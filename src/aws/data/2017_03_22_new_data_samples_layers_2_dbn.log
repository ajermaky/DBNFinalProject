_______RUN: 0

==========Layers: [1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.978301895
Pre-training layer 0, epoch 0, representative training free energy -403.737935883
Pre-training layer 0, epoch 0, validation free energy -399.145662689
Pre-training layer 0, epoch 1, cost -96.7157479553
Pre-training layer 0, epoch 2, cost -91.1020001984
Pre-training layer 0, epoch 3, cost -87.898904953
Pre-training layer 0, epoch 4, cost -85.8381027145
Pre-training layer 0, epoch 5, cost -84.1484031143
Pre-training layer 0, epoch 5, representative training free energy -350.353727722
Pre-training layer 0, epoch 5, validation free energy -342.754701141
Pre-training layer 0, epoch 6, cost -82.9468167267
Pre-training layer 0, epoch 7, cost -81.9777912216
Pre-training layer 0, epoch 8, cost -81.2377444229
Pre-training layer 0, epoch 9, cost -80.5045234604
Pre-training layer 0, epoch 10, cost -79.9059928131
Pre-training layer 0, epoch 10, representative training free energy -340.930774933
Pre-training layer 0, epoch 10, validation free energy -332.687208435
Pre-training layer 0, epoch 11, cost -79.2866701965
Pre-training layer 0, epoch 12, cost -78.8497456741
Pre-training layer 0, epoch 13, cost -78.3321193466
Pre-training layer 0, epoch 14, cost -77.9263762054
Pre-training layer 0, epoch 15, cost -77.6714734802
Pre-training layer 0, epoch 15, representative training free energy -331.697545975
Pre-training layer 0, epoch 15, validation free energy -324.367362564
Pre-training layer 0, epoch 16, cost -77.3268844757
Pre-training layer 0, epoch 17, cost -76.8290162735
Pre-training layer 0, epoch 18, cost -76.6540405426
Pre-training layer 0, epoch 19, cost -76.3758392868
Pre-training layer 0, epoch 20, cost -76.1154821625
Pre-training layer 0, epoch 20, representative training free energy -329.339082138
Pre-training layer 0, epoch 20, validation free energy -320.40690834
Pre-training layer 0, epoch 21, cost -75.9143422546
Pre-training layer 0, epoch 22, cost -75.5293122559
Pre-training layer 0, epoch 23, cost -75.3286850281
Pre-training layer 0, epoch 24, cost -75.2751819611
Pre-training layer 0, epoch 25, cost -75.118500351
Pre-training layer 0, epoch 25, representative training free energy -322.438662689
Pre-training layer 0, epoch 25, validation free energy -312.791254517
Pre-training layer 0, epoch 26, cost -74.8939204483
Pre-training layer 0, epoch 27, cost -74.8138998642
Pre-training layer 0, epoch 28, cost -74.5802316666
Pre-training layer 0, epoch 29, cost -74.4406162338
Pre-training layer 0, epoch 30, cost -74.2116060181
Pre-training layer 0, epoch 30, representative training free energy -320.131377579
Pre-training layer 0, epoch 30, validation free energy -311.066468384
Pre-training layer 0, epoch 31, cost -74.0440512238
Pre-training layer 0, epoch 32, cost -73.8948479614
Pre-training layer 0, epoch 33, cost -73.7745130615
Pre-training layer 0, epoch 34, cost -73.6464049683
Pre-training layer 0, epoch 35, cost -73.5302156754
Pre-training layer 0, epoch 35, representative training free energy -315.760323044
Pre-training layer 0, epoch 35, validation free energy -305.926206161
Pre-training layer 0, epoch 36, cost -73.3379705276
Pre-training layer 0, epoch 37, cost -73.2352649994
Pre-training layer 0, epoch 38, cost -73.156679184
Pre-training layer 0, epoch 39, cost -73.0791954727
Pre-training layer 0, epoch 40, cost -72.9596827164
Pre-training layer 0, epoch 40, representative training free energy -310.964059113
Pre-training layer 0, epoch 40, validation free energy -300.200972855
Pre-training layer 0, epoch 41, cost -72.8345327148
Pre-training layer 0, epoch 42, cost -72.7778083878
Pre-training layer 0, epoch 43, cost -72.6358510971
Pre-training layer 0, epoch 44, cost -72.6402755585
Pre-training layer 0, epoch 45, cost -72.5150795364
Pre-training layer 0, epoch 45, representative training free energy -308.582941986
Pre-training layer 0, epoch 45, validation free energy -298.760423889
Pre-training layer 0, epoch 46, cost -72.3784234467
Pre-training layer 0, epoch 47, cost -72.33462043
Pre-training layer 0, epoch 48, cost -72.1701953735
Pre-training layer 0, epoch 49, cost -72.2079477081
Pre-training layer 0, epoch 50, cost -72.0888145905
Pre-training layer 0, epoch 50, representative training free energy -307.013513977
Pre-training layer 0, epoch 50, validation free energy -296.33978302
Pre-training layer 0, epoch 51, cost -71.9653742599
Pre-training layer 0, epoch 52, cost -71.9767436142
Pre-training layer 0, epoch 53, cost -71.8248438492
Pre-training layer 0, epoch 54, cost -71.7022094803
Pre-training layer 0, epoch 55, cost -71.7165154572
Pre-training layer 0, epoch 55, representative training free energy -303.45370105
Pre-training layer 0, epoch 55, validation free energy -292.183408325
Pre-training layer 0, epoch 56, cost -71.5926363297
Pre-training layer 0, epoch 57, cost -71.5700020523
Pre-training layer 0, epoch 58, cost -71.4246395721
Pre-training layer 0, epoch 59, cost -71.3994981232
Pre-training layer 0, epoch 60, cost -71.3532808533
Pre-training layer 0, epoch 60, representative training free energy -300.935382233
Pre-training layer 0, epoch 60, validation free energy -289.125050873
Pre-training layer 0, epoch 61, cost -71.217469223
Pre-training layer 0, epoch 62, cost -71.2405652313
Pre-training layer 0, epoch 63, cost -71.1054517365
Pre-training layer 0, epoch 64, cost -71.0426599274
Pre-training layer 0, epoch 65, cost -71.0600471954
Pre-training layer 0, epoch 65, representative training free energy -294.851419174
Pre-training layer 0, epoch 65, validation free energy -284.007699188
Pre-training layer 0, epoch 66, cost -71.0085506134
Pre-training layer 0, epoch 67, cost -70.9097368317
Pre-training layer 0, epoch 68, cost -70.798548111
Pre-training layer 0, epoch 69, cost -70.8026683197
Pre-training layer 0, epoch 70, cost -70.7340310364
Pre-training layer 0, epoch 70, representative training free energy -291.950687729
Pre-training layer 0, epoch 70, validation free energy -280.13103624
Pre-training layer 0, epoch 71, cost -70.7109154053
Pre-training layer 0, epoch 72, cost -70.6087123566
Pre-training layer 0, epoch 73, cost -70.5286875153
Pre-training layer 0, epoch 74, cost -70.4601678925
Pre-training layer 0, epoch 75, cost -70.5108752899
Pre-training layer 0, epoch 75, representative training free energy -288.026173355
Pre-training layer 0, epoch 75, validation free energy -275.974565353
Pre-training layer 0, epoch 76, cost -70.4362898636
Pre-training layer 0, epoch 77, cost -70.3606339264
Pre-training layer 0, epoch 78, cost -70.3553477631
Pre-training layer 0, epoch 79, cost -70.2988590088
Pre-training layer 0, epoch 80, cost -70.2112962875
Pre-training layer 0, epoch 80, representative training free energy -285.329678192
Pre-training layer 0, epoch 80, validation free energy -273.762221756
Pre-training layer 0, epoch 81, cost -70.1385518951
Pre-training layer 0, epoch 82, cost -70.1195090485
Pre-training layer 0, epoch 83, cost -70.0347834167
Pre-training layer 0, epoch 84, cost -70.0044495087
Pre-training layer 0, epoch 85, cost -69.9572436523
Pre-training layer 0, epoch 85, representative training free energy -278.842178772
Pre-training layer 0, epoch 85, validation free energy -266.134903091
Pre-training layer 0, epoch 86, cost -69.9736726837
Pre-training layer 0, epoch 87, cost -69.8331051636
Pre-training layer 0, epoch 88, cost -69.8672281799
Pre-training layer 0, epoch 89, cost -69.8024226685
Pre-training layer 0, epoch 90, cost -69.7926904984
Pre-training layer 0, epoch 90, representative training free energy -278.049399597
Pre-training layer 0, epoch 90, validation free energy -265.526435242
Pre-training layer 0, epoch 91, cost -69.7032273026
Pre-training layer 0, epoch 92, cost -69.6728578949
Pre-training layer 0, epoch 93, cost -69.5894141617
Pre-training layer 0, epoch 94, cost -69.560911232
Pre-training layer 0, epoch 95, cost -69.5122365875
Pre-training layer 0, epoch 95, representative training free energy -273.267698776
Pre-training layer 0, epoch 95, validation free energy -261.561676559
Pre-training layer 0, epoch 96, cost -69.4905189896
Pre-training layer 0, epoch 97, cost -69.4085933762
Pre-training layer 0, epoch 98, cost -69.3444744186
Pre-training layer 0, epoch 99, cost -69.3797250977
The pretraining code for file dbn_loop.pyc ran for 1.22m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 16.500000 %
     epoch 1, minibatch 500/500, test error of best model 16.400000 %
epoch 2, minibatch 500/500, validation error 11.400000 %
     epoch 2, minibatch 500/500, test error of best model 10.700000 %
epoch 3, minibatch 500/500, validation error 9.400000 %
     epoch 3, minibatch 500/500, test error of best model 8.200000 %
epoch 4, minibatch 500/500, validation error 8.100000 %
     epoch 4, minibatch 500/500, test error of best model 7.200000 %
epoch 5, minibatch 500/500, validation error 7.500000 %
     epoch 5, minibatch 500/500, test error of best model 6.600000 %
epoch 6, minibatch 500/500, validation error 7.000000 %
     epoch 6, minibatch 500/500, test error of best model 6.300000 %
epoch 7, minibatch 500/500, validation error 6.600000 %
     epoch 7, minibatch 500/500, test error of best model 6.200000 %
epoch 8, minibatch 500/500, validation error 6.300000 %
     epoch 8, minibatch 500/500, test error of best model 6.000000 %
epoch 9, minibatch 500/500, validation error 6.100000 %
     epoch 9, minibatch 500/500, test error of best model 6.100000 %
epoch 10, minibatch 500/500, validation error 5.900000 %
     epoch 10, minibatch 500/500, test error of best model 6.100000 %
epoch 11, minibatch 500/500, validation error 6.000000 %
epoch 12, minibatch 500/500, validation error 6.000000 %
epoch 13, minibatch 500/500, validation error 5.900000 %
epoch 14, minibatch 500/500, validation error 5.900000 %
epoch 15, minibatch 500/500, validation error 5.900000 %
epoch 16, minibatch 500/500, validation error 5.600000 %
     epoch 16, minibatch 500/500, test error of best model 5.300000 %
epoch 17, minibatch 500/500, validation error 5.700000 %
epoch 18, minibatch 500/500, validation error 5.700000 %
epoch 19, minibatch 500/500, validation error 5.700000 %
epoch 20, minibatch 500/500, validation error 5.600000 %
epoch 21, minibatch 500/500, validation error 5.700000 %
epoch 22, minibatch 500/500, validation error 5.700000 %
epoch 23, minibatch 500/500, validation error 5.700000 %
epoch 24, minibatch 500/500, validation error 5.600000 %
epoch 25, minibatch 500/500, validation error 5.500000 %
     epoch 25, minibatch 500/500, test error of best model 4.900000 %
epoch 26, minibatch 500/500, validation error 5.400000 %
     epoch 26, minibatch 500/500, test error of best model 4.900000 %
epoch 27, minibatch 500/500, validation error 5.300000 %
     epoch 27, minibatch 500/500, test error of best model 4.800000 %
epoch 28, minibatch 500/500, validation error 5.300000 %
epoch 29, minibatch 500/500, validation error 5.200000 %
     epoch 29, minibatch 500/500, test error of best model 5.000000 %
epoch 30, minibatch 500/500, validation error 5.200000 %
epoch 31, minibatch 500/500, validation error 5.200000 %
epoch 32, minibatch 500/500, validation error 5.100000 %
     epoch 32, minibatch 500/500, test error of best model 5.000000 %
epoch 33, minibatch 500/500, validation error 5.100000 %
epoch 34, minibatch 500/500, validation error 5.100000 %
epoch 35, minibatch 500/500, validation error 4.900000 %
     epoch 35, minibatch 500/500, test error of best model 5.100000 %
epoch 36, minibatch 500/500, validation error 4.900000 %
epoch 37, minibatch 500/500, validation error 4.900000 %
epoch 38, minibatch 500/500, validation error 4.900000 %
epoch 39, minibatch 500/500, validation error 4.900000 %
epoch 40, minibatch 500/500, validation error 4.900000 %
epoch 41, minibatch 500/500, validation error 4.900000 %
epoch 42, minibatch 500/500, validation error 4.900000 %
epoch 43, minibatch 500/500, validation error 4.900000 %
epoch 44, minibatch 500/500, validation error 4.900000 %
epoch 45, minibatch 500/500, validation error 4.900000 %
epoch 46, minibatch 500/500, validation error 4.900000 %
epoch 47, minibatch 500/500, validation error 4.900000 %
epoch 48, minibatch 500/500, validation error 4.900000 %
epoch 49, minibatch 500/500, validation error 4.900000 %
epoch 50, minibatch 500/500, validation error 4.900000 %
epoch 51, minibatch 500/500, validation error 4.900000 %
epoch 52, minibatch 500/500, validation error 4.900000 %
epoch 53, minibatch 500/500, validation error 4.900000 %
epoch 54, minibatch 500/500, validation error 4.900000 %
epoch 55, minibatch 500/500, validation error 4.900000 %
epoch 56, minibatch 500/500, validation error 4.900000 %
epoch 57, minibatch 500/500, validation error 4.900000 %
epoch 58, minibatch 500/500, validation error 4.900000 %
epoch 59, minibatch 500/500, validation error 4.900000 %
epoch 60, minibatch 500/500, validation error 4.900000 %
epoch 61, minibatch 500/500, validation error 4.900000 %
epoch 62, minibatch 500/500, validation error 4.900000 %
epoch 63, minibatch 500/500, validation error 4.900000 %
epoch 64, minibatch 500/500, validation error 4.900000 %
epoch 65, minibatch 500/500, validation error 4.900000 %
epoch 66, minibatch 500/500, validation error 4.900000 %
epoch 67, minibatch 500/500, validation error 4.900000 %
epoch 68, minibatch 500/500, validation error 4.900000 %
epoch 69, minibatch 500/500, validation error 4.900000 %
Optimization complete with best validation score of 4.900000 %, obtained at iteration 17500, with test performance 5.100000 %
The fine tuning code for file dbn_loop.pyc ran for 0.44m


==========Layers: [1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -121.033790329
Pre-training layer 0, epoch 0, representative training free energy -408.875717926
Pre-training layer 0, epoch 0, validation free energy -403.603559631
Pre-training layer 0, epoch 1, cost -96.722141449
Pre-training layer 0, epoch 2, cost -90.9669599304
Pre-training layer 0, epoch 3, cost -87.7728413086
Pre-training layer 0, epoch 4, cost -85.7486105957
Pre-training layer 0, epoch 5, cost -84.1782671127
Pre-training layer 0, epoch 5, representative training free energy -353.353989044
Pre-training layer 0, epoch 5, validation free energy -346.965464294
Pre-training layer 0, epoch 6, cost -83.0006663361
Pre-training layer 0, epoch 7, cost -82.0789467773
Pre-training layer 0, epoch 8, cost -81.1987757187
Pre-training layer 0, epoch 9, cost -80.4584504623
Pre-training layer 0, epoch 10, cost -79.8912337112
Pre-training layer 0, epoch 10, representative training free energy -341.224697418
Pre-training layer 0, epoch 10, validation free energy -332.981278946
Pre-training layer 0, epoch 11, cost -79.3100137405
Pre-training layer 0, epoch 12, cost -78.8441932983
Pre-training layer 0, epoch 13, cost -78.2755966187
Pre-training layer 0, epoch 14, cost -77.9469265442
Pre-training layer 0, epoch 15, cost -77.5353748169
Pre-training layer 0, epoch 15, representative training free energy -334.589998306
Pre-training layer 0, epoch 15, validation free energy -327.278528
Pre-training layer 0, epoch 16, cost -77.1912362137
Pre-training layer 0, epoch 17, cost -76.9198536987
Pre-training layer 0, epoch 18, cost -76.6329455566
Pre-training layer 0, epoch 19, cost -76.3739561234
Pre-training layer 0, epoch 20, cost -76.0440391693
Pre-training layer 0, epoch 20, representative training free energy -329.21394371
Pre-training layer 0, epoch 20, validation free energy -321.307146713
Pre-training layer 0, epoch 21, cost -75.8608345337
Pre-training layer 0, epoch 22, cost -75.6126661224
Pre-training layer 0, epoch 23, cost -75.4906067734
Pre-training layer 0, epoch 24, cost -75.2133919907
Pre-training layer 0, epoch 25, cost -75.0102485962
Pre-training layer 0, epoch 25, representative training free energy -329.711268265
Pre-training layer 0, epoch 25, validation free energy -321.001013519
Pre-training layer 0, epoch 26, cost -74.9135932236
Pre-training layer 0, epoch 27, cost -74.7355376511
Pre-training layer 0, epoch 28, cost -74.5611540604
Pre-training layer 0, epoch 29, cost -74.3818499908
Pre-training layer 0, epoch 30, cost -74.1924318771
Pre-training layer 0, epoch 30, representative training free energy -322.296937454
Pre-training layer 0, epoch 30, validation free energy -313.18709642
Pre-training layer 0, epoch 31, cost -74.1059016571
Pre-training layer 0, epoch 32, cost -73.9336364822
Pre-training layer 0, epoch 33, cost -73.8865407715
Pre-training layer 0, epoch 34, cost -73.6751767578
Pre-training layer 0, epoch 35, cost -73.5048345261
Pre-training layer 0, epoch 35, representative training free energy -318.287234589
Pre-training layer 0, epoch 35, validation free energy -308.994799225
Pre-training layer 0, epoch 36, cost -73.4932176285
Pre-training layer 0, epoch 37, cost -73.4047824402
Pre-training layer 0, epoch 38, cost -73.2393430252
Pre-training layer 0, epoch 39, cost -73.0395018387
Pre-training layer 0, epoch 40, cost -73.0945309219
Pre-training layer 0, epoch 40, representative training free energy -314.392805252
Pre-training layer 0, epoch 40, validation free energy -303.670510422
Pre-training layer 0, epoch 41, cost -72.9236489182
Pre-training layer 0, epoch 42, cost -72.8033604355
Pre-training layer 0, epoch 43, cost -72.6785151596
Pre-training layer 0, epoch 44, cost -72.6945891037
Pre-training layer 0, epoch 45, cost -72.6382419968
Pre-training layer 0, epoch 45, representative training free energy -312.108694778
Pre-training layer 0, epoch 45, validation free energy -301.302230743
Pre-training layer 0, epoch 46, cost -72.4343340149
Pre-training layer 0, epoch 47, cost -72.3592803421
Pre-training layer 0, epoch 48, cost -72.3055760651
Pre-training layer 0, epoch 49, cost -72.2068515854
Pre-training layer 0, epoch 50, cost -72.1248800125
Pre-training layer 0, epoch 50, representative training free energy -307.022105911
Pre-training layer 0, epoch 50, validation free energy -296.885455902
Pre-training layer 0, epoch 51, cost -71.9543349686
Pre-training layer 0, epoch 52, cost -71.8839835815
Pre-training layer 0, epoch 53, cost -71.8301106644
Pre-training layer 0, epoch 54, cost -71.738147438
Pre-training layer 0, epoch 55, cost -71.776489006
Pre-training layer 0, epoch 55, representative training free energy -304.693100983
Pre-training layer 0, epoch 55, validation free energy -293.299814682
Pre-training layer 0, epoch 56, cost -71.6194802246
Pre-training layer 0, epoch 57, cost -71.4857431183
Pre-training layer 0, epoch 58, cost -71.4552016144
Pre-training layer 0, epoch 59, cost -71.3516769867
Pre-training layer 0, epoch 60, cost -71.4159979858
Pre-training layer 0, epoch 60, representative training free energy -296.356430893
Pre-training layer 0, epoch 60, validation free energy -286.354055618
Pre-training layer 0, epoch 61, cost -71.3452786102
Pre-training layer 0, epoch 62, cost -71.2258194122
Pre-training layer 0, epoch 63, cost -71.1914153137
Pre-training layer 0, epoch 64, cost -71.157964035
Pre-training layer 0, epoch 65, cost -70.9527272186
Pre-training layer 0, epoch 65, representative training free energy -293.319685303
Pre-training layer 0, epoch 65, validation free energy -283.118244476
Pre-training layer 0, epoch 66, cost -71.0024550934
Pre-training layer 0, epoch 67, cost -71.0425765228
Pre-training layer 0, epoch 68, cost -70.8702490997
Pre-training layer 0, epoch 69, cost -70.8459862976
Pre-training layer 0, epoch 70, cost -70.7403952866
Pre-training layer 0, epoch 70, representative training free energy -293.490057831
Pre-training layer 0, epoch 70, validation free energy -282.701512619
Pre-training layer 0, epoch 71, cost -70.6207126312
Pre-training layer 0, epoch 72, cost -70.5422340164
Pre-training layer 0, epoch 73, cost -70.617876976
Pre-training layer 0, epoch 74, cost -70.5291988373
Pre-training layer 0, epoch 75, cost -70.5166817551
Pre-training layer 0, epoch 75, representative training free energy -290.989393051
Pre-training layer 0, epoch 75, validation free energy -279.6308927
Pre-training layer 0, epoch 76, cost -70.4274306183
Pre-training layer 0, epoch 77, cost -70.395002243
Pre-training layer 0, epoch 78, cost -70.4318141861
Pre-training layer 0, epoch 79, cost -70.3054746628
Pre-training layer 0, epoch 80, cost -70.3410862579
Pre-training layer 0, epoch 80, representative training free energy -283.620887329
Pre-training layer 0, epoch 80, validation free energy -271.954165466
Pre-training layer 0, epoch 81, cost -70.2342995605
Pre-training layer 0, epoch 82, cost -70.1461498871
Pre-training layer 0, epoch 83, cost -70.1278132629
Pre-training layer 0, epoch 84, cost -69.9621828613
Pre-training layer 0, epoch 85, cost -69.9754657669
Pre-training layer 0, epoch 85, representative training free energy -283.472996429
Pre-training layer 0, epoch 85, validation free energy -271.61096817
Pre-training layer 0, epoch 86, cost -69.9774409714
Pre-training layer 0, epoch 87, cost -69.944307312
Pre-training layer 0, epoch 88, cost -69.9237413864
Pre-training layer 0, epoch 89, cost -69.8542888412
Pre-training layer 0, epoch 90, cost -69.809297142
Pre-training layer 0, epoch 90, representative training free energy -280.37569754
Pre-training layer 0, epoch 90, validation free energy -268.592322495
Pre-training layer 0, epoch 91, cost -69.7466299286
Pre-training layer 0, epoch 92, cost -69.7184214096
Pre-training layer 0, epoch 93, cost -69.6222540588
Pre-training layer 0, epoch 94, cost -69.6634401932
Pre-training layer 0, epoch 95, cost -69.6537811966
Pre-training layer 0, epoch 95, representative training free energy -274.527434982
Pre-training layer 0, epoch 95, validation free energy -262.893680908
Pre-training layer 0, epoch 96, cost -69.6573107681
Pre-training layer 0, epoch 97, cost -69.4816437378
Pre-training layer 0, epoch 98, cost -69.4402828903
Pre-training layer 0, epoch 99, cost -69.4565777206
Pre-training layer 1, epoch 0, cost -174.047343063
Pre-training layer 1, epoch 0, representative training free energy -144111.821461
Pre-training layer 1, epoch 0, validation free energy -143153.936629
Pre-training layer 1, epoch 1, cost -143.955985382
Pre-training layer 1, epoch 2, cost -135.588481934
Pre-training layer 1, epoch 3, cost -130.85619548
Pre-training layer 1, epoch 4, cost -127.824475906
Pre-training layer 1, epoch 5, cost -125.639810623
Pre-training layer 1, epoch 5, representative training free energy -197814.303047
Pre-training layer 1, epoch 5, validation free energy -196378.494648
Pre-training layer 1, epoch 6, cost -123.963649628
Pre-training layer 1, epoch 7, cost -122.473294922
Pre-training layer 1, epoch 8, cost -121.281754684
Pre-training layer 1, epoch 9, cost -120.377930313
Pre-training layer 1, epoch 10, cost -119.440312027
Pre-training layer 1, epoch 10, representative training free energy -218163.201383
Pre-training layer 1, epoch 10, validation free energy -216533.740008
Pre-training layer 1, epoch 11, cost -118.683471283
Pre-training layer 1, epoch 12, cost -118.046786774
Pre-training layer 1, epoch 13, cost -117.490335678
Pre-training layer 1, epoch 14, cost -116.903727844
Pre-training layer 1, epoch 15, cost -116.484244156
Pre-training layer 1, epoch 15, representative training free energy -232264.08832
Pre-training layer 1, epoch 15, validation free energy -230489.506023
Pre-training layer 1, epoch 16, cost -115.951070557
Pre-training layer 1, epoch 17, cost -115.652973907
Pre-training layer 1, epoch 18, cost -115.223136917
Pre-training layer 1, epoch 19, cost -114.870758652
Pre-training layer 1, epoch 20, cost -114.587063477
Pre-training layer 1, epoch 20, representative training free energy -243140.156227
Pre-training layer 1, epoch 20, validation free energy -241284.938508
Pre-training layer 1, epoch 21, cost -114.310339233
Pre-training layer 1, epoch 22, cost -114.022423386
Pre-training layer 1, epoch 23, cost -113.717333069
Pre-training layer 1, epoch 24, cost -113.535136337
Pre-training layer 1, epoch 25, cost -113.329610336
Pre-training layer 1, epoch 25, representative training free energy -251411.611117
Pre-training layer 1, epoch 25, validation free energy -249461.224273
Pre-training layer 1, epoch 26, cost -113.051971527
Pre-training layer 1, epoch 27, cost -112.796826492
Pre-training layer 1, epoch 28, cost -112.67593602
Pre-training layer 1, epoch 29, cost -112.439220169
Pre-training layer 1, epoch 30, cost -112.319559616
Pre-training layer 1, epoch 30, representative training free energy -258912.180344
Pre-training layer 1, epoch 30, validation free energy -256897.594008
Pre-training layer 1, epoch 31, cost -112.041323975
Pre-training layer 1, epoch 32, cost -111.957576889
Pre-training layer 1, epoch 33, cost -111.768549561
Pre-training layer 1, epoch 34, cost -111.6006483
Pre-training layer 1, epoch 35, cost -111.54980275
Pre-training layer 1, epoch 35, representative training free energy -265053.456312
Pre-training layer 1, epoch 35, validation free energy -263031.628367
Pre-training layer 1, epoch 36, cost -111.316831787
Pre-training layer 1, epoch 37, cost -111.249633286
Pre-training layer 1, epoch 38, cost -111.123693939
Pre-training layer 1, epoch 39, cost -110.912074997
Pre-training layer 1, epoch 40, cost -110.839477264
Pre-training layer 1, epoch 40, representative training free energy -270949.322867
Pre-training layer 1, epoch 40, validation free energy -268850.291648
Pre-training layer 1, epoch 41, cost -110.735611755
Pre-training layer 1, epoch 42, cost -110.654229294
Pre-training layer 1, epoch 43, cost -110.532254654
Pre-training layer 1, epoch 44, cost -110.413909225
Pre-training layer 1, epoch 45, cost -110.244455841
Pre-training layer 1, epoch 45, representative training free energy -276040.520469
Pre-training layer 1, epoch 45, validation free energy -273933.035922
Pre-training layer 1, epoch 46, cost -110.24165181
Pre-training layer 1, epoch 47, cost -110.149998413
Pre-training layer 1, epoch 48, cost -110.092488785
Pre-training layer 1, epoch 49, cost -110.012182144
Pre-training layer 1, epoch 50, cost -109.907708221
Pre-training layer 1, epoch 50, representative training free energy -280648.665766
Pre-training layer 1, epoch 50, validation free energy -278496.100547
Pre-training layer 1, epoch 51, cost -109.882421997
Pre-training layer 1, epoch 52, cost -109.718720123
Pre-training layer 1, epoch 53, cost -109.67483403
Pre-training layer 1, epoch 54, cost -109.65762117
Pre-training layer 1, epoch 55, cost -109.563700623
Pre-training layer 1, epoch 55, representative training free energy -284440.119859
Pre-training layer 1, epoch 55, validation free energy -282270.758984
Pre-training layer 1, epoch 56, cost -109.541243164
Pre-training layer 1, epoch 57, cost -109.400555099
Pre-training layer 1, epoch 58, cost -109.314892517
Pre-training layer 1, epoch 59, cost -109.283517563
Pre-training layer 1, epoch 60, cost -109.205524506
Pre-training layer 1, epoch 60, representative training free energy -288078.473453
Pre-training layer 1, epoch 60, validation free energy -285786.863219
Pre-training layer 1, epoch 61, cost -109.203640518
Pre-training layer 1, epoch 62, cost -109.068039413
Pre-training layer 1, epoch 63, cost -109.054445351
Pre-training layer 1, epoch 64, cost -109.028135086
Pre-training layer 1, epoch 65, cost -108.937046318
Pre-training layer 1, epoch 65, representative training free energy -291517.424711
Pre-training layer 1, epoch 65, validation free energy -289287.280664
Pre-training layer 1, epoch 66, cost -108.942024506
Pre-training layer 1, epoch 67, cost -108.87478125
Pre-training layer 1, epoch 68, cost -108.792900848
Pre-training layer 1, epoch 69, cost -108.804724457
Pre-training layer 1, epoch 70, cost -108.743664215
Pre-training layer 1, epoch 70, representative training free energy -295382.058211
Pre-training layer 1, epoch 70, validation free energy -293133.736563
Pre-training layer 1, epoch 71, cost -108.65969606
Pre-training layer 1, epoch 72, cost -108.660656906
Pre-training layer 1, epoch 73, cost -108.598106064
Pre-training layer 1, epoch 74, cost -108.535805016
Pre-training layer 1, epoch 75, cost -108.467660789
Pre-training layer 1, epoch 75, representative training free energy -298476.902891
Pre-training layer 1, epoch 75, validation free energy -296146.382773
Pre-training layer 1, epoch 76, cost -108.466525909
Pre-training layer 1, epoch 77, cost -108.473919006
Pre-training layer 1, epoch 78, cost -108.443422096
Pre-training layer 1, epoch 79, cost -108.399075356
Pre-training layer 1, epoch 80, cost -108.311600197
Pre-training layer 1, epoch 80, representative training free energy -301183.965672
Pre-training layer 1, epoch 80, validation free energy -298835.260742
Pre-training layer 1, epoch 81, cost -108.271976959
Pre-training layer 1, epoch 82, cost -108.261963676
Pre-training layer 1, epoch 83, cost -108.274610802
Pre-training layer 1, epoch 84, cost -108.258095528
Pre-training layer 1, epoch 85, cost -108.141154129
Pre-training layer 1, epoch 85, representative training free energy -303850.433789
Pre-training layer 1, epoch 85, validation free energy -301513.010187
Pre-training layer 1, epoch 86, cost -108.077197968
Pre-training layer 1, epoch 87, cost -108.113111298
Pre-training layer 1, epoch 88, cost -107.982648499
Pre-training layer 1, epoch 89, cost -108.077473152
Pre-training layer 1, epoch 90, cost -107.981570404
Pre-training layer 1, epoch 90, representative training free energy -306239.675523
Pre-training layer 1, epoch 90, validation free energy -303897.237273
Pre-training layer 1, epoch 91, cost -108.045505005
Pre-training layer 1, epoch 92, cost -107.951240173
Pre-training layer 1, epoch 93, cost -107.934655174
Pre-training layer 1, epoch 94, cost -107.846128906
Pre-training layer 1, epoch 95, cost -107.873481873
Pre-training layer 1, epoch 95, representative training free energy -308675.972781
Pre-training layer 1, epoch 95, validation free energy -306274.683258
Pre-training layer 1, epoch 96, cost -107.76885627
Pre-training layer 1, epoch 97, cost -107.743993027
Pre-training layer 1, epoch 98, cost -107.721955521
Pre-training layer 1, epoch 99, cost -107.696624893
The pretraining code for file dbn_loop.pyc ran for 2.83m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.000000 %
     epoch 1, minibatch 500/500, test error of best model 13.600000 %
epoch 2, minibatch 500/500, validation error 9.500000 %
     epoch 2, minibatch 500/500, test error of best model 9.500000 %
epoch 3, minibatch 500/500, validation error 7.900000 %
     epoch 3, minibatch 500/500, test error of best model 7.700000 %
epoch 4, minibatch 500/500, validation error 6.800000 %
     epoch 4, minibatch 500/500, test error of best model 7.100000 %
epoch 5, minibatch 500/500, validation error 6.200000 %
     epoch 5, minibatch 500/500, test error of best model 6.700000 %
epoch 6, minibatch 500/500, validation error 5.800000 %
     epoch 6, minibatch 500/500, test error of best model 6.500000 %
epoch 7, minibatch 500/500, validation error 5.300000 %
     epoch 7, minibatch 500/500, test error of best model 6.000000 %
epoch 8, minibatch 500/500, validation error 5.300000 %
epoch 9, minibatch 500/500, validation error 5.300000 %
epoch 10, minibatch 500/500, validation error 5.200000 %
     epoch 10, minibatch 500/500, test error of best model 5.500000 %
epoch 11, minibatch 500/500, validation error 5.300000 %
epoch 12, minibatch 500/500, validation error 5.300000 %
epoch 13, minibatch 500/500, validation error 5.000000 %
     epoch 13, minibatch 500/500, test error of best model 5.300000 %
epoch 14, minibatch 500/500, validation error 5.100000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
epoch 16, minibatch 500/500, validation error 5.200000 %
epoch 17, minibatch 500/500, validation error 5.100000 %
epoch 18, minibatch 500/500, validation error 4.800000 %
     epoch 18, minibatch 500/500, test error of best model 5.100000 %
epoch 19, minibatch 500/500, validation error 4.600000 %
     epoch 19, minibatch 500/500, test error of best model 5.000000 %
epoch 20, minibatch 500/500, validation error 4.500000 %
     epoch 20, minibatch 500/500, test error of best model 5.000000 %
epoch 21, minibatch 500/500, validation error 4.600000 %
epoch 22, minibatch 500/500, validation error 4.600000 %
epoch 23, minibatch 500/500, validation error 4.600000 %
epoch 24, minibatch 500/500, validation error 4.600000 %
epoch 25, minibatch 500/500, validation error 4.600000 %
epoch 26, minibatch 500/500, validation error 4.600000 %
epoch 27, minibatch 500/500, validation error 4.500000 %
epoch 28, minibatch 500/500, validation error 4.500000 %
epoch 29, minibatch 500/500, validation error 4.500000 %
epoch 30, minibatch 500/500, validation error 4.500000 %
epoch 31, minibatch 500/500, validation error 4.500000 %
epoch 32, minibatch 500/500, validation error 4.600000 %
epoch 33, minibatch 500/500, validation error 4.600000 %
epoch 34, minibatch 500/500, validation error 4.600000 %
epoch 35, minibatch 500/500, validation error 4.600000 %
epoch 36, minibatch 500/500, validation error 4.600000 %
epoch 37, minibatch 500/500, validation error 4.600000 %
epoch 38, minibatch 500/500, validation error 4.600000 %
epoch 39, minibatch 500/500, validation error 4.600000 %
Optimization complete with best validation score of 4.500000 %, obtained at iteration 10000, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.54m


==========Layers: [1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.792779495
Pre-training layer 0, epoch 0, representative training free energy -408.933905731
Pre-training layer 0, epoch 0, validation free energy -404.155954742
Pre-training layer 0, epoch 1, cost -96.7597813721
Pre-training layer 0, epoch 2, cost -90.8222769775
Pre-training layer 0, epoch 3, cost -87.77471698
Pre-training layer 0, epoch 4, cost -85.6880443268
Pre-training layer 0, epoch 5, cost -84.2815156326
Pre-training layer 0, epoch 5, representative training free energy -349.028797821
Pre-training layer 0, epoch 5, validation free energy -342.835365829
Pre-training layer 0, epoch 6, cost -82.9012403946
Pre-training layer 0, epoch 7, cost -82.0462086792
Pre-training layer 0, epoch 8, cost -81.1629303818
Pre-training layer 0, epoch 9, cost -80.5153626633
Pre-training layer 0, epoch 10, cost -79.8292186127
Pre-training layer 0, epoch 10, representative training free energy -343.599464325
Pre-training layer 0, epoch 10, validation free energy -336.959708374
Pre-training layer 0, epoch 11, cost -79.3038451157
Pre-training layer 0, epoch 12, cost -78.7638030777
Pre-training layer 0, epoch 13, cost -78.2274127731
Pre-training layer 0, epoch 14, cost -77.8753828354
Pre-training layer 0, epoch 15, cost -77.5546332169
Pre-training layer 0, epoch 15, representative training free energy -337.589639435
Pre-training layer 0, epoch 15, validation free energy -328.325243027
Pre-training layer 0, epoch 16, cost -77.2310146866
Pre-training layer 0, epoch 17, cost -76.9239862518
Pre-training layer 0, epoch 18, cost -76.586224968
Pre-training layer 0, epoch 19, cost -76.4252965546
Pre-training layer 0, epoch 20, cost -76.1416117325
Pre-training layer 0, epoch 20, representative training free energy -329.372046707
Pre-training layer 0, epoch 20, validation free energy -321.343727615
Pre-training layer 0, epoch 21, cost -75.8058812714
Pre-training layer 0, epoch 22, cost -75.614493248
Pre-training layer 0, epoch 23, cost -75.3690582733
Pre-training layer 0, epoch 24, cost -75.2382902069
Pre-training layer 0, epoch 25, cost -75.1252897644
Pre-training layer 0, epoch 25, representative training free energy -326.400614807
Pre-training layer 0, epoch 25, validation free energy -317.021993484
Pre-training layer 0, epoch 26, cost -74.8456318817
Pre-training layer 0, epoch 27, cost -74.6127785263
Pre-training layer 0, epoch 28, cost -74.5341989136
Pre-training layer 0, epoch 29, cost -74.2824740829
Pre-training layer 0, epoch 30, cost -74.188088089
Pre-training layer 0, epoch 30, representative training free energy -321.598327362
Pre-training layer 0, epoch 30, validation free energy -311.408757492
Pre-training layer 0, epoch 31, cost -74.0554448853
Pre-training layer 0, epoch 32, cost -73.9552319412
Pre-training layer 0, epoch 33, cost -73.8171348953
Pre-training layer 0, epoch 34, cost -73.5642352066
Pre-training layer 0, epoch 35, cost -73.5826645432
Pre-training layer 0, epoch 35, representative training free energy -318.449030701
Pre-training layer 0, epoch 35, validation free energy -308.564252563
Pre-training layer 0, epoch 36, cost -73.444597435
Pre-training layer 0, epoch 37, cost -73.2508713455
Pre-training layer 0, epoch 38, cost -73.1276382751
Pre-training layer 0, epoch 39, cost -73.1815069809
Pre-training layer 0, epoch 40, cost -72.8864789124
Pre-training layer 0, epoch 40, representative training free energy -312.079414825
Pre-training layer 0, epoch 40, validation free energy -302.425460403
Pre-training layer 0, epoch 41, cost -72.8097307739
Pre-training layer 0, epoch 42, cost -72.8285817413
Pre-training layer 0, epoch 43, cost -72.6498342667
Pre-training layer 0, epoch 44, cost -72.5759535751
Pre-training layer 0, epoch 45, cost -72.5385089417
Pre-training layer 0, epoch 45, representative training free energy -309.442104996
Pre-training layer 0, epoch 45, validation free energy -299.191568878
Pre-training layer 0, epoch 46, cost -72.3822083969
Pre-training layer 0, epoch 47, cost -72.2602208786
Pre-training layer 0, epoch 48, cost -72.208418457
Pre-training layer 0, epoch 49, cost -72.1452086563
Pre-training layer 0, epoch 50, cost -72.139008667
Pre-training layer 0, epoch 50, representative training free energy -305.256251953
Pre-training layer 0, epoch 50, validation free energy -294.040848633
Pre-training layer 0, epoch 51, cost -71.9052104111
Pre-training layer 0, epoch 52, cost -71.9536620255
Pre-training layer 0, epoch 53, cost -71.8934486008
Pre-training layer 0, epoch 54, cost -71.7615859756
Pre-training layer 0, epoch 55, cost -71.7487932663
Pre-training layer 0, epoch 55, representative training free energy -301.610374817
Pre-training layer 0, epoch 55, validation free energy -291.231591171
Pre-training layer 0, epoch 56, cost -71.6202412338
Pre-training layer 0, epoch 57, cost -71.6013094788
Pre-training layer 0, epoch 58, cost -71.390587471
Pre-training layer 0, epoch 59, cost -71.4312683563
Pre-training layer 0, epoch 60, cost -71.3846153336
Pre-training layer 0, epoch 60, representative training free energy -300.459073914
Pre-training layer 0, epoch 60, validation free energy -290.769168854
Pre-training layer 0, epoch 61, cost -71.2825923843
Pre-training layer 0, epoch 62, cost -71.1343851929
Pre-training layer 0, epoch 63, cost -71.124444603
Pre-training layer 0, epoch 64, cost -71.1175155334
Pre-training layer 0, epoch 65, cost -71.0135072861
Pre-training layer 0, epoch 65, representative training free energy -296.390610199
Pre-training layer 0, epoch 65, validation free energy -285.654946869
Pre-training layer 0, epoch 66, cost -70.8764705505
Pre-training layer 0, epoch 67, cost -70.7975868301
Pre-training layer 0, epoch 68, cost -70.7485307465
Pre-training layer 0, epoch 69, cost -70.7672674255
Pre-training layer 0, epoch 70, cost -70.6673767395
Pre-training layer 0, epoch 70, representative training free energy -292.274939331
Pre-training layer 0, epoch 70, validation free energy -281.184087097
Pre-training layer 0, epoch 71, cost -70.6499670181
Pre-training layer 0, epoch 72, cost -70.5699139481
Pre-training layer 0, epoch 73, cost -70.5795096283
Pre-training layer 0, epoch 74, cost -70.5250810471
Pre-training layer 0, epoch 75, cost -70.4193573151
Pre-training layer 0, epoch 75, representative training free energy -286.975596481
Pre-training layer 0, epoch 75, validation free energy -275.229306152
Pre-training layer 0, epoch 76, cost -70.4724934616
Pre-training layer 0, epoch 77, cost -70.2970793839
Pre-training layer 0, epoch 78, cost -70.3288249969
Pre-training layer 0, epoch 79, cost -70.2761823578
Pre-training layer 0, epoch 80, cost -70.2421688843
Pre-training layer 0, epoch 80, representative training free energy -284.211358475
Pre-training layer 0, epoch 80, validation free energy -272.650003204
Pre-training layer 0, epoch 81, cost -70.1697923965
Pre-training layer 0, epoch 82, cost -70.1320177765
Pre-training layer 0, epoch 83, cost -70.0322593842
Pre-training layer 0, epoch 84, cost -69.9332796783
Pre-training layer 0, epoch 85, cost -70.0237082443
Pre-training layer 0, epoch 85, representative training free energy -282.886163528
Pre-training layer 0, epoch 85, validation free energy -271.117828766
Pre-training layer 0, epoch 86, cost -69.9502858276
Pre-training layer 0, epoch 87, cost -69.8865549316
Pre-training layer 0, epoch 88, cost -69.8207024384
Pre-training layer 0, epoch 89, cost -69.8888233795
Pre-training layer 0, epoch 90, cost -69.7892493973
Pre-training layer 0, epoch 90, representative training free energy -273.386406326
Pre-training layer 0, epoch 90, validation free energy -261.707317886
Pre-training layer 0, epoch 91, cost -69.72304245
Pre-training layer 0, epoch 92, cost -69.6949705582
Pre-training layer 0, epoch 93, cost -69.5904622498
Pre-training layer 0, epoch 94, cost -69.6165320587
Pre-training layer 0, epoch 95, cost -69.5231008835
Pre-training layer 0, epoch 95, representative training free energy -275.355232117
Pre-training layer 0, epoch 95, validation free energy -262.941593292
Pre-training layer 0, epoch 96, cost -69.5199773865
Pre-training layer 0, epoch 97, cost -69.4215975647
Pre-training layer 0, epoch 98, cost -69.4095989685
Pre-training layer 0, epoch 99, cost -69.3979085236
Pre-training layer 1, epoch 0, cost -174.32754306
Pre-training layer 1, epoch 0, representative training free energy -145931.999148
Pre-training layer 1, epoch 0, validation free energy -145242.466805
Pre-training layer 1, epoch 1, cost -144.233056961
Pre-training layer 1, epoch 2, cost -135.944747482
Pre-training layer 1, epoch 3, cost -131.299617752
Pre-training layer 1, epoch 4, cost -128.042203629
Pre-training layer 1, epoch 5, cost -125.970402039
Pre-training layer 1, epoch 5, representative training free energy -201113.882984
Pre-training layer 1, epoch 5, validation free energy -199993.024031
Pre-training layer 1, epoch 6, cost -124.110516876
Pre-training layer 1, epoch 7, cost -122.63778746
Pre-training layer 1, epoch 8, cost -121.525976471
Pre-training layer 1, epoch 9, cost -120.543211426
Pre-training layer 1, epoch 10, cost -119.749385208
Pre-training layer 1, epoch 10, representative training free energy -222680.575148
Pre-training layer 1, epoch 10, validation free energy -221417.731891
Pre-training layer 1, epoch 11, cost -119.025733505
Pre-training layer 1, epoch 12, cost -118.27944751
Pre-training layer 1, epoch 13, cost -117.670204163
Pre-training layer 1, epoch 14, cost -117.206336975
Pre-training layer 1, epoch 15, cost -116.665700073
Pre-training layer 1, epoch 15, representative training free energy -237245.296164
Pre-training layer 1, epoch 15, validation free energy -235905.677359
Pre-training layer 1, epoch 16, cost -116.373390411
Pre-training layer 1, epoch 17, cost -115.81519957
Pre-training layer 1, epoch 18, cost -115.517008057
Pre-training layer 1, epoch 19, cost -115.091130219
Pre-training layer 1, epoch 20, cost -114.827514923
Pre-training layer 1, epoch 20, representative training free energy -248279.06968
Pre-training layer 1, epoch 20, validation free energy -246878.432195
Pre-training layer 1, epoch 21, cost -114.384880981
Pre-training layer 1, epoch 22, cost -114.171435547
Pre-training layer 1, epoch 23, cost -113.942089752
Pre-training layer 1, epoch 24, cost -113.715195374
Pre-training layer 1, epoch 25, cost -113.379048492
Pre-training layer 1, epoch 25, representative training free energy -257535.758984
Pre-training layer 1, epoch 25, validation free energy -256076.448414
Pre-training layer 1, epoch 26, cost -113.115615768
Pre-training layer 1, epoch 27, cost -112.934631424
Pre-training layer 1, epoch 28, cost -112.869178314
Pre-training layer 1, epoch 29, cost -112.651565674
Pre-training layer 1, epoch 30, cost -112.397442581
Pre-training layer 1, epoch 30, representative training free energy -264864.506953
Pre-training layer 1, epoch 30, validation free energy -263387.128117
Pre-training layer 1, epoch 31, cost -112.230136795
Pre-training layer 1, epoch 32, cost -112.108893906
Pre-training layer 1, epoch 33, cost -111.842995667
Pre-training layer 1, epoch 34, cost -111.775737579
Pre-training layer 1, epoch 35, cost -111.686536545
Pre-training layer 1, epoch 35, representative training free energy -271210.332445
Pre-training layer 1, epoch 35, validation free energy -269631.669531
Pre-training layer 1, epoch 36, cost -111.494852631
Pre-training layer 1, epoch 37, cost -111.381002808
Pre-training layer 1, epoch 38, cost -111.235262207
Pre-training layer 1, epoch 39, cost -111.148977478
Pre-training layer 1, epoch 40, cost -110.972810104
Pre-training layer 1, epoch 40, representative training free energy -277305.54682
Pre-training layer 1, epoch 40, validation free energy -275742.842953
Pre-training layer 1, epoch 41, cost -110.93287793
Pre-training layer 1, epoch 42, cost -110.732921478
Pre-training layer 1, epoch 43, cost -110.695435654
Pre-training layer 1, epoch 44, cost -110.602316254
Pre-training layer 1, epoch 45, cost -110.407477737
Pre-training layer 1, epoch 45, representative training free energy -282443.770891
Pre-training layer 1, epoch 45, validation free energy -280816.638273
Pre-training layer 1, epoch 46, cost -110.430238144
Pre-training layer 1, epoch 47, cost -110.301115524
Pre-training layer 1, epoch 48, cost -110.215607437
Pre-training layer 1, epoch 49, cost -110.12734256
Pre-training layer 1, epoch 50, cost -109.941737747
Pre-training layer 1, epoch 50, representative training free energy -287039.087742
Pre-training layer 1, epoch 50, validation free energy -285368.135953
Pre-training layer 1, epoch 51, cost -109.903668091
Pre-training layer 1, epoch 52, cost -109.876312546
Pre-training layer 1, epoch 53, cost -109.801258438
Pre-training layer 1, epoch 54, cost -109.728820183
Pre-training layer 1, epoch 55, cost -109.709972321
Pre-training layer 1, epoch 55, representative training free energy -291115.786461
Pre-training layer 1, epoch 55, validation free energy -289490.752375
Pre-training layer 1, epoch 56, cost -109.61986911
Pre-training layer 1, epoch 57, cost -109.5788097
Pre-training layer 1, epoch 58, cost -109.496951859
Pre-training layer 1, epoch 59, cost -109.407372665
Pre-training layer 1, epoch 60, cost -109.331687653
Pre-training layer 1, epoch 60, representative training free energy -295578.809813
Pre-training layer 1, epoch 60, validation free energy -293876.881625
Pre-training layer 1, epoch 61, cost -109.349284004
Pre-training layer 1, epoch 62, cost -109.291728439
Pre-training layer 1, epoch 63, cost -109.194163391
Pre-training layer 1, epoch 64, cost -109.113592216
Pre-training layer 1, epoch 65, cost -109.039942497
Pre-training layer 1, epoch 65, representative training free energy -299230.801664
Pre-training layer 1, epoch 65, validation free energy -297526.71675
Pre-training layer 1, epoch 66, cost -108.992250702
Pre-training layer 1, epoch 67, cost -108.926966721
Pre-training layer 1, epoch 68, cost -108.963415146
Pre-training layer 1, epoch 69, cost -108.857767059
Pre-training layer 1, epoch 70, cost -108.857252831
Pre-training layer 1, epoch 70, representative training free energy -302552.652867
Pre-training layer 1, epoch 70, validation free energy -300779.540617
Pre-training layer 1, epoch 71, cost -108.783289467
Pre-training layer 1, epoch 72, cost -108.795107292
Pre-training layer 1, epoch 73, cost -108.786209549
Pre-training layer 1, epoch 74, cost -108.657257187
Pre-training layer 1, epoch 75, cost -108.662118668
Pre-training layer 1, epoch 75, representative training free energy -306014.107195
Pre-training layer 1, epoch 75, validation free energy -304250.893594
Pre-training layer 1, epoch 76, cost -108.566434471
Pre-training layer 1, epoch 77, cost -108.571889717
Pre-training layer 1, epoch 78, cost -108.570067871
Pre-training layer 1, epoch 79, cost -108.537212997
Pre-training layer 1, epoch 80, cost -108.478000259
Pre-training layer 1, epoch 80, representative training free energy -308743.094805
Pre-training layer 1, epoch 80, validation free energy -306963.332984
Pre-training layer 1, epoch 81, cost -108.408863808
Pre-training layer 1, epoch 82, cost -108.38388163
Pre-training layer 1, epoch 83, cost -108.338112671
Pre-training layer 1, epoch 84, cost -108.276521019
Pre-training layer 1, epoch 85, cost -108.276370293
Pre-training layer 1, epoch 85, representative training free energy -311601.037961
Pre-training layer 1, epoch 85, validation free energy -309790.16075
Pre-training layer 1, epoch 86, cost -108.272672379
Pre-training layer 1, epoch 87, cost -108.249157272
Pre-training layer 1, epoch 88, cost -108.216229759
Pre-training layer 1, epoch 89, cost -108.157775894
Pre-training layer 1, epoch 90, cost -108.090581535
Pre-training layer 1, epoch 90, representative training free energy -314005.116852
Pre-training layer 1, epoch 90, validation free energy -312198.060711
Pre-training layer 1, epoch 91, cost -108.079273376
Pre-training layer 1, epoch 92, cost -108.073115868
Pre-training layer 1, epoch 93, cost -108.045764801
Pre-training layer 1, epoch 94, cost -108.027970604
Pre-training layer 1, epoch 95, cost -107.964485359
Pre-training layer 1, epoch 95, representative training free energy -316589.248367
Pre-training layer 1, epoch 95, validation free energy -314757.765242
Pre-training layer 1, epoch 96, cost -107.999546249
Pre-training layer 1, epoch 97, cost -108.005704056
Pre-training layer 1, epoch 98, cost -107.905356117
Pre-training layer 1, epoch 99, cost -107.899286827
Pre-training layer 2, epoch 0, cost -100.577591507
Pre-training layer 2, epoch 0, representative training free energy 9002.02048755
Pre-training layer 2, epoch 0, validation free energy 8891.47657935
Pre-training layer 2, epoch 1, cost -77.7218102417
Pre-training layer 2, epoch 2, cost -72.4340526505
Pre-training layer 2, epoch 3, cost -69.4544554214
Pre-training layer 2, epoch 4, cost -67.6583713379
Pre-training layer 2, epoch 5, cost -66.2062002792
Pre-training layer 2, epoch 5, representative training free energy 19894.7664321
Pre-training layer 2, epoch 5, validation free energy 19743.6173096
Pre-training layer 2, epoch 6, cost -65.210196434
Pre-training layer 2, epoch 7, cost -64.3415352097
Pre-training layer 2, epoch 8, cost -63.7280368195
Pre-training layer 2, epoch 9, cost -63.0607585602
Pre-training layer 2, epoch 10, cost -62.5204208221
Pre-training layer 2, epoch 10, representative training free energy 28129.9331807
Pre-training layer 2, epoch 10, validation free energy 27943.6483105
Pre-training layer 2, epoch 11, cost -62.2056145477
Pre-training layer 2, epoch 12, cost -61.8332318497
Pre-training layer 2, epoch 13, cost -61.4299926376
Pre-training layer 2, epoch 14, cost -61.1284087677
Pre-training layer 2, epoch 15, cost -60.8833077545
Pre-training layer 2, epoch 15, representative training free energy 34617.0220957
Pre-training layer 2, epoch 15, validation free energy 34395.5283828
Pre-training layer 2, epoch 16, cost -60.6361761246
Pre-training layer 2, epoch 17, cost -60.3387699203
Pre-training layer 2, epoch 18, cost -60.2014474335
Pre-training layer 2, epoch 19, cost -59.9209458542
Pre-training layer 2, epoch 20, cost -59.8401896667
Pre-training layer 2, epoch 20, representative training free energy 39915.6792051
Pre-training layer 2, epoch 20, validation free energy 39673.8247832
Pre-training layer 2, epoch 21, cost -59.5990013428
Pre-training layer 2, epoch 22, cost -59.3569987488
Pre-training layer 2, epoch 23, cost -59.3433781662
Pre-training layer 2, epoch 24, cost -59.1412810516
Pre-training layer 2, epoch 25, cost -58.9946544037
Pre-training layer 2, epoch 25, representative training free energy 44225.0976475
Pre-training layer 2, epoch 25, validation free energy 43964.951999
Pre-training layer 2, epoch 26, cost -58.88028582
Pre-training layer 2, epoch 27, cost -58.7871400681
Pre-training layer 2, epoch 28, cost -58.614528717
Pre-training layer 2, epoch 29, cost -58.571459053
Pre-training layer 2, epoch 30, cost -58.4244783173
Pre-training layer 2, epoch 30, representative training free energy 48324.4364316
Pre-training layer 2, epoch 30, validation free energy 48041.340915
Pre-training layer 2, epoch 31, cost -58.3516826019
Pre-training layer 2, epoch 32, cost -58.2720112228
Pre-training layer 2, epoch 33, cost -58.1165940704
Pre-training layer 2, epoch 34, cost -58.0529621506
Pre-training layer 2, epoch 35, cost -58.0229518433
Pre-training layer 2, epoch 35, representative training free energy 51969.0813848
Pre-training layer 2, epoch 35, validation free energy 51678.0271309
Pre-training layer 2, epoch 36, cost -57.9422770386
Pre-training layer 2, epoch 37, cost -57.7964967651
Pre-training layer 2, epoch 38, cost -57.7538514252
Pre-training layer 2, epoch 39, cost -57.6841779251
Pre-training layer 2, epoch 40, cost -57.6026331253
Pre-training layer 2, epoch 40, representative training free energy 55664.8701133
Pre-training layer 2, epoch 40, validation free energy 55353.5652695
Pre-training layer 2, epoch 41, cost -57.5173676682
Pre-training layer 2, epoch 42, cost -57.4562197037
Pre-training layer 2, epoch 43, cost -57.4462262955
Pre-training layer 2, epoch 44, cost -57.3525365219
Pre-training layer 2, epoch 45, cost -57.3005122681
Pre-training layer 2, epoch 45, representative training free energy 58209.1949941
Pre-training layer 2, epoch 45, validation free energy 57896.0550742
Pre-training layer 2, epoch 46, cost -57.2203506622
Pre-training layer 2, epoch 47, cost -57.1974353256
Pre-training layer 2, epoch 48, cost -57.1388039932
Pre-training layer 2, epoch 49, cost -57.1148434525
Pre-training layer 2, epoch 50, cost -57.0751884918
Pre-training layer 2, epoch 50, representative training free energy 60851.0523125
Pre-training layer 2, epoch 50, validation free energy 60517.9725313
Pre-training layer 2, epoch 51, cost -56.9937992935
Pre-training layer 2, epoch 52, cost -56.9142608261
Pre-training layer 2, epoch 53, cost -56.9045254669
Pre-training layer 2, epoch 54, cost -56.8301683121
Pre-training layer 2, epoch 55, cost -56.7841066971
Pre-training layer 2, epoch 55, representative training free energy 63685.8147578
Pre-training layer 2, epoch 55, validation free energy 63334.8992754
Pre-training layer 2, epoch 56, cost -56.797197258
Pre-training layer 2, epoch 57, cost -56.7716604385
Pre-training layer 2, epoch 58, cost -56.6672946854
Pre-training layer 2, epoch 59, cost -56.6690753555
Pre-training layer 2, epoch 60, cost -56.5943014145
Pre-training layer 2, epoch 60, representative training free energy 66359.3810586
Pre-training layer 2, epoch 60, validation free energy 66002.5095371
Pre-training layer 2, epoch 61, cost -56.5185442352
Pre-training layer 2, epoch 62, cost -56.479336235
Pre-training layer 2, epoch 63, cost -56.4973868256
Pre-training layer 2, epoch 64, cost -56.4526441498
Pre-training layer 2, epoch 65, cost -56.3957056046
Pre-training layer 2, epoch 65, representative training free energy 68046.2557012
Pre-training layer 2, epoch 65, validation free energy 67683.4845879
Pre-training layer 2, epoch 66, cost -56.3208917999
Pre-training layer 2, epoch 67, cost -56.3956464081
Pre-training layer 2, epoch 68, cost -56.3331902084
Pre-training layer 2, epoch 69, cost -56.3246191559
Pre-training layer 2, epoch 70, cost -56.271072998
Pre-training layer 2, epoch 70, representative training free energy 70634.9358555
Pre-training layer 2, epoch 70, validation free energy 70260.4999727
Pre-training layer 2, epoch 71, cost -56.2319972839
Pre-training layer 2, epoch 72, cost -56.2044814072
Pre-training layer 2, epoch 73, cost -56.2123126144
Pre-training layer 2, epoch 74, cost -56.1404889679
Pre-training layer 2, epoch 75, cost -56.0584284821
Pre-training layer 2, epoch 75, representative training free energy 72706.5959434
Pre-training layer 2, epoch 75, validation free energy 72325.06925
Pre-training layer 2, epoch 76, cost -56.0814257812
Pre-training layer 2, epoch 77, cost -56.0219143295
Pre-training layer 2, epoch 78, cost -56.0030112534
Pre-training layer 2, epoch 79, cost -55.9779144363
Pre-training layer 2, epoch 80, cost -56.0214111633
Pre-training layer 2, epoch 80, representative training free energy 74159.6444043
Pre-training layer 2, epoch 80, validation free energy 73765.8900801
Pre-training layer 2, epoch 81, cost -55.9835862274
Pre-training layer 2, epoch 82, cost -55.8195396652
Pre-training layer 2, epoch 83, cost -55.9126886444
Pre-training layer 2, epoch 84, cost -55.9348448944
Pre-training layer 2, epoch 85, cost -55.8805129776
Pre-training layer 2, epoch 85, representative training free energy 76445.3037539
Pre-training layer 2, epoch 85, validation free energy 76040.642543
Pre-training layer 2, epoch 86, cost -55.7796113815
Pre-training layer 2, epoch 87, cost -55.8188098297
Pre-training layer 2, epoch 88, cost -55.7702746429
Pre-training layer 2, epoch 89, cost -55.7959490967
Pre-training layer 2, epoch 90, cost -55.7231823959
Pre-training layer 2, epoch 90, representative training free energy 78046.2636289
Pre-training layer 2, epoch 90, validation free energy 77633.3016602
Pre-training layer 2, epoch 91, cost -55.652249855
Pre-training layer 2, epoch 92, cost -55.7875354233
Pre-training layer 2, epoch 93, cost -55.648597168
Pre-training layer 2, epoch 94, cost -55.7234879074
Pre-training layer 2, epoch 95, cost -55.5968557892
Pre-training layer 2, epoch 95, representative training free energy 79773.7069297
Pre-training layer 2, epoch 95, validation free energy 79346.3118262
Pre-training layer 2, epoch 96, cost -55.635594635
Pre-training layer 2, epoch 97, cost -55.5924338684
Pre-training layer 2, epoch 98, cost -55.608996933
Pre-training layer 2, epoch 99, cost -55.5383101654
The pretraining code for file dbn_loop.pyc ran for 4.66m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 15.700000 %
     epoch 1, minibatch 500/500, test error of best model 15.700000 %
epoch 2, minibatch 500/500, validation error 10.500000 %
     epoch 2, minibatch 500/500, test error of best model 10.100000 %
epoch 3, minibatch 500/500, validation error 9.100000 %
     epoch 3, minibatch 500/500, test error of best model 7.400000 %
epoch 4, minibatch 500/500, validation error 7.600000 %
     epoch 4, minibatch 500/500, test error of best model 6.100000 %
epoch 5, minibatch 500/500, validation error 6.800000 %
     epoch 5, minibatch 500/500, test error of best model 5.600000 %
epoch 6, minibatch 500/500, validation error 6.600000 %
     epoch 6, minibatch 500/500, test error of best model 5.100000 %
epoch 7, minibatch 500/500, validation error 6.200000 %
     epoch 7, minibatch 500/500, test error of best model 4.700000 %
epoch 8, minibatch 500/500, validation error 5.900000 %
     epoch 8, minibatch 500/500, test error of best model 4.500000 %
epoch 9, minibatch 500/500, validation error 5.400000 %
     epoch 9, minibatch 500/500, test error of best model 4.300000 %
epoch 10, minibatch 500/500, validation error 5.500000 %
epoch 11, minibatch 500/500, validation error 5.500000 %
epoch 12, minibatch 500/500, validation error 5.400000 %
     epoch 12, minibatch 500/500, test error of best model 4.000000 %
epoch 13, minibatch 500/500, validation error 5.300000 %
     epoch 13, minibatch 500/500, test error of best model 3.900000 %
epoch 14, minibatch 500/500, validation error 5.100000 %
     epoch 14, minibatch 500/500, test error of best model 3.800000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
epoch 16, minibatch 500/500, validation error 5.200000 %
epoch 17, minibatch 500/500, validation error 5.200000 %
epoch 18, minibatch 500/500, validation error 5.200000 %
epoch 19, minibatch 500/500, validation error 5.100000 %
epoch 20, minibatch 500/500, validation error 5.100000 %
epoch 21, minibatch 500/500, validation error 5.100000 %
epoch 22, minibatch 500/500, validation error 5.100000 %
epoch 23, minibatch 500/500, validation error 5.200000 %
epoch 24, minibatch 500/500, validation error 5.200000 %
epoch 25, minibatch 500/500, validation error 5.200000 %
epoch 26, minibatch 500/500, validation error 5.100000 %
epoch 27, minibatch 500/500, validation error 5.100000 %
Optimization complete with best validation score of 5.100000 %, obtained at iteration 7000, with test performance 3.800000 %
The fine tuning code for file dbn_loop.pyc ran for 0.57m


==========Layers: [1000, 1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -121.000237717
Pre-training layer 0, epoch 0, representative training free energy -409.345304108
Pre-training layer 0, epoch 0, validation free energy -402.431249329
Pre-training layer 0, epoch 1, cost -96.6582617035
Pre-training layer 0, epoch 2, cost -91.0289542084
Pre-training layer 0, epoch 3, cost -87.7293145828
Pre-training layer 0, epoch 4, cost -85.7052027817
Pre-training layer 0, epoch 5, cost -84.2831273346
Pre-training layer 0, epoch 5, representative training free energy -349.190262665
Pre-training layer 0, epoch 5, validation free energy -343.162598602
Pre-training layer 0, epoch 6, cost -82.870505928
Pre-training layer 0, epoch 7, cost -81.9534944153
Pre-training layer 0, epoch 8, cost -81.1819410706
Pre-training layer 0, epoch 9, cost -80.4778519363
Pre-training layer 0, epoch 10, cost -79.8940945358
Pre-training layer 0, epoch 10, representative training free energy -340.278464874
Pre-training layer 0, epoch 10, validation free energy -333.95686673
Pre-training layer 0, epoch 11, cost -79.2210384598
Pre-training layer 0, epoch 12, cost -78.7112079163
Pre-training layer 0, epoch 13, cost -78.3841279449
Pre-training layer 0, epoch 14, cost -78.0319431458
Pre-training layer 0, epoch 15, cost -77.6799460297
Pre-training layer 0, epoch 15, representative training free energy -339.009838272
Pre-training layer 0, epoch 15, validation free energy -330.413671616
Pre-training layer 0, epoch 16, cost -77.3202919464
Pre-training layer 0, epoch 17, cost -76.9392658234
Pre-training layer 0, epoch 18, cost -76.7519373703
Pre-training layer 0, epoch 19, cost -76.4895905762
Pre-training layer 0, epoch 20, cost -76.1671491547
Pre-training layer 0, epoch 20, representative training free energy -330.322922653
Pre-training layer 0, epoch 20, validation free energy -321.799309189
Pre-training layer 0, epoch 21, cost -76.004928833
Pre-training layer 0, epoch 22, cost -75.6447913666
Pre-training layer 0, epoch 23, cost -75.5933475266
Pre-training layer 0, epoch 24, cost -75.4325131989
Pre-training layer 0, epoch 25, cost -75.0523862381
Pre-training layer 0, epoch 25, representative training free energy -326.312599884
Pre-training layer 0, epoch 25, validation free energy -317.467039902
Pre-training layer 0, epoch 26, cost -74.8990716171
Pre-training layer 0, epoch 27, cost -74.7651782303
Pre-training layer 0, epoch 28, cost -74.5780256348
Pre-training layer 0, epoch 29, cost -74.4448541946
Pre-training layer 0, epoch 30, cost -74.2566546326
Pre-training layer 0, epoch 30, representative training free energy -323.490507904
Pre-training layer 0, epoch 30, validation free energy -313.781144104
Pre-training layer 0, epoch 31, cost -74.0424127426
Pre-training layer 0, epoch 32, cost -73.9347856522
Pre-training layer 0, epoch 33, cost -73.7574673004
Pre-training layer 0, epoch 34, cost -73.6577932358
Pre-training layer 0, epoch 35, cost -73.5502228394
Pre-training layer 0, epoch 35, representative training free energy -320.569240356
Pre-training layer 0, epoch 35, validation free energy -310.12747081
Pre-training layer 0, epoch 36, cost -73.4567540054
Pre-training layer 0, epoch 37, cost -73.3343876572
Pre-training layer 0, epoch 38, cost -73.2168173676
Pre-training layer 0, epoch 39, cost -73.1907236938
Pre-training layer 0, epoch 40, cost -73.0105397949
Pre-training layer 0, epoch 40, representative training free energy -313.995591125
Pre-training layer 0, epoch 40, validation free energy -304.253771347
Pre-training layer 0, epoch 41, cost -72.979481369
Pre-training layer 0, epoch 42, cost -72.8262364273
Pre-training layer 0, epoch 43, cost -72.7036261902
Pre-training layer 0, epoch 44, cost -72.566109848
Pre-training layer 0, epoch 45, cost -72.6286835632
Pre-training layer 0, epoch 45, representative training free energy -310.116132233
Pre-training layer 0, epoch 45, validation free energy -299.458217529
Pre-training layer 0, epoch 46, cost -72.4218840942
Pre-training layer 0, epoch 47, cost -72.3435790863
Pre-training layer 0, epoch 48, cost -72.222819809
Pre-training layer 0, epoch 49, cost -72.1575576096
Pre-training layer 0, epoch 50, cost -72.0958911896
Pre-training layer 0, epoch 50, representative training free energy -304.484023972
Pre-training layer 0, epoch 50, validation free energy -294.423681946
Pre-training layer 0, epoch 51, cost -72.0122585297
Pre-training layer 0, epoch 52, cost -71.8718241272
Pre-training layer 0, epoch 53, cost -71.8727851105
Pre-training layer 0, epoch 54, cost -71.8630823441
Pre-training layer 0, epoch 55, cost -71.589343956
Pre-training layer 0, epoch 55, representative training free energy -306.454438034
Pre-training layer 0, epoch 55, validation free energy -294.841471588
Pre-training layer 0, epoch 56, cost -71.7502309799
Pre-training layer 0, epoch 57, cost -71.7037711029
Pre-training layer 0, epoch 58, cost -71.5197081833
Pre-training layer 0, epoch 59, cost -71.4254113998
Pre-training layer 0, epoch 60, cost -71.443597908
Pre-training layer 0, epoch 60, representative training free energy -300.253478241
Pre-training layer 0, epoch 60, validation free energy -289.322019577
Pre-training layer 0, epoch 61, cost -71.2885618515
Pre-training layer 0, epoch 62, cost -71.2611028748
Pre-training layer 0, epoch 63, cost -71.1953556061
Pre-training layer 0, epoch 64, cost -71.0909020767
Pre-training layer 0, epoch 65, cost -71.005192688
Pre-training layer 0, epoch 65, representative training free energy -298.77542038
Pre-training layer 0, epoch 65, validation free energy -286.413160904
Pre-training layer 0, epoch 66, cost -71.0213659744
Pre-training layer 0, epoch 67, cost -70.9708418045
Pre-training layer 0, epoch 68, cost -70.9454070358
Pre-training layer 0, epoch 69, cost -70.8195870972
Pre-training layer 0, epoch 70, cost -70.6913518829
Pre-training layer 0, epoch 70, representative training free energy -294.305974197
Pre-training layer 0, epoch 70, validation free energy -282.362068069
Pre-training layer 0, epoch 71, cost -70.7746674118
Pre-training layer 0, epoch 72, cost -70.6220016479
Pre-training layer 0, epoch 73, cost -70.6771946259
Pre-training layer 0, epoch 74, cost -70.5792365494
Pre-training layer 0, epoch 75, cost -70.3722035141
Pre-training layer 0, epoch 75, representative training free energy -289.505828857
Pre-training layer 0, epoch 75, validation free energy -278.040864594
Pre-training layer 0, epoch 76, cost -70.4460545502
Pre-training layer 0, epoch 77, cost -70.4241491318
Pre-training layer 0, epoch 78, cost -70.404069519
Pre-training layer 0, epoch 79, cost -70.2874340439
Pre-training layer 0, epoch 80, cost -70.289918045
Pre-training layer 0, epoch 80, representative training free energy -287.764512299
Pre-training layer 0, epoch 80, validation free energy -275.098682587
Pre-training layer 0, epoch 81, cost -70.2042373123
Pre-training layer 0, epoch 82, cost -70.1822724686
Pre-training layer 0, epoch 83, cost -70.0914856033
Pre-training layer 0, epoch 84, cost -70.124783371
Pre-training layer 0, epoch 85, cost -69.9569640503
Pre-training layer 0, epoch 85, representative training free energy -283.819534424
Pre-training layer 0, epoch 85, validation free energy -271.328485229
Pre-training layer 0, epoch 86, cost -69.9675221634
Pre-training layer 0, epoch 87, cost -69.9067036514
Pre-training layer 0, epoch 88, cost -69.7581462631
Pre-training layer 0, epoch 89, cost -69.7680445862
Pre-training layer 0, epoch 90, cost -69.7126754456
Pre-training layer 0, epoch 90, representative training free energy -281.65344072
Pre-training layer 0, epoch 90, validation free energy -268.530441101
Pre-training layer 0, epoch 91, cost -69.816492897
Pre-training layer 0, epoch 92, cost -69.7053148422
Pre-training layer 0, epoch 93, cost -69.6662150803
Pre-training layer 0, epoch 94, cost -69.700756279
Pre-training layer 0, epoch 95, cost -69.5977209244
Pre-training layer 0, epoch 95, representative training free energy -274.813920395
Pre-training layer 0, epoch 95, validation free energy -262.799985062
Pre-training layer 0, epoch 96, cost -69.5945466309
Pre-training layer 0, epoch 97, cost -69.5504958801
Pre-training layer 0, epoch 98, cost -69.4329773788
Pre-training layer 0, epoch 99, cost -69.5240323029
Pre-training layer 1, epoch 0, cost -172.517643906
Pre-training layer 1, epoch 0, representative training free energy -146502.709152
Pre-training layer 1, epoch 0, validation free energy -145521.697375
Pre-training layer 1, epoch 1, cost -142.458404678
Pre-training layer 1, epoch 2, cost -134.222806061
Pre-training layer 1, epoch 3, cost -129.561209183
Pre-training layer 1, epoch 4, cost -126.520568161
Pre-training layer 1, epoch 5, cost -124.155917374
Pre-training layer 1, epoch 5, representative training free energy -201067.542719
Pre-training layer 1, epoch 5, validation free energy -199565.353633
Pre-training layer 1, epoch 6, cost -122.553180756
Pre-training layer 1, epoch 7, cost -121.146183029
Pre-training layer 1, epoch 8, cost -119.966162308
Pre-training layer 1, epoch 9, cost -118.999117081
Pre-training layer 1, epoch 10, cost -118.170756226
Pre-training layer 1, epoch 10, representative training free energy -222369.025312
Pre-training layer 1, epoch 10, validation free energy -220698.85357
Pre-training layer 1, epoch 11, cost -117.449405655
Pre-training layer 1, epoch 12, cost -116.76406926
Pre-training layer 1, epoch 13, cost -116.215533112
Pre-training layer 1, epoch 14, cost -115.67432254
Pre-training layer 1, epoch 15, cost -115.262602325
Pre-training layer 1, epoch 15, representative training free energy -236798.643
Pre-training layer 1, epoch 15, validation free energy -234968.057594
Pre-training layer 1, epoch 16, cost -114.723955307
Pre-training layer 1, epoch 17, cost -114.442295959
Pre-training layer 1, epoch 18, cost -113.881104767
Pre-training layer 1, epoch 19, cost -113.603840759
Pre-training layer 1, epoch 20, cost -113.257850555
Pre-training layer 1, epoch 20, representative training free energy -247511.12618
Pre-training layer 1, epoch 20, validation free energy -245575.359383
Pre-training layer 1, epoch 21, cost -112.949636627
Pre-training layer 1, epoch 22, cost -112.81439357
Pre-training layer 1, epoch 23, cost -112.407006851
Pre-training layer 1, epoch 24, cost -112.182042801
Pre-training layer 1, epoch 25, cost -112.033752701
Pre-training layer 1, epoch 25, representative training free energy -256767.568445
Pre-training layer 1, epoch 25, validation free energy -254726.436414
Pre-training layer 1, epoch 26, cost -111.714095291
Pre-training layer 1, epoch 27, cost -111.535675797
Pre-training layer 1, epoch 28, cost -111.342999817
Pre-training layer 1, epoch 29, cost -111.152664169
Pre-training layer 1, epoch 30, cost -110.929700714
Pre-training layer 1, epoch 30, representative training free energy -264008.062695
Pre-training layer 1, epoch 30, validation free energy -261889.357164
Pre-training layer 1, epoch 31, cost -110.764651917
Pre-training layer 1, epoch 32, cost -110.663649673
Pre-training layer 1, epoch 33, cost -110.495877686
Pre-training layer 1, epoch 34, cost -110.367117996
Pre-training layer 1, epoch 35, cost -110.367199265
Pre-training layer 1, epoch 35, representative training free energy -270785.28707
Pre-training layer 1, epoch 35, validation free energy -268622.057266
Pre-training layer 1, epoch 36, cost -110.068114716
Pre-training layer 1, epoch 37, cost -110.028764221
Pre-training layer 1, epoch 38, cost -109.889210831
Pre-training layer 1, epoch 39, cost -109.747195557
Pre-training layer 1, epoch 40, cost -109.545757584
Pre-training layer 1, epoch 40, representative training free energy -276353.163539
Pre-training layer 1, epoch 40, validation free energy -274189.549813
Pre-training layer 1, epoch 41, cost -109.374823135
Pre-training layer 1, epoch 42, cost -109.351953049
Pre-training layer 1, epoch 43, cost -109.259797012
Pre-training layer 1, epoch 44, cost -109.151011276
Pre-training layer 1, epoch 45, cost -109.042615417
Pre-training layer 1, epoch 45, representative training free energy -281480.3215
Pre-training layer 1, epoch 45, validation free energy -279224.627383
Pre-training layer 1, epoch 46, cost -108.940313217
Pre-training layer 1, epoch 47, cost -108.878160095
Pre-training layer 1, epoch 48, cost -108.799091492
Pre-training layer 1, epoch 49, cost -108.766347626
Pre-training layer 1, epoch 50, cost -108.722566818
Pre-training layer 1, epoch 50, representative training free energy -286098.028188
Pre-training layer 1, epoch 50, validation free energy -283798.908977
Pre-training layer 1, epoch 51, cost -108.610437744
Pre-training layer 1, epoch 52, cost -108.618883575
Pre-training layer 1, epoch 53, cost -108.486939362
Pre-training layer 1, epoch 54, cost -108.344572952
Pre-training layer 1, epoch 55, cost -108.261274734
Pre-training layer 1, epoch 55, representative training free energy -290330.119273
Pre-training layer 1, epoch 55, validation free energy -288011.305047
Pre-training layer 1, epoch 56, cost -108.247618607
Pre-training layer 1, epoch 57, cost -108.184284096
Pre-training layer 1, epoch 58, cost -108.103997902
Pre-training layer 1, epoch 59, cost -107.985589951
Pre-training layer 1, epoch 60, cost -107.97987706
Pre-training layer 1, epoch 60, representative training free energy -294596.609695
Pre-training layer 1, epoch 60, validation free energy -292263.359586
Pre-training layer 1, epoch 61, cost -107.955819199
Pre-training layer 1, epoch 62, cost -107.826146797
Pre-training layer 1, epoch 63, cost -107.807612244
Pre-training layer 1, epoch 64, cost -107.787397217
Pre-training layer 1, epoch 65, cost -107.737469681
Pre-training layer 1, epoch 65, representative training free energy -298373.022094
Pre-training layer 1, epoch 65, validation free energy -295973.728164
Pre-training layer 1, epoch 66, cost -107.667851807
Pre-training layer 1, epoch 67, cost -107.641775162
Pre-training layer 1, epoch 68, cost -107.53860511
Pre-training layer 1, epoch 69, cost -107.518598221
Pre-training layer 1, epoch 70, cost -107.47293103
Pre-training layer 1, epoch 70, representative training free energy -301370.463781
Pre-training layer 1, epoch 70, validation free energy -298938.175477
Pre-training layer 1, epoch 71, cost -107.408686111
Pre-training layer 1, epoch 72, cost -107.461006577
Pre-training layer 1, epoch 73, cost -107.29157383
Pre-training layer 1, epoch 74, cost -107.291047333
Pre-training layer 1, epoch 75, cost -107.258620468
Pre-training layer 1, epoch 75, representative training free energy -304922.51025
Pre-training layer 1, epoch 75, validation free energy -302424.087109
Pre-training layer 1, epoch 76, cost -107.181418884
Pre-training layer 1, epoch 77, cost -107.199916016
Pre-training layer 1, epoch 78, cost -107.132311394
Pre-training layer 1, epoch 79, cost -107.079892273
Pre-training layer 1, epoch 80, cost -107.002284576
Pre-training layer 1, epoch 80, representative training free energy -307961.369891
Pre-training layer 1, epoch 80, validation free energy -305466.689609
Pre-training layer 1, epoch 81, cost -107.005486427
Pre-training layer 1, epoch 82, cost -106.950118172
Pre-training layer 1, epoch 83, cost -106.988471603
Pre-training layer 1, epoch 84, cost -106.896909767
Pre-training layer 1, epoch 85, cost -106.953857147
Pre-training layer 1, epoch 85, representative training free energy -310737.280219
Pre-training layer 1, epoch 85, validation free energy -308172.242977
Pre-training layer 1, epoch 86, cost -106.928352676
Pre-training layer 1, epoch 87, cost -106.783789108
Pre-training layer 1, epoch 88, cost -106.775098579
Pre-training layer 1, epoch 89, cost -106.808200272
Pre-training layer 1, epoch 90, cost -106.743130486
Pre-training layer 1, epoch 90, representative training free energy -313324.843047
Pre-training layer 1, epoch 90, validation free energy -310784.956281
Pre-training layer 1, epoch 91, cost -106.705463272
Pre-training layer 1, epoch 92, cost -106.770036667
Pre-training layer 1, epoch 93, cost -106.679528458
Pre-training layer 1, epoch 94, cost -106.597736053
Pre-training layer 1, epoch 95, cost -106.545348007
Pre-training layer 1, epoch 95, representative training free energy -316139.253445
Pre-training layer 1, epoch 95, validation free energy -313583.976008
Pre-training layer 1, epoch 96, cost -106.517161842
Pre-training layer 1, epoch 97, cost -106.581561432
Pre-training layer 1, epoch 98, cost -106.571174973
Pre-training layer 1, epoch 99, cost -106.499019547
Pre-training layer 2, epoch 0, cost -100.791490509
Pre-training layer 2, epoch 0, representative training free energy 9101.37957007
Pre-training layer 2, epoch 0, validation free energy 8997.28925586
Pre-training layer 2, epoch 1, cost -77.8717869492
Pre-training layer 2, epoch 2, cost -72.4104541321
Pre-training layer 2, epoch 3, cost -69.4728229218
Pre-training layer 2, epoch 4, cost -67.5107017441
Pre-training layer 2, epoch 5, cost -66.2401408081
Pre-training layer 2, epoch 5, representative training free energy 19946.3355151
Pre-training layer 2, epoch 5, validation free energy 19751.1062007
Pre-training layer 2, epoch 6, cost -65.1516147995
Pre-training layer 2, epoch 7, cost -64.289550354
Pre-training layer 2, epoch 8, cost -63.6004664993
Pre-training layer 2, epoch 9, cost -63.0505637131
Pre-training layer 2, epoch 10, cost -62.4704738617
Pre-training layer 2, epoch 10, representative training free energy 28225.1979922
Pre-training layer 2, epoch 10, validation free energy 27954.3593379
Pre-training layer 2, epoch 11, cost -62.0878444519
Pre-training layer 2, epoch 12, cost -61.7185477524
Pre-training layer 2, epoch 13, cost -61.3797260666
Pre-training layer 2, epoch 14, cost -61.1110674438
Pre-training layer 2, epoch 15, cost -60.8112989349
Pre-training layer 2, epoch 15, representative training free energy 34155.4994941
Pre-training layer 2, epoch 15, validation free energy 33834.5381113
Pre-training layer 2, epoch 16, cost -60.5419481888
Pre-training layer 2, epoch 17, cost -60.398123848
Pre-training layer 2, epoch 18, cost -60.1687527771
Pre-training layer 2, epoch 19, cost -59.8862712479
Pre-training layer 2, epoch 20, cost -59.7666170044
Pre-training layer 2, epoch 20, representative training free energy 39144.5895381
Pre-training layer 2, epoch 20, validation free energy 38791.4502852
Pre-training layer 2, epoch 21, cost -59.5590355988
Pre-training layer 2, epoch 22, cost -59.510901619
Pre-training layer 2, epoch 23, cost -59.2782131119
Pre-training layer 2, epoch 24, cost -59.0824676437
Pre-training layer 2, epoch 25, cost -59.0147545547
Pre-training layer 2, epoch 25, representative training free energy 43842.1023672
Pre-training layer 2, epoch 25, validation free energy 43449.164085
Pre-training layer 2, epoch 26, cost -58.8919826813
Pre-training layer 2, epoch 27, cost -58.8262714081
Pre-training layer 2, epoch 28, cost -58.610530838
Pre-training layer 2, epoch 29, cost -58.529624939
Pre-training layer 2, epoch 30, cost -58.38587043
Pre-training layer 2, epoch 30, representative training free energy 47701.7403301
Pre-training layer 2, epoch 30, validation free energy 47272.7948809
Pre-training layer 2, epoch 31, cost -58.3575985336
Pre-training layer 2, epoch 32, cost -58.2236279678
Pre-training layer 2, epoch 33, cost -58.2072411346
Pre-training layer 2, epoch 34, cost -58.0568588791
Pre-training layer 2, epoch 35, cost -57.9939268188
Pre-training layer 2, epoch 35, representative training free energy 51213.5276719
Pre-training layer 2, epoch 35, validation free energy 50763.1828301
Pre-training layer 2, epoch 36, cost -57.9372208786
Pre-training layer 2, epoch 37, cost -57.7926180573
Pre-training layer 2, epoch 38, cost -57.6871952515
Pre-training layer 2, epoch 39, cost -57.6978934555
Pre-training layer 2, epoch 40, cost -57.6021495667
Pre-training layer 2, epoch 40, representative training free energy 54205.8384258
Pre-training layer 2, epoch 40, validation free energy 53732.1596582
Pre-training layer 2, epoch 41, cost -57.678894043
Pre-training layer 2, epoch 42, cost -57.5759637527
Pre-training layer 2, epoch 43, cost -57.4399527817
Pre-training layer 2, epoch 44, cost -57.3456169662
Pre-training layer 2, epoch 45, cost -57.3201569901
Pre-training layer 2, epoch 45, representative training free energy 56997.9074707
Pre-training layer 2, epoch 45, validation free energy 56509.0549102
Pre-training layer 2, epoch 46, cost -57.2391977768
Pre-training layer 2, epoch 47, cost -57.1950842361
Pre-training layer 2, epoch 48, cost -57.2152974625
Pre-training layer 2, epoch 49, cost -57.1290831299
Pre-training layer 2, epoch 50, cost -57.0685388107
Pre-training layer 2, epoch 50, representative training free energy 59347.6644766
Pre-training layer 2, epoch 50, validation free energy 58839.4828672
Pre-training layer 2, epoch 51, cost -57.0509473419
Pre-training layer 2, epoch 52, cost -56.9585069427
Pre-training layer 2, epoch 53, cost -56.9420631027
Pre-training layer 2, epoch 54, cost -56.8773576584
Pre-training layer 2, epoch 55, cost -56.8301012039
Pre-training layer 2, epoch 55, representative training free energy 62191.0466289
Pre-training layer 2, epoch 55, validation free energy 61661.2161211
Pre-training layer 2, epoch 56, cost -56.7899444504
Pre-training layer 2, epoch 57, cost -56.7226609039
Pre-training layer 2, epoch 58, cost -56.6854617996
Pre-training layer 2, epoch 59, cost -56.6480968399
Pre-training layer 2, epoch 60, cost -56.6319203796
Pre-training layer 2, epoch 60, representative training free energy 64577.9635781
Pre-training layer 2, epoch 60, validation free energy 64023.7116445
Pre-training layer 2, epoch 61, cost -56.5814294586
Pre-training layer 2, epoch 62, cost -56.5660061722
Pre-training layer 2, epoch 63, cost -56.5797526932
Pre-training layer 2, epoch 64, cost -56.4686403503
Pre-training layer 2, epoch 65, cost -56.4520202713
Pre-training layer 2, epoch 65, representative training free energy 66807.345541
Pre-training layer 2, epoch 65, validation free energy 66250.4954336
Pre-training layer 2, epoch 66, cost -56.4552056427
Pre-training layer 2, epoch 67, cost -56.4383730164
Pre-training layer 2, epoch 68, cost -56.3561891937
Pre-training layer 2, epoch 69, cost -56.3298144531
Pre-training layer 2, epoch 70, cost -56.3394552231
Pre-training layer 2, epoch 70, representative training free energy 68809.5952344
Pre-training layer 2, epoch 70, validation free energy 68234.0868457
Pre-training layer 2, epoch 71, cost -56.2511609802
Pre-training layer 2, epoch 72, cost -56.2274261703
Pre-training layer 2, epoch 73, cost -56.2245599365
Pre-training layer 2, epoch 74, cost -56.1548238907
Pre-training layer 2, epoch 75, cost -56.1222937698
Pre-training layer 2, epoch 75, representative training free energy 70680.8741328
Pre-training layer 2, epoch 75, validation free energy 70092.739668
Pre-training layer 2, epoch 76, cost -56.1695583572
Pre-training layer 2, epoch 77, cost -56.11384478
Pre-training layer 2, epoch 78, cost -56.0735649185
Pre-training layer 2, epoch 79, cost -56.0723636398
Pre-training layer 2, epoch 80, cost -56.0378709259
Pre-training layer 2, epoch 80, representative training free energy 72465.3052969
Pre-training layer 2, epoch 80, validation free energy 71869.5317871
Pre-training layer 2, epoch 81, cost -56.0503668289
Pre-training layer 2, epoch 82, cost -55.9139713974
Pre-training layer 2, epoch 83, cost -55.9467884445
Pre-training layer 2, epoch 84, cost -55.896625618
Pre-training layer 2, epoch 85, cost -55.9478627014
Pre-training layer 2, epoch 85, representative training free energy 74096.7662598
Pre-training layer 2, epoch 85, validation free energy 73479.0597969
Pre-training layer 2, epoch 86, cost -55.9066626434
Pre-training layer 2, epoch 87, cost -55.8688448715
Pre-training layer 2, epoch 88, cost -55.8430977097
Pre-training layer 2, epoch 89, cost -55.8676801453
Pre-training layer 2, epoch 90, cost -55.8069941177
Pre-training layer 2, epoch 90, representative training free energy 76030.0838984
Pre-training layer 2, epoch 90, validation free energy 75401.6653945
Pre-training layer 2, epoch 91, cost -55.7256540527
Pre-training layer 2, epoch 92, cost -55.7765888367
Pre-training layer 2, epoch 93, cost -55.6744246368
Pre-training layer 2, epoch 94, cost -55.7320679016
Pre-training layer 2, epoch 95, cost -55.7208604431
Pre-training layer 2, epoch 95, representative training free energy 77678.3430586
Pre-training layer 2, epoch 95, validation free energy 77029.9818008
Pre-training layer 2, epoch 96, cost -55.6817250748
Pre-training layer 2, epoch 97, cost -55.6159967346
Pre-training layer 2, epoch 98, cost -55.6636553497
Pre-training layer 2, epoch 99, cost -55.7143066864
Pre-training layer 3, epoch 0, cost -138.881513992
Pre-training layer 3, epoch 0, representative training free energy -505414835.84
Pre-training layer 3, epoch 0, validation free energy -501621734.4
Pre-training layer 3, epoch 1, cost -111.043708817
Pre-training layer 3, epoch 2, cost -103.811734848
Pre-training layer 3, epoch 3, cost -100.049670639
Pre-training layer 3, epoch 4, cost -97.5776946564
Pre-training layer 3, epoch 5, cost -95.8632518768
Pre-training layer 3, epoch 5, representative training free energy -729748169.824
Pre-training layer 3, epoch 5, validation free energy -724067155.44
Pre-training layer 3, epoch 6, cost -94.5740029755
Pre-training layer 3, epoch 7, cost -93.5039672546
Pre-training layer 3, epoch 8, cost -92.6187044373
Pre-training layer 3, epoch 9, cost -92.0468591309
Pre-training layer 3, epoch 10, cost -91.4833863907
Pre-training layer 3, epoch 10, representative training free energy -821805368.608
Pre-training layer 3, epoch 10, validation free energy -815396110.496
Pre-training layer 3, epoch 11, cost -90.8677887344
Pre-training layer 3, epoch 12, cost -90.4571199341
Pre-training layer 3, epoch 13, cost -90.129974144
Pre-training layer 3, epoch 14, cost -89.7789715424
Pre-training layer 3, epoch 15, cost -89.4508381348
Pre-training layer 3, epoch 15, representative training free energy -881047171.488
Pre-training layer 3, epoch 15, validation free energy -874148270.08
Pre-training layer 3, epoch 16, cost -89.1653927155
Pre-training layer 3, epoch 17, cost -88.8917526779
Pre-training layer 3, epoch 18, cost -88.7118287582
Pre-training layer 3, epoch 19, cost -88.496857048
Pre-training layer 3, epoch 20, cost -88.427849884
Pre-training layer 3, epoch 20, representative training free energy -927005515.84
Pre-training layer 3, epoch 20, validation free energy -919753581.792
Pre-training layer 3, epoch 21, cost -88.1308127747
Pre-training layer 3, epoch 22, cost -88.0399199524
Pre-training layer 3, epoch 23, cost -87.7587386246
Pre-training layer 3, epoch 24, cost -87.6062475739
Pre-training layer 3, epoch 25, cost -87.4622406769
Pre-training layer 3, epoch 25, representative training free energy -965205714.56
Pre-training layer 3, epoch 25, validation free energy -957615607.328
Pre-training layer 3, epoch 26, cost -87.381853714
Pre-training layer 3, epoch 27, cost -87.2022015457
Pre-training layer 3, epoch 28, cost -87.1256676559
Pre-training layer 3, epoch 29, cost -87.0386496506
Pre-training layer 3, epoch 30, cost -86.9491076736
Pre-training layer 3, epoch 30, representative training free energy -999486426.464
Pre-training layer 3, epoch 30, validation free energy -991643328.32
Pre-training layer 3, epoch 31, cost -86.8524480591
Pre-training layer 3, epoch 32, cost -86.6906981506
Pre-training layer 3, epoch 33, cost -86.6921882401
Pre-training layer 3, epoch 34, cost -86.6179227753
Pre-training layer 3, epoch 35, cost -86.4791768036
Pre-training layer 3, epoch 35, representative training free energy -1026181227.33
Pre-training layer 3, epoch 35, validation free energy -1018128817.09
Pre-training layer 3, epoch 36, cost -86.3940282593
Pre-training layer 3, epoch 37, cost -86.3425239334
Pre-training layer 3, epoch 38, cost -86.2174559631
Pre-training layer 3, epoch 39, cost -86.1682438126
Pre-training layer 3, epoch 40, cost -86.1285384521
Pre-training layer 3, epoch 40, representative training free energy -1053176353.86
Pre-training layer 3, epoch 40, validation free energy -1044907167.87
Pre-training layer 3, epoch 41, cost -86.0319489822
Pre-training layer 3, epoch 42, cost -85.9820277481
Pre-training layer 3, epoch 43, cost -85.9398343048
Pre-training layer 3, epoch 44, cost -85.8689435883
Pre-training layer 3, epoch 45, cost -85.8594425812
Pre-training layer 3, epoch 45, representative training free energy -1074842694.21
Pre-training layer 3, epoch 45, validation free energy -1066383962.75
Pre-training layer 3, epoch 46, cost -85.7527231674
Pre-training layer 3, epoch 47, cost -85.7271412125
Pre-training layer 3, epoch 48, cost -85.7100779877
Pre-training layer 3, epoch 49, cost -85.6261031799
Pre-training layer 3, epoch 50, cost -85.5871122818
Pre-training layer 3, epoch 50, representative training free energy -1096289096.54
Pre-training layer 3, epoch 50, validation free energy -1087688589.28
Pre-training layer 3, epoch 51, cost -85.5925660706
Pre-training layer 3, epoch 52, cost -85.5093761368
Pre-training layer 3, epoch 53, cost -85.4195813293
Pre-training layer 3, epoch 54, cost -85.3962496033
Pre-training layer 3, epoch 55, cost -85.3705724716
Pre-training layer 3, epoch 55, representative training free energy -1114983737.31
Pre-training layer 3, epoch 55, validation free energy -1106215064.26
Pre-training layer 3, epoch 56, cost -85.366346489
Pre-training layer 3, epoch 57, cost -85.2849938583
Pre-training layer 3, epoch 58, cost -85.2412952499
Pre-training layer 3, epoch 59, cost -85.1837333755
Pre-training layer 3, epoch 60, cost -85.1065760422
Pre-training layer 3, epoch 60, representative training free energy -1133977670.78
Pre-training layer 3, epoch 60, validation free energy -1125054635.33
Pre-training layer 3, epoch 61, cost -85.1507814713
Pre-training layer 3, epoch 62, cost -85.1352153015
Pre-training layer 3, epoch 63, cost -85.0435529099
Pre-training layer 3, epoch 64, cost -85.0171050339
Pre-training layer 3, epoch 65, cost -84.9875554733
Pre-training layer 3, epoch 65, representative training free energy -1151806820.77
Pre-training layer 3, epoch 65, validation free energy -1142743837.02
Pre-training layer 3, epoch 66, cost -85.0237892075
Pre-training layer 3, epoch 67, cost -84.9063327332
Pre-training layer 3, epoch 68, cost -84.9331882172
Pre-training layer 3, epoch 69, cost -84.8684060211
Pre-training layer 3, epoch 70, cost -84.8653915863
Pre-training layer 3, epoch 70, representative training free energy -1168295831.55
Pre-training layer 3, epoch 70, validation free energy -1159110308.48
Pre-training layer 3, epoch 71, cost -84.8068011322
Pre-training layer 3, epoch 72, cost -84.7849363708
Pre-training layer 3, epoch 73, cost -84.7707670364
Pre-training layer 3, epoch 74, cost -84.7317766571
Pre-training layer 3, epoch 75, cost -84.7429639511
Pre-training layer 3, epoch 75, representative training free energy -1181434373.79
Pre-training layer 3, epoch 75, validation free energy -1172155788.86
Pre-training layer 3, epoch 76, cost -84.6963603439
Pre-training layer 3, epoch 77, cost -84.6651155472
Pre-training layer 3, epoch 78, cost -84.6029970932
Pre-training layer 3, epoch 79, cost -84.6005356445
Pre-training layer 3, epoch 80, cost -84.5860523605
Pre-training layer 3, epoch 80, representative training free energy -1195111664.0
Pre-training layer 3, epoch 80, validation free energy -1185714923.49
Pre-training layer 3, epoch 81, cost -84.5428134384
Pre-training layer 3, epoch 82, cost -84.5403885803
Pre-training layer 3, epoch 83, cost -84.567494194
Pre-training layer 3, epoch 84, cost -84.4973397217
Pre-training layer 3, epoch 85, cost -84.5100280304
Pre-training layer 3, epoch 85, representative training free energy -1207715647.81
Pre-training layer 3, epoch 85, validation free energy -1198210238.21
Pre-training layer 3, epoch 86, cost -84.4552783279
Pre-training layer 3, epoch 87, cost -84.3875825272
Pre-training layer 3, epoch 88, cost -84.4385931778
Pre-training layer 3, epoch 89, cost -84.3344210434
Pre-training layer 3, epoch 90, cost -84.4219603043
Pre-training layer 3, epoch 90, representative training free energy -1220265611.33
Pre-training layer 3, epoch 90, validation free energy -1210667210.21
Pre-training layer 3, epoch 91, cost -84.3709227295
Pre-training layer 3, epoch 92, cost -84.3152509766
Pre-training layer 3, epoch 93, cost -84.3160909653
Pre-training layer 3, epoch 94, cost -84.3146368408
Pre-training layer 3, epoch 95, cost -84.3132949677
Pre-training layer 3, epoch 95, representative training free energy -1231421737.98
Pre-training layer 3, epoch 95, validation free energy -1221705806.18
Pre-training layer 3, epoch 96, cost -84.236506073
Pre-training layer 3, epoch 97, cost -84.2137436142
Pre-training layer 3, epoch 98, cost -84.233937294
Pre-training layer 3, epoch 99, cost -84.2215392456
The pretraining code for file dbn_loop.pyc ran for 6.68m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 14.300000 %
     epoch 1, minibatch 500/500, test error of best model 14.400000 %
epoch 2, minibatch 500/500, validation error 10.600000 %
     epoch 2, minibatch 500/500, test error of best model 10.000000 %
epoch 3, minibatch 500/500, validation error 8.800000 %
     epoch 3, minibatch 500/500, test error of best model 8.200000 %
epoch 4, minibatch 500/500, validation error 7.100000 %
     epoch 4, minibatch 500/500, test error of best model 7.300000 %
epoch 5, minibatch 500/500, validation error 6.300000 %
     epoch 5, minibatch 500/500, test error of best model 6.700000 %
epoch 6, minibatch 500/500, validation error 6.100000 %
     epoch 6, minibatch 500/500, test error of best model 6.300000 %
epoch 7, minibatch 500/500, validation error 6.100000 %
epoch 8, minibatch 500/500, validation error 6.100000 %
     epoch 8, minibatch 500/500, test error of best model 5.800000 %
epoch 9, minibatch 500/500, validation error 6.200000 %
epoch 10, minibatch 500/500, validation error 5.800000 %
     epoch 10, minibatch 500/500, test error of best model 5.400000 %
epoch 11, minibatch 500/500, validation error 5.600000 %
     epoch 11, minibatch 500/500, test error of best model 5.100000 %
epoch 12, minibatch 500/500, validation error 5.500000 %
     epoch 12, minibatch 500/500, test error of best model 4.800000 %
epoch 13, minibatch 500/500, validation error 5.500000 %
epoch 14, minibatch 500/500, validation error 5.200000 %
     epoch 14, minibatch 500/500, test error of best model 4.500000 %
epoch 15, minibatch 500/500, validation error 4.900000 %
     epoch 15, minibatch 500/500, test error of best model 4.500000 %
epoch 16, minibatch 500/500, validation error 4.800000 %
     epoch 16, minibatch 500/500, test error of best model 4.500000 %
epoch 17, minibatch 500/500, validation error 4.800000 %
epoch 18, minibatch 500/500, validation error 4.700000 %
     epoch 18, minibatch 500/500, test error of best model 4.400000 %
epoch 19, minibatch 500/500, validation error 4.700000 %
epoch 20, minibatch 500/500, validation error 4.900000 %
epoch 21, minibatch 500/500, validation error 4.800000 %
epoch 22, minibatch 500/500, validation error 4.900000 %
epoch 23, minibatch 500/500, validation error 4.800000 %
epoch 24, minibatch 500/500, validation error 4.800000 %
epoch 25, minibatch 500/500, validation error 4.800000 %
epoch 26, minibatch 500/500, validation error 4.800000 %
epoch 27, minibatch 500/500, validation error 4.800000 %
epoch 28, minibatch 500/500, validation error 4.800000 %
epoch 29, minibatch 500/500, validation error 4.800000 %
epoch 30, minibatch 500/500, validation error 4.800000 %
epoch 31, minibatch 500/500, validation error 4.800000 %
epoch 32, minibatch 500/500, validation error 4.800000 %
epoch 33, minibatch 500/500, validation error 4.800000 %
epoch 34, minibatch 500/500, validation error 4.800000 %
epoch 35, minibatch 500/500, validation error 4.700000 %
Optimization complete with best validation score of 4.700000 %, obtained at iteration 9000, with test performance 4.400000 %
The fine tuning code for file dbn_loop.pyc ran for 0.99m
_______RUN: 1

==========Layers: [1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.850655304
Pre-training layer 0, epoch 0, representative training free energy -402.744191101
Pre-training layer 0, epoch 0, validation free energy -397.118146515
Pre-training layer 0, epoch 1, cost -96.6613920898
Pre-training layer 0, epoch 2, cost -90.9398140106
Pre-training layer 0, epoch 3, cost -87.7966148071
Pre-training layer 0, epoch 4, cost -85.7713521805
Pre-training layer 0, epoch 5, cost -84.2093525925
Pre-training layer 0, epoch 5, representative training free energy -349.901764648
Pre-training layer 0, epoch 5, validation free energy -344.257976257
Pre-training layer 0, epoch 6, cost -83.0184506607
Pre-training layer 0, epoch 7, cost -81.9929509659
Pre-training layer 0, epoch 8, cost -81.122507988
Pre-training layer 0, epoch 9, cost -80.4303027954
Pre-training layer 0, epoch 10, cost -79.7130318756
Pre-training layer 0, epoch 10, representative training free energy -336.210164505
Pre-training layer 0, epoch 10, validation free energy -328.839835785
Pre-training layer 0, epoch 11, cost -79.344942955
Pre-training layer 0, epoch 12, cost -78.7170954819
Pre-training layer 0, epoch 13, cost -78.4763445892
Pre-training layer 0, epoch 14, cost -77.9527246475
Pre-training layer 0, epoch 15, cost -77.4726752777
Pre-training layer 0, epoch 15, representative training free energy -335.281168671
Pre-training layer 0, epoch 15, validation free energy -326.92132103
Pre-training layer 0, epoch 16, cost -77.2244436646
Pre-training layer 0, epoch 17, cost -76.9069786911
Pre-training layer 0, epoch 18, cost -76.6268226852
Pre-training layer 0, epoch 19, cost -76.3461674042
Pre-training layer 0, epoch 20, cost -76.177427063
Pre-training layer 0, epoch 20, representative training free energy -328.735870789
Pre-training layer 0, epoch 20, validation free energy -320.718295502
Pre-training layer 0, epoch 21, cost -75.9139760361
Pre-training layer 0, epoch 22, cost -75.6426193161
Pre-training layer 0, epoch 23, cost -75.4865461807
Pre-training layer 0, epoch 24, cost -75.2427549515
Pre-training layer 0, epoch 25, cost -75.1131611328
Pre-training layer 0, epoch 25, representative training free energy -327.745648254
Pre-training layer 0, epoch 25, validation free energy -318.094977112
Pre-training layer 0, epoch 26, cost -74.9117454758
Pre-training layer 0, epoch 27, cost -74.7414267883
Pre-training layer 0, epoch 28, cost -74.5957493134
Pre-training layer 0, epoch 29, cost -74.4687189865
Pre-training layer 0, epoch 30, cost -74.1124857025
Pre-training layer 0, epoch 30, representative training free energy -318.943875259
Pre-training layer 0, epoch 30, validation free energy -308.923368484
Pre-training layer 0, epoch 31, cost -74.1264872818
Pre-training layer 0, epoch 32, cost -74.0277235336
Pre-training layer 0, epoch 33, cost -73.6498608017
Pre-training layer 0, epoch 34, cost -73.6360404587
Pre-training layer 0, epoch 35, cost -73.5480749664
Pre-training layer 0, epoch 35, representative training free energy -318.866915833
Pre-training layer 0, epoch 35, validation free energy -309.141636002
Pre-training layer 0, epoch 36, cost -73.4560257111
Pre-training layer 0, epoch 37, cost -73.3382289734
Pre-training layer 0, epoch 38, cost -73.1642164841
Pre-training layer 0, epoch 39, cost -73.1322444992
Pre-training layer 0, epoch 40, cost -72.8669133606
Pre-training layer 0, epoch 40, representative training free energy -312.826078217
Pre-training layer 0, epoch 40, validation free energy -302.377176743
Pre-training layer 0, epoch 41, cost -72.9495059891
Pre-training layer 0, epoch 42, cost -72.878881813
Pre-training layer 0, epoch 43, cost -72.6481852493
Pre-training layer 0, epoch 44, cost -72.6178142166
Pre-training layer 0, epoch 45, cost -72.5030825577
Pre-training layer 0, epoch 45, representative training free energy -308.720674866
Pre-training layer 0, epoch 45, validation free energy -298.750819
Pre-training layer 0, epoch 46, cost -72.4329004135
Pre-training layer 0, epoch 47, cost -72.309470253
Pre-training layer 0, epoch 48, cost -72.1295273514
Pre-training layer 0, epoch 49, cost -72.2223176727
Pre-training layer 0, epoch 50, cost -72.1222861633
Pre-training layer 0, epoch 50, representative training free energy -308.785162369
Pre-training layer 0, epoch 50, validation free energy -298.080752625
Pre-training layer 0, epoch 51, cost -72.0414503021
Pre-training layer 0, epoch 52, cost -71.9017832718
Pre-training layer 0, epoch 53, cost -71.8956421509
Pre-training layer 0, epoch 54, cost -71.7412316208
Pre-training layer 0, epoch 55, cost -71.6466120682
Pre-training layer 0, epoch 55, representative training free energy -305.141327454
Pre-training layer 0, epoch 55, validation free energy -294.720172821
Pre-training layer 0, epoch 56, cost -71.62314048
Pre-training layer 0, epoch 57, cost -71.5132969666
Pre-training layer 0, epoch 58, cost -71.5389626389
Pre-training layer 0, epoch 59, cost -71.5110612869
Pre-training layer 0, epoch 60, cost -71.349845932
Pre-training layer 0, epoch 60, representative training free energy -299.461449738
Pre-training layer 0, epoch 60, validation free energy -287.627082916
Pre-training layer 0, epoch 61, cost -71.2880413284
Pre-training layer 0, epoch 62, cost -71.3133080292
Pre-training layer 0, epoch 63, cost -71.1791467896
Pre-training layer 0, epoch 64, cost -71.1753289642
Pre-training layer 0, epoch 65, cost -71.0846582184
Pre-training layer 0, epoch 65, representative training free energy -297.027835861
Pre-training layer 0, epoch 65, validation free energy -285.535828812
Pre-training layer 0, epoch 66, cost -71.0153142929
Pre-training layer 0, epoch 67, cost -70.9113036499
Pre-training layer 0, epoch 68, cost -70.8991873016
Pre-training layer 0, epoch 69, cost -70.9163154449
Pre-training layer 0, epoch 70, cost -70.7852536087
Pre-training layer 0, epoch 70, representative training free energy -291.225731522
Pre-training layer 0, epoch 70, validation free energy -279.687925934
Pre-training layer 0, epoch 71, cost -70.7575144577
Pre-training layer 0, epoch 72, cost -70.7622783508
Pre-training layer 0, epoch 73, cost -70.6405772476
Pre-training layer 0, epoch 74, cost -70.5338335724
Pre-training layer 0, epoch 75, cost -70.4820282822
Pre-training layer 0, epoch 75, representative training free energy -286.90266893
Pre-training layer 0, epoch 75, validation free energy -274.943230881
Pre-training layer 0, epoch 76, cost -70.468736145
Pre-training layer 0, epoch 77, cost -70.4573426285
Pre-training layer 0, epoch 78, cost -70.3341749802
Pre-training layer 0, epoch 79, cost -70.2338326416
Pre-training layer 0, epoch 80, cost -70.3189721985
Pre-training layer 0, epoch 80, representative training free energy -288.135710358
Pre-training layer 0, epoch 80, validation free energy -277.063205017
Pre-training layer 0, epoch 81, cost -70.2323829193
Pre-training layer 0, epoch 82, cost -70.1547804184
Pre-training layer 0, epoch 83, cost -70.0903648682
Pre-training layer 0, epoch 84, cost -70.0004287949
Pre-training layer 0, epoch 85, cost -70.0186678314
Pre-training layer 0, epoch 85, representative training free energy -284.374901535
Pre-training layer 0, epoch 85, validation free energy -271.384813889
Pre-training layer 0, epoch 86, cost -69.9924447479
Pre-training layer 0, epoch 87, cost -69.8850634537
Pre-training layer 0, epoch 88, cost -69.8310261765
Pre-training layer 0, epoch 89, cost -69.8559119644
Pre-training layer 0, epoch 90, cost -69.7989153442
Pre-training layer 0, epoch 90, representative training free energy -280.603263962
Pre-training layer 0, epoch 90, validation free energy -267.857632065
Pre-training layer 0, epoch 91, cost -69.7631568222
Pre-training layer 0, epoch 92, cost -69.7134887466
Pre-training layer 0, epoch 93, cost -69.5814100647
Pre-training layer 0, epoch 94, cost -69.5482166748
Pre-training layer 0, epoch 95, cost -69.5536578064
Pre-training layer 0, epoch 95, representative training free energy -276.498631378
Pre-training layer 0, epoch 95, validation free energy -263.701979034
Pre-training layer 0, epoch 96, cost -69.6009001007
Pre-training layer 0, epoch 97, cost -69.4905386276
Pre-training layer 0, epoch 98, cost -69.4633253174
Pre-training layer 0, epoch 99, cost -69.3981693497
The pretraining code for file dbn_loop.pyc ran for 1.22m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 16.800000 %
     epoch 1, minibatch 500/500, test error of best model 16.000000 %
epoch 2, minibatch 500/500, validation error 11.000000 %
     epoch 2, minibatch 500/500, test error of best model 10.800000 %
epoch 3, minibatch 500/500, validation error 8.900000 %
     epoch 3, minibatch 500/500, test error of best model 8.300000 %
epoch 4, minibatch 500/500, validation error 8.000000 %
     epoch 4, minibatch 500/500, test error of best model 7.100000 %
epoch 5, minibatch 500/500, validation error 7.200000 %
     epoch 5, minibatch 500/500, test error of best model 6.600000 %
epoch 6, minibatch 500/500, validation error 6.500000 %
     epoch 6, minibatch 500/500, test error of best model 6.300000 %
epoch 7, minibatch 500/500, validation error 6.200000 %
     epoch 7, minibatch 500/500, test error of best model 6.200000 %
epoch 8, minibatch 500/500, validation error 5.800000 %
     epoch 8, minibatch 500/500, test error of best model 6.100000 %
epoch 9, minibatch 500/500, validation error 5.600000 %
     epoch 9, minibatch 500/500, test error of best model 5.900000 %
epoch 10, minibatch 500/500, validation error 5.400000 %
     epoch 10, minibatch 500/500, test error of best model 5.500000 %
epoch 11, minibatch 500/500, validation error 5.300000 %
     epoch 11, minibatch 500/500, test error of best model 5.300000 %
epoch 12, minibatch 500/500, validation error 5.200000 %
     epoch 12, minibatch 500/500, test error of best model 5.400000 %
epoch 13, minibatch 500/500, validation error 5.100000 %
     epoch 13, minibatch 500/500, test error of best model 5.300000 %
epoch 14, minibatch 500/500, validation error 5.100000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
epoch 16, minibatch 500/500, validation error 5.000000 %
     epoch 16, minibatch 500/500, test error of best model 5.000000 %
epoch 17, minibatch 500/500, validation error 4.800000 %
     epoch 17, minibatch 500/500, test error of best model 4.900000 %
epoch 18, minibatch 500/500, validation error 4.700000 %
     epoch 18, minibatch 500/500, test error of best model 4.800000 %
epoch 19, minibatch 500/500, validation error 4.700000 %
epoch 20, minibatch 500/500, validation error 4.700000 %
epoch 21, minibatch 500/500, validation error 4.600000 %
     epoch 21, minibatch 500/500, test error of best model 4.800000 %
epoch 22, minibatch 500/500, validation error 4.600000 %
epoch 23, minibatch 500/500, validation error 4.600000 %
epoch 24, minibatch 500/500, validation error 4.600000 %
epoch 25, minibatch 500/500, validation error 4.600000 %
epoch 26, minibatch 500/500, validation error 4.500000 %
     epoch 26, minibatch 500/500, test error of best model 4.800000 %
epoch 27, minibatch 500/500, validation error 4.500000 %
epoch 28, minibatch 500/500, validation error 4.500000 %
epoch 29, minibatch 500/500, validation error 4.500000 %
epoch 30, minibatch 500/500, validation error 4.500000 %
epoch 31, minibatch 500/500, validation error 4.600000 %
epoch 32, minibatch 500/500, validation error 4.600000 %
epoch 33, minibatch 500/500, validation error 4.600000 %
epoch 34, minibatch 500/500, validation error 4.600000 %
epoch 35, minibatch 500/500, validation error 4.600000 %
epoch 36, minibatch 500/500, validation error 4.600000 %
epoch 37, minibatch 500/500, validation error 4.600000 %
epoch 38, minibatch 500/500, validation error 4.600000 %
epoch 39, minibatch 500/500, validation error 4.600000 %
epoch 40, minibatch 500/500, validation error 4.600000 %
epoch 41, minibatch 500/500, validation error 4.600000 %
epoch 42, minibatch 500/500, validation error 4.600000 %
epoch 43, minibatch 500/500, validation error 4.500000 %
epoch 44, minibatch 500/500, validation error 4.500000 %
epoch 45, minibatch 500/500, validation error 4.500000 %
epoch 46, minibatch 500/500, validation error 4.500000 %
epoch 47, minibatch 500/500, validation error 4.500000 %
epoch 48, minibatch 500/500, validation error 4.500000 %
epoch 49, minibatch 500/500, validation error 4.500000 %
epoch 50, minibatch 500/500, validation error 4.500000 %
epoch 51, minibatch 500/500, validation error 4.500000 %
Optimization complete with best validation score of 4.500000 %, obtained at iteration 13000, with test performance 4.800000 %
The fine tuning code for file dbn_loop.pyc ran for 0.33m


==========Layers: [1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.782262039
Pre-training layer 0, epoch 0, representative training free energy -405.204268738
Pre-training layer 0, epoch 0, validation free energy -400.006225586
Pre-training layer 0, epoch 1, cost -96.598426178
Pre-training layer 0, epoch 2, cost -90.8806990356
Pre-training layer 0, epoch 3, cost -87.8016338806
Pre-training layer 0, epoch 4, cost -85.8488751297
Pre-training layer 0, epoch 5, cost -84.1954179687
Pre-training layer 0, epoch 5, representative training free energy -353.149289124
Pre-training layer 0, epoch 5, validation free energy -347.056642456
Pre-training layer 0, epoch 6, cost -82.9327343216
Pre-training layer 0, epoch 7, cost -81.9036658401
Pre-training layer 0, epoch 8, cost -81.0815231781
Pre-training layer 0, epoch 9, cost -80.465131691
Pre-training layer 0, epoch 10, cost -79.8213011017
Pre-training layer 0, epoch 10, representative training free energy -345.544833984
Pre-training layer 0, epoch 10, validation free energy -336.555243988
Pre-training layer 0, epoch 11, cost -79.2082844315
Pre-training layer 0, epoch 12, cost -78.7926249542
Pre-training layer 0, epoch 13, cost -78.3587206802
Pre-training layer 0, epoch 14, cost -77.9600126266
Pre-training layer 0, epoch 15, cost -77.6906044617
Pre-training layer 0, epoch 15, representative training free energy -338.427679932
Pre-training layer 0, epoch 15, validation free energy -330.195332153
Pre-training layer 0, epoch 16, cost -77.2896687546
Pre-training layer 0, epoch 17, cost -76.9574930344
Pre-training layer 0, epoch 18, cost -76.6521750259
Pre-training layer 0, epoch 19, cost -76.3682533112
Pre-training layer 0, epoch 20, cost -76.1258252792
Pre-training layer 0, epoch 20, representative training free energy -335.966544312
Pre-training layer 0, epoch 20, validation free energy -326.90325798
Pre-training layer 0, epoch 21, cost -75.8579429321
Pre-training layer 0, epoch 22, cost -75.6795347595
Pre-training layer 0, epoch 23, cost -75.5170616684
Pre-training layer 0, epoch 24, cost -75.1569862671
Pre-training layer 0, epoch 25, cost -75.085657959
Pre-training layer 0, epoch 25, representative training free energy -332.387005188
Pre-training layer 0, epoch 25, validation free energy -322.707309906
Pre-training layer 0, epoch 26, cost -74.9574889221
Pre-training layer 0, epoch 27, cost -74.7227390366
Pre-training layer 0, epoch 28, cost -74.5473969269
Pre-training layer 0, epoch 29, cost -74.3708392334
Pre-training layer 0, epoch 30, cost -74.2830806656
Pre-training layer 0, epoch 30, representative training free energy -322.410384628
Pre-training layer 0, epoch 30, validation free energy -312.980199326
Pre-training layer 0, epoch 31, cost -74.2046046753
Pre-training layer 0, epoch 32, cost -73.9714494858
Pre-training layer 0, epoch 33, cost -73.7616409302
Pre-training layer 0, epoch 34, cost -73.674919548
Pre-training layer 0, epoch 35, cost -73.6448901138
Pre-training layer 0, epoch 35, representative training free energy -320.717076691
Pre-training layer 0, epoch 35, validation free energy -310.030154266
Pre-training layer 0, epoch 36, cost -73.3611290359
Pre-training layer 0, epoch 37, cost -73.358620575
Pre-training layer 0, epoch 38, cost -73.3112490997
Pre-training layer 0, epoch 39, cost -73.2142901917
Pre-training layer 0, epoch 40, cost -73.0668959656
Pre-training layer 0, epoch 40, representative training free energy -318.095746033
Pre-training layer 0, epoch 40, validation free energy -306.339191513
Pre-training layer 0, epoch 41, cost -72.9391888046
Pre-training layer 0, epoch 42, cost -72.7151767654
Pre-training layer 0, epoch 43, cost -72.6463912125
Pre-training layer 0, epoch 44, cost -72.5713720856
Pre-training layer 0, epoch 45, cost -72.6072798538
Pre-training layer 0, epoch 45, representative training free energy -315.208502167
Pre-training layer 0, epoch 45, validation free energy -304.877326462
Pre-training layer 0, epoch 46, cost -72.4015508728
Pre-training layer 0, epoch 47, cost -72.3679551849
Pre-training layer 0, epoch 48, cost -72.334970108
Pre-training layer 0, epoch 49, cost -72.2261404572
Pre-training layer 0, epoch 50, cost -72.1777263336
Pre-training layer 0, epoch 50, representative training free energy -308.456508713
Pre-training layer 0, epoch 50, validation free energy -297.452156708
Pre-training layer 0, epoch 51, cost -72.0827131119
Pre-training layer 0, epoch 52, cost -71.9446056671
Pre-training layer 0, epoch 53, cost -71.8817520218
Pre-training layer 0, epoch 54, cost -71.8026998444
Pre-training layer 0, epoch 55, cost -71.8820383148
Pre-training layer 0, epoch 55, representative training free energy -304.815137085
Pre-training layer 0, epoch 55, validation free energy -294.67324176
Pre-training layer 0, epoch 56, cost -71.6184949799
Pre-training layer 0, epoch 57, cost -71.5516279984
Pre-training layer 0, epoch 58, cost -71.4758431778
Pre-training layer 0, epoch 59, cost -71.4624896164
Pre-training layer 0, epoch 60, cost -71.4445795288
Pre-training layer 0, epoch 60, representative training free energy -305.209485687
Pre-training layer 0, epoch 60, validation free energy -293.748643951
Pre-training layer 0, epoch 61, cost -71.3460718307
Pre-training layer 0, epoch 62, cost -71.3687729721
Pre-training layer 0, epoch 63, cost -71.2205473404
Pre-training layer 0, epoch 64, cost -71.1307885513
Pre-training layer 0, epoch 65, cost -71.1205775299
Pre-training layer 0, epoch 65, representative training free energy -299.290020294
Pre-training layer 0, epoch 65, validation free energy -287.87202887
Pre-training layer 0, epoch 66, cost -70.9853368835
Pre-training layer 0, epoch 67, cost -70.9874887848
Pre-training layer 0, epoch 68, cost -70.9260424576
Pre-training layer 0, epoch 69, cost -70.8109767532
Pre-training layer 0, epoch 70, cost -70.9057571487
Pre-training layer 0, epoch 70, representative training free energy -298.717828369
Pre-training layer 0, epoch 70, validation free energy -287.515288055
Pre-training layer 0, epoch 71, cost -70.6808725662
Pre-training layer 0, epoch 72, cost -70.6485292587
Pre-training layer 0, epoch 73, cost -70.6337860336
Pre-training layer 0, epoch 74, cost -70.5018120499
Pre-training layer 0, epoch 75, cost -70.5172026596
Pre-training layer 0, epoch 75, representative training free energy -295.47059758
Pre-training layer 0, epoch 75, validation free energy -283.681068115
Pre-training layer 0, epoch 76, cost -70.4533771667
Pre-training layer 0, epoch 77, cost -70.429576416
Pre-training layer 0, epoch 78, cost -70.3496476288
Pre-training layer 0, epoch 79, cost -70.3539422684
Pre-training layer 0, epoch 80, cost -70.2968121796
Pre-training layer 0, epoch 80, representative training free energy -292.606598343
Pre-training layer 0, epoch 80, validation free energy -280.435856644
Pre-training layer 0, epoch 81, cost -70.2982134933
Pre-training layer 0, epoch 82, cost -70.3061154022
Pre-training layer 0, epoch 83, cost -70.2086870728
Pre-training layer 0, epoch 84, cost -70.0786182022
Pre-training layer 0, epoch 85, cost -70.0866758041
Pre-training layer 0, epoch 85, representative training free energy -286.082606888
Pre-training layer 0, epoch 85, validation free energy -274.095944962
Pre-training layer 0, epoch 86, cost -69.9136869888
Pre-training layer 0, epoch 87, cost -69.9771008072
Pre-training layer 0, epoch 88, cost -69.8953444138
Pre-training layer 0, epoch 89, cost -69.8816371536
Pre-training layer 0, epoch 90, cost -69.8289026108
Pre-training layer 0, epoch 90, representative training free energy -285.608452255
Pre-training layer 0, epoch 90, validation free energy -273.642947617
Pre-training layer 0, epoch 91, cost -69.8705779953
Pre-training layer 0, epoch 92, cost -69.7583410339
Pre-training layer 0, epoch 93, cost -69.7880779266
Pre-training layer 0, epoch 94, cost -69.6857975616
Pre-training layer 0, epoch 95, cost -69.5439115295
Pre-training layer 0, epoch 95, representative training free energy -282.014606979
Pre-training layer 0, epoch 95, validation free energy -269.731958328
Pre-training layer 0, epoch 96, cost -69.5430949554
Pre-training layer 0, epoch 97, cost -69.5097278366
Pre-training layer 0, epoch 98, cost -69.4798982086
Pre-training layer 0, epoch 99, cost -69.4538383026
Pre-training layer 1, epoch 0, cost -173.347871506
Pre-training layer 1, epoch 0, representative training free energy -143992.933371
Pre-training layer 1, epoch 0, validation free energy -143125.840438
Pre-training layer 1, epoch 1, cost -143.38705365
Pre-training layer 1, epoch 2, cost -135.365491867
Pre-training layer 1, epoch 3, cost -130.526610718
Pre-training layer 1, epoch 4, cost -127.595690277
Pre-training layer 1, epoch 5, cost -125.253444992
Pre-training layer 1, epoch 5, representative training free energy -197766.460375
Pre-training layer 1, epoch 5, validation free energy -196404.749906
Pre-training layer 1, epoch 6, cost -123.417538391
Pre-training layer 1, epoch 7, cost -122.069794479
Pre-training layer 1, epoch 8, cost -121.045865616
Pre-training layer 1, epoch 9, cost -119.98676918
Pre-training layer 1, epoch 10, cost -119.094907379
Pre-training layer 1, epoch 10, representative training free energy -219360.226445
Pre-training layer 1, epoch 10, validation free energy -217796.696391
Pre-training layer 1, epoch 11, cost -118.316015869
Pre-training layer 1, epoch 12, cost -117.700704758
Pre-training layer 1, epoch 13, cost -117.076665939
Pre-training layer 1, epoch 14, cost -116.526309326
Pre-training layer 1, epoch 15, cost -116.026680862
Pre-training layer 1, epoch 15, representative training free energy -233636.097828
Pre-training layer 1, epoch 15, validation free energy -231932.212438
Pre-training layer 1, epoch 16, cost -115.665151932
Pre-training layer 1, epoch 17, cost -115.165625488
Pre-training layer 1, epoch 18, cost -114.805984543
Pre-training layer 1, epoch 19, cost -114.47994693
Pre-training layer 1, epoch 20, cost -114.227431641
Pre-training layer 1, epoch 20, representative training free energy -244288.979297
Pre-training layer 1, epoch 20, validation free energy -242501.109039
Pre-training layer 1, epoch 21, cost -113.909153137
Pre-training layer 1, epoch 22, cost -113.506730988
Pre-training layer 1, epoch 23, cost -113.367128647
Pre-training layer 1, epoch 24, cost -113.060718201
Pre-training layer 1, epoch 25, cost -112.8281642
Pre-training layer 1, epoch 25, representative training free energy -253072.918523
Pre-training layer 1, epoch 25, validation free energy -251258.388609
Pre-training layer 1, epoch 26, cost -112.63385556
Pre-training layer 1, epoch 27, cost -112.242982468
Pre-training layer 1, epoch 28, cost -112.197083908
Pre-training layer 1, epoch 29, cost -111.999502808
Pre-training layer 1, epoch 30, cost -111.74413356
Pre-training layer 1, epoch 30, representative training free energy -260623.499719
Pre-training layer 1, epoch 30, validation free energy -258752.477375
Pre-training layer 1, epoch 31, cost -111.533661224
Pre-training layer 1, epoch 32, cost -111.444966187
Pre-training layer 1, epoch 33, cost -111.272328445
Pre-training layer 1, epoch 34, cost -111.094154404
Pre-training layer 1, epoch 35, cost -111.109506119
Pre-training layer 1, epoch 35, representative training free energy -267330.598391
Pre-training layer 1, epoch 35, validation free energy -265346.392719
Pre-training layer 1, epoch 36, cost -110.852514374
Pre-training layer 1, epoch 37, cost -110.753270172
Pre-training layer 1, epoch 38, cost -110.581266983
Pre-training layer 1, epoch 39, cost -110.515365097
Pre-training layer 1, epoch 40, cost -110.345647629
Pre-training layer 1, epoch 40, representative training free energy -272491.998836
Pre-training layer 1, epoch 40, validation free energy -270484.56218
Pre-training layer 1, epoch 41, cost -110.260207321
Pre-training layer 1, epoch 42, cost -110.116093803
Pre-training layer 1, epoch 43, cost -109.98552562
Pre-training layer 1, epoch 44, cost -109.912169342
Pre-training layer 1, epoch 45, cost -109.877690727
Pre-training layer 1, epoch 45, representative training free energy -278215.776578
Pre-training layer 1, epoch 45, validation free energy -276205.740398
Pre-training layer 1, epoch 46, cost -109.780315277
Pre-training layer 1, epoch 47, cost -109.733932678
Pre-training layer 1, epoch 48, cost -109.565096603
Pre-training layer 1, epoch 49, cost -109.441512512
Pre-training layer 1, epoch 50, cost -109.350760391
Pre-training layer 1, epoch 50, representative training free energy -282152.822656
Pre-training layer 1, epoch 50, validation free energy -280023.704078
Pre-training layer 1, epoch 51, cost -109.364573593
Pre-training layer 1, epoch 52, cost -109.220511902
Pre-training layer 1, epoch 53, cost -109.092284256
Pre-training layer 1, epoch 54, cost -109.049555481
Pre-training layer 1, epoch 55, cost -109.039469154
Pre-training layer 1, epoch 55, representative training free energy -286482.761297
Pre-training layer 1, epoch 55, validation free energy -284314.103133
Pre-training layer 1, epoch 56, cost -108.983158264
Pre-training layer 1, epoch 57, cost -108.784716415
Pre-training layer 1, epoch 58, cost -108.798753242
Pre-training layer 1, epoch 59, cost -108.71536203
Pre-training layer 1, epoch 60, cost -108.700477318
Pre-training layer 1, epoch 60, representative training free energy -290546.670641
Pre-training layer 1, epoch 60, validation free energy -288355.452656
Pre-training layer 1, epoch 61, cost -108.626158974
Pre-training layer 1, epoch 62, cost -108.509356117
Pre-training layer 1, epoch 63, cost -108.555431503
Pre-training layer 1, epoch 64, cost -108.513509438
Pre-training layer 1, epoch 65, cost -108.358628342
Pre-training layer 1, epoch 65, representative training free energy -294227.361844
Pre-training layer 1, epoch 65, validation free energy -291993.204703
Pre-training layer 1, epoch 66, cost -108.345593658
Pre-training layer 1, epoch 67, cost -108.328464958
Pre-training layer 1, epoch 68, cost -108.254587418
Pre-training layer 1, epoch 69, cost -108.234741608
Pre-training layer 1, epoch 70, cost -108.149183563
Pre-training layer 1, epoch 70, representative training free energy -297987.442758
Pre-training layer 1, epoch 70, validation free energy -295783.615281
Pre-training layer 1, epoch 71, cost -108.073061943
Pre-training layer 1, epoch 72, cost -108.159680969
Pre-training layer 1, epoch 73, cost -108.016771179
Pre-training layer 1, epoch 74, cost -107.96643383
Pre-training layer 1, epoch 75, cost -108.025367561
Pre-training layer 1, epoch 75, representative training free energy -301144.631352
Pre-training layer 1, epoch 75, validation free energy -298922.77625
Pre-training layer 1, epoch 76, cost -107.830861511
Pre-training layer 1, epoch 77, cost -107.819464447
Pre-training layer 1, epoch 78, cost -107.847018265
Pre-training layer 1, epoch 79, cost -107.749066376
Pre-training layer 1, epoch 80, cost -107.734823776
Pre-training layer 1, epoch 80, representative training free energy -304080.357812
Pre-training layer 1, epoch 80, validation free energy -301835.624914
Pre-training layer 1, epoch 81, cost -107.677459396
Pre-training layer 1, epoch 82, cost -107.663468094
Pre-training layer 1, epoch 83, cost -107.672737076
Pre-training layer 1, epoch 84, cost -107.603368767
Pre-training layer 1, epoch 85, cost -107.59239064
Pre-training layer 1, epoch 85, representative training free energy -306854.744789
Pre-training layer 1, epoch 85, validation free energy -304542.969687
Pre-training layer 1, epoch 86, cost -107.610231407
Pre-training layer 1, epoch 87, cost -107.434004883
Pre-training layer 1, epoch 88, cost -107.418850662
Pre-training layer 1, epoch 89, cost -107.435261169
Pre-training layer 1, epoch 90, cost -107.469255135
Pre-training layer 1, epoch 90, representative training free energy -309592.745914
Pre-training layer 1, epoch 90, validation free energy -307254.440891
Pre-training layer 1, epoch 91, cost -107.376797958
Pre-training layer 1, epoch 92, cost -107.264694946
Pre-training layer 1, epoch 93, cost -107.231942986
Pre-training layer 1, epoch 94, cost -107.267645233
Pre-training layer 1, epoch 95, cost -107.253140015
Pre-training layer 1, epoch 95, representative training free energy -312102.112109
Pre-training layer 1, epoch 95, validation free energy -309742.290828
Pre-training layer 1, epoch 96, cost -107.232399292
Pre-training layer 1, epoch 97, cost -107.12780407
Pre-training layer 1, epoch 98, cost -107.189167908
Pre-training layer 1, epoch 99, cost -107.151145912
The pretraining code for file dbn_loop.pyc ran for 2.84m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 13.500000 %
     epoch 1, minibatch 500/500, test error of best model 13.400000 %
epoch 2, minibatch 500/500, validation error 9.500000 %
     epoch 2, minibatch 500/500, test error of best model 9.100000 %
epoch 3, minibatch 500/500, validation error 8.000000 %
     epoch 3, minibatch 500/500, test error of best model 7.700000 %
epoch 4, minibatch 500/500, validation error 7.200000 %
     epoch 4, minibatch 500/500, test error of best model 6.800000 %
epoch 5, minibatch 500/500, validation error 6.600000 %
     epoch 5, minibatch 500/500, test error of best model 6.200000 %
epoch 6, minibatch 500/500, validation error 5.900000 %
     epoch 6, minibatch 500/500, test error of best model 5.800000 %
epoch 7, minibatch 500/500, validation error 5.500000 %
     epoch 7, minibatch 500/500, test error of best model 5.500000 %
epoch 8, minibatch 500/500, validation error 5.400000 %
     epoch 8, minibatch 500/500, test error of best model 5.400000 %
epoch 9, minibatch 500/500, validation error 5.500000 %
epoch 10, minibatch 500/500, validation error 5.300000 %
     epoch 10, minibatch 500/500, test error of best model 5.100000 %
epoch 11, minibatch 500/500, validation error 5.200000 %
     epoch 11, minibatch 500/500, test error of best model 4.900000 %
epoch 12, minibatch 500/500, validation error 5.100000 %
     epoch 12, minibatch 500/500, test error of best model 4.600000 %
epoch 13, minibatch 500/500, validation error 5.200000 %
epoch 14, minibatch 500/500, validation error 5.200000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
epoch 16, minibatch 500/500, validation error 5.000000 %
     epoch 16, minibatch 500/500, test error of best model 4.000000 %
epoch 17, minibatch 500/500, validation error 5.000000 %
epoch 18, minibatch 500/500, validation error 4.900000 %
     epoch 18, minibatch 500/500, test error of best model 4.100000 %
epoch 19, minibatch 500/500, validation error 4.800000 %
     epoch 19, minibatch 500/500, test error of best model 4.100000 %
epoch 20, minibatch 500/500, validation error 4.800000 %
epoch 21, minibatch 500/500, validation error 4.600000 %
     epoch 21, minibatch 500/500, test error of best model 4.300000 %
epoch 22, minibatch 500/500, validation error 4.600000 %
epoch 23, minibatch 500/500, validation error 4.800000 %
epoch 24, minibatch 500/500, validation error 4.800000 %
epoch 25, minibatch 500/500, validation error 4.900000 %
epoch 26, minibatch 500/500, validation error 4.900000 %
epoch 27, minibatch 500/500, validation error 4.900000 %
epoch 28, minibatch 500/500, validation error 5.000000 %
epoch 29, minibatch 500/500, validation error 5.000000 %
epoch 30, minibatch 500/500, validation error 5.100000 %
epoch 31, minibatch 500/500, validation error 5.100000 %
epoch 32, minibatch 500/500, validation error 5.100000 %
epoch 33, minibatch 500/500, validation error 5.000000 %
epoch 34, minibatch 500/500, validation error 5.000000 %
epoch 35, minibatch 500/500, validation error 5.000000 %
epoch 36, minibatch 500/500, validation error 5.000000 %
epoch 37, minibatch 500/500, validation error 5.000000 %
epoch 38, minibatch 500/500, validation error 5.000000 %
epoch 39, minibatch 500/500, validation error 4.900000 %
epoch 40, minibatch 500/500, validation error 4.900000 %
epoch 41, minibatch 500/500, validation error 5.000000 %
Optimization complete with best validation score of 4.600000 %, obtained at iteration 10500, with test performance 4.300000 %
The fine tuning code for file dbn_loop.pyc ran for 0.57m


==========Layers: [1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.764498764
Pre-training layer 0, epoch 0, representative training free energy -408.580800293
Pre-training layer 0, epoch 0, validation free energy -402.645679047
Pre-training layer 0, epoch 1, cost -96.7632107239
Pre-training layer 0, epoch 2, cost -90.9726673279
Pre-training layer 0, epoch 3, cost -87.9503478546
Pre-training layer 0, epoch 4, cost -85.7697273102
Pre-training layer 0, epoch 5, cost -84.2244584351
Pre-training layer 0, epoch 5, representative training free energy -355.307183319
Pre-training layer 0, epoch 5, validation free energy -348.738568466
Pre-training layer 0, epoch 6, cost -83.0289028702
Pre-training layer 0, epoch 7, cost -81.9637795715
Pre-training layer 0, epoch 8, cost -81.1963401642
Pre-training layer 0, epoch 9, cost -80.3805277023
Pre-training layer 0, epoch 10, cost -79.8216159058
Pre-training layer 0, epoch 10, representative training free energy -339.433945633
Pre-training layer 0, epoch 10, validation free energy -331.633932709
Pre-training layer 0, epoch 11, cost -79.2531393127
Pre-training layer 0, epoch 12, cost -78.8356849594
Pre-training layer 0, epoch 13, cost -78.2886291351
Pre-training layer 0, epoch 14, cost -77.8666431198
Pre-training layer 0, epoch 15, cost -77.5806739502
Pre-training layer 0, epoch 15, representative training free energy -339.692915253
Pre-training layer 0, epoch 15, validation free energy -331.267971649
Pre-training layer 0, epoch 16, cost -77.2646822586
Pre-training layer 0, epoch 17, cost -76.9240467987
Pre-training layer 0, epoch 18, cost -76.5867789459
Pre-training layer 0, epoch 19, cost -76.316925293
Pre-training layer 0, epoch 20, cost -76.1637637329
Pre-training layer 0, epoch 20, representative training free energy -331.25475592
Pre-training layer 0, epoch 20, validation free energy -322.449644928
Pre-training layer 0, epoch 21, cost -75.87784021
Pre-training layer 0, epoch 22, cost -75.7197710266
Pre-training layer 0, epoch 23, cost -75.5099910736
Pre-training layer 0, epoch 24, cost -75.2806283112
Pre-training layer 0, epoch 25, cost -75.1140639343
Pre-training layer 0, epoch 25, representative training free energy -325.240598953
Pre-training layer 0, epoch 25, validation free energy -316.483443787
Pre-training layer 0, epoch 26, cost -74.8887776489
Pre-training layer 0, epoch 27, cost -74.7734368362
Pre-training layer 0, epoch 28, cost -74.4930476913
Pre-training layer 0, epoch 29, cost -74.3676625519
Pre-training layer 0, epoch 30, cost -74.1155221939
Pre-training layer 0, epoch 30, representative training free energy -325.76588089
Pre-training layer 0, epoch 30, validation free energy -316.484609451
Pre-training layer 0, epoch 31, cost -74.0884512253
Pre-training layer 0, epoch 32, cost -74.0045400009
Pre-training layer 0, epoch 33, cost -73.7236051865
Pre-training layer 0, epoch 34, cost -73.7268602142
Pre-training layer 0, epoch 35, cost -73.5398046799
Pre-training layer 0, epoch 35, representative training free energy -321.213145996
Pre-training layer 0, epoch 35, validation free energy -312.216791626
Pre-training layer 0, epoch 36, cost -73.4302344055
Pre-training layer 0, epoch 37, cost -73.3269692078
Pre-training layer 0, epoch 38, cost -73.3237104492
Pre-training layer 0, epoch 39, cost -73.0783519592
Pre-training layer 0, epoch 40, cost -73.0316077881
Pre-training layer 0, epoch 40, representative training free energy -312.651806931
Pre-training layer 0, epoch 40, validation free energy -302.574766251
Pre-training layer 0, epoch 41, cost -72.9182057877
Pre-training layer 0, epoch 42, cost -72.790677002
Pre-training layer 0, epoch 43, cost -72.7587069473
Pre-training layer 0, epoch 44, cost -72.7151976013
Pre-training layer 0, epoch 45, cost -72.5218596954
Pre-training layer 0, epoch 45, representative training free energy -311.078611969
Pre-training layer 0, epoch 45, validation free energy -301.734322052
Pre-training layer 0, epoch 46, cost -72.5112293472
Pre-training layer 0, epoch 47, cost -72.3792378006
Pre-training layer 0, epoch 48, cost -72.3196408997
Pre-training layer 0, epoch 49, cost -72.2288652649
Pre-training layer 0, epoch 50, cost -72.1153978882
Pre-training layer 0, epoch 50, representative training free energy -305.607828323
Pre-training layer 0, epoch 50, validation free energy -294.615113007
Pre-training layer 0, epoch 51, cost -72.1016703568
Pre-training layer 0, epoch 52, cost -72.0380634918
Pre-training layer 0, epoch 53, cost -71.9697315598
Pre-training layer 0, epoch 54, cost -71.7244043655
Pre-training layer 0, epoch 55, cost -71.7324509277
Pre-training layer 0, epoch 55, representative training free energy -300.499089844
Pre-training layer 0, epoch 55, validation free energy -289.750440613
Pre-training layer 0, epoch 56, cost -71.6670474701
Pre-training layer 0, epoch 57, cost -71.5788409271
Pre-training layer 0, epoch 58, cost -71.4696144562
Pre-training layer 0, epoch 59, cost -71.5199272156
Pre-training layer 0, epoch 60, cost -71.4544115829
Pre-training layer 0, epoch 60, representative training free energy -298.42716243
Pre-training layer 0, epoch 60, validation free energy -286.78499971
Pre-training layer 0, epoch 61, cost -71.3214778214
Pre-training layer 0, epoch 62, cost -71.188677269
Pre-training layer 0, epoch 63, cost -71.1316986847
Pre-training layer 0, epoch 64, cost -71.1779631348
Pre-training layer 0, epoch 65, cost -71.0171890106
Pre-training layer 0, epoch 65, representative training free energy -296.819926437
Pre-training layer 0, epoch 65, validation free energy -285.064909134
Pre-training layer 0, epoch 66, cost -71.052037941
Pre-training layer 0, epoch 67, cost -70.917566925
Pre-training layer 0, epoch 68, cost -70.9782847595
Pre-training layer 0, epoch 69, cost -70.7758818588
Pre-training layer 0, epoch 70, cost -70.7815575867
Pre-training layer 0, epoch 70, representative training free energy -292.662494019
Pre-training layer 0, epoch 70, validation free energy -281.226154617
Pre-training layer 0, epoch 71, cost -70.7223106995
Pre-training layer 0, epoch 72, cost -70.7280323181
Pre-training layer 0, epoch 73, cost -70.6102745285
Pre-training layer 0, epoch 74, cost -70.5293912888
Pre-training layer 0, epoch 75, cost -70.544706337
Pre-training layer 0, epoch 75, representative training free energy -290.175149292
Pre-training layer 0, epoch 75, validation free energy -278.145330353
Pre-training layer 0, epoch 76, cost -70.4740063248
Pre-training layer 0, epoch 77, cost -70.4559932404
Pre-training layer 0, epoch 78, cost -70.3972303009
Pre-training layer 0, epoch 79, cost -70.3630963516
Pre-training layer 0, epoch 80, cost -70.2683231735
Pre-training layer 0, epoch 80, representative training free energy -288.254092819
Pre-training layer 0, epoch 80, validation free energy -275.507944794
Pre-training layer 0, epoch 81, cost -70.2093305664
Pre-training layer 0, epoch 82, cost -70.1637026749
Pre-training layer 0, epoch 83, cost -70.0886259918
Pre-training layer 0, epoch 84, cost -70.0702433624
Pre-training layer 0, epoch 85, cost -70.0688021774
Pre-training layer 0, epoch 85, representative training free energy -281.668021622
Pre-training layer 0, epoch 85, validation free energy -268.816134598
Pre-training layer 0, epoch 86, cost -69.9134698639
Pre-training layer 0, epoch 87, cost -69.9245256042
Pre-training layer 0, epoch 88, cost -69.8691440582
Pre-training layer 0, epoch 89, cost -69.9341452637
Pre-training layer 0, epoch 90, cost -69.8303862228
Pre-training layer 0, epoch 90, representative training free energy -276.630930573
Pre-training layer 0, epoch 90, validation free energy -264.698130707
Pre-training layer 0, epoch 91, cost -69.733414505
Pre-training layer 0, epoch 92, cost -69.7421059952
Pre-training layer 0, epoch 93, cost -69.6377507553
Pre-training layer 0, epoch 94, cost -69.5885303192
Pre-training layer 0, epoch 95, cost -69.6084670181
Pre-training layer 0, epoch 95, representative training free energy -276.593743912
Pre-training layer 0, epoch 95, validation free energy -264.070914246
Pre-training layer 0, epoch 96, cost -69.5586069565
Pre-training layer 0, epoch 97, cost -69.5766515579
Pre-training layer 0, epoch 98, cost -69.462641571
Pre-training layer 0, epoch 99, cost -69.3780137711
Pre-training layer 1, epoch 0, cost -172.244726105
Pre-training layer 1, epoch 0, representative training free energy -143962.892457
Pre-training layer 1, epoch 0, validation free energy -143127.633504
Pre-training layer 1, epoch 1, cost -142.330170013
Pre-training layer 1, epoch 2, cost -134.067935791
Pre-training layer 1, epoch 3, cost -129.505808044
Pre-training layer 1, epoch 4, cost -126.428665268
Pre-training layer 1, epoch 5, cost -124.165002304
Pre-training layer 1, epoch 5, representative training free energy -198260.770602
Pre-training layer 1, epoch 5, validation free energy -196817.302961
Pre-training layer 1, epoch 6, cost -122.330123093
Pre-training layer 1, epoch 7, cost -120.979922241
Pre-training layer 1, epoch 8, cost -119.897069214
Pre-training layer 1, epoch 9, cost -118.882237701
Pre-training layer 1, epoch 10, cost -117.950306473
Pre-training layer 1, epoch 10, representative training free energy -219041.511687
Pre-training layer 1, epoch 10, validation free energy -217353.07982
Pre-training layer 1, epoch 11, cost -117.356518372
Pre-training layer 1, epoch 12, cost -116.693528397
Pre-training layer 1, epoch 13, cost -116.145148422
Pre-training layer 1, epoch 14, cost -115.545571365
Pre-training layer 1, epoch 15, cost -115.008846115
Pre-training layer 1, epoch 15, representative training free energy -232842.747625
Pre-training layer 1, epoch 15, validation free energy -231061.434766
Pre-training layer 1, epoch 16, cost -114.661344055
Pre-training layer 1, epoch 17, cost -114.186085342
Pre-training layer 1, epoch 18, cost -113.854057053
Pre-training layer 1, epoch 19, cost -113.514272659
Pre-training layer 1, epoch 20, cost -113.173729126
Pre-training layer 1, epoch 20, representative training free energy -244234.883734
Pre-training layer 1, epoch 20, validation free energy -242329.931984
Pre-training layer 1, epoch 21, cost -112.896734558
Pre-training layer 1, epoch 22, cost -112.693991791
Pre-training layer 1, epoch 23, cost -112.350044937
Pre-training layer 1, epoch 24, cost -112.127501846
Pre-training layer 1, epoch 25, cost -111.849944473
Pre-training layer 1, epoch 25, representative training free energy -252983.222039
Pre-training layer 1, epoch 25, validation free energy -251002.843531
Pre-training layer 1, epoch 26, cost -111.628196091
Pre-training layer 1, epoch 27, cost -111.450612946
Pre-training layer 1, epoch 28, cost -111.191181
Pre-training layer 1, epoch 29, cost -110.961528931
Pre-training layer 1, epoch 30, cost -110.806659836
Pre-training layer 1, epoch 30, representative training free energy -260422.117195
Pre-training layer 1, epoch 30, validation free energy -258402.854898
Pre-training layer 1, epoch 31, cost -110.598961884
Pre-training layer 1, epoch 32, cost -110.464575256
Pre-training layer 1, epoch 33, cost -110.271191071
Pre-training layer 1, epoch 34, cost -110.134782684
Pre-training layer 1, epoch 35, cost -110.075298996
Pre-training layer 1, epoch 35, representative training free energy -266914.194594
Pre-training layer 1, epoch 35, validation free energy -264828.019719
Pre-training layer 1, epoch 36, cost -109.923090561
Pre-training layer 1, epoch 37, cost -109.688715195
Pre-training layer 1, epoch 38, cost -109.64639299
Pre-training layer 1, epoch 39, cost -109.578914825
Pre-training layer 1, epoch 40, cost -109.557768814
Pre-training layer 1, epoch 40, representative training free energy -272887.63807
Pre-training layer 1, epoch 40, validation free energy -270698.242977
Pre-training layer 1, epoch 41, cost -109.311088516
Pre-training layer 1, epoch 42, cost -109.128582367
Pre-training layer 1, epoch 43, cost -109.084063309
Pre-training layer 1, epoch 44, cost -108.994334091
Pre-training layer 1, epoch 45, cost -108.955554504
Pre-training layer 1, epoch 45, representative training free energy -277587.501055
Pre-training layer 1, epoch 45, validation free energy -275358.228031
Pre-training layer 1, epoch 46, cost -108.828081619
Pre-training layer 1, epoch 47, cost -108.682936371
Pre-training layer 1, epoch 48, cost -108.603359421
Pre-training layer 1, epoch 49, cost -108.544794998
Pre-training layer 1, epoch 50, cost -108.445976974
Pre-training layer 1, epoch 50, representative training free energy -282218.267727
Pre-training layer 1, epoch 50, validation free energy -279992.075195
Pre-training layer 1, epoch 51, cost -108.386075851
Pre-training layer 1, epoch 52, cost -108.283511566
Pre-training layer 1, epoch 53, cost -108.230086441
Pre-training layer 1, epoch 54, cost -108.162786728
Pre-training layer 1, epoch 55, cost -108.062619293
Pre-training layer 1, epoch 55, representative training free energy -286731.27318
Pre-training layer 1, epoch 55, validation free energy -284479.678914
Pre-training layer 1, epoch 56, cost -107.992864716
Pre-training layer 1, epoch 57, cost -107.876683182
Pre-training layer 1, epoch 58, cost -107.867907684
Pre-training layer 1, epoch 59, cost -107.790744446
Pre-training layer 1, epoch 60, cost -107.727483475
Pre-training layer 1, epoch 60, representative training free energy -290634.916844
Pre-training layer 1, epoch 60, validation free energy -288352.222805
Pre-training layer 1, epoch 61, cost -107.632041565
Pre-training layer 1, epoch 62, cost -107.650961838
Pre-training layer 1, epoch 63, cost -107.540266968
Pre-training layer 1, epoch 64, cost -107.539139999
Pre-training layer 1, epoch 65, cost -107.439219101
Pre-training layer 1, epoch 65, representative training free energy -294187.053227
Pre-training layer 1, epoch 65, validation free energy -291835.077492
Pre-training layer 1, epoch 66, cost -107.388087524
Pre-training layer 1, epoch 67, cost -107.407275925
Pre-training layer 1, epoch 68, cost -107.281673523
Pre-training layer 1, epoch 69, cost -107.212772293
Pre-training layer 1, epoch 70, cost -107.241098251
Pre-training layer 1, epoch 70, representative training free energy -297822.666281
Pre-training layer 1, epoch 70, validation free energy -295465.028047
Pre-training layer 1, epoch 71, cost -107.155809982
Pre-training layer 1, epoch 72, cost -107.073594208
Pre-training layer 1, epoch 73, cost -107.121263931
Pre-training layer 1, epoch 74, cost -107.050225861
Pre-training layer 1, epoch 75, cost -107.016934601
Pre-training layer 1, epoch 75, representative training free energy -301280.687258
Pre-training layer 1, epoch 75, validation free energy -298915.177398
Pre-training layer 1, epoch 76, cost -106.997379013
Pre-training layer 1, epoch 77, cost -106.969734314
Pre-training layer 1, epoch 78, cost -106.828995102
Pre-training layer 1, epoch 79, cost -106.801407669
Pre-training layer 1, epoch 80, cost -106.831238037
Pre-training layer 1, epoch 80, representative training free energy -304093.394531
Pre-training layer 1, epoch 80, validation free energy -301701.117641
Pre-training layer 1, epoch 81, cost -106.746932777
Pre-training layer 1, epoch 82, cost -106.746480072
Pre-training layer 1, epoch 83, cost -106.625120377
Pre-training layer 1, epoch 84, cost -106.638586594
Pre-training layer 1, epoch 85, cost -106.63026123
Pre-training layer 1, epoch 85, representative training free energy -307114.283219
Pre-training layer 1, epoch 85, validation free energy -304659.912281
Pre-training layer 1, epoch 86, cost -106.604195992
Pre-training layer 1, epoch 87, cost -106.634723083
Pre-training layer 1, epoch 88, cost -106.44012851
Pre-training layer 1, epoch 89, cost -106.462540771
Pre-training layer 1, epoch 90, cost -106.434348526
Pre-training layer 1, epoch 90, representative training free energy -309629.581984
Pre-training layer 1, epoch 90, validation free energy -307114.054703
Pre-training layer 1, epoch 91, cost -106.402092911
Pre-training layer 1, epoch 92, cost -106.338313477
Pre-training layer 1, epoch 93, cost -106.302573105
Pre-training layer 1, epoch 94, cost -106.364654053
Pre-training layer 1, epoch 95, cost -106.23313279
Pre-training layer 1, epoch 95, representative training free energy -312246.347602
Pre-training layer 1, epoch 95, validation free energy -309745.403227
Pre-training layer 1, epoch 96, cost -106.261425888
Pre-training layer 1, epoch 97, cost -106.25495462
Pre-training layer 1, epoch 98, cost -106.238306229
Pre-training layer 1, epoch 99, cost -106.254456772
Pre-training layer 2, epoch 0, cost -101.191573288
Pre-training layer 2, epoch 0, representative training free energy 9177.82652588
Pre-training layer 2, epoch 0, validation free energy 9067.09294043
Pre-training layer 2, epoch 1, cost -78.1468011551
Pre-training layer 2, epoch 2, cost -72.7259421692
Pre-training layer 2, epoch 3, cost -69.8456985321
Pre-training layer 2, epoch 4, cost -68.0622450027
Pre-training layer 2, epoch 5, cost -66.6114789505
Pre-training layer 2, epoch 5, representative training free energy 21095.695793
Pre-training layer 2, epoch 5, validation free energy 20902.2300317
Pre-training layer 2, epoch 6, cost -65.554163765
Pre-training layer 2, epoch 7, cost -64.7876233749
Pre-training layer 2, epoch 8, cost -64.0524936371
Pre-training layer 2, epoch 9, cost -63.4565991592
Pre-training layer 2, epoch 10, cost -62.9526466827
Pre-training layer 2, epoch 10, representative training free energy 28830.3611846
Pre-training layer 2, epoch 10, validation free energy 28587.8764971
Pre-training layer 2, epoch 11, cost -62.4819288483
Pre-training layer 2, epoch 12, cost -62.1891214828
Pre-training layer 2, epoch 13, cost -61.7862856827
Pre-training layer 2, epoch 14, cost -61.5014878998
Pre-training layer 2, epoch 15, cost -61.2721759186
Pre-training layer 2, epoch 15, representative training free energy 34808.6988691
Pre-training layer 2, epoch 15, validation free energy 34527.6234219
Pre-training layer 2, epoch 16, cost -60.9016364212
Pre-training layer 2, epoch 17, cost -60.7868923721
Pre-training layer 2, epoch 18, cost -60.5408974762
Pre-training layer 2, epoch 19, cost -60.3364745331
Pre-training layer 2, epoch 20, cost -60.2153751373
Pre-training layer 2, epoch 20, representative training free energy 39583.818083
Pre-training layer 2, epoch 20, validation free energy 39272.6434043
Pre-training layer 2, epoch 21, cost -59.961598587
Pre-training layer 2, epoch 22, cost -59.7961419754
Pre-training layer 2, epoch 23, cost -59.6642888184
Pre-training layer 2, epoch 24, cost -59.5152190933
Pre-training layer 2, epoch 25, cost -59.3501436234
Pre-training layer 2, epoch 25, representative training free energy 43929.5642656
Pre-training layer 2, epoch 25, validation free energy 43591.5591836
Pre-training layer 2, epoch 26, cost -59.328624176
Pre-training layer 2, epoch 27, cost -59.1892272339
Pre-training layer 2, epoch 28, cost -59.0512858734
Pre-training layer 2, epoch 29, cost -58.906496582
Pre-training layer 2, epoch 30, cost -58.7973029022
Pre-training layer 2, epoch 30, representative training free energy 47346.2327813
Pre-training layer 2, epoch 30, validation free energy 46982.0560645
Pre-training layer 2, epoch 31, cost -58.7307400436
Pre-training layer 2, epoch 32, cost -58.7088032913
Pre-training layer 2, epoch 33, cost -58.5289165955
Pre-training layer 2, epoch 34, cost -58.4631476517
Pre-training layer 2, epoch 35, cost -58.3223946915
Pre-training layer 2, epoch 35, representative training free energy 50630.7097852
Pre-training layer 2, epoch 35, validation free energy 50260.3695488
Pre-training layer 2, epoch 36, cost -58.2609070282
Pre-training layer 2, epoch 37, cost -58.1769656906
Pre-training layer 2, epoch 38, cost -58.1253307343
Pre-training layer 2, epoch 39, cost -58.0656164932
Pre-training layer 2, epoch 40, cost -57.9450023575
Pre-training layer 2, epoch 40, representative training free energy 53470.782543
Pre-training layer 2, epoch 40, validation free energy 53084.3347051
Pre-training layer 2, epoch 41, cost -57.8652517929
Pre-training layer 2, epoch 42, cost -57.8889594574
Pre-training layer 2, epoch 43, cost -57.8107196274
Pre-training layer 2, epoch 44, cost -57.7075306854
Pre-training layer 2, epoch 45, cost -57.6975322189
Pre-training layer 2, epoch 45, representative training free energy 56027.7660449
Pre-training layer 2, epoch 45, validation free energy 55621.9264023
Pre-training layer 2, epoch 46, cost -57.5949711151
Pre-training layer 2, epoch 47, cost -57.5872442551
Pre-training layer 2, epoch 48, cost -57.52531987
Pre-training layer 2, epoch 49, cost -57.4586312943
Pre-training layer 2, epoch 50, cost -57.3734057617
Pre-training layer 2, epoch 50, representative training free energy 58529.5627813
Pre-training layer 2, epoch 50, validation free energy 58114.4117578
Pre-training layer 2, epoch 51, cost -57.389646431
Pre-training layer 2, epoch 52, cost -57.2684256897
Pre-training layer 2, epoch 53, cost -57.2457135391
Pre-training layer 2, epoch 54, cost -57.1518213348
Pre-training layer 2, epoch 55, cost -57.2053733292
Pre-training layer 2, epoch 55, representative training free energy 61182.6308809
Pre-training layer 2, epoch 55, validation free energy 60738.508209
Pre-training layer 2, epoch 56, cost -57.1108946838
Pre-training layer 2, epoch 57, cost -57.0731231155
Pre-training layer 2, epoch 58, cost -57.0663755646
Pre-training layer 2, epoch 59, cost -57.0263304977
Pre-training layer 2, epoch 60, cost -56.9615918579
Pre-training layer 2, epoch 60, representative training free energy 63371.431793
Pre-training layer 2, epoch 60, validation free energy 62927.255832
Pre-training layer 2, epoch 61, cost -56.936482399
Pre-training layer 2, epoch 62, cost -56.8335269394
Pre-training layer 2, epoch 63, cost -56.8287890854
Pre-training layer 2, epoch 64, cost -56.8094092407
Pre-training layer 2, epoch 65, cost -56.7756205368
Pre-training layer 2, epoch 65, representative training free energy 65605.7464531
Pre-training layer 2, epoch 65, validation free energy 65142.9152168
Pre-training layer 2, epoch 66, cost -56.7209732819
Pre-training layer 2, epoch 67, cost -56.6754133072
Pre-training layer 2, epoch 68, cost -56.6431043167
Pre-training layer 2, epoch 69, cost -56.5682350311
Pre-training layer 2, epoch 70, cost -56.5743832932
Pre-training layer 2, epoch 70, representative training free energy 67657.5520195
Pre-training layer 2, epoch 70, validation free energy 67176.5248535
Pre-training layer 2, epoch 71, cost -56.5881549835
Pre-training layer 2, epoch 72, cost -56.5319011993
Pre-training layer 2, epoch 73, cost -56.5024219666
Pre-training layer 2, epoch 74, cost -56.4339597244
Pre-training layer 2, epoch 75, cost -56.446733284
Pre-training layer 2, epoch 75, representative training free energy 69619.8322676
Pre-training layer 2, epoch 75, validation free energy 69136.4572109
Pre-training layer 2, epoch 76, cost -56.4305429993
Pre-training layer 2, epoch 77, cost -56.342020752
Pre-training layer 2, epoch 78, cost -56.3421274185
Pre-training layer 2, epoch 79, cost -56.3108384247
Pre-training layer 2, epoch 80, cost -56.3091111374
Pre-training layer 2, epoch 80, representative training free energy 71306.6825469
Pre-training layer 2, epoch 80, validation free energy 70829.2941699
Pre-training layer 2, epoch 81, cost -56.2463286819
Pre-training layer 2, epoch 82, cost -56.3321456985
Pre-training layer 2, epoch 83, cost -56.1947939148
Pre-training layer 2, epoch 84, cost -56.2539485779
Pre-training layer 2, epoch 85, cost -56.2047458267
Pre-training layer 2, epoch 85, representative training free energy 73322.1267246
Pre-training layer 2, epoch 85, validation free energy 72821.6692832
Pre-training layer 2, epoch 86, cost -56.2174458084
Pre-training layer 2, epoch 87, cost -56.1126984406
Pre-training layer 2, epoch 88, cost -56.0965078659
Pre-training layer 2, epoch 89, cost -56.1143282471
Pre-training layer 2, epoch 90, cost -56.06806633
Pre-training layer 2, epoch 90, representative training free energy 74730.5438184
Pre-training layer 2, epoch 90, validation free energy 74220.3306641
Pre-training layer 2, epoch 91, cost -56.0644800186
Pre-training layer 2, epoch 92, cost -56.0869722061
Pre-training layer 2, epoch 93, cost -56.050181282
Pre-training layer 2, epoch 94, cost -56.0191297836
Pre-training layer 2, epoch 95, cost -55.972908783
Pre-training layer 2, epoch 95, representative training free energy 76363.3030996
Pre-training layer 2, epoch 95, validation free energy 75848.684375
Pre-training layer 2, epoch 96, cost -55.9333148041
Pre-training layer 2, epoch 97, cost -55.9088114853
Pre-training layer 2, epoch 98, cost -55.8650823288
Pre-training layer 2, epoch 99, cost -55.8852513809
The pretraining code for file dbn_loop.pyc ran for 4.66m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 14.300000 %
     epoch 1, minibatch 500/500, test error of best model 15.700000 %
epoch 2, minibatch 500/500, validation error 10.200000 %
     epoch 2, minibatch 500/500, test error of best model 10.500000 %
epoch 3, minibatch 500/500, validation error 8.200000 %
     epoch 3, minibatch 500/500, test error of best model 8.200000 %
epoch 4, minibatch 500/500, validation error 7.400000 %
     epoch 4, minibatch 500/500, test error of best model 6.800000 %
epoch 5, minibatch 500/500, validation error 6.800000 %
     epoch 5, minibatch 500/500, test error of best model 5.900000 %
epoch 6, minibatch 500/500, validation error 6.400000 %
     epoch 6, minibatch 500/500, test error of best model 5.900000 %
epoch 7, minibatch 500/500, validation error 6.000000 %
     epoch 7, minibatch 500/500, test error of best model 5.300000 %
epoch 8, minibatch 500/500, validation error 5.900000 %
     epoch 8, minibatch 500/500, test error of best model 5.400000 %
epoch 9, minibatch 500/500, validation error 5.800000 %
     epoch 9, minibatch 500/500, test error of best model 5.100000 %
epoch 10, minibatch 500/500, validation error 5.600000 %
     epoch 10, minibatch 500/500, test error of best model 5.000000 %
epoch 11, minibatch 500/500, validation error 5.500000 %
     epoch 11, minibatch 500/500, test error of best model 5.000000 %
epoch 12, minibatch 500/500, validation error 5.500000 %
epoch 13, minibatch 500/500, validation error 5.500000 %
epoch 14, minibatch 500/500, validation error 5.500000 %
epoch 15, minibatch 500/500, validation error 5.600000 %
epoch 16, minibatch 500/500, validation error 5.600000 %
epoch 17, minibatch 500/500, validation error 5.600000 %
epoch 18, minibatch 500/500, validation error 5.600000 %
epoch 19, minibatch 500/500, validation error 5.500000 %
epoch 20, minibatch 500/500, validation error 5.500000 %
epoch 21, minibatch 500/500, validation error 5.500000 %
Optimization complete with best validation score of 5.500000 %, obtained at iteration 5500, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.45m


==========Layers: [1000, 1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.9612379
Pre-training layer 0, epoch 0, representative training free energy -404.541421753
Pre-training layer 0, epoch 0, validation free energy -398.908321106
Pre-training layer 0, epoch 1, cost -96.6276899109
Pre-training layer 0, epoch 2, cost -91.0208889465
Pre-training layer 0, epoch 3, cost -87.8787467957
Pre-training layer 0, epoch 4, cost -85.5806107407
Pre-training layer 0, epoch 5, cost -84.1355000381
Pre-training layer 0, epoch 5, representative training free energy -352.311790527
Pre-training layer 0, epoch 5, validation free energy -345.235740005
Pre-training layer 0, epoch 6, cost -83.078302002
Pre-training layer 0, epoch 7, cost -82.0239387817
Pre-training layer 0, epoch 8, cost -81.215481842
Pre-training layer 0, epoch 9, cost -80.4661676254
Pre-training layer 0, epoch 10, cost -79.9457835464
Pre-training layer 0, epoch 10, representative training free energy -340.768125641
Pre-training layer 0, epoch 10, validation free energy -333.612988312
Pre-training layer 0, epoch 11, cost -79.134596962
Pre-training layer 0, epoch 12, cost -78.7443602448
Pre-training layer 0, epoch 13, cost -78.4528551254
Pre-training layer 0, epoch 14, cost -77.9735456619
Pre-training layer 0, epoch 15, cost -77.5697766342
Pre-training layer 0, epoch 15, representative training free energy -337.261189484
Pre-training layer 0, epoch 15, validation free energy -328.559265121
Pre-training layer 0, epoch 16, cost -77.1983059235
Pre-training layer 0, epoch 17, cost -76.8699220963
Pre-training layer 0, epoch 18, cost -76.6183868408
Pre-training layer 0, epoch 19, cost -76.3212971573
Pre-training layer 0, epoch 20, cost -76.1499124756
Pre-training layer 0, epoch 20, representative training free energy -327.85565181
Pre-training layer 0, epoch 20, validation free energy -318.770082657
Pre-training layer 0, epoch 21, cost -75.951540802
Pre-training layer 0, epoch 22, cost -75.6283540573
Pre-training layer 0, epoch 23, cost -75.466275116
Pre-training layer 0, epoch 24, cost -75.2182052689
Pre-training layer 0, epoch 25, cost -75.014885231
Pre-training layer 0, epoch 25, representative training free energy -327.894811661
Pre-training layer 0, epoch 25, validation free energy -319.749627396
Pre-training layer 0, epoch 26, cost -74.9042924347
Pre-training layer 0, epoch 27, cost -74.6790054474
Pre-training layer 0, epoch 28, cost -74.5540326309
Pre-training layer 0, epoch 29, cost -74.3670143356
Pre-training layer 0, epoch 30, cost -74.1811249084
Pre-training layer 0, epoch 30, representative training free energy -322.877658539
Pre-training layer 0, epoch 30, validation free energy -313.707034805
Pre-training layer 0, epoch 31, cost -74.1206117935
Pre-training layer 0, epoch 32, cost -73.9180513535
Pre-training layer 0, epoch 33, cost -73.8258357773
Pre-training layer 0, epoch 34, cost -73.6947553864
Pre-training layer 0, epoch 35, cost -73.6367971497
Pre-training layer 0, epoch 35, representative training free energy -322.139694107
Pre-training layer 0, epoch 35, validation free energy -312.046089539
Pre-training layer 0, epoch 36, cost -73.4465200653
Pre-training layer 0, epoch 37, cost -73.3684785156
Pre-training layer 0, epoch 38, cost -73.3220133133
Pre-training layer 0, epoch 39, cost -73.0619897842
Pre-training layer 0, epoch 40, cost -73.0747938004
Pre-training layer 0, epoch 40, representative training free energy -317.372148346
Pre-training layer 0, epoch 40, validation free energy -307.175440781
Pre-training layer 0, epoch 41, cost -72.9190124817
Pre-training layer 0, epoch 42, cost -72.7285002213
Pre-training layer 0, epoch 43, cost -72.6478430786
Pre-training layer 0, epoch 44, cost -72.5413279877
Pre-training layer 0, epoch 45, cost -72.5434189758
Pre-training layer 0, epoch 45, representative training free energy -312.049502716
Pre-training layer 0, epoch 45, validation free energy -301.491172791
Pre-training layer 0, epoch 46, cost -72.4444311981
Pre-training layer 0, epoch 47, cost -72.3155301208
Pre-training layer 0, epoch 48, cost -72.2295760956
Pre-training layer 0, epoch 49, cost -72.2263030014
Pre-training layer 0, epoch 50, cost -72.1086609268
Pre-training layer 0, epoch 50, representative training free energy -305.711767029
Pre-training layer 0, epoch 50, validation free energy -295.708683792
Pre-training layer 0, epoch 51, cost -72.0386001587
Pre-training layer 0, epoch 52, cost -72.0122833405
Pre-training layer 0, epoch 53, cost -71.8258096848
Pre-training layer 0, epoch 54, cost -71.7979033813
Pre-training layer 0, epoch 55, cost -71.7593998566
Pre-training layer 0, epoch 55, representative training free energy -307.623572113
Pre-training layer 0, epoch 55, validation free energy -296.727955734
Pre-training layer 0, epoch 56, cost -71.6357154999
Pre-training layer 0, epoch 57, cost -71.5625385895
Pre-training layer 0, epoch 58, cost -71.4850790405
Pre-training layer 0, epoch 59, cost -71.4043692627
Pre-training layer 0, epoch 60, cost -71.3425650635
Pre-training layer 0, epoch 60, representative training free energy -302.063729141
Pre-training layer 0, epoch 60, validation free energy -291.413486267
Pre-training layer 0, epoch 61, cost -71.3107751541
Pre-training layer 0, epoch 62, cost -71.236029808
Pre-training layer 0, epoch 63, cost -71.1694468994
Pre-training layer 0, epoch 64, cost -71.0817700424
Pre-training layer 0, epoch 65, cost -71.1188489685
Pre-training layer 0, epoch 65, representative training free energy -295.44712883
Pre-training layer 0, epoch 65, validation free energy -284.632529694
Pre-training layer 0, epoch 66, cost -70.9864585953
Pre-training layer 0, epoch 67, cost -70.8791678543
Pre-training layer 0, epoch 68, cost -70.838379921
Pre-training layer 0, epoch 69, cost -70.8065820541
Pre-training layer 0, epoch 70, cost -70.7582901993
Pre-training layer 0, epoch 70, representative training free energy -291.113825424
Pre-training layer 0, epoch 70, validation free energy -280.082648682
Pre-training layer 0, epoch 71, cost -70.7223617172
Pre-training layer 0, epoch 72, cost -70.7506195831
Pre-training layer 0, epoch 73, cost -70.6262008972
Pre-training layer 0, epoch 74, cost -70.6285410233
Pre-training layer 0, epoch 75, cost -70.4864766312
Pre-training layer 0, epoch 75, representative training free energy -291.93301088
Pre-training layer 0, epoch 75, validation free energy -278.983969452
Pre-training layer 0, epoch 76, cost -70.4808448715
Pre-training layer 0, epoch 77, cost -70.4254013138
Pre-training layer 0, epoch 78, cost -70.3822949142
Pre-training layer 0, epoch 79, cost -70.2810017776
Pre-training layer 0, epoch 80, cost -70.2508969116
Pre-training layer 0, epoch 80, representative training free energy -284.311757736
Pre-training layer 0, epoch 80, validation free energy -271.314920517
Pre-training layer 0, epoch 81, cost -70.1436673279
Pre-training layer 0, epoch 82, cost -70.0409618225
Pre-training layer 0, epoch 83, cost -70.0609464111
Pre-training layer 0, epoch 84, cost -69.9850565338
Pre-training layer 0, epoch 85, cost -69.9034123077
Pre-training layer 0, epoch 85, representative training free energy -282.621309937
Pre-training layer 0, epoch 85, validation free energy -270.603348373
Pre-training layer 0, epoch 86, cost -69.8959302216
Pre-training layer 0, epoch 87, cost -69.8556846466
Pre-training layer 0, epoch 88, cost -69.9667793198
Pre-training layer 0, epoch 89, cost -69.8401935272
Pre-training layer 0, epoch 90, cost -69.6972269821
Pre-training layer 0, epoch 90, representative training free energy -279.038025421
Pre-training layer 0, epoch 90, validation free energy -266.501828552
Pre-training layer 0, epoch 91, cost -69.7200379181
Pre-training layer 0, epoch 92, cost -69.6541186371
Pre-training layer 0, epoch 93, cost -69.6403046799
Pre-training layer 0, epoch 94, cost -69.6283748703
Pre-training layer 0, epoch 95, cost -69.5911558151
Pre-training layer 0, epoch 95, representative training free energy -278.53766539
Pre-training layer 0, epoch 95, validation free energy -265.351689804
Pre-training layer 0, epoch 96, cost -69.5910055542
Pre-training layer 0, epoch 97, cost -69.4742595444
Pre-training layer 0, epoch 98, cost -69.3798404388
Pre-training layer 0, epoch 99, cost -69.3815074768
Pre-training layer 1, epoch 0, cost -171.889934677
Pre-training layer 1, epoch 0, representative training free energy -146707.138254
Pre-training layer 1, epoch 0, validation free energy -145631.73402
Pre-training layer 1, epoch 1, cost -141.817067062
Pre-training layer 1, epoch 2, cost -133.422746155
Pre-training layer 1, epoch 3, cost -128.784104584
Pre-training layer 1, epoch 4, cost -125.761652283
Pre-training layer 1, epoch 5, cost -123.512764587
Pre-training layer 1, epoch 5, representative training free energy -202201.625641
Pre-training layer 1, epoch 5, validation free energy -200518.294961
Pre-training layer 1, epoch 6, cost -121.782304214
Pre-training layer 1, epoch 7, cost -120.4069814
Pre-training layer 1, epoch 8, cost -119.330688965
Pre-training layer 1, epoch 9, cost -118.194855774
Pre-training layer 1, epoch 10, cost -117.492272141
Pre-training layer 1, epoch 10, representative training free energy -223485.39882
Pre-training layer 1, epoch 10, validation free energy -221648.647766
Pre-training layer 1, epoch 11, cost -116.638263199
Pre-training layer 1, epoch 12, cost -116.135677414
Pre-training layer 1, epoch 13, cost -115.409986206
Pre-training layer 1, epoch 14, cost -114.880510223
Pre-training layer 1, epoch 15, cost -114.502361969
Pre-training layer 1, epoch 15, representative training free energy -237647.38668
Pre-training layer 1, epoch 15, validation free energy -235630.488211
Pre-training layer 1, epoch 16, cost -114.010518143
Pre-training layer 1, epoch 17, cost -113.619493881
Pre-training layer 1, epoch 18, cost -113.237796082
Pre-training layer 1, epoch 19, cost -113.02960614
Pre-training layer 1, epoch 20, cost -112.529044434
Pre-training layer 1, epoch 20, representative training free energy -249017.547805
Pre-training layer 1, epoch 20, validation free energy -246944.358484
Pre-training layer 1, epoch 21, cost -112.214201599
Pre-training layer 1, epoch 22, cost -111.890826416
Pre-training layer 1, epoch 23, cost -111.721434616
Pre-training layer 1, epoch 24, cost -111.527301422
Pre-training layer 1, epoch 25, cost -111.241938873
Pre-training layer 1, epoch 25, representative training free energy -257582.329875
Pre-training layer 1, epoch 25, validation free energy -255409.629992
Pre-training layer 1, epoch 26, cost -110.992933289
Pre-training layer 1, epoch 27, cost -110.78344606
Pre-training layer 1, epoch 28, cost -110.540974091
Pre-training layer 1, epoch 29, cost -110.3909151
Pre-training layer 1, epoch 30, cost -110.252167725
Pre-training layer 1, epoch 30, representative training free energy -265356.331516
Pre-training layer 1, epoch 30, validation free energy -263092.157187
Pre-training layer 1, epoch 31, cost -110.070737305
Pre-training layer 1, epoch 32, cost -109.906364059
Pre-training layer 1, epoch 33, cost -109.800876266
Pre-training layer 1, epoch 34, cost -109.60054863
Pre-training layer 1, epoch 35, cost -109.484158218
Pre-training layer 1, epoch 35, representative training free energy -271782.417742
Pre-training layer 1, epoch 35, validation free energy -269478.484891
Pre-training layer 1, epoch 36, cost -109.317695236
Pre-training layer 1, epoch 37, cost -109.231108078
Pre-training layer 1, epoch 38, cost -109.094076813
Pre-training layer 1, epoch 39, cost -108.884220001
Pre-training layer 1, epoch 40, cost -108.862090073
Pre-training layer 1, epoch 40, representative training free energy -277562.743383
Pre-training layer 1, epoch 40, validation free energy -275214.681023
Pre-training layer 1, epoch 41, cost -108.825196075
Pre-training layer 1, epoch 42, cost -108.683726318
Pre-training layer 1, epoch 43, cost -108.603692169
Pre-training layer 1, epoch 44, cost -108.403593552
Pre-training layer 1, epoch 45, cost -108.388062576
Pre-training layer 1, epoch 45, representative training free energy -282951.158969
Pre-training layer 1, epoch 45, validation free energy -280564.866734
Pre-training layer 1, epoch 46, cost -108.276108841
Pre-training layer 1, epoch 47, cost -108.176179718
Pre-training layer 1, epoch 48, cost -108.016214897
Pre-training layer 1, epoch 49, cost -108.00468158
Pre-training layer 1, epoch 50, cost -107.930610504
Pre-training layer 1, epoch 50, representative training free energy -287993.150547
Pre-training layer 1, epoch 50, validation free energy -285587.001563
Pre-training layer 1, epoch 51, cost -107.894229736
Pre-training layer 1, epoch 52, cost -107.719355255
Pre-training layer 1, epoch 53, cost -107.645499611
Pre-training layer 1, epoch 54, cost -107.585480453
Pre-training layer 1, epoch 55, cost -107.537399124
Pre-training layer 1, epoch 55, representative training free energy -292043.421922
Pre-training layer 1, epoch 55, validation free energy -289623.709781
Pre-training layer 1, epoch 56, cost -107.517836845
Pre-training layer 1, epoch 57, cost -107.455634186
Pre-training layer 1, epoch 58, cost -107.322265182
Pre-training layer 1, epoch 59, cost -107.307387253
Pre-training layer 1, epoch 60, cost -107.260201393
Pre-training layer 1, epoch 60, representative training free energy -295880.310625
Pre-training layer 1, epoch 60, validation free energy -293393.300602
Pre-training layer 1, epoch 61, cost -107.226192947
Pre-training layer 1, epoch 62, cost -107.098921875
Pre-training layer 1, epoch 63, cost -107.109669479
Pre-training layer 1, epoch 64, cost -107.03126667
Pre-training layer 1, epoch 65, cost -106.972392448
Pre-training layer 1, epoch 65, representative training free energy -299297.676539
Pre-training layer 1, epoch 65, validation free energy -296817.915977
Pre-training layer 1, epoch 66, cost -106.92812191
Pre-training layer 1, epoch 67, cost -106.824203621
Pre-training layer 1, epoch 68, cost -106.76310009
Pre-training layer 1, epoch 69, cost -106.789630264
Pre-training layer 1, epoch 70, cost -106.744621468
Pre-training layer 1, epoch 70, representative training free energy -303419.957617
Pre-training layer 1, epoch 70, validation free energy -300956.868664
Pre-training layer 1, epoch 71, cost -106.730427879
Pre-training layer 1, epoch 72, cost -106.627512756
Pre-training layer 1, epoch 73, cost -106.554655968
Pre-training layer 1, epoch 74, cost -106.570121445
Pre-training layer 1, epoch 75, cost -106.541789513
Pre-training layer 1, epoch 75, representative training free energy -306703.620844
Pre-training layer 1, epoch 75, validation free energy -304204.267305
Pre-training layer 1, epoch 76, cost -106.455169281
Pre-training layer 1, epoch 77, cost -106.472453255
Pre-training layer 1, epoch 78, cost -106.481697052
Pre-training layer 1, epoch 79, cost -106.331858337
Pre-training layer 1, epoch 80, cost -106.317072968
Pre-training layer 1, epoch 80, representative training free energy -309895.407508
Pre-training layer 1, epoch 80, validation free energy -307371.411789
Pre-training layer 1, epoch 81, cost -106.314527878
Pre-training layer 1, epoch 82, cost -106.211215393
Pre-training layer 1, epoch 83, cost -106.205138237
Pre-training layer 1, epoch 84, cost -106.1798293
Pre-training layer 1, epoch 85, cost -106.080485611
Pre-training layer 1, epoch 85, representative training free energy -312700.578102
Pre-training layer 1, epoch 85, validation free energy -310126.794563
Pre-training layer 1, epoch 86, cost -106.053247406
Pre-training layer 1, epoch 87, cost -106.074079231
Pre-training layer 1, epoch 88, cost -106.087085579
Pre-training layer 1, epoch 89, cost -105.967387421
Pre-training layer 1, epoch 90, cost -105.945129875
Pre-training layer 1, epoch 90, representative training free energy -314907.591703
Pre-training layer 1, epoch 90, validation free energy -312302.08868
Pre-training layer 1, epoch 91, cost -105.973104836
Pre-training layer 1, epoch 92, cost -105.877470032
Pre-training layer 1, epoch 93, cost -105.947212639
Pre-training layer 1, epoch 94, cost -105.912326401
Pre-training layer 1, epoch 95, cost -105.887682877
Pre-training layer 1, epoch 95, representative training free energy -317798.539164
Pre-training layer 1, epoch 95, validation free energy -315212.470359
Pre-training layer 1, epoch 96, cost -105.825443947
Pre-training layer 1, epoch 97, cost -105.787559242
Pre-training layer 1, epoch 98, cost -105.870916595
Pre-training layer 1, epoch 99, cost -105.759594864
Pre-training layer 2, epoch 0, cost -101.78833255
Pre-training layer 2, epoch 0, representative training free energy 9485.15752905
Pre-training layer 2, epoch 0, validation free energy 9367.17454517
Pre-training layer 2, epoch 1, cost -78.8938786545
Pre-training layer 2, epoch 2, cost -73.6833739929
Pre-training layer 2, epoch 3, cost -70.6749753952
Pre-training layer 2, epoch 4, cost -68.7612902298
Pre-training layer 2, epoch 5, cost -67.4391778107
Pre-training layer 2, epoch 5, representative training free energy 20702.5570718
Pre-training layer 2, epoch 5, validation free energy 20500.49571
Pre-training layer 2, epoch 6, cost -66.3530997467
Pre-training layer 2, epoch 7, cost -65.4788393326
Pre-training layer 2, epoch 8, cost -64.828078804
Pre-training layer 2, epoch 9, cost -64.2887725906
Pre-training layer 2, epoch 10, cost -63.7565779037
Pre-training layer 2, epoch 10, representative training free energy 29591.7583369
Pre-training layer 2, epoch 10, validation free energy 29334.985623
Pre-training layer 2, epoch 11, cost -63.3398595734
Pre-training layer 2, epoch 12, cost -62.978111824
Pre-training layer 2, epoch 13, cost -62.6230924454
Pre-training layer 2, epoch 14, cost -62.3264386215
Pre-training layer 2, epoch 15, cost -62.0482854843
Pre-training layer 2, epoch 15, representative training free energy 36624.4673779
Pre-training layer 2, epoch 15, validation free energy 36335.0053701
Pre-training layer 2, epoch 16, cost -61.7196975861
Pre-training layer 2, epoch 17, cost -61.5237152405
Pre-training layer 2, epoch 18, cost -61.3411283875
Pre-training layer 2, epoch 19, cost -61.102602356
Pre-training layer 2, epoch 20, cost -60.9177842178
Pre-training layer 2, epoch 20, representative training free energy 42221.5616895
Pre-training layer 2, epoch 20, validation free energy 41904.9711709
Pre-training layer 2, epoch 21, cost -60.7767931824
Pre-training layer 2, epoch 22, cost -60.5966851578
Pre-training layer 2, epoch 23, cost -60.4576233749
Pre-training layer 2, epoch 24, cost -60.2407053146
Pre-training layer 2, epoch 25, cost -60.1232892075
Pre-training layer 2, epoch 25, representative training free energy 47142.1928018
Pre-training layer 2, epoch 25, validation free energy 46799.7126318
Pre-training layer 2, epoch 26, cost -60.0350646667
Pre-training layer 2, epoch 27, cost -59.9017152176
Pre-training layer 2, epoch 28, cost -59.8087184982
Pre-training layer 2, epoch 29, cost -59.7079750748
Pre-training layer 2, epoch 30, cost -59.5814997177
Pre-training layer 2, epoch 30, representative training free energy 51557.7412852
Pre-training layer 2, epoch 30, validation free energy 51204.2516699
Pre-training layer 2, epoch 31, cost -59.4598770142
Pre-training layer 2, epoch 32, cost -59.355786644
Pre-training layer 2, epoch 33, cost -59.3191530914
Pre-training layer 2, epoch 34, cost -59.1888405762
Pre-training layer 2, epoch 35, cost -59.032353508
Pre-training layer 2, epoch 35, representative training free energy 55483.4204805
Pre-training layer 2, epoch 35, validation free energy 55122.4064297
Pre-training layer 2, epoch 36, cost -59.0480592194
Pre-training layer 2, epoch 37, cost -58.9869835052
Pre-training layer 2, epoch 38, cost -58.9529560089
Pre-training layer 2, epoch 39, cost -58.7478178101
Pre-training layer 2, epoch 40, cost -58.7701474304
Pre-training layer 2, epoch 40, representative training free energy 59060.4617754
Pre-training layer 2, epoch 40, validation free energy 58676.9705625
Pre-training layer 2, epoch 41, cost -58.6692255096
Pre-training layer 2, epoch 42, cost -58.6492970505
Pre-training layer 2, epoch 43, cost -58.5799492493
Pre-training layer 2, epoch 44, cost -58.3446914597
Pre-training layer 2, epoch 45, cost -58.3748030243
Pre-training layer 2, epoch 45, representative training free energy 62414.9669297
Pre-training layer 2, epoch 45, validation free energy 62008.7863086
Pre-training layer 2, epoch 46, cost -58.3413506088
Pre-training layer 2, epoch 47, cost -58.3620474701
Pre-training layer 2, epoch 48, cost -58.2430593643
Pre-training layer 2, epoch 49, cost -58.202796524
Pre-training layer 2, epoch 50, cost -58.1142738647
Pre-training layer 2, epoch 50, representative training free energy 65388.8935156
Pre-training layer 2, epoch 50, validation free energy 64976.0558242
Pre-training layer 2, epoch 51, cost -58.0824184189
Pre-training layer 2, epoch 52, cost -58.0763997574
Pre-training layer 2, epoch 53, cost -58.0029140015
Pre-training layer 2, epoch 54, cost -57.9365617523
Pre-training layer 2, epoch 55, cost -57.9373421249
Pre-training layer 2, epoch 55, representative training free energy 68493.0684258
Pre-training layer 2, epoch 55, validation free energy 68061.3582402
Pre-training layer 2, epoch 56, cost -57.7964062042
Pre-training layer 2, epoch 57, cost -57.7578087082
Pre-training layer 2, epoch 58, cost -57.719443512
Pre-training layer 2, epoch 59, cost -57.678875145
Pre-training layer 2, epoch 60, cost -57.685537735
Pre-training layer 2, epoch 60, representative training free energy 70770.0360527
Pre-training layer 2, epoch 60, validation free energy 70319.306668
Pre-training layer 2, epoch 61, cost -57.6512711792
Pre-training layer 2, epoch 62, cost -57.6472615509
Pre-training layer 2, epoch 63, cost -57.5791539001
Pre-training layer 2, epoch 64, cost -57.5877599487
Pre-training layer 2, epoch 65, cost -57.5031951904
Pre-training layer 2, epoch 65, representative training free energy 73359.0553418
Pre-training layer 2, epoch 65, validation free energy 72902.4235117
Pre-training layer 2, epoch 66, cost -57.4697472534
Pre-training layer 2, epoch 67, cost -57.5295989456
Pre-training layer 2, epoch 68, cost -57.4238226547
Pre-training layer 2, epoch 69, cost -57.3496523438
Pre-training layer 2, epoch 70, cost -57.383793541
Pre-training layer 2, epoch 70, representative training free energy 75274.9564863
Pre-training layer 2, epoch 70, validation free energy 74784.7868086
Pre-training layer 2, epoch 71, cost -57.3360349197
Pre-training layer 2, epoch 72, cost -57.2976509399
Pre-training layer 2, epoch 73, cost -57.2470923615
Pre-training layer 2, epoch 74, cost -57.2413833008
Pre-training layer 2, epoch 75, cost -57.2102597046
Pre-training layer 2, epoch 75, representative training free energy 77591.9091328
Pre-training layer 2, epoch 75, validation free energy 77065.1332578
Pre-training layer 2, epoch 76, cost -57.1577251129
Pre-training layer 2, epoch 77, cost -57.1886368484
Pre-training layer 2, epoch 78, cost -57.1306274261
Pre-training layer 2, epoch 79, cost -57.1002978897
Pre-training layer 2, epoch 80, cost -57.0452685318
Pre-training layer 2, epoch 80, representative training free energy 79774.9779434
Pre-training layer 2, epoch 80, validation free energy 79272.041582
Pre-training layer 2, epoch 81, cost -56.9464931717
Pre-training layer 2, epoch 82, cost -57.0675971375
Pre-training layer 2, epoch 83, cost -57.0998491669
Pre-training layer 2, epoch 84, cost -57.0052114487
Pre-training layer 2, epoch 85, cost -56.900017807
Pre-training layer 2, epoch 85, representative training free energy 81888.3399785
Pre-training layer 2, epoch 85, validation free energy 81381.1932344
Pre-training layer 2, epoch 86, cost -56.9090525513
Pre-training layer 2, epoch 87, cost -56.8357467194
Pre-training layer 2, epoch 88, cost -56.8471434784
Pre-training layer 2, epoch 89, cost -56.8460617065
Pre-training layer 2, epoch 90, cost -56.8244161835
Pre-training layer 2, epoch 90, representative training free energy 83895.9942832
Pre-training layer 2, epoch 90, validation free energy 83344.094916
Pre-training layer 2, epoch 91, cost -56.7987285385
Pre-training layer 2, epoch 92, cost -56.7170162277
Pre-training layer 2, epoch 93, cost -56.7401624908
Pre-training layer 2, epoch 94, cost -56.7270963974
Pre-training layer 2, epoch 95, cost -56.6708516541
Pre-training layer 2, epoch 95, representative training free energy 85543.9946387
Pre-training layer 2, epoch 95, validation free energy 85005.590043
Pre-training layer 2, epoch 96, cost -56.758320694
Pre-training layer 2, epoch 97, cost -56.7382819366
Pre-training layer 2, epoch 98, cost -56.6212761383
Pre-training layer 2, epoch 99, cost -56.6600385666
Pre-training layer 3, epoch 0, cost -137.762871399
Pre-training layer 3, epoch 0, representative training free energy -516309455.392
Pre-training layer 3, epoch 0, validation free energy -512941855.952
Pre-training layer 3, epoch 1, cost -110.109236572
Pre-training layer 3, epoch 2, cost -102.949261902
Pre-training layer 3, epoch 3, cost -99.1790372162
Pre-training layer 3, epoch 4, cost -96.5381644592
Pre-training layer 3, epoch 5, cost -94.8882149506
Pre-training layer 3, epoch 5, representative training free energy -739191575.792
Pre-training layer 3, epoch 5, validation free energy -734036048.48
Pre-training layer 3, epoch 6, cost -93.5733582153
Pre-training layer 3, epoch 7, cost -92.4429664307
Pre-training layer 3, epoch 8, cost -91.5919411163
Pre-training layer 3, epoch 9, cost -90.9507845154
Pre-training layer 3, epoch 10, cost -90.3316301117
Pre-training layer 3, epoch 10, representative training free energy -831128336.224
Pre-training layer 3, epoch 10, validation free energy -825263068.768
Pre-training layer 3, epoch 11, cost -89.8804689636
Pre-training layer 3, epoch 12, cost -89.4415688019
Pre-training layer 3, epoch 13, cost -89.084149025
Pre-training layer 3, epoch 14, cost -88.7281112747
Pre-training layer 3, epoch 15, cost -88.5206306915
Pre-training layer 3, epoch 15, representative training free energy -891842020.416
Pre-training layer 3, epoch 15, validation free energy -885502791.904
Pre-training layer 3, epoch 16, cost -88.2365295792
Pre-training layer 3, epoch 17, cost -87.9674357529
Pre-training layer 3, epoch 18, cost -87.685921936
Pre-training layer 3, epoch 19, cost -87.552360199
Pre-training layer 3, epoch 20, cost -87.334855957
Pre-training layer 3, epoch 20, representative training free energy -936920242.528
Pre-training layer 3, epoch 20, validation free energy -930261909.344
Pre-training layer 3, epoch 21, cost -87.1183119888
Pre-training layer 3, epoch 22, cost -87.0466109695
Pre-training layer 3, epoch 23, cost -86.8281521606
Pre-training layer 3, epoch 24, cost -86.7021777954
Pre-training layer 3, epoch 25, cost -86.6088312607
Pre-training layer 3, epoch 25, representative training free energy -972799430.464
Pre-training layer 3, epoch 25, validation free energy -965846152.032
Pre-training layer 3, epoch 26, cost -86.5219465942
Pre-training layer 3, epoch 27, cost -86.3443661575
Pre-training layer 3, epoch 28, cost -86.2715159836
Pre-training layer 3, epoch 29, cost -86.1195849609
Pre-training layer 3, epoch 30, cost -86.0533935547
Pre-training layer 3, epoch 30, representative training free energy -1004366768.16
Pre-training layer 3, epoch 30, validation free energy -997170703.136
Pre-training layer 3, epoch 31, cost -85.9209831009
Pre-training layer 3, epoch 32, cost -85.8823872986
Pre-training layer 3, epoch 33, cost -85.8286099854
Pre-training layer 3, epoch 34, cost -85.6275830002
Pre-training layer 3, epoch 35, cost -85.5725349045
Pre-training layer 3, epoch 35, representative training free energy -1033099255.84
Pre-training layer 3, epoch 35, validation free energy -1025694188.42
Pre-training layer 3, epoch 36, cost -85.5321206055
Pre-training layer 3, epoch 37, cost -85.5308565521
Pre-training layer 3, epoch 38, cost -85.3434307327
Pre-training layer 3, epoch 39, cost -85.3264360657
Pre-training layer 3, epoch 40, cost -85.2575891876
Pre-training layer 3, epoch 40, representative training free energy -1057482768.45
Pre-training layer 3, epoch 40, validation free energy -1049872449.47
Pre-training layer 3, epoch 41, cost -85.2094600525
Pre-training layer 3, epoch 42, cost -85.0986957092
Pre-training layer 3, epoch 43, cost -85.0197943192
Pre-training layer 3, epoch 44, cost -84.9803895721
Pre-training layer 3, epoch 45, cost -85.0046839371
Pre-training layer 3, epoch 45, representative training free energy -1080792590.37
Pre-training layer 3, epoch 45, validation free energy -1073018175.01
Pre-training layer 3, epoch 46, cost -84.9177828674
Pre-training layer 3, epoch 47, cost -84.8643609543
Pre-training layer 3, epoch 48, cost -84.7655087128
Pre-training layer 3, epoch 49, cost -84.7699368286
Pre-training layer 3, epoch 50, cost -84.6726831207
Pre-training layer 3, epoch 50, representative training free energy -1102069721.95
Pre-training layer 3, epoch 50, validation free energy -1094158719.68
Pre-training layer 3, epoch 51, cost -84.6606376419
Pre-training layer 3, epoch 52, cost -84.5805272217
Pre-training layer 3, epoch 53, cost -84.5432809448
Pre-training layer 3, epoch 54, cost -84.5123462753
Pre-training layer 3, epoch 55, cost -84.5319274063
Pre-training layer 3, epoch 55, representative training free energy -1120612682.37
Pre-training layer 3, epoch 55, validation free energy -1112539498.21
Pre-training layer 3, epoch 56, cost -84.4233797989
Pre-training layer 3, epoch 57, cost -84.3449952087
Pre-training layer 3, epoch 58, cost -84.2716538696
Pre-training layer 3, epoch 59, cost -84.3096237335
Pre-training layer 3, epoch 60, cost -84.3541804886
Pre-training layer 3, epoch 60, representative training free energy -1139296102.91
Pre-training layer 3, epoch 60, validation free energy -1131072189.09
Pre-training layer 3, epoch 61, cost -84.2504676361
Pre-training layer 3, epoch 62, cost -84.208502655
Pre-training layer 3, epoch 63, cost -84.2334804916
Pre-training layer 3, epoch 64, cost -84.1937759628
Pre-training layer 3, epoch 65, cost -84.0841098938
Pre-training layer 3, epoch 65, representative training free energy -1156050843.97
Pre-training layer 3, epoch 65, validation free energy -1147697099.07
Pre-training layer 3, epoch 66, cost -84.0770902863
Pre-training layer 3, epoch 67, cost -84.0673402939
Pre-training layer 3, epoch 68, cost -84.0355035324
Pre-training layer 3, epoch 69, cost -83.9929416428
Pre-training layer 3, epoch 70, cost -83.9639006577
Pre-training layer 3, epoch 70, representative training free energy -1170880970.85
Pre-training layer 3, epoch 70, validation free energy -1162415947.52
Pre-training layer 3, epoch 71, cost -83.999926178
Pre-training layer 3, epoch 72, cost -83.9096485138
Pre-training layer 3, epoch 73, cost -83.8637606964
Pre-training layer 3, epoch 74, cost -83.8462181473
Pre-training layer 3, epoch 75, cost -83.8316830978
Pre-training layer 3, epoch 75, representative training free energy -1185955075.23
Pre-training layer 3, epoch 75, validation free energy -1177379332.29
Pre-training layer 3, epoch 76, cost -83.827836853
Pre-training layer 3, epoch 77, cost -83.8229336548
Pre-training layer 3, epoch 78, cost -83.7536468735
Pre-training layer 3, epoch 79, cost -83.7163335419
Pre-training layer 3, epoch 80, cost -83.703937355
Pre-training layer 3, epoch 80, representative training free energy -1201285513.5
Pre-training layer 3, epoch 80, validation free energy -1192602439.04
Pre-training layer 3, epoch 81, cost -83.7188621826
Pre-training layer 3, epoch 82, cost -83.6512104263
Pre-training layer 3, epoch 83, cost -83.597950592
Pre-training layer 3, epoch 84, cost -83.6291526871
Pre-training layer 3, epoch 85, cost -83.6355206299
Pre-training layer 3, epoch 85, representative training free energy -1215766784.19
Pre-training layer 3, epoch 85, validation free energy -1206979735.01
Pre-training layer 3, epoch 86, cost -83.5282990036
Pre-training layer 3, epoch 87, cost -83.5804715652
Pre-training layer 3, epoch 88, cost -83.4803197021
Pre-training layer 3, epoch 89, cost -83.5283592682
Pre-training layer 3, epoch 90, cost -83.5033126068
Pre-training layer 3, epoch 90, representative training free energy -1226764971.71
Pre-training layer 3, epoch 90, validation free energy -1217903583.33
Pre-training layer 3, epoch 91, cost -83.4641846085
Pre-training layer 3, epoch 92, cost -83.4905728378
Pre-training layer 3, epoch 93, cost -83.4731496887
Pre-training layer 3, epoch 94, cost -83.4146786728
Pre-training layer 3, epoch 95, cost -83.4537068253
Pre-training layer 3, epoch 95, representative training free energy -1238701499.07
Pre-training layer 3, epoch 95, validation free energy -1229740385.09
Pre-training layer 3, epoch 96, cost -83.4170556183
Pre-training layer 3, epoch 97, cost -83.3952541428
Pre-training layer 3, epoch 98, cost -83.3809546432
Pre-training layer 3, epoch 99, cost -83.3276854019
The pretraining code for file dbn_loop.pyc ran for 6.68m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 14.500000 %
     epoch 1, minibatch 500/500, test error of best model 15.600000 %
epoch 2, minibatch 500/500, validation error 10.100000 %
     epoch 2, minibatch 500/500, test error of best model 10.000000 %
epoch 3, minibatch 500/500, validation error 8.700000 %
     epoch 3, minibatch 500/500, test error of best model 7.700000 %
epoch 4, minibatch 500/500, validation error 7.900000 %
     epoch 4, minibatch 500/500, test error of best model 7.100000 %
epoch 5, minibatch 500/500, validation error 7.100000 %
     epoch 5, minibatch 500/500, test error of best model 6.900000 %
epoch 6, minibatch 500/500, validation error 6.600000 %
     epoch 6, minibatch 500/500, test error of best model 5.900000 %
epoch 7, minibatch 500/500, validation error 6.200000 %
     epoch 7, minibatch 500/500, test error of best model 5.700000 %
epoch 8, minibatch 500/500, validation error 5.700000 %
     epoch 8, minibatch 500/500, test error of best model 5.600000 %
epoch 9, minibatch 500/500, validation error 5.300000 %
     epoch 9, minibatch 500/500, test error of best model 5.200000 %
epoch 10, minibatch 500/500, validation error 5.300000 %
     epoch 10, minibatch 500/500, test error of best model 5.200000 %
epoch 11, minibatch 500/500, validation error 5.100000 %
     epoch 11, minibatch 500/500, test error of best model 5.200000 %
epoch 12, minibatch 500/500, validation error 5.300000 %
epoch 13, minibatch 500/500, validation error 5.200000 %
epoch 14, minibatch 500/500, validation error 5.100000 %
epoch 15, minibatch 500/500, validation error 5.000000 %
     epoch 15, minibatch 500/500, test error of best model 4.800000 %
epoch 16, minibatch 500/500, validation error 4.800000 %
     epoch 16, minibatch 500/500, test error of best model 4.800000 %
epoch 17, minibatch 500/500, validation error 4.800000 %
epoch 18, minibatch 500/500, validation error 4.700000 %
     epoch 18, minibatch 500/500, test error of best model 4.800000 %
epoch 19, minibatch 500/500, validation error 4.800000 %
epoch 20, minibatch 500/500, validation error 4.800000 %
epoch 21, minibatch 500/500, validation error 5.100000 %
epoch 22, minibatch 500/500, validation error 5.100000 %
epoch 23, minibatch 500/500, validation error 5.000000 %
epoch 24, minibatch 500/500, validation error 5.200000 %
epoch 25, minibatch 500/500, validation error 5.000000 %
epoch 26, minibatch 500/500, validation error 5.000000 %
epoch 27, minibatch 500/500, validation error 5.000000 %
epoch 28, minibatch 500/500, validation error 5.000000 %
epoch 29, minibatch 500/500, validation error 4.900000 %
epoch 30, minibatch 500/500, validation error 4.900000 %
epoch 31, minibatch 500/500, validation error 5.000000 %
epoch 32, minibatch 500/500, validation error 5.100000 %
epoch 33, minibatch 500/500, validation error 5.100000 %
epoch 34, minibatch 500/500, validation error 5.200000 %
epoch 35, minibatch 500/500, validation error 5.200000 %
Optimization complete with best validation score of 4.700000 %, obtained at iteration 9000, with test performance 4.800000 %
The fine tuning code for file dbn_loop.pyc ran for 0.99m
_______RUN: 2

==========Layers: [1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.887690338
Pre-training layer 0, epoch 0, representative training free energy -406.131694946
Pre-training layer 0, epoch 0, validation free energy -401.273637115
Pre-training layer 0, epoch 1, cost -96.7754278259
Pre-training layer 0, epoch 2, cost -90.9214568329
Pre-training layer 0, epoch 3, cost -87.8404399185
Pre-training layer 0, epoch 4, cost -85.677148674
Pre-training layer 0, epoch 5, cost -84.1362496567
Pre-training layer 0, epoch 5, representative training free energy -356.254546997
Pre-training layer 0, epoch 5, validation free energy -349.532419815
Pre-training layer 0, epoch 6, cost -82.914950264
Pre-training layer 0, epoch 7, cost -81.9965604172
Pre-training layer 0, epoch 8, cost -81.1671789017
Pre-training layer 0, epoch 9, cost -80.4890152283
Pre-training layer 0, epoch 10, cost -79.9112555847
Pre-training layer 0, epoch 10, representative training free energy -343.688621201
Pre-training layer 0, epoch 10, validation free energy -336.087413834
Pre-training layer 0, epoch 11, cost -79.1638505707
Pre-training layer 0, epoch 12, cost -78.6993755112
Pre-training layer 0, epoch 13, cost -78.3754306946
Pre-training layer 0, epoch 14, cost -78.0344051361
Pre-training layer 0, epoch 15, cost -77.5821977005
Pre-training layer 0, epoch 15, representative training free energy -337.045729187
Pre-training layer 0, epoch 15, validation free energy -329.606936035
Pre-training layer 0, epoch 16, cost -77.2535098343
Pre-training layer 0, epoch 17, cost -76.9916522141
Pre-training layer 0, epoch 18, cost -76.6084932022
Pre-training layer 0, epoch 19, cost -76.3737483673
Pre-training layer 0, epoch 20, cost -76.0816436157
Pre-training layer 0, epoch 20, representative training free energy -330.708723251
Pre-training layer 0, epoch 20, validation free energy -321.394397247
Pre-training layer 0, epoch 21, cost -75.8210598907
Pre-training layer 0, epoch 22, cost -75.694332283
Pre-training layer 0, epoch 23, cost -75.4043246918
Pre-training layer 0, epoch 24, cost -75.1316227646
Pre-training layer 0, epoch 25, cost -75.0337821426
Pre-training layer 0, epoch 25, representative training free energy -327.464278381
Pre-training layer 0, epoch 25, validation free energy -317.862535889
Pre-training layer 0, epoch 26, cost -74.8206855011
Pre-training layer 0, epoch 27, cost -74.6438368683
Pre-training layer 0, epoch 28, cost -74.4865264053
Pre-training layer 0, epoch 29, cost -74.3261337204
Pre-training layer 0, epoch 30, cost -74.2232145081
Pre-training layer 0, epoch 30, representative training free energy -319.763137222
Pre-training layer 0, epoch 30, validation free energy -309.306087845
Pre-training layer 0, epoch 31, cost -74.0469799957
Pre-training layer 0, epoch 32, cost -73.9809557114
Pre-training layer 0, epoch 33, cost -73.668649826
Pre-training layer 0, epoch 34, cost -73.6961761322
Pre-training layer 0, epoch 35, cost -73.5058414841
Pre-training layer 0, epoch 35, representative training free energy -316.531633698
Pre-training layer 0, epoch 35, validation free energy -305.634954163
Pre-training layer 0, epoch 36, cost -73.3429449768
Pre-training layer 0, epoch 37, cost -73.3132827072
Pre-training layer 0, epoch 38, cost -73.2003893433
Pre-training layer 0, epoch 39, cost -73.0653806534
Pre-training layer 0, epoch 40, cost -73.0188432465
Pre-training layer 0, epoch 40, representative training free energy -317.648841782
Pre-training layer 0, epoch 40, validation free energy -307.616235733
Pre-training layer 0, epoch 41, cost -72.8272236557
Pre-training layer 0, epoch 42, cost -72.7964507751
Pre-training layer 0, epoch 43, cost -72.6864617386
Pre-training layer 0, epoch 44, cost -72.5737471542
Pre-training layer 0, epoch 45, cost -72.5183370514
Pre-training layer 0, epoch 45, representative training free energy -309.876078278
Pre-training layer 0, epoch 45, validation free energy -300.424844833
Pre-training layer 0, epoch 46, cost -72.4505282288
Pre-training layer 0, epoch 47, cost -72.3752968903
Pre-training layer 0, epoch 48, cost -72.3037871246
Pre-training layer 0, epoch 49, cost -72.1541833878
Pre-training layer 0, epoch 50, cost -71.9870442505
Pre-training layer 0, epoch 50, representative training free energy -308.029736923
Pre-training layer 0, epoch 50, validation free energy -297.900202332
Pre-training layer 0, epoch 51, cost -71.9805722198
Pre-training layer 0, epoch 52, cost -71.8680760269
Pre-training layer 0, epoch 53, cost -71.854219574
Pre-training layer 0, epoch 54, cost -71.7857005997
Pre-training layer 0, epoch 55, cost -71.6821893234
Pre-training layer 0, epoch 55, representative training free energy -301.408449142
Pre-training layer 0, epoch 55, validation free energy -290.191920761
Pre-training layer 0, epoch 56, cost -71.5498489914
Pre-training layer 0, epoch 57, cost -71.4947755051
Pre-training layer 0, epoch 58, cost -71.5193604507
Pre-training layer 0, epoch 59, cost -71.396101593
Pre-training layer 0, epoch 60, cost -71.3124710083
Pre-training layer 0, epoch 60, representative training free energy -294.387265533
Pre-training layer 0, epoch 60, validation free energy -283.963132141
Pre-training layer 0, epoch 61, cost -71.3501149139
Pre-training layer 0, epoch 62, cost -71.2068396149
Pre-training layer 0, epoch 63, cost -71.1302566757
Pre-training layer 0, epoch 64, cost -71.1265036545
Pre-training layer 0, epoch 65, cost -71.1041308365
Pre-training layer 0, epoch 65, representative training free energy -297.302166916
Pre-training layer 0, epoch 65, validation free energy -285.874891678
Pre-training layer 0, epoch 66, cost -70.992490799
Pre-training layer 0, epoch 67, cost -70.9534508362
Pre-training layer 0, epoch 68, cost -70.9332615814
Pre-training layer 0, epoch 69, cost -70.840011673
Pre-training layer 0, epoch 70, cost -70.7553753738
Pre-training layer 0, epoch 70, representative training free energy -293.066364014
Pre-training layer 0, epoch 70, validation free energy -282.212366135
Pre-training layer 0, epoch 71, cost -70.7430341034
Pre-training layer 0, epoch 72, cost -70.5846138992
Pre-training layer 0, epoch 73, cost -70.6045698471
Pre-training layer 0, epoch 74, cost -70.4321445847
Pre-training layer 0, epoch 75, cost -70.4519834137
Pre-training layer 0, epoch 75, representative training free energy -289.106041397
Pre-training layer 0, epoch 75, validation free energy -277.095857773
Pre-training layer 0, epoch 76, cost -70.5076860199
Pre-training layer 0, epoch 77, cost -70.3941276398
Pre-training layer 0, epoch 78, cost -70.3682111969
Pre-training layer 0, epoch 79, cost -70.3590816269
Pre-training layer 0, epoch 80, cost -70.2346464539
Pre-training layer 0, epoch 80, representative training free energy -284.798189209
Pre-training layer 0, epoch 80, validation free energy -273.64155011
Pre-training layer 0, epoch 81, cost -70.0605251999
Pre-training layer 0, epoch 82, cost -70.1609091034
Pre-training layer 0, epoch 83, cost -70.0395835876
Pre-training layer 0, epoch 84, cost -70.0200498505
Pre-training layer 0, epoch 85, cost -69.8925391846
Pre-training layer 0, epoch 85, representative training free energy -283.253596695
Pre-training layer 0, epoch 85, validation free energy -270.312768066
Pre-training layer 0, epoch 86, cost -69.862229332
Pre-training layer 0, epoch 87, cost -69.8937949371
Pre-training layer 0, epoch 88, cost -69.7133119507
Pre-training layer 0, epoch 89, cost -69.7440344696
Pre-training layer 0, epoch 90, cost -69.7655901489
Pre-training layer 0, epoch 90, representative training free energy -282.301183411
Pre-training layer 0, epoch 90, validation free energy -270.054248566
Pre-training layer 0, epoch 91, cost -69.7474113541
Pre-training layer 0, epoch 92, cost -69.733682045
Pre-training layer 0, epoch 93, cost -69.6098142853
Pre-training layer 0, epoch 94, cost -69.6029598541
Pre-training layer 0, epoch 95, cost -69.4866070251
Pre-training layer 0, epoch 95, representative training free energy -275.777454269
Pre-training layer 0, epoch 95, validation free energy -264.235539688
Pre-training layer 0, epoch 96, cost -69.5746186218
Pre-training layer 0, epoch 97, cost -69.4537327805
Pre-training layer 0, epoch 98, cost -69.5118107452
Pre-training layer 0, epoch 99, cost -69.3983746338
The pretraining code for file dbn_loop.pyc ran for 1.22m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 16.300000 %
     epoch 1, minibatch 500/500, test error of best model 16.300000 %
epoch 2, minibatch 500/500, validation error 11.700000 %
     epoch 2, minibatch 500/500, test error of best model 10.500000 %
epoch 3, minibatch 500/500, validation error 9.100000 %
     epoch 3, minibatch 500/500, test error of best model 8.500000 %
epoch 4, minibatch 500/500, validation error 8.700000 %
     epoch 4, minibatch 500/500, test error of best model 7.100000 %
epoch 5, minibatch 500/500, validation error 7.700000 %
     epoch 5, minibatch 500/500, test error of best model 6.500000 %
epoch 6, minibatch 500/500, validation error 7.200000 %
     epoch 6, minibatch 500/500, test error of best model 5.900000 %
epoch 7, minibatch 500/500, validation error 6.600000 %
     epoch 7, minibatch 500/500, test error of best model 5.600000 %
epoch 8, minibatch 500/500, validation error 6.500000 %
     epoch 8, minibatch 500/500, test error of best model 5.600000 %
epoch 9, minibatch 500/500, validation error 6.200000 %
     epoch 9, minibatch 500/500, test error of best model 5.500000 %
epoch 10, minibatch 500/500, validation error 5.900000 %
     epoch 10, minibatch 500/500, test error of best model 5.700000 %
epoch 11, minibatch 500/500, validation error 5.500000 %
     epoch 11, minibatch 500/500, test error of best model 5.600000 %
epoch 12, minibatch 500/500, validation error 5.500000 %
epoch 13, minibatch 500/500, validation error 5.400000 %
     epoch 13, minibatch 500/500, test error of best model 5.300000 %
epoch 14, minibatch 500/500, validation error 5.400000 %
epoch 15, minibatch 500/500, validation error 5.300000 %
     epoch 15, minibatch 500/500, test error of best model 5.200000 %
epoch 16, minibatch 500/500, validation error 5.200000 %
     epoch 16, minibatch 500/500, test error of best model 5.100000 %
epoch 17, minibatch 500/500, validation error 5.100000 %
     epoch 17, minibatch 500/500, test error of best model 5.000000 %
epoch 18, minibatch 500/500, validation error 5.100000 %
epoch 19, minibatch 500/500, validation error 4.900000 %
     epoch 19, minibatch 500/500, test error of best model 5.000000 %
epoch 20, minibatch 500/500, validation error 4.900000 %
epoch 21, minibatch 500/500, validation error 5.000000 %
epoch 22, minibatch 500/500, validation error 5.000000 %
epoch 23, minibatch 500/500, validation error 5.000000 %
epoch 24, minibatch 500/500, validation error 5.000000 %
epoch 25, minibatch 500/500, validation error 5.000000 %
epoch 26, minibatch 500/500, validation error 5.000000 %
epoch 27, minibatch 500/500, validation error 4.900000 %
epoch 28, minibatch 500/500, validation error 4.900000 %
epoch 29, minibatch 500/500, validation error 4.800000 %
     epoch 29, minibatch 500/500, test error of best model 5.500000 %
epoch 30, minibatch 500/500, validation error 4.800000 %
epoch 31, minibatch 500/500, validation error 4.800000 %
epoch 32, minibatch 500/500, validation error 4.800000 %
epoch 33, minibatch 500/500, validation error 4.800000 %
epoch 34, minibatch 500/500, validation error 4.900000 %
epoch 35, minibatch 500/500, validation error 4.900000 %
epoch 36, minibatch 500/500, validation error 4.900000 %
epoch 37, minibatch 500/500, validation error 4.900000 %
epoch 38, minibatch 500/500, validation error 4.900000 %
epoch 39, minibatch 500/500, validation error 4.900000 %
epoch 40, minibatch 500/500, validation error 4.900000 %
epoch 41, minibatch 500/500, validation error 4.900000 %
epoch 42, minibatch 500/500, validation error 4.900000 %
epoch 43, minibatch 500/500, validation error 5.000000 %
epoch 44, minibatch 500/500, validation error 5.000000 %
epoch 45, minibatch 500/500, validation error 5.000000 %
epoch 46, minibatch 500/500, validation error 5.000000 %
epoch 47, minibatch 500/500, validation error 5.000000 %
epoch 48, minibatch 500/500, validation error 5.000000 %
epoch 49, minibatch 500/500, validation error 5.000000 %
epoch 50, minibatch 500/500, validation error 5.000000 %
epoch 51, minibatch 500/500, validation error 4.900000 %
epoch 52, minibatch 500/500, validation error 4.900000 %
epoch 53, minibatch 500/500, validation error 4.800000 %
epoch 54, minibatch 500/500, validation error 4.800000 %
epoch 55, minibatch 500/500, validation error 4.800000 %
epoch 56, minibatch 500/500, validation error 4.800000 %
epoch 57, minibatch 500/500, validation error 4.800000 %
Optimization complete with best validation score of 4.800000 %, obtained at iteration 14500, with test performance 5.500000 %
The fine tuning code for file dbn_loop.pyc ran for 0.37m


==========Layers: [1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.980656296
Pre-training layer 0, epoch 0, representative training free energy -408.277340118
Pre-training layer 0, epoch 0, validation free energy -403.280924164
Pre-training layer 0, epoch 1, cost -96.8580509491
Pre-training layer 0, epoch 2, cost -91.0650726624
Pre-training layer 0, epoch 3, cost -87.7666450806
Pre-training layer 0, epoch 4, cost -85.6240398636
Pre-training layer 0, epoch 5, cost -84.2148094635
Pre-training layer 0, epoch 5, representative training free energy -355.745790054
Pre-training layer 0, epoch 5, validation free energy -348.468852219
Pre-training layer 0, epoch 6, cost -82.9891566391
Pre-training layer 0, epoch 7, cost -82.0061175766
Pre-training layer 0, epoch 8, cost -81.0929302902
Pre-training layer 0, epoch 9, cost -80.3466230392
Pre-training layer 0, epoch 10, cost -79.9067248383
Pre-training layer 0, epoch 10, representative training free energy -338.446279053
Pre-training layer 0, epoch 10, validation free energy -330.675067993
Pre-training layer 0, epoch 11, cost -79.2275050888
Pre-training layer 0, epoch 12, cost -78.7341007538
Pre-training layer 0, epoch 13, cost -78.3752189941
Pre-training layer 0, epoch 14, cost -77.9043097534
Pre-training layer 0, epoch 15, cost -77.6137108688
Pre-training layer 0, epoch 15, representative training free energy -333.798924713
Pre-training layer 0, epoch 15, validation free energy -325.352066208
Pre-training layer 0, epoch 16, cost -77.1831473083
Pre-training layer 0, epoch 17, cost -76.9194142609
Pre-training layer 0, epoch 18, cost -76.6415374222
Pre-training layer 0, epoch 19, cost -76.3613068237
Pre-training layer 0, epoch 20, cost -75.9938693466
Pre-training layer 0, epoch 20, representative training free energy -332.974553726
Pre-training layer 0, epoch 20, validation free energy -324.874991714
Pre-training layer 0, epoch 21, cost -75.8365535812
Pre-training layer 0, epoch 22, cost -75.6175014801
Pre-training layer 0, epoch 23, cost -75.5071437531
Pre-training layer 0, epoch 24, cost -75.2398430481
Pre-training layer 0, epoch 25, cost -74.9605554428
Pre-training layer 0, epoch 25, representative training free energy -323.595477341
Pre-training layer 0, epoch 25, validation free energy -313.357872009
Pre-training layer 0, epoch 26, cost -74.8202594833
Pre-training layer 0, epoch 27, cost -74.6480518341
Pre-training layer 0, epoch 28, cost -74.4915274124
Pre-training layer 0, epoch 29, cost -74.370273819
Pre-training layer 0, epoch 30, cost -74.1894559402
Pre-training layer 0, epoch 30, representative training free energy -318.125292831
Pre-training layer 0, epoch 30, validation free energy -308.335085449
Pre-training layer 0, epoch 31, cost -74.1139068985
Pre-training layer 0, epoch 32, cost -73.8717521667
Pre-training layer 0, epoch 33, cost -73.724984993
Pre-training layer 0, epoch 34, cost -73.6122941895
Pre-training layer 0, epoch 35, cost -73.6494740753
Pre-training layer 0, epoch 35, representative training free energy -316.897800354
Pre-training layer 0, epoch 35, validation free energy -307.64897493
Pre-training layer 0, epoch 36, cost -73.3862487717
Pre-training layer 0, epoch 37, cost -73.3127459412
Pre-training layer 0, epoch 38, cost -73.1423632431
Pre-training layer 0, epoch 39, cost -73.0560630188
Pre-training layer 0, epoch 40, cost -72.9946485062
Pre-training layer 0, epoch 40, representative training free energy -313.734271729
Pre-training layer 0, epoch 40, validation free energy -303.362214554
Pre-training layer 0, epoch 41, cost -72.8944123993
Pre-training layer 0, epoch 42, cost -72.8858065109
Pre-training layer 0, epoch 43, cost -72.6862213745
Pre-training layer 0, epoch 44, cost -72.488350441
Pre-training layer 0, epoch 45, cost -72.5475377884
Pre-training layer 0, epoch 45, representative training free energy -305.987534744
Pre-training layer 0, epoch 45, validation free energy -295.72891246
Pre-training layer 0, epoch 46, cost -72.3765220947
Pre-training layer 0, epoch 47, cost -72.3367892685
Pre-training layer 0, epoch 48, cost -72.1938288193
Pre-training layer 0, epoch 49, cost -72.1783944321
Pre-training layer 0, epoch 50, cost -72.1144971848
Pre-training layer 0, epoch 50, representative training free energy -306.103319305
Pre-training layer 0, epoch 50, validation free energy -295.264314194
Pre-training layer 0, epoch 51, cost -71.9391211472
Pre-training layer 0, epoch 52, cost -71.8906655197
Pre-training layer 0, epoch 53, cost -71.8972884064
Pre-training layer 0, epoch 54, cost -71.7073467255
Pre-training layer 0, epoch 55, cost -71.7044908142
Pre-training layer 0, epoch 55, representative training free energy -299.497779205
Pre-training layer 0, epoch 55, validation free energy -288.099530533
Pre-training layer 0, epoch 56, cost -71.5784052277
Pre-training layer 0, epoch 57, cost -71.475320816
Pre-training layer 0, epoch 58, cost -71.5238509445
Pre-training layer 0, epoch 59, cost -71.3249644089
Pre-training layer 0, epoch 60, cost -71.3368244934
Pre-training layer 0, epoch 60, representative training free energy -296.39196991
Pre-training layer 0, epoch 60, validation free energy -284.595989838
Pre-training layer 0, epoch 61, cost -71.2961959076
Pre-training layer 0, epoch 62, cost -71.1682490463
Pre-training layer 0, epoch 63, cost -71.1743003693
Pre-training layer 0, epoch 64, cost -71.0807789688
Pre-training layer 0, epoch 65, cost -70.9040314789
Pre-training layer 0, epoch 65, representative training free energy -294.370598221
Pre-training layer 0, epoch 65, validation free energy -282.622572739
Pre-training layer 0, epoch 66, cost -71.0173298264
Pre-training layer 0, epoch 67, cost -70.8606736221
Pre-training layer 0, epoch 68, cost -70.8829876251
Pre-training layer 0, epoch 69, cost -70.6266496811
Pre-training layer 0, epoch 70, cost -70.6602303772
Pre-training layer 0, epoch 70, representative training free energy -290.649843613
Pre-training layer 0, epoch 70, validation free energy -277.980444992
Pre-training layer 0, epoch 71, cost -70.6464821396
Pre-training layer 0, epoch 72, cost -70.6243257065
Pre-training layer 0, epoch 73, cost -70.5468746414
Pre-training layer 0, epoch 74, cost -70.420522995
Pre-training layer 0, epoch 75, cost -70.5015345154
Pre-training layer 0, epoch 75, representative training free energy -285.32303656
Pre-training layer 0, epoch 75, validation free energy -272.853725235
Pre-training layer 0, epoch 76, cost -70.3474335175
Pre-training layer 0, epoch 77, cost -70.2663746567
Pre-training layer 0, epoch 78, cost -70.3308954926
Pre-training layer 0, epoch 79, cost -70.1178870468
Pre-training layer 0, epoch 80, cost -70.1077091141
Pre-training layer 0, epoch 80, representative training free energy -282.718628403
Pre-training layer 0, epoch 80, validation free energy -271.191523529
Pre-training layer 0, epoch 81, cost -70.1599500656
Pre-training layer 0, epoch 82, cost -70.0700587311
Pre-training layer 0, epoch 83, cost -70.0636435471
Pre-training layer 0, epoch 84, cost -70.0476926041
Pre-training layer 0, epoch 85, cost -69.999126358
Pre-training layer 0, epoch 85, representative training free energy -280.675703949
Pre-training layer 0, epoch 85, validation free energy -268.224736038
Pre-training layer 0, epoch 86, cost -69.9504734802
Pre-training layer 0, epoch 87, cost -69.8763702164
Pre-training layer 0, epoch 88, cost -69.748813446
Pre-training layer 0, epoch 89, cost -69.6541271286
Pre-training layer 0, epoch 90, cost -69.7240167465
Pre-training layer 0, epoch 90, representative training free energy -273.203344421
Pre-training layer 0, epoch 90, validation free energy -260.715217987
Pre-training layer 0, epoch 91, cost -69.685472229
Pre-training layer 0, epoch 92, cost -69.6571385574
Pre-training layer 0, epoch 93, cost -69.5206258545
Pre-training layer 0, epoch 94, cost -69.487349556
Pre-training layer 0, epoch 95, cost -69.5679354248
Pre-training layer 0, epoch 95, representative training free energy -274.17234613
Pre-training layer 0, epoch 95, validation free energy -262.246062531
Pre-training layer 0, epoch 96, cost -69.463950882
Pre-training layer 0, epoch 97, cost -69.4686510162
Pre-training layer 0, epoch 98, cost -69.3466165619
Pre-training layer 0, epoch 99, cost -69.3991025009
Pre-training layer 1, epoch 0, cost -172.099369583
Pre-training layer 1, epoch 0, representative training free energy -145195.626215
Pre-training layer 1, epoch 0, validation free energy -144070.839215
Pre-training layer 1, epoch 1, cost -142.037112778
Pre-training layer 1, epoch 2, cost -133.739475372
Pre-training layer 1, epoch 3, cost -129.03017453
Pre-training layer 1, epoch 4, cost -125.955637253
Pre-training layer 1, epoch 5, cost -123.858956528
Pre-training layer 1, epoch 5, representative training free energy -200497.4285
Pre-training layer 1, epoch 5, validation free energy -198790.002914
Pre-training layer 1, epoch 6, cost -122.139861755
Pre-training layer 1, epoch 7, cost -120.675414383
Pre-training layer 1, epoch 8, cost -119.583551636
Pre-training layer 1, epoch 9, cost -118.52115686
Pre-training layer 1, epoch 10, cost -117.688855957
Pre-training layer 1, epoch 10, representative training free energy -222043.068492
Pre-training layer 1, epoch 10, validation free energy -220146.091695
Pre-training layer 1, epoch 11, cost -117.027600662
Pre-training layer 1, epoch 12, cost -116.347304092
Pre-training layer 1, epoch 13, cost -115.663496307
Pre-training layer 1, epoch 14, cost -115.275746368
Pre-training layer 1, epoch 15, cost -114.727642456
Pre-training layer 1, epoch 15, representative training free energy -235980.830023
Pre-training layer 1, epoch 15, validation free energy -233935.640852
Pre-training layer 1, epoch 16, cost -114.319595093
Pre-training layer 1, epoch 17, cost -113.84009166
Pre-training layer 1, epoch 18, cost -113.431476974
Pre-training layer 1, epoch 19, cost -113.070917358
Pre-training layer 1, epoch 20, cost -112.849765076
Pre-training layer 1, epoch 20, representative training free energy -247047.58525
Pre-training layer 1, epoch 20, validation free energy -244881.092812
Pre-training layer 1, epoch 21, cost -112.446085678
Pre-training layer 1, epoch 22, cost -112.193434097
Pre-training layer 1, epoch 23, cost -112.005271072
Pre-training layer 1, epoch 24, cost -111.731605057
Pre-training layer 1, epoch 25, cost -111.463132355
Pre-training layer 1, epoch 25, representative training free energy -256305.939086
Pre-training layer 1, epoch 25, validation free energy -254127.119578
Pre-training layer 1, epoch 26, cost -111.235119644
Pre-training layer 1, epoch 27, cost -111.009899414
Pre-training layer 1, epoch 28, cost -110.835329834
Pre-training layer 1, epoch 29, cost -110.677184814
Pre-training layer 1, epoch 30, cost -110.474854172
Pre-training layer 1, epoch 30, representative training free energy -263493.412945
Pre-training layer 1, epoch 30, validation free energy -261253.306664
Pre-training layer 1, epoch 31, cost -110.318404221
Pre-training layer 1, epoch 32, cost -110.146740952
Pre-training layer 1, epoch 33, cost -110.002107513
Pre-training layer 1, epoch 34, cost -109.873071564
Pre-training layer 1, epoch 35, cost -109.651745056
Pre-training layer 1, epoch 35, representative training free energy -270065.587648
Pre-training layer 1, epoch 35, validation free energy -267754.534148
Pre-training layer 1, epoch 36, cost -109.585706238
Pre-training layer 1, epoch 37, cost -109.462765701
Pre-training layer 1, epoch 38, cost -109.287513885
Pre-training layer 1, epoch 39, cost -109.127599762
Pre-training layer 1, epoch 40, cost -109.105492264
Pre-training layer 1, epoch 40, representative training free energy -276040.682422
Pre-training layer 1, epoch 40, validation free energy -273688.471953
Pre-training layer 1, epoch 41, cost -108.978695297
Pre-training layer 1, epoch 42, cost -108.823383652
Pre-training layer 1, epoch 43, cost -108.727906693
Pre-training layer 1, epoch 44, cost -108.642315231
Pre-training layer 1, epoch 45, cost -108.557935684
Pre-training layer 1, epoch 45, representative training free energy -281175.977266
Pre-training layer 1, epoch 45, validation free energy -278817.923297
Pre-training layer 1, epoch 46, cost -108.375163498
Pre-training layer 1, epoch 47, cost -108.367735931
Pre-training layer 1, epoch 48, cost -108.233163452
Pre-training layer 1, epoch 49, cost -108.106882004
Pre-training layer 1, epoch 50, cost -108.073197929
Pre-training layer 1, epoch 50, representative training free energy -285768.726313
Pre-training layer 1, epoch 50, validation free energy -283352.289727
Pre-training layer 1, epoch 51, cost -108.044311401
Pre-training layer 1, epoch 52, cost -107.992965332
Pre-training layer 1, epoch 53, cost -107.850425964
Pre-training layer 1, epoch 54, cost -107.79496563
Pre-training layer 1, epoch 55, cost -107.759716682
Pre-training layer 1, epoch 55, representative training free energy -290544.669891
Pre-training layer 1, epoch 55, validation free energy -288111.666344
Pre-training layer 1, epoch 56, cost -107.682136658
Pre-training layer 1, epoch 57, cost -107.58552681
Pre-training layer 1, epoch 58, cost -107.604362465
Pre-training layer 1, epoch 59, cost -107.452876823
Pre-training layer 1, epoch 60, cost -107.383496986
Pre-training layer 1, epoch 60, representative training free energy -294202.101234
Pre-training layer 1, epoch 60, validation free energy -291699.955195
Pre-training layer 1, epoch 61, cost -107.314978973
Pre-training layer 1, epoch 62, cost -107.324127586
Pre-training layer 1, epoch 63, cost -107.236448822
Pre-training layer 1, epoch 64, cost -107.131418854
Pre-training layer 1, epoch 65, cost -107.08700676
Pre-training layer 1, epoch 65, representative training free energy -297839.693125
Pre-training layer 1, epoch 65, validation free energy -295349.192062
Pre-training layer 1, epoch 66, cost -107.062360443
Pre-training layer 1, epoch 67, cost -106.982426224
Pre-training layer 1, epoch 68, cost -106.954519356
Pre-training layer 1, epoch 69, cost -106.932065704
Pre-training layer 1, epoch 70, cost -106.807146164
Pre-training layer 1, epoch 70, representative training free energy -301172.617172
Pre-training layer 1, epoch 70, validation free energy -298642.597398
Pre-training layer 1, epoch 71, cost -106.815899231
Pre-training layer 1, epoch 72, cost -106.731936226
Pre-training layer 1, epoch 73, cost -106.756453362
Pre-training layer 1, epoch 74, cost -106.686101105
Pre-training layer 1, epoch 75, cost -106.688152344
Pre-training layer 1, epoch 75, representative training free energy -304861.177883
Pre-training layer 1, epoch 75, validation free energy -302305.023375
Pre-training layer 1, epoch 76, cost -106.565745117
Pre-training layer 1, epoch 77, cost -106.531896927
Pre-training layer 1, epoch 78, cost -106.49750106
Pre-training layer 1, epoch 79, cost -106.524012955
Pre-training layer 1, epoch 80, cost -106.450916122
Pre-training layer 1, epoch 80, representative training free energy -307564.406477
Pre-training layer 1, epoch 80, validation free energy -304965.981484
Pre-training layer 1, epoch 81, cost -106.446805336
Pre-training layer 1, epoch 82, cost -106.377508781
Pre-training layer 1, epoch 83, cost -106.3356101
Pre-training layer 1, epoch 84, cost -106.313964798
Pre-training layer 1, epoch 85, cost -106.212524162
Pre-training layer 1, epoch 85, representative training free energy -310757.336141
Pre-training layer 1, epoch 85, validation free energy -308164.181625
Pre-training layer 1, epoch 86, cost -106.255621529
Pre-training layer 1, epoch 87, cost -106.14339975
Pre-training layer 1, epoch 88, cost -106.161647659
Pre-training layer 1, epoch 89, cost -106.111175949
Pre-training layer 1, epoch 90, cost -106.145575043
Pre-training layer 1, epoch 90, representative training free energy -313462.443227
Pre-training layer 1, epoch 90, validation free energy -310833.154578
Pre-training layer 1, epoch 91, cost -106.128742393
Pre-training layer 1, epoch 92, cost -106.14606971
Pre-training layer 1, epoch 93, cost -106.060742615
Pre-training layer 1, epoch 94, cost -105.953804718
Pre-training layer 1, epoch 95, cost -105.979113701
Pre-training layer 1, epoch 95, representative training free energy -315800.906492
Pre-training layer 1, epoch 95, validation free energy -313159.711828
Pre-training layer 1, epoch 96, cost -105.935908806
Pre-training layer 1, epoch 97, cost -105.874830307
Pre-training layer 1, epoch 98, cost -105.850188225
Pre-training layer 1, epoch 99, cost -105.900597717
The pretraining code for file dbn_loop.pyc ran for 2.84m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.700000 %
     epoch 1, minibatch 500/500, test error of best model 12.800000 %
epoch 2, minibatch 500/500, validation error 9.000000 %
     epoch 2, minibatch 500/500, test error of best model 9.200000 %
epoch 3, minibatch 500/500, validation error 7.400000 %
     epoch 3, minibatch 500/500, test error of best model 7.200000 %
epoch 4, minibatch 500/500, validation error 6.400000 %
     epoch 4, minibatch 500/500, test error of best model 6.600000 %
epoch 5, minibatch 500/500, validation error 6.400000 %
epoch 6, minibatch 500/500, validation error 6.300000 %
     epoch 6, minibatch 500/500, test error of best model 5.500000 %
epoch 7, minibatch 500/500, validation error 5.900000 %
     epoch 7, minibatch 500/500, test error of best model 5.400000 %
epoch 8, minibatch 500/500, validation error 6.000000 %
epoch 9, minibatch 500/500, validation error 5.700000 %
     epoch 9, minibatch 500/500, test error of best model 5.200000 %
epoch 10, minibatch 500/500, validation error 5.600000 %
     epoch 10, minibatch 500/500, test error of best model 5.200000 %
epoch 11, minibatch 500/500, validation error 5.400000 %
     epoch 11, minibatch 500/500, test error of best model 5.000000 %
epoch 12, minibatch 500/500, validation error 5.600000 %
epoch 13, minibatch 500/500, validation error 5.700000 %
epoch 14, minibatch 500/500, validation error 5.900000 %
epoch 15, minibatch 500/500, validation error 5.900000 %
epoch 16, minibatch 500/500, validation error 5.800000 %
epoch 17, minibatch 500/500, validation error 5.800000 %
epoch 18, minibatch 500/500, validation error 5.700000 %
epoch 19, minibatch 500/500, validation error 5.700000 %
epoch 20, minibatch 500/500, validation error 5.700000 %
epoch 21, minibatch 500/500, validation error 5.700000 %
Optimization complete with best validation score of 5.400000 %, obtained at iteration 5500, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.30m


==========Layers: [1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.888211868
Pre-training layer 0, epoch 0, representative training free energy -409.624835724
Pre-training layer 0, epoch 0, validation free energy -404.740640259
Pre-training layer 0, epoch 1, cost -96.6295333405
Pre-training layer 0, epoch 2, cost -90.9267584381
Pre-training layer 0, epoch 3, cost -87.6887061005
Pre-training layer 0, epoch 4, cost -85.6376206131
Pre-training layer 0, epoch 5, cost -84.2069390869
Pre-training layer 0, epoch 5, representative training free energy -354.862779175
Pre-training layer 0, epoch 5, validation free energy -348.492173859
Pre-training layer 0, epoch 6, cost -82.8608243256
Pre-training layer 0, epoch 7, cost -81.9988941193
Pre-training layer 0, epoch 8, cost -81.0787784271
Pre-training layer 0, epoch 9, cost -80.5402586594
Pre-training layer 0, epoch 10, cost -79.7900783005
Pre-training layer 0, epoch 10, representative training free energy -338.520015671
Pre-training layer 0, epoch 10, validation free energy -330.667533005
Pre-training layer 0, epoch 11, cost -79.3114385529
Pre-training layer 0, epoch 12, cost -78.726671814
Pre-training layer 0, epoch 13, cost -78.3438617172
Pre-training layer 0, epoch 14, cost -77.8760099411
Pre-training layer 0, epoch 15, cost -77.5452150497
Pre-training layer 0, epoch 15, representative training free energy -335.780774933
Pre-training layer 0, epoch 15, validation free energy -327.455414124
Pre-training layer 0, epoch 16, cost -77.2325025101
Pre-training layer 0, epoch 17, cost -76.8437142868
Pre-training layer 0, epoch 18, cost -76.611310051
Pre-training layer 0, epoch 19, cost -76.3175468903
Pre-training layer 0, epoch 20, cost -76.0703085403
Pre-training layer 0, epoch 20, representative training free energy -331.60912027
Pre-training layer 0, epoch 20, validation free energy -322.8893302
Pre-training layer 0, epoch 21, cost -75.9321353073
Pre-training layer 0, epoch 22, cost -75.6390014572
Pre-training layer 0, epoch 23, cost -75.3328946838
Pre-training layer 0, epoch 24, cost -75.2336841278
Pre-training layer 0, epoch 25, cost -75.0399976425
Pre-training layer 0, epoch 25, representative training free energy -324.656856522
Pre-training layer 0, epoch 25, validation free energy -315.760824997
Pre-training layer 0, epoch 26, cost -74.9431349487
Pre-training layer 0, epoch 27, cost -74.6922547302
Pre-training layer 0, epoch 28, cost -74.5573654633
Pre-training layer 0, epoch 29, cost -74.353812294
Pre-training layer 0, epoch 30, cost -74.2089899292
Pre-training layer 0, epoch 30, representative training free energy -324.93683725
Pre-training layer 0, epoch 30, validation free energy -315.249140335
Pre-training layer 0, epoch 31, cost -74.0964588165
Pre-training layer 0, epoch 32, cost -73.9688387299
Pre-training layer 0, epoch 33, cost -73.7275067825
Pre-training layer 0, epoch 34, cost -73.7237733002
Pre-training layer 0, epoch 35, cost -73.619289505
Pre-training layer 0, epoch 35, representative training free energy -317.406239502
Pre-training layer 0, epoch 35, validation free energy -307.175351074
Pre-training layer 0, epoch 36, cost -73.5024011612
Pre-training layer 0, epoch 37, cost -73.2700215225
Pre-training layer 0, epoch 38, cost -73.1676273575
Pre-training layer 0, epoch 39, cost -73.1215386734
Pre-training layer 0, epoch 40, cost -72.9347420807
Pre-training layer 0, epoch 40, representative training free energy -316.47503064
Pre-training layer 0, epoch 40, validation free energy -306.696461227
Pre-training layer 0, epoch 41, cost -72.7920325775
Pre-training layer 0, epoch 42, cost -72.722782692
Pre-training layer 0, epoch 43, cost -72.60660746
Pre-training layer 0, epoch 44, cost -72.5521025238
Pre-training layer 0, epoch 45, cost -72.4591641006
Pre-training layer 0, epoch 45, representative training free energy -312.346393829
Pre-training layer 0, epoch 45, validation free energy -301.768400787
Pre-training layer 0, epoch 46, cost -72.3266950073
Pre-training layer 0, epoch 47, cost -72.3557116852
Pre-training layer 0, epoch 48, cost -72.2174878769
Pre-training layer 0, epoch 49, cost -72.1610131912
Pre-training layer 0, epoch 50, cost -72.0187340775
Pre-training layer 0, epoch 50, representative training free energy -309.564145111
Pre-training layer 0, epoch 50, validation free energy -297.735694672
Pre-training layer 0, epoch 51, cost -71.9481972504
Pre-training layer 0, epoch 52, cost -71.9138922424
Pre-training layer 0, epoch 53, cost -71.7881987152
Pre-training layer 0, epoch 54, cost -71.7789435806
Pre-training layer 0, epoch 55, cost -71.6162982712
Pre-training layer 0, epoch 55, representative training free energy -304.893594879
Pre-training layer 0, epoch 55, validation free energy -293.102515427
Pre-training layer 0, epoch 56, cost -71.6286584549
Pre-training layer 0, epoch 57, cost -71.5213581772
Pre-training layer 0, epoch 58, cost -71.5232240982
Pre-training layer 0, epoch 59, cost -71.3953314133
Pre-training layer 0, epoch 60, cost -71.3499713516
Pre-training layer 0, epoch 60, representative training free energy -298.434211014
Pre-training layer 0, epoch 60, validation free energy -287.118834717
Pre-training layer 0, epoch 61, cost -71.2796107864
Pre-training layer 0, epoch 62, cost -71.2339901276
Pre-training layer 0, epoch 63, cost -71.1230881653
Pre-training layer 0, epoch 64, cost -71.0991478882
Pre-training layer 0, epoch 65, cost -71.1057596359
Pre-training layer 0, epoch 65, representative training free energy -295.958439514
Pre-training layer 0, epoch 65, validation free energy -284.477804108
Pre-training layer 0, epoch 66, cost -71.0210373001
Pre-training layer 0, epoch 67, cost -70.903739357
Pre-training layer 0, epoch 68, cost -70.8283127289
Pre-training layer 0, epoch 69, cost -70.7791584854
Pre-training layer 0, epoch 70, cost -70.7540706787
Pre-training layer 0, epoch 70, representative training free energy -294.807888
Pre-training layer 0, epoch 70, validation free energy -282.768393005
Pre-training layer 0, epoch 71, cost -70.6252131577
Pre-training layer 0, epoch 72, cost -70.6428259735
Pre-training layer 0, epoch 73, cost -70.5817331085
Pre-training layer 0, epoch 74, cost -70.4237347641
Pre-training layer 0, epoch 75, cost -70.5073834534
Pre-training layer 0, epoch 75, representative training free energy -290.054214554
Pre-training layer 0, epoch 75, validation free energy -277.631794647
Pre-training layer 0, epoch 76, cost -70.4282075043
Pre-training layer 0, epoch 77, cost -70.3368526764
Pre-training layer 0, epoch 78, cost -70.358487793
Pre-training layer 0, epoch 79, cost -70.3049580994
Pre-training layer 0, epoch 80, cost -70.2680005264
Pre-training layer 0, epoch 80, representative training free energy -287.020355728
Pre-training layer 0, epoch 80, validation free energy -274.960630203
Pre-training layer 0, epoch 81, cost -70.1336168137
Pre-training layer 0, epoch 82, cost -70.1066542892
Pre-training layer 0, epoch 83, cost -70.1064580154
Pre-training layer 0, epoch 84, cost -70.0140474548
Pre-training layer 0, epoch 85, cost -69.9349999008
Pre-training layer 0, epoch 85, representative training free energy -284.02108783
Pre-training layer 0, epoch 85, validation free energy -271.253692825
Pre-training layer 0, epoch 86, cost -69.9957227325
Pre-training layer 0, epoch 87, cost -69.9745626297
Pre-training layer 0, epoch 88, cost -69.9115487671
Pre-training layer 0, epoch 89, cost -69.8987197266
Pre-training layer 0, epoch 90, cost -69.7744008408
Pre-training layer 0, epoch 90, representative training free energy -279.087058594
Pre-training layer 0, epoch 90, validation free energy -266.293845123
Pre-training layer 0, epoch 91, cost -69.7804392853
Pre-training layer 0, epoch 92, cost -69.6892659378
Pre-training layer 0, epoch 93, cost -69.6983744354
Pre-training layer 0, epoch 94, cost -69.6462628098
Pre-training layer 0, epoch 95, cost -69.5140678253
Pre-training layer 0, epoch 95, representative training free energy -274.641982086
Pre-training layer 0, epoch 95, validation free energy -262.487351624
Pre-training layer 0, epoch 96, cost -69.5117872162
Pre-training layer 0, epoch 97, cost -69.5181094971
Pre-training layer 0, epoch 98, cost -69.4663564453
Pre-training layer 0, epoch 99, cost -69.4129055252
Pre-training layer 1, epoch 0, cost -172.335365906
Pre-training layer 1, epoch 0, representative training free energy -144705.239723
Pre-training layer 1, epoch 0, validation free energy -143864.367961
Pre-training layer 1, epoch 1, cost -142.285344666
Pre-training layer 1, epoch 2, cost -133.951116959
Pre-training layer 1, epoch 3, cost -129.455694366
Pre-training layer 1, epoch 4, cost -126.25476059
Pre-training layer 1, epoch 5, cost -124.147624146
Pre-training layer 1, epoch 5, representative training free energy -198997.697352
Pre-training layer 1, epoch 5, validation free energy -197630.985328
Pre-training layer 1, epoch 6, cost -122.304438354
Pre-training layer 1, epoch 7, cost -120.869424408
Pre-training layer 1, epoch 8, cost -119.763343109
Pre-training layer 1, epoch 9, cost -118.824798889
Pre-training layer 1, epoch 10, cost -117.954088394
Pre-training layer 1, epoch 10, representative training free energy -220517.006867
Pre-training layer 1, epoch 10, validation free energy -218905.049648
Pre-training layer 1, epoch 11, cost -117.214877243
Pre-training layer 1, epoch 12, cost -116.557987762
Pre-training layer 1, epoch 13, cost -115.922542419
Pre-training layer 1, epoch 14, cost -115.343204376
Pre-training layer 1, epoch 15, cost -114.983193939
Pre-training layer 1, epoch 15, representative training free energy -234554.459352
Pre-training layer 1, epoch 15, validation free energy -232873.115813
Pre-training layer 1, epoch 16, cost -114.486493896
Pre-training layer 1, epoch 17, cost -114.030842773
Pre-training layer 1, epoch 18, cost -113.681673737
Pre-training layer 1, epoch 19, cost -113.426540527
Pre-training layer 1, epoch 20, cost -113.05227565
Pre-training layer 1, epoch 20, representative training free energy -245546.313766
Pre-training layer 1, epoch 20, validation free energy -243744.132906
Pre-training layer 1, epoch 21, cost -112.711986954
Pre-training layer 1, epoch 22, cost -112.433552109
Pre-training layer 1, epoch 23, cost -112.156550995
Pre-training layer 1, epoch 24, cost -111.979363449
Pre-training layer 1, epoch 25, cost -111.710401566
Pre-training layer 1, epoch 25, representative training free energy -254508.212766
Pre-training layer 1, epoch 25, validation free energy -252626.539578
Pre-training layer 1, epoch 26, cost -111.555271317
Pre-training layer 1, epoch 27, cost -111.286909683
Pre-training layer 1, epoch 28, cost -111.027724487
Pre-training layer 1, epoch 29, cost -110.902476776
Pre-training layer 1, epoch 30, cost -110.719912659
Pre-training layer 1, epoch 30, representative training free energy -262083.372109
Pre-training layer 1, epoch 30, validation free energy -260135.272609
Pre-training layer 1, epoch 31, cost -110.555905273
Pre-training layer 1, epoch 32, cost -110.420464249
Pre-training layer 1, epoch 33, cost -110.199755356
Pre-training layer 1, epoch 34, cost -110.057033936
Pre-training layer 1, epoch 35, cost -109.902354401
Pre-training layer 1, epoch 35, representative training free energy -268775.469219
Pre-training layer 1, epoch 35, validation free energy -266745.312484
Pre-training layer 1, epoch 36, cost -109.765666542
Pre-training layer 1, epoch 37, cost -109.644216019
Pre-training layer 1, epoch 38, cost -109.513803253
Pre-training layer 1, epoch 39, cost -109.282912689
Pre-training layer 1, epoch 40, cost -109.220240326
Pre-training layer 1, epoch 40, representative training free energy -274090.679539
Pre-training layer 1, epoch 40, validation free energy -272042.797672
Pre-training layer 1, epoch 41, cost -109.17888855
Pre-training layer 1, epoch 42, cost -108.983516083
Pre-training layer 1, epoch 43, cost -108.866329048
Pre-training layer 1, epoch 44, cost -108.856091034
Pre-training layer 1, epoch 45, cost -108.750854385
Pre-training layer 1, epoch 45, representative training free energy -279359.64232
Pre-training layer 1, epoch 45, validation free energy -277249.277672
Pre-training layer 1, epoch 46, cost -108.586852859
Pre-training layer 1, epoch 47, cost -108.503722588
Pre-training layer 1, epoch 48, cost -108.371307762
Pre-training layer 1, epoch 49, cost -108.404408203
Pre-training layer 1, epoch 50, cost -108.233944977
Pre-training layer 1, epoch 50, representative training free energy -283992.778977
Pre-training layer 1, epoch 50, validation free energy -281860.135039
Pre-training layer 1, epoch 51, cost -108.273934929
Pre-training layer 1, epoch 52, cost -108.056300278
Pre-training layer 1, epoch 53, cost -107.999766617
Pre-training layer 1, epoch 54, cost -107.951685242
Pre-training layer 1, epoch 55, cost -107.870407318
Pre-training layer 1, epoch 55, representative training free energy -288385.80007
Pre-training layer 1, epoch 55, validation free energy -286220.582734
Pre-training layer 1, epoch 56, cost -107.862296074
Pre-training layer 1, epoch 57, cost -107.777264999
Pre-training layer 1, epoch 58, cost -107.712818756
Pre-training layer 1, epoch 59, cost -107.640473541
Pre-training layer 1, epoch 60, cost -107.577683586
Pre-training layer 1, epoch 60, representative training free energy -292197.984977
Pre-training layer 1, epoch 60, validation free energy -290021.642758
Pre-training layer 1, epoch 61, cost -107.491245392
Pre-training layer 1, epoch 62, cost -107.434530891
Pre-training layer 1, epoch 63, cost -107.397105331
Pre-training layer 1, epoch 64, cost -107.402792267
Pre-training layer 1, epoch 65, cost -107.29632106
Pre-training layer 1, epoch 65, representative training free energy -295809.715523
Pre-training layer 1, epoch 65, validation free energy -293614.619023
Pre-training layer 1, epoch 66, cost -107.230530579
Pre-training layer 1, epoch 67, cost -107.158932068
Pre-training layer 1, epoch 68, cost -107.175940659
Pre-training layer 1, epoch 69, cost -107.038961731
Pre-training layer 1, epoch 70, cost -106.9786091
Pre-training layer 1, epoch 70, representative training free energy -299432.553031
Pre-training layer 1, epoch 70, validation free energy -297240.267297
Pre-training layer 1, epoch 71, cost -107.058943146
Pre-training layer 1, epoch 72, cost -107.007907486
Pre-training layer 1, epoch 73, cost -106.92735685
Pre-training layer 1, epoch 74, cost -106.923045715
Pre-training layer 1, epoch 75, cost -106.794717819
Pre-training layer 1, epoch 75, representative training free energy -302787.857383
Pre-training layer 1, epoch 75, validation free energy -300532.572047
Pre-training layer 1, epoch 76, cost -106.856049049
Pre-training layer 1, epoch 77, cost -106.804673401
Pre-training layer 1, epoch 78, cost -106.609073578
Pre-training layer 1, epoch 79, cost -106.627581863
Pre-training layer 1, epoch 80, cost -106.665065216
Pre-training layer 1, epoch 80, representative training free energy -306088.167234
Pre-training layer 1, epoch 80, validation free energy -303827.982797
Pre-training layer 1, epoch 81, cost -106.676992416
Pre-training layer 1, epoch 82, cost -106.50097477
Pre-training layer 1, epoch 83, cost -106.519590355
Pre-training layer 1, epoch 84, cost -106.465921249
Pre-training layer 1, epoch 85, cost -106.428164108
Pre-training layer 1, epoch 85, representative training free energy -308883.953953
Pre-training layer 1, epoch 85, validation free energy -306637.549141
Pre-training layer 1, epoch 86, cost -106.457074448
Pre-training layer 1, epoch 87, cost -106.341275208
Pre-training layer 1, epoch 88, cost -106.312336853
Pre-training layer 1, epoch 89, cost -106.339831131
Pre-training layer 1, epoch 90, cost -106.297881706
Pre-training layer 1, epoch 90, representative training free energy -311228.170461
Pre-training layer 1, epoch 90, validation free energy -308987.854555
Pre-training layer 1, epoch 91, cost -106.347303566
Pre-training layer 1, epoch 92, cost -106.257464317
Pre-training layer 1, epoch 93, cost -106.187636414
Pre-training layer 1, epoch 94, cost -106.126945847
Pre-training layer 1, epoch 95, cost -106.165047203
Pre-training layer 1, epoch 95, representative training free energy -313786.82582
Pre-training layer 1, epoch 95, validation free energy -311467.98793
Pre-training layer 1, epoch 96, cost -106.192324005
Pre-training layer 1, epoch 97, cost -106.088005814
Pre-training layer 1, epoch 98, cost -106.062879532
Pre-training layer 1, epoch 99, cost -105.957355003
Pre-training layer 2, epoch 0, cost -101.07479985
Pre-training layer 2, epoch 0, representative training free energy 8831.88451367
Pre-training layer 2, epoch 0, validation free energy 8724.22861841
Pre-training layer 2, epoch 1, cost -78.0928105392
Pre-training layer 2, epoch 2, cost -72.6646679153
Pre-training layer 2, epoch 3, cost -69.7368527222
Pre-training layer 2, epoch 4, cost -67.8110461502
Pre-training layer 2, epoch 5, cost -66.3847546768
Pre-training layer 2, epoch 5, representative training free energy 19299.5686353
Pre-training layer 2, epoch 5, validation free energy 19112.611709
Pre-training layer 2, epoch 6, cost -65.3052309418
Pre-training layer 2, epoch 7, cost -64.4872139969
Pre-training layer 2, epoch 8, cost -63.754297287
Pre-training layer 2, epoch 9, cost -63.2130370026
Pre-training layer 2, epoch 10, cost -62.7475321274
Pre-training layer 2, epoch 10, representative training free energy 27078.4121846
Pre-training layer 2, epoch 10, validation free energy 26839.2797812
Pre-training layer 2, epoch 11, cost -62.3784144821
Pre-training layer 2, epoch 12, cost -61.9217939072
Pre-training layer 2, epoch 13, cost -61.6239688187
Pre-training layer 2, epoch 14, cost -61.2511895981
Pre-training layer 2, epoch 15, cost -60.995839447
Pre-training layer 2, epoch 15, representative training free energy 32891.2716455
Pre-training layer 2, epoch 15, validation free energy 32612.2455166
Pre-training layer 2, epoch 16, cost -60.8347499771
Pre-training layer 2, epoch 17, cost -60.472392189
Pre-training layer 2, epoch 18, cost -60.2834233932
Pre-training layer 2, epoch 19, cost -60.0941807632
Pre-training layer 2, epoch 20, cost -59.9311352844
Pre-training layer 2, epoch 20, representative training free energy 38172.8416924
Pre-training layer 2, epoch 20, validation free energy 37868.7027158
Pre-training layer 2, epoch 21, cost -59.747820015
Pre-training layer 2, epoch 22, cost -59.5860356979
Pre-training layer 2, epoch 23, cost -59.4472097626
Pre-training layer 2, epoch 24, cost -59.259330307
Pre-training layer 2, epoch 25, cost -59.1783430634
Pre-training layer 2, epoch 25, representative training free energy 42714.5731309
Pre-training layer 2, epoch 25, validation free energy 42381.3427314
Pre-training layer 2, epoch 26, cost -59.0517860336
Pre-training layer 2, epoch 27, cost -58.9061371536
Pre-training layer 2, epoch 28, cost -58.7438351517
Pre-training layer 2, epoch 29, cost -58.7433409805
Pre-training layer 2, epoch 30, cost -58.6051989899
Pre-training layer 2, epoch 30, representative training free energy 46435.9564072
Pre-training layer 2, epoch 30, validation free energy 46087.714041
Pre-training layer 2, epoch 31, cost -58.571915802
Pre-training layer 2, epoch 32, cost -58.3551347122
Pre-training layer 2, epoch 33, cost -58.2947896881
Pre-training layer 2, epoch 34, cost -58.2780595398
Pre-training layer 2, epoch 35, cost -58.1235272369
Pre-training layer 2, epoch 35, representative training free energy 50208.1240234
Pre-training layer 2, epoch 35, validation free energy 49842.050918
Pre-training layer 2, epoch 36, cost -58.0709037933
Pre-training layer 2, epoch 37, cost -57.9523443069
Pre-training layer 2, epoch 38, cost -57.9479323883
Pre-training layer 2, epoch 39, cost -57.8360858917
Pre-training layer 2, epoch 40, cost -57.7568132706
Pre-training layer 2, epoch 40, representative training free energy 53418.5607324
Pre-training layer 2, epoch 40, validation free energy 53026.4414238
Pre-training layer 2, epoch 41, cost -57.683985321
Pre-training layer 2, epoch 42, cost -57.6358637772
Pre-training layer 2, epoch 43, cost -57.5718413849
Pre-training layer 2, epoch 44, cost -57.5651937408
Pre-training layer 2, epoch 45, cost -57.5248292618
Pre-training layer 2, epoch 45, representative training free energy 56474.2620938
Pre-training layer 2, epoch 45, validation free energy 56067.2883203
Pre-training layer 2, epoch 46, cost -57.4198183136
Pre-training layer 2, epoch 47, cost -57.3896202927
Pre-training layer 2, epoch 48, cost -57.2325263138
Pre-training layer 2, epoch 49, cost -57.2552083511
Pre-training layer 2, epoch 50, cost -57.1257125168
Pre-training layer 2, epoch 50, representative training free energy 59338.084959
Pre-training layer 2, epoch 50, validation free energy 58918.0191602
Pre-training layer 2, epoch 51, cost -57.1536393204
Pre-training layer 2, epoch 52, cost -57.0910059891
Pre-training layer 2, epoch 53, cost -57.0534550934
Pre-training layer 2, epoch 54, cost -56.9976164703
Pre-training layer 2, epoch 55, cost -56.8929567642
Pre-training layer 2, epoch 55, representative training free energy 61782.1682207
Pre-training layer 2, epoch 55, validation free energy 61355.2935273
Pre-training layer 2, epoch 56, cost -56.9024102325
Pre-training layer 2, epoch 57, cost -56.8873171921
Pre-training layer 2, epoch 58, cost -56.8639549561
Pre-training layer 2, epoch 59, cost -56.8017138672
Pre-training layer 2, epoch 60, cost -56.7759558563
Pre-training layer 2, epoch 60, representative training free energy 64281.6178535
Pre-training layer 2, epoch 60, validation free energy 63854.0189453
Pre-training layer 2, epoch 61, cost -56.6802267151
Pre-training layer 2, epoch 62, cost -56.647819191
Pre-training layer 2, epoch 63, cost -56.6072060852
Pre-training layer 2, epoch 64, cost -56.6461807938
Pre-training layer 2, epoch 65, cost -56.5856397247
Pre-training layer 2, epoch 65, representative training free energy 66671.6959785
Pre-training layer 2, epoch 65, validation free energy 66224.7034297
Pre-training layer 2, epoch 66, cost -56.5001765213
Pre-training layer 2, epoch 67, cost -56.5161471939
Pre-training layer 2, epoch 68, cost -56.4307495346
Pre-training layer 2, epoch 69, cost -56.3863167801
Pre-training layer 2, epoch 70, cost -56.47013871
Pre-training layer 2, epoch 70, representative training free energy 69153.7361172
Pre-training layer 2, epoch 70, validation free energy 68699.4091641
Pre-training layer 2, epoch 71, cost -56.3675727158
Pre-training layer 2, epoch 72, cost -56.3574449997
Pre-training layer 2, epoch 73, cost -56.2821480179
Pre-training layer 2, epoch 74, cost -56.2482040939
Pre-training layer 2, epoch 75, cost -56.3001651764
Pre-training layer 2, epoch 75, representative training free energy 71078.8659707
Pre-training layer 2, epoch 75, validation free energy 70616.5080605
Pre-training layer 2, epoch 76, cost -56.23206353
Pre-training layer 2, epoch 77, cost -56.2298221817
Pre-training layer 2, epoch 78, cost -56.1907767868
Pre-training layer 2, epoch 79, cost -56.1937240982
Pre-training layer 2, epoch 80, cost -56.1265634995
Pre-training layer 2, epoch 80, representative training free energy 73179.2718711
Pre-training layer 2, epoch 80, validation free energy 72715.0011621
Pre-training layer 2, epoch 81, cost -56.1248548965
Pre-training layer 2, epoch 82, cost -56.0934927597
Pre-training layer 2, epoch 83, cost -56.0795799255
Pre-training layer 2, epoch 84, cost -56.0329021606
Pre-training layer 2, epoch 85, cost -56.0006407394
Pre-training layer 2, epoch 85, representative training free energy 75053.9576699
Pre-training layer 2, epoch 85, validation free energy 74575.8639336
Pre-training layer 2, epoch 86, cost -56.0224698715
Pre-training layer 2, epoch 87, cost -55.9252322311
Pre-training layer 2, epoch 88, cost -55.9475768967
Pre-training layer 2, epoch 89, cost -55.917480011
Pre-training layer 2, epoch 90, cost -55.8757419662
Pre-training layer 2, epoch 90, representative training free energy 77008.0434355
Pre-training layer 2, epoch 90, validation free energy 76520.1694492
Pre-training layer 2, epoch 91, cost -55.8762547455
Pre-training layer 2, epoch 92, cost -55.8514542542
Pre-training layer 2, epoch 93, cost -55.8371991501
Pre-training layer 2, epoch 94, cost -55.8134456635
Pre-training layer 2, epoch 95, cost -55.764663765
Pre-training layer 2, epoch 95, representative training free energy 78762.457959
Pre-training layer 2, epoch 95, validation free energy 78274.6246582
Pre-training layer 2, epoch 96, cost -55.7546149139
Pre-training layer 2, epoch 97, cost -55.8228042526
Pre-training layer 2, epoch 98, cost -55.6692417374
Pre-training layer 2, epoch 99, cost -55.7282404099
The pretraining code for file dbn_loop.pyc ran for 4.66m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 14.400000 %
     epoch 1, minibatch 500/500, test error of best model 16.300000 %
epoch 2, minibatch 500/500, validation error 9.500000 %
     epoch 2, minibatch 500/500, test error of best model 9.900000 %
epoch 3, minibatch 500/500, validation error 8.100000 %
     epoch 3, minibatch 500/500, test error of best model 7.600000 %
epoch 4, minibatch 500/500, validation error 7.500000 %
     epoch 4, minibatch 500/500, test error of best model 6.800000 %
epoch 5, minibatch 500/500, validation error 6.500000 %
     epoch 5, minibatch 500/500, test error of best model 6.200000 %
epoch 6, minibatch 500/500, validation error 6.100000 %
     epoch 6, minibatch 500/500, test error of best model 5.900000 %
epoch 7, minibatch 500/500, validation error 5.500000 %
     epoch 7, minibatch 500/500, test error of best model 5.700000 %
epoch 8, minibatch 500/500, validation error 5.300000 %
     epoch 8, minibatch 500/500, test error of best model 5.400000 %
epoch 9, minibatch 500/500, validation error 5.200000 %
     epoch 9, minibatch 500/500, test error of best model 5.100000 %
epoch 10, minibatch 500/500, validation error 4.900000 %
     epoch 10, minibatch 500/500, test error of best model 5.000000 %
epoch 11, minibatch 500/500, validation error 5.100000 %
epoch 12, minibatch 500/500, validation error 5.000000 %
epoch 13, minibatch 500/500, validation error 5.100000 %
epoch 14, minibatch 500/500, validation error 5.300000 %
epoch 15, minibatch 500/500, validation error 5.300000 %
epoch 16, minibatch 500/500, validation error 5.200000 %
epoch 17, minibatch 500/500, validation error 4.900000 %
epoch 18, minibatch 500/500, validation error 4.800000 %
     epoch 18, minibatch 500/500, test error of best model 4.600000 %
epoch 19, minibatch 500/500, validation error 4.800000 %
epoch 20, minibatch 500/500, validation error 4.800000 %
epoch 21, minibatch 500/500, validation error 4.800000 %
epoch 22, minibatch 500/500, validation error 4.800000 %
epoch 23, minibatch 500/500, validation error 4.800000 %
epoch 24, minibatch 500/500, validation error 4.700000 %
     epoch 24, minibatch 500/500, test error of best model 4.300000 %
epoch 25, minibatch 500/500, validation error 4.700000 %
epoch 26, minibatch 500/500, validation error 4.700000 %
epoch 27, minibatch 500/500, validation error 4.700000 %
epoch 28, minibatch 500/500, validation error 4.700000 %
epoch 29, minibatch 500/500, validation error 4.700000 %
epoch 30, minibatch 500/500, validation error 4.700000 %
epoch 31, minibatch 500/500, validation error 4.700000 %
epoch 32, minibatch 500/500, validation error 5.100000 %
epoch 33, minibatch 500/500, validation error 5.000000 %
epoch 34, minibatch 500/500, validation error 4.900000 %
epoch 35, minibatch 500/500, validation error 5.000000 %
epoch 36, minibatch 500/500, validation error 5.000000 %
epoch 37, minibatch 500/500, validation error 5.000000 %
epoch 38, minibatch 500/500, validation error 5.000000 %
epoch 39, minibatch 500/500, validation error 5.000000 %
epoch 40, minibatch 500/500, validation error 4.900000 %
epoch 41, minibatch 500/500, validation error 4.900000 %
epoch 42, minibatch 500/500, validation error 4.900000 %
epoch 43, minibatch 500/500, validation error 4.900000 %
epoch 44, minibatch 500/500, validation error 4.900000 %
epoch 45, minibatch 500/500, validation error 4.900000 %
epoch 46, minibatch 500/500, validation error 4.900000 %
epoch 47, minibatch 500/500, validation error 4.800000 %
Optimization complete with best validation score of 4.700000 %, obtained at iteration 12000, with test performance 4.300000 %
The fine tuning code for file dbn_loop.pyc ran for 0.97m


==========Layers: [1000, 1000, 1000, 1000] ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.891703064
Pre-training layer 0, epoch 0, representative training free energy -408.971988342
Pre-training layer 0, epoch 0, validation free energy -403.586522369
Pre-training layer 0, epoch 1, cost -96.648065033
Pre-training layer 0, epoch 2, cost -90.8996651306
Pre-training layer 0, epoch 3, cost -87.9261756973
Pre-training layer 0, epoch 4, cost -85.7770488739
Pre-training layer 0, epoch 5, cost -84.2676589584
Pre-training layer 0, epoch 5, representative training free energy -355.159690308
Pre-training layer 0, epoch 5, validation free energy -348.117980484
Pre-training layer 0, epoch 6, cost -82.9336881256
Pre-training layer 0, epoch 7, cost -82.0548139114
Pre-training layer 0, epoch 8, cost -81.1860886078
Pre-training layer 0, epoch 9, cost -80.460631546
Pre-training layer 0, epoch 10, cost -79.909825531
Pre-training layer 0, epoch 10, representative training free energy -342.595530334
Pre-training layer 0, epoch 10, validation free energy -335.301955933
Pre-training layer 0, epoch 11, cost -79.2577681351
Pre-training layer 0, epoch 12, cost -78.8175806274
Pre-training layer 0, epoch 13, cost -78.3853638
Pre-training layer 0, epoch 14, cost -78.0257814178
Pre-training layer 0, epoch 15, cost -77.6190183258
Pre-training layer 0, epoch 15, representative training free energy -335.341560867
Pre-training layer 0, epoch 15, validation free energy -326.663825302
Pre-training layer 0, epoch 16, cost -77.3086790161
Pre-training layer 0, epoch 17, cost -76.8748340607
Pre-training layer 0, epoch 18, cost -76.5939669266
Pre-training layer 0, epoch 19, cost -76.3336750259
Pre-training layer 0, epoch 20, cost -76.1395336151
Pre-training layer 0, epoch 20, representative training free energy -329.904410568
Pre-training layer 0, epoch 20, validation free energy -321.250991562
Pre-training layer 0, epoch 21, cost -75.8347556686
Pre-training layer 0, epoch 22, cost -75.6723660278
Pre-training layer 0, epoch 23, cost -75.4299065781
Pre-training layer 0, epoch 24, cost -75.3169438248
Pre-training layer 0, epoch 25, cost -75.1261656799
Pre-training layer 0, epoch 25, representative training free energy -326.763758347
Pre-training layer 0, epoch 25, validation free energy -317.875212723
Pre-training layer 0, epoch 26, cost -74.9399118195
Pre-training layer 0, epoch 27, cost -74.7518065796
Pre-training layer 0, epoch 28, cost -74.5548426056
Pre-training layer 0, epoch 29, cost -74.3218930054
Pre-training layer 0, epoch 30, cost -74.1897884521
Pre-training layer 0, epoch 30, representative training free energy -324.307744171
Pre-training layer 0, epoch 30, validation free energy -314.309983368
Pre-training layer 0, epoch 31, cost -74.1987170792
Pre-training layer 0, epoch 32, cost -74.0006261063
Pre-training layer 0, epoch 33, cost -73.7883592224
Pre-training layer 0, epoch 34, cost -73.6265758438
Pre-training layer 0, epoch 35, cost -73.5276639938
Pre-training layer 0, epoch 35, representative training free energy -317.43393425
Pre-training layer 0, epoch 35, validation free energy -307.053049561
Pre-training layer 0, epoch 36, cost -73.454187561
Pre-training layer 0, epoch 37, cost -73.331480751
Pre-training layer 0, epoch 38, cost -73.1119442902
Pre-training layer 0, epoch 39, cost -73.1258069687
Pre-training layer 0, epoch 40, cost -72.9798473206
Pre-training layer 0, epoch 40, representative training free energy -312.958551529
Pre-training layer 0, epoch 40, validation free energy -302.499975952
Pre-training layer 0, epoch 41, cost -72.906083168
Pre-training layer 0, epoch 42, cost -72.7954292679
Pre-training layer 0, epoch 43, cost -72.6382967377
Pre-training layer 0, epoch 44, cost -72.6530088348
Pre-training layer 0, epoch 45, cost -72.5481951904
Pre-training layer 0, epoch 45, representative training free energy -310.539376724
Pre-training layer 0, epoch 45, validation free energy -299.40632103
Pre-training layer 0, epoch 46, cost -72.3317704315
Pre-training layer 0, epoch 47, cost -72.3499616089
Pre-training layer 0, epoch 48, cost -72.2702876205
Pre-training layer 0, epoch 49, cost -72.1854229279
Pre-training layer 0, epoch 50, cost -72.0948669739
Pre-training layer 0, epoch 50, representative training free energy -305.587609726
Pre-training layer 0, epoch 50, validation free energy -294.69539566
Pre-training layer 0, epoch 51, cost -71.9582070389
Pre-training layer 0, epoch 52, cost -71.9853307724
Pre-training layer 0, epoch 53, cost -71.9248946762
Pre-training layer 0, epoch 54, cost -71.734079155
Pre-training layer 0, epoch 55, cost -71.7134382935
Pre-training layer 0, epoch 55, representative training free energy -301.419353119
Pre-training layer 0, epoch 55, validation free energy -290.475439102
Pre-training layer 0, epoch 56, cost -71.5425473251
Pre-training layer 0, epoch 57, cost -71.5645794678
Pre-training layer 0, epoch 58, cost -71.5036115952
Pre-training layer 0, epoch 59, cost -71.4090947113
Pre-training layer 0, epoch 60, cost -71.4189627991
Pre-training layer 0, epoch 60, representative training free energy -297.241764023
Pre-training layer 0, epoch 60, validation free energy -286.444462982
Pre-training layer 0, epoch 61, cost -71.2144478683
Pre-training layer 0, epoch 62, cost -71.2099968796
Pre-training layer 0, epoch 63, cost -71.1772263184
Pre-training layer 0, epoch 64, cost -71.1627873993
Pre-training layer 0, epoch 65, cost -70.9814063644
Pre-training layer 0, epoch 65, representative training free energy -293.357245865
Pre-training layer 0, epoch 65, validation free energy -282.580619736
Pre-training layer 0, epoch 66, cost -70.9604136505
Pre-training layer 0, epoch 67, cost -70.9155658417
Pre-training layer 0, epoch 68, cost -70.8571275024
Pre-training layer 0, epoch 69, cost -70.8310857162
Pre-training layer 0, epoch 70, cost -70.837685463
Pre-training layer 0, epoch 70, representative training free energy -287.740702423
Pre-training layer 0, epoch 70, validation free energy -276.41230809
Pre-training layer 0, epoch 71, cost -70.6747039108
Pre-training layer 0, epoch 72, cost -70.6590610733
Pre-training layer 0, epoch 73, cost -70.5454827728
Pre-training layer 0, epoch 74, cost -70.5906186752
Pre-training layer 0, epoch 75, cost -70.4905086212
Pre-training layer 0, epoch 75, representative training free energy -281.840385391
Pre-training layer 0, epoch 75, validation free energy -270.205735825
Pre-training layer 0, epoch 76, cost -70.4948969345
Pre-training layer 0, epoch 77, cost -70.3318629761
Pre-training layer 0, epoch 78, cost -70.3259088211
Pre-training layer 0, epoch 79, cost -70.3032120743
Pre-training layer 0, epoch 80, cost -70.2049270248
Pre-training layer 0, epoch 80, representative training free energy -284.798125214
Pre-training layer 0, epoch 80, validation free energy -272.567906265
Pre-training layer 0, epoch 81, cost -70.1911842804
Pre-training layer 0, epoch 82, cost -70.10985849
Pre-training layer 0, epoch 83, cost -70.0923416519
Pre-training layer 0, epoch 84, cost -70.0769632034
Pre-training layer 0, epoch 85, cost -70.0566537476
Pre-training layer 0, epoch 85, representative training free energy -277.651582199
Pre-training layer 0, epoch 85, validation free energy -264.763269165
Pre-training layer 0, epoch 86, cost -69.9110250626
Pre-training layer 0, epoch 87, cost -69.8500929718
Pre-training layer 0, epoch 88, cost -69.8907824097
Pre-training layer 0, epoch 89, cost -69.8070307236
Pre-training layer 0, epoch 90, cost -69.8274797897
Pre-training layer 0, epoch 90, representative training free energy -274.338656448
Pre-training layer 0, epoch 90, validation free energy -261.993782883
Pre-training layer 0, epoch 91, cost -69.7287209091
Pre-training layer 0, epoch 92, cost -69.663282547
Pre-training layer 0, epoch 93, cost -69.6282642059
Pre-training layer 0, epoch 94, cost -69.6060275345
Pre-training layer 0, epoch 95, cost -69.5901653061
Pre-training layer 0, epoch 95, representative training free energy -272.159959473
Pre-training layer 0, epoch 95, validation free energy -259.508128693
Pre-training layer 0, epoch 96, cost -69.5936767578
Pre-training layer 0, epoch 97, cost -69.431187233
Pre-training layer 0, epoch 98, cost -69.3918158875
Pre-training layer 0, epoch 99, cost -69.3050520935
Pre-training layer 1, epoch 0, cost -173.316402878
Pre-training layer 1, epoch 0, representative training free energy -145838.565137
Pre-training layer 1, epoch 0, validation free energy -144842.636488
Pre-training layer 1, epoch 1, cost -143.205867126
Pre-training layer 1, epoch 2, cost -135.037659943
Pre-training layer 1, epoch 3, cost -130.382867188
Pre-training layer 1, epoch 4, cost -127.31084285
Pre-training layer 1, epoch 5, cost -125.013868759
Pre-training layer 1, epoch 5, representative training free energy -201047.732562
Pre-training layer 1, epoch 5, validation free energy -199547.16357
Pre-training layer 1, epoch 6, cost -123.302507767
Pre-training layer 1, epoch 7, cost -121.90727684
Pre-training layer 1, epoch 8, cost -120.749317047
Pre-training layer 1, epoch 9, cost -119.810737137
Pre-training layer 1, epoch 10, cost -118.840280289
Pre-training layer 1, epoch 10, representative training free energy -222242.975992
Pre-training layer 1, epoch 10, validation free energy -220508.734609
Pre-training layer 1, epoch 11, cost -118.123934586
Pre-training layer 1, epoch 12, cost -117.502696304
Pre-training layer 1, epoch 13, cost -116.921308807
Pre-training layer 1, epoch 14, cost -116.36507312
Pre-training layer 1, epoch 15, cost -115.858476257
Pre-training layer 1, epoch 15, representative training free energy -236313.23907
Pre-training layer 1, epoch 15, validation free energy -234474.554859
Pre-training layer 1, epoch 16, cost -115.489896652
Pre-training layer 1, epoch 17, cost -114.989821579
Pre-training layer 1, epoch 18, cost -114.747156876
Pre-training layer 1, epoch 19, cost -114.364742218
Pre-training layer 1, epoch 20, cost -114.086403091
Pre-training layer 1, epoch 20, representative training free energy -247190.516148
Pre-training layer 1, epoch 20, validation free energy -245289.623203
Pre-training layer 1, epoch 21, cost -113.683828064
Pre-training layer 1, epoch 22, cost -113.460250519
Pre-training layer 1, epoch 23, cost -113.158478424
Pre-training layer 1, epoch 24, cost -112.922073044
Pre-training layer 1, epoch 25, cost -112.671396255
Pre-training layer 1, epoch 25, representative training free energy -256126.221664
Pre-training layer 1, epoch 25, validation free energy -254154.477234
Pre-training layer 1, epoch 26, cost -112.437952057
Pre-training layer 1, epoch 27, cost -112.26380632
Pre-training layer 1, epoch 28, cost -112.090392273
Pre-training layer 1, epoch 29, cost -111.82944545
Pre-training layer 1, epoch 30, cost -111.664665909
Pre-training layer 1, epoch 30, representative training free energy -263885.672633
Pre-training layer 1, epoch 30, validation free energy -261885.510227
Pre-training layer 1, epoch 31, cost -111.631921768
Pre-training layer 1, epoch 32, cost -111.399921021
Pre-training layer 1, epoch 33, cost -111.140764099
Pre-training layer 1, epoch 34, cost -111.043020584
Pre-training layer 1, epoch 35, cost -110.893737061
Pre-training layer 1, epoch 35, representative training free energy -270303.59468
Pre-training layer 1, epoch 35, validation free energy -268265.258062
Pre-training layer 1, epoch 36, cost -110.757275024
Pre-training layer 1, epoch 37, cost -110.635995544
Pre-training layer 1, epoch 38, cost -110.4679646
Pre-training layer 1, epoch 39, cost -110.385500595
Pre-training layer 1, epoch 40, cost -110.298762955
Pre-training layer 1, epoch 40, representative training free energy -275923.929453
Pre-training layer 1, epoch 40, validation free energy -273807.324148
Pre-training layer 1, epoch 41, cost -110.159639389
Pre-training layer 1, epoch 42, cost -110.036749893
Pre-training layer 1, epoch 43, cost -110.022415359
Pre-training layer 1, epoch 44, cost -109.840845886
Pre-training layer 1, epoch 45, cost -109.711296844
Pre-training layer 1, epoch 45, representative training free energy -281360.792148
Pre-training layer 1, epoch 45, validation free energy -279242.880734
Pre-training layer 1, epoch 46, cost -109.606865189
Pre-training layer 1, epoch 47, cost -109.588683319
Pre-training layer 1, epoch 48, cost -109.400843925
Pre-training layer 1, epoch 49, cost -109.33334581
Pre-training layer 1, epoch 50, cost -109.235820854
Pre-training layer 1, epoch 50, representative training free energy -286019.39993
Pre-training layer 1, epoch 50, validation free energy -283855.573961
Pre-training layer 1, epoch 51, cost -109.261053802
Pre-training layer 1, epoch 52, cost -109.08145105
Pre-training layer 1, epoch 53, cost -109.079318253
Pre-training layer 1, epoch 54, cost -108.924161148
Pre-training layer 1, epoch 55, cost -108.888206711
Pre-training layer 1, epoch 55, representative training free energy -290625.509164
Pre-training layer 1, epoch 55, validation free energy -288437.335477
Pre-training layer 1, epoch 56, cost -108.877001122
Pre-training layer 1, epoch 57, cost -108.819146729
Pre-training layer 1, epoch 58, cost -108.717880356
Pre-training layer 1, epoch 59, cost -108.678135086
Pre-training layer 1, epoch 60, cost -108.546102463
Pre-training layer 1, epoch 60, representative training free energy -294538.926242
Pre-training layer 1, epoch 60, validation free energy -292327.785758
Pre-training layer 1, epoch 61, cost -108.552008202
Pre-training layer 1, epoch 62, cost -108.464117737
Pre-training layer 1, epoch 63, cost -108.455908539
Pre-training layer 1, epoch 64, cost -108.248508087
Pre-training layer 1, epoch 65, cost -108.328468536
Pre-training layer 1, epoch 65, representative training free energy -298316.29475
Pre-training layer 1, epoch 65, validation free energy -296090.157398
Pre-training layer 1, epoch 66, cost -108.218648987
Pre-training layer 1, epoch 67, cost -108.164563957
Pre-training layer 1, epoch 68, cost -108.165062759
Pre-training layer 1, epoch 69, cost -108.093057312
Pre-training layer 1, epoch 70, cost -108.121498718
Pre-training layer 1, epoch 70, representative training free energy -301812.402656
Pre-training layer 1, epoch 70, validation free energy -299566.364898
Pre-training layer 1, epoch 71, cost -108.03231295
Pre-training layer 1, epoch 72, cost -107.94626619
Pre-training layer 1, epoch 73, cost -107.905207825
Pre-training layer 1, epoch 74, cost -107.904693062
Pre-training layer 1, epoch 75, cost -107.875426628
Pre-training layer 1, epoch 75, representative training free energy -305210.239344
Pre-training layer 1, epoch 75, validation free energy -302889.658602
Pre-training layer 1, epoch 76, cost -107.768247322
Pre-training layer 1, epoch 77, cost -107.811499542
Pre-training layer 1, epoch 78, cost -107.743803268
Pre-training layer 1, epoch 79, cost -107.604662224
Pre-training layer 1, epoch 80, cost -107.629528542
Pre-training layer 1, epoch 80, representative training free energy -308119.750773
Pre-training layer 1, epoch 80, validation free energy -305806.970422
Pre-training layer 1, epoch 81, cost -107.644445847
Pre-training layer 1, epoch 82, cost -107.552382164
Pre-training layer 1, epoch 83, cost -107.592650864
Pre-training layer 1, epoch 84, cost -107.491846832
Pre-training layer 1, epoch 85, cost -107.499814178
Pre-training layer 1, epoch 85, representative training free energy -311095.940039
Pre-training layer 1, epoch 85, validation free energy -308765.922742
Pre-training layer 1, epoch 86, cost -107.403520866
Pre-training layer 1, epoch 87, cost -107.350010719
Pre-training layer 1, epoch 88, cost -107.421053947
Pre-training layer 1, epoch 89, cost -107.344925255
Pre-training layer 1, epoch 90, cost -107.275695793
Pre-training layer 1, epoch 90, representative training free energy -314180.64318
Pre-training layer 1, epoch 90, validation free energy -311810.865047
Pre-training layer 1, epoch 91, cost -107.208522583
Pre-training layer 1, epoch 92, cost -107.17941626
Pre-training layer 1, epoch 93, cost -107.223619232
Pre-training layer 1, epoch 94, cost -107.159047775
Pre-training layer 1, epoch 95, cost -107.134893585
Pre-training layer 1, epoch 95, representative training free energy -317012.693648
Pre-training layer 1, epoch 95, validation free energy -314631.801359
Pre-training layer 1, epoch 96, cost -107.133253815
Pre-training layer 1, epoch 97, cost -107.030995361
Pre-training layer 1, epoch 98, cost -107.105404617
Pre-training layer 1, epoch 99, cost -107.049755501
Pre-training layer 2, epoch 0, cost -102.178703102
Pre-training layer 2, epoch 0, representative training free energy 8808.94598682
Pre-training layer 2, epoch 0, validation free energy 8643.46965063
Pre-training layer 2, epoch 1, cost -79.0566893082
Pre-training layer 2, epoch 2, cost -73.6031467514
Pre-training layer 2, epoch 3, cost -70.7685967712
Pre-training layer 2, epoch 4, cost -68.7743888168
Pre-training layer 2, epoch 5, cost -67.3637844315
Pre-training layer 2, epoch 5, representative training free energy 19869.0166367
Pre-training layer 2, epoch 5, validation free energy 19685.7789546
Pre-training layer 2, epoch 6, cost -66.2537747192
Pre-training layer 2, epoch 7, cost -65.4988899765
Pre-training layer 2, epoch 8, cost -64.8497241745
Pre-training layer 2, epoch 9, cost -64.234670929
Pre-training layer 2, epoch 10, cost -63.696304718
Pre-training layer 2, epoch 10, representative training free energy 28429.7911113
Pre-training layer 2, epoch 10, validation free energy 28177.9713242
Pre-training layer 2, epoch 11, cost -63.397652092
Pre-training layer 2, epoch 12, cost -62.8994271317
Pre-training layer 2, epoch 13, cost -62.6135556793
Pre-training layer 2, epoch 14, cost -62.2701667328
Pre-training layer 2, epoch 15, cost -61.9229587326
Pre-training layer 2, epoch 15, representative training free energy 35478.8177354
Pre-training layer 2, epoch 15, validation free energy 35172.2587051
Pre-training layer 2, epoch 16, cost -61.766035675
Pre-training layer 2, epoch 17, cost -61.5402870102
Pre-training layer 2, epoch 18, cost -61.3372891617
Pre-training layer 2, epoch 19, cost -61.0932913208
Pre-training layer 2, epoch 20, cost -60.9461494217
Pre-training layer 2, epoch 20, representative training free energy 41249.030377
Pre-training layer 2, epoch 20, validation free energy 40891.8631426
Pre-training layer 2, epoch 21, cost -60.7180589676
Pre-training layer 2, epoch 22, cost -60.5225890884
Pre-training layer 2, epoch 23, cost -60.5125805817
Pre-training layer 2, epoch 24, cost -60.4585902405
Pre-training layer 2, epoch 25, cost -60.1455702667
Pre-training layer 2, epoch 25, representative training free energy 46407.1307822
Pre-training layer 2, epoch 25, validation free energy 46005.8283857
Pre-training layer 2, epoch 26, cost -60.0470484467
Pre-training layer 2, epoch 27, cost -59.958574379
Pre-training layer 2, epoch 28, cost -59.802523941
Pre-training layer 2, epoch 29, cost -59.7520224228
Pre-training layer 2, epoch 30, cost -59.6001261673
Pre-training layer 2, epoch 30, representative training free energy 51104.706709
Pre-training layer 2, epoch 30, validation free energy 50654.08475
Pre-training layer 2, epoch 31, cost -59.5186268845
Pre-training layer 2, epoch 32, cost -59.3680127258
Pre-training layer 2, epoch 33, cost -59.2657615051
Pre-training layer 2, epoch 34, cost -59.2100066681
Pre-training layer 2, epoch 35, cost -59.1949560013
Pre-training layer 2, epoch 35, representative training free energy 55288.6676523
Pre-training layer 2, epoch 35, validation free energy 54802.2692969
Pre-training layer 2, epoch 36, cost -59.0108103409
Pre-training layer 2, epoch 37, cost -59.0656107635
Pre-training layer 2, epoch 38, cost -58.9293570862
Pre-training layer 2, epoch 39, cost -58.848655304
Pre-training layer 2, epoch 40, cost -58.7669564514
Pre-training layer 2, epoch 40, representative training free energy 59067.5958359
Pre-training layer 2, epoch 40, validation free energy 58547.5765664
Pre-training layer 2, epoch 41, cost -58.7580370483
Pre-training layer 2, epoch 42, cost -58.6838097458
Pre-training layer 2, epoch 43, cost -58.5196441727
Pre-training layer 2, epoch 44, cost -58.539095459
Pre-training layer 2, epoch 45, cost -58.4577982101
Pre-training layer 2, epoch 45, representative training free energy 61938.8204863
Pre-training layer 2, epoch 45, validation free energy 61387.4849023
Pre-training layer 2, epoch 46, cost -58.4335410233
Pre-training layer 2, epoch 47, cost -58.299647377
Pre-training layer 2, epoch 48, cost -58.2924401932
Pre-training layer 2, epoch 49, cost -58.2909328308
Pre-training layer 2, epoch 50, cost -58.2577951813
Pre-training layer 2, epoch 50, representative training free energy 64829.5876914
Pre-training layer 2, epoch 50, validation free energy 64241.0124863
Pre-training layer 2, epoch 51, cost -58.123285141
Pre-training layer 2, epoch 52, cost -58.1410302582
Pre-training layer 2, epoch 53, cost -58.0718621368
Pre-training layer 2, epoch 54, cost -58.0360243683
Pre-training layer 2, epoch 55, cost -58.0056638031
Pre-training layer 2, epoch 55, representative training free energy 68122.816916
Pre-training layer 2, epoch 55, validation free energy 67495.8425723
Pre-training layer 2, epoch 56, cost -57.9835562363
Pre-training layer 2, epoch 57, cost -57.9053089371
Pre-training layer 2, epoch 58, cost -57.8727898636
Pre-training layer 2, epoch 59, cost -57.8145095901
Pre-training layer 2, epoch 60, cost -57.8009012833
Pre-training layer 2, epoch 60, representative training free energy 70656.723418
Pre-training layer 2, epoch 60, validation free energy 69993.5525801
Pre-training layer 2, epoch 61, cost -57.6914017105
Pre-training layer 2, epoch 62, cost -57.7757564011
Pre-training layer 2, epoch 63, cost -57.6834922867
Pre-training layer 2, epoch 64, cost -57.6159571304
Pre-training layer 2, epoch 65, cost -57.5798107529
Pre-training layer 2, epoch 65, representative training free energy 73401.0617324
Pre-training layer 2, epoch 65, validation free energy 72720.3031113
Pre-training layer 2, epoch 66, cost -57.5152345047
Pre-training layer 2, epoch 67, cost -57.5926604462
Pre-training layer 2, epoch 68, cost -57.4817931519
Pre-training layer 2, epoch 69, cost -57.4304684982
Pre-training layer 2, epoch 70, cost -57.4282573929
Pre-training layer 2, epoch 70, representative training free energy 75760.5867441
Pre-training layer 2, epoch 70, validation free energy 75052.1746348
Pre-training layer 2, epoch 71, cost -57.3371334839
Pre-training layer 2, epoch 72, cost -57.3956669235
Pre-training layer 2, epoch 73, cost -57.3109875565
Pre-training layer 2, epoch 74, cost -57.3188686905
Pre-training layer 2, epoch 75, cost -57.2082154465
Pre-training layer 2, epoch 75, representative training free energy 78142.2830859
Pre-training layer 2, epoch 75, validation free energy 77414.2198066
Pre-training layer 2, epoch 76, cost -57.2047456207
Pre-training layer 2, epoch 77, cost -57.2059126968
Pre-training layer 2, epoch 78, cost -57.2085348434
Pre-training layer 2, epoch 79, cost -57.1164087982
Pre-training layer 2, epoch 80, cost -57.0411111679
Pre-training layer 2, epoch 80, representative training free energy 80314.1483672
Pre-training layer 2, epoch 80, validation free energy 79572.134377
Pre-training layer 2, epoch 81, cost -57.0828841171
Pre-training layer 2, epoch 82, cost -57.0465853119
Pre-training layer 2, epoch 83, cost -57.0428111267
Pre-training layer 2, epoch 84, cost -57.02423069
Pre-training layer 2, epoch 85, cost -57.0855700455
Pre-training layer 2, epoch 85, representative training free energy 82257.976375
Pre-training layer 2, epoch 85, validation free energy 81492.7163555
Pre-training layer 2, epoch 86, cost -56.9950404663
Pre-training layer 2, epoch 87, cost -56.9087222824
Pre-training layer 2, epoch 88, cost -56.9753612747
Pre-training layer 2, epoch 89, cost -56.8773932114
Pre-training layer 2, epoch 90, cost -56.7877211685
Pre-training layer 2, epoch 90, representative training free energy 84083.0085059
Pre-training layer 2, epoch 90, validation free energy 83304.4662441
Pre-training layer 2, epoch 91, cost -56.8739034042
Pre-training layer 2, epoch 92, cost -56.8610437088
Pre-training layer 2, epoch 93, cost -56.8072080994
Pre-training layer 2, epoch 94, cost -56.8154095078
Pre-training layer 2, epoch 95, cost -56.7485471191
Pre-training layer 2, epoch 95, representative training free energy 85725.6048242
Pre-training layer 2, epoch 95, validation free energy 84925.6207187
Pre-training layer 2, epoch 96, cost -56.7312722626
Pre-training layer 2, epoch 97, cost -56.7066340408
Pre-training layer 2, epoch 98, cost -56.6892966919
Pre-training layer 2, epoch 99, cost -56.7351764374
Pre-training layer 3, epoch 0, cost -141.598774155
Pre-training layer 3, epoch 0, representative training free energy -529388596.576
Pre-training layer 3, epoch 0, validation free energy -526062717.568
Pre-training layer 3, epoch 1, cost -113.649864578
Pre-training layer 3, epoch 2, cost -106.411223389
Pre-training layer 3, epoch 3, cost -102.49874086
Pre-training layer 3, epoch 4, cost -100.063425125
Pre-training layer 3, epoch 5, cost -98.2541256866
Pre-training layer 3, epoch 5, representative training free energy -765666862.832
Pre-training layer 3, epoch 5, validation free energy -760633993.504
Pre-training layer 3, epoch 6, cost -96.9316197357
Pre-training layer 3, epoch 7, cost -95.874812027
Pre-training layer 3, epoch 8, cost -94.9540776901
Pre-training layer 3, epoch 9, cost -94.1838132172
Pre-training layer 3, epoch 10, cost -93.7342654877
Pre-training layer 3, epoch 10, representative training free energy -859084967.456
Pre-training layer 3, epoch 10, validation free energy -853387086.848
Pre-training layer 3, epoch 11, cost -93.2133067474
Pre-training layer 3, epoch 12, cost -92.6859747772
Pre-training layer 3, epoch 13, cost -92.3549677277
Pre-training layer 3, epoch 14, cost -92.0499049454
Pre-training layer 3, epoch 15, cost -91.7462920685
Pre-training layer 3, epoch 15, representative training free energy -922357457.856
Pre-training layer 3, epoch 15, validation free energy -916186913.44
Pre-training layer 3, epoch 16, cost -91.4021407394
Pre-training layer 3, epoch 17, cost -91.1744395447
Pre-training layer 3, epoch 18, cost -90.9558733368
Pre-training layer 3, epoch 19, cost -90.7688228607
Pre-training layer 3, epoch 20, cost -90.518287796
Pre-training layer 3, epoch 20, representative training free energy -970711863.712
Pre-training layer 3, epoch 20, validation free energy -964209056.16
Pre-training layer 3, epoch 21, cost -90.398022522
Pre-training layer 3, epoch 22, cost -90.1914805145
Pre-training layer 3, epoch 23, cost -90.0736774368
Pre-training layer 3, epoch 24, cost -89.8887462616
Pre-training layer 3, epoch 25, cost -89.7140430069
Pre-training layer 3, epoch 25, representative training free energy -1009676610.43
Pre-training layer 3, epoch 25, validation free energy -1002902913.5
Pre-training layer 3, epoch 26, cost -89.6751427002
Pre-training layer 3, epoch 27, cost -89.4793143387
Pre-training layer 3, epoch 28, cost -89.463822258
Pre-training layer 3, epoch 29, cost -89.2874443512
Pre-training layer 3, epoch 30, cost -89.163043869
Pre-training layer 3, epoch 30, representative training free energy -1043787810.24
Pre-training layer 3, epoch 30, validation free energy -1036766297.86
Pre-training layer 3, epoch 31, cost -89.0945220184
Pre-training layer 3, epoch 32, cost -88.9491397324
Pre-training layer 3, epoch 33, cost -88.8655614014
Pre-training layer 3, epoch 34, cost -88.7926381989
Pre-training layer 3, epoch 35, cost -88.7259062805
Pre-training layer 3, epoch 35, representative training free energy -1074453231.33
Pre-training layer 3, epoch 35, validation free energy -1067218051.04
Pre-training layer 3, epoch 36, cost -88.7085459366
Pre-training layer 3, epoch 37, cost -88.5491879196
Pre-training layer 3, epoch 38, cost -88.5506607132
Pre-training layer 3, epoch 39, cost -88.4637116165
Pre-training layer 3, epoch 40, cost -88.3965928345
Pre-training layer 3, epoch 40, representative training free energy -1099125369.44
Pre-training layer 3, epoch 40, validation free energy -1091708363.62
Pre-training layer 3, epoch 41, cost -88.3492702713
Pre-training layer 3, epoch 42, cost -88.2591487885
Pre-training layer 3, epoch 43, cost -88.2444585114
Pre-training layer 3, epoch 44, cost -88.0732295609
Pre-training layer 3, epoch 45, cost -88.0587534637
Pre-training layer 3, epoch 45, representative training free energy -1123222743.04
Pre-training layer 3, epoch 45, validation free energy -1115643856.74
Pre-training layer 3, epoch 46, cost -88.009928978
Pre-training layer 3, epoch 47, cost -87.9599801788
Pre-training layer 3, epoch 48, cost -87.8661608505
Pre-training layer 3, epoch 49, cost -87.8916490784
Pre-training layer 3, epoch 50, cost -87.8092050018
Pre-training layer 3, epoch 50, representative training free energy -1145938906.4
Pre-training layer 3, epoch 50, validation free energy -1138203956.29
Pre-training layer 3, epoch 51, cost -87.7830607986
Pre-training layer 3, epoch 52, cost -87.7102737885
Pre-training layer 3, epoch 53, cost -87.7010805511
Pre-training layer 3, epoch 54, cost -87.639077034
Pre-training layer 3, epoch 55, cost -87.5495998993
Pre-training layer 3, epoch 55, representative training free energy -1165295077.22
Pre-training layer 3, epoch 55, validation free energy -1157412799.65
Pre-training layer 3, epoch 56, cost -87.4708525848
Pre-training layer 3, epoch 57, cost -87.5445099945
Pre-training layer 3, epoch 58, cost -87.4592505646
Pre-training layer 3, epoch 59, cost -87.4338521042
Pre-training layer 3, epoch 60, cost -87.3667459946
Pre-training layer 3, epoch 60, representative training free energy -1184394537.66
Pre-training layer 3, epoch 60, validation free energy -1176371429.22
Pre-training layer 3, epoch 61, cost -87.3410202789
Pre-training layer 3, epoch 62, cost -87.3348978806
Pre-training layer 3, epoch 63, cost -87.2851466064
Pre-training layer 3, epoch 64, cost -87.19133815
Pre-training layer 3, epoch 65, cost -87.2238826675
Pre-training layer 3, epoch 65, representative training free energy -1201233432.7
Pre-training layer 3, epoch 65, validation free energy -1193075597.12
Pre-training layer 3, epoch 66, cost -87.1874204483
Pre-training layer 3, epoch 67, cost -87.1521232986
Pre-training layer 3, epoch 68, cost -87.1537662048
Pre-training layer 3, epoch 69, cost -87.0761517944
Pre-training layer 3, epoch 70, cost -87.105989357
Pre-training layer 3, epoch 70, representative training free energy -1219968050.3
Pre-training layer 3, epoch 70, validation free energy -1211687900.19
Pre-training layer 3, epoch 71, cost -86.9896772308
Pre-training layer 3, epoch 72, cost -86.9562609329
Pre-training layer 3, epoch 73, cost -86.9589566574
Pre-training layer 3, epoch 74, cost -86.9889828644
Pre-training layer 3, epoch 75, cost -86.9632344894
Pre-training layer 3, epoch 75, representative training free energy -1233425434.62
Pre-training layer 3, epoch 75, validation free energy -1225049098.24
Pre-training layer 3, epoch 76, cost -86.8572677078
Pre-training layer 3, epoch 77, cost -86.8590480194
Pre-training layer 3, epoch 78, cost -86.9124798965
Pre-training layer 3, epoch 79, cost -86.8758064499
Pre-training layer 3, epoch 80, cost -86.7912419815
Pre-training layer 3, epoch 80, representative training free energy -1247928500.1
Pre-training layer 3, epoch 80, validation free energy -1239455981.38
Pre-training layer 3, epoch 81, cost -86.8006872864
Pre-training layer 3, epoch 82, cost -86.8045498352
Pre-training layer 3, epoch 83, cost -86.7376072235
Pre-training layer 3, epoch 84, cost -86.7514650879
Pre-training layer 3, epoch 85, cost -86.7381029282
Pre-training layer 3, epoch 85, representative training free energy -1260068183.94
Pre-training layer 3, epoch 85, validation free energy -1251504014.75
Pre-training layer 3, epoch 86, cost -86.7152616882
Pre-training layer 3, epoch 87, cost -86.6906948013
Pre-training layer 3, epoch 88, cost -86.6870276794
Pre-training layer 3, epoch 89, cost -86.6541986542
Pre-training layer 3, epoch 90, cost -86.6343779297
Pre-training layer 3, epoch 90, representative training free energy -1273449402.46
Pre-training layer 3, epoch 90, validation free energy -1264762097.09
Pre-training layer 3, epoch 91, cost -86.59848806
Pre-training layer 3, epoch 92, cost -86.6493421936
Pre-training layer 3, epoch 93, cost -86.5649464569
Pre-training layer 3, epoch 94, cost -86.5212396698
Pre-training layer 3, epoch 95, cost -86.5408996277
Pre-training layer 3, epoch 95, representative training free energy -1284377010.05
Pre-training layer 3, epoch 95, validation free energy -1275618395.07
Pre-training layer 3, epoch 96, cost -86.5250688324
Pre-training layer 3, epoch 97, cost -86.5523502274
Pre-training layer 3, epoch 98, cost -86.4694481506
Pre-training layer 3, epoch 99, cost -86.4714331512
The pretraining code for file dbn_loop.pyc ran for 6.69m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 14.400000 %
     epoch 1, minibatch 500/500, test error of best model 14.800000 %
epoch 2, minibatch 500/500, validation error 10.000000 %
     epoch 2, minibatch 500/500, test error of best model 9.900000 %
epoch 3, minibatch 500/500, validation error 8.400000 %
     epoch 3, minibatch 500/500, test error of best model 7.500000 %
epoch 4, minibatch 500/500, validation error 7.000000 %
     epoch 4, minibatch 500/500, test error of best model 6.800000 %
epoch 5, minibatch 500/500, validation error 6.400000 %
     epoch 5, minibatch 500/500, test error of best model 6.200000 %
epoch 6, minibatch 500/500, validation error 6.200000 %
     epoch 6, minibatch 500/500, test error of best model 5.800000 %
epoch 7, minibatch 500/500, validation error 6.000000 %
     epoch 7, minibatch 500/500, test error of best model 5.500000 %
epoch 8, minibatch 500/500, validation error 5.600000 %
     epoch 8, minibatch 500/500, test error of best model 5.300000 %
epoch 9, minibatch 500/500, validation error 5.500000 %
     epoch 9, minibatch 500/500, test error of best model 5.300000 %
epoch 10, minibatch 500/500, validation error 5.200000 %
     epoch 10, minibatch 500/500, test error of best model 5.200000 %
epoch 11, minibatch 500/500, validation error 5.200000 %
epoch 12, minibatch 500/500, validation error 5.700000 %
epoch 13, minibatch 500/500, validation error 5.700000 %
epoch 14, minibatch 500/500, validation error 5.700000 %
epoch 15, minibatch 500/500, validation error 5.600000 %
epoch 16, minibatch 500/500, validation error 5.600000 %
epoch 17, minibatch 500/500, validation error 5.600000 %
epoch 18, minibatch 500/500, validation error 5.700000 %
epoch 19, minibatch 500/500, validation error 5.700000 %
Optimization complete with best validation score of 5.200000 %, obtained at iteration 5000, with test performance 5.200000 %
The fine tuning code for file dbn_loop.pyc ran for 0.55m
