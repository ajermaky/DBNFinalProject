_______RUN: 0

==========Sample Size: (1000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -183.294465637
Pre-training layer 0, epoch 0, representative training free energy -591.15681604
Pre-training layer 0, epoch 0, validation free energy -585.093156311
Pre-training layer 0, epoch 1, cost -135.548593674
Pre-training layer 0, epoch 2, cost -123.572870789
Pre-training layer 0, epoch 3, cost -117.239715118
Pre-training layer 0, epoch 4, cost -112.340062714
Pre-training layer 0, epoch 5, cost -108.751370468
Pre-training layer 0, epoch 5, representative training free energy -551.704519226
Pre-training layer 0, epoch 5, validation free energy -540.372630859
Pre-training layer 0, epoch 6, cost -105.840298386
Pre-training layer 0, epoch 7, cost -103.75621994
Pre-training layer 0, epoch 8, cost -101.608204193
Pre-training layer 0, epoch 9, cost -99.8131759644
Pre-training layer 0, epoch 10, cost -98.1350752258
Pre-training layer 0, epoch 10, representative training free energy -539.283068359
Pre-training layer 0, epoch 10, validation free energy -525.825598633
Pre-training layer 0, epoch 11, cost -96.7252108002
Pre-training layer 0, epoch 12, cost -95.983006134
Pre-training layer 0, epoch 13, cost -94.6420584869
Pre-training layer 0, epoch 14, cost -93.6273989868
Pre-training layer 0, epoch 15, cost -92.5961741638
Pre-training layer 0, epoch 15, representative training free energy -523.384526611
Pre-training layer 0, epoch 15, validation free energy -508.585185211
Pre-training layer 0, epoch 16, cost -91.9909427643
Pre-training layer 0, epoch 17, cost -91.1916960907
Pre-training layer 0, epoch 18, cost -90.0715761566
Pre-training layer 0, epoch 19, cost -89.8104351807
Pre-training layer 0, epoch 20, cost -89.0320809174
Pre-training layer 0, epoch 20, representative training free energy -513.45652121
Pre-training layer 0, epoch 20, validation free energy -498.937342926
Pre-training layer 0, epoch 21, cost -88.3093501282
Pre-training layer 0, epoch 22, cost -88.0409989929
Pre-training layer 0, epoch 23, cost -87.3399846649
Pre-training layer 0, epoch 24, cost -86.5859502411
Pre-training layer 0, epoch 25, cost -86.0976335907
Pre-training layer 0, epoch 25, representative training free energy -507.629197357
Pre-training layer 0, epoch 25, validation free energy -492.281501862
Pre-training layer 0, epoch 26, cost -85.862251358
Pre-training layer 0, epoch 27, cost -85.5957439423
Pre-training layer 0, epoch 28, cost -84.9483562469
Pre-training layer 0, epoch 29, cost -84.7342971039
Pre-training layer 0, epoch 30, cost -84.3397279358
Pre-training layer 0, epoch 30, representative training free energy -504.683580719
Pre-training layer 0, epoch 30, validation free energy -489.304388763
Pre-training layer 0, epoch 31, cost -83.9688063812
Pre-training layer 0, epoch 32, cost -83.6076805115
Pre-training layer 0, epoch 33, cost -83.0859212494
Pre-training layer 0, epoch 34, cost -83.181601944
Pre-training layer 0, epoch 35, cost -82.7738764954
Pre-training layer 0, epoch 35, representative training free energy -494.862537415
Pre-training layer 0, epoch 35, validation free energy -478.540001678
Pre-training layer 0, epoch 36, cost -82.5927878571
Pre-training layer 0, epoch 37, cost -82.2733148193
Pre-training layer 0, epoch 38, cost -81.8958409882
Pre-training layer 0, epoch 39, cost -81.2265163422
Pre-training layer 0, epoch 40, cost -81.2216124725
Pre-training layer 0, epoch 40, representative training free energy -494.300906006
Pre-training layer 0, epoch 40, validation free energy -477.427458923
Pre-training layer 0, epoch 41, cost -81.0921664429
Pre-training layer 0, epoch 42, cost -80.8081304169
Pre-training layer 0, epoch 43, cost -80.424368515
Pre-training layer 0, epoch 44, cost -80.6022063446
Pre-training layer 0, epoch 45, cost -80.3186714935
Pre-training layer 0, epoch 45, representative training free energy -486.907764771
Pre-training layer 0, epoch 45, validation free energy -469.247960815
Pre-training layer 0, epoch 46, cost -79.9283296967
Pre-training layer 0, epoch 47, cost -79.7650961304
Pre-training layer 0, epoch 48, cost -79.537158165
Pre-training layer 0, epoch 49, cost -79.2577823639
Pre-training layer 0, epoch 50, cost -78.9689977646
Pre-training layer 0, epoch 50, representative training free energy -483.442022003
Pre-training layer 0, epoch 50, validation free energy -465.631901367
Pre-training layer 0, epoch 51, cost -79.0793318176
Pre-training layer 0, epoch 52, cost -78.5275350571
Pre-training layer 0, epoch 53, cost -78.7538368225
Pre-training layer 0, epoch 54, cost -78.3589726257
Pre-training layer 0, epoch 55, cost -78.3409942627
Pre-training layer 0, epoch 55, representative training free energy -484.070491608
Pre-training layer 0, epoch 55, validation free energy -466.153037689
Pre-training layer 0, epoch 56, cost -78.19936306
Pre-training layer 0, epoch 57, cost -77.8882673264
Pre-training layer 0, epoch 58, cost -77.8221066666
Pre-training layer 0, epoch 59, cost -77.5138929367
Pre-training layer 0, epoch 60, cost -77.4748159027
Pre-training layer 0, epoch 60, representative training free energy -481.248347626
Pre-training layer 0, epoch 60, validation free energy -463.662287048
Pre-training layer 0, epoch 61, cost -77.6070194244
Pre-training layer 0, epoch 62, cost -77.1064697266
Pre-training layer 0, epoch 63, cost -76.9968539429
Pre-training layer 0, epoch 64, cost -76.8690750885
Pre-training layer 0, epoch 65, cost -76.8500053406
Pre-training layer 0, epoch 65, representative training free energy -478.555258057
Pre-training layer 0, epoch 65, validation free energy -460.887737244
Pre-training layer 0, epoch 66, cost -76.67627491
Pre-training layer 0, epoch 67, cost -76.3846632004
Pre-training layer 0, epoch 68, cost -76.3715195084
Pre-training layer 0, epoch 69, cost -76.3435837555
Pre-training layer 0, epoch 70, cost -75.9671339417
Pre-training layer 0, epoch 70, representative training free energy -479.185478271
Pre-training layer 0, epoch 70, validation free energy -459.535897797
Pre-training layer 0, epoch 71, cost -76.0242131805
Pre-training layer 0, epoch 72, cost -75.8499479675
Pre-training layer 0, epoch 73, cost -75.8058516693
Pre-training layer 0, epoch 74, cost -75.5653503418
Pre-training layer 0, epoch 75, cost -75.5903662491
Pre-training layer 0, epoch 75, representative training free energy -480.906902954
Pre-training layer 0, epoch 75, validation free energy -461.570335815
Pre-training layer 0, epoch 76, cost -75.5202305603
Pre-training layer 0, epoch 77, cost -75.336924057
Pre-training layer 0, epoch 78, cost -75.2857286453
Pre-training layer 0, epoch 79, cost -75.0188185501
Pre-training layer 0, epoch 80, cost -74.891957283
Pre-training layer 0, epoch 80, representative training free energy -473.490329132
Pre-training layer 0, epoch 80, validation free energy -454.470503754
Pre-training layer 0, epoch 81, cost -74.719876976
Pre-training layer 0, epoch 82, cost -74.8446763229
Pre-training layer 0, epoch 83, cost -74.5148049545
Pre-training layer 0, epoch 84, cost -74.5685860062
Pre-training layer 0, epoch 85, cost -74.6108133698
Pre-training layer 0, epoch 85, representative training free energy -476.010088287
Pre-training layer 0, epoch 85, validation free energy -456.47984259
Pre-training layer 0, epoch 86, cost -74.5560086441
Pre-training layer 0, epoch 87, cost -74.2392995834
Pre-training layer 0, epoch 88, cost -74.3072944641
Pre-training layer 0, epoch 89, cost -74.075410614
Pre-training layer 0, epoch 90, cost -74.1044192505
Pre-training layer 0, epoch 90, representative training free energy -473.982856781
Pre-training layer 0, epoch 90, validation free energy -453.83431842
Pre-training layer 0, epoch 91, cost -73.9959072113
Pre-training layer 0, epoch 92, cost -73.8545776367
Pre-training layer 0, epoch 93, cost -73.8024755859
Pre-training layer 0, epoch 94, cost -73.760409584
Pre-training layer 0, epoch 95, cost -73.6435202026
Pre-training layer 0, epoch 95, representative training free energy -475.158135742
Pre-training layer 0, epoch 95, validation free energy -454.59105835
Pre-training layer 0, epoch 96, cost -73.5178866959
Pre-training layer 0, epoch 97, cost -73.4356640625
Pre-training layer 0, epoch 98, cost -73.3840695572
Pre-training layer 0, epoch 99, cost -73.1944166946
Pre-training layer 1, epoch 0, cost -432.583664856
Pre-training layer 1, epoch 0, representative training free energy -32740.6054033
Pre-training layer 1, epoch 0, validation free energy -32242.2415117
Pre-training layer 1, epoch 1, cost -370.438597412
Pre-training layer 1, epoch 2, cost -350.783014832
Pre-training layer 1, epoch 3, cost -339.014055786
Pre-training layer 1, epoch 4, cost -330.982660828
Pre-training layer 1, epoch 5, cost -324.693811646
Pre-training layer 1, epoch 5, representative training free energy -46939.833666
Pre-training layer 1, epoch 5, validation free energy -46360.3936045
Pre-training layer 1, epoch 6, cost -319.710154419
Pre-training layer 1, epoch 7, cost -315.581661682
Pre-training layer 1, epoch 8, cost -312.080926208
Pre-training layer 1, epoch 9, cost -309.111822815
Pre-training layer 1, epoch 10, cost -306.543333435
Pre-training layer 1, epoch 10, representative training free energy -51296.7576396
Pre-training layer 1, epoch 10, validation free energy -50711.1774238
Pre-training layer 1, epoch 11, cost -304.281347046
Pre-training layer 1, epoch 12, cost -302.349488525
Pre-training layer 1, epoch 13, cost -300.762135315
Pre-training layer 1, epoch 14, cost -298.8421875
Pre-training layer 1, epoch 15, cost -297.273948364
Pre-training layer 1, epoch 15, representative training free energy -53839.6521582
Pre-training layer 1, epoch 15, validation free energy -53244.9905977
Pre-training layer 1, epoch 16, cost -295.8502034
Pre-training layer 1, epoch 17, cost -294.826321716
Pre-training layer 1, epoch 18, cost -293.414830017
Pre-training layer 1, epoch 19, cost -292.366674957
Pre-training layer 1, epoch 20, cost -291.337272491
Pre-training layer 1, epoch 20, representative training free energy -55591.5234629
Pre-training layer 1, epoch 20, validation free energy -54988.2563125
Pre-training layer 1, epoch 21, cost -290.432646484
Pre-training layer 1, epoch 22, cost -289.679132385
Pre-training layer 1, epoch 23, cost -288.848398285
Pre-training layer 1, epoch 24, cost -288.100110016
Pre-training layer 1, epoch 25, cost -287.352861481
Pre-training layer 1, epoch 25, representative training free energy -56957.4992842
Pre-training layer 1, epoch 25, validation free energy -56362.3750625
Pre-training layer 1, epoch 26, cost -286.513388824
Pre-training layer 1, epoch 27, cost -286.048887939
Pre-training layer 1, epoch 28, cost -285.388572235
Pre-training layer 1, epoch 29, cost -284.761614838
Pre-training layer 1, epoch 30, cost -284.231249847
Pre-training layer 1, epoch 30, representative training free energy -58013.3819414
Pre-training layer 1, epoch 30, validation free energy -57404.0598477
Pre-training layer 1, epoch 31, cost -283.763023987
Pre-training layer 1, epoch 32, cost -283.112131653
Pre-training layer 1, epoch 33, cost -282.611553345
Pre-training layer 1, epoch 34, cost -282.170011749
Pre-training layer 1, epoch 35, cost -281.616307983
Pre-training layer 1, epoch 35, representative training free energy -58963.9653516
Pre-training layer 1, epoch 35, validation free energy -58359.1552949
Pre-training layer 1, epoch 36, cost -281.223291473
Pre-training layer 1, epoch 37, cost -280.644262238
Pre-training layer 1, epoch 38, cost -280.502343445
Pre-training layer 1, epoch 39, cost -280.259787598
Pre-training layer 1, epoch 40, cost -279.778415375
Pre-training layer 1, epoch 40, representative training free energy -59727.6221719
Pre-training layer 1, epoch 40, validation free energy -59108.1162559
Pre-training layer 1, epoch 41, cost -279.315426331
Pre-training layer 1, epoch 42, cost -279.037398376
Pre-training layer 1, epoch 43, cost -278.772268982
Pre-training layer 1, epoch 44, cost -278.26785675
Pre-training layer 1, epoch 45, cost -278.062873383
Pre-training layer 1, epoch 45, representative training free energy -60423.5337979
Pre-training layer 1, epoch 45, validation free energy -59805.0532031
Pre-training layer 1, epoch 46, cost -277.560789032
Pre-training layer 1, epoch 47, cost -277.350826111
Pre-training layer 1, epoch 48, cost -277.142989655
Pre-training layer 1, epoch 49, cost -276.713169098
Pre-training layer 1, epoch 50, cost -276.694682617
Pre-training layer 1, epoch 50, representative training free energy -60974.8744287
Pre-training layer 1, epoch 50, validation free energy -60360.2602051
Pre-training layer 1, epoch 51, cost -276.476960297
Pre-training layer 1, epoch 52, cost -275.90395752
Pre-training layer 1, epoch 53, cost -275.766363983
Pre-training layer 1, epoch 54, cost -275.678635254
Pre-training layer 1, epoch 55, cost -275.350467834
Pre-training layer 1, epoch 55, representative training free energy -61582.5354668
Pre-training layer 1, epoch 55, validation free energy -60957.7858906
Pre-training layer 1, epoch 56, cost -275.271995697
Pre-training layer 1, epoch 57, cost -274.905109253
Pre-training layer 1, epoch 58, cost -274.802581482
Pre-training layer 1, epoch 59, cost -274.531135254
Pre-training layer 1, epoch 60, cost -274.388552246
Pre-training layer 1, epoch 60, representative training free energy -62023.4179277
Pre-training layer 1, epoch 60, validation free energy -61404.4103945
Pre-training layer 1, epoch 61, cost -274.431852722
Pre-training layer 1, epoch 62, cost -273.929338837
Pre-training layer 1, epoch 63, cost -273.894546051
Pre-training layer 1, epoch 64, cost -273.730830688
Pre-training layer 1, epoch 65, cost -273.247201233
Pre-training layer 1, epoch 65, representative training free energy -62481.5257676
Pre-training layer 1, epoch 65, validation free energy -61857.3314219
Pre-training layer 1, epoch 66, cost -273.093194122
Pre-training layer 1, epoch 67, cost -273.163191986
Pre-training layer 1, epoch 68, cost -272.998748932
Pre-training layer 1, epoch 69, cost -272.738014679
Pre-training layer 1, epoch 70, cost -272.673174896
Pre-training layer 1, epoch 70, representative training free energy -62933.1743633
Pre-training layer 1, epoch 70, validation free energy -62311.5186152
Pre-training layer 1, epoch 71, cost -272.523901672
Pre-training layer 1, epoch 72, cost -272.429284821
Pre-training layer 1, epoch 73, cost -272.313379517
Pre-training layer 1, epoch 74, cost -272.064663086
Pre-training layer 1, epoch 75, cost -271.985643005
Pre-training layer 1, epoch 75, representative training free energy -63423.4503242
Pre-training layer 1, epoch 75, validation free energy -62789.8602363
Pre-training layer 1, epoch 76, cost -271.65497467
Pre-training layer 1, epoch 77, cost -271.641186371
Pre-training layer 1, epoch 78, cost -271.56292923
Pre-training layer 1, epoch 79, cost -271.427991638
Pre-training layer 1, epoch 80, cost -271.027590485
Pre-training layer 1, epoch 80, representative training free energy -63784.6197617
Pre-training layer 1, epoch 80, validation free energy -63141.4425273
Pre-training layer 1, epoch 81, cost -271.032447815
Pre-training layer 1, epoch 82, cost -270.977351685
Pre-training layer 1, epoch 83, cost -271.028626404
Pre-training layer 1, epoch 84, cost -270.985432281
Pre-training layer 1, epoch 85, cost -270.655106049
Pre-training layer 1, epoch 85, representative training free energy -64161.6114238
Pre-training layer 1, epoch 85, validation free energy -63522.2080352
Pre-training layer 1, epoch 86, cost -270.591491852
Pre-training layer 1, epoch 87, cost -270.290392456
Pre-training layer 1, epoch 88, cost -270.437577667
Pre-training layer 1, epoch 89, cost -270.215452271
Pre-training layer 1, epoch 90, cost -270.13926239
Pre-training layer 1, epoch 90, representative training free energy -64474.9758809
Pre-training layer 1, epoch 90, validation free energy -63825.1665098
Pre-training layer 1, epoch 91, cost -270.035539398
Pre-training layer 1, epoch 92, cost -269.951918488
Pre-training layer 1, epoch 93, cost -269.887971954
Pre-training layer 1, epoch 94, cost -269.923342285
Pre-training layer 1, epoch 95, cost -269.792033081
Pre-training layer 1, epoch 95, representative training free energy -64837.8220527
Pre-training layer 1, epoch 95, validation free energy -64195.3355039
Pre-training layer 1, epoch 96, cost -269.495717773
Pre-training layer 1, epoch 97, cost -269.474625549
Pre-training layer 1, epoch 98, cost -269.441460419
Pre-training layer 1, epoch 99, cost -269.530800476
Pre-training layer 2, epoch 0, cost -162.068306656
Pre-training layer 2, epoch 0, representative training free energy 1644.57564023
Pre-training layer 2, epoch 0, validation free energy 1655.14428589
Pre-training layer 2, epoch 1, cost -108.128820572
Pre-training layer 2, epoch 2, cost -97.6539161682
Pre-training layer 2, epoch 3, cost -92.0527479553
Pre-training layer 2, epoch 4, cost -88.2342482758
Pre-training layer 2, epoch 5, cost -85.3267709351
Pre-training layer 2, epoch 5, representative training free energy 2583.25592694
Pre-training layer 2, epoch 5, validation free energy 2585.90510907
Pre-training layer 2, epoch 6, cost -83.0348959351
Pre-training layer 2, epoch 7, cost -81.1854510498
Pre-training layer 2, epoch 8, cost -79.8140016174
Pre-training layer 2, epoch 9, cost -78.562670784
Pre-training layer 2, epoch 10, cost -77.6776741409
Pre-training layer 2, epoch 10, representative training free energy 3034.66707812
Pre-training layer 2, epoch 10, validation free energy 3026.81742487
Pre-training layer 2, epoch 11, cost -76.5646582794
Pre-training layer 2, epoch 12, cost -75.7171015549
Pre-training layer 2, epoch 13, cost -74.971202774
Pre-training layer 2, epoch 14, cost -74.2364286423
Pre-training layer 2, epoch 15, cost -73.6795780945
Pre-training layer 2, epoch 15, representative training free energy 3386.22983051
Pre-training layer 2, epoch 15, validation free energy 3365.06331183
Pre-training layer 2, epoch 16, cost -73.0198627853
Pre-training layer 2, epoch 17, cost -72.4496363831
Pre-training layer 2, epoch 18, cost -72.0743106079
Pre-training layer 2, epoch 19, cost -71.5244128799
Pre-training layer 2, epoch 20, cost -71.347294426
Pre-training layer 2, epoch 20, representative training free energy 3609.56620221
Pre-training layer 2, epoch 20, validation free energy 3586.48043799
Pre-training layer 2, epoch 21, cost -70.9683543396
Pre-training layer 2, epoch 22, cost -70.6326609039
Pre-training layer 2, epoch 23, cost -70.2966172028
Pre-training layer 2, epoch 24, cost -69.9739508438
Pre-training layer 2, epoch 25, cost -69.64114254
Pre-training layer 2, epoch 25, representative training free energy 3835.55354114
Pre-training layer 2, epoch 25, validation free energy 3804.28313025
Pre-training layer 2, epoch 26, cost -69.0654494858
Pre-training layer 2, epoch 27, cost -68.8890667343
Pre-training layer 2, epoch 28, cost -69.0017901611
Pre-training layer 2, epoch 29, cost -68.5280668259
Pre-training layer 2, epoch 30, cost -68.2851958084
Pre-training layer 2, epoch 30, representative training free energy 4059.95452295
Pre-training layer 2, epoch 30, validation free energy 4022.66895959
Pre-training layer 2, epoch 31, cost -68.0590457535
Pre-training layer 2, epoch 32, cost -67.9938386917
Pre-training layer 2, epoch 33, cost -67.6842177582
Pre-training layer 2, epoch 34, cost -67.3577360535
Pre-training layer 2, epoch 35, cost -67.1516113663
Pre-training layer 2, epoch 35, representative training free energy 4254.29107129
Pre-training layer 2, epoch 35, validation free energy 4210.0462406
Pre-training layer 2, epoch 36, cost -66.8920706558
Pre-training layer 2, epoch 37, cost -66.7300295639
Pre-training layer 2, epoch 38, cost -66.7529494858
Pre-training layer 2, epoch 39, cost -66.5963923264
Pre-training layer 2, epoch 40, cost -66.441202507
Pre-training layer 2, epoch 40, representative training free energy 4419.60499084
Pre-training layer 2, epoch 40, validation free energy 4372.12676367
Pre-training layer 2, epoch 41, cost -66.2745428848
Pre-training layer 2, epoch 42, cost -66.089913063
Pre-training layer 2, epoch 43, cost -66.1902256012
Pre-training layer 2, epoch 44, cost -65.7711911011
Pre-training layer 2, epoch 45, cost -65.7799150085
Pre-training layer 2, epoch 45, representative training free energy 4584.88399292
Pre-training layer 2, epoch 45, validation free energy 4532.67662451
Pre-training layer 2, epoch 46, cost -65.663460083
Pre-training layer 2, epoch 47, cost -65.7153057098
Pre-training layer 2, epoch 48, cost -65.3964757919
Pre-training layer 2, epoch 49, cost -65.3047282028
Pre-training layer 2, epoch 50, cost -65.1580528259
Pre-training layer 2, epoch 50, representative training free energy 4724.96697168
Pre-training layer 2, epoch 50, validation free energy 4666.42115442
Pre-training layer 2, epoch 51, cost -65.0610866165
Pre-training layer 2, epoch 52, cost -64.9679098892
Pre-training layer 2, epoch 53, cost -64.9979194641
Pre-training layer 2, epoch 54, cost -65.0034154129
Pre-training layer 2, epoch 55, cost -64.7365613556
Pre-training layer 2, epoch 55, representative training free energy 4862.67784766
Pre-training layer 2, epoch 55, validation free energy 4802.23959058
Pre-training layer 2, epoch 56, cost -64.7540674591
Pre-training layer 2, epoch 57, cost -64.7730278015
Pre-training layer 2, epoch 58, cost -64.5742700195
Pre-training layer 2, epoch 59, cost -64.3765324402
Pre-training layer 2, epoch 60, cost -64.2203659058
Pre-training layer 2, epoch 60, representative training free energy 4992.41376501
Pre-training layer 2, epoch 60, validation free energy 4931.95821533
Pre-training layer 2, epoch 61, cost -64.3329121017
Pre-training layer 2, epoch 62, cost -64.169987793
Pre-training layer 2, epoch 63, cost -64.0594106674
Pre-training layer 2, epoch 64, cost -64.0913251877
Pre-training layer 2, epoch 65, cost -63.9235912323
Pre-training layer 2, epoch 65, representative training free energy 5106.33883044
Pre-training layer 2, epoch 65, validation free energy 5043.06421411
Pre-training layer 2, epoch 66, cost -63.8379176712
Pre-training layer 2, epoch 67, cost -63.8454376221
Pre-training layer 2, epoch 68, cost -63.6328992081
Pre-training layer 2, epoch 69, cost -63.555153923
Pre-training layer 2, epoch 70, cost -63.6099546051
Pre-training layer 2, epoch 70, representative training free energy 5220.66337915
Pre-training layer 2, epoch 70, validation free energy 5153.46124377
Pre-training layer 2, epoch 71, cost -63.6155857468
Pre-training layer 2, epoch 72, cost -63.6104019165
Pre-training layer 2, epoch 73, cost -63.4003291321
Pre-training layer 2, epoch 74, cost -63.3473213577
Pre-training layer 2, epoch 75, cost -63.3676839447
Pre-training layer 2, epoch 75, representative training free energy 5328.51716455
Pre-training layer 2, epoch 75, validation free energy 5259.94487537
Pre-training layer 2, epoch 76, cost -63.1898415375
Pre-training layer 2, epoch 77, cost -63.1481793594
Pre-training layer 2, epoch 78, cost -63.1774718857
Pre-training layer 2, epoch 79, cost -63.0588206863
Pre-training layer 2, epoch 80, cost -63.0888304901
Pre-training layer 2, epoch 80, representative training free energy 5438.63351343
Pre-training layer 2, epoch 80, validation free energy 5365.92787585
Pre-training layer 2, epoch 81, cost -63.1481653595
Pre-training layer 2, epoch 82, cost -63.1048115921
Pre-training layer 2, epoch 83, cost -63.0061296082
Pre-training layer 2, epoch 84, cost -62.8116047287
Pre-training layer 2, epoch 85, cost -62.9733868408
Pre-training layer 2, epoch 85, representative training free energy 5547.36249792
Pre-training layer 2, epoch 85, validation free energy 5474.52287256
Pre-training layer 2, epoch 86, cost -62.7152925873
Pre-training layer 2, epoch 87, cost -62.857025528
Pre-training layer 2, epoch 88, cost -62.7380921936
Pre-training layer 2, epoch 89, cost -62.6926640701
Pre-training layer 2, epoch 90, cost -62.6106501389
Pre-training layer 2, epoch 90, representative training free energy 5638.92340442
Pre-training layer 2, epoch 90, validation free energy 5561.67874268
Pre-training layer 2, epoch 91, cost -62.7513168335
Pre-training layer 2, epoch 92, cost -62.490234375
Pre-training layer 2, epoch 93, cost -62.6818227005
Pre-training layer 2, epoch 94, cost -62.4195717621
Pre-training layer 2, epoch 95, cost -62.5261766434
Pre-training layer 2, epoch 95, representative training free energy 5732.42272229
Pre-training layer 2, epoch 95, validation free energy 5656.24854041
Pre-training layer 2, epoch 96, cost -62.3287667465
Pre-training layer 2, epoch 97, cost -62.4433759689
Pre-training layer 2, epoch 98, cost -62.3172029114
Pre-training layer 2, epoch 99, cost -62.3090958023
The pretraining code for file dbn_loop.pyc ran for 1.05m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 23.900000 %
     epoch 1, minibatch 100/100, test error of best model 25.500000 %
epoch 2, minibatch 100/100, validation error 19.000000 %
     epoch 2, minibatch 100/100, test error of best model 19.400000 %
epoch 3, minibatch 100/100, validation error 17.800000 %
     epoch 3, minibatch 100/100, test error of best model 17.100000 %
epoch 4, minibatch 100/100, validation error 16.900000 %
     epoch 4, minibatch 100/100, test error of best model 16.400000 %
epoch 5, minibatch 100/100, validation error 16.500000 %
     epoch 5, minibatch 100/100, test error of best model 15.700000 %
epoch 6, minibatch 100/100, validation error 15.100000 %
     epoch 6, minibatch 100/100, test error of best model 14.800000 %
epoch 7, minibatch 100/100, validation error 14.600000 %
     epoch 7, minibatch 100/100, test error of best model 14.500000 %
epoch 8, minibatch 100/100, validation error 14.200000 %
     epoch 8, minibatch 100/100, test error of best model 14.000000 %
epoch 9, minibatch 100/100, validation error 13.700000 %
     epoch 9, minibatch 100/100, test error of best model 14.200000 %
epoch 10, minibatch 100/100, validation error 13.600000 %
     epoch 10, minibatch 100/100, test error of best model 14.100000 %
epoch 11, minibatch 100/100, validation error 13.500000 %
     epoch 11, minibatch 100/100, test error of best model 13.800000 %
epoch 12, minibatch 100/100, validation error 13.300000 %
     epoch 12, minibatch 100/100, test error of best model 13.300000 %
epoch 13, minibatch 100/100, validation error 12.900000 %
     epoch 13, minibatch 100/100, test error of best model 12.900000 %
epoch 14, minibatch 100/100, validation error 12.800000 %
     epoch 14, minibatch 100/100, test error of best model 12.800000 %
epoch 15, minibatch 100/100, validation error 12.300000 %
     epoch 15, minibatch 100/100, test error of best model 12.700000 %
epoch 16, minibatch 100/100, validation error 11.900000 %
     epoch 16, minibatch 100/100, test error of best model 12.700000 %
epoch 17, minibatch 100/100, validation error 11.800000 %
     epoch 17, minibatch 100/100, test error of best model 12.700000 %
epoch 18, minibatch 100/100, validation error 11.500000 %
     epoch 18, minibatch 100/100, test error of best model 12.600000 %
epoch 19, minibatch 100/100, validation error 11.200000 %
     epoch 19, minibatch 100/100, test error of best model 12.400000 %
epoch 20, minibatch 100/100, validation error 11.200000 %
epoch 21, minibatch 100/100, validation error 11.100000 %
     epoch 21, minibatch 100/100, test error of best model 12.300000 %
epoch 22, minibatch 100/100, validation error 11.300000 %
epoch 23, minibatch 100/100, validation error 11.000000 %
     epoch 23, minibatch 100/100, test error of best model 12.400000 %
epoch 24, minibatch 100/100, validation error 10.800000 %
     epoch 24, minibatch 100/100, test error of best model 12.500000 %
epoch 25, minibatch 100/100, validation error 10.700000 %
     epoch 25, minibatch 100/100, test error of best model 12.200000 %
epoch 26, minibatch 100/100, validation error 10.700000 %
epoch 27, minibatch 100/100, validation error 10.700000 %
epoch 28, minibatch 100/100, validation error 10.500000 %
     epoch 28, minibatch 100/100, test error of best model 12.100000 %
epoch 29, minibatch 100/100, validation error 10.200000 %
     epoch 29, minibatch 100/100, test error of best model 12.100000 %
epoch 30, minibatch 100/100, validation error 10.100000 %
     epoch 30, minibatch 100/100, test error of best model 11.900000 %
epoch 31, minibatch 100/100, validation error 10.100000 %
epoch 32, minibatch 100/100, validation error 9.900000 %
     epoch 32, minibatch 100/100, test error of best model 12.000000 %
epoch 33, minibatch 100/100, validation error 9.900000 %
epoch 34, minibatch 100/100, validation error 9.800000 %
     epoch 34, minibatch 100/100, test error of best model 12.000000 %
epoch 35, minibatch 100/100, validation error 9.800000 %
epoch 36, minibatch 100/100, validation error 9.800000 %
epoch 37, minibatch 100/100, validation error 9.700000 %
     epoch 37, minibatch 100/100, test error of best model 11.900000 %
epoch 38, minibatch 100/100, validation error 9.900000 %
epoch 39, minibatch 100/100, validation error 10.000000 %
epoch 40, minibatch 100/100, validation error 10.000000 %
epoch 41, minibatch 100/100, validation error 10.000000 %
epoch 42, minibatch 100/100, validation error 10.000000 %
epoch 43, minibatch 100/100, validation error 10.000000 %
epoch 44, minibatch 100/100, validation error 10.000000 %
epoch 45, minibatch 100/100, validation error 10.000000 %
epoch 46, minibatch 100/100, validation error 10.000000 %
epoch 47, minibatch 100/100, validation error 10.000000 %
epoch 48, minibatch 100/100, validation error 10.000000 %
epoch 49, minibatch 100/100, validation error 10.000000 %
epoch 50, minibatch 100/100, validation error 10.000000 %
epoch 51, minibatch 100/100, validation error 10.000000 %
epoch 52, minibatch 100/100, validation error 10.000000 %
epoch 53, minibatch 100/100, validation error 10.000000 %
epoch 54, minibatch 100/100, validation error 10.000000 %
epoch 55, minibatch 100/100, validation error 9.900000 %
epoch 56, minibatch 100/100, validation error 9.900000 %
epoch 57, minibatch 100/100, validation error 9.900000 %
epoch 58, minibatch 100/100, validation error 9.900000 %
epoch 59, minibatch 100/100, validation error 9.900000 %
epoch 60, minibatch 100/100, validation error 9.900000 %
epoch 61, minibatch 100/100, validation error 9.900000 %
epoch 62, minibatch 100/100, validation error 9.900000 %
epoch 63, minibatch 100/100, validation error 9.900000 %
epoch 64, minibatch 100/100, validation error 9.900000 %
epoch 65, minibatch 100/100, validation error 9.900000 %
epoch 66, minibatch 100/100, validation error 9.900000 %
epoch 67, minibatch 100/100, validation error 9.900000 %
epoch 68, minibatch 100/100, validation error 9.900000 %
epoch 69, minibatch 100/100, validation error 9.900000 %
epoch 70, minibatch 100/100, validation error 9.900000 %
epoch 71, minibatch 100/100, validation error 9.900000 %
epoch 72, minibatch 100/100, validation error 9.900000 %
epoch 73, minibatch 100/100, validation error 10.000000 %
Optimization complete with best validation score of 9.700000 %, obtained at iteration 3700, with test performance 11.900000 %
The fine tuning code for file dbn_loop.pyc ran for 0.41m


==========Sample Size: (2000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -159.939585152
Pre-training layer 0, epoch 0, representative training free energy -589.647486298
Pre-training layer 0, epoch 0, validation free energy -589.102871307
Pre-training layer 0, epoch 1, cost -122.070827599
Pre-training layer 0, epoch 2, cost -112.475079346
Pre-training layer 0, epoch 3, cost -107.316098633
Pre-training layer 0, epoch 4, cost -103.288212509
Pre-training layer 0, epoch 5, cost -100.185480461
Pre-training layer 0, epoch 5, representative training free energy -532.485099609
Pre-training layer 0, epoch 5, validation free energy -526.054832367
Pre-training layer 0, epoch 6, cost -97.6743708038
Pre-training layer 0, epoch 7, cost -95.8238791275
Pre-training layer 0, epoch 8, cost -94.2874497604
Pre-training layer 0, epoch 9, cost -92.7606879425
Pre-training layer 0, epoch 10, cost -91.6205018616
Pre-training layer 0, epoch 10, representative training free energy -514.140265564
Pre-training layer 0, epoch 10, validation free energy -506.696246429
Pre-training layer 0, epoch 11, cost -90.5572958374
Pre-training layer 0, epoch 12, cost -89.4826181793
Pre-training layer 0, epoch 13, cost -88.6229102707
Pre-training layer 0, epoch 14, cost -87.9623794937
Pre-training layer 0, epoch 15, cost -87.4180169678
Pre-training layer 0, epoch 15, representative training free energy -495.997779083
Pre-training layer 0, epoch 15, validation free energy -488.580567078
Pre-training layer 0, epoch 16, cost -86.5651359558
Pre-training layer 0, epoch 17, cost -86.1785430908
Pre-training layer 0, epoch 18, cost -85.3975084686
Pre-training layer 0, epoch 19, cost -84.911698761
Pre-training layer 0, epoch 20, cost -84.48707798
Pre-training layer 0, epoch 20, representative training free energy -486.082735779
Pre-training layer 0, epoch 20, validation free energy -478.070986847
Pre-training layer 0, epoch 21, cost -83.9585681534
Pre-training layer 0, epoch 22, cost -83.616518631
Pre-training layer 0, epoch 23, cost -83.3099022102
Pre-training layer 0, epoch 24, cost -82.9070791245
Pre-training layer 0, epoch 25, cost -82.3737966919
Pre-training layer 0, epoch 25, representative training free energy -482.45443399
Pre-training layer 0, epoch 25, validation free energy -473.082775482
Pre-training layer 0, epoch 26, cost -82.1966484833
Pre-training layer 0, epoch 27, cost -82.0626682663
Pre-training layer 0, epoch 28, cost -81.549446106
Pre-training layer 0, epoch 29, cost -81.139699688
Pre-training layer 0, epoch 30, cost -81.0981249619
Pre-training layer 0, epoch 30, representative training free energy -478.11051712
Pre-training layer 0, epoch 30, validation free energy -468.469918579
Pre-training layer 0, epoch 31, cost -80.7544026184
Pre-training layer 0, epoch 32, cost -80.4987696838
Pre-training layer 0, epoch 33, cost -80.2553292274
Pre-training layer 0, epoch 34, cost -79.7227890015
Pre-training layer 0, epoch 35, cost -79.7865787315
Pre-training layer 0, epoch 35, representative training free energy -473.178259155
Pre-training layer 0, epoch 35, validation free energy -463.176516998
Pre-training layer 0, epoch 36, cost -79.5154872704
Pre-training layer 0, epoch 37, cost -79.4407801056
Pre-training layer 0, epoch 38, cost -79.1079116631
Pre-training layer 0, epoch 39, cost -79.026595192
Pre-training layer 0, epoch 40, cost -78.8205283165
Pre-training layer 0, epoch 40, representative training free energy -468.596799042
Pre-training layer 0, epoch 40, validation free energy -458.600401398
Pre-training layer 0, epoch 41, cost -78.4859448242
Pre-training layer 0, epoch 42, cost -78.3359305573
Pre-training layer 0, epoch 43, cost -78.3760369492
Pre-training layer 0, epoch 44, cost -78.0675924492
Pre-training layer 0, epoch 45, cost -77.8765406036
Pre-training layer 0, epoch 45, representative training free energy -466.397860779
Pre-training layer 0, epoch 45, validation free energy -455.480218018
Pre-training layer 0, epoch 46, cost -77.7299797249
Pre-training layer 0, epoch 47, cost -77.6608837509
Pre-training layer 0, epoch 48, cost -77.5934373856
Pre-training layer 0, epoch 49, cost -77.1985302162
Pre-training layer 0, epoch 50, cost -77.0761344147
Pre-training layer 0, epoch 50, representative training free energy -462.31448587
Pre-training layer 0, epoch 50, validation free energy -451.384842072
Pre-training layer 0, epoch 51, cost -76.9725442696
Pre-training layer 0, epoch 52, cost -76.8867847824
Pre-training layer 0, epoch 53, cost -76.8279016685
Pre-training layer 0, epoch 54, cost -76.5175390053
Pre-training layer 0, epoch 55, cost -76.5607941246
Pre-training layer 0, epoch 55, representative training free energy -462.764952972
Pre-training layer 0, epoch 55, validation free energy -451.12405484
Pre-training layer 0, epoch 56, cost -76.3685004425
Pre-training layer 0, epoch 57, cost -76.3011644745
Pre-training layer 0, epoch 58, cost -76.1385520744
Pre-training layer 0, epoch 59, cost -75.9223860931
Pre-training layer 0, epoch 60, cost -76.0112701035
Pre-training layer 0, epoch 60, representative training free energy -462.367845154
Pre-training layer 0, epoch 60, validation free energy -451.175759003
Pre-training layer 0, epoch 61, cost -75.6689241791
Pre-training layer 0, epoch 62, cost -75.6834212303
Pre-training layer 0, epoch 63, cost -75.5039198685
Pre-training layer 0, epoch 64, cost -75.4872148705
Pre-training layer 0, epoch 65, cost -75.3264328384
Pre-training layer 0, epoch 65, representative training free energy -460.820350983
Pre-training layer 0, epoch 65, validation free energy -449.143300385
Pre-training layer 0, epoch 66, cost -75.2621207428
Pre-training layer 0, epoch 67, cost -75.1030101967
Pre-training layer 0, epoch 68, cost -74.9999950409
Pre-training layer 0, epoch 69, cost -75.0186999321
Pre-training layer 0, epoch 70, cost -74.9030105591
Pre-training layer 0, epoch 70, representative training free energy -459.527954498
Pre-training layer 0, epoch 70, validation free energy -447.399472229
Pre-training layer 0, epoch 71, cost -74.7751302719
Pre-training layer 0, epoch 72, cost -74.68835289
Pre-training layer 0, epoch 73, cost -74.574723568
Pre-training layer 0, epoch 74, cost -74.4349111176
Pre-training layer 0, epoch 75, cost -74.5456473541
Pre-training layer 0, epoch 75, representative training free energy -458.340588104
Pre-training layer 0, epoch 75, validation free energy -445.409975769
Pre-training layer 0, epoch 76, cost -74.3852217674
Pre-training layer 0, epoch 77, cost -74.2852938843
Pre-training layer 0, epoch 78, cost -74.1326665115
Pre-training layer 0, epoch 79, cost -74.3349847984
Pre-training layer 0, epoch 80, cost -74.0340763855
Pre-training layer 0, epoch 80, representative training free energy -454.730903656
Pre-training layer 0, epoch 80, validation free energy -442.90619278
Pre-training layer 0, epoch 81, cost -73.7142093086
Pre-training layer 0, epoch 82, cost -73.9009312248
Pre-training layer 0, epoch 83, cost -73.8416615486
Pre-training layer 0, epoch 84, cost -73.8518668365
Pre-training layer 0, epoch 85, cost -73.6031033897
Pre-training layer 0, epoch 85, representative training free energy -457.793639587
Pre-training layer 0, epoch 85, validation free energy -445.027712585
Pre-training layer 0, epoch 86, cost -73.5236235619
Pre-training layer 0, epoch 87, cost -73.5652988625
Pre-training layer 0, epoch 88, cost -73.6220030594
Pre-training layer 0, epoch 89, cost -73.4620328903
Pre-training layer 0, epoch 90, cost -73.3931546783
Pre-training layer 0, epoch 90, representative training free energy -457.559542023
Pre-training layer 0, epoch 90, validation free energy -445.165914948
Pre-training layer 0, epoch 91, cost -73.3570603752
Pre-training layer 0, epoch 92, cost -73.2322289848
Pre-training layer 0, epoch 93, cost -73.0665135956
Pre-training layer 0, epoch 94, cost -73.0017674828
Pre-training layer 0, epoch 95, cost -73.047059021
Pre-training layer 0, epoch 95, representative training free energy -455.388272095
Pre-training layer 0, epoch 95, validation free energy -442.144912567
Pre-training layer 0, epoch 96, cost -73.1934213638
Pre-training layer 0, epoch 97, cost -73.0157726479
Pre-training layer 0, epoch 98, cost -72.7209761429
Pre-training layer 0, epoch 99, cost -72.9778497887
Pre-training layer 1, epoch 0, cost -376.526734543
Pre-training layer 1, epoch 0, representative training free energy -42621.427666
Pre-training layer 1, epoch 0, validation free energy -42201.4018711
Pre-training layer 1, epoch 1, cost -323.242960968
Pre-training layer 1, epoch 2, cost -307.167305145
Pre-training layer 1, epoch 3, cost -297.367794495
Pre-training layer 1, epoch 4, cost -290.699959564
Pre-training layer 1, epoch 5, cost -285.424932404
Pre-training layer 1, epoch 5, representative training free energy -58309.113498
Pre-training layer 1, epoch 5, validation free energy -57689.3765879
Pre-training layer 1, epoch 6, cost -281.179176559
Pre-training layer 1, epoch 7, cost -278.000469818
Pre-training layer 1, epoch 8, cost -275.271317673
Pre-training layer 1, epoch 9, cost -273.094408188
Pre-training layer 1, epoch 10, cost -270.700839615
Pre-training layer 1, epoch 10, representative training free energy -63133.618291
Pre-training layer 1, epoch 10, validation free energy -62467.2206777
Pre-training layer 1, epoch 11, cost -268.972184143
Pre-training layer 1, epoch 12, cost -267.270836868
Pre-training layer 1, epoch 13, cost -265.849355698
Pre-training layer 1, epoch 14, cost -264.568549576
Pre-training layer 1, epoch 15, cost -263.478745117
Pre-training layer 1, epoch 15, representative training free energy -65993.8266309
Pre-training layer 1, epoch 15, validation free energy -65295.105791
Pre-training layer 1, epoch 16, cost -262.347157364
Pre-training layer 1, epoch 17, cost -261.556310349
Pre-training layer 1, epoch 18, cost -260.581494751
Pre-training layer 1, epoch 19, cost -259.863470459
Pre-training layer 1, epoch 20, cost -259.016243362
Pre-training layer 1, epoch 20, representative training free energy -67921.280002
Pre-training layer 1, epoch 20, validation free energy -67203.9543809
Pre-training layer 1, epoch 21, cost -258.282651367
Pre-training layer 1, epoch 22, cost -257.601277618
Pre-training layer 1, epoch 23, cost -257.02270546
Pre-training layer 1, epoch 24, cost -256.361158752
Pre-training layer 1, epoch 25, cost -256.049178391
Pre-training layer 1, epoch 25, representative training free energy -69448.7974805
Pre-training layer 1, epoch 25, validation free energy -68722.2293574
Pre-training layer 1, epoch 26, cost -255.5540522
Pre-training layer 1, epoch 27, cost -255.094149399
Pre-training layer 1, epoch 28, cost -254.538549652
Pre-training layer 1, epoch 29, cost -254.107649002
Pre-training layer 1, epoch 30, cost -253.663881836
Pre-training layer 1, epoch 30, representative training free energy -70729.4374238
Pre-training layer 1, epoch 30, validation free energy -69990.7373125
Pre-training layer 1, epoch 31, cost -253.532886276
Pre-training layer 1, epoch 32, cost -253.003375473
Pre-training layer 1, epoch 33, cost -252.685556259
Pre-training layer 1, epoch 34, cost -252.250734253
Pre-training layer 1, epoch 35, cost -252.001087418
Pre-training layer 1, epoch 35, representative training free energy -71664.007623
Pre-training layer 1, epoch 35, validation free energy -70920.1458555
Pre-training layer 1, epoch 36, cost -251.770264893
Pre-training layer 1, epoch 37, cost -251.505538635
Pre-training layer 1, epoch 38, cost -251.196293564
Pre-training layer 1, epoch 39, cost -250.910585861
Pre-training layer 1, epoch 40, cost -250.685299072
Pre-training layer 1, epoch 40, representative training free energy -72576.7149336
Pre-training layer 1, epoch 40, validation free energy -71822.8349766
Pre-training layer 1, epoch 41, cost -250.390697479
Pre-training layer 1, epoch 42, cost -250.235649414
Pre-training layer 1, epoch 43, cost -250.045366287
Pre-training layer 1, epoch 44, cost -249.777498398
Pre-training layer 1, epoch 45, cost -249.560570602
Pre-training layer 1, epoch 45, representative training free energy -73372.3140332
Pre-training layer 1, epoch 45, validation free energy -72599.2394023
Pre-training layer 1, epoch 46, cost -249.264121017
Pre-training layer 1, epoch 47, cost -249.101546707
Pre-training layer 1, epoch 48, cost -248.829213562
Pre-training layer 1, epoch 49, cost -248.726716461
Pre-training layer 1, epoch 50, cost -248.479348068
Pre-training layer 1, epoch 50, representative training free energy -74105.685457
Pre-training layer 1, epoch 50, validation free energy -73328.1616289
Pre-training layer 1, epoch 51, cost -248.34569809
Pre-training layer 1, epoch 52, cost -248.241625671
Pre-training layer 1, epoch 53, cost -248.04270401
Pre-training layer 1, epoch 54, cost -248.14371254
Pre-training layer 1, epoch 55, cost -247.672726593
Pre-training layer 1, epoch 55, representative training free energy -74749.2050781
Pre-training layer 1, epoch 55, validation free energy -73959.429957
Pre-training layer 1, epoch 56, cost -247.621813812
Pre-training layer 1, epoch 57, cost -247.445132523
Pre-training layer 1, epoch 58, cost -247.285029984
Pre-training layer 1, epoch 59, cost -247.147946472
Pre-training layer 1, epoch 60, cost -247.056009369
Pre-training layer 1, epoch 60, representative training free energy -75345.4877949
Pre-training layer 1, epoch 60, validation free energy -74556.4191211
Pre-training layer 1, epoch 61, cost -246.944999695
Pre-training layer 1, epoch 62, cost -246.793086243
Pre-training layer 1, epoch 63, cost -246.575148544
Pre-training layer 1, epoch 64, cost -246.581107864
Pre-training layer 1, epoch 65, cost -246.454850082
Pre-training layer 1, epoch 65, representative training free energy -75876.0270684
Pre-training layer 1, epoch 65, validation free energy -75070.3920625
Pre-training layer 1, epoch 66, cost -246.256425018
Pre-training layer 1, epoch 67, cost -246.330640106
Pre-training layer 1, epoch 68, cost -246.169604187
Pre-training layer 1, epoch 69, cost -246.038805008
Pre-training layer 1, epoch 70, cost -245.92961792
Pre-training layer 1, epoch 70, representative training free energy -76336.2576641
Pre-training layer 1, epoch 70, validation free energy -75536.2855898
Pre-training layer 1, epoch 71, cost -245.800918198
Pre-training layer 1, epoch 72, cost -245.602499924
Pre-training layer 1, epoch 73, cost -245.508401337
Pre-training layer 1, epoch 74, cost -245.579379349
Pre-training layer 1, epoch 75, cost -245.299957657
Pre-training layer 1, epoch 75, representative training free energy -76790.302041
Pre-training layer 1, epoch 75, validation free energy -75980.1924746
Pre-training layer 1, epoch 76, cost -245.184395905
Pre-training layer 1, epoch 77, cost -245.182276764
Pre-training layer 1, epoch 78, cost -245.04717453
Pre-training layer 1, epoch 79, cost -245.033958282
Pre-training layer 1, epoch 80, cost -244.91813858
Pre-training layer 1, epoch 80, representative training free energy -77255.3987012
Pre-training layer 1, epoch 80, validation free energy -76440.5248301
Pre-training layer 1, epoch 81, cost -244.754327545
Pre-training layer 1, epoch 82, cost -244.821601105
Pre-training layer 1, epoch 83, cost -244.696157303
Pre-training layer 1, epoch 84, cost -244.589809113
Pre-training layer 1, epoch 85, cost -244.586181488
Pre-training layer 1, epoch 85, representative training free energy -77620.9820645
Pre-training layer 1, epoch 85, validation free energy -76804.5776758
Pre-training layer 1, epoch 86, cost -244.485220337
Pre-training layer 1, epoch 87, cost -244.481438141
Pre-training layer 1, epoch 88, cost -244.283647995
Pre-training layer 1, epoch 89, cost -244.289361343
Pre-training layer 1, epoch 90, cost -244.243842926
Pre-training layer 1, epoch 90, representative training free energy -77953.3100762
Pre-training layer 1, epoch 90, validation free energy -77126.044584
Pre-training layer 1, epoch 91, cost -243.985322495
Pre-training layer 1, epoch 92, cost -244.125078278
Pre-training layer 1, epoch 93, cost -243.821436691
Pre-training layer 1, epoch 94, cost -244.065530014
Pre-training layer 1, epoch 95, cost -243.82871315
Pre-training layer 1, epoch 95, representative training free energy -78325.0853047
Pre-training layer 1, epoch 95, validation free energy -77492.3472617
Pre-training layer 1, epoch 96, cost -243.913691864
Pre-training layer 1, epoch 97, cost -243.734841156
Pre-training layer 1, epoch 98, cost -243.696499252
Pre-training layer 1, epoch 99, cost -243.57752861
Pre-training layer 2, epoch 0, cost -136.256378784
Pre-training layer 2, epoch 0, representative training free energy 2268.89451282
Pre-training layer 2, epoch 0, validation free energy 2253.8091792
Pre-training layer 2, epoch 1, cost -96.940845871
Pre-training layer 2, epoch 2, cost -89.2613190079
Pre-training layer 2, epoch 3, cost -84.9806036186
Pre-training layer 2, epoch 4, cost -81.7116690636
Pre-training layer 2, epoch 5, cost -79.5233751106
Pre-training layer 2, epoch 5, representative training free energy 3676.92287421
Pre-training layer 2, epoch 5, validation free energy 3632.65940851
Pre-training layer 2, epoch 6, cost -77.5068378639
Pre-training layer 2, epoch 7, cost -76.2285932541
Pre-training layer 2, epoch 8, cost -75.1293345451
Pre-training layer 2, epoch 9, cost -74.0384870911
Pre-training layer 2, epoch 10, cost -73.212993412
Pre-training layer 2, epoch 10, representative training free energy 4316.47463617
Pre-training layer 2, epoch 10, validation free energy 4265.90328247
Pre-training layer 2, epoch 11, cost -72.6257294273
Pre-training layer 2, epoch 12, cost -71.7079224396
Pre-training layer 2, epoch 13, cost -71.2070411301
Pre-training layer 2, epoch 14, cost -70.7385675812
Pre-training layer 2, epoch 15, cost -70.3064566231
Pre-training layer 2, epoch 15, representative training free energy 4816.164052
Pre-training layer 2, epoch 15, validation free energy 4760.56331885
Pre-training layer 2, epoch 16, cost -69.7062593842
Pre-training layer 2, epoch 17, cost -69.2566028595
Pre-training layer 2, epoch 18, cost -68.9266874504
Pre-training layer 2, epoch 19, cost -68.6323392296
Pre-training layer 2, epoch 20, cost -68.1887971687
Pre-training layer 2, epoch 20, representative training free energy 5246.5772251
Pre-training layer 2, epoch 20, validation free energy 5190.13330542
Pre-training layer 2, epoch 21, cost -67.9951516533
Pre-training layer 2, epoch 22, cost -67.7848622131
Pre-training layer 2, epoch 23, cost -67.4763533592
Pre-training layer 2, epoch 24, cost -67.140828743
Pre-training layer 2, epoch 25, cost -67.0533352089
Pre-training layer 2, epoch 25, representative training free energy 5581.25761609
Pre-training layer 2, epoch 25, validation free energy 5520.54733557
Pre-training layer 2, epoch 26, cost -66.7217729187
Pre-training layer 2, epoch 27, cost -66.6752549934
Pre-training layer 2, epoch 28, cost -66.4105718994
Pre-training layer 2, epoch 29, cost -66.3075306511
Pre-training layer 2, epoch 30, cost -66.1117903137
Pre-training layer 2, epoch 30, representative training free energy 5895.29319751
Pre-training layer 2, epoch 30, validation free energy 5829.61349854
Pre-training layer 2, epoch 31, cost -65.8491846466
Pre-training layer 2, epoch 32, cost -65.7855793571
Pre-training layer 2, epoch 33, cost -65.6000577545
Pre-training layer 2, epoch 34, cost -65.5742602158
Pre-training layer 2, epoch 35, cost -65.4385222054
Pre-training layer 2, epoch 35, representative training free energy 6175.72355945
Pre-training layer 2, epoch 35, validation free energy 6109.07150049
Pre-training layer 2, epoch 36, cost -65.1192255974
Pre-training layer 2, epoch 37, cost -65.2176248932
Pre-training layer 2, epoch 38, cost -65.0174523544
Pre-training layer 2, epoch 39, cost -64.8995742226
Pre-training layer 2, epoch 40, cost -64.6619937134
Pre-training layer 2, epoch 40, representative training free energy 6437.17567615
Pre-training layer 2, epoch 40, validation free energy 6365.08808716
Pre-training layer 2, epoch 41, cost -64.7210490608
Pre-training layer 2, epoch 42, cost -64.4375517845
Pre-training layer 2, epoch 43, cost -64.3877330589
Pre-training layer 2, epoch 44, cost -64.4193382645
Pre-training layer 2, epoch 45, cost -64.2439914513
Pre-training layer 2, epoch 45, representative training free energy 6673.8022688
Pre-training layer 2, epoch 45, validation free energy 6597.82080627
Pre-training layer 2, epoch 46, cost -64.2312392807
Pre-training layer 2, epoch 47, cost -64.0996285629
Pre-training layer 2, epoch 48, cost -64.0517785645
Pre-training layer 2, epoch 49, cost -63.8362043571
Pre-training layer 2, epoch 50, cost -63.9327719498
Pre-training layer 2, epoch 50, representative training free energy 6879.70152087
Pre-training layer 2, epoch 50, validation free energy 6805.98778223
Pre-training layer 2, epoch 51, cost -63.8438873863
Pre-training layer 2, epoch 52, cost -63.6742016792
Pre-training layer 2, epoch 53, cost -63.6395392609
Pre-training layer 2, epoch 54, cost -63.7372647476
Pre-training layer 2, epoch 55, cost -63.5496473122
Pre-training layer 2, epoch 55, representative training free energy 7086.72032642
Pre-training layer 2, epoch 55, validation free energy 7007.18111255
Pre-training layer 2, epoch 56, cost -63.4008354568
Pre-training layer 2, epoch 57, cost -63.4325628853
Pre-training layer 2, epoch 58, cost -63.3711904335
Pre-training layer 2, epoch 59, cost -63.3205561447
Pre-training layer 2, epoch 60, cost -63.2163896561
Pre-training layer 2, epoch 60, representative training free energy 7280.88001562
Pre-training layer 2, epoch 60, validation free energy 7199.59428418
Pre-training layer 2, epoch 61, cost -63.0855169296
Pre-training layer 2, epoch 62, cost -63.1763090706
Pre-training layer 2, epoch 63, cost -63.0478509712
Pre-training layer 2, epoch 64, cost -62.9641911125
Pre-training layer 2, epoch 65, cost -62.9734195709
Pre-training layer 2, epoch 65, representative training free energy 7472.31584985
Pre-training layer 2, epoch 65, validation free energy 7389.61290576
Pre-training layer 2, epoch 66, cost -62.7592569542
Pre-training layer 2, epoch 67, cost -62.8862079048
Pre-training layer 2, epoch 68, cost -62.7186868668
Pre-training layer 2, epoch 69, cost -62.6828205299
Pre-training layer 2, epoch 70, cost -62.7503999329
Pre-training layer 2, epoch 70, representative training free energy 7628.18267944
Pre-training layer 2, epoch 70, validation free energy 7545.13617896
Pre-training layer 2, epoch 71, cost -62.6286454582
Pre-training layer 2, epoch 72, cost -62.7112957001
Pre-training layer 2, epoch 73, cost -62.74990942
Pre-training layer 2, epoch 74, cost -62.5837591934
Pre-training layer 2, epoch 75, cost -62.4936302757
Pre-training layer 2, epoch 75, representative training free energy 7792.44094482
Pre-training layer 2, epoch 75, validation free energy 7705.53848267
Pre-training layer 2, epoch 76, cost -62.5116983604
Pre-training layer 2, epoch 77, cost -62.4662662315
Pre-training layer 2, epoch 78, cost -62.2905247307
Pre-training layer 2, epoch 79, cost -62.2387811089
Pre-training layer 2, epoch 80, cost -62.3542877388
Pre-training layer 2, epoch 80, representative training free energy 7961.11364917
Pre-training layer 2, epoch 80, validation free energy 7871.52599414
Pre-training layer 2, epoch 81, cost -62.4184822083
Pre-training layer 2, epoch 82, cost -62.3455158043
Pre-training layer 2, epoch 83, cost -62.2743419456
Pre-training layer 2, epoch 84, cost -62.1820157433
Pre-training layer 2, epoch 85, cost -62.1083914566
Pre-training layer 2, epoch 85, representative training free energy 8115.17857983
Pre-training layer 2, epoch 85, validation free energy 8023.91520435
Pre-training layer 2, epoch 86, cost -62.2112658691
Pre-training layer 2, epoch 87, cost -62.1405931854
Pre-training layer 2, epoch 88, cost -62.1417302704
Pre-training layer 2, epoch 89, cost -62.1304743195
Pre-training layer 2, epoch 90, cost -61.9949483871
Pre-training layer 2, epoch 90, representative training free energy 8284.8176167
Pre-training layer 2, epoch 90, validation free energy 8192.68863989
Pre-training layer 2, epoch 91, cost -62.1390616226
Pre-training layer 2, epoch 92, cost -61.9629900551
Pre-training layer 2, epoch 93, cost -61.9940810013
Pre-training layer 2, epoch 94, cost -61.7821408844
Pre-training layer 2, epoch 95, cost -61.9791702652
Pre-training layer 2, epoch 95, representative training free energy 8425.86462744
Pre-training layer 2, epoch 95, validation free energy 8332.00522412
Pre-training layer 2, epoch 96, cost -61.9114438629
Pre-training layer 2, epoch 97, cost -61.785328331
Pre-training layer 2, epoch 98, cost -61.8264786148
Pre-training layer 2, epoch 99, cost -61.7814916229
The pretraining code for file dbn_loop.pyc ran for 1.96m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 12.400000 %
     epoch 1, minibatch 200/200, test error of best model 13.800000 %
epoch 2, minibatch 200/200, validation error 10.500000 %
     epoch 2, minibatch 200/200, test error of best model 11.600000 %
epoch 3, minibatch 200/200, validation error 9.100000 %
     epoch 3, minibatch 200/200, test error of best model 10.600000 %
epoch 4, minibatch 200/200, validation error 9.000000 %
     epoch 4, minibatch 200/200, test error of best model 10.000000 %
epoch 5, minibatch 200/200, validation error 8.900000 %
     epoch 5, minibatch 200/200, test error of best model 9.800000 %
epoch 6, minibatch 200/200, validation error 8.600000 %
     epoch 6, minibatch 200/200, test error of best model 9.700000 %
epoch 7, minibatch 200/200, validation error 8.500000 %
     epoch 7, minibatch 200/200, test error of best model 9.400000 %
epoch 8, minibatch 200/200, validation error 8.500000 %
epoch 9, minibatch 200/200, validation error 8.400000 %
     epoch 9, minibatch 200/200, test error of best model 8.500000 %
epoch 10, minibatch 200/200, validation error 8.200000 %
     epoch 10, minibatch 200/200, test error of best model 8.300000 %
epoch 11, minibatch 200/200, validation error 8.100000 %
     epoch 11, minibatch 200/200, test error of best model 8.300000 %
epoch 12, minibatch 200/200, validation error 7.900000 %
     epoch 12, minibatch 200/200, test error of best model 8.300000 %
epoch 13, minibatch 200/200, validation error 7.800000 %
     epoch 13, minibatch 200/200, test error of best model 8.200000 %
epoch 14, minibatch 200/200, validation error 7.400000 %
     epoch 14, minibatch 200/200, test error of best model 8.300000 %
epoch 15, minibatch 200/200, validation error 7.100000 %
     epoch 15, minibatch 200/200, test error of best model 8.400000 %
epoch 16, minibatch 200/200, validation error 7.200000 %
epoch 17, minibatch 200/200, validation error 7.300000 %
epoch 18, minibatch 200/200, validation error 7.400000 %
epoch 19, minibatch 200/200, validation error 7.400000 %
epoch 20, minibatch 200/200, validation error 7.200000 %
epoch 21, minibatch 200/200, validation error 7.400000 %
epoch 22, minibatch 200/200, validation error 7.300000 %
epoch 23, minibatch 200/200, validation error 7.500000 %
epoch 24, minibatch 200/200, validation error 7.500000 %
epoch 25, minibatch 200/200, validation error 7.600000 %
epoch 26, minibatch 200/200, validation error 7.700000 %
epoch 27, minibatch 200/200, validation error 7.600000 %
epoch 28, minibatch 200/200, validation error 7.600000 %
epoch 29, minibatch 200/200, validation error 7.500000 %
Optimization complete with best validation score of 7.100000 %, obtained at iteration 3000, with test performance 8.400000 %
The fine tuning code for file dbn_loop.pyc ran for 0.28m


==========Sample Size: (3000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -149.414550069
Pre-training layer 0, epoch 0, representative training free energy -557.512208557
Pre-training layer 0, epoch 0, validation free energy -554.811125244
Pre-training layer 0, epoch 1, cost -115.639415181
Pre-training layer 0, epoch 2, cost -106.84642072
Pre-training layer 0, epoch 3, cost -101.617770742
Pre-training layer 0, epoch 4, cost -98.4014991252
Pre-training layer 0, epoch 5, cost -95.6202276357
Pre-training layer 0, epoch 5, representative training free energy -503.828503784
Pre-training layer 0, epoch 5, validation free energy -498.48968045
Pre-training layer 0, epoch 6, cost -93.594515152
Pre-training layer 0, epoch 7, cost -91.8460911814
Pre-training layer 0, epoch 8, cost -90.4591273499
Pre-training layer 0, epoch 9, cost -89.4450159454
Pre-training layer 0, epoch 10, cost -88.220378329
Pre-training layer 0, epoch 10, representative training free energy -481.33636676
Pre-training layer 0, epoch 10, validation free energy -475.258418732
Pre-training layer 0, epoch 11, cost -87.25576238
Pre-training layer 0, epoch 12, cost -86.4351315562
Pre-training layer 0, epoch 13, cost -85.8956414541
Pre-training layer 0, epoch 14, cost -85.0557489268
Pre-training layer 0, epoch 15, cost -84.7202037684
Pre-training layer 0, epoch 15, representative training free energy -470.238537415
Pre-training layer 0, epoch 15, validation free energy -463.626377228
Pre-training layer 0, epoch 16, cost -84.0596896108
Pre-training layer 0, epoch 17, cost -83.5780794907
Pre-training layer 0, epoch 18, cost -83.1253550339
Pre-training layer 0, epoch 19, cost -82.5129963557
Pre-training layer 0, epoch 20, cost -82.3058538946
Pre-training layer 0, epoch 20, representative training free energy -463.774241577
Pre-training layer 0, epoch 20, validation free energy -457.01582666
Pre-training layer 0, epoch 21, cost -82.0251977158
Pre-training layer 0, epoch 22, cost -81.5136483637
Pre-training layer 0, epoch 23, cost -81.1661544545
Pre-training layer 0, epoch 24, cost -80.6856101227
Pre-training layer 0, epoch 25, cost -80.6657342911
Pre-training layer 0, epoch 25, representative training free energy -456.713586304
Pre-training layer 0, epoch 25, validation free energy -449.417063416
Pre-training layer 0, epoch 26, cost -80.1064493815
Pre-training layer 0, epoch 27, cost -79.8340573502
Pre-training layer 0, epoch 28, cost -79.6839308929
Pre-training layer 0, epoch 29, cost -79.5720386632
Pre-training layer 0, epoch 30, cost -79.1803165944
Pre-training layer 0, epoch 30, representative training free energy -452.437956116
Pre-training layer 0, epoch 30, validation free energy -444.477117615
Pre-training layer 0, epoch 31, cost -79.0268643824
Pre-training layer 0, epoch 32, cost -78.8803791936
Pre-training layer 0, epoch 33, cost -78.6588469823
Pre-training layer 0, epoch 34, cost -78.3693975067
Pre-training layer 0, epoch 35, cost -78.3820366033
Pre-training layer 0, epoch 35, representative training free energy -449.892666718
Pre-training layer 0, epoch 35, validation free energy -441.849498138
Pre-training layer 0, epoch 36, cost -78.0278466415
Pre-training layer 0, epoch 37, cost -77.9395441945
Pre-training layer 0, epoch 38, cost -77.8035724131
Pre-training layer 0, epoch 39, cost -77.6032243601
Pre-training layer 0, epoch 40, cost -77.4399026362
Pre-training layer 0, epoch 40, representative training free energy -447.463225677
Pre-training layer 0, epoch 40, validation free energy -438.586667511
Pre-training layer 0, epoch 41, cost -77.1500514476
Pre-training layer 0, epoch 42, cost -77.0435763295
Pre-training layer 0, epoch 43, cost -77.05996123
Pre-training layer 0, epoch 44, cost -76.8221284739
Pre-training layer 0, epoch 45, cost -76.6065874481
Pre-training layer 0, epoch 45, representative training free energy -445.805090088
Pre-training layer 0, epoch 45, validation free energy -437.230072021
Pre-training layer 0, epoch 46, cost -76.4619135412
Pre-training layer 0, epoch 47, cost -76.3987453206
Pre-training layer 0, epoch 48, cost -76.2728625107
Pre-training layer 0, epoch 49, cost -76.2760243861
Pre-training layer 0, epoch 50, cost -76.2101377996
Pre-training layer 0, epoch 50, representative training free energy -445.52524469
Pre-training layer 0, epoch 50, validation free energy -435.839891998
Pre-training layer 0, epoch 51, cost -75.7545230738
Pre-training layer 0, epoch 52, cost -75.8189586894
Pre-training layer 0, epoch 53, cost -75.6341676458
Pre-training layer 0, epoch 54, cost -75.6948609543
Pre-training layer 0, epoch 55, cost -75.5947348531
Pre-training layer 0, epoch 55, representative training free energy -446.040949738
Pre-training layer 0, epoch 55, validation free energy -436.80436496
Pre-training layer 0, epoch 56, cost -75.4122920609
Pre-training layer 0, epoch 57, cost -75.2436140442
Pre-training layer 0, epoch 58, cost -75.2379513931
Pre-training layer 0, epoch 59, cost -75.175273145
Pre-training layer 0, epoch 60, cost -74.9144576263
Pre-training layer 0, epoch 60, representative training free energy -441.127253326
Pre-training layer 0, epoch 60, validation free energy -431.763308289
Pre-training layer 0, epoch 61, cost -74.9192090861
Pre-training layer 0, epoch 62, cost -74.9251410294
Pre-training layer 0, epoch 63, cost -74.743482844
Pre-training layer 0, epoch 64, cost -74.7460946274
Pre-training layer 0, epoch 65, cost -74.5070417404
Pre-training layer 0, epoch 65, representative training free energy -441.035987183
Pre-training layer 0, epoch 65, validation free energy -431.634339752
Pre-training layer 0, epoch 66, cost -74.5716844686
Pre-training layer 0, epoch 67, cost -74.3119572194
Pre-training layer 0, epoch 68, cost -74.4525076294
Pre-training layer 0, epoch 69, cost -74.2971915181
Pre-training layer 0, epoch 70, cost -74.0946163559
Pre-training layer 0, epoch 70, representative training free energy -437.700652496
Pre-training layer 0, epoch 70, validation free energy -427.433237427
Pre-training layer 0, epoch 71, cost -74.2715136592
Pre-training layer 0, epoch 72, cost -74.0428949992
Pre-training layer 0, epoch 73, cost -73.8366799672
Pre-training layer 0, epoch 74, cost -73.9593884786
Pre-training layer 0, epoch 75, cost -74.0057370249
Pre-training layer 0, epoch 75, representative training free energy -438.035937042
Pre-training layer 0, epoch 75, validation free energy -427.853801361
Pre-training layer 0, epoch 76, cost -73.8060471344
Pre-training layer 0, epoch 77, cost -73.6665339025
Pre-training layer 0, epoch 78, cost -73.7118646367
Pre-training layer 0, epoch 79, cost -73.6073159663
Pre-training layer 0, epoch 80, cost -73.4884378306
Pre-training layer 0, epoch 80, representative training free energy -438.383410614
Pre-training layer 0, epoch 80, validation free energy -428.368546082
Pre-training layer 0, epoch 81, cost -73.4430251567
Pre-training layer 0, epoch 82, cost -73.3955894852
Pre-training layer 0, epoch 83, cost -73.4156143697
Pre-training layer 0, epoch 84, cost -73.1800930913
Pre-training layer 0, epoch 85, cost -73.1319428762
Pre-training layer 0, epoch 85, representative training free energy -439.035464813
Pre-training layer 0, epoch 85, validation free energy -428.343213043
Pre-training layer 0, epoch 86, cost -73.240433019
Pre-training layer 0, epoch 87, cost -73.0350695165
Pre-training layer 0, epoch 88, cost -73.0355592092
Pre-training layer 0, epoch 89, cost -72.8906747055
Pre-training layer 0, epoch 90, cost -72.8912090683
Pre-training layer 0, epoch 90, representative training free energy -434.931530426
Pre-training layer 0, epoch 90, validation free energy -424.022948425
Pre-training layer 0, epoch 91, cost -72.9514513524
Pre-training layer 0, epoch 92, cost -72.9231524658
Pre-training layer 0, epoch 93, cost -72.8826953379
Pre-training layer 0, epoch 94, cost -72.6125165812
Pre-training layer 0, epoch 95, cost -72.7070191447
Pre-training layer 0, epoch 95, representative training free energy -436.44141095
Pre-training layer 0, epoch 95, validation free energy -425.810399261
Pre-training layer 0, epoch 96, cost -72.6770100784
Pre-training layer 0, epoch 97, cost -72.6211993408
Pre-training layer 0, epoch 98, cost -72.5446641159
Pre-training layer 0, epoch 99, cost -72.4412435023
Pre-training layer 1, epoch 0, cost -346.301519623
Pre-training layer 1, epoch 0, representative training free energy -50708.4300205
Pre-training layer 1, epoch 0, validation free energy -50157.8787998
Pre-training layer 1, epoch 1, cost -297.286490682
Pre-training layer 1, epoch 2, cost -282.375790253
Pre-training layer 1, epoch 3, cost -273.595046183
Pre-training layer 1, epoch 4, cost -267.340385793
Pre-training layer 1, epoch 5, cost -262.726442769
Pre-training layer 1, epoch 5, representative training free energy -68672.0648242
Pre-training layer 1, epoch 5, validation free energy -67880.7314473
Pre-training layer 1, epoch 6, cost -259.310934041
Pre-training layer 1, epoch 7, cost -256.52645518
Pre-training layer 1, epoch 8, cost -254.111054942
Pre-training layer 1, epoch 9, cost -251.981654358
Pre-training layer 1, epoch 10, cost -250.186168213
Pre-training layer 1, epoch 10, representative training free energy -74248.5010566
Pre-training layer 1, epoch 10, validation free energy -73393.3380996
Pre-training layer 1, epoch 11, cost -248.964829407
Pre-training layer 1, epoch 12, cost -247.518846181
Pre-training layer 1, epoch 13, cost -246.289395905
Pre-training layer 1, epoch 14, cost -245.284783427
Pre-training layer 1, epoch 15, cost -244.272285868
Pre-training layer 1, epoch 15, representative training free energy -77446.4318965
Pre-training layer 1, epoch 15, validation free energy -76558.9347363
Pre-training layer 1, epoch 16, cost -243.471471863
Pre-training layer 1, epoch 17, cost -242.534257812
Pre-training layer 1, epoch 18, cost -242.026137034
Pre-training layer 1, epoch 19, cost -241.390491028
Pre-training layer 1, epoch 20, cost -240.758848012
Pre-training layer 1, epoch 20, representative training free energy -79663.9269238
Pre-training layer 1, epoch 20, validation free energy -78753.8913652
Pre-training layer 1, epoch 21, cost -240.174071198
Pre-training layer 1, epoch 22, cost -239.61849467
Pre-training layer 1, epoch 23, cost -239.198244222
Pre-training layer 1, epoch 24, cost -238.735960592
Pre-training layer 1, epoch 25, cost -238.129451955
Pre-training layer 1, epoch 25, representative training free energy -81498.4858477
Pre-training layer 1, epoch 25, validation free energy -80557.7114512
Pre-training layer 1, epoch 26, cost -237.847195943
Pre-training layer 1, epoch 27, cost -237.485750682
Pre-training layer 1, epoch 28, cost -236.958545329
Pre-training layer 1, epoch 29, cost -236.800115967
Pre-training layer 1, epoch 30, cost -236.400311279
Pre-training layer 1, epoch 30, representative training free energy -82989.5212852
Pre-training layer 1, epoch 30, validation free energy -82030.3650527
Pre-training layer 1, epoch 31, cost -236.063606873
Pre-training layer 1, epoch 32, cost -235.73372467
Pre-training layer 1, epoch 33, cost -235.580614065
Pre-training layer 1, epoch 34, cost -235.40001358
Pre-training layer 1, epoch 35, cost -235.037427419
Pre-training layer 1, epoch 35, representative training free energy -84259.4424687
Pre-training layer 1, epoch 35, validation free energy -83282.778332
Pre-training layer 1, epoch 36, cost -234.775730693
Pre-training layer 1, epoch 37, cost -234.626040293
Pre-training layer 1, epoch 38, cost -234.376304525
Pre-training layer 1, epoch 39, cost -234.190454915
Pre-training layer 1, epoch 40, cost -234.075074921
Pre-training layer 1, epoch 40, representative training free energy -85308.8677559
Pre-training layer 1, epoch 40, validation free energy -84330.4657305
Pre-training layer 1, epoch 41, cost -233.836926524
Pre-training layer 1, epoch 42, cost -233.533507131
Pre-training layer 1, epoch 43, cost -233.417695516
Pre-training layer 1, epoch 44, cost -233.174874268
Pre-training layer 1, epoch 45, cost -232.919923248
Pre-training layer 1, epoch 45, representative training free energy -86289.7876484
Pre-training layer 1, epoch 45, validation free energy -85297.6624648
Pre-training layer 1, epoch 46, cost -232.872067719
Pre-training layer 1, epoch 47, cost -232.709355672
Pre-training layer 1, epoch 48, cost -232.546301727
Pre-training layer 1, epoch 49, cost -232.427097473
Pre-training layer 1, epoch 50, cost -232.088914693
Pre-training layer 1, epoch 50, representative training free energy -87085.1790957
Pre-training layer 1, epoch 50, validation free energy -86089.0172871
Pre-training layer 1, epoch 51, cost -232.107392782
Pre-training layer 1, epoch 52, cost -232.009729716
Pre-training layer 1, epoch 53, cost -231.763732096
Pre-training layer 1, epoch 54, cost -231.846370392
Pre-training layer 1, epoch 55, cost -231.584732157
Pre-training layer 1, epoch 55, representative training free energy -87913.6674258
Pre-training layer 1, epoch 55, validation free energy -86905.9780742
Pre-training layer 1, epoch 56, cost -231.464379018
Pre-training layer 1, epoch 57, cost -231.2872435
Pre-training layer 1, epoch 58, cost -231.277075195
Pre-training layer 1, epoch 59, cost -231.179046529
Pre-training layer 1, epoch 60, cost -231.025151927
Pre-training layer 1, epoch 60, representative training free energy -88589.2217754
Pre-training layer 1, epoch 60, validation free energy -87579.543625
Pre-training layer 1, epoch 61, cost -230.983940582
Pre-training layer 1, epoch 62, cost -230.851407827
Pre-training layer 1, epoch 63, cost -230.723394165
Pre-training layer 1, epoch 64, cost -230.473712056
Pre-training layer 1, epoch 65, cost -230.468943481
Pre-training layer 1, epoch 65, representative training free energy -89241.2311367
Pre-training layer 1, epoch 65, validation free energy -88212.0339746
Pre-training layer 1, epoch 66, cost -230.298233744
Pre-training layer 1, epoch 67, cost -230.399821014
Pre-training layer 1, epoch 68, cost -230.280846405
Pre-training layer 1, epoch 69, cost -230.033295593
Pre-training layer 1, epoch 70, cost -230.048656108
Pre-training layer 1, epoch 70, representative training free energy -89838.038252
Pre-training layer 1, epoch 70, validation free energy -88800.6849746
Pre-training layer 1, epoch 71, cost -229.840736287
Pre-training layer 1, epoch 72, cost -229.768621368
Pre-training layer 1, epoch 73, cost -229.75033783
Pre-training layer 1, epoch 74, cost -229.592118683
Pre-training layer 1, epoch 75, cost -229.486147817
Pre-training layer 1, epoch 75, representative training free energy -90331.5938477
Pre-training layer 1, epoch 75, validation free energy -89298.0664609
Pre-training layer 1, epoch 76, cost -229.589538981
Pre-training layer 1, epoch 77, cost -229.56007843
Pre-training layer 1, epoch 78, cost -229.368326365
Pre-training layer 1, epoch 79, cost -229.147552185
Pre-training layer 1, epoch 80, cost -229.235258636
Pre-training layer 1, epoch 80, representative training free energy -90875.3287266
Pre-training layer 1, epoch 80, validation free energy -89826.2368789
Pre-training layer 1, epoch 81, cost -229.145947418
Pre-training layer 1, epoch 82, cost -229.045131887
Pre-training layer 1, epoch 83, cost -229.008365987
Pre-training layer 1, epoch 84, cost -228.832596639
Pre-training layer 1, epoch 85, cost -228.851198578
Pre-training layer 1, epoch 85, representative training free energy -91528.2257188
Pre-training layer 1, epoch 85, validation free energy -90473.3399727
Pre-training layer 1, epoch 86, cost -228.757139333
Pre-training layer 1, epoch 87, cost -228.765577799
Pre-training layer 1, epoch 88, cost -228.544938558
Pre-training layer 1, epoch 89, cost -228.539742686
Pre-training layer 1, epoch 90, cost -228.403472392
Pre-training layer 1, epoch 90, representative training free energy -91948.9981035
Pre-training layer 1, epoch 90, validation free energy -90873.0239004
Pre-training layer 1, epoch 91, cost -228.502283071
Pre-training layer 1, epoch 92, cost -228.459408569
Pre-training layer 1, epoch 93, cost -228.379015808
Pre-training layer 1, epoch 94, cost -228.345481873
Pre-training layer 1, epoch 95, cost -228.241771291
Pre-training layer 1, epoch 95, representative training free energy -92386.5707207
Pre-training layer 1, epoch 95, validation free energy -91323.782168
Pre-training layer 1, epoch 96, cost -228.125196991
Pre-training layer 1, epoch 97, cost -228.163728129
Pre-training layer 1, epoch 98, cost -228.072546844
Pre-training layer 1, epoch 99, cost -227.981598053
Pre-training layer 2, epoch 0, cost -127.995430349
Pre-training layer 2, epoch 0, representative training free energy 3235.9181521
Pre-training layer 2, epoch 0, validation free energy 3155.40234424
Pre-training layer 2, epoch 1, cost -94.0290015157
Pre-training layer 2, epoch 2, cost -86.9320693461
Pre-training layer 2, epoch 3, cost -82.739748497
Pre-training layer 2, epoch 4, cost -80.0190989812
Pre-training layer 2, epoch 5, cost -77.8802256648
Pre-training layer 2, epoch 5, representative training free energy 4862.06909229
Pre-training layer 2, epoch 5, validation free energy 4777.89610876
Pre-training layer 2, epoch 6, cost -76.2975465012
Pre-training layer 2, epoch 7, cost -75.2090700022
Pre-training layer 2, epoch 8, cost -74.0953281657
Pre-training layer 2, epoch 9, cost -73.1506591161
Pre-training layer 2, epoch 10, cost -72.4144004949
Pre-training layer 2, epoch 10, representative training free energy 5738.77208545
Pre-training layer 2, epoch 10, validation free energy 5648.50904663
Pre-training layer 2, epoch 11, cost -71.7445290629
Pre-training layer 2, epoch 12, cost -71.1275495656
Pre-training layer 2, epoch 13, cost -70.6252951686
Pre-training layer 2, epoch 14, cost -70.1813154475
Pre-training layer 2, epoch 15, cost -69.6756235123
Pre-training layer 2, epoch 15, representative training free energy 6442.89500208
Pre-training layer 2, epoch 15, validation free energy 6354.4947749
Pre-training layer 2, epoch 16, cost -69.3915154394
Pre-training layer 2, epoch 17, cost -68.9338491821
Pre-training layer 2, epoch 18, cost -68.6778265762
Pre-training layer 2, epoch 19, cost -68.3413252894
Pre-training layer 2, epoch 20, cost -68.1022899373
Pre-training layer 2, epoch 20, representative training free energy 7001.72852783
Pre-training layer 2, epoch 20, validation free energy 6917.76766528
Pre-training layer 2, epoch 21, cost -67.9199578985
Pre-training layer 2, epoch 22, cost -67.6647727839
Pre-training layer 2, epoch 23, cost -67.4451096471
Pre-training layer 2, epoch 24, cost -67.1811965179
Pre-training layer 2, epoch 25, cost -67.0451054382
Pre-training layer 2, epoch 25, representative training free energy 7491.18558984
Pre-training layer 2, epoch 25, validation free energy 7402.89602051
Pre-training layer 2, epoch 26, cost -66.742939682
Pre-training layer 2, epoch 27, cost -66.6439183299
Pre-training layer 2, epoch 28, cost -66.4692967224
Pre-training layer 2, epoch 29, cost -66.3486788177
Pre-training layer 2, epoch 30, cost -66.2368142573
Pre-training layer 2, epoch 30, representative training free energy 7857.24748535
Pre-training layer 2, epoch 30, validation free energy 7762.04916968
Pre-training layer 2, epoch 31, cost -66.0712712097
Pre-training layer 2, epoch 32, cost -65.9425171789
Pre-training layer 2, epoch 33, cost -65.8920378367
Pre-training layer 2, epoch 34, cost -65.7804623667
Pre-training layer 2, epoch 35, cost -65.4783978399
Pre-training layer 2, epoch 35, representative training free energy 8224.19732764
Pre-training layer 2, epoch 35, validation free energy 8127.29615527
Pre-training layer 2, epoch 36, cost -65.5045583979
Pre-training layer 2, epoch 37, cost -65.396874822
Pre-training layer 2, epoch 38, cost -65.2329069265
Pre-training layer 2, epoch 39, cost -65.1518147024
Pre-training layer 2, epoch 40, cost -65.0880133311
Pre-training layer 2, epoch 40, representative training free energy 8570.21830396
Pre-training layer 2, epoch 40, validation free energy 8470.18961963
Pre-training layer 2, epoch 41, cost -65.0550955709
Pre-training layer 2, epoch 42, cost -64.9351512909
Pre-training layer 2, epoch 43, cost -64.9300171153
Pre-training layer 2, epoch 44, cost -64.7647121684
Pre-training layer 2, epoch 45, cost -64.6831581624
Pre-training layer 2, epoch 45, representative training free energy 8856.72178906
Pre-training layer 2, epoch 45, validation free energy 8752.10281494
Pre-training layer 2, epoch 46, cost -64.6589872996
Pre-training layer 2, epoch 47, cost -64.5393618266
Pre-training layer 2, epoch 48, cost -64.5850530752
Pre-training layer 2, epoch 49, cost -64.4080929438
Pre-training layer 2, epoch 50, cost -64.4285886256
Pre-training layer 2, epoch 50, representative training free energy 9156.82265552
Pre-training layer 2, epoch 50, validation free energy 9049.80729443
Pre-training layer 2, epoch 51, cost -64.2943970998
Pre-training layer 2, epoch 52, cost -64.2865662257
Pre-training layer 2, epoch 53, cost -64.1593837865
Pre-training layer 2, epoch 54, cost -64.0060293325
Pre-training layer 2, epoch 55, cost -64.2002916972
Pre-training layer 2, epoch 55, representative training free energy 9370.76521021
Pre-training layer 2, epoch 55, validation free energy 9259.56440576
Pre-training layer 2, epoch 56, cost -64.0734882609
Pre-training layer 2, epoch 57, cost -63.9370740255
Pre-training layer 2, epoch 58, cost -63.8807709757
Pre-training layer 2, epoch 59, cost -63.8636672719
Pre-training layer 2, epoch 60, cost -63.8211073812
Pre-training layer 2, epoch 60, representative training free energy 9646.68292676
Pre-training layer 2, epoch 60, validation free energy 9532.43520654
Pre-training layer 2, epoch 61, cost -63.8235161845
Pre-training layer 2, epoch 62, cost -63.7746685282
Pre-training layer 2, epoch 63, cost -63.7361556753
Pre-training layer 2, epoch 64, cost -63.6581917953
Pre-training layer 2, epoch 65, cost -63.6541296768
Pre-training layer 2, epoch 65, representative training free energy 9888.22860815
Pre-training layer 2, epoch 65, validation free energy 9771.18088745
Pre-training layer 2, epoch 66, cost -63.5872874324
Pre-training layer 2, epoch 67, cost -63.5367874908
Pre-training layer 2, epoch 68, cost -63.5248358281
Pre-training layer 2, epoch 69, cost -63.493856163
Pre-training layer 2, epoch 70, cost -63.473045845
Pre-training layer 2, epoch 70, representative training free energy 10134.8715635
Pre-training layer 2, epoch 70, validation free energy 10013.9129128
Pre-training layer 2, epoch 71, cost -63.4104600398
Pre-training layer 2, epoch 72, cost -63.3238020833
Pre-training layer 2, epoch 73, cost -63.309695727
Pre-training layer 2, epoch 74, cost -63.2079603704
Pre-training layer 2, epoch 75, cost -63.253199234
Pre-training layer 2, epoch 75, representative training free energy 10341.9605168
Pre-training layer 2, epoch 75, validation free energy 10218.8196382
Pre-training layer 2, epoch 76, cost -63.1822788239
Pre-training layer 2, epoch 77, cost -63.1409314728
Pre-training layer 2, epoch 78, cost -63.175620931
Pre-training layer 2, epoch 79, cost -63.2039441045
Pre-training layer 2, epoch 80, cost -63.2504243088
Pre-training layer 2, epoch 80, representative training free energy 10539.0230608
Pre-training layer 2, epoch 80, validation free energy 10411.7827122
Pre-training layer 2, epoch 81, cost -63.1226566442
Pre-training layer 2, epoch 82, cost -63.0836694717
Pre-training layer 2, epoch 83, cost -63.0608713913
Pre-training layer 2, epoch 84, cost -63.0518018087
Pre-training layer 2, epoch 85, cost -62.9409629822
Pre-training layer 2, epoch 85, representative training free energy 10772.7658142
Pre-training layer 2, epoch 85, validation free energy 10644.097832
Pre-training layer 2, epoch 86, cost -62.9611762238
Pre-training layer 2, epoch 87, cost -62.9183906174
Pre-training layer 2, epoch 88, cost -62.74858476
Pre-training layer 2, epoch 89, cost -62.9249404271
Pre-training layer 2, epoch 90, cost -62.8982621384
Pre-training layer 2, epoch 90, representative training free energy 10954.2698804
Pre-training layer 2, epoch 90, validation free energy 10823.1513545
Pre-training layer 2, epoch 91, cost -62.8451593018
Pre-training layer 2, epoch 92, cost -62.7648133977
Pre-training layer 2, epoch 93, cost -62.7981107712
Pre-training layer 2, epoch 94, cost -62.7644120916
Pre-training layer 2, epoch 95, cost -62.7386987813
Pre-training layer 2, epoch 95, representative training free energy 11168.5445127
Pre-training layer 2, epoch 95, validation free energy 11032.7935886
Pre-training layer 2, epoch 96, cost -62.6580172729
Pre-training layer 2, epoch 97, cost -62.6151489512
Pre-training layer 2, epoch 98, cost -62.690006218
Pre-training layer 2, epoch 99, cost -62.6224848048
The pretraining code for file dbn_loop.pyc ran for 2.85m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 10.700000 %
     epoch 1, minibatch 300/300, test error of best model 11.600000 %
epoch 2, minibatch 300/300, validation error 9.200000 %
     epoch 2, minibatch 300/300, test error of best model 10.000000 %
epoch 3, minibatch 300/300, validation error 8.700000 %
     epoch 3, minibatch 300/300, test error of best model 8.900000 %
epoch 4, minibatch 300/300, validation error 8.700000 %
epoch 5, minibatch 300/300, validation error 8.200000 %
     epoch 5, minibatch 300/300, test error of best model 8.300000 %
epoch 6, minibatch 300/300, validation error 8.100000 %
     epoch 6, minibatch 300/300, test error of best model 7.900000 %
epoch 7, minibatch 300/300, validation error 8.000000 %
     epoch 7, minibatch 300/300, test error of best model 7.700000 %
epoch 8, minibatch 300/300, validation error 7.900000 %
     epoch 8, minibatch 300/300, test error of best model 7.200000 %
epoch 9, minibatch 300/300, validation error 7.900000 %
epoch 10, minibatch 300/300, validation error 7.800000 %
     epoch 10, minibatch 300/300, test error of best model 7.300000 %
epoch 11, minibatch 300/300, validation error 7.900000 %
epoch 12, minibatch 300/300, validation error 8.100000 %
epoch 13, minibatch 300/300, validation error 8.200000 %
epoch 14, minibatch 300/300, validation error 8.400000 %
epoch 15, minibatch 300/300, validation error 8.500000 %
epoch 16, minibatch 300/300, validation error 8.500000 %
epoch 17, minibatch 300/300, validation error 8.300000 %
epoch 18, minibatch 300/300, validation error 8.100000 %
epoch 19, minibatch 300/300, validation error 8.000000 %
Optimization complete with best validation score of 7.800000 %, obtained at iteration 3000, with test performance 7.300000 %
The fine tuning code for file dbn_loop.pyc ran for 0.26m


==========Sample Size: (4000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -142.435302505
Pre-training layer 0, epoch 0, representative training free energy -552.076575775
Pre-training layer 0, epoch 0, validation free energy -549.37970929
Pre-training layer 0, epoch 1, cost -111.259866161
Pre-training layer 0, epoch 2, cost -103.066906662
Pre-training layer 0, epoch 3, cost -98.1763906097
Pre-training layer 0, epoch 4, cost -94.9465360451
Pre-training layer 0, epoch 5, cost -92.6473996353
Pre-training layer 0, epoch 5, representative training free energy -489.366557434
Pre-training layer 0, epoch 5, validation free energy -485.504647278
Pre-training layer 0, epoch 6, cost -90.7799381256
Pre-training layer 0, epoch 7, cost -89.4049313545
Pre-training layer 0, epoch 8, cost -88.0322462654
Pre-training layer 0, epoch 9, cost -87.0265810585
Pre-training layer 0, epoch 10, cost -86.0176455688
Pre-training layer 0, epoch 10, representative training free energy -467.022883667
Pre-training layer 0, epoch 10, validation free energy -462.582421387
Pre-training layer 0, epoch 11, cost -85.4078335857
Pre-training layer 0, epoch 12, cost -84.6164297295
Pre-training layer 0, epoch 13, cost -83.8906892109
Pre-training layer 0, epoch 14, cost -83.3396957779
Pre-training layer 0, epoch 15, cost -82.8602912045
Pre-training layer 0, epoch 15, representative training free energy -451.378494965
Pre-training layer 0, epoch 15, validation free energy -445.768120575
Pre-training layer 0, epoch 16, cost -82.4562421036
Pre-training layer 0, epoch 17, cost -82.1760895157
Pre-training layer 0, epoch 18, cost -81.5579386997
Pre-training layer 0, epoch 19, cost -81.137741127
Pre-training layer 0, epoch 20, cost -80.9392268467
Pre-training layer 0, epoch 20, representative training free energy -444.074974091
Pre-training layer 0, epoch 20, validation free energy -438.100284485
Pre-training layer 0, epoch 21, cost -80.6267226791
Pre-training layer 0, epoch 22, cost -80.3612105274
Pre-training layer 0, epoch 23, cost -79.9521786404
Pre-training layer 0, epoch 24, cost -79.7554657364
Pre-training layer 0, epoch 25, cost -79.4207795048
Pre-training layer 0, epoch 25, representative training free energy -439.896835602
Pre-training layer 0, epoch 25, validation free energy -433.962331787
Pre-training layer 0, epoch 26, cost -79.1394778633
Pre-training layer 0, epoch 27, cost -79.033340292
Pre-training layer 0, epoch 28, cost -78.6988955784
Pre-training layer 0, epoch 29, cost -78.4597907448
Pre-training layer 0, epoch 30, cost -78.4118080902
Pre-training layer 0, epoch 30, representative training free energy -435.669532806
Pre-training layer 0, epoch 30, validation free energy -429.52412265
Pre-training layer 0, epoch 31, cost -78.1648340034
Pre-training layer 0, epoch 32, cost -77.9756730747
Pre-training layer 0, epoch 33, cost -77.6631506252
Pre-training layer 0, epoch 34, cost -77.6065263367
Pre-training layer 0, epoch 35, cost -77.3211418247
Pre-training layer 0, epoch 35, representative training free energy -432.883566925
Pre-training layer 0, epoch 35, validation free energy -425.850362305
Pre-training layer 0, epoch 36, cost -77.4230625057
Pre-training layer 0, epoch 37, cost -77.0829927444
Pre-training layer 0, epoch 38, cost -77.1110779858
Pre-training layer 0, epoch 39, cost -76.7979432869
Pre-training layer 0, epoch 40, cost -76.6236195469
Pre-training layer 0, epoch 40, representative training free energy -432.203500549
Pre-training layer 0, epoch 40, validation free energy -425.618012024
Pre-training layer 0, epoch 41, cost -76.5910858822
Pre-training layer 0, epoch 42, cost -76.4328779411
Pre-training layer 0, epoch 43, cost -76.3047108173
Pre-training layer 0, epoch 44, cost -76.1192893982
Pre-training layer 0, epoch 45, cost -75.9802153778
Pre-training layer 0, epoch 45, representative training free energy -427.008530731
Pre-training layer 0, epoch 45, validation free energy -419.982566956
Pre-training layer 0, epoch 46, cost -75.9879445076
Pre-training layer 0, epoch 47, cost -75.895378809
Pre-training layer 0, epoch 48, cost -75.6390372372
Pre-training layer 0, epoch 49, cost -75.605220747
Pre-training layer 0, epoch 50, cost -75.4872782898
Pre-training layer 0, epoch 50, representative training free energy -427.072218445
Pre-training layer 0, epoch 50, validation free energy -420.715648132
Pre-training layer 0, epoch 51, cost -75.4291933441
Pre-training layer 0, epoch 52, cost -75.3206863785
Pre-training layer 0, epoch 53, cost -75.2862668705
Pre-training layer 0, epoch 54, cost -75.0998320389
Pre-training layer 0, epoch 55, cost -75.1086308765
Pre-training layer 0, epoch 55, representative training free energy -427.189095154
Pre-training layer 0, epoch 55, validation free energy -419.614269928
Pre-training layer 0, epoch 56, cost -74.973158474
Pre-training layer 0, epoch 57, cost -74.8424304771
Pre-training layer 0, epoch 58, cost -74.6778602409
Pre-training layer 0, epoch 59, cost -74.711493597
Pre-training layer 0, epoch 60, cost -74.6707737064
Pre-training layer 0, epoch 60, representative training free energy -423.162300446
Pre-training layer 0, epoch 60, validation free energy -415.560172363
Pre-training layer 0, epoch 61, cost -74.489987011
Pre-training layer 0, epoch 62, cost -74.4160014629
Pre-training layer 0, epoch 63, cost -74.4264650726
Pre-training layer 0, epoch 64, cost -74.3060439682
Pre-training layer 0, epoch 65, cost -74.1781059456
Pre-training layer 0, epoch 65, representative training free energy -425.463272095
Pre-training layer 0, epoch 65, validation free energy -418.183548279
Pre-training layer 0, epoch 66, cost -74.0472248745
Pre-training layer 0, epoch 67, cost -73.9443825054
Pre-training layer 0, epoch 68, cost -74.0706763172
Pre-training layer 0, epoch 69, cost -73.9566605663
Pre-training layer 0, epoch 70, cost -73.8635661316
Pre-training layer 0, epoch 70, representative training free energy -420.26146286
Pre-training layer 0, epoch 70, validation free energy -412.454382324
Pre-training layer 0, epoch 71, cost -73.8138966274
Pre-training layer 0, epoch 72, cost -73.6821193123
Pre-training layer 0, epoch 73, cost -73.687689867
Pre-training layer 0, epoch 74, cost -73.6678764439
Pre-training layer 0, epoch 75, cost -73.5595642376
Pre-training layer 0, epoch 75, representative training free energy -421.385896698
Pre-training layer 0, epoch 75, validation free energy -413.359999908
Pre-training layer 0, epoch 76, cost -73.4944579029
Pre-training layer 0, epoch 77, cost -73.4337084675
Pre-training layer 0, epoch 78, cost -73.3499523544
Pre-training layer 0, epoch 79, cost -73.3297114372
Pre-training layer 0, epoch 80, cost -73.2368740845
Pre-training layer 0, epoch 80, representative training free energy -418.696799866
Pre-training layer 0, epoch 80, validation free energy -411.124988464
Pre-training layer 0, epoch 81, cost -73.3344025612
Pre-training layer 0, epoch 82, cost -73.106061964
Pre-training layer 0, epoch 83, cost -73.1318626404
Pre-training layer 0, epoch 84, cost -73.0550624371
Pre-training layer 0, epoch 85, cost -73.0140134144
Pre-training layer 0, epoch 85, representative training free energy -418.864937134
Pre-training layer 0, epoch 85, validation free energy -410.297821289
Pre-training layer 0, epoch 86, cost -72.8334773636
Pre-training layer 0, epoch 87, cost -72.8802159119
Pre-training layer 0, epoch 88, cost -72.8667040253
Pre-training layer 0, epoch 89, cost -72.6939975834
Pre-training layer 0, epoch 90, cost -72.6824226952
Pre-training layer 0, epoch 90, representative training free energy -417.473094116
Pre-training layer 0, epoch 90, validation free energy -409.067048584
Pre-training layer 0, epoch 91, cost -72.7680125999
Pre-training layer 0, epoch 92, cost -72.6141085052
Pre-training layer 0, epoch 93, cost -72.6977273655
Pre-training layer 0, epoch 94, cost -72.467020874
Pre-training layer 0, epoch 95, cost -72.4903458977
Pre-training layer 0, epoch 95, representative training free energy -418.785198395
Pre-training layer 0, epoch 95, validation free energy -409.457285889
Pre-training layer 0, epoch 96, cost -72.4094355488
Pre-training layer 0, epoch 97, cost -72.4049355125
Pre-training layer 0, epoch 98, cost -72.3152292728
Pre-training layer 0, epoch 99, cost -72.3499362183
Pre-training layer 1, epoch 0, cost -324.952464752
Pre-training layer 1, epoch 0, representative training free energy -58360.6723477
Pre-training layer 1, epoch 0, validation free energy -57759.1162246
Pre-training layer 1, epoch 1, cost -279.290666046
Pre-training layer 1, epoch 2, cost -265.34211277
Pre-training layer 1, epoch 3, cost -257.234115028
Pre-training layer 1, epoch 4, cost -251.648578491
Pre-training layer 1, epoch 5, cost -247.634515724
Pre-training layer 1, epoch 5, representative training free energy -78431.1319473
Pre-training layer 1, epoch 5, validation free energy -77589.4279336
Pre-training layer 1, epoch 6, cost -244.33648159
Pre-training layer 1, epoch 7, cost -241.894746704
Pre-training layer 1, epoch 8, cost -239.718504372
Pre-training layer 1, epoch 9, cost -238.012627029
Pre-training layer 1, epoch 10, cost -236.27433754
Pre-training layer 1, epoch 10, representative training free energy -84558.3812949
Pre-training layer 1, epoch 10, validation free energy -83616.0813887
Pre-training layer 1, epoch 11, cost -235.247980881
Pre-training layer 1, epoch 12, cost -233.975196419
Pre-training layer 1, epoch 13, cost -232.887054253
Pre-training layer 1, epoch 14, cost -232.064638443
Pre-training layer 1, epoch 15, cost -231.201381226
Pre-training layer 1, epoch 15, representative training free energy -88046.9683887
Pre-training layer 1, epoch 15, validation free energy -87065.3519473
Pre-training layer 1, epoch 16, cost -230.486058655
Pre-training layer 1, epoch 17, cost -229.795340919
Pre-training layer 1, epoch 18, cost -229.181859016
Pre-training layer 1, epoch 19, cost -228.613741646
Pre-training layer 1, epoch 20, cost -228.151987305
Pre-training layer 1, epoch 20, representative training free energy -90723.9209941
Pre-training layer 1, epoch 20, validation free energy -89704.257832
Pre-training layer 1, epoch 21, cost -227.541785278
Pre-training layer 1, epoch 22, cost -227.243708878
Pre-training layer 1, epoch 23, cost -226.804329262
Pre-training layer 1, epoch 24, cost -226.312395706
Pre-training layer 1, epoch 25, cost -225.993406525
Pre-training layer 1, epoch 25, representative training free energy -92639.1706719
Pre-training layer 1, epoch 25, validation free energy -91591.8167539
Pre-training layer 1, epoch 26, cost -225.599236794
Pre-training layer 1, epoch 27, cost -225.363070869
Pre-training layer 1, epoch 28, cost -225.010438347
Pre-training layer 1, epoch 29, cost -224.705485535
Pre-training layer 1, epoch 30, cost -224.429031906
Pre-training layer 1, epoch 30, representative training free energy -94264.7114102
Pre-training layer 1, epoch 30, validation free energy -93206.4424063
Pre-training layer 1, epoch 31, cost -224.041821518
Pre-training layer 1, epoch 32, cost -223.801365814
Pre-training layer 1, epoch 33, cost -223.650676117
Pre-training layer 1, epoch 34, cost -223.341783524
Pre-training layer 1, epoch 35, cost -223.182467842
Pre-training layer 1, epoch 35, representative training free energy -95736.0654043
Pre-training layer 1, epoch 35, validation free energy -94651.232373
Pre-training layer 1, epoch 36, cost -222.859507866
Pre-training layer 1, epoch 37, cost -222.71214386
Pre-training layer 1, epoch 38, cost -222.559670906
Pre-training layer 1, epoch 39, cost -222.283719559
Pre-training layer 1, epoch 40, cost -222.200939789
Pre-training layer 1, epoch 40, representative training free energy -96946.1283652
Pre-training layer 1, epoch 40, validation free energy -95825.2447988
Pre-training layer 1, epoch 41, cost -221.95846962
Pre-training layer 1, epoch 42, cost -221.696125603
Pre-training layer 1, epoch 43, cost -221.704396935
Pre-training layer 1, epoch 44, cost -221.571170692
Pre-training layer 1, epoch 45, cost -221.363649979
Pre-training layer 1, epoch 45, representative training free energy -98085.7795293
Pre-training layer 1, epoch 45, validation free energy -96964.3038379
Pre-training layer 1, epoch 46, cost -221.105364532
Pre-training layer 1, epoch 47, cost -221.084322777
Pre-training layer 1, epoch 48, cost -220.910315628
Pre-training layer 1, epoch 49, cost -220.757906799
Pre-training layer 1, epoch 50, cost -220.53886982
Pre-training layer 1, epoch 50, representative training free energy -98975.2330039
Pre-training layer 1, epoch 50, validation free energy -97841.3472598
Pre-training layer 1, epoch 51, cost -220.474634857
Pre-training layer 1, epoch 52, cost -220.333945274
Pre-training layer 1, epoch 53, cost -220.220569077
Pre-training layer 1, epoch 54, cost -220.118379021
Pre-training layer 1, epoch 55, cost -220.059057007
Pre-training layer 1, epoch 55, representative training free energy -99861.0218008
Pre-training layer 1, epoch 55, validation free energy -98716.5800664
Pre-training layer 1, epoch 56, cost -219.792268486
Pre-training layer 1, epoch 57, cost -219.876028137
Pre-training layer 1, epoch 58, cost -219.664659271
Pre-training layer 1, epoch 59, cost -219.663106155
Pre-training layer 1, epoch 60, cost -219.426402283
Pre-training layer 1, epoch 60, representative training free energy -100558.534736
Pre-training layer 1, epoch 60, validation free energy -99402.2081387
Pre-training layer 1, epoch 61, cost -219.346036568
Pre-training layer 1, epoch 62, cost -219.258193283
Pre-training layer 1, epoch 63, cost -219.219631767
Pre-training layer 1, epoch 64, cost -219.091232262
Pre-training layer 1, epoch 65, cost -219.023972969
Pre-training layer 1, epoch 65, representative training free energy -101408.5514
Pre-training layer 1, epoch 65, validation free energy -100243.83249
Pre-training layer 1, epoch 66, cost -218.947530365
Pre-training layer 1, epoch 67, cost -218.908734283
Pre-training layer 1, epoch 68, cost -218.791460266
Pre-training layer 1, epoch 69, cost -218.77187767
Pre-training layer 1, epoch 70, cost -218.583633728
Pre-training layer 1, epoch 70, representative training free energy -102186.31408
Pre-training layer 1, epoch 70, validation free energy -101000.650781
Pre-training layer 1, epoch 71, cost -218.577539673
Pre-training layer 1, epoch 72, cost -218.412490501
Pre-training layer 1, epoch 73, cost -218.346559677
Pre-training layer 1, epoch 74, cost -218.306525993
Pre-training layer 1, epoch 75, cost -218.202431259
Pre-training layer 1, epoch 75, representative training free energy -102903.250789
Pre-training layer 1, epoch 75, validation free energy -101717.324145
Pre-training layer 1, epoch 76, cost -218.137258186
Pre-training layer 1, epoch 77, cost -218.083987389
Pre-training layer 1, epoch 78, cost -218.011705933
Pre-training layer 1, epoch 79, cost -217.984767494
Pre-training layer 1, epoch 80, cost -217.893847847
Pre-training layer 1, epoch 80, representative training free energy -103501.751004
Pre-training layer 1, epoch 80, validation free energy -102297.845621
Pre-training layer 1, epoch 81, cost -217.884117088
Pre-training layer 1, epoch 82, cost -217.744265862
Pre-training layer 1, epoch 83, cost -217.673146667
Pre-training layer 1, epoch 84, cost -217.67363842
Pre-training layer 1, epoch 85, cost -217.551851654
Pre-training layer 1, epoch 85, representative training free energy -104006.895705
Pre-training layer 1, epoch 85, validation free energy -102807.126598
Pre-training layer 1, epoch 86, cost -217.493474846
Pre-training layer 1, epoch 87, cost -217.458054504
Pre-training layer 1, epoch 88, cost -217.426699829
Pre-training layer 1, epoch 89, cost -217.39819603
Pre-training layer 1, epoch 90, cost -217.383816528
Pre-training layer 1, epoch 90, representative training free energy -104750.031371
Pre-training layer 1, epoch 90, validation free energy -103542.10059
Pre-training layer 1, epoch 91, cost -217.373402672
Pre-training layer 1, epoch 92, cost -217.184888306
Pre-training layer 1, epoch 93, cost -217.077696152
Pre-training layer 1, epoch 94, cost -216.990800171
Pre-training layer 1, epoch 95, cost -217.110816956
Pre-training layer 1, epoch 95, representative training free energy -105265.745254
Pre-training layer 1, epoch 95, validation free energy -104048.399035
Pre-training layer 1, epoch 96, cost -217.048276062
Pre-training layer 1, epoch 97, cost -216.920708389
Pre-training layer 1, epoch 98, cost -216.914300766
Pre-training layer 1, epoch 99, cost -216.74429287
Pre-training layer 2, epoch 0, cost -119.259367123
Pre-training layer 2, epoch 0, representative training free energy 3915.2470896
Pre-training layer 2, epoch 0, validation free energy 3849.42717456
Pre-training layer 2, epoch 1, cost -89.0428140545
Pre-training layer 2, epoch 2, cost -82.5484639263
Pre-training layer 2, epoch 3, cost -78.9381280231
Pre-training layer 2, epoch 4, cost -76.444518795
Pre-training layer 2, epoch 5, cost -74.5410243225
Pre-training layer 2, epoch 5, representative training free energy 5896.40823437
Pre-training layer 2, epoch 5, validation free energy 5824.27242859
Pre-training layer 2, epoch 6, cost -73.1210461426
Pre-training layer 2, epoch 7, cost -72.1001718616
Pre-training layer 2, epoch 8, cost -71.0964019012
Pre-training layer 2, epoch 9, cost -70.3100125408
Pre-training layer 2, epoch 10, cost -69.6387427235
Pre-training layer 2, epoch 10, representative training free energy 7034.28807251
Pre-training layer 2, epoch 10, validation free energy 6952.20552637
Pre-training layer 2, epoch 11, cost -68.9890074825
Pre-training layer 2, epoch 12, cost -68.4878371048
Pre-training layer 2, epoch 13, cost -68.0321064663
Pre-training layer 2, epoch 14, cost -67.5897012615
Pre-training layer 2, epoch 15, cost -67.2459067726
Pre-training layer 2, epoch 15, representative training free energy 7857.3156062
Pre-training layer 2, epoch 15, validation free energy 7765.8591272
Pre-training layer 2, epoch 16, cost -66.8121243668
Pre-training layer 2, epoch 17, cost -66.6150120831
Pre-training layer 2, epoch 18, cost -66.3247344685
Pre-training layer 2, epoch 19, cost -66.033637228
Pre-training layer 2, epoch 20, cost -65.8419242287
Pre-training layer 2, epoch 20, representative training free energy 8505.11946753
Pre-training layer 2, epoch 20, validation free energy 8412.78612402
Pre-training layer 2, epoch 21, cost -65.6042757797
Pre-training layer 2, epoch 22, cost -65.3531479645
Pre-training layer 2, epoch 23, cost -65.28042243
Pre-training layer 2, epoch 24, cost -65.0204624939
Pre-training layer 2, epoch 25, cost -64.8139681911
Pre-training layer 2, epoch 25, representative training free energy 9102.70384863
Pre-training layer 2, epoch 25, validation free energy 9005.94089966
Pre-training layer 2, epoch 26, cost -64.7583754158
Pre-training layer 2, epoch 27, cost -64.5700573158
Pre-training layer 2, epoch 28, cost -64.4793040466
Pre-training layer 2, epoch 29, cost -64.2613101292
Pre-training layer 2, epoch 30, cost -64.1281822777
Pre-training layer 2, epoch 30, representative training free energy 9558.979604
Pre-training layer 2, epoch 30, validation free energy 9453.94160889
Pre-training layer 2, epoch 31, cost -64.0431660557
Pre-training layer 2, epoch 32, cost -63.9222880936
Pre-training layer 2, epoch 33, cost -63.8221613407
Pre-training layer 2, epoch 34, cost -63.7851198864
Pre-training layer 2, epoch 35, cost -63.6369422531
Pre-training layer 2, epoch 35, representative training free energy 10004.9628855
Pre-training layer 2, epoch 35, validation free energy 9896.29740283
Pre-training layer 2, epoch 36, cost -63.5240086555
Pre-training layer 2, epoch 37, cost -63.5058426571
Pre-training layer 2, epoch 38, cost -63.4277750111
Pre-training layer 2, epoch 39, cost -63.3334843349
Pre-training layer 2, epoch 40, cost -63.3080016613
Pre-training layer 2, epoch 40, representative training free energy 10446.8653608
Pre-training layer 2, epoch 40, validation free energy 10330.8840193
Pre-training layer 2, epoch 41, cost -63.1266351604
Pre-training layer 2, epoch 42, cost -63.0827655315
Pre-training layer 2, epoch 43, cost -62.9906628799
Pre-training layer 2, epoch 44, cost -62.9122245884
Pre-training layer 2, epoch 45, cost -62.7755751991
Pre-training layer 2, epoch 45, representative training free energy 10829.1123254
Pre-training layer 2, epoch 45, validation free energy 10709.7723376
Pre-training layer 2, epoch 46, cost -62.8309125328
Pre-training layer 2, epoch 47, cost -62.6682079601
Pre-training layer 2, epoch 48, cost -62.7028493309
Pre-training layer 2, epoch 49, cost -62.5883628082
Pre-training layer 2, epoch 50, cost -62.6935825539
Pre-training layer 2, epoch 50, representative training free energy 11181.6032046
Pre-training layer 2, epoch 50, validation free energy 11060.6350752
Pre-training layer 2, epoch 51, cost -62.5089960766
Pre-training layer 2, epoch 52, cost -62.5058083057
Pre-training layer 2, epoch 53, cost -62.4229560089
Pre-training layer 2, epoch 54, cost -62.3881637001
Pre-training layer 2, epoch 55, cost -62.369003458
Pre-training layer 2, epoch 55, representative training free energy 11485.9342351
Pre-training layer 2, epoch 55, validation free energy 11361.1022161
Pre-training layer 2, epoch 56, cost -62.2610297775
Pre-training layer 2, epoch 57, cost -62.1912957287
Pre-training layer 2, epoch 58, cost -62.2403094769
Pre-training layer 2, epoch 59, cost -62.1013500595
Pre-training layer 2, epoch 60, cost -62.0967965794
Pre-training layer 2, epoch 60, representative training free energy 11847.669259
Pre-training layer 2, epoch 60, validation free energy 11718.7759153
Pre-training layer 2, epoch 61, cost -62.114187603
Pre-training layer 2, epoch 62, cost -62.1004471684
Pre-training layer 2, epoch 63, cost -62.0315534496
Pre-training layer 2, epoch 64, cost -61.9605417252
Pre-training layer 2, epoch 65, cost -61.9900749779
Pre-training layer 2, epoch 65, representative training free energy 12129.791519
Pre-training layer 2, epoch 65, validation free energy 11997.8246321
Pre-training layer 2, epoch 66, cost -61.9476485157
Pre-training layer 2, epoch 67, cost -61.9370927715
Pre-training layer 2, epoch 68, cost -61.8578970623
Pre-training layer 2, epoch 69, cost -61.8401395702
Pre-training layer 2, epoch 70, cost -61.7301752758
Pre-training layer 2, epoch 70, representative training free energy 12441.9158936
Pre-training layer 2, epoch 70, validation free energy 12303.6155161
Pre-training layer 2, epoch 71, cost -61.760491848
Pre-training layer 2, epoch 72, cost -61.6505366993
Pre-training layer 2, epoch 73, cost -61.7258599472
Pre-training layer 2, epoch 74, cost -61.6026207829
Pre-training layer 2, epoch 75, cost -61.6470712757
Pre-training layer 2, epoch 75, representative training free energy 12728.0412041
Pre-training layer 2, epoch 75, validation free energy 12589.4692393
Pre-training layer 2, epoch 76, cost -61.6214349747
Pre-training layer 2, epoch 77, cost -61.6240246868
Pre-training layer 2, epoch 78, cost -61.5186103535
Pre-training layer 2, epoch 79, cost -61.5689481926
Pre-training layer 2, epoch 80, cost -61.4817291355
Pre-training layer 2, epoch 80, representative training free energy 13034.7586372
Pre-training layer 2, epoch 80, validation free energy 12890.053103
Pre-training layer 2, epoch 81, cost -61.3689133358
Pre-training layer 2, epoch 82, cost -61.4860474586
Pre-training layer 2, epoch 83, cost -61.462403307
Pre-training layer 2, epoch 84, cost -61.3064932919
Pre-training layer 2, epoch 85, cost -61.3704034519
Pre-training layer 2, epoch 85, representative training free energy 13298.2302153
Pre-training layer 2, epoch 85, validation free energy 13154.3564424
Pre-training layer 2, epoch 86, cost -61.3598434067
Pre-training layer 2, epoch 87, cost -61.3868501663
Pre-training layer 2, epoch 88, cost -61.2562693024
Pre-training layer 2, epoch 89, cost -61.3095703793
Pre-training layer 2, epoch 90, cost -61.255164957
Pre-training layer 2, epoch 90, representative training free energy 13571.5329771
Pre-training layer 2, epoch 90, validation free energy 13425.8554756
Pre-training layer 2, epoch 91, cost -61.2961081219
Pre-training layer 2, epoch 92, cost -61.2258790493
Pre-training layer 2, epoch 93, cost -61.2108248901
Pre-training layer 2, epoch 94, cost -61.1456414604
Pre-training layer 2, epoch 95, cost -61.1141538239
Pre-training layer 2, epoch 95, representative training free energy 13827.8134072
Pre-training layer 2, epoch 95, validation free energy 13675.6779507
Pre-training layer 2, epoch 96, cost -61.0837449074
Pre-training layer 2, epoch 97, cost -61.0289045429
Pre-training layer 2, epoch 98, cost -61.0610026073
Pre-training layer 2, epoch 99, cost -61.0620724678
The pretraining code for file dbn_loop.pyc ran for 3.75m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 9.700000 %
     epoch 1, minibatch 400/400, test error of best model 9.700000 %
epoch 2, minibatch 400/400, validation error 8.600000 %
     epoch 2, minibatch 400/400, test error of best model 8.100000 %
epoch 3, minibatch 400/400, validation error 8.100000 %
     epoch 3, minibatch 400/400, test error of best model 7.800000 %
epoch 4, minibatch 400/400, validation error 7.700000 %
     epoch 4, minibatch 400/400, test error of best model 7.200000 %
epoch 5, minibatch 400/400, validation error 7.400000 %
     epoch 5, minibatch 400/400, test error of best model 6.900000 %
epoch 6, minibatch 400/400, validation error 7.200000 %
     epoch 6, minibatch 400/400, test error of best model 6.900000 %
epoch 7, minibatch 400/400, validation error 7.000000 %
     epoch 7, minibatch 400/400, test error of best model 6.500000 %
epoch 8, minibatch 400/400, validation error 6.800000 %
     epoch 8, minibatch 400/400, test error of best model 6.500000 %
epoch 9, minibatch 400/400, validation error 6.400000 %
     epoch 9, minibatch 400/400, test error of best model 6.600000 %
epoch 10, minibatch 400/400, validation error 6.200000 %
     epoch 10, minibatch 400/400, test error of best model 6.400000 %
epoch 11, minibatch 400/400, validation error 6.100000 %
     epoch 11, minibatch 400/400, test error of best model 6.200000 %
epoch 12, minibatch 400/400, validation error 5.900000 %
     epoch 12, minibatch 400/400, test error of best model 6.100000 %
epoch 13, minibatch 400/400, validation error 5.800000 %
     epoch 13, minibatch 400/400, test error of best model 6.200000 %
epoch 14, minibatch 400/400, validation error 5.700000 %
     epoch 14, minibatch 400/400, test error of best model 6.300000 %
epoch 15, minibatch 400/400, validation error 5.600000 %
     epoch 15, minibatch 400/400, test error of best model 6.400000 %
epoch 16, minibatch 400/400, validation error 5.700000 %
epoch 17, minibatch 400/400, validation error 5.700000 %
epoch 18, minibatch 400/400, validation error 5.700000 %
epoch 19, minibatch 400/400, validation error 5.800000 %
epoch 20, minibatch 400/400, validation error 5.900000 %
epoch 21, minibatch 400/400, validation error 5.900000 %
epoch 22, minibatch 400/400, validation error 5.800000 %
epoch 23, minibatch 400/400, validation error 5.800000 %
epoch 24, minibatch 400/400, validation error 5.800000 %
epoch 25, minibatch 400/400, validation error 5.600000 %
epoch 26, minibatch 400/400, validation error 5.700000 %
epoch 27, minibatch 400/400, validation error 5.800000 %
epoch 28, minibatch 400/400, validation error 5.800000 %
epoch 29, minibatch 400/400, validation error 5.800000 %
Optimization complete with best validation score of 5.600000 %, obtained at iteration 6000, with test performance 6.400000 %
The fine tuning code for file dbn_loop.pyc ran for 0.51m
_______RUN: 1

==========Sample Size: (1000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -183.877061005
Pre-training layer 0, epoch 0, representative training free energy -593.391059509
Pre-training layer 0, epoch 0, validation free energy -587.076457764
Pre-training layer 0, epoch 1, cost -135.056906815
Pre-training layer 0, epoch 2, cost -123.549293289
Pre-training layer 0, epoch 3, cost -117.137329254
Pre-training layer 0, epoch 4, cost -112.464418182
Pre-training layer 0, epoch 5, cost -108.643423309
Pre-training layer 0, epoch 5, representative training free energy -550.200429687
Pre-training layer 0, epoch 5, validation free energy -538.885468262
Pre-training layer 0, epoch 6, cost -105.721955719
Pre-training layer 0, epoch 7, cost -103.50432869
Pre-training layer 0, epoch 8, cost -101.436107635
Pre-training layer 0, epoch 9, cost -99.9087403107
Pre-training layer 0, epoch 10, cost -98.3433179474
Pre-training layer 0, epoch 10, representative training free energy -535.791463684
Pre-training layer 0, epoch 10, validation free energy -522.829308624
Pre-training layer 0, epoch 11, cost -96.9488090515
Pre-training layer 0, epoch 12, cost -95.498860321
Pre-training layer 0, epoch 13, cost -94.7746295929
Pre-training layer 0, epoch 14, cost -93.5308646393
Pre-training layer 0, epoch 15, cost -92.6276533508
Pre-training layer 0, epoch 15, representative training free energy -520.651817871
Pre-training layer 0, epoch 15, validation free energy -506.44476593
Pre-training layer 0, epoch 16, cost -92.1213928986
Pre-training layer 0, epoch 17, cost -91.4508740997
Pre-training layer 0, epoch 18, cost -90.3675769043
Pre-training layer 0, epoch 19, cost -89.7885906219
Pre-training layer 0, epoch 20, cost -89.1129627991
Pre-training layer 0, epoch 20, representative training free energy -512.707023651
Pre-training layer 0, epoch 20, validation free energy -498.187641113
Pre-training layer 0, epoch 21, cost -88.640759201
Pre-training layer 0, epoch 22, cost -87.7891280365
Pre-training layer 0, epoch 23, cost -87.1026689148
Pre-training layer 0, epoch 24, cost -86.7767167664
Pre-training layer 0, epoch 25, cost -86.2491881561
Pre-training layer 0, epoch 25, representative training free energy -509.304447388
Pre-training layer 0, epoch 25, validation free energy -493.252440613
Pre-training layer 0, epoch 26, cost -86.3116143799
Pre-training layer 0, epoch 27, cost -85.4856574249
Pre-training layer 0, epoch 28, cost -84.9118241882
Pre-training layer 0, epoch 29, cost -84.5809629059
Pre-training layer 0, epoch 30, cost -84.2253421021
Pre-training layer 0, epoch 30, representative training free energy -500.707480103
Pre-training layer 0, epoch 30, validation free energy -485.672346039
Pre-training layer 0, epoch 31, cost -83.9597822571
Pre-training layer 0, epoch 32, cost -83.7908622742
Pre-training layer 0, epoch 33, cost -83.2049332428
Pre-training layer 0, epoch 34, cost -82.9396656036
Pre-training layer 0, epoch 35, cost -82.467068634
Pre-training layer 0, epoch 35, representative training free energy -499.860270569
Pre-training layer 0, epoch 35, validation free energy -483.568971558
Pre-training layer 0, epoch 36, cost -82.5119815063
Pre-training layer 0, epoch 37, cost -81.9342694092
Pre-training layer 0, epoch 38, cost -82.0992674255
Pre-training layer 0, epoch 39, cost -81.608846283
Pre-training layer 0, epoch 40, cost -81.1654383087
Pre-training layer 0, epoch 40, representative training free energy -495.121969604
Pre-training layer 0, epoch 40, validation free energy -478.762290161
Pre-training layer 0, epoch 41, cost -80.9142784119
Pre-training layer 0, epoch 42, cost -80.8668965149
Pre-training layer 0, epoch 43, cost -80.7322301483
Pre-training layer 0, epoch 44, cost -80.3646303558
Pre-training layer 0, epoch 45, cost -80.1824150085
Pre-training layer 0, epoch 45, representative training free energy -490.552343567
Pre-training layer 0, epoch 45, validation free energy -472.864728394
Pre-training layer 0, epoch 46, cost -79.9065457916
Pre-training layer 0, epoch 47, cost -79.5967816162
Pre-training layer 0, epoch 48, cost -79.4498779297
Pre-training layer 0, epoch 49, cost -79.3129409027
Pre-training layer 0, epoch 50, cost -79.1019515991
Pre-training layer 0, epoch 50, representative training free energy -488.082140747
Pre-training layer 0, epoch 50, validation free energy -470.675017822
Pre-training layer 0, epoch 51, cost -78.8800366211
Pre-training layer 0, epoch 52, cost -78.5621977234
Pre-training layer 0, epoch 53, cost -78.5763525391
Pre-training layer 0, epoch 54, cost -78.6129528809
Pre-training layer 0, epoch 55, cost -78.1358873749
Pre-training layer 0, epoch 55, representative training free energy -483.832940552
Pre-training layer 0, epoch 55, validation free energy -466.291662231
Pre-training layer 0, epoch 56, cost -78.2947181702
Pre-training layer 0, epoch 57, cost -77.8976895142
Pre-training layer 0, epoch 58, cost -77.7444126511
Pre-training layer 0, epoch 59, cost -77.5221094894
Pre-training layer 0, epoch 60, cost -77.508401413
Pre-training layer 0, epoch 60, representative training free energy -479.571104919
Pre-training layer 0, epoch 60, validation free energy -461.570468689
Pre-training layer 0, epoch 61, cost -77.2638422775
Pre-training layer 0, epoch 62, cost -77.1586833954
Pre-training layer 0, epoch 63, cost -77.2876361847
Pre-training layer 0, epoch 64, cost -76.8310634613
Pre-training layer 0, epoch 65, cost -76.6555721283
Pre-training layer 0, epoch 65, representative training free energy -481.271981567
Pre-training layer 0, epoch 65, validation free energy -462.992458282
Pre-training layer 0, epoch 66, cost -76.7508685303
Pre-training layer 0, epoch 67, cost -76.3050180817
Pre-training layer 0, epoch 68, cost -76.2120588684
Pre-training layer 0, epoch 69, cost -76.2951386261
Pre-training layer 0, epoch 70, cost -76.0889578247
Pre-training layer 0, epoch 70, representative training free energy -477.887450226
Pre-training layer 0, epoch 70, validation free energy -459.452740631
Pre-training layer 0, epoch 71, cost -75.9114777756
Pre-training layer 0, epoch 72, cost -75.7306904984
Pre-training layer 0, epoch 73, cost -75.6446626282
Pre-training layer 0, epoch 74, cost -75.5065750885
Pre-training layer 0, epoch 75, cost -75.5357000732
Pre-training layer 0, epoch 75, representative training free energy -476.047909424
Pre-training layer 0, epoch 75, validation free energy -456.645140137
Pre-training layer 0, epoch 76, cost -75.2682920074
Pre-training layer 0, epoch 77, cost -75.2821203613
Pre-training layer 0, epoch 78, cost -75.2258151627
Pre-training layer 0, epoch 79, cost -75.1241765213
Pre-training layer 0, epoch 80, cost -74.8047607422
Pre-training layer 0, epoch 80, representative training free energy -474.625718933
Pre-training layer 0, epoch 80, validation free energy -455.387974243
Pre-training layer 0, epoch 81, cost -74.9244669342
Pre-training layer 0, epoch 82, cost -74.7386276627
Pre-training layer 0, epoch 83, cost -74.7120688248
Pre-training layer 0, epoch 84, cost -74.5497108841
Pre-training layer 0, epoch 85, cost -74.3665858841
Pre-training layer 0, epoch 85, representative training free energy -476.240441345
Pre-training layer 0, epoch 85, validation free energy -456.351378662
Pre-training layer 0, epoch 86, cost -74.5896098709
Pre-training layer 0, epoch 87, cost -74.3779352188
Pre-training layer 0, epoch 88, cost -74.3089047623
Pre-training layer 0, epoch 89, cost -74.2789054871
Pre-training layer 0, epoch 90, cost -73.9940322495
Pre-training layer 0, epoch 90, representative training free energy -472.531184448
Pre-training layer 0, epoch 90, validation free energy -451.77346402
Pre-training layer 0, epoch 91, cost -74.0395172501
Pre-training layer 0, epoch 92, cost -73.9404924011
Pre-training layer 0, epoch 93, cost -73.741608429
Pre-training layer 0, epoch 94, cost -73.845644455
Pre-training layer 0, epoch 95, cost -73.8405592346
Pre-training layer 0, epoch 95, representative training free energy -471.991901947
Pre-training layer 0, epoch 95, validation free energy -452.455461304
Pre-training layer 0, epoch 96, cost -73.4677011871
Pre-training layer 0, epoch 97, cost -73.5182908249
Pre-training layer 0, epoch 98, cost -73.4516270447
Pre-training layer 0, epoch 99, cost -73.5955596542
Pre-training layer 1, epoch 0, cost -432.282136841
Pre-training layer 1, epoch 0, representative training free energy -32878.4633643
Pre-training layer 1, epoch 0, validation free energy -32399.5768789
Pre-training layer 1, epoch 1, cost -370.438262024
Pre-training layer 1, epoch 2, cost -350.267368164
Pre-training layer 1, epoch 3, cost -338.691497192
Pre-training layer 1, epoch 4, cost -330.455057678
Pre-training layer 1, epoch 5, cost -324.533711548
Pre-training layer 1, epoch 5, representative training free energy -47200.7734756
Pre-training layer 1, epoch 5, validation free energy -46623.3139893
Pre-training layer 1, epoch 6, cost -319.188344421
Pre-training layer 1, epoch 7, cost -315.467632141
Pre-training layer 1, epoch 8, cost -312.073990173
Pre-training layer 1, epoch 9, cost -309.196562805
Pre-training layer 1, epoch 10, cost -306.138141174
Pre-training layer 1, epoch 10, representative training free energy -51506.1353574
Pre-training layer 1, epoch 10, validation free energy -50923.8117344
Pre-training layer 1, epoch 11, cost -304.165613708
Pre-training layer 1, epoch 12, cost -301.951818542
Pre-training layer 1, epoch 13, cost -300.563786011
Pre-training layer 1, epoch 14, cost -298.331397247
Pre-training layer 1, epoch 15, cost -297.040619812
Pre-training layer 1, epoch 15, representative training free energy -54068.9334336
Pre-training layer 1, epoch 15, validation free energy -53474.0280605
Pre-training layer 1, epoch 16, cost -295.918467407
Pre-training layer 1, epoch 17, cost -294.294797363
Pre-training layer 1, epoch 18, cost -293.18375351
Pre-training layer 1, epoch 19, cost -292.082795258
Pre-training layer 1, epoch 20, cost -291.24111084
Pre-training layer 1, epoch 20, representative training free energy -55800.2310732
Pre-training layer 1, epoch 20, validation free energy -55203.1714893
Pre-training layer 1, epoch 21, cost -290.081219482
Pre-training layer 1, epoch 22, cost -289.313644409
Pre-training layer 1, epoch 23, cost -288.394806061
Pre-training layer 1, epoch 24, cost -287.47056778
Pre-training layer 1, epoch 25, cost -286.967058411
Pre-training layer 1, epoch 25, representative training free energy -57139.2572158
Pre-training layer 1, epoch 25, validation free energy -56540.181252
Pre-training layer 1, epoch 26, cost -286.324276733
Pre-training layer 1, epoch 27, cost -285.517210999
Pre-training layer 1, epoch 28, cost -285.025224762
Pre-training layer 1, epoch 29, cost -284.346399994
Pre-training layer 1, epoch 30, cost -283.905028992
Pre-training layer 1, epoch 30, representative training free energy -58183.4638975
Pre-training layer 1, epoch 30, validation free energy -57583.7624063
Pre-training layer 1, epoch 31, cost -283.467898712
Pre-training layer 1, epoch 32, cost -282.76582962
Pre-training layer 1, epoch 33, cost -282.209330292
Pre-training layer 1, epoch 34, cost -281.604799652
Pre-training layer 1, epoch 35, cost -281.252499084
Pre-training layer 1, epoch 35, representative training free energy -59131.0792803
Pre-training layer 1, epoch 35, validation free energy -58519.1418203
Pre-training layer 1, epoch 36, cost -280.944670868
Pre-training layer 1, epoch 37, cost -280.639674988
Pre-training layer 1, epoch 38, cost -280.001244202
Pre-training layer 1, epoch 39, cost -279.667286682
Pre-training layer 1, epoch 40, cost -279.381875916
Pre-training layer 1, epoch 40, representative training free energy -59923.816041
Pre-training layer 1, epoch 40, validation free energy -59310.9564434
Pre-training layer 1, epoch 41, cost -279.042741547
Pre-training layer 1, epoch 42, cost -278.596430664
Pre-training layer 1, epoch 43, cost -278.20825531
Pre-training layer 1, epoch 44, cost -278.125953217
Pre-training layer 1, epoch 45, cost -277.709007263
Pre-training layer 1, epoch 45, representative training free energy -60654.8821484
Pre-training layer 1, epoch 45, validation free energy -60041.7407617
Pre-training layer 1, epoch 46, cost -277.387880249
Pre-training layer 1, epoch 47, cost -277.097765808
Pre-training layer 1, epoch 48, cost -276.98578537
Pre-training layer 1, epoch 49, cost -276.401576385
Pre-training layer 1, epoch 50, cost -276.459983826
Pre-training layer 1, epoch 50, representative training free energy -61252.2311777
Pre-training layer 1, epoch 50, validation free energy -60649.1303359
Pre-training layer 1, epoch 51, cost -275.85895462
Pre-training layer 1, epoch 52, cost -275.75165329
Pre-training layer 1, epoch 53, cost -275.444109192
Pre-training layer 1, epoch 54, cost -275.223603363
Pre-training layer 1, epoch 55, cost -274.895988922
Pre-training layer 1, epoch 55, representative training free energy -61817.0065508
Pre-training layer 1, epoch 55, validation free energy -61209.0445059
Pre-training layer 1, epoch 56, cost -274.954537048
Pre-training layer 1, epoch 57, cost -274.525308228
Pre-training layer 1, epoch 58, cost -274.273301849
Pre-training layer 1, epoch 59, cost -274.246762543
Pre-training layer 1, epoch 60, cost -273.966977386
Pre-training layer 1, epoch 60, representative training free energy -62293.2289688
Pre-training layer 1, epoch 60, validation free energy -61681.9203516
Pre-training layer 1, epoch 61, cost -273.892117767
Pre-training layer 1, epoch 62, cost -273.568526001
Pre-training layer 1, epoch 63, cost -273.469090424
Pre-training layer 1, epoch 64, cost -273.436939087
Pre-training layer 1, epoch 65, cost -272.945081177
Pre-training layer 1, epoch 65, representative training free energy -62788.418623
Pre-training layer 1, epoch 65, validation free energy -62179.9850918
Pre-training layer 1, epoch 66, cost -272.924533386
Pre-training layer 1, epoch 67, cost -272.777489319
Pre-training layer 1, epoch 68, cost -272.64594162
Pre-training layer 1, epoch 69, cost -272.561676941
Pre-training layer 1, epoch 70, cost -272.283419647
Pre-training layer 1, epoch 70, representative training free energy -63225.1445586
Pre-training layer 1, epoch 70, validation free energy -62613.1270879
Pre-training layer 1, epoch 71, cost -272.019880676
Pre-training layer 1, epoch 72, cost -271.980849152
Pre-training layer 1, epoch 73, cost -271.914373474
Pre-training layer 1, epoch 74, cost -271.711831512
Pre-training layer 1, epoch 75, cost -271.671015015
Pre-training layer 1, epoch 75, representative training free energy -63571.275834
Pre-training layer 1, epoch 75, validation free energy -62956.5994414
Pre-training layer 1, epoch 76, cost -271.498919678
Pre-training layer 1, epoch 77, cost -271.091758423
Pre-training layer 1, epoch 78, cost -271.18118454
Pre-training layer 1, epoch 79, cost -271.064215851
Pre-training layer 1, epoch 80, cost -270.886869049
Pre-training layer 1, epoch 80, representative training free energy -63923.5896602
Pre-training layer 1, epoch 80, validation free energy -63310.0476602
Pre-training layer 1, epoch 81, cost -270.86202713
Pre-training layer 1, epoch 82, cost -270.7071492
Pre-training layer 1, epoch 83, cost -270.561598816
Pre-training layer 1, epoch 84, cost -270.610864258
Pre-training layer 1, epoch 85, cost -270.42737381
Pre-training layer 1, epoch 85, representative training free energy -64410.7592285
Pre-training layer 1, epoch 85, validation free energy -63792.5854824
Pre-training layer 1, epoch 86, cost -270.247649231
Pre-training layer 1, epoch 87, cost -270.134357758
Pre-training layer 1, epoch 88, cost -269.945666504
Pre-training layer 1, epoch 89, cost -270.054904175
Pre-training layer 1, epoch 90, cost -269.865121765
Pre-training layer 1, epoch 90, representative training free energy -64631.9911953
Pre-training layer 1, epoch 90, validation free energy -64011.8402285
Pre-training layer 1, epoch 91, cost -269.850274658
Pre-training layer 1, epoch 92, cost -269.709360504
Pre-training layer 1, epoch 93, cost -269.548538055
Pre-training layer 1, epoch 94, cost -269.53572998
Pre-training layer 1, epoch 95, cost -269.362702026
Pre-training layer 1, epoch 95, representative training free energy -65024.5795605
Pre-training layer 1, epoch 95, validation free energy -64406.3926367
Pre-training layer 1, epoch 96, cost -269.110965881
Pre-training layer 1, epoch 97, cost -269.317129211
Pre-training layer 1, epoch 98, cost -269.165787354
Pre-training layer 1, epoch 99, cost -269.033815613
Pre-training layer 2, epoch 0, cost -161.888431778
Pre-training layer 2, epoch 0, representative training free energy 1709.75866165
Pre-training layer 2, epoch 0, validation free energy 1721.77536166
Pre-training layer 2, epoch 1, cost -108.158213654
Pre-training layer 2, epoch 2, cost -97.6801990509
Pre-training layer 2, epoch 3, cost -91.9555345154
Pre-training layer 2, epoch 4, cost -88.2800478363
Pre-training layer 2, epoch 5, cost -85.7232307434
Pre-training layer 2, epoch 5, representative training free energy 2544.24668542
Pre-training layer 2, epoch 5, validation free energy 2538.16600775
Pre-training layer 2, epoch 6, cost -83.5567890167
Pre-training layer 2, epoch 7, cost -81.5548438263
Pre-training layer 2, epoch 8, cost -80.2153887939
Pre-training layer 2, epoch 9, cost -78.9261560059
Pre-training layer 2, epoch 10, cost -77.7491509628
Pre-training layer 2, epoch 10, representative training free energy 2930.72019995
Pre-training layer 2, epoch 10, validation free energy 2902.35090454
Pre-training layer 2, epoch 11, cost -76.8173138809
Pre-training layer 2, epoch 12, cost -75.8505659866
Pre-training layer 2, epoch 13, cost -75.2724026108
Pre-training layer 2, epoch 14, cost -74.5242447662
Pre-training layer 2, epoch 15, cost -73.712587204
Pre-training layer 2, epoch 15, representative training free energy 3253.37235895
Pre-training layer 2, epoch 15, validation free energy 3206.64388037
Pre-training layer 2, epoch 16, cost -73.405845108
Pre-training layer 2, epoch 17, cost -72.7731304169
Pre-training layer 2, epoch 18, cost -72.2732159424
Pre-training layer 2, epoch 19, cost -71.8787221146
Pre-training layer 2, epoch 20, cost -71.3644776535
Pre-training layer 2, epoch 20, representative training free energy 3497.24940125
Pre-training layer 2, epoch 20, validation free energy 3454.36259723
Pre-training layer 2, epoch 21, cost -71.0611705399
Pre-training layer 2, epoch 22, cost -70.4188659286
Pre-training layer 2, epoch 23, cost -70.3429378128
Pre-training layer 2, epoch 24, cost -69.9185583878
Pre-training layer 2, epoch 25, cost -69.7130345535
Pre-training layer 2, epoch 25, representative training free energy 3718.01527094
Pre-training layer 2, epoch 25, validation free energy 3676.95753601
Pre-training layer 2, epoch 26, cost -69.4562704468
Pre-training layer 2, epoch 27, cost -69.1241194534
Pre-training layer 2, epoch 28, cost -68.7714167786
Pre-training layer 2, epoch 29, cost -68.8083951187
Pre-training layer 2, epoch 30, cost -68.4493093872
Pre-training layer 2, epoch 30, representative training free energy 3928.81631384
Pre-training layer 2, epoch 30, validation free energy 3883.26652008
Pre-training layer 2, epoch 31, cost -68.1928717804
Pre-training layer 2, epoch 32, cost -68.1244673157
Pre-training layer 2, epoch 33, cost -67.868115921
Pre-training layer 2, epoch 34, cost -67.5855727005
Pre-training layer 2, epoch 35, cost -67.4500061798
Pre-training layer 2, epoch 35, representative training free energy 4120.60637329
Pre-training layer 2, epoch 35, validation free energy 4072.28786023
Pre-training layer 2, epoch 36, cost -67.2799118805
Pre-training layer 2, epoch 37, cost -67.0142394638
Pre-training layer 2, epoch 38, cost -66.9434024811
Pre-training layer 2, epoch 39, cost -66.825136261
Pre-training layer 2, epoch 40, cost -66.6171047211
Pre-training layer 2, epoch 40, representative training free energy 4290.22505505
Pre-training layer 2, epoch 40, validation free energy 4239.07762122
Pre-training layer 2, epoch 41, cost -66.5445768738
Pre-training layer 2, epoch 42, cost -66.2725063324
Pre-training layer 2, epoch 43, cost -66.2436679459
Pre-training layer 2, epoch 44, cost -65.9882617187
Pre-training layer 2, epoch 45, cost -65.8651568604
Pre-training layer 2, epoch 45, representative training free energy 4457.74184924
Pre-training layer 2, epoch 45, validation free energy 4403.06645825
Pre-training layer 2, epoch 46, cost -65.703980217
Pre-training layer 2, epoch 47, cost -65.7446923065
Pre-training layer 2, epoch 48, cost -65.5281350708
Pre-training layer 2, epoch 49, cost -65.4656764221
Pre-training layer 2, epoch 50, cost -65.3439003754
Pre-training layer 2, epoch 50, representative training free energy 4594.01503113
Pre-training layer 2, epoch 50, validation free energy 4535.4730061
Pre-training layer 2, epoch 51, cost -65.2692159271
Pre-training layer 2, epoch 52, cost -65.2360428238
Pre-training layer 2, epoch 53, cost -65.0087305069
Pre-training layer 2, epoch 54, cost -64.9776413345
Pre-training layer 2, epoch 55, cost -64.7322885513
Pre-training layer 2, epoch 55, representative training free energy 4720.30591296
Pre-training layer 2, epoch 55, validation free energy 4659.88184473
Pre-training layer 2, epoch 56, cost -64.7167028046
Pre-training layer 2, epoch 57, cost -64.6899421692
Pre-training layer 2, epoch 58, cost -64.7437865448
Pre-training layer 2, epoch 59, cost -64.6918709183
Pre-training layer 2, epoch 60, cost -64.3817324829
Pre-training layer 2, epoch 60, representative training free energy 4853.49753198
Pre-training layer 2, epoch 60, validation free energy 4792.53588684
Pre-training layer 2, epoch 61, cost -64.3339989853
Pre-training layer 2, epoch 62, cost -64.3155733109
Pre-training layer 2, epoch 63, cost -64.3483764648
Pre-training layer 2, epoch 64, cost -64.04259552
Pre-training layer 2, epoch 65, cost -64.1045154572
Pre-training layer 2, epoch 65, representative training free energy 4964.70251526
Pre-training layer 2, epoch 65, validation free energy 4900.86292078
Pre-training layer 2, epoch 66, cost -64.0623854446
Pre-training layer 2, epoch 67, cost -63.8922444534
Pre-training layer 2, epoch 68, cost -63.9139864349
Pre-training layer 2, epoch 69, cost -63.9127684021
Pre-training layer 2, epoch 70, cost -63.7190364075
Pre-training layer 2, epoch 70, representative training free energy 5083.43979846
Pre-training layer 2, epoch 70, validation free energy 5014.67875684
Pre-training layer 2, epoch 71, cost -63.8612897491
Pre-training layer 2, epoch 72, cost -63.7868390274
Pre-training layer 2, epoch 73, cost -63.5880139542
Pre-training layer 2, epoch 74, cost -63.359000473
Pre-training layer 2, epoch 75, cost -63.3933586502
Pre-training layer 2, epoch 75, representative training free energy 5186.08914111
Pre-training layer 2, epoch 75, validation free energy 5117.91713977
Pre-training layer 2, epoch 76, cost -63.345502243
Pre-training layer 2, epoch 77, cost -63.4276488495
Pre-training layer 2, epoch 78, cost -63.1157344055
Pre-training layer 2, epoch 79, cost -63.3330703735
Pre-training layer 2, epoch 80, cost -63.1374946594
Pre-training layer 2, epoch 80, representative training free energy 5297.57244958
Pre-training layer 2, epoch 80, validation free energy 5220.50332202
Pre-training layer 2, epoch 81, cost -63.2318075943
Pre-training layer 2, epoch 82, cost -63.012211113
Pre-training layer 2, epoch 83, cost -63.1282911301
Pre-training layer 2, epoch 84, cost -63.1256997299
Pre-training layer 2, epoch 85, cost -63.0187326431
Pre-training layer 2, epoch 85, representative training free energy 5393.83934363
Pre-training layer 2, epoch 85, validation free energy 5319.88595837
Pre-training layer 2, epoch 86, cost -62.9046000671
Pre-training layer 2, epoch 87, cost -62.8077951813
Pre-training layer 2, epoch 88, cost -62.7823236465
Pre-training layer 2, epoch 89, cost -62.9069366837
Pre-training layer 2, epoch 90, cost -62.8078936768
Pre-training layer 2, epoch 90, representative training free energy 5494.40714429
Pre-training layer 2, epoch 90, validation free energy 5420.21917883
Pre-training layer 2, epoch 91, cost -62.6117365646
Pre-training layer 2, epoch 92, cost -62.545449028
Pre-training layer 2, epoch 93, cost -62.6848441315
Pre-training layer 2, epoch 94, cost -62.6841108322
Pre-training layer 2, epoch 95, cost -62.7842850876
Pre-training layer 2, epoch 95, representative training free energy 5592.49312585
Pre-training layer 2, epoch 95, validation free energy 5510.60576001
Pre-training layer 2, epoch 96, cost -62.6563546753
Pre-training layer 2, epoch 97, cost -62.5398022842
Pre-training layer 2, epoch 98, cost -62.4522859955
Pre-training layer 2, epoch 99, cost -62.5002534103
The pretraining code for file dbn_loop.pyc ran for 1.10m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 23.300000 %
     epoch 1, minibatch 100/100, test error of best model 24.100000 %
epoch 2, minibatch 100/100, validation error 17.800000 %
     epoch 2, minibatch 100/100, test error of best model 18.800000 %
epoch 3, minibatch 100/100, validation error 16.400000 %
     epoch 3, minibatch 100/100, test error of best model 17.300000 %
epoch 4, minibatch 100/100, validation error 16.100000 %
     epoch 4, minibatch 100/100, test error of best model 16.400000 %
epoch 5, minibatch 100/100, validation error 15.800000 %
     epoch 5, minibatch 100/100, test error of best model 15.900000 %
epoch 6, minibatch 100/100, validation error 14.900000 %
     epoch 6, minibatch 100/100, test error of best model 15.300000 %
epoch 7, minibatch 100/100, validation error 14.600000 %
     epoch 7, minibatch 100/100, test error of best model 14.600000 %
epoch 8, minibatch 100/100, validation error 14.400000 %
     epoch 8, minibatch 100/100, test error of best model 14.200000 %
epoch 9, minibatch 100/100, validation error 14.100000 %
     epoch 9, minibatch 100/100, test error of best model 14.300000 %
epoch 10, minibatch 100/100, validation error 13.500000 %
     epoch 10, minibatch 100/100, test error of best model 13.600000 %
epoch 11, minibatch 100/100, validation error 13.100000 %
     epoch 11, minibatch 100/100, test error of best model 13.400000 %
epoch 12, minibatch 100/100, validation error 12.800000 %
     epoch 12, minibatch 100/100, test error of best model 13.300000 %
epoch 13, minibatch 100/100, validation error 12.400000 %
     epoch 13, minibatch 100/100, test error of best model 13.400000 %
epoch 14, minibatch 100/100, validation error 12.500000 %
epoch 15, minibatch 100/100, validation error 12.100000 %
     epoch 15, minibatch 100/100, test error of best model 13.000000 %
epoch 16, minibatch 100/100, validation error 12.100000 %
     epoch 16, minibatch 100/100, test error of best model 13.000000 %
epoch 17, minibatch 100/100, validation error 11.900000 %
     epoch 17, minibatch 100/100, test error of best model 12.800000 %
epoch 18, minibatch 100/100, validation error 11.400000 %
     epoch 18, minibatch 100/100, test error of best model 12.800000 %
epoch 19, minibatch 100/100, validation error 11.500000 %
epoch 20, minibatch 100/100, validation error 11.400000 %
epoch 21, minibatch 100/100, validation error 11.200000 %
     epoch 21, minibatch 100/100, test error of best model 12.800000 %
epoch 22, minibatch 100/100, validation error 10.800000 %
     epoch 22, minibatch 100/100, test error of best model 12.700000 %
epoch 23, minibatch 100/100, validation error 10.800000 %
     epoch 23, minibatch 100/100, test error of best model 12.600000 %
epoch 24, minibatch 100/100, validation error 10.700000 %
     epoch 24, minibatch 100/100, test error of best model 12.200000 %
epoch 25, minibatch 100/100, validation error 10.500000 %
     epoch 25, minibatch 100/100, test error of best model 12.000000 %
epoch 26, minibatch 100/100, validation error 10.400000 %
     epoch 26, minibatch 100/100, test error of best model 12.000000 %
epoch 27, minibatch 100/100, validation error 10.400000 %
epoch 28, minibatch 100/100, validation error 10.200000 %
     epoch 28, minibatch 100/100, test error of best model 12.000000 %
epoch 29, minibatch 100/100, validation error 10.300000 %
epoch 30, minibatch 100/100, validation error 10.300000 %
epoch 31, minibatch 100/100, validation error 10.300000 %
epoch 32, minibatch 100/100, validation error 10.500000 %
epoch 33, minibatch 100/100, validation error 10.600000 %
epoch 34, minibatch 100/100, validation error 10.600000 %
epoch 35, minibatch 100/100, validation error 10.600000 %
epoch 36, minibatch 100/100, validation error 10.700000 %
epoch 37, minibatch 100/100, validation error 10.600000 %
epoch 38, minibatch 100/100, validation error 10.400000 %
epoch 39, minibatch 100/100, validation error 10.300000 %
epoch 40, minibatch 100/100, validation error 10.200000 %
epoch 41, minibatch 100/100, validation error 10.300000 %
epoch 42, minibatch 100/100, validation error 10.300000 %
epoch 43, minibatch 100/100, validation error 10.300000 %
epoch 44, minibatch 100/100, validation error 10.300000 %
epoch 45, minibatch 100/100, validation error 10.200000 %
epoch 46, minibatch 100/100, validation error 10.200000 %
epoch 47, minibatch 100/100, validation error 10.200000 %
epoch 48, minibatch 100/100, validation error 10.200000 %
epoch 49, minibatch 100/100, validation error 10.200000 %
epoch 50, minibatch 100/100, validation error 10.200000 %
epoch 51, minibatch 100/100, validation error 10.200000 %
epoch 52, minibatch 100/100, validation error 10.200000 %
epoch 53, minibatch 100/100, validation error 10.200000 %
epoch 54, minibatch 100/100, validation error 10.200000 %
epoch 55, minibatch 100/100, validation error 10.200000 %
Optimization complete with best validation score of 10.200000 %, obtained at iteration 2800, with test performance 12.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.31m


==========Sample Size: (2000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -160.038538284
Pre-training layer 0, epoch 0, representative training free energy -583.161094452
Pre-training layer 0, epoch 0, validation free energy -582.331814575
Pre-training layer 0, epoch 1, cost -122.355695801
Pre-training layer 0, epoch 2, cost -112.741294556
Pre-training layer 0, epoch 3, cost -107.142784615
Pre-training layer 0, epoch 4, cost -103.20770813
Pre-training layer 0, epoch 5, cost -100.250452423
Pre-training layer 0, epoch 5, representative training free energy -527.693266541
Pre-training layer 0, epoch 5, validation free energy -522.488637756
Pre-training layer 0, epoch 6, cost -97.8873888779
Pre-training layer 0, epoch 7, cost -95.8780854034
Pre-training layer 0, epoch 8, cost -94.2549384308
Pre-training layer 0, epoch 9, cost -92.8647631073
Pre-training layer 0, epoch 10, cost -91.5347389984
Pre-training layer 0, epoch 10, representative training free energy -509.459289368
Pre-training layer 0, epoch 10, validation free energy -502.452499878
Pre-training layer 0, epoch 11, cost -90.4663979721
Pre-training layer 0, epoch 12, cost -89.7455086517
Pre-training layer 0, epoch 13, cost -88.6316247559
Pre-training layer 0, epoch 14, cost -87.9119784164
Pre-training layer 0, epoch 15, cost -87.4824895477
Pre-training layer 0, epoch 15, representative training free energy -497.940458679
Pre-training layer 0, epoch 15, validation free energy -490.471843597
Pre-training layer 0, epoch 16, cost -86.6693970108
Pre-training layer 0, epoch 17, cost -86.2554230881
Pre-training layer 0, epoch 18, cost -85.6498561859
Pre-training layer 0, epoch 19, cost -85.1043609619
Pre-training layer 0, epoch 20, cost -84.6310371017
Pre-training layer 0, epoch 20, representative training free energy -491.373206879
Pre-training layer 0, epoch 20, validation free energy -482.608881256
Pre-training layer 0, epoch 21, cost -84.0807122421
Pre-training layer 0, epoch 22, cost -83.5462399864
Pre-training layer 0, epoch 23, cost -83.264249649
Pre-training layer 0, epoch 24, cost -82.9452586746
Pre-training layer 0, epoch 25, cost -82.5679666901
Pre-training layer 0, epoch 25, representative training free energy -479.20452063
Pre-training layer 0, epoch 25, validation free energy -470.409529602
Pre-training layer 0, epoch 26, cost -82.0348970413
Pre-training layer 0, epoch 27, cost -81.9732513428
Pre-training layer 0, epoch 28, cost -81.5586414528
Pre-training layer 0, epoch 29, cost -81.1288598633
Pre-training layer 0, epoch 30, cost -80.9351292038
Pre-training layer 0, epoch 30, representative training free energy -480.48509137
Pre-training layer 0, epoch 30, validation free energy -470.090909546
Pre-training layer 0, epoch 31, cost -80.8114936829
Pre-training layer 0, epoch 32, cost -80.4305277634
Pre-training layer 0, epoch 33, cost -80.1384488487
Pre-training layer 0, epoch 34, cost -80.1041302109
Pre-training layer 0, epoch 35, cost -79.7512265968
Pre-training layer 0, epoch 35, representative training free energy -474.940707672
Pre-training layer 0, epoch 35, validation free energy -465.16040329
Pre-training layer 0, epoch 36, cost -79.6836805725
Pre-training layer 0, epoch 37, cost -79.2762974739
Pre-training layer 0, epoch 38, cost -79.2171579361
Pre-training layer 0, epoch 39, cost -78.7786115456
Pre-training layer 0, epoch 40, cost -78.7300655746
Pre-training layer 0, epoch 40, representative training free energy -471.276727203
Pre-training layer 0, epoch 40, validation free energy -460.923924652
Pre-training layer 0, epoch 41, cost -78.4731450462
Pre-training layer 0, epoch 42, cost -78.3129488182
Pre-training layer 0, epoch 43, cost -78.0541974068
Pre-training layer 0, epoch 44, cost -77.9482574844
Pre-training layer 0, epoch 45, cost -77.8996681023
Pre-training layer 0, epoch 45, representative training free energy -469.696645844
Pre-training layer 0, epoch 45, validation free energy -458.214140808
Pre-training layer 0, epoch 46, cost -77.7220983124
Pre-training layer 0, epoch 47, cost -77.5721921158
Pre-training layer 0, epoch 48, cost -77.2544387817
Pre-training layer 0, epoch 49, cost -77.2450963974
Pre-training layer 0, epoch 50, cost -77.1574909782
Pre-training layer 0, epoch 50, representative training free energy -466.488568939
Pre-training layer 0, epoch 50, validation free energy -455.798093628
Pre-training layer 0, epoch 51, cost -76.9064632225
Pre-training layer 0, epoch 52, cost -76.7380404472
Pre-training layer 0, epoch 53, cost -76.6829707909
Pre-training layer 0, epoch 54, cost -76.5343228912
Pre-training layer 0, epoch 55, cost -76.5245456505
Pre-training layer 0, epoch 55, representative training free energy -465.185798492
Pre-training layer 0, epoch 55, validation free energy -454.542594635
Pre-training layer 0, epoch 56, cost -76.3834887505
Pre-training layer 0, epoch 57, cost -76.3711356735
Pre-training layer 0, epoch 58, cost -76.102357769
Pre-training layer 0, epoch 59, cost -76.0905588341
Pre-training layer 0, epoch 60, cost -75.7965658569
Pre-training layer 0, epoch 60, representative training free energy -462.967571411
Pre-training layer 0, epoch 60, validation free energy -451.970085907
Pre-training layer 0, epoch 61, cost -75.8148260498
Pre-training layer 0, epoch 62, cost -75.5649963188
Pre-training layer 0, epoch 63, cost -75.4975237083
Pre-training layer 0, epoch 64, cost -75.4736283493
Pre-training layer 0, epoch 65, cost -75.2797576523
Pre-training layer 0, epoch 65, representative training free energy -458.405492157
Pre-training layer 0, epoch 65, validation free energy -446.436326904
Pre-training layer 0, epoch 66, cost -75.2440627861
Pre-training layer 0, epoch 67, cost -75.2467170334
Pre-training layer 0, epoch 68, cost -75.1725445938
Pre-training layer 0, epoch 69, cost -74.9301775742
Pre-training layer 0, epoch 70, cost -75.0195660973
Pre-training layer 0, epoch 70, representative training free energy -456.836555756
Pre-training layer 0, epoch 70, validation free energy -445.609962616
Pre-training layer 0, epoch 71, cost -74.808350544
Pre-training layer 0, epoch 72, cost -74.6978643227
Pre-training layer 0, epoch 73, cost -74.6447409439
Pre-training layer 0, epoch 74, cost -74.4202057266
Pre-training layer 0, epoch 75, cost -74.4745265007
Pre-training layer 0, epoch 75, representative training free energy -461.406337158
Pre-training layer 0, epoch 75, validation free energy -449.086896851
Pre-training layer 0, epoch 76, cost -74.315003109
Pre-training layer 0, epoch 77, cost -74.4330209541
Pre-training layer 0, epoch 78, cost -74.1095658112
Pre-training layer 0, epoch 79, cost -74.1997889328
Pre-training layer 0, epoch 80, cost -74.0558565712
Pre-training layer 0, epoch 80, representative training free energy -455.641670746
Pre-training layer 0, epoch 80, validation free energy -443.053561768
Pre-training layer 0, epoch 81, cost -73.8563868332
Pre-training layer 0, epoch 82, cost -73.9802358627
Pre-training layer 0, epoch 83, cost -73.8653154945
Pre-training layer 0, epoch 84, cost -73.7439624977
Pre-training layer 0, epoch 85, cost -73.7938295364
Pre-training layer 0, epoch 85, representative training free energy -456.613135864
Pre-training layer 0, epoch 85, validation free energy -444.340542114
Pre-training layer 0, epoch 86, cost -73.5695642662
Pre-training layer 0, epoch 87, cost -73.492915535
Pre-training layer 0, epoch 88, cost -73.4565262222
Pre-training layer 0, epoch 89, cost -73.439943409
Pre-training layer 0, epoch 90, cost -73.387640934
Pre-training layer 0, epoch 90, representative training free energy -456.931663269
Pre-training layer 0, epoch 90, validation free energy -444.798936432
Pre-training layer 0, epoch 91, cost -73.3735672569
Pre-training layer 0, epoch 92, cost -73.3105417061
Pre-training layer 0, epoch 93, cost -73.2975190544
Pre-training layer 0, epoch 94, cost -73.1417017555
Pre-training layer 0, epoch 95, cost -72.9156429482
Pre-training layer 0, epoch 95, representative training free energy -454.468970978
Pre-training layer 0, epoch 95, validation free energy -441.20808194
Pre-training layer 0, epoch 96, cost -72.9262850189
Pre-training layer 0, epoch 97, cost -72.9683148766
Pre-training layer 0, epoch 98, cost -72.8188501358
Pre-training layer 0, epoch 99, cost -72.794905529
Pre-training layer 1, epoch 0, cost -376.766030884
Pre-training layer 1, epoch 0, representative training free energy -42497.4485674
Pre-training layer 1, epoch 0, validation free energy -42129.3900508
Pre-training layer 1, epoch 1, cost -323.804459991
Pre-training layer 1, epoch 2, cost -307.722797241
Pre-training layer 1, epoch 3, cost -297.870367508
Pre-training layer 1, epoch 4, cost -291.078020325
Pre-training layer 1, epoch 5, cost -285.772527313
Pre-training layer 1, epoch 5, representative training free energy -58569.9815996
Pre-training layer 1, epoch 5, validation free energy -58022.2534219
Pre-training layer 1, epoch 6, cost -281.619564209
Pre-training layer 1, epoch 7, cost -278.443886261
Pre-training layer 1, epoch 8, cost -275.525739288
Pre-training layer 1, epoch 9, cost -273.328638
Pre-training layer 1, epoch 10, cost -270.962810593
Pre-training layer 1, epoch 10, representative training free energy -63375.9970234
Pre-training layer 1, epoch 10, validation free energy -62791.5433809
Pre-training layer 1, epoch 11, cost -269.433319778
Pre-training layer 1, epoch 12, cost -267.712484207
Pre-training layer 1, epoch 13, cost -266.320118561
Pre-training layer 1, epoch 14, cost -264.999146957
Pre-training layer 1, epoch 15, cost -263.793470306
Pre-training layer 1, epoch 15, representative training free energy -66243.1942461
Pre-training layer 1, epoch 15, validation free energy -65641.5048184
Pre-training layer 1, epoch 16, cost -262.724098282
Pre-training layer 1, epoch 17, cost -261.685681915
Pre-training layer 1, epoch 18, cost -260.934869156
Pre-training layer 1, epoch 19, cost -259.96527504
Pre-training layer 1, epoch 20, cost -259.230895157
Pre-training layer 1, epoch 20, representative training free energy -68150.8460332
Pre-training layer 1, epoch 20, validation free energy -67527.6732734
Pre-training layer 1, epoch 21, cost -258.527860718
Pre-training layer 1, epoch 22, cost -257.986263809
Pre-training layer 1, epoch 23, cost -257.315727997
Pre-training layer 1, epoch 24, cost -256.684976959
Pre-training layer 1, epoch 25, cost -256.132558517
Pre-training layer 1, epoch 25, representative training free energy -69743.2204414
Pre-training layer 1, epoch 25, validation free energy -69114.3200547
Pre-training layer 1, epoch 26, cost -255.667189102
Pre-training layer 1, epoch 27, cost -255.202512741
Pre-training layer 1, epoch 28, cost -254.965665207
Pre-training layer 1, epoch 29, cost -254.401195602
Pre-training layer 1, epoch 30, cost -253.970772247
Pre-training layer 1, epoch 30, representative training free energy -71039.8917148
Pre-training layer 1, epoch 30, validation free energy -70402.8317266
Pre-training layer 1, epoch 31, cost -253.711568222
Pre-training layer 1, epoch 32, cost -253.433570023
Pre-training layer 1, epoch 33, cost -252.965105743
Pre-training layer 1, epoch 34, cost -252.543648453
Pre-training layer 1, epoch 35, cost -252.328817749
Pre-training layer 1, epoch 35, representative training free energy -71981.374209
Pre-training layer 1, epoch 35, validation free energy -71331.864334
Pre-training layer 1, epoch 36, cost -251.856717834
Pre-training layer 1, epoch 37, cost -251.717761841
Pre-training layer 1, epoch 38, cost -251.39363327
Pre-training layer 1, epoch 39, cost -251.130377655
Pre-training layer 1, epoch 40, cost -250.932316971
Pre-training layer 1, epoch 40, representative training free energy -72971.4569512
Pre-training layer 1, epoch 40, validation free energy -72315.2003555
Pre-training layer 1, epoch 41, cost -250.628855057
Pre-training layer 1, epoch 42, cost -250.384737549
Pre-training layer 1, epoch 43, cost -250.168271179
Pre-training layer 1, epoch 44, cost -249.952512131
Pre-training layer 1, epoch 45, cost -249.708490601
Pre-training layer 1, epoch 45, representative training free energy -73783.6019023
Pre-training layer 1, epoch 45, validation free energy -73114.5208652
Pre-training layer 1, epoch 46, cost -249.588847046
Pre-training layer 1, epoch 47, cost -249.39195694
Pre-training layer 1, epoch 48, cost -249.056490097
Pre-training layer 1, epoch 49, cost -248.867302475
Pre-training layer 1, epoch 50, cost -248.73725174
Pre-training layer 1, epoch 50, representative training free energy -74519.5403555
Pre-training layer 1, epoch 50, validation free energy -73840.6453887
Pre-training layer 1, epoch 51, cost -248.591572876
Pre-training layer 1, epoch 52, cost -248.311192322
Pre-training layer 1, epoch 53, cost -248.249193802
Pre-training layer 1, epoch 54, cost -248.106274338
Pre-training layer 1, epoch 55, cost -247.97016922
Pre-training layer 1, epoch 55, representative training free energy -75259.1920742
Pre-training layer 1, epoch 55, validation free energy -74571.9415859
Pre-training layer 1, epoch 56, cost -247.725829849
Pre-training layer 1, epoch 57, cost -247.642416687
Pre-training layer 1, epoch 58, cost -247.619772339
Pre-training layer 1, epoch 59, cost -247.441532898
Pre-training layer 1, epoch 60, cost -247.299379196
Pre-training layer 1, epoch 60, representative training free energy -75768.3578047
Pre-training layer 1, epoch 60, validation free energy -75092.7143574
Pre-training layer 1, epoch 61, cost -247.09253067
Pre-training layer 1, epoch 62, cost -247.069453659
Pre-training layer 1, epoch 63, cost -246.962961884
Pre-training layer 1, epoch 64, cost -246.830053711
Pre-training layer 1, epoch 65, cost -246.506121445
Pre-training layer 1, epoch 65, representative training free energy -76301.5863691
Pre-training layer 1, epoch 65, validation free energy -75614.1385254
Pre-training layer 1, epoch 66, cost -246.568178558
Pre-training layer 1, epoch 67, cost -246.349701767
Pre-training layer 1, epoch 68, cost -246.201513138
Pre-training layer 1, epoch 69, cost -246.196380768
Pre-training layer 1, epoch 70, cost -246.002153854
Pre-training layer 1, epoch 70, representative training free energy -76888.8132852
Pre-training layer 1, epoch 70, validation free energy -76195.4645195
Pre-training layer 1, epoch 71, cost -245.873301544
Pre-training layer 1, epoch 72, cost -245.814711761
Pre-training layer 1, epoch 73, cost -245.756231537
Pre-training layer 1, epoch 74, cost -245.685830688
Pre-training layer 1, epoch 75, cost -245.60868515
Pre-training layer 1, epoch 75, representative training free energy -77255.4800859
Pre-training layer 1, epoch 75, validation free energy -76556.2164473
Pre-training layer 1, epoch 76, cost -245.347523193
Pre-training layer 1, epoch 77, cost -245.359858322
Pre-training layer 1, epoch 78, cost -245.277955017
Pre-training layer 1, epoch 79, cost -245.209303436
Pre-training layer 1, epoch 80, cost -245.145454483
Pre-training layer 1, epoch 80, representative training free energy -77754.0350762
Pre-training layer 1, epoch 80, validation free energy -77043.9061641
Pre-training layer 1, epoch 81, cost -245.020034637
Pre-training layer 1, epoch 82, cost -245.002921066
Pre-training layer 1, epoch 83, cost -244.821572418
Pre-training layer 1, epoch 84, cost -244.934987488
Pre-training layer 1, epoch 85, cost -244.824156036
Pre-training layer 1, epoch 85, representative training free energy -78196.6215801
Pre-training layer 1, epoch 85, validation free energy -77479.7355059
Pre-training layer 1, epoch 86, cost -244.611813965
Pre-training layer 1, epoch 87, cost -244.724895477
Pre-training layer 1, epoch 88, cost -244.637746811
Pre-training layer 1, epoch 89, cost -244.412049103
Pre-training layer 1, epoch 90, cost -244.307885742
Pre-training layer 1, epoch 90, representative training free energy -78572.6368301
Pre-training layer 1, epoch 90, validation free energy -77852.4426543
Pre-training layer 1, epoch 91, cost -244.294428101
Pre-training layer 1, epoch 92, cost -244.161131897
Pre-training layer 1, epoch 93, cost -244.124060822
Pre-training layer 1, epoch 94, cost -244.070923691
Pre-training layer 1, epoch 95, cost -244.045402298
Pre-training layer 1, epoch 95, representative training free energy -78968.926377
Pre-training layer 1, epoch 95, validation free energy -78250.102209
Pre-training layer 1, epoch 96, cost -244.075386963
Pre-training layer 1, epoch 97, cost -243.822520905
Pre-training layer 1, epoch 98, cost -243.925252533
Pre-training layer 1, epoch 99, cost -243.784783936
Pre-training layer 2, epoch 0, cost -135.793198128
Pre-training layer 2, epoch 0, representative training free energy 2456.02394128
Pre-training layer 2, epoch 0, validation free energy 2451.93147287
Pre-training layer 2, epoch 1, cost -96.4434489059
Pre-training layer 2, epoch 2, cost -88.3260855865
Pre-training layer 2, epoch 3, cost -84.2383605194
Pre-training layer 2, epoch 4, cost -80.9019961739
Pre-training layer 2, epoch 5, cost -78.7216397285
Pre-training layer 2, epoch 5, representative training free energy 3892.27090192
Pre-training layer 2, epoch 5, validation free energy 3856.50666565
Pre-training layer 2, epoch 6, cost -77.1411416817
Pre-training layer 2, epoch 7, cost -75.6790694237
Pre-training layer 2, epoch 8, cost -74.2681560135
Pre-training layer 2, epoch 9, cost -73.2297848701
Pre-training layer 2, epoch 10, cost -72.5354902077
Pre-training layer 2, epoch 10, representative training free energy 4600.04135583
Pre-training layer 2, epoch 10, validation free energy 4550.90874976
Pre-training layer 2, epoch 11, cost -71.8347439575
Pre-training layer 2, epoch 12, cost -71.0288085365
Pre-training layer 2, epoch 13, cost -70.4724259186
Pre-training layer 2, epoch 14, cost -69.8713232994
Pre-training layer 2, epoch 15, cost -69.5689011955
Pre-training layer 2, epoch 15, representative training free energy 5094.76199963
Pre-training layer 2, epoch 15, validation free energy 5039.22538831
Pre-training layer 2, epoch 16, cost -69.014522419
Pre-training layer 2, epoch 17, cost -68.5670427132
Pre-training layer 2, epoch 18, cost -68.2648284531
Pre-training layer 2, epoch 19, cost -68.0864498329
Pre-training layer 2, epoch 20, cost -67.557980938
Pre-training layer 2, epoch 20, representative training free energy 5485.85879419
Pre-training layer 2, epoch 20, validation free energy 5426.5881593
Pre-training layer 2, epoch 21, cost -67.3204924965
Pre-training layer 2, epoch 22, cost -67.0904828835
Pre-training layer 2, epoch 23, cost -66.6505548477
Pre-training layer 2, epoch 24, cost -66.5233911705
Pre-training layer 2, epoch 25, cost -66.3216567421
Pre-training layer 2, epoch 25, representative training free energy 5844.38983435
Pre-training layer 2, epoch 25, validation free energy 5782.07838953
Pre-training layer 2, epoch 26, cost -66.0460029411
Pre-training layer 2, epoch 27, cost -65.8744416046
Pre-training layer 2, epoch 28, cost -65.7161840248
Pre-training layer 2, epoch 29, cost -65.5188320541
Pre-training layer 2, epoch 30, cost -65.2677481651
Pre-training layer 2, epoch 30, representative training free energy 6162.7113573
Pre-training layer 2, epoch 30, validation free energy 6095.00366431
Pre-training layer 2, epoch 31, cost -65.1887207222
Pre-training layer 2, epoch 32, cost -64.9043956757
Pre-training layer 2, epoch 33, cost -64.8512887383
Pre-training layer 2, epoch 34, cost -64.7213081551
Pre-training layer 2, epoch 35, cost -64.5905555916
Pre-training layer 2, epoch 35, representative training free energy 6410.91767151
Pre-training layer 2, epoch 35, validation free energy 6340.72694312
Pre-training layer 2, epoch 36, cost -64.4504736519
Pre-training layer 2, epoch 37, cost -64.2976237106
Pre-training layer 2, epoch 38, cost -64.1362871742
Pre-training layer 2, epoch 39, cost -64.0313226509
Pre-training layer 2, epoch 40, cost -63.9691443634
Pre-training layer 2, epoch 40, representative training free energy 6694.48866394
Pre-training layer 2, epoch 40, validation free energy 6619.38115894
Pre-training layer 2, epoch 41, cost -64.0242616081
Pre-training layer 2, epoch 42, cost -63.8783067703
Pre-training layer 2, epoch 43, cost -63.6416060448
Pre-training layer 2, epoch 44, cost -63.5641787529
Pre-training layer 2, epoch 45, cost -63.5633353043
Pre-training layer 2, epoch 45, representative training free energy 6917.44838037
Pre-training layer 2, epoch 45, validation free energy 6839.74335791
Pre-training layer 2, epoch 46, cost -63.5682268715
Pre-training layer 2, epoch 47, cost -63.3003519058
Pre-training layer 2, epoch 48, cost -63.233856926
Pre-training layer 2, epoch 49, cost -63.1713871765
Pre-training layer 2, epoch 50, cost -63.1324035835
Pre-training layer 2, epoch 50, representative training free energy 7122.07118201
Pre-training layer 2, epoch 50, validation free energy 7042.95793286
Pre-training layer 2, epoch 51, cost -62.9946468544
Pre-training layer 2, epoch 52, cost -63.0184955597
Pre-training layer 2, epoch 53, cost -62.8027256012
Pre-training layer 2, epoch 54, cost -62.9357323647
Pre-training layer 2, epoch 55, cost -62.7334583855
Pre-training layer 2, epoch 55, representative training free energy 7350.86413281
Pre-training layer 2, epoch 55, validation free energy 7269.49807227
Pre-training layer 2, epoch 56, cost -62.7687727737
Pre-training layer 2, epoch 57, cost -62.7537419319
Pre-training layer 2, epoch 58, cost -62.6112415695
Pre-training layer 2, epoch 59, cost -62.4849127007
Pre-training layer 2, epoch 60, cost -62.4491238785
Pre-training layer 2, epoch 60, representative training free energy 7531.06203418
Pre-training layer 2, epoch 60, validation free energy 7447.50128809
Pre-training layer 2, epoch 61, cost -62.5360000992
Pre-training layer 2, epoch 62, cost -62.2840610504
Pre-training layer 2, epoch 63, cost -62.2925502968
Pre-training layer 2, epoch 64, cost -62.3362635612
Pre-training layer 2, epoch 65, cost -62.2175134659
Pre-training layer 2, epoch 65, representative training free energy 7720.82484521
Pre-training layer 2, epoch 65, validation free energy 7635.08463745
Pre-training layer 2, epoch 66, cost -62.2889203835
Pre-training layer 2, epoch 67, cost -62.095050621
Pre-training layer 2, epoch 68, cost -62.1849696541
Pre-training layer 2, epoch 69, cost -62.1181141853
Pre-training layer 2, epoch 70, cost -61.8998495293
Pre-training layer 2, epoch 70, representative training free energy 7913.67256885
Pre-training layer 2, epoch 70, validation free energy 7826.27550952
Pre-training layer 2, epoch 71, cost -62.0050592232
Pre-training layer 2, epoch 72, cost -61.9397484398
Pre-training layer 2, epoch 73, cost -61.8725086212
Pre-training layer 2, epoch 74, cost -61.768422451
Pre-training layer 2, epoch 75, cost -61.7470232964
Pre-training layer 2, epoch 75, representative training free energy 8077.18707642
Pre-training layer 2, epoch 75, validation free energy 7987.3558667
Pre-training layer 2, epoch 76, cost -61.7699315834
Pre-training layer 2, epoch 77, cost -61.601406002
Pre-training layer 2, epoch 78, cost -61.6550840187
Pre-training layer 2, epoch 79, cost -61.7090363693
Pre-training layer 2, epoch 80, cost -61.5757956314
Pre-training layer 2, epoch 80, representative training free energy 8247.09783179
Pre-training layer 2, epoch 80, validation free energy 8155.64720093
Pre-training layer 2, epoch 81, cost -61.4824191856
Pre-training layer 2, epoch 82, cost -61.6105698776
Pre-training layer 2, epoch 83, cost -61.5887835693
Pre-training layer 2, epoch 84, cost -61.406882
Pre-training layer 2, epoch 85, cost -61.3808343124
Pre-training layer 2, epoch 85, representative training free energy 8403.43605835
Pre-training layer 2, epoch 85, validation free energy 8310.18078052
Pre-training layer 2, epoch 86, cost -61.4063941574
Pre-training layer 2, epoch 87, cost -61.3951137733
Pre-training layer 2, epoch 88, cost -61.291462059
Pre-training layer 2, epoch 89, cost -61.2725601578
Pre-training layer 2, epoch 90, cost -61.399543972
Pre-training layer 2, epoch 90, representative training free energy 8538.68178027
Pre-training layer 2, epoch 90, validation free energy 8442.93921948
Pre-training layer 2, epoch 91, cost -61.3123343468
Pre-training layer 2, epoch 92, cost -61.2970773888
Pre-training layer 2, epoch 93, cost -61.1821310806
Pre-training layer 2, epoch 94, cost -61.2005517387
Pre-training layer 2, epoch 95, cost -61.1298077393
Pre-training layer 2, epoch 95, representative training free energy 8685.35366626
Pre-training layer 2, epoch 95, validation free energy 8588.39653809
Pre-training layer 2, epoch 96, cost -61.0863783455
Pre-training layer 2, epoch 97, cost -61.1017681694
Pre-training layer 2, epoch 98, cost -61.0480807686
Pre-training layer 2, epoch 99, cost -61.0937869453
The pretraining code for file dbn_loop.pyc ran for 1.98m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 12.000000 %
     epoch 1, minibatch 200/200, test error of best model 13.500000 %
epoch 2, minibatch 200/200, validation error 9.600000 %
     epoch 2, minibatch 200/200, test error of best model 10.900000 %
epoch 3, minibatch 200/200, validation error 9.100000 %
     epoch 3, minibatch 200/200, test error of best model 9.600000 %
epoch 4, minibatch 200/200, validation error 9.400000 %
epoch 5, minibatch 200/200, validation error 8.800000 %
     epoch 5, minibatch 200/200, test error of best model 9.100000 %
epoch 6, minibatch 200/200, validation error 8.500000 %
     epoch 6, minibatch 200/200, test error of best model 8.800000 %
epoch 7, minibatch 200/200, validation error 8.700000 %
epoch 8, minibatch 200/200, validation error 8.500000 %
     epoch 8, minibatch 200/200, test error of best model 8.300000 %
epoch 9, minibatch 200/200, validation error 8.300000 %
     epoch 9, minibatch 200/200, test error of best model 8.100000 %
epoch 10, minibatch 200/200, validation error 8.200000 %
     epoch 10, minibatch 200/200, test error of best model 8.200000 %
epoch 11, minibatch 200/200, validation error 8.200000 %
epoch 12, minibatch 200/200, validation error 8.200000 %
epoch 13, minibatch 200/200, validation error 7.700000 %
     epoch 13, minibatch 200/200, test error of best model 8.200000 %
epoch 14, minibatch 200/200, validation error 7.700000 %
epoch 15, minibatch 200/200, validation error 7.700000 %
epoch 16, minibatch 200/200, validation error 7.700000 %
epoch 17, minibatch 200/200, validation error 7.800000 %
epoch 18, minibatch 200/200, validation error 7.700000 %
epoch 19, minibatch 200/200, validation error 7.400000 %
     epoch 19, minibatch 200/200, test error of best model 8.500000 %
epoch 20, minibatch 200/200, validation error 7.600000 %
epoch 21, minibatch 200/200, validation error 7.600000 %
epoch 22, minibatch 200/200, validation error 7.600000 %
epoch 23, minibatch 200/200, validation error 7.500000 %
epoch 24, minibatch 200/200, validation error 7.500000 %
epoch 25, minibatch 200/200, validation error 7.600000 %
epoch 26, minibatch 200/200, validation error 7.600000 %
epoch 27, minibatch 200/200, validation error 7.500000 %
epoch 28, minibatch 200/200, validation error 7.600000 %
epoch 29, minibatch 200/200, validation error 7.600000 %
epoch 30, minibatch 200/200, validation error 7.500000 %
epoch 31, minibatch 200/200, validation error 7.300000 %
     epoch 31, minibatch 200/200, test error of best model 8.000000 %
epoch 32, minibatch 200/200, validation error 7.300000 %
epoch 33, minibatch 200/200, validation error 7.200000 %
     epoch 33, minibatch 200/200, test error of best model 8.000000 %
epoch 34, minibatch 200/200, validation error 7.200000 %
epoch 35, minibatch 200/200, validation error 7.100000 %
     epoch 35, minibatch 200/200, test error of best model 8.100000 %
epoch 36, minibatch 200/200, validation error 7.200000 %
epoch 37, minibatch 200/200, validation error 7.200000 %
epoch 38, minibatch 200/200, validation error 7.200000 %
epoch 39, minibatch 200/200, validation error 7.100000 %
epoch 40, minibatch 200/200, validation error 7.100000 %
epoch 41, minibatch 200/200, validation error 7.100000 %
epoch 42, minibatch 200/200, validation error 7.000000 %
     epoch 42, minibatch 200/200, test error of best model 7.400000 %
epoch 43, minibatch 200/200, validation error 7.000000 %
epoch 44, minibatch 200/200, validation error 7.000000 %
epoch 45, minibatch 200/200, validation error 7.000000 %
epoch 46, minibatch 200/200, validation error 7.000000 %
epoch 47, minibatch 200/200, validation error 7.000000 %
epoch 48, minibatch 200/200, validation error 7.000000 %
epoch 49, minibatch 200/200, validation error 7.100000 %
epoch 50, minibatch 200/200, validation error 7.100000 %
epoch 51, minibatch 200/200, validation error 7.000000 %
epoch 52, minibatch 200/200, validation error 7.000000 %
epoch 53, minibatch 200/200, validation error 7.000000 %
epoch 54, minibatch 200/200, validation error 7.000000 %
epoch 55, minibatch 200/200, validation error 7.000000 %
epoch 56, minibatch 200/200, validation error 7.000000 %
epoch 57, minibatch 200/200, validation error 7.100000 %
epoch 58, minibatch 200/200, validation error 7.100000 %
epoch 59, minibatch 200/200, validation error 7.000000 %
epoch 60, minibatch 200/200, validation error 7.000000 %
epoch 61, minibatch 200/200, validation error 7.000000 %
epoch 62, minibatch 200/200, validation error 7.000000 %
epoch 63, minibatch 200/200, validation error 7.000000 %
epoch 64, minibatch 200/200, validation error 7.000000 %
epoch 65, minibatch 200/200, validation error 7.000000 %
epoch 66, minibatch 200/200, validation error 7.000000 %
epoch 67, minibatch 200/200, validation error 7.000000 %
epoch 68, minibatch 200/200, validation error 7.000000 %
epoch 69, minibatch 200/200, validation error 7.000000 %
epoch 70, minibatch 200/200, validation error 7.000000 %
epoch 71, minibatch 200/200, validation error 7.000000 %
epoch 72, minibatch 200/200, validation error 7.000000 %
epoch 73, minibatch 200/200, validation error 7.000000 %
epoch 74, minibatch 200/200, validation error 7.000000 %
epoch 75, minibatch 200/200, validation error 7.000000 %
epoch 76, minibatch 200/200, validation error 7.000000 %
epoch 77, minibatch 200/200, validation error 7.000000 %
epoch 78, minibatch 200/200, validation error 7.000000 %
epoch 79, minibatch 200/200, validation error 7.100000 %
epoch 80, minibatch 200/200, validation error 7.100000 %
epoch 81, minibatch 200/200, validation error 7.100000 %
epoch 82, minibatch 200/200, validation error 7.100000 %
epoch 83, minibatch 200/200, validation error 7.000000 %
     epoch 83, minibatch 200/200, test error of best model 7.400000 %
Optimization complete with best validation score of 7.000000 %, obtained at iteration 16600, with test performance 7.400000 %
The fine tuning code for file dbn_loop.pyc ran for 0.76m


==========Sample Size: (3000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -149.571305618
Pre-training layer 0, epoch 0, representative training free energy -560.933569946
Pre-training layer 0, epoch 0, validation free energy -559.285503296
Pre-training layer 0, epoch 1, cost -115.692497025
Pre-training layer 0, epoch 2, cost -106.791088282
Pre-training layer 0, epoch 3, cost -101.644934743
Pre-training layer 0, epoch 4, cost -98.1696378581
Pre-training layer 0, epoch 5, cost -95.5390954844
Pre-training layer 0, epoch 5, representative training free energy -502.519966034
Pre-training layer 0, epoch 5, validation free energy -498.03155191
Pre-training layer 0, epoch 6, cost -93.5336904144
Pre-training layer 0, epoch 7, cost -91.9847743988
Pre-training layer 0, epoch 8, cost -90.6497386424
Pre-training layer 0, epoch 9, cost -89.2347586314
Pre-training layer 0, epoch 10, cost -88.2376579285
Pre-training layer 0, epoch 10, representative training free energy -480.420514313
Pre-training layer 0, epoch 10, validation free energy -475.001291626
Pre-training layer 0, epoch 11, cost -87.4490612284
Pre-training layer 0, epoch 12, cost -86.5052707926
Pre-training layer 0, epoch 13, cost -85.9436197662
Pre-training layer 0, epoch 14, cost -85.1387026469
Pre-training layer 0, epoch 15, cost -84.5912698364
Pre-training layer 0, epoch 15, representative training free energy -469.863778351
Pre-training layer 0, epoch 15, validation free energy -463.221131866
Pre-training layer 0, epoch 16, cost -83.9129051717
Pre-training layer 0, epoch 17, cost -83.3145013301
Pre-training layer 0, epoch 18, cost -83.1719008509
Pre-training layer 0, epoch 19, cost -82.4541115316
Pre-training layer 0, epoch 20, cost -82.2592138799
Pre-training layer 0, epoch 20, representative training free energy -462.842531555
Pre-training layer 0, epoch 20, validation free energy -455.581579559
Pre-training layer 0, epoch 21, cost -81.8732361476
Pre-training layer 0, epoch 22, cost -81.4879224014
Pre-training layer 0, epoch 23, cost -81.2350650024
Pre-training layer 0, epoch 24, cost -80.8977078374
Pre-training layer 0, epoch 25, cost -80.6665058263
Pre-training layer 0, epoch 25, representative training free energy -458.428611969
Pre-training layer 0, epoch 25, validation free energy -451.191211731
Pre-training layer 0, epoch 26, cost -80.2120052338
Pre-training layer 0, epoch 27, cost -79.9875269063
Pre-training layer 0, epoch 28, cost -79.7639152781
Pre-training layer 0, epoch 29, cost -79.5060984421
Pre-training layer 0, epoch 30, cost -79.3982888794
Pre-training layer 0, epoch 30, representative training free energy -453.107895172
Pre-training layer 0, epoch 30, validation free energy -445.07486969
Pre-training layer 0, epoch 31, cost -79.1649123128
Pre-training layer 0, epoch 32, cost -78.9674288432
Pre-training layer 0, epoch 33, cost -78.6171633403
Pre-training layer 0, epoch 34, cost -78.5206715012
Pre-training layer 0, epoch 35, cost -78.1790760167
Pre-training layer 0, epoch 35, representative training free energy -450.646975159
Pre-training layer 0, epoch 35, validation free energy -442.898860321
Pre-training layer 0, epoch 36, cost -78.0913027318
Pre-training layer 0, epoch 37, cost -78.019370575
Pre-training layer 0, epoch 38, cost -77.7212709808
Pre-training layer 0, epoch 39, cost -77.6030294927
Pre-training layer 0, epoch 40, cost -77.5111522166
Pre-training layer 0, epoch 40, representative training free energy -447.665204651
Pre-training layer 0, epoch 40, validation free energy -439.13135556
Pre-training layer 0, epoch 41, cost -77.2276897939
Pre-training layer 0, epoch 42, cost -77.1527883403
Pre-training layer 0, epoch 43, cost -77.0160023499
Pre-training layer 0, epoch 44, cost -76.9485324732
Pre-training layer 0, epoch 45, cost -76.7373502096
Pre-training layer 0, epoch 45, representative training free energy -443.989475464
Pre-training layer 0, epoch 45, validation free energy -434.772102478
Pre-training layer 0, epoch 46, cost -76.7123188146
Pre-training layer 0, epoch 47, cost -76.380356547
Pre-training layer 0, epoch 48, cost -76.3198841604
Pre-training layer 0, epoch 49, cost -76.3223202642
Pre-training layer 0, epoch 50, cost -76.0430279541
Pre-training layer 0, epoch 50, representative training free energy -444.841115601
Pre-training layer 0, epoch 50, validation free energy -436.285276855
Pre-training layer 0, epoch 51, cost -76.0699706523
Pre-training layer 0, epoch 52, cost -75.9093148295
Pre-training layer 0, epoch 53, cost -75.6696839015
Pre-training layer 0, epoch 54, cost -75.5704089101
Pre-training layer 0, epoch 55, cost -75.6167657471
Pre-training layer 0, epoch 55, representative training free energy -441.237382172
Pre-training layer 0, epoch 55, validation free energy -432.130716248
Pre-training layer 0, epoch 56, cost -75.3970316696
Pre-training layer 0, epoch 57, cost -75.3488936361
Pre-training layer 0, epoch 58, cost -75.3979211299
Pre-training layer 0, epoch 59, cost -75.0302510961
Pre-training layer 0, epoch 60, cost -74.9044378281
Pre-training layer 0, epoch 60, representative training free energy -442.048802582
Pre-training layer 0, epoch 60, validation free energy -432.416902313
Pre-training layer 0, epoch 61, cost -74.7495570374
Pre-training layer 0, epoch 62, cost -74.7936871847
Pre-training layer 0, epoch 63, cost -74.7777947235
Pre-training layer 0, epoch 64, cost -74.7610842641
Pre-training layer 0, epoch 65, cost -74.5597554016
Pre-training layer 0, epoch 65, representative training free energy -439.873764984
Pre-training layer 0, epoch 65, validation free energy -430.502112152
Pre-training layer 0, epoch 66, cost -74.574298261
Pre-training layer 0, epoch 67, cost -74.4792384211
Pre-training layer 0, epoch 68, cost -74.3878122838
Pre-training layer 0, epoch 69, cost -74.3090159861
Pre-training layer 0, epoch 70, cost -74.2850308482
Pre-training layer 0, epoch 70, representative training free energy -435.980905273
Pre-training layer 0, epoch 70, validation free energy -426.23728186
Pre-training layer 0, epoch 71, cost -74.1835877991
Pre-training layer 0, epoch 72, cost -74.1924825795
Pre-training layer 0, epoch 73, cost -74.0866162364
Pre-training layer 0, epoch 74, cost -73.9724380747
Pre-training layer 0, epoch 75, cost -73.7157904307
Pre-training layer 0, epoch 75, representative training free energy -438.222557556
Pre-training layer 0, epoch 75, validation free energy -427.367309601
Pre-training layer 0, epoch 76, cost -73.7351596959
Pre-training layer 0, epoch 77, cost -73.8668578211
Pre-training layer 0, epoch 78, cost -73.6294052124
Pre-training layer 0, epoch 79, cost -73.647914772
Pre-training layer 0, epoch 80, cost -73.5750299454
Pre-training layer 0, epoch 80, representative training free energy -433.610362305
Pre-training layer 0, epoch 80, validation free energy -422.94477298
Pre-training layer 0, epoch 81, cost -73.376219457
Pre-training layer 0, epoch 82, cost -73.4110349782
Pre-training layer 0, epoch 83, cost -73.3124693553
Pre-training layer 0, epoch 84, cost -73.4006108093
Pre-training layer 0, epoch 85, cost -73.159607811
Pre-training layer 0, epoch 85, representative training free energy -435.546519836
Pre-training layer 0, epoch 85, validation free energy -424.716191589
Pre-training layer 0, epoch 86, cost -73.1488428624
Pre-training layer 0, epoch 87, cost -73.0690306981
Pre-training layer 0, epoch 88, cost -73.0742611567
Pre-training layer 0, epoch 89, cost -72.9596043523
Pre-training layer 0, epoch 90, cost -72.8293149439
Pre-training layer 0, epoch 90, representative training free energy -436.508917694
Pre-training layer 0, epoch 90, validation free energy -425.589835236
Pre-training layer 0, epoch 91, cost -72.9786263402
Pre-training layer 0, epoch 92, cost -72.750990359
Pre-training layer 0, epoch 93, cost -72.7617885335
Pre-training layer 0, epoch 94, cost -72.7404435857
Pre-training layer 0, epoch 95, cost -72.747726237
Pre-training layer 0, epoch 95, representative training free energy -436.584345459
Pre-training layer 0, epoch 95, validation free energy -425.733693237
Pre-training layer 0, epoch 96, cost -72.5958627065
Pre-training layer 0, epoch 97, cost -72.5301289495
Pre-training layer 0, epoch 98, cost -72.5099238968
Pre-training layer 0, epoch 99, cost -72.5524996058
Pre-training layer 1, epoch 0, cost -346.536434886
Pre-training layer 1, epoch 0, representative training free energy -50697.8745156
Pre-training layer 1, epoch 0, validation free energy -50153.5647656
Pre-training layer 1, epoch 1, cost -297.314922791
Pre-training layer 1, epoch 2, cost -282.492679392
Pre-training layer 1, epoch 3, cost -273.676449636
Pre-training layer 1, epoch 4, cost -267.441168772
Pre-training layer 1, epoch 5, cost -263.11322408
Pre-training layer 1, epoch 5, representative training free energy -68734.4379844
Pre-training layer 1, epoch 5, validation free energy -67952.5926758
Pre-training layer 1, epoch 6, cost -259.482817179
Pre-training layer 1, epoch 7, cost -256.59041036
Pre-training layer 1, epoch 8, cost -254.304187978
Pre-training layer 1, epoch 9, cost -252.185923716
Pre-training layer 1, epoch 10, cost -250.43024114
Pre-training layer 1, epoch 10, representative training free energy -74136.351252
Pre-training layer 1, epoch 10, validation free energy -73288.3774063
Pre-training layer 1, epoch 11, cost -248.866141968
Pre-training layer 1, epoch 12, cost -247.683670807
Pre-training layer 1, epoch 13, cost -246.479049123
Pre-training layer 1, epoch 14, cost -245.353919678
Pre-training layer 1, epoch 15, cost -244.41903717
Pre-training layer 1, epoch 15, representative training free energy -77359.9683457
Pre-training layer 1, epoch 15, validation free energy -76489.8926094
Pre-training layer 1, epoch 16, cost -243.629483643
Pre-training layer 1, epoch 17, cost -242.878953807
Pre-training layer 1, epoch 18, cost -242.09032252
Pre-training layer 1, epoch 19, cost -241.546768443
Pre-training layer 1, epoch 20, cost -241.004679871
Pre-training layer 1, epoch 20, representative training free energy -79556.6364805
Pre-training layer 1, epoch 20, validation free energy -78653.6433047
Pre-training layer 1, epoch 21, cost -240.284857941
Pre-training layer 1, epoch 22, cost -239.798879242
Pre-training layer 1, epoch 23, cost -239.170045013
Pre-training layer 1, epoch 24, cost -238.781591187
Pre-training layer 1, epoch 25, cost -238.542983348
Pre-training layer 1, epoch 25, representative training free energy -81269.6459609
Pre-training layer 1, epoch 25, validation free energy -80353.983668
Pre-training layer 1, epoch 26, cost -238.13999939
Pre-training layer 1, epoch 27, cost -237.621163279
Pre-training layer 1, epoch 28, cost -237.404430491
Pre-training layer 1, epoch 29, cost -236.901994527
Pre-training layer 1, epoch 30, cost -236.52843689
Pre-training layer 1, epoch 30, representative training free energy -82752.9666328
Pre-training layer 1, epoch 30, validation free energy -81810.2185762
Pre-training layer 1, epoch 31, cost -236.387174377
Pre-training layer 1, epoch 32, cost -236.150244446
Pre-training layer 1, epoch 33, cost -235.991137594
Pre-training layer 1, epoch 34, cost -235.587984772
Pre-training layer 1, epoch 35, cost -235.388048299
Pre-training layer 1, epoch 35, representative training free energy -83838.7663711
Pre-training layer 1, epoch 35, validation free energy -82888.0232793
Pre-training layer 1, epoch 36, cost -235.02384491
Pre-training layer 1, epoch 37, cost -234.895329793
Pre-training layer 1, epoch 38, cost -234.646751912
Pre-training layer 1, epoch 39, cost -234.404057261
Pre-training layer 1, epoch 40, cost -234.175022786
Pre-training layer 1, epoch 40, representative training free energy -84839.0538848
Pre-training layer 1, epoch 40, validation free energy -83876.0740527
Pre-training layer 1, epoch 41, cost -233.982015381
Pre-training layer 1, epoch 42, cost -233.703108266
Pre-training layer 1, epoch 43, cost -233.438108673
Pre-training layer 1, epoch 44, cost -233.394292348
Pre-training layer 1, epoch 45, cost -233.204455261
Pre-training layer 1, epoch 45, representative training free energy -85762.4838652
Pre-training layer 1, epoch 45, validation free energy -84774.6470449
Pre-training layer 1, epoch 46, cost -233.079102071
Pre-training layer 1, epoch 47, cost -232.884019877
Pre-training layer 1, epoch 48, cost -232.767114512
Pre-training layer 1, epoch 49, cost -232.537774353
Pre-training layer 1, epoch 50, cost -232.499558411
Pre-training layer 1, epoch 50, representative training free energy -86607.5024668
Pre-training layer 1, epoch 50, validation free energy -85627.9595723
Pre-training layer 1, epoch 51, cost -232.187965749
Pre-training layer 1, epoch 52, cost -232.205786133
Pre-training layer 1, epoch 53, cost -232.043084666
Pre-training layer 1, epoch 54, cost -231.853264414
Pre-training layer 1, epoch 55, cost -231.790525055
Pre-training layer 1, epoch 55, representative training free energy -87243.0873223
Pre-training layer 1, epoch 55, validation free energy -86253.6540117
Pre-training layer 1, epoch 56, cost -231.647156423
Pre-training layer 1, epoch 57, cost -231.650640818
Pre-training layer 1, epoch 58, cost -231.420872752
Pre-training layer 1, epoch 59, cost -231.280222117
Pre-training layer 1, epoch 60, cost -231.222883352
Pre-training layer 1, epoch 60, representative training free energy -87990.2068359
Pre-training layer 1, epoch 60, validation free energy -86983.8535879
Pre-training layer 1, epoch 61, cost -231.046565552
Pre-training layer 1, epoch 62, cost -231.021335653
Pre-training layer 1, epoch 63, cost -230.863339539
Pre-training layer 1, epoch 64, cost -230.772187195
Pre-training layer 1, epoch 65, cost -230.758027802
Pre-training layer 1, epoch 65, representative training free energy -88726.844209
Pre-training layer 1, epoch 65, validation free energy -87713.6570898
Pre-training layer 1, epoch 66, cost -230.538210246
Pre-training layer 1, epoch 67, cost -230.505599874
Pre-training layer 1, epoch 68, cost -230.39375768
Pre-training layer 1, epoch 69, cost -230.390620728
Pre-training layer 1, epoch 70, cost -230.187996572
Pre-training layer 1, epoch 70, representative training free energy -89249.8001289
Pre-training layer 1, epoch 70, validation free energy -88235.40725
Pre-training layer 1, epoch 71, cost -230.154941762
Pre-training layer 1, epoch 72, cost -230.03329834
Pre-training layer 1, epoch 73, cost -230.012817128
Pre-training layer 1, epoch 74, cost -229.769723663
Pre-training layer 1, epoch 75, cost -229.6950737
Pre-training layer 1, epoch 75, representative training free energy -89903.5790078
Pre-training layer 1, epoch 75, validation free energy -88870.1720254
Pre-training layer 1, epoch 76, cost -229.718088786
Pre-training layer 1, epoch 77, cost -229.659057922
Pre-training layer 1, epoch 78, cost -229.568484344
Pre-training layer 1, epoch 79, cost -229.396977488
Pre-training layer 1, epoch 80, cost -229.404490306
Pre-training layer 1, epoch 80, representative training free energy -90322.6498809
Pre-training layer 1, epoch 80, validation free energy -89283.0218984
Pre-training layer 1, epoch 81, cost -229.283715668
Pre-training layer 1, epoch 82, cost -229.30893219
Pre-training layer 1, epoch 83, cost -229.185068054
Pre-training layer 1, epoch 84, cost -229.038501282
Pre-training layer 1, epoch 85, cost -229.155796407
Pre-training layer 1, epoch 85, representative training free energy -90813.342127
Pre-training layer 1, epoch 85, validation free energy -89774.559209
Pre-training layer 1, epoch 86, cost -229.10667511
Pre-training layer 1, epoch 87, cost -229.0357783
Pre-training layer 1, epoch 88, cost -228.837910563
Pre-training layer 1, epoch 89, cost -228.854565938
Pre-training layer 1, epoch 90, cost -228.795019073
Pre-training layer 1, epoch 90, representative training free energy -91244.8304531
Pre-training layer 1, epoch 90, validation free energy -90203.4400195
Pre-training layer 1, epoch 91, cost -228.701276906
Pre-training layer 1, epoch 92, cost -228.716452789
Pre-training layer 1, epoch 93, cost -228.642152964
Pre-training layer 1, epoch 94, cost -228.518265839
Pre-training layer 1, epoch 95, cost -228.454598134
Pre-training layer 1, epoch 95, representative training free energy -91735.3156016
Pre-training layer 1, epoch 95, validation free energy -90684.0581504
Pre-training layer 1, epoch 96, cost -228.472351735
Pre-training layer 1, epoch 97, cost -228.375546265
Pre-training layer 1, epoch 98, cost -228.310136363
Pre-training layer 1, epoch 99, cost -228.34230896
Pre-training layer 2, epoch 0, cost -127.369295731
Pre-training layer 2, epoch 0, representative training free energy 3174.15759509
Pre-training layer 2, epoch 0, validation free energy 3131.46352942
Pre-training layer 2, epoch 1, cost -93.1692306773
Pre-training layer 2, epoch 2, cost -86.0171184031
Pre-training layer 2, epoch 3, cost -82.0152133306
Pre-training layer 2, epoch 4, cost -79.3998128891
Pre-training layer 2, epoch 5, cost -77.1998412577
Pre-training layer 2, epoch 5, representative training free energy 4939.72557031
Pre-training layer 2, epoch 5, validation free energy 4839.36937903
Pre-training layer 2, epoch 6, cost -75.5842305247
Pre-training layer 2, epoch 7, cost -74.3223811595
Pre-training layer 2, epoch 8, cost -73.4567902629
Pre-training layer 2, epoch 9, cost -72.4232062276
Pre-training layer 2, epoch 10, cost -71.7588380051
Pre-training layer 2, epoch 10, representative training free energy 5936.77177527
Pre-training layer 2, epoch 10, validation free energy 5853.26570386
Pre-training layer 2, epoch 11, cost -71.0757428869
Pre-training layer 2, epoch 12, cost -70.4099718475
Pre-training layer 2, epoch 13, cost -69.9125561651
Pre-training layer 2, epoch 14, cost -69.480527331
Pre-training layer 2, epoch 15, cost -69.0127649053
Pre-training layer 2, epoch 15, representative training free energy 6625.71606494
Pre-training layer 2, epoch 15, validation free energy 6541.80956653
Pre-training layer 2, epoch 16, cost -68.6267471441
Pre-training layer 2, epoch 17, cost -68.3075879796
Pre-training layer 2, epoch 18, cost -67.8883003616
Pre-training layer 2, epoch 19, cost -67.5578481038
Pre-training layer 2, epoch 20, cost -67.4383812459
Pre-training layer 2, epoch 20, representative training free energy 7170.69117822
Pre-training layer 2, epoch 20, validation free energy 7084.25097949
Pre-training layer 2, epoch 21, cost -67.1441518784
Pre-training layer 2, epoch 22, cost -66.8989227931
Pre-training layer 2, epoch 23, cost -66.6628988139
Pre-training layer 2, epoch 24, cost -66.4292299398
Pre-training layer 2, epoch 25, cost -66.2610318629
Pre-training layer 2, epoch 25, representative training free energy 7643.0472085
Pre-training layer 2, epoch 25, validation free energy 7551.33625439
Pre-training layer 2, epoch 26, cost -66.0124070485
Pre-training layer 2, epoch 27, cost -65.8510659409
Pre-training layer 2, epoch 28, cost -65.7233068975
Pre-training layer 2, epoch 29, cost -65.5032401148
Pre-training layer 2, epoch 30, cost -65.4539748764
Pre-training layer 2, epoch 30, representative training free energy 8045.08863159
Pre-training layer 2, epoch 30, validation free energy 7948.65218091
Pre-training layer 2, epoch 31, cost -65.2328155772
Pre-training layer 2, epoch 32, cost -65.1866350047
Pre-training layer 2, epoch 33, cost -65.1175874583
Pre-training layer 2, epoch 34, cost -64.9202095159
Pre-training layer 2, epoch 35, cost -64.8336327998
Pre-training layer 2, epoch 35, representative training free energy 8449.77718042
Pre-training layer 2, epoch 35, validation free energy 8350.15807446
Pre-training layer 2, epoch 36, cost -64.6939153163
Pre-training layer 2, epoch 37, cost -64.5966443507
Pre-training layer 2, epoch 38, cost -64.560705986
Pre-training layer 2, epoch 39, cost -64.4381125005
Pre-training layer 2, epoch 40, cost -64.3911262767
Pre-training layer 2, epoch 40, representative training free energy 8776.12853711
Pre-training layer 2, epoch 40, validation free energy 8673.43019971
Pre-training layer 2, epoch 41, cost -64.344027799
Pre-training layer 2, epoch 42, cost -64.0933468374
Pre-training layer 2, epoch 43, cost -64.0412267939
Pre-training layer 2, epoch 44, cost -64.130674324
Pre-training layer 2, epoch 45, cost -64.0158234533
Pre-training layer 2, epoch 45, representative training free energy 9086.87532275
Pre-training layer 2, epoch 45, validation free energy 8980.48741431
Pre-training layer 2, epoch 46, cost -63.9320624415
Pre-training layer 2, epoch 47, cost -63.8700917435
Pre-training layer 2, epoch 48, cost -63.7316187159
Pre-training layer 2, epoch 49, cost -63.7484914653
Pre-training layer 2, epoch 50, cost -63.5337102763
Pre-training layer 2, epoch 50, representative training free energy 9345.95714233
Pre-training layer 2, epoch 50, validation free energy 9236.06595435
Pre-training layer 2, epoch 51, cost -63.5466441091
Pre-training layer 2, epoch 52, cost -63.47132562
Pre-training layer 2, epoch 53, cost -63.3060652415
Pre-training layer 2, epoch 54, cost -63.3878645579
Pre-training layer 2, epoch 55, cost -63.3093767039
Pre-training layer 2, epoch 55, representative training free energy 9647.01834009
Pre-training layer 2, epoch 55, validation free energy 9534.38657593
Pre-training layer 2, epoch 56, cost -63.3271948242
Pre-training layer 2, epoch 57, cost -63.3465139135
Pre-training layer 2, epoch 58, cost -63.2004570262
Pre-training layer 2, epoch 59, cost -63.1005963643
Pre-training layer 2, epoch 60, cost -63.0027532578
Pre-training layer 2, epoch 60, representative training free energy 9886.41057178
Pre-training layer 2, epoch 60, validation free energy 9769.67230566
Pre-training layer 2, epoch 61, cost -62.935119044
Pre-training layer 2, epoch 62, cost -63.0270723216
Pre-training layer 2, epoch 63, cost -62.9800560252
Pre-training layer 2, epoch 64, cost -62.9402083969
Pre-training layer 2, epoch 65, cost -62.8831816228
Pre-training layer 2, epoch 65, representative training free energy 10099.4438792
Pre-training layer 2, epoch 65, validation free energy 9978.64639355
Pre-training layer 2, epoch 66, cost -62.8557426453
Pre-training layer 2, epoch 67, cost -62.7875771459
Pre-training layer 2, epoch 68, cost -62.7474272029
Pre-training layer 2, epoch 69, cost -62.7542603175
Pre-training layer 2, epoch 70, cost -62.6892725881
Pre-training layer 2, epoch 70, representative training free energy 10366.8667349
Pre-training layer 2, epoch 70, validation free energy 10243.1534583
Pre-training layer 2, epoch 71, cost -62.6747058996
Pre-training layer 2, epoch 72, cost -62.6735430908
Pre-training layer 2, epoch 73, cost -62.5850971095
Pre-training layer 2, epoch 74, cost -62.5003053792
Pre-training layer 2, epoch 75, cost -62.5727521769
Pre-training layer 2, epoch 75, representative training free energy 10573.4352671
Pre-training layer 2, epoch 75, validation free energy 10446.5567063
Pre-training layer 2, epoch 76, cost -62.5141677856
Pre-training layer 2, epoch 77, cost -62.4394156774
Pre-training layer 2, epoch 78, cost -62.4766852315
Pre-training layer 2, epoch 79, cost -62.4257336426
Pre-training layer 2, epoch 80, cost -62.4154471207
Pre-training layer 2, epoch 80, representative training free energy 10773.1988091
Pre-training layer 2, epoch 80, validation free energy 10642.9236689
Pre-training layer 2, epoch 81, cost -62.2701552327
Pre-training layer 2, epoch 82, cost -62.3517156601
Pre-training layer 2, epoch 83, cost -62.2944099299
Pre-training layer 2, epoch 84, cost -62.1712705612
Pre-training layer 2, epoch 85, cost -62.1853256861
Pre-training layer 2, epoch 85, representative training free energy 10995.5575813
Pre-training layer 2, epoch 85, validation free energy 10863.5107302
Pre-training layer 2, epoch 86, cost -62.2660640589
Pre-training layer 2, epoch 87, cost -62.1472938029
Pre-training layer 2, epoch 88, cost -62.1305685806
Pre-training layer 2, epoch 89, cost -62.0381178029
Pre-training layer 2, epoch 90, cost -62.1051318359
Pre-training layer 2, epoch 90, representative training free energy 11195.2484617
Pre-training layer 2, epoch 90, validation free energy 11061.1539026
Pre-training layer 2, epoch 91, cost -62.0500291951
Pre-training layer 2, epoch 92, cost -62.0849884923
Pre-training layer 2, epoch 93, cost -62.0880456289
Pre-training layer 2, epoch 94, cost -62.0456007894
Pre-training layer 2, epoch 95, cost -61.990881424
Pre-training layer 2, epoch 95, representative training free energy 11376.1961865
Pre-training layer 2, epoch 95, validation free energy 11239.4991038
Pre-training layer 2, epoch 96, cost -61.9954082489
Pre-training layer 2, epoch 97, cost -61.9377862295
Pre-training layer 2, epoch 98, cost -61.8316362635
Pre-training layer 2, epoch 99, cost -61.9205721792
The pretraining code for file dbn_loop.pyc ran for 2.87m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 11.200000 %
     epoch 1, minibatch 300/300, test error of best model 11.100000 %
epoch 2, minibatch 300/300, validation error 10.400000 %
     epoch 2, minibatch 300/300, test error of best model 10.000000 %
epoch 3, minibatch 300/300, validation error 9.400000 %
     epoch 3, minibatch 300/300, test error of best model 9.100000 %
epoch 4, minibatch 300/300, validation error 9.000000 %
     epoch 4, minibatch 300/300, test error of best model 8.800000 %
epoch 5, minibatch 300/300, validation error 8.600000 %
     epoch 5, minibatch 300/300, test error of best model 8.300000 %
epoch 6, minibatch 300/300, validation error 8.300000 %
     epoch 6, minibatch 300/300, test error of best model 8.300000 %
epoch 7, minibatch 300/300, validation error 8.200000 %
     epoch 7, minibatch 300/300, test error of best model 8.200000 %
epoch 8, minibatch 300/300, validation error 8.100000 %
     epoch 8, minibatch 300/300, test error of best model 7.900000 %
epoch 9, minibatch 300/300, validation error 8.100000 %
epoch 10, minibatch 300/300, validation error 8.000000 %
     epoch 10, minibatch 300/300, test error of best model 8.000000 %
epoch 11, minibatch 300/300, validation error 8.100000 %
epoch 12, minibatch 300/300, validation error 7.500000 %
     epoch 12, minibatch 300/300, test error of best model 7.700000 %
epoch 13, minibatch 300/300, validation error 7.600000 %
epoch 14, minibatch 300/300, validation error 7.500000 %
epoch 15, minibatch 300/300, validation error 7.400000 %
     epoch 15, minibatch 300/300, test error of best model 7.600000 %
epoch 16, minibatch 300/300, validation error 7.400000 %
epoch 17, minibatch 300/300, validation error 7.500000 %
epoch 18, minibatch 300/300, validation error 7.500000 %
epoch 19, minibatch 300/300, validation error 7.400000 %
epoch 20, minibatch 300/300, validation error 7.200000 %
     epoch 20, minibatch 300/300, test error of best model 7.700000 %
epoch 21, minibatch 300/300, validation error 7.200000 %
epoch 22, minibatch 300/300, validation error 7.200000 %
epoch 23, minibatch 300/300, validation error 7.300000 %
epoch 24, minibatch 300/300, validation error 7.400000 %
epoch 25, minibatch 300/300, validation error 7.500000 %
epoch 26, minibatch 300/300, validation error 7.500000 %
epoch 27, minibatch 300/300, validation error 7.300000 %
epoch 28, minibatch 300/300, validation error 7.300000 %
epoch 29, minibatch 300/300, validation error 7.300000 %
epoch 30, minibatch 300/300, validation error 7.500000 %
epoch 31, minibatch 300/300, validation error 7.400000 %
epoch 32, minibatch 300/300, validation error 7.400000 %
epoch 33, minibatch 300/300, validation error 7.000000 %
     epoch 33, minibatch 300/300, test error of best model 7.100000 %
epoch 34, minibatch 300/300, validation error 6.900000 %
     epoch 34, minibatch 300/300, test error of best model 7.200000 %
epoch 35, minibatch 300/300, validation error 6.700000 %
     epoch 35, minibatch 300/300, test error of best model 7.100000 %
epoch 36, minibatch 300/300, validation error 6.700000 %
epoch 37, minibatch 300/300, validation error 6.700000 %
epoch 38, minibatch 300/300, validation error 6.700000 %
epoch 39, minibatch 300/300, validation error 6.600000 %
     epoch 39, minibatch 300/300, test error of best model 7.000000 %
epoch 40, minibatch 300/300, validation error 6.600000 %
epoch 41, minibatch 300/300, validation error 6.500000 %
     epoch 41, minibatch 300/300, test error of best model 7.000000 %
epoch 42, minibatch 300/300, validation error 6.600000 %
epoch 43, minibatch 300/300, validation error 6.500000 %
epoch 44, minibatch 300/300, validation error 6.400000 %
     epoch 44, minibatch 300/300, test error of best model 6.900000 %
epoch 45, minibatch 300/300, validation error 6.300000 %
     epoch 45, minibatch 300/300, test error of best model 6.800000 %
epoch 46, minibatch 300/300, validation error 6.300000 %
epoch 47, minibatch 300/300, validation error 6.300000 %
epoch 48, minibatch 300/300, validation error 6.300000 %
epoch 49, minibatch 300/300, validation error 6.300000 %
epoch 50, minibatch 300/300, validation error 6.400000 %
epoch 51, minibatch 300/300, validation error 6.300000 %
epoch 52, minibatch 300/300, validation error 6.300000 %
epoch 53, minibatch 300/300, validation error 6.300000 %
epoch 54, minibatch 300/300, validation error 6.300000 %
epoch 55, minibatch 300/300, validation error 6.300000 %
epoch 56, minibatch 300/300, validation error 6.300000 %
epoch 57, minibatch 300/300, validation error 6.300000 %
epoch 58, minibatch 300/300, validation error 6.300000 %
epoch 59, minibatch 300/300, validation error 6.300000 %
epoch 60, minibatch 300/300, validation error 6.200000 %
     epoch 60, minibatch 300/300, test error of best model 7.200000 %
epoch 61, minibatch 300/300, validation error 6.200000 %
epoch 62, minibatch 300/300, validation error 6.200000 %
epoch 63, minibatch 300/300, validation error 6.200000 %
epoch 64, minibatch 300/300, validation error 6.200000 %
epoch 65, minibatch 300/300, validation error 6.200000 %
epoch 66, minibatch 300/300, validation error 6.200000 %
epoch 67, minibatch 300/300, validation error 6.200000 %
epoch 68, minibatch 300/300, validation error 6.100000 %
     epoch 68, minibatch 300/300, test error of best model 7.100000 %
epoch 69, minibatch 300/300, validation error 6.100000 %
epoch 70, minibatch 300/300, validation error 6.100000 %
epoch 71, minibatch 300/300, validation error 6.100000 %
epoch 72, minibatch 300/300, validation error 6.100000 %
epoch 73, minibatch 300/300, validation error 6.100000 %
epoch 74, minibatch 300/300, validation error 6.000000 %
     epoch 74, minibatch 300/300, test error of best model 7.100000 %
epoch 75, minibatch 300/300, validation error 6.000000 %
epoch 76, minibatch 300/300, validation error 6.000000 %
epoch 77, minibatch 300/300, validation error 6.000000 %
epoch 78, minibatch 300/300, validation error 6.000000 %
epoch 79, minibatch 300/300, validation error 6.000000 %
epoch 80, minibatch 300/300, validation error 6.000000 %
epoch 81, minibatch 300/300, validation error 6.000000 %
epoch 82, minibatch 300/300, validation error 6.000000 %
epoch 83, minibatch 300/300, validation error 6.000000 %
epoch 84, minibatch 300/300, validation error 6.000000 %
epoch 85, minibatch 300/300, validation error 6.000000 %
epoch 86, minibatch 300/300, validation error 6.000000 %
epoch 87, minibatch 300/300, validation error 6.000000 %
epoch 88, minibatch 300/300, validation error 6.000000 %
epoch 89, minibatch 300/300, validation error 6.000000 %
epoch 90, minibatch 300/300, validation error 6.000000 %
epoch 91, minibatch 300/300, validation error 6.000000 %
epoch 92, minibatch 300/300, validation error 6.000000 %
epoch 93, minibatch 300/300, validation error 6.000000 %
epoch 94, minibatch 300/300, validation error 6.000000 %
epoch 95, minibatch 300/300, validation error 6.000000 %
epoch 96, minibatch 300/300, validation error 6.000000 %
epoch 97, minibatch 300/300, validation error 6.000000 %
epoch 98, minibatch 300/300, validation error 6.000000 %
epoch 99, minibatch 300/300, validation error 6.000000 %
epoch 100, minibatch 300/300, validation error 6.000000 %
epoch 101, minibatch 300/300, validation error 6.000000 %
epoch 102, minibatch 300/300, validation error 6.000000 %
epoch 103, minibatch 300/300, validation error 5.900000 %
     epoch 103, minibatch 300/300, test error of best model 7.100000 %
epoch 104, minibatch 300/300, validation error 5.900000 %
epoch 105, minibatch 300/300, validation error 5.800000 %
     epoch 105, minibatch 300/300, test error of best model 7.100000 %
epoch 106, minibatch 300/300, validation error 5.800000 %
epoch 107, minibatch 300/300, validation error 5.800000 %
epoch 108, minibatch 300/300, validation error 5.800000 %
epoch 109, minibatch 300/300, validation error 5.800000 %
epoch 110, minibatch 300/300, validation error 5.800000 %
epoch 111, minibatch 300/300, validation error 5.800000 %
epoch 112, minibatch 300/300, validation error 5.800000 %
epoch 113, minibatch 300/300, validation error 5.800000 %
epoch 114, minibatch 300/300, validation error 5.800000 %
epoch 115, minibatch 300/300, validation error 5.800000 %
epoch 116, minibatch 300/300, validation error 5.800000 %
epoch 117, minibatch 300/300, validation error 5.800000 %
epoch 118, minibatch 300/300, validation error 5.800000 %
epoch 119, minibatch 300/300, validation error 5.800000 %
epoch 120, minibatch 300/300, validation error 5.800000 %
epoch 121, minibatch 300/300, validation error 5.800000 %
epoch 122, minibatch 300/300, validation error 5.800000 %
epoch 123, minibatch 300/300, validation error 5.800000 %
epoch 124, minibatch 300/300, validation error 5.800000 %
epoch 125, minibatch 300/300, validation error 5.800000 %
epoch 126, minibatch 300/300, validation error 5.800000 %
epoch 127, minibatch 300/300, validation error 5.800000 %
epoch 128, minibatch 300/300, validation error 5.800000 %
epoch 129, minibatch 300/300, validation error 5.800000 %
epoch 130, minibatch 300/300, validation error 5.800000 %
epoch 131, minibatch 300/300, validation error 5.800000 %
epoch 132, minibatch 300/300, validation error 5.800000 %
epoch 133, minibatch 300/300, validation error 5.800000 %
epoch 134, minibatch 300/300, validation error 5.800000 %
epoch 135, minibatch 300/300, validation error 5.800000 %
epoch 136, minibatch 300/300, validation error 5.800000 %
epoch 137, minibatch 300/300, validation error 5.800000 %
epoch 138, minibatch 300/300, validation error 5.800000 %
epoch 139, minibatch 300/300, validation error 5.800000 %
epoch 140, minibatch 300/300, validation error 5.800000 %
epoch 141, minibatch 300/300, validation error 5.800000 %
epoch 142, minibatch 300/300, validation error 5.800000 %
epoch 143, minibatch 300/300, validation error 5.800000 %
epoch 144, minibatch 300/300, validation error 5.800000 %
epoch 145, minibatch 300/300, validation error 5.800000 %
epoch 146, minibatch 300/300, validation error 5.800000 %
epoch 147, minibatch 300/300, validation error 5.800000 %
epoch 148, minibatch 300/300, validation error 5.800000 %
epoch 149, minibatch 300/300, validation error 5.800000 %
epoch 150, minibatch 300/300, validation error 5.800000 %
epoch 151, minibatch 300/300, validation error 5.800000 %
epoch 152, minibatch 300/300, validation error 5.800000 %
epoch 153, minibatch 300/300, validation error 5.800000 %
epoch 154, minibatch 300/300, validation error 5.800000 %
epoch 155, minibatch 300/300, validation error 5.800000 %
epoch 156, minibatch 300/300, validation error 5.800000 %
epoch 157, minibatch 300/300, validation error 5.800000 %
epoch 158, minibatch 300/300, validation error 5.800000 %
epoch 159, minibatch 300/300, validation error 5.800000 %
epoch 160, minibatch 300/300, validation error 5.800000 %
epoch 161, minibatch 300/300, validation error 5.800000 %
epoch 162, minibatch 300/300, validation error 5.800000 %
epoch 163, minibatch 300/300, validation error 5.800000 %
epoch 164, minibatch 300/300, validation error 5.800000 %
epoch 165, minibatch 300/300, validation error 5.800000 %
epoch 166, minibatch 300/300, validation error 5.800000 %
epoch 167, minibatch 300/300, validation error 5.800000 %
epoch 168, minibatch 300/300, validation error 5.800000 %
epoch 169, minibatch 300/300, validation error 5.700000 %
     epoch 169, minibatch 300/300, test error of best model 7.100000 %
epoch 170, minibatch 300/300, validation error 5.700000 %
epoch 171, minibatch 300/300, validation error 5.700000 %
epoch 172, minibatch 300/300, validation error 5.700000 %
epoch 173, minibatch 300/300, validation error 5.800000 %
epoch 174, minibatch 300/300, validation error 5.800000 %
epoch 175, minibatch 300/300, validation error 5.800000 %
epoch 176, minibatch 300/300, validation error 5.800000 %
epoch 177, minibatch 300/300, validation error 5.800000 %
epoch 178, minibatch 300/300, validation error 5.800000 %
epoch 179, minibatch 300/300, validation error 5.800000 %
epoch 180, minibatch 300/300, validation error 5.800000 %
epoch 181, minibatch 300/300, validation error 5.800000 %
epoch 182, minibatch 300/300, validation error 5.800000 %
epoch 183, minibatch 300/300, validation error 5.800000 %
epoch 184, minibatch 300/300, validation error 5.800000 %
epoch 185, minibatch 300/300, validation error 5.800000 %
epoch 186, minibatch 300/300, validation error 5.800000 %
epoch 187, minibatch 300/300, validation error 5.800000 %
epoch 188, minibatch 300/300, validation error 5.800000 %
epoch 189, minibatch 300/300, validation error 5.800000 %
epoch 190, minibatch 300/300, validation error 5.800000 %
epoch 191, minibatch 300/300, validation error 5.800000 %
epoch 192, minibatch 300/300, validation error 5.800000 %
epoch 193, minibatch 300/300, validation error 5.800000 %
epoch 194, minibatch 300/300, validation error 5.800000 %
epoch 195, minibatch 300/300, validation error 5.800000 %
epoch 196, minibatch 300/300, validation error 5.800000 %
epoch 197, minibatch 300/300, validation error 5.800000 %
epoch 198, minibatch 300/300, validation error 5.800000 %
epoch 199, minibatch 300/300, validation error 5.700000 %
epoch 200, minibatch 300/300, validation error 5.700000 %
epoch 201, minibatch 300/300, validation error 5.700000 %
epoch 202, minibatch 300/300, validation error 5.700000 %
epoch 203, minibatch 300/300, validation error 5.700000 %
epoch 204, minibatch 300/300, validation error 5.700000 %
epoch 205, minibatch 300/300, validation error 5.700000 %
epoch 206, minibatch 300/300, validation error 5.700000 %
epoch 207, minibatch 300/300, validation error 5.700000 %
epoch 208, minibatch 300/300, validation error 5.700000 %
epoch 209, minibatch 300/300, validation error 5.700000 %
epoch 210, minibatch 300/300, validation error 5.700000 %
epoch 211, minibatch 300/300, validation error 5.700000 %
epoch 212, minibatch 300/300, validation error 5.700000 %
epoch 213, minibatch 300/300, validation error 5.700000 %
epoch 214, minibatch 300/300, validation error 5.700000 %
epoch 215, minibatch 300/300, validation error 5.700000 %
epoch 216, minibatch 300/300, validation error 5.700000 %
epoch 217, minibatch 300/300, validation error 5.700000 %
epoch 218, minibatch 300/300, validation error 5.700000 %
epoch 219, minibatch 300/300, validation error 5.700000 %
epoch 220, minibatch 300/300, validation error 5.700000 %
epoch 221, minibatch 300/300, validation error 5.700000 %
epoch 222, minibatch 300/300, validation error 5.700000 %
epoch 223, minibatch 300/300, validation error 5.700000 %
epoch 224, minibatch 300/300, validation error 5.700000 %
epoch 225, minibatch 300/300, validation error 5.700000 %
epoch 226, minibatch 300/300, validation error 5.700000 %
epoch 227, minibatch 300/300, validation error 5.700000 %
epoch 228, minibatch 300/300, validation error 5.700000 %
epoch 229, minibatch 300/300, validation error 5.700000 %
epoch 230, minibatch 300/300, validation error 5.700000 %
epoch 231, minibatch 300/300, validation error 5.700000 %
epoch 232, minibatch 300/300, validation error 5.700000 %
epoch 233, minibatch 300/300, validation error 5.700000 %
epoch 234, minibatch 300/300, validation error 5.700000 %
epoch 235, minibatch 300/300, validation error 5.700000 %
epoch 236, minibatch 300/300, validation error 5.700000 %
epoch 237, minibatch 300/300, validation error 5.700000 %
epoch 238, minibatch 300/300, validation error 5.700000 %
epoch 239, minibatch 300/300, validation error 5.700000 %
epoch 240, minibatch 300/300, validation error 5.700000 %
epoch 241, minibatch 300/300, validation error 5.700000 %
epoch 242, minibatch 300/300, validation error 5.700000 %
epoch 243, minibatch 300/300, validation error 5.700000 %
epoch 244, minibatch 300/300, validation error 5.700000 %
epoch 245, minibatch 300/300, validation error 5.700000 %
epoch 246, minibatch 300/300, validation error 5.700000 %
epoch 247, minibatch 300/300, validation error 5.700000 %
epoch 248, minibatch 300/300, validation error 5.700000 %
epoch 249, minibatch 300/300, validation error 5.700000 %
epoch 250, minibatch 300/300, validation error 5.700000 %
epoch 251, minibatch 300/300, validation error 5.700000 %
epoch 252, minibatch 300/300, validation error 5.700000 %
epoch 253, minibatch 300/300, validation error 5.700000 %
epoch 254, minibatch 300/300, validation error 5.700000 %
epoch 255, minibatch 300/300, validation error 5.700000 %
epoch 256, minibatch 300/300, validation error 5.700000 %
epoch 257, minibatch 300/300, validation error 5.700000 %
epoch 258, minibatch 300/300, validation error 5.700000 %
epoch 259, minibatch 300/300, validation error 5.700000 %
epoch 260, minibatch 300/300, validation error 5.700000 %
epoch 261, minibatch 300/300, validation error 5.700000 %
epoch 262, minibatch 300/300, validation error 5.700000 %
epoch 263, minibatch 300/300, validation error 5.700000 %
epoch 264, minibatch 300/300, validation error 5.700000 %
epoch 265, minibatch 300/300, validation error 5.700000 %
epoch 266, minibatch 300/300, validation error 5.700000 %
epoch 267, minibatch 300/300, validation error 5.700000 %
epoch 268, minibatch 300/300, validation error 5.700000 %
epoch 269, minibatch 300/300, validation error 5.700000 %
epoch 270, minibatch 300/300, validation error 5.700000 %
epoch 271, minibatch 300/300, validation error 5.700000 %
epoch 272, minibatch 300/300, validation error 5.700000 %
epoch 273, minibatch 300/300, validation error 5.700000 %
epoch 274, minibatch 300/300, validation error 5.700000 %
epoch 275, minibatch 300/300, validation error 5.700000 %
epoch 276, minibatch 300/300, validation error 5.700000 %
epoch 277, minibatch 300/300, validation error 5.700000 %
epoch 278, minibatch 300/300, validation error 5.700000 %
epoch 279, minibatch 300/300, validation error 5.700000 %
epoch 280, minibatch 300/300, validation error 5.700000 %
epoch 281, minibatch 300/300, validation error 5.700000 %
epoch 282, minibatch 300/300, validation error 5.700000 %
epoch 283, minibatch 300/300, validation error 5.700000 %
epoch 284, minibatch 300/300, validation error 5.700000 %
epoch 285, minibatch 300/300, validation error 5.700000 %
epoch 286, minibatch 300/300, validation error 5.700000 %
epoch 287, minibatch 300/300, validation error 5.700000 %
epoch 288, minibatch 300/300, validation error 5.700000 %
epoch 289, minibatch 300/300, validation error 5.700000 %
epoch 290, minibatch 300/300, validation error 5.700000 %
epoch 291, minibatch 300/300, validation error 5.700000 %
epoch 292, minibatch 300/300, validation error 5.700000 %
epoch 293, minibatch 300/300, validation error 5.700000 %
epoch 294, minibatch 300/300, validation error 5.700000 %
epoch 295, minibatch 300/300, validation error 5.700000 %
epoch 296, minibatch 300/300, validation error 5.700000 %
epoch 297, minibatch 300/300, validation error 5.700000 %
epoch 298, minibatch 300/300, validation error 5.700000 %
epoch 299, minibatch 300/300, validation error 5.700000 %
epoch 300, minibatch 300/300, validation error 5.700000 %
epoch 301, minibatch 300/300, validation error 5.700000 %
epoch 302, minibatch 300/300, validation error 5.700000 %
epoch 303, minibatch 300/300, validation error 5.700000 %
epoch 304, minibatch 300/300, validation error 5.700000 %
epoch 305, minibatch 300/300, validation error 5.700000 %
epoch 306, minibatch 300/300, validation error 5.700000 %
epoch 307, minibatch 300/300, validation error 5.700000 %
epoch 308, minibatch 300/300, validation error 5.700000 %
epoch 309, minibatch 300/300, validation error 5.700000 %
epoch 310, minibatch 300/300, validation error 5.700000 %
epoch 311, minibatch 300/300, validation error 5.700000 %
epoch 312, minibatch 300/300, validation error 5.700000 %
epoch 313, minibatch 300/300, validation error 5.700000 %
epoch 314, minibatch 300/300, validation error 5.700000 %
epoch 315, minibatch 300/300, validation error 5.700000 %
epoch 316, minibatch 300/300, validation error 5.700000 %
epoch 317, minibatch 300/300, validation error 5.700000 %
epoch 318, minibatch 300/300, validation error 5.700000 %
epoch 319, minibatch 300/300, validation error 5.700000 %
epoch 320, minibatch 300/300, validation error 5.700000 %
epoch 321, minibatch 300/300, validation error 5.700000 %
epoch 322, minibatch 300/300, validation error 5.700000 %
epoch 323, minibatch 300/300, validation error 5.700000 %
epoch 324, minibatch 300/300, validation error 5.700000 %
epoch 325, minibatch 300/300, validation error 5.700000 %
epoch 326, minibatch 300/300, validation error 5.700000 %
epoch 327, minibatch 300/300, validation error 5.700000 %
epoch 328, minibatch 300/300, validation error 5.700000 %
epoch 329, minibatch 300/300, validation error 5.700000 %
epoch 330, minibatch 300/300, validation error 5.700000 %
epoch 331, minibatch 300/300, validation error 5.700000 %
epoch 332, minibatch 300/300, validation error 5.700000 %
epoch 333, minibatch 300/300, validation error 5.700000 %
epoch 334, minibatch 300/300, validation error 5.700000 %
epoch 335, minibatch 300/300, validation error 5.700000 %
epoch 336, minibatch 300/300, validation error 5.700000 %
epoch 337, minibatch 300/300, validation error 5.700000 %
Optimization complete with best validation score of 5.700000 %, obtained at iteration 50700, with test performance 7.100000 %
The fine tuning code for file dbn_loop.pyc ran for 4.28m


==========Sample Size: (4000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -142.452370701
Pre-training layer 0, epoch 0, representative training free energy -549.823452026
Pre-training layer 0, epoch 0, validation free energy -547.664627228
Pre-training layer 0, epoch 1, cost -111.174816475
Pre-training layer 0, epoch 2, cost -103.112398357
Pre-training layer 0, epoch 3, cost -98.2328974533
Pre-training layer 0, epoch 4, cost -94.8380142212
Pre-training layer 0, epoch 5, cost -92.6447031021
Pre-training layer 0, epoch 5, representative training free energy -489.741098694
Pre-training layer 0, epoch 5, validation free energy -486.50789035
Pre-training layer 0, epoch 6, cost -90.7870099258
Pre-training layer 0, epoch 7, cost -89.3381396866
Pre-training layer 0, epoch 8, cost -87.9828626251
Pre-training layer 0, epoch 9, cost -87.044938488
Pre-training layer 0, epoch 10, cost -86.062218008
Pre-training layer 0, epoch 10, representative training free energy -463.359261414
Pre-training layer 0, epoch 10, validation free energy -458.964951843
Pre-training layer 0, epoch 11, cost -85.3773506355
Pre-training layer 0, epoch 12, cost -84.776538868
Pre-training layer 0, epoch 13, cost -84.031014967
Pre-training layer 0, epoch 14, cost -83.4369634438
Pre-training layer 0, epoch 15, cost -82.7404147816
Pre-training layer 0, epoch 15, representative training free energy -454.529961914
Pre-training layer 0, epoch 15, validation free energy -449.162814362
Pre-training layer 0, epoch 16, cost -82.2997593307
Pre-training layer 0, epoch 17, cost -82.0193864155
Pre-training layer 0, epoch 18, cost -81.6879644012
Pre-training layer 0, epoch 19, cost -81.1883974361
Pre-training layer 0, epoch 20, cost -80.8317415714
Pre-training layer 0, epoch 20, representative training free energy -445.771438873
Pre-training layer 0, epoch 20, validation free energy -440.701342377
Pre-training layer 0, epoch 21, cost -80.6095152283
Pre-training layer 0, epoch 22, cost -80.2074804688
Pre-training layer 0, epoch 23, cost -79.9021145439
Pre-training layer 0, epoch 24, cost -79.6719746304
Pre-training layer 0, epoch 25, cost -79.488828764
Pre-training layer 0, epoch 25, representative training free energy -439.096703094
Pre-training layer 0, epoch 25, validation free energy -433.078550201
Pre-training layer 0, epoch 26, cost -79.0614862347
Pre-training layer 0, epoch 27, cost -79.0131433105
Pre-training layer 0, epoch 28, cost -78.9178132343
Pre-training layer 0, epoch 29, cost -78.6449839687
Pre-training layer 0, epoch 30, cost -78.2431401634
Pre-training layer 0, epoch 30, representative training free energy -437.422774445
Pre-training layer 0, epoch 30, validation free energy -430.861168121
Pre-training layer 0, epoch 31, cost -78.1035727501
Pre-training layer 0, epoch 32, cost -78.0058252239
Pre-training layer 0, epoch 33, cost -77.7108917618
Pre-training layer 0, epoch 34, cost -77.6162019634
Pre-training layer 0, epoch 35, cost -77.3950459099
Pre-training layer 0, epoch 35, representative training free energy -430.216882324
Pre-training layer 0, epoch 35, validation free energy -424.601089264
Pre-training layer 0, epoch 36, cost -77.1144544125
Pre-training layer 0, epoch 37, cost -76.9970152569
Pre-training layer 0, epoch 38, cost -76.983923378
Pre-training layer 0, epoch 39, cost -76.8102067375
Pre-training layer 0, epoch 40, cost -76.7857614422
Pre-training layer 0, epoch 40, representative training free energy -430.997902313
Pre-training layer 0, epoch 40, validation free energy -424.075710052
Pre-training layer 0, epoch 41, cost -76.564783287
Pre-training layer 0, epoch 42, cost -76.3418405819
Pre-training layer 0, epoch 43, cost -76.4081572056
Pre-training layer 0, epoch 44, cost -76.104199419
Pre-training layer 0, epoch 45, cost -76.0544278622
Pre-training layer 0, epoch 45, representative training free energy -426.687574799
Pre-training layer 0, epoch 45, validation free energy -419.599572723
Pre-training layer 0, epoch 46, cost -75.9490811253
Pre-training layer 0, epoch 47, cost -75.7565906143
Pre-training layer 0, epoch 48, cost -75.6148116207
Pre-training layer 0, epoch 49, cost -75.626960144
Pre-training layer 0, epoch 50, cost -75.4756722641
Pre-training layer 0, epoch 50, representative training free energy -426.44449704
Pre-training layer 0, epoch 50, validation free energy -419.27085965
Pre-training layer 0, epoch 51, cost -75.3668150043
Pre-training layer 0, epoch 52, cost -75.3485889053
Pre-training layer 0, epoch 53, cost -75.1672941971
Pre-training layer 0, epoch 54, cost -75.0381527805
Pre-training layer 0, epoch 55, cost -75.1037940311
Pre-training layer 0, epoch 55, representative training free energy -427.994894287
Pre-training layer 0, epoch 55, validation free energy -420.544771973
Pre-training layer 0, epoch 56, cost -74.9488749886
Pre-training layer 0, epoch 57, cost -74.843890295
Pre-training layer 0, epoch 58, cost -74.8212858963
Pre-training layer 0, epoch 59, cost -74.7632919216
Pre-training layer 0, epoch 60, cost -74.612410965
Pre-training layer 0, epoch 60, representative training free energy -424.714530884
Pre-training layer 0, epoch 60, validation free energy -416.943992004
Pre-training layer 0, epoch 61, cost -74.5894230938
Pre-training layer 0, epoch 62, cost -74.6133636951
Pre-training layer 0, epoch 63, cost -74.256080904
Pre-training layer 0, epoch 64, cost -74.1830072689
Pre-training layer 0, epoch 65, cost -74.241361227
Pre-training layer 0, epoch 65, representative training free energy -419.174532379
Pre-training layer 0, epoch 65, validation free energy -411.381884766
Pre-training layer 0, epoch 66, cost -74.2023338699
Pre-training layer 0, epoch 67, cost -74.1038944817
Pre-training layer 0, epoch 68, cost -74.1186953354
Pre-training layer 0, epoch 69, cost -73.8713643551
Pre-training layer 0, epoch 70, cost -73.8811444569
Pre-training layer 0, epoch 70, representative training free energy -425.288008179
Pre-training layer 0, epoch 70, validation free energy -416.936465332
Pre-training layer 0, epoch 71, cost -73.9071039677
Pre-training layer 0, epoch 72, cost -73.6705687332
Pre-training layer 0, epoch 73, cost -73.640048418
Pre-training layer 0, epoch 74, cost -73.6529800701
Pre-training layer 0, epoch 75, cost -73.5373592854
Pre-training layer 0, epoch 75, representative training free energy -420.533655334
Pre-training layer 0, epoch 75, validation free energy -413.062720123
Pre-training layer 0, epoch 76, cost -73.4368575096
Pre-training layer 0, epoch 77, cost -73.3904478645
Pre-training layer 0, epoch 78, cost -73.4322565269
Pre-training layer 0, epoch 79, cost -73.3516088104
Pre-training layer 0, epoch 80, cost -73.1838020897
Pre-training layer 0, epoch 80, representative training free energy -418.545623352
Pre-training layer 0, epoch 80, validation free energy -410.211135468
Pre-training layer 0, epoch 81, cost -73.206779623
Pre-training layer 0, epoch 82, cost -73.1208646202
Pre-training layer 0, epoch 83, cost -73.0761749077
Pre-training layer 0, epoch 84, cost -73.0642797089
Pre-training layer 0, epoch 85, cost -72.9622745609
Pre-training layer 0, epoch 85, representative training free energy -418.156530121
Pre-training layer 0, epoch 85, validation free energy -410.326708801
Pre-training layer 0, epoch 86, cost -72.9320974636
Pre-training layer 0, epoch 87, cost -72.8037881565
Pre-training layer 0, epoch 88, cost -72.8219000244
Pre-training layer 0, epoch 89, cost -72.859594202
Pre-training layer 0, epoch 90, cost -72.6783173275
Pre-training layer 0, epoch 90, representative training free energy -418.091686859
Pre-training layer 0, epoch 90, validation free energy -409.637865662
Pre-training layer 0, epoch 91, cost -72.7430359364
Pre-training layer 0, epoch 92, cost -72.6620042801
Pre-training layer 0, epoch 93, cost -72.5035300636
Pre-training layer 0, epoch 94, cost -72.5217708778
Pre-training layer 0, epoch 95, cost -72.5502914143
Pre-training layer 0, epoch 95, representative training free energy -416.266100494
Pre-training layer 0, epoch 95, validation free energy -407.848406769
Pre-training layer 0, epoch 96, cost -72.4245638561
Pre-training layer 0, epoch 97, cost -72.4150093555
Pre-training layer 0, epoch 98, cost -72.3763288403
Pre-training layer 0, epoch 99, cost -72.2406241798
Pre-training layer 1, epoch 0, cost -324.496184006
Pre-training layer 1, epoch 0, representative training free energy -58225.0369824
Pre-training layer 1, epoch 0, validation free energy -57656.8961191
Pre-training layer 1, epoch 1, cost -279.000039177
Pre-training layer 1, epoch 2, cost -265.263033066
Pre-training layer 1, epoch 3, cost -257.045785332
Pre-training layer 1, epoch 4, cost -251.449254417
Pre-training layer 1, epoch 5, cost -247.302918968
Pre-training layer 1, epoch 5, representative training free energy -78207.772543
Pre-training layer 1, epoch 5, validation free energy -77364.2150918
Pre-training layer 1, epoch 6, cost -244.160388412
Pre-training layer 1, epoch 7, cost -241.631961632
Pre-training layer 1, epoch 8, cost -239.51573719
Pre-training layer 1, epoch 9, cost -237.918837204
Pre-training layer 1, epoch 10, cost -236.370646667
Pre-training layer 1, epoch 10, representative training free energy -84235.8239434
Pre-training layer 1, epoch 10, validation free energy -83303.7307246
Pre-training layer 1, epoch 11, cost -235.133171692
Pre-training layer 1, epoch 12, cost -233.925178032
Pre-training layer 1, epoch 13, cost -232.900464516
Pre-training layer 1, epoch 14, cost -231.978343391
Pre-training layer 1, epoch 15, cost -231.226411133
Pre-training layer 1, epoch 15, representative training free energy -87923.3365684
Pre-training layer 1, epoch 15, validation free energy -86953.3321719
Pre-training layer 1, epoch 16, cost -230.488439484
Pre-training layer 1, epoch 17, cost -229.792967758
Pre-training layer 1, epoch 18, cost -229.133422966
Pre-training layer 1, epoch 19, cost -228.644523277
Pre-training layer 1, epoch 20, cost -228.105270996
Pre-training layer 1, epoch 20, representative training free energy -90524.4674316
Pre-training layer 1, epoch 20, validation free energy -89505.5053633
Pre-training layer 1, epoch 21, cost -227.617380257
Pre-training layer 1, epoch 22, cost -227.183426323
Pre-training layer 1, epoch 23, cost -226.773335648
Pre-training layer 1, epoch 24, cost -226.285488586
Pre-training layer 1, epoch 25, cost -225.954972878
Pre-training layer 1, epoch 25, representative training free energy -92394.494918
Pre-training layer 1, epoch 25, validation free energy -91362.9075352
Pre-training layer 1, epoch 26, cost -225.575480537
Pre-training layer 1, epoch 27, cost -225.275785103
Pre-training layer 1, epoch 28, cost -224.916777763
Pre-training layer 1, epoch 29, cost -224.713973694
Pre-training layer 1, epoch 30, cost -224.433196678
Pre-training layer 1, epoch 30, representative training free energy -94089.664334
Pre-training layer 1, epoch 30, validation free energy -93039.9299414
Pre-training layer 1, epoch 31, cost -224.046122169
Pre-training layer 1, epoch 32, cost -223.838053856
Pre-training layer 1, epoch 33, cost -223.614620132
Pre-training layer 1, epoch 34, cost -223.359406586
Pre-training layer 1, epoch 35, cost -222.999113579
Pre-training layer 1, epoch 35, representative training free energy -95402.7729883
Pre-training layer 1, epoch 35, validation free energy -94340.8394883
Pre-training layer 1, epoch 36, cost -222.908700256
Pre-training layer 1, epoch 37, cost -222.732155342
Pre-training layer 1, epoch 38, cost -222.388402023
Pre-training layer 1, epoch 39, cost -222.271215782
Pre-training layer 1, epoch 40, cost -222.098159409
Pre-training layer 1, epoch 40, representative training free energy -96610.6090723
Pre-training layer 1, epoch 40, validation free energy -95534.6355234
Pre-training layer 1, epoch 41, cost -221.972763939
Pre-training layer 1, epoch 42, cost -221.83678463
Pre-training layer 1, epoch 43, cost -221.543933411
Pre-training layer 1, epoch 44, cost -221.458730316
Pre-training layer 1, epoch 45, cost -221.353566704
Pre-training layer 1, epoch 45, representative training free energy -97802.1218711
Pre-training layer 1, epoch 45, validation free energy -96709.1730273
Pre-training layer 1, epoch 46, cost -221.128068924
Pre-training layer 1, epoch 47, cost -220.969734383
Pre-training layer 1, epoch 48, cost -220.880306664
Pre-training layer 1, epoch 49, cost -220.714028091
Pre-training layer 1, epoch 50, cost -220.583356056
Pre-training layer 1, epoch 50, representative training free energy -98721.7160605
Pre-training layer 1, epoch 50, validation free energy -97610.911293
Pre-training layer 1, epoch 51, cost -220.413202858
Pre-training layer 1, epoch 52, cost -220.348670921
Pre-training layer 1, epoch 53, cost -220.213467445
Pre-training layer 1, epoch 54, cost -219.981850815
Pre-training layer 1, epoch 55, cost -219.927260399
Pre-training layer 1, epoch 55, representative training free energy -99673.4754473
Pre-training layer 1, epoch 55, validation free energy -98550.9055586
Pre-training layer 1, epoch 56, cost -219.974840775
Pre-training layer 1, epoch 57, cost -219.794151993
Pre-training layer 1, epoch 58, cost -219.632496109
Pre-training layer 1, epoch 59, cost -219.552636604
Pre-training layer 1, epoch 60, cost -219.449943848
Pre-training layer 1, epoch 60, representative training free energy -100468.34834
Pre-training layer 1, epoch 60, validation free energy -99331.6135996
Pre-training layer 1, epoch 61, cost -219.417410355
Pre-training layer 1, epoch 62, cost -219.14073967
Pre-training layer 1, epoch 63, cost -219.137193947
Pre-training layer 1, epoch 64, cost -219.065674019
Pre-training layer 1, epoch 65, cost -219.002895889
Pre-training layer 1, epoch 65, representative training free energy -101284.134184
Pre-training layer 1, epoch 65, validation free energy -100129.342
Pre-training layer 1, epoch 66, cost -218.972282829
Pre-training layer 1, epoch 67, cost -218.83027771
Pre-training layer 1, epoch 68, cost -218.710650864
Pre-training layer 1, epoch 69, cost -218.611393318
Pre-training layer 1, epoch 70, cost -218.482289085
Pre-training layer 1, epoch 70, representative training free energy -101933.167828
Pre-training layer 1, epoch 70, validation free energy -100773.912348
Pre-training layer 1, epoch 71, cost -218.383271904
Pre-training layer 1, epoch 72, cost -218.361815147
Pre-training layer 1, epoch 73, cost -218.183628883
Pre-training layer 1, epoch 74, cost -218.212159348
Pre-training layer 1, epoch 75, cost -218.150686302
Pre-training layer 1, epoch 75, representative training free energy -102744.947041
Pre-training layer 1, epoch 75, validation free energy -101574.406906
Pre-training layer 1, epoch 76, cost -218.085211563
Pre-training layer 1, epoch 77, cost -218.006799469
Pre-training layer 1, epoch 78, cost -217.949705544
Pre-training layer 1, epoch 79, cost -217.807684021
Pre-training layer 1, epoch 80, cost -217.754633408
Pre-training layer 1, epoch 80, representative training free energy -103260.916133
Pre-training layer 1, epoch 80, validation free energy -102091.706094
Pre-training layer 1, epoch 81, cost -217.760944901
Pre-training layer 1, epoch 82, cost -217.664867516
Pre-training layer 1, epoch 83, cost -217.655588341
Pre-training layer 1, epoch 84, cost -217.497252884
Pre-training layer 1, epoch 85, cost -217.518097534
Pre-training layer 1, epoch 85, representative training free energy -103867.572795
Pre-training layer 1, epoch 85, validation free energy -102691.908016
Pre-training layer 1, epoch 86, cost -217.497222481
Pre-training layer 1, epoch 87, cost -217.333004646
Pre-training layer 1, epoch 88, cost -217.296056099
Pre-training layer 1, epoch 89, cost -217.219858398
Pre-training layer 1, epoch 90, cost -217.20855835
Pre-training layer 1, epoch 90, representative training free energy -104454.333834
Pre-training layer 1, epoch 90, validation free energy -103272.555457
Pre-training layer 1, epoch 91, cost -217.031568642
Pre-training layer 1, epoch 92, cost -217.097734756
Pre-training layer 1, epoch 93, cost -217.03349659
Pre-training layer 1, epoch 94, cost -216.86213356
Pre-training layer 1, epoch 95, cost -216.851007843
Pre-training layer 1, epoch 95, representative training free energy -105010.8781
Pre-training layer 1, epoch 95, validation free energy -103821.763
Pre-training layer 1, epoch 96, cost -216.934306908
Pre-training layer 1, epoch 97, cost -216.783521767
Pre-training layer 1, epoch 98, cost -216.84979557
Pre-training layer 1, epoch 99, cost -216.722037392
Pre-training layer 2, epoch 0, cost -118.667935696
Pre-training layer 2, epoch 0, representative training free energy 3613.4704455
Pre-training layer 2, epoch 0, validation free energy 3568.13651044
Pre-training layer 2, epoch 1, cost -88.8431332684
Pre-training layer 2, epoch 2, cost -82.20701931
Pre-training layer 2, epoch 3, cost -78.6081255245
Pre-training layer 2, epoch 4, cost -76.1611487389
Pre-training layer 2, epoch 5, cost -74.2115477753
Pre-training layer 2, epoch 5, representative training free energy 5577.33555383
Pre-training layer 2, epoch 5, validation free energy 5508.02827075
Pre-training layer 2, epoch 6, cost -72.8436880016
Pre-training layer 2, epoch 7, cost -71.5575344563
Pre-training layer 2, epoch 8, cost -70.7507463455
Pre-training layer 2, epoch 9, cost -70.0180422306
Pre-training layer 2, epoch 10, cost -69.3068810749
Pre-training layer 2, epoch 10, representative training free energy 6671.15304858
Pre-training layer 2, epoch 10, validation free energy 6584.91858081
Pre-training layer 2, epoch 11, cost -68.6392078781
Pre-training layer 2, epoch 12, cost -68.0992721081
Pre-training layer 2, epoch 13, cost -67.7351733875
Pre-training layer 2, epoch 14, cost -67.3197258759
Pre-training layer 2, epoch 15, cost -66.9067467022
Pre-training layer 2, epoch 15, representative training free energy 7436.59712964
Pre-training layer 2, epoch 15, validation free energy 7345.1747439
Pre-training layer 2, epoch 16, cost -66.557045145
Pre-training layer 2, epoch 17, cost -66.25146101
Pre-training layer 2, epoch 18, cost -65.9899254131
Pre-training layer 2, epoch 19, cost -65.7129866505
Pre-training layer 2, epoch 20, cost -65.5612804508
Pre-training layer 2, epoch 20, representative training free energy 8095.50439917
Pre-training layer 2, epoch 20, validation free energy 8002.25449243
Pre-training layer 2, epoch 21, cost -65.3462451935
Pre-training layer 2, epoch 22, cost -65.0525129795
Pre-training layer 2, epoch 23, cost -64.8402292442
Pre-training layer 2, epoch 24, cost -64.6727558422
Pre-training layer 2, epoch 25, cost -64.5341131401
Pre-training layer 2, epoch 25, representative training free energy 8595.00358325
Pre-training layer 2, epoch 25, validation free energy 8498.26827759
Pre-training layer 2, epoch 26, cost -64.419917345
Pre-training layer 2, epoch 27, cost -64.2398758125
Pre-training layer 2, epoch 28, cost -64.1643138695
Pre-training layer 2, epoch 29, cost -64.0059478188
Pre-training layer 2, epoch 30, cost -63.8669812489
Pre-training layer 2, epoch 30, representative training free energy 9070.11769775
Pre-training layer 2, epoch 30, validation free energy 8971.27154248
Pre-training layer 2, epoch 31, cost -63.7884123325
Pre-training layer 2, epoch 32, cost -63.6524534225
Pre-training layer 2, epoch 33, cost -63.6621234703
Pre-training layer 2, epoch 34, cost -63.3773121929
Pre-training layer 2, epoch 35, cost -63.3744652271
Pre-training layer 2, epoch 35, representative training free energy 9515.18864917
Pre-training layer 2, epoch 35, validation free energy 9411.20715625
Pre-training layer 2, epoch 36, cost -63.2275991917
Pre-training layer 2, epoch 37, cost -63.194010725
Pre-training layer 2, epoch 38, cost -63.1588864422
Pre-training layer 2, epoch 39, cost -63.0347932911
Pre-training layer 2, epoch 40, cost -62.8815859795
Pre-training layer 2, epoch 40, representative training free energy 9907.19418945
Pre-training layer 2, epoch 40, validation free energy 9799.71422437
Pre-training layer 2, epoch 41, cost -62.9234799004
Pre-training layer 2, epoch 42, cost -62.7975396729
Pre-training layer 2, epoch 43, cost -62.8035709763
Pre-training layer 2, epoch 44, cost -62.7162285805
Pre-training layer 2, epoch 45, cost -62.656411705
Pre-training layer 2, epoch 45, representative training free energy 10263.5741648
Pre-training layer 2, epoch 45, validation free energy 10153.4745723
Pre-training layer 2, epoch 46, cost -62.5563010025
Pre-training layer 2, epoch 47, cost -62.4193620872
Pre-training layer 2, epoch 48, cost -62.4425250626
Pre-training layer 2, epoch 49, cost -62.3391645813
Pre-training layer 2, epoch 50, cost -62.3301041126
Pre-training layer 2, epoch 50, representative training free energy 10635.2061965
Pre-training layer 2, epoch 50, validation free energy 10520.6609478
Pre-training layer 2, epoch 51, cost -62.3298201466
Pre-training layer 2, epoch 52, cost -62.1695495224
Pre-training layer 2, epoch 53, cost -62.1927745724
Pre-training layer 2, epoch 54, cost -62.1850590611
Pre-training layer 2, epoch 55, cost -62.0237879753
Pre-training layer 2, epoch 55, representative training free energy 10969.9413809
Pre-training layer 2, epoch 55, validation free energy 10852.0454541
Pre-training layer 2, epoch 56, cost -62.0316007996
Pre-training layer 2, epoch 57, cost -62.0254425335
Pre-training layer 2, epoch 58, cost -61.9192857456
Pre-training layer 2, epoch 59, cost -61.926532011
Pre-training layer 2, epoch 60, cost -61.8107495308
Pre-training layer 2, epoch 60, representative training free energy 11313.263302
Pre-training layer 2, epoch 60, validation free energy 11188.6843564
Pre-training layer 2, epoch 61, cost -61.8126632214
Pre-training layer 2, epoch 62, cost -61.7478051949
Pre-training layer 2, epoch 63, cost -61.8105862904
Pre-training layer 2, epoch 64, cost -61.6766683578
Pre-training layer 2, epoch 65, cost -61.6529017735
Pre-training layer 2, epoch 65, representative training free energy 11639.822646
Pre-training layer 2, epoch 65, validation free energy 11515.096749
Pre-training layer 2, epoch 66, cost -61.6189354992
Pre-training layer 2, epoch 67, cost -61.6275201893
Pre-training layer 2, epoch 68, cost -61.6002493858
Pre-training layer 2, epoch 69, cost -61.4266411591
Pre-training layer 2, epoch 70, cost -61.4725608921
Pre-training layer 2, epoch 70, representative training free energy 11946.6974268
Pre-training layer 2, epoch 70, validation free energy 11819.2121897
Pre-training layer 2, epoch 71, cost -61.4682110214
Pre-training layer 2, epoch 72, cost -61.491556921
Pre-training layer 2, epoch 73, cost -61.3109290218
Pre-training layer 2, epoch 74, cost -61.4094995022
Pre-training layer 2, epoch 75, cost -61.3401952839
Pre-training layer 2, epoch 75, representative training free energy 12259.1922717
Pre-training layer 2, epoch 75, validation free energy 12127.8702051
Pre-training layer 2, epoch 76, cost -61.2811407566
Pre-training layer 2, epoch 77, cost -61.266693449
Pre-training layer 2, epoch 78, cost -61.2948980999
Pre-training layer 2, epoch 79, cost -61.2059502983
Pre-training layer 2, epoch 80, cost -61.2351564407
Pre-training layer 2, epoch 80, representative training free energy 12549.0721782
Pre-training layer 2, epoch 80, validation free energy 12416.5483062
Pre-training layer 2, epoch 81, cost -61.187979269
Pre-training layer 2, epoch 82, cost -61.1011404419
Pre-training layer 2, epoch 83, cost -61.184553566
Pre-training layer 2, epoch 84, cost -61.0590109634
Pre-training layer 2, epoch 85, cost -61.1065560341
Pre-training layer 2, epoch 85, representative training free energy 12852.1592373
Pre-training layer 2, epoch 85, validation free energy 12716.6555454
Pre-training layer 2, epoch 86, cost -61.1065782452
Pre-training layer 2, epoch 87, cost -60.9792449951
Pre-training layer 2, epoch 88, cost -60.9587669945
Pre-training layer 2, epoch 89, cost -60.9854007816
Pre-training layer 2, epoch 90, cost -61.0285111904
Pre-training layer 2, epoch 90, representative training free energy 13128.5631997
Pre-training layer 2, epoch 90, validation free energy 12992.0038857
Pre-training layer 2, epoch 91, cost -60.9060962009
Pre-training layer 2, epoch 92, cost -60.8927392292
Pre-training layer 2, epoch 93, cost -60.8581142044
Pre-training layer 2, epoch 94, cost -60.8230414391
Pre-training layer 2, epoch 95, cost -60.8675617123
Pre-training layer 2, epoch 95, representative training free energy 13406.6595195
Pre-training layer 2, epoch 95, validation free energy 13266.4506909
Pre-training layer 2, epoch 96, cost -60.8214846992
Pre-training layer 2, epoch 97, cost -60.8416621876
Pre-training layer 2, epoch 98, cost -60.8321864223
Pre-training layer 2, epoch 99, cost -60.7634138203
The pretraining code for file dbn_loop.pyc ran for 3.77m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 10.300000 %
     epoch 1, minibatch 400/400, test error of best model 9.700000 %
epoch 2, minibatch 400/400, validation error 8.600000 %
     epoch 2, minibatch 400/400, test error of best model 8.200000 %
epoch 3, minibatch 400/400, validation error 8.000000 %
     epoch 3, minibatch 400/400, test error of best model 8.000000 %
epoch 4, minibatch 400/400, validation error 7.300000 %
     epoch 4, minibatch 400/400, test error of best model 7.500000 %
epoch 5, minibatch 400/400, validation error 7.200000 %
     epoch 5, minibatch 400/400, test error of best model 6.800000 %
epoch 6, minibatch 400/400, validation error 6.800000 %
     epoch 6, minibatch 400/400, test error of best model 6.700000 %
epoch 7, minibatch 400/400, validation error 6.600000 %
     epoch 7, minibatch 400/400, test error of best model 6.800000 %
epoch 8, minibatch 400/400, validation error 6.500000 %
     epoch 8, minibatch 400/400, test error of best model 6.800000 %
epoch 9, minibatch 400/400, validation error 6.400000 %
     epoch 9, minibatch 400/400, test error of best model 6.700000 %
epoch 10, minibatch 400/400, validation error 6.200000 %
     epoch 10, minibatch 400/400, test error of best model 6.600000 %
epoch 11, minibatch 400/400, validation error 6.200000 %
epoch 12, minibatch 400/400, validation error 6.000000 %
     epoch 12, minibatch 400/400, test error of best model 6.400000 %
epoch 13, minibatch 400/400, validation error 6.000000 %
epoch 14, minibatch 400/400, validation error 6.100000 %
epoch 15, minibatch 400/400, validation error 6.100000 %
epoch 16, minibatch 400/400, validation error 6.000000 %
epoch 17, minibatch 400/400, validation error 5.800000 %
     epoch 17, minibatch 400/400, test error of best model 6.000000 %
epoch 18, minibatch 400/400, validation error 5.700000 %
     epoch 18, minibatch 400/400, test error of best model 6.000000 %
epoch 19, minibatch 400/400, validation error 5.700000 %
epoch 20, minibatch 400/400, validation error 5.800000 %
epoch 21, minibatch 400/400, validation error 5.800000 %
epoch 22, minibatch 400/400, validation error 5.700000 %
epoch 23, minibatch 400/400, validation error 5.800000 %
epoch 24, minibatch 400/400, validation error 6.000000 %
epoch 25, minibatch 400/400, validation error 6.000000 %
epoch 26, minibatch 400/400, validation error 6.000000 %
epoch 27, minibatch 400/400, validation error 5.900000 %
epoch 28, minibatch 400/400, validation error 5.900000 %
epoch 29, minibatch 400/400, validation error 5.900000 %
epoch 30, minibatch 400/400, validation error 5.900000 %
epoch 31, minibatch 400/400, validation error 6.000000 %
epoch 32, minibatch 400/400, validation error 6.000000 %
epoch 33, minibatch 400/400, validation error 6.000000 %
epoch 34, minibatch 400/400, validation error 5.900000 %
epoch 35, minibatch 400/400, validation error 5.900000 %
Optimization complete with best validation score of 5.700000 %, obtained at iteration 7200, with test performance 6.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.60m
