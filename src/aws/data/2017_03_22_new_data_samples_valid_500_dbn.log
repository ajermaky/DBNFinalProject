_______RUN: 0

==========Sample Size: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.979169434
Pre-training layer 0, epoch 0, representative training free energy -264.310089996
Pre-training layer 0, epoch 0, validation free energy -257.663379608
Pre-training layer 0, epoch 1, cost -95.7216175232
Pre-training layer 0, epoch 2, cost -90.3699411316
Pre-training layer 0, epoch 3, cost -87.3163264694
Pre-training layer 0, epoch 4, cost -85.2702885742
Pre-training layer 0, epoch 5, cost -83.7608608093
Pre-training layer 0, epoch 5, representative training free energy -261.043840515
Pre-training layer 0, epoch 5, validation free energy -251.640098633
Pre-training layer 0, epoch 6, cost -82.6184528046
Pre-training layer 0, epoch 7, cost -81.6024680939
Pre-training layer 0, epoch 8, cost -80.9228732224
Pre-training layer 0, epoch 9, cost -80.150156662
Pre-training layer 0, epoch 10, cost -79.6284147263
Pre-training layer 0, epoch 10, representative training free energy -268.500223267
Pre-training layer 0, epoch 10, validation free energy -256.209898956
Pre-training layer 0, epoch 11, cost -78.9926260757
Pre-training layer 0, epoch 12, cost -78.5600858765
Pre-training layer 0, epoch 13, cost -78.1400668716
Pre-training layer 0, epoch 14, cost -77.7507462082
Pre-training layer 0, epoch 15, cost -77.4388077393
Pre-training layer 0, epoch 15, representative training free energy -263.756641235
Pre-training layer 0, epoch 15, validation free energy -251.914578979
Pre-training layer 0, epoch 16, cost -77.191799942
Pre-training layer 0, epoch 17, cost -76.8327313232
Pre-training layer 0, epoch 18, cost -76.5836449814
Pre-training layer 0, epoch 19, cost -76.2547523117
Pre-training layer 0, epoch 20, cost -75.9992597046
Pre-training layer 0, epoch 20, representative training free energy -261.911847626
Pre-training layer 0, epoch 20, validation free energy -248.938433197
Pre-training layer 0, epoch 21, cost -75.7740005035
Pre-training layer 0, epoch 22, cost -75.5247362061
Pre-training layer 0, epoch 23, cost -75.3756071701
Pre-training layer 0, epoch 24, cost -75.1586633911
Pre-training layer 0, epoch 25, cost -75.1026782913
Pre-training layer 0, epoch 25, representative training free energy -261.560800537
Pre-training layer 0, epoch 25, validation free energy -248.412368134
Pre-training layer 0, epoch 26, cost -74.8448610077
Pre-training layer 0, epoch 27, cost -74.6665999222
Pre-training layer 0, epoch 28, cost -74.484428978
Pre-training layer 0, epoch 29, cost -74.2676099167
Pre-training layer 0, epoch 30, cost -74.1962352829
Pre-training layer 0, epoch 30, representative training free energy -260.51016925
Pre-training layer 0, epoch 30, validation free energy -247.371132721
Pre-training layer 0, epoch 31, cost -74.0097772217
Pre-training layer 0, epoch 32, cost -73.9393362503
Pre-training layer 0, epoch 33, cost -73.7717867508
Pre-training layer 0, epoch 34, cost -73.6622630157
Pre-training layer 0, epoch 35, cost -73.5785222092
Pre-training layer 0, epoch 35, representative training free energy -253.252949493
Pre-training layer 0, epoch 35, validation free energy -239.385519409
Pre-training layer 0, epoch 36, cost -73.4435415955
Pre-training layer 0, epoch 37, cost -73.3264917297
Pre-training layer 0, epoch 38, cost -73.0947857971
Pre-training layer 0, epoch 39, cost -73.0107021561
Pre-training layer 0, epoch 40, cost -72.8682627258
Pre-training layer 0, epoch 40, representative training free energy -250.573890961
Pre-training layer 0, epoch 40, validation free energy -235.790426605
Pre-training layer 0, epoch 41, cost -72.8553834229
Pre-training layer 0, epoch 42, cost -72.750624054
Pre-training layer 0, epoch 43, cost -72.6885878448
Pre-training layer 0, epoch 44, cost -72.6290485611
Pre-training layer 0, epoch 45, cost -72.4239121933
Pre-training layer 0, epoch 45, representative training free energy -248.303267792
Pre-training layer 0, epoch 45, validation free energy -233.162401001
Pre-training layer 0, epoch 46, cost -72.3266580963
Pre-training layer 0, epoch 47, cost -72.310547081
Pre-training layer 0, epoch 48, cost -72.115865181
Pre-training layer 0, epoch 49, cost -72.1168842087
Pre-training layer 0, epoch 50, cost -71.9989689331
Pre-training layer 0, epoch 50, representative training free energy -243.390233398
Pre-training layer 0, epoch 50, validation free energy -227.619660278
Pre-training layer 0, epoch 51, cost -71.816461174
Pre-training layer 0, epoch 52, cost -71.836570816
Pre-training layer 0, epoch 53, cost -71.7923654327
Pre-training layer 0, epoch 54, cost -71.6919293594
Pre-training layer 0, epoch 55, cost -71.7528044434
Pre-training layer 0, epoch 55, representative training free energy -242.464815826
Pre-training layer 0, epoch 55, validation free energy -227.515223938
Pre-training layer 0, epoch 56, cost -71.606296936
Pre-training layer 0, epoch 57, cost -71.3201856003
Pre-training layer 0, epoch 58, cost -71.3397118301
Pre-training layer 0, epoch 59, cost -71.2754112167
Pre-training layer 0, epoch 60, cost -71.2956480789
Pre-training layer 0, epoch 60, representative training free energy -238.122127167
Pre-training layer 0, epoch 60, validation free energy -223.202261047
Pre-training layer 0, epoch 61, cost -71.2038440628
Pre-training layer 0, epoch 62, cost -71.0052506714
Pre-training layer 0, epoch 63, cost -71.0438031769
Pre-training layer 0, epoch 64, cost -70.990749733
Pre-training layer 0, epoch 65, cost -70.9205720291
Pre-training layer 0, epoch 65, representative training free energy -230.877972931
Pre-training layer 0, epoch 65, validation free energy -214.965125031
Pre-training layer 0, epoch 66, cost -70.8944700546
Pre-training layer 0, epoch 67, cost -70.7246514893
Pre-training layer 0, epoch 68, cost -70.7033465195
Pre-training layer 0, epoch 69, cost -70.6900191116
Pre-training layer 0, epoch 70, cost -70.6958343277
Pre-training layer 0, epoch 70, representative training free energy -231.015467377
Pre-training layer 0, epoch 70, validation free energy -213.960582611
Pre-training layer 0, epoch 71, cost -70.7147252884
Pre-training layer 0, epoch 72, cost -70.5621029892
Pre-training layer 0, epoch 73, cost -70.3770883636
Pre-training layer 0, epoch 74, cost -70.3864639511
Pre-training layer 0, epoch 75, cost -70.3817712097
Pre-training layer 0, epoch 75, representative training free energy -230.945357239
Pre-training layer 0, epoch 75, validation free energy -213.757925415
Pre-training layer 0, epoch 76, cost -70.3509841003
Pre-training layer 0, epoch 77, cost -70.3215339813
Pre-training layer 0, epoch 78, cost -70.1732705688
Pre-training layer 0, epoch 79, cost -70.1485957794
Pre-training layer 0, epoch 80, cost -70.147994133
Pre-training layer 0, epoch 80, representative training free energy -226.569121948
Pre-training layer 0, epoch 80, validation free energy -209.947864853
Pre-training layer 0, epoch 81, cost -70.1105657806
Pre-training layer 0, epoch 82, cost -70.0869846344
Pre-training layer 0, epoch 83, cost -69.966515625
Pre-training layer 0, epoch 84, cost -69.901382637
Pre-training layer 0, epoch 85, cost -69.8923493958
Pre-training layer 0, epoch 85, representative training free energy -223.322516205
Pre-training layer 0, epoch 85, validation free energy -205.900538574
Pre-training layer 0, epoch 86, cost -69.6940240479
Pre-training layer 0, epoch 87, cost -69.7572214127
Pre-training layer 0, epoch 88, cost -69.7944252853
Pre-training layer 0, epoch 89, cost -69.7226722183
Pre-training layer 0, epoch 90, cost -69.7118865662
Pre-training layer 0, epoch 90, representative training free energy -216.913113068
Pre-training layer 0, epoch 90, validation free energy -199.535638382
Pre-training layer 0, epoch 91, cost -69.5907522202
Pre-training layer 0, epoch 92, cost -69.6059160004
Pre-training layer 0, epoch 93, cost -69.5524431076
Pre-training layer 0, epoch 94, cost -69.4776186981
Pre-training layer 0, epoch 95, cost -69.4386955185
Pre-training layer 0, epoch 95, representative training free energy -216.510060394
Pre-training layer 0, epoch 95, validation free energy -199.32906308
Pre-training layer 0, epoch 96, cost -69.3631891022
Pre-training layer 0, epoch 97, cost -69.3503675613
Pre-training layer 0, epoch 98, cost -69.3317686615
Pre-training layer 0, epoch 99, cost -69.2990174026
Pre-training layer 1, epoch 0, cost -111.172522865
Pre-training layer 1, epoch 0, representative training free energy -324725.028438
Pre-training layer 1, epoch 0, validation free energy -321655.915172
Pre-training layer 1, epoch 1, cost -87.0573574829
Pre-training layer 1, epoch 2, cost -80.9909176178
Pre-training layer 1, epoch 3, cost -77.6070556564
Pre-training layer 1, epoch 4, cost -75.3182142258
Pre-training layer 1, epoch 5, cost -73.7171097412
Pre-training layer 1, epoch 5, representative training free energy -428713.528312
Pre-training layer 1, epoch 5, validation free energy -424628.163281
Pre-training layer 1, epoch 6, cost -72.2761206131
Pre-training layer 1, epoch 7, cost -71.1585163269
Pre-training layer 1, epoch 8, cost -70.4147906494
Pre-training layer 1, epoch 9, cost -69.6075067596
Pre-training layer 1, epoch 10, cost -68.9518231583
Pre-training layer 1, epoch 10, representative training free energy -477587.221562
Pre-training layer 1, epoch 10, validation free energy -473004.787844
Pre-training layer 1, epoch 11, cost -68.3810687866
Pre-training layer 1, epoch 12, cost -67.8581907578
Pre-training layer 1, epoch 13, cost -67.414450531
Pre-training layer 1, epoch 14, cost -66.9267605667
Pre-training layer 1, epoch 15, cost -66.6078014832
Pre-training layer 1, epoch 15, representative training free energy -510229.041375
Pre-training layer 1, epoch 15, validation free energy -505396.337312
Pre-training layer 1, epoch 16, cost -66.2227072906
Pre-training layer 1, epoch 17, cost -65.8209269562
Pre-training layer 1, epoch 18, cost -65.5576040039
Pre-training layer 1, epoch 19, cost -65.3203198242
Pre-training layer 1, epoch 20, cost -65.0959810257
Pre-training layer 1, epoch 20, representative training free energy -536245.907344
Pre-training layer 1, epoch 20, validation free energy -531171.733469
Pre-training layer 1, epoch 21, cost -64.7876414948
Pre-training layer 1, epoch 22, cost -64.5971846695
Pre-training layer 1, epoch 23, cost -64.3645357513
Pre-training layer 1, epoch 24, cost -64.1682413635
Pre-training layer 1, epoch 25, cost -63.916860672
Pre-training layer 1, epoch 25, representative training free energy -558314.140094
Pre-training layer 1, epoch 25, validation free energy -553043.239281
Pre-training layer 1, epoch 26, cost -63.8231717606
Pre-training layer 1, epoch 27, cost -63.6119195862
Pre-training layer 1, epoch 28, cost -63.4809559631
Pre-training layer 1, epoch 29, cost -63.2970407104
Pre-training layer 1, epoch 30, cost -63.1965107956
Pre-training layer 1, epoch 30, representative training free energy -576058.418156
Pre-training layer 1, epoch 30, validation free energy -570620.159969
Pre-training layer 1, epoch 31, cost -62.9981969147
Pre-training layer 1, epoch 32, cost -62.8839859848
Pre-training layer 1, epoch 33, cost -62.8137252731
Pre-training layer 1, epoch 34, cost -62.6070213776
Pre-training layer 1, epoch 35, cost -62.5177667313
Pre-training layer 1, epoch 35, representative training free energy -593082.775094
Pre-training layer 1, epoch 35, validation free energy -587507.538219
Pre-training layer 1, epoch 36, cost -62.3798705597
Pre-training layer 1, epoch 37, cost -62.2897458191
Pre-training layer 1, epoch 38, cost -62.231036438
Pre-training layer 1, epoch 39, cost -62.1202268257
Pre-training layer 1, epoch 40, cost -62.0348954391
Pre-training layer 1, epoch 40, representative training free energy -607524.078406
Pre-training layer 1, epoch 40, validation free energy -601901.654531
Pre-training layer 1, epoch 41, cost -62.000262352
Pre-training layer 1, epoch 42, cost -61.8355232811
Pre-training layer 1, epoch 43, cost -61.7938736877
Pre-training layer 1, epoch 44, cost -61.724693367
Pre-training layer 1, epoch 45, cost -61.6569314575
Pre-training layer 1, epoch 45, representative training free energy -620225.558406
Pre-training layer 1, epoch 45, validation free energy -614429.105844
Pre-training layer 1, epoch 46, cost -61.5292768784
Pre-training layer 1, epoch 47, cost -61.5123291168
Pre-training layer 1, epoch 48, cost -61.3842004509
Pre-training layer 1, epoch 49, cost -61.3068484802
Pre-training layer 1, epoch 50, cost -61.3103161812
Pre-training layer 1, epoch 50, representative training free energy -632087.991063
Pre-training layer 1, epoch 50, validation free energy -626184.443469
Pre-training layer 1, epoch 51, cost -61.1751765251
Pre-training layer 1, epoch 52, cost -61.1246414871
Pre-training layer 1, epoch 53, cost -61.0782897568
Pre-training layer 1, epoch 54, cost -60.974158226
Pre-training layer 1, epoch 55, cost -60.9297241821
Pre-training layer 1, epoch 55, representative training free energy -642978.272938
Pre-training layer 1, epoch 55, validation free energy -636956.731063
Pre-training layer 1, epoch 56, cost -60.8255979691
Pre-training layer 1, epoch 57, cost -60.8155360641
Pre-training layer 1, epoch 58, cost -60.7010217514
Pre-training layer 1, epoch 59, cost -60.7163055878
Pre-training layer 1, epoch 60, cost -60.6212749367
Pre-training layer 1, epoch 60, representative training free energy -653479.2515
Pre-training layer 1, epoch 60, validation free energy -647417.058531
Pre-training layer 1, epoch 61, cost -60.5489147835
Pre-training layer 1, epoch 62, cost -60.5368713074
Pre-training layer 1, epoch 63, cost -60.5588164902
Pre-training layer 1, epoch 64, cost -60.515725399
Pre-training layer 1, epoch 65, cost -60.4488431549
Pre-training layer 1, epoch 65, representative training free energy -662799.729531
Pre-training layer 1, epoch 65, validation free energy -656671.104219
Pre-training layer 1, epoch 66, cost -60.3691930466
Pre-training layer 1, epoch 67, cost -60.3251413994
Pre-training layer 1, epoch 68, cost -60.1885322571
Pre-training layer 1, epoch 69, cost -60.2185558548
Pre-training layer 1, epoch 70, cost -60.1944043808
Pre-training layer 1, epoch 70, representative training free energy -671051.677031
Pre-training layer 1, epoch 70, validation free energy -664844.436813
Pre-training layer 1, epoch 71, cost -60.145071022
Pre-training layer 1, epoch 72, cost -60.114517807
Pre-training layer 1, epoch 73, cost -60.1084764252
Pre-training layer 1, epoch 74, cost -60.0289274635
Pre-training layer 1, epoch 75, cost -60.0665502815
Pre-training layer 1, epoch 75, representative training free energy -680106.326656
Pre-training layer 1, epoch 75, validation free energy -673843.450094
Pre-training layer 1, epoch 76, cost -59.9646944656
Pre-training layer 1, epoch 77, cost -59.9632253838
Pre-training layer 1, epoch 78, cost -59.9022011452
Pre-training layer 1, epoch 79, cost -59.8401937027
Pre-training layer 1, epoch 80, cost -59.7909043388
Pre-training layer 1, epoch 80, representative training free energy -687922.732594
Pre-training layer 1, epoch 80, validation free energy -681528.845656
Pre-training layer 1, epoch 81, cost -59.7812473145
Pre-training layer 1, epoch 82, cost -59.7441911507
Pre-training layer 1, epoch 83, cost -59.7415148048
Pre-training layer 1, epoch 84, cost -59.7373772125
Pre-training layer 1, epoch 85, cost -59.7381876259
Pre-training layer 1, epoch 85, representative training free energy -695685.719688
Pre-training layer 1, epoch 85, validation free energy -689303.504656
Pre-training layer 1, epoch 86, cost -59.6105914993
Pre-training layer 1, epoch 87, cost -59.627478096
Pre-training layer 1, epoch 88, cost -59.5534873886
Pre-training layer 1, epoch 89, cost -59.5597128716
Pre-training layer 1, epoch 90, cost -59.5845015068
Pre-training layer 1, epoch 90, representative training free energy -702834.316625
Pre-training layer 1, epoch 90, validation free energy -696380.213906
Pre-training layer 1, epoch 91, cost -59.5289344559
Pre-training layer 1, epoch 92, cost -59.4573703537
Pre-training layer 1, epoch 93, cost -59.4536534805
Pre-training layer 1, epoch 94, cost -59.402838295
Pre-training layer 1, epoch 95, cost -59.3559218292
Pre-training layer 1, epoch 95, representative training free energy -710176.371
Pre-training layer 1, epoch 95, validation free energy -703642.482094
Pre-training layer 1, epoch 96, cost -59.3900954781
Pre-training layer 1, epoch 97, cost -59.3888942413
Pre-training layer 1, epoch 98, cost -59.2416761856
Pre-training layer 1, epoch 99, cost -59.2718075485
Pre-training layer 2, epoch 0, cost -90.2364793472
Pre-training layer 2, epoch 0, representative training free energy 43771.1989883
Pre-training layer 2, epoch 0, validation free energy 43347.1704688
Pre-training layer 2, epoch 1, cost -66.8399315262
Pre-training layer 2, epoch 2, cost -62.0576432724
Pre-training layer 2, epoch 3, cost -59.3568282318
Pre-training layer 2, epoch 4, cost -57.7156563034
Pre-training layer 2, epoch 5, cost -56.491088501
Pre-training layer 2, epoch 5, representative training free energy 136341.402578
Pre-training layer 2, epoch 5, validation free energy 135172.288266
Pre-training layer 2, epoch 6, cost -55.4821822586
Pre-training layer 2, epoch 7, cost -54.7769478607
Pre-training layer 2, epoch 8, cost -54.1681473999
Pre-training layer 2, epoch 9, cost -53.5229146423
Pre-training layer 2, epoch 10, cost -53.1693919144
Pre-training layer 2, epoch 10, representative training free energy 179219.15407
Pre-training layer 2, epoch 10, validation free energy 177726.008891
Pre-training layer 2, epoch 11, cost -52.7391438446
Pre-training layer 2, epoch 12, cost -52.4079827805
Pre-training layer 2, epoch 13, cost -52.0560110092
Pre-training layer 2, epoch 14, cost -51.8217099304
Pre-training layer 2, epoch 15, cost -51.594409256
Pre-training layer 2, epoch 15, representative training free energy 208062.052641
Pre-training layer 2, epoch 15, validation free energy 206385.153859
Pre-training layer 2, epoch 16, cost -51.2597073288
Pre-training layer 2, epoch 17, cost -51.0648528671
Pre-training layer 2, epoch 18, cost -50.9520966949
Pre-training layer 2, epoch 19, cost -50.7684147339
Pre-training layer 2, epoch 20, cost -50.51436129
Pre-training layer 2, epoch 20, representative training free energy 228325.281328
Pre-training layer 2, epoch 20, validation free energy 226514.054531
Pre-training layer 2, epoch 21, cost -50.4319935226
Pre-training layer 2, epoch 22, cost -50.2153388596
Pre-training layer 2, epoch 23, cost -50.0736087418
Pre-training layer 2, epoch 24, cost -49.8669619827
Pre-training layer 2, epoch 25, cost -49.7510076904
Pre-training layer 2, epoch 25, representative training free energy 242636.353109
Pre-training layer 2, epoch 25, validation free energy 240746.078234
Pre-training layer 2, epoch 26, cost -49.701784256
Pre-training layer 2, epoch 27, cost -49.5359391098
Pre-training layer 2, epoch 28, cost -49.4709453964
Pre-training layer 2, epoch 29, cost -49.3225735779
Pre-training layer 2, epoch 30, cost -49.2607363892
Pre-training layer 2, epoch 30, representative training free energy 253528.237703
Pre-training layer 2, epoch 30, validation free energy 251594.301437
Pre-training layer 2, epoch 31, cost -49.0875023422
Pre-training layer 2, epoch 32, cost -49.0575550613
Pre-training layer 2, epoch 33, cost -49.0045431137
Pre-training layer 2, epoch 34, cost -48.9049907265
Pre-training layer 2, epoch 35, cost -48.835297348
Pre-training layer 2, epoch 35, representative training free energy 262669.748203
Pre-training layer 2, epoch 35, validation free energy 260670.222437
Pre-training layer 2, epoch 36, cost -48.7969961014
Pre-training layer 2, epoch 37, cost -48.6070853348
Pre-training layer 2, epoch 38, cost -48.5605341873
Pre-training layer 2, epoch 39, cost -48.5017454376
Pre-training layer 2, epoch 40, cost -48.4065080109
Pre-training layer 2, epoch 40, representative training free energy 269671.094328
Pre-training layer 2, epoch 40, validation free energy 267623.589859
Pre-training layer 2, epoch 41, cost -48.4150067596
Pre-training layer 2, epoch 42, cost -48.3619699783
Pre-training layer 2, epoch 43, cost -48.3250381203
Pre-training layer 2, epoch 44, cost -48.2510362701
Pre-training layer 2, epoch 45, cost -48.1519263306
Pre-training layer 2, epoch 45, representative training free energy 277341.967422
Pre-training layer 2, epoch 45, validation free energy 275251.022531
Pre-training layer 2, epoch 46, cost -48.121221077
Pre-training layer 2, epoch 47, cost -48.0926664772
Pre-training layer 2, epoch 48, cost -47.9675632858
Pre-training layer 2, epoch 49, cost -47.8814316025
Pre-training layer 2, epoch 50, cost -47.9503438492
Pre-training layer 2, epoch 50, representative training free energy 282961.61175
Pre-training layer 2, epoch 50, validation free energy 280849.979359
Pre-training layer 2, epoch 51, cost -47.8684757538
Pre-training layer 2, epoch 52, cost -47.7599113693
Pre-training layer 2, epoch 53, cost -47.7666133347
Pre-training layer 2, epoch 54, cost -47.6974610596
Pre-training layer 2, epoch 55, cost -47.6594203186
Pre-training layer 2, epoch 55, representative training free energy 288051.859312
Pre-training layer 2, epoch 55, validation free energy 285876.461578
Pre-training layer 2, epoch 56, cost -47.5719836426
Pre-training layer 2, epoch 57, cost -47.5663237686
Pre-training layer 2, epoch 58, cost -47.5220215302
Pre-training layer 2, epoch 59, cost -47.5639510193
Pre-training layer 2, epoch 60, cost -47.3947262993
Pre-training layer 2, epoch 60, representative training free energy 291298.052609
Pre-training layer 2, epoch 60, validation free energy 289094.620438
Pre-training layer 2, epoch 61, cost -47.3983029404
Pre-training layer 2, epoch 62, cost -47.3733117905
Pre-training layer 2, epoch 63, cost -47.2910302353
Pre-training layer 2, epoch 64, cost -47.2842952499
Pre-training layer 2, epoch 65, cost -47.2461943359
Pre-training layer 2, epoch 65, representative training free energy 295224.097516
Pre-training layer 2, epoch 65, validation free energy 292995.33575
Pre-training layer 2, epoch 66, cost -47.2831778069
Pre-training layer 2, epoch 67, cost -47.192538826
Pre-training layer 2, epoch 68, cost -47.2083290672
Pre-training layer 2, epoch 69, cost -47.1860912971
Pre-training layer 2, epoch 70, cost -47.127792038
Pre-training layer 2, epoch 70, representative training free energy 299271.699172
Pre-training layer 2, epoch 70, validation free energy 297022.764437
Pre-training layer 2, epoch 71, cost -47.1033955078
Pre-training layer 2, epoch 72, cost -46.9953573914
Pre-training layer 2, epoch 73, cost -46.9933254623
Pre-training layer 2, epoch 74, cost -46.9739064255
Pre-training layer 2, epoch 75, cost -46.995835762
Pre-training layer 2, epoch 75, representative training free energy 302019.211719
Pre-training layer 2, epoch 75, validation free energy 299713.473141
Pre-training layer 2, epoch 76, cost -46.9554012604
Pre-training layer 2, epoch 77, cost -46.9226364136
Pre-training layer 2, epoch 78, cost -46.9017804489
Pre-training layer 2, epoch 79, cost -46.8784705811
Pre-training layer 2, epoch 80, cost -46.8248157158
Pre-training layer 2, epoch 80, representative training free energy 305064.804266
Pre-training layer 2, epoch 80, validation free energy 302772.497
Pre-training layer 2, epoch 81, cost -46.8169050903
Pre-training layer 2, epoch 82, cost -46.8037394295
Pre-training layer 2, epoch 83, cost -46.7763196297
Pre-training layer 2, epoch 84, cost -46.7009443398
Pre-training layer 2, epoch 85, cost -46.6401433029
Pre-training layer 2, epoch 85, representative training free energy 308286.181984
Pre-training layer 2, epoch 85, validation free energy 305942.425391
Pre-training layer 2, epoch 86, cost -46.7459764099
Pre-training layer 2, epoch 87, cost -46.6677713966
Pre-training layer 2, epoch 88, cost -46.6195364914
Pre-training layer 2, epoch 89, cost -46.6400182877
Pre-training layer 2, epoch 90, cost -46.5518055801
Pre-training layer 2, epoch 90, representative training free energy 309780.272969
Pre-training layer 2, epoch 90, validation free energy 307439.600297
Pre-training layer 2, epoch 91, cost -46.5812526016
Pre-training layer 2, epoch 92, cost -46.4806571465
Pre-training layer 2, epoch 93, cost -46.5406644745
Pre-training layer 2, epoch 94, cost -46.5723421783
Pre-training layer 2, epoch 95, cost -46.4816123772
Pre-training layer 2, epoch 95, representative training free energy 312044.530047
Pre-training layer 2, epoch 95, validation free energy 309689.718016
Pre-training layer 2, epoch 96, cost -46.4708091621
Pre-training layer 2, epoch 97, cost -46.4060914917
Pre-training layer 2, epoch 98, cost -46.4962967033
Pre-training layer 2, epoch 99, cost -46.4900174332
The pretraining code for file dbn_loop.pyc ran for 4.73m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.600000 %
     epoch 1, minibatch 500/500, test error of best model 13.200000 %
epoch 2, minibatch 500/500, validation error 9.600000 %
     epoch 2, minibatch 500/500, test error of best model 7.800000 %
epoch 3, minibatch 500/500, validation error 8.600000 %
     epoch 3, minibatch 500/500, test error of best model 6.000000 %
epoch 4, minibatch 500/500, validation error 8.000000 %
     epoch 4, minibatch 500/500, test error of best model 6.000000 %
epoch 5, minibatch 500/500, validation error 6.600000 %
     epoch 5, minibatch 500/500, test error of best model 5.600000 %
epoch 6, minibatch 500/500, validation error 6.000000 %
     epoch 6, minibatch 500/500, test error of best model 5.200000 %
epoch 7, minibatch 500/500, validation error 6.000000 %
epoch 8, minibatch 500/500, validation error 6.200000 %
epoch 9, minibatch 500/500, validation error 6.000000 %
epoch 10, minibatch 500/500, validation error 6.000000 %
epoch 11, minibatch 500/500, validation error 6.000000 %
Optimization complete with best validation score of 6.000000 %, obtained at iteration 3000, with test performance 5.200000 %
The fine tuning code for file dbn_loop.pyc ran for 0.24m


==========Sample Size: (5000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.924856613
Pre-training layer 0, epoch 0, representative training free energy -257.632156326
Pre-training layer 0, epoch 0, validation free energy -253.177146362
Pre-training layer 0, epoch 1, cost -95.6918633575
Pre-training layer 0, epoch 2, cost -90.2431469421
Pre-training layer 0, epoch 3, cost -87.2495036621
Pre-training layer 0, epoch 4, cost -85.1490542679
Pre-training layer 0, epoch 5, cost -83.8089355469
Pre-training layer 0, epoch 5, representative training free energy -264.307550095
Pre-training layer 0, epoch 5, validation free energy -256.855696899
Pre-training layer 0, epoch 6, cost -82.6254062347
Pre-training layer 0, epoch 7, cost -81.5755836029
Pre-training layer 0, epoch 8, cost -80.8247892838
Pre-training layer 0, epoch 9, cost -80.0486152802
Pre-training layer 0, epoch 10, cost -79.4939509277
Pre-training layer 0, epoch 10, representative training free energy -266.47069809
Pre-training layer 0, epoch 10, validation free energy -258.914332077
Pre-training layer 0, epoch 11, cost -79.0276605759
Pre-training layer 0, epoch 12, cost -78.4418946915
Pre-training layer 0, epoch 13, cost -78.1349635696
Pre-training layer 0, epoch 14, cost -77.7275406647
Pre-training layer 0, epoch 15, cost -77.271858017
Pre-training layer 0, epoch 15, representative training free energy -266.412099136
Pre-training layer 0, epoch 15, validation free energy -256.199117905
Pre-training layer 0, epoch 16, cost -76.946973114
Pre-training layer 0, epoch 17, cost -76.698304718
Pre-training layer 0, epoch 18, cost -76.3176823578
Pre-training layer 0, epoch 19, cost -76.1627656631
Pre-training layer 0, epoch 20, cost -75.9978245926
Pre-training layer 0, epoch 20, representative training free energy -263.079175171
Pre-training layer 0, epoch 20, validation free energy -251.94390567
Pre-training layer 0, epoch 21, cost -75.6582409744
Pre-training layer 0, epoch 22, cost -75.5721139374
Pre-training layer 0, epoch 23, cost -75.2674262161
Pre-training layer 0, epoch 24, cost -75.1011214676
Pre-training layer 0, epoch 25, cost -74.9100659256
Pre-training layer 0, epoch 25, representative training free energy -256.752432159
Pre-training layer 0, epoch 25, validation free energy -243.56302739
Pre-training layer 0, epoch 26, cost -74.7808421402
Pre-training layer 0, epoch 27, cost -74.4920891571
Pre-training layer 0, epoch 28, cost -74.3480484543
Pre-training layer 0, epoch 29, cost -74.1753897858
Pre-training layer 0, epoch 30, cost -74.0301682358
Pre-training layer 0, epoch 30, representative training free energy -259.159251511
Pre-training layer 0, epoch 30, validation free energy -247.066474289
Pre-training layer 0, epoch 31, cost -73.7850647583
Pre-training layer 0, epoch 32, cost -73.7440671921
Pre-training layer 0, epoch 33, cost -73.5928364182
Pre-training layer 0, epoch 34, cost -73.4917086029
Pre-training layer 0, epoch 35, cost -73.4167312698
Pre-training layer 0, epoch 35, representative training free energy -253.599199875
Pre-training layer 0, epoch 35, validation free energy -241.617015015
Pre-training layer 0, epoch 36, cost -73.314664444
Pre-training layer 0, epoch 37, cost -73.1427384796
Pre-training layer 0, epoch 38, cost -73.0576697922
Pre-training layer 0, epoch 39, cost -72.9125524902
Pre-training layer 0, epoch 40, cost -72.8314561539
Pre-training layer 0, epoch 40, representative training free energy -252.523723221
Pre-training layer 0, epoch 40, validation free energy -239.445523468
Pre-training layer 0, epoch 41, cost -72.7253901062
Pre-training layer 0, epoch 42, cost -72.645347374
Pre-training layer 0, epoch 43, cost -72.4997318649
Pre-training layer 0, epoch 44, cost -72.329553894
Pre-training layer 0, epoch 45, cost -72.2561336212
Pre-training layer 0, epoch 45, representative training free energy -243.677833557
Pre-training layer 0, epoch 45, validation free energy -230.067007217
Pre-training layer 0, epoch 46, cost -72.2733431625
Pre-training layer 0, epoch 47, cost -72.1183596191
Pre-training layer 0, epoch 48, cost -71.9881730576
Pre-training layer 0, epoch 49, cost -72.0325562897
Pre-training layer 0, epoch 50, cost -71.9334856873
Pre-training layer 0, epoch 50, representative training free energy -242.470068039
Pre-training layer 0, epoch 50, validation free energy -228.279795967
Pre-training layer 0, epoch 51, cost -71.7683968277
Pre-training layer 0, epoch 52, cost -71.7919128952
Pre-training layer 0, epoch 53, cost -71.6384537048
Pre-training layer 0, epoch 54, cost -71.4892710953
Pre-training layer 0, epoch 55, cost -71.5274618149
Pre-training layer 0, epoch 55, representative training free energy -234.714877121
Pre-training layer 0, epoch 55, validation free energy -221.226617561
Pre-training layer 0, epoch 56, cost -71.5462540665
Pre-training layer 0, epoch 57, cost -71.2980507355
Pre-training layer 0, epoch 58, cost -71.2921478958
Pre-training layer 0, epoch 59, cost -71.1654932861
Pre-training layer 0, epoch 60, cost -71.1653570328
Pre-training layer 0, epoch 60, representative training free energy -236.532606628
Pre-training layer 0, epoch 60, validation free energy -221.462070892
Pre-training layer 0, epoch 61, cost -71.1173480453
Pre-training layer 0, epoch 62, cost -70.9320538483
Pre-training layer 0, epoch 63, cost -71.0135641022
Pre-training layer 0, epoch 64, cost -70.9295846176
Pre-training layer 0, epoch 65, cost -70.7907477798
Pre-training layer 0, epoch 65, representative training free energy -227.359349091
Pre-training layer 0, epoch 65, validation free energy -213.433321129
Pre-training layer 0, epoch 66, cost -70.8534222412
Pre-training layer 0, epoch 67, cost -70.6589628906
Pre-training layer 0, epoch 68, cost -70.6051988144
Pre-training layer 0, epoch 69, cost -70.4639226227
Pre-training layer 0, epoch 70, cost -70.434756279
Pre-training layer 0, epoch 70, representative training free energy -224.807201904
Pre-training layer 0, epoch 70, validation free energy -209.833580635
Pre-training layer 0, epoch 71, cost -70.4940323868
Pre-training layer 0, epoch 72, cost -70.3606032639
Pre-training layer 0, epoch 73, cost -70.3300903549
Pre-training layer 0, epoch 74, cost -70.2399925995
Pre-training layer 0, epoch 75, cost -70.2865090485
Pre-training layer 0, epoch 75, representative training free energy -226.470403381
Pre-training layer 0, epoch 75, validation free energy -210.789677422
Pre-training layer 0, epoch 76, cost -70.1012769318
Pre-training layer 0, epoch 77, cost -70.0919690399
Pre-training layer 0, epoch 78, cost -70.0883611679
Pre-training layer 0, epoch 79, cost -69.9627240601
Pre-training layer 0, epoch 80, cost -69.9798701859
Pre-training layer 0, epoch 80, representative training free energy -220.292203537
Pre-training layer 0, epoch 80, validation free energy -205.005915962
Pre-training layer 0, epoch 81, cost -69.9400647964
Pre-training layer 0, epoch 82, cost -69.8548632126
Pre-training layer 0, epoch 83, cost -69.7070554581
Pre-training layer 0, epoch 84, cost -69.7120517349
Pre-training layer 0, epoch 85, cost -69.6972005463
Pre-training layer 0, epoch 85, representative training free energy -215.553842896
Pre-training layer 0, epoch 85, validation free energy -199.390180489
Pre-training layer 0, epoch 86, cost -69.6938446045
Pre-training layer 0, epoch 87, cost -69.6475812073
Pre-training layer 0, epoch 88, cost -69.6730260162
Pre-training layer 0, epoch 89, cost -69.5791071701
Pre-training layer 0, epoch 90, cost -69.4894628983
Pre-training layer 0, epoch 90, representative training free energy -216.702724136
Pre-training layer 0, epoch 90, validation free energy -200.628620491
Pre-training layer 0, epoch 91, cost -69.5225068893
Pre-training layer 0, epoch 92, cost -69.3421732254
Pre-training layer 0, epoch 93, cost -69.3268131409
Pre-training layer 0, epoch 94, cost -69.3024150467
Pre-training layer 0, epoch 95, cost -69.2062631149
Pre-training layer 0, epoch 95, representative training free energy -209.672856384
Pre-training layer 0, epoch 95, validation free energy -191.90644899
Pre-training layer 0, epoch 96, cost -69.2955221405
Pre-training layer 0, epoch 97, cost -69.2108514023
Pre-training layer 0, epoch 98, cost -69.2132669983
Pre-training layer 0, epoch 99, cost -69.1333886414
Pre-training layer 1, epoch 0, cost -114.128765274
Pre-training layer 1, epoch 0, representative training free energy -331062.886805
Pre-training layer 1, epoch 0, validation free energy -329120.316539
Pre-training layer 1, epoch 1, cost -89.5143868256
Pre-training layer 1, epoch 2, cost -83.3603394547
Pre-training layer 1, epoch 3, cost -79.944137085
Pre-training layer 1, epoch 4, cost -77.6439585724
Pre-training layer 1, epoch 5, cost -75.921527832
Pre-training layer 1, epoch 5, representative training free energy -438694.642594
Pre-training layer 1, epoch 5, validation free energy -435919.420172
Pre-training layer 1, epoch 6, cost -74.5176203613
Pre-training layer 1, epoch 7, cost -73.4563743439
Pre-training layer 1, epoch 8, cost -72.5401356049
Pre-training layer 1, epoch 9, cost -71.7341603775
Pre-training layer 1, epoch 10, cost -71.1925710144
Pre-training layer 1, epoch 10, representative training free energy -488679.408578
Pre-training layer 1, epoch 10, validation free energy -485554.455141
Pre-training layer 1, epoch 11, cost -70.5113379669
Pre-training layer 1, epoch 12, cost -69.96151091
Pre-training layer 1, epoch 13, cost -69.5716782761
Pre-training layer 1, epoch 14, cost -69.1419282532
Pre-training layer 1, epoch 15, cost -68.6575293808
Pre-training layer 1, epoch 15, representative training free energy -523807.954656
Pre-training layer 1, epoch 15, validation free energy -520511.658203
Pre-training layer 1, epoch 16, cost -68.4043781204
Pre-training layer 1, epoch 17, cost -68.076497879
Pre-training layer 1, epoch 18, cost -67.820591423
Pre-training layer 1, epoch 19, cost -67.4349667587
Pre-training layer 1, epoch 20, cost -67.2580417938
Pre-training layer 1, epoch 20, representative training free energy -550890.959875
Pre-training layer 1, epoch 20, validation free energy -547433.295187
Pre-training layer 1, epoch 21, cost -66.9765575485
Pre-training layer 1, epoch 22, cost -66.7761418839
Pre-training layer 1, epoch 23, cost -66.4573986511
Pre-training layer 1, epoch 24, cost -66.2925393066
Pre-training layer 1, epoch 25, cost -66.2169452667
Pre-training layer 1, epoch 25, representative training free energy -572876.493484
Pre-training layer 1, epoch 25, validation free energy -569260.325141
Pre-training layer 1, epoch 26, cost -65.9649768295
Pre-training layer 1, epoch 27, cost -65.7050723267
Pre-training layer 1, epoch 28, cost -65.6300815277
Pre-training layer 1, epoch 29, cost -65.4744172516
Pre-training layer 1, epoch 30, cost -65.3058948898
Pre-training layer 1, epoch 30, representative training free energy -592249.584828
Pre-training layer 1, epoch 30, validation free energy -588527.630781
Pre-training layer 1, epoch 31, cost -65.1313204651
Pre-training layer 1, epoch 32, cost -65.0378537827
Pre-training layer 1, epoch 33, cost -64.9130699005
Pre-training layer 1, epoch 34, cost -64.7768059311
Pre-training layer 1, epoch 35, cost -64.6378414307
Pre-training layer 1, epoch 35, representative training free energy -608332.729406
Pre-training layer 1, epoch 35, validation free energy -604373.382188
Pre-training layer 1, epoch 36, cost -64.5594591522
Pre-training layer 1, epoch 37, cost -64.4362143402
Pre-training layer 1, epoch 38, cost -64.3595292358
Pre-training layer 1, epoch 39, cost -64.3264286575
Pre-training layer 1, epoch 40, cost -64.2568913193
Pre-training layer 1, epoch 40, representative training free energy -622593.645188
Pre-training layer 1, epoch 40, validation free energy -618583.401141
Pre-training layer 1, epoch 41, cost -63.9554815292
Pre-training layer 1, epoch 42, cost -64.0061826172
Pre-training layer 1, epoch 43, cost -63.9220306625
Pre-training layer 1, epoch 44, cost -63.7606191254
Pre-training layer 1, epoch 45, cost -63.7243118057
Pre-training layer 1, epoch 45, representative training free energy -635652.925719
Pre-training layer 1, epoch 45, validation free energy -631549.628125
Pre-training layer 1, epoch 46, cost -63.635259407
Pre-training layer 1, epoch 47, cost -63.5653282394
Pre-training layer 1, epoch 48, cost -63.5018923111
Pre-training layer 1, epoch 49, cost -63.4666394653
Pre-training layer 1, epoch 50, cost -63.4374546204
Pre-training layer 1, epoch 50, representative training free energy -647423.840875
Pre-training layer 1, epoch 50, validation free energy -643201.946609
Pre-training layer 1, epoch 51, cost -63.3446130981
Pre-training layer 1, epoch 52, cost -63.2424537888
Pre-training layer 1, epoch 53, cost -63.1745671539
Pre-training layer 1, epoch 54, cost -63.0479390106
Pre-training layer 1, epoch 55, cost -63.0769372787
Pre-training layer 1, epoch 55, representative training free energy -658990.637297
Pre-training layer 1, epoch 55, validation free energy -654762.940156
Pre-training layer 1, epoch 56, cost -62.9894468307
Pre-training layer 1, epoch 57, cost -62.9960175552
Pre-training layer 1, epoch 58, cost -62.8685911179
Pre-training layer 1, epoch 59, cost -62.8702488556
Pre-training layer 1, epoch 60, cost -62.8060135422
Pre-training layer 1, epoch 60, representative training free energy -668509.960625
Pre-training layer 1, epoch 60, validation free energy -664186.509016
Pre-training layer 1, epoch 61, cost -62.7148246689
Pre-training layer 1, epoch 62, cost -62.7207325668
Pre-training layer 1, epoch 63, cost -62.6096298447
Pre-training layer 1, epoch 64, cost -62.6595749397
Pre-training layer 1, epoch 65, cost -62.5758135834
Pre-training layer 1, epoch 65, representative training free energy -677525.865172
Pre-training layer 1, epoch 65, validation free energy -672962.154375
Pre-training layer 1, epoch 66, cost -62.553348465
Pre-training layer 1, epoch 67, cost -62.4942911224
Pre-training layer 1, epoch 68, cost -62.4414184952
Pre-training layer 1, epoch 69, cost -62.3994037094
Pre-training layer 1, epoch 70, cost -62.3567126007
Pre-training layer 1, epoch 70, representative training free energy -686688.241078
Pre-training layer 1, epoch 70, validation free energy -682169.159156
Pre-training layer 1, epoch 71, cost -62.3240518723
Pre-training layer 1, epoch 72, cost -62.2786569138
Pre-training layer 1, epoch 73, cost -62.3073508148
Pre-training layer 1, epoch 74, cost -62.177017395
Pre-training layer 1, epoch 75, cost -62.1179395218
Pre-training layer 1, epoch 75, representative training free energy -695035.573484
Pre-training layer 1, epoch 75, validation free energy -690397.051844
Pre-training layer 1, epoch 76, cost -62.1263959122
Pre-training layer 1, epoch 77, cost -62.0820091934
Pre-training layer 1, epoch 78, cost -62.0395746689
Pre-training layer 1, epoch 79, cost -62.1065972519
Pre-training layer 1, epoch 80, cost -62.0094997482
Pre-training layer 1, epoch 80, representative training free energy -702581.711516
Pre-training layer 1, epoch 80, validation free energy -697990.320109
Pre-training layer 1, epoch 81, cost -61.9523210678
Pre-training layer 1, epoch 82, cost -61.9502193527
Pre-training layer 1, epoch 83, cost -61.867819931
Pre-training layer 1, epoch 84, cost -61.921655098
Pre-training layer 1, epoch 85, cost -61.8585301666
Pre-training layer 1, epoch 85, representative training free energy -710272.525906
Pre-training layer 1, epoch 85, validation free energy -705531.866156
Pre-training layer 1, epoch 86, cost -61.8419502563
Pre-training layer 1, epoch 87, cost -61.8325440445
Pre-training layer 1, epoch 88, cost -61.7194627686
Pre-training layer 1, epoch 89, cost -61.785050087
Pre-training layer 1, epoch 90, cost -61.7061886368
Pre-training layer 1, epoch 90, representative training free energy -718162.156141
Pre-training layer 1, epoch 90, validation free energy -713379.289016
Pre-training layer 1, epoch 91, cost -61.6873766098
Pre-training layer 1, epoch 92, cost -61.5969522514
Pre-training layer 1, epoch 93, cost -61.6897164764
Pre-training layer 1, epoch 94, cost -61.5750083046
Pre-training layer 1, epoch 95, cost -61.5214752922
Pre-training layer 1, epoch 95, representative training free energy -724899.850297
Pre-training layer 1, epoch 95, validation free energy -720093.444328
Pre-training layer 1, epoch 96, cost -61.5475974274
Pre-training layer 1, epoch 97, cost -61.5164126244
Pre-training layer 1, epoch 98, cost -61.4723624878
Pre-training layer 1, epoch 99, cost -61.4747999878
Pre-training layer 2, epoch 0, cost -89.9888998566
Pre-training layer 2, epoch 0, representative training free energy 35606.9362129
Pre-training layer 2, epoch 0, validation free energy 35125.4449473
Pre-training layer 2, epoch 1, cost -66.5800223236
Pre-training layer 2, epoch 2, cost -61.9560901566
Pre-training layer 2, epoch 3, cost -59.2790962982
Pre-training layer 2, epoch 4, cost -57.6515764084
Pre-training layer 2, epoch 5, cost -56.3621268234
Pre-training layer 2, epoch 5, representative training free energy 132481.508535
Pre-training layer 2, epoch 5, validation free energy 131411.796035
Pre-training layer 2, epoch 6, cost -55.5224010544
Pre-training layer 2, epoch 7, cost -54.7174706268
Pre-training layer 2, epoch 8, cost -54.0532725143
Pre-training layer 2, epoch 9, cost -53.5683370819
Pre-training layer 2, epoch 10, cost -53.0625775909
Pre-training layer 2, epoch 10, representative training free energy 181774.501695
Pre-training layer 2, epoch 10, validation free energy 180495.426234
Pre-training layer 2, epoch 11, cost -52.6844002686
Pre-training layer 2, epoch 12, cost -52.3770488739
Pre-training layer 2, epoch 13, cost -51.9570679398
Pre-training layer 2, epoch 14, cost -51.7348367386
Pre-training layer 2, epoch 15, cost -51.4396217117
Pre-training layer 2, epoch 15, representative training free energy 211867.38207
Pre-training layer 2, epoch 15, validation free energy 210500.01768
Pre-training layer 2, epoch 16, cost -51.152772049
Pre-training layer 2, epoch 17, cost -51.0087275314
Pre-training layer 2, epoch 18, cost -50.7795126801
Pre-training layer 2, epoch 19, cost -50.6487577209
Pre-training layer 2, epoch 20, cost -50.4385940018
Pre-training layer 2, epoch 20, representative training free energy 234206.917367
Pre-training layer 2, epoch 20, validation free energy 232808.94007
Pre-training layer 2, epoch 21, cost -50.2525377426
Pre-training layer 2, epoch 22, cost -50.1370543213
Pre-training layer 2, epoch 23, cost -49.9636269684
Pre-training layer 2, epoch 24, cost -49.856320816
Pre-training layer 2, epoch 25, cost -49.7245639725
Pre-training layer 2, epoch 25, representative training free energy 249148.329523
Pre-training layer 2, epoch 25, validation free energy 247724.483992
Pre-training layer 2, epoch 26, cost -49.5489254532
Pre-training layer 2, epoch 27, cost -49.4576120377
Pre-training layer 2, epoch 28, cost -49.3848660583
Pre-training layer 2, epoch 29, cost -49.2618084488
Pre-training layer 2, epoch 30, cost -49.0809336624
Pre-training layer 2, epoch 30, representative training free energy 262922.716594
Pre-training layer 2, epoch 30, validation free energy 261487.616336
Pre-training layer 2, epoch 31, cost -49.0024751625
Pre-training layer 2, epoch 32, cost -48.9337189713
Pre-training layer 2, epoch 33, cost -48.8910921402
Pre-training layer 2, epoch 34, cost -48.8135617371
Pre-training layer 2, epoch 35, cost -48.6911249886
Pre-training layer 2, epoch 35, representative training free energy 273264.613766
Pre-training layer 2, epoch 35, validation free energy 271843.332898
Pre-training layer 2, epoch 36, cost -48.5729280472
Pre-training layer 2, epoch 37, cost -48.570847847
Pre-training layer 2, epoch 38, cost -48.5200702744
Pre-training layer 2, epoch 39, cost -48.4144791756
Pre-training layer 2, epoch 40, cost -48.3079675484
Pre-training layer 2, epoch 40, representative training free energy 282411.202852
Pre-training layer 2, epoch 40, validation free energy 281008.96093
Pre-training layer 2, epoch 41, cost -48.2460440216
Pre-training layer 2, epoch 42, cost -48.2012797737
Pre-training layer 2, epoch 43, cost -48.1436388054
Pre-training layer 2, epoch 44, cost -48.0111147003
Pre-training layer 2, epoch 45, cost -47.9592698441
Pre-training layer 2, epoch 45, representative training free energy 290703.748164
Pre-training layer 2, epoch 45, validation free energy 289237.413
Pre-training layer 2, epoch 46, cost -47.9663584213
Pre-training layer 2, epoch 47, cost -47.8663954582
Pre-training layer 2, epoch 48, cost -47.856463089
Pre-training layer 2, epoch 49, cost -47.7561086655
Pre-training layer 2, epoch 50, cost -47.7469843674
Pre-training layer 2, epoch 50, representative training free energy 296552.419031
Pre-training layer 2, epoch 50, validation free energy 295097.422984
Pre-training layer 2, epoch 51, cost -47.6932019882
Pre-training layer 2, epoch 52, cost -47.6144461288
Pre-training layer 2, epoch 53, cost -47.5933065834
Pre-training layer 2, epoch 54, cost -47.540765213
Pre-training layer 2, epoch 55, cost -47.5009450684
Pre-training layer 2, epoch 55, representative training free energy 302535.941852
Pre-training layer 2, epoch 55, validation free energy 301062.578336
Pre-training layer 2, epoch 56, cost -47.4494453316
Pre-training layer 2, epoch 57, cost -47.3617493477
Pre-training layer 2, epoch 58, cost -47.3054650803
Pre-training layer 2, epoch 59, cost -47.4153210068
Pre-training layer 2, epoch 60, cost -47.2445744057
Pre-training layer 2, epoch 60, representative training free energy 307227.915625
Pre-training layer 2, epoch 60, validation free energy 305708.530055
Pre-training layer 2, epoch 61, cost -47.2458116302
Pre-training layer 2, epoch 62, cost -47.215014679
Pre-training layer 2, epoch 63, cost -47.2307165604
Pre-training layer 2, epoch 64, cost -47.1942056808
Pre-training layer 2, epoch 65, cost -47.1037915421
Pre-training layer 2, epoch 65, representative training free energy 312042.693703
Pre-training layer 2, epoch 65, validation free energy 310505.317047
Pre-training layer 2, epoch 66, cost -47.1105115967
Pre-training layer 2, epoch 67, cost -47.0267217102
Pre-training layer 2, epoch 68, cost -47.0308811531
Pre-training layer 2, epoch 69, cost -47.0298086395
Pre-training layer 2, epoch 70, cost -46.9406105995
Pre-training layer 2, epoch 70, representative training free energy 314963.667695
Pre-training layer 2, epoch 70, validation free energy 313413.869109
Pre-training layer 2, epoch 71, cost -46.929062149
Pre-training layer 2, epoch 72, cost -46.8851478081
Pre-training layer 2, epoch 73, cost -46.8382444077
Pre-training layer 2, epoch 74, cost -46.7879213066
Pre-training layer 2, epoch 75, cost -46.7589831085
Pre-training layer 2, epoch 75, representative training free energy 318399.892273
Pre-training layer 2, epoch 75, validation free energy 316863.141609
Pre-training layer 2, epoch 76, cost -46.7780425835
Pre-training layer 2, epoch 77, cost -46.7884647942
Pre-training layer 2, epoch 78, cost -46.6525082359
Pre-training layer 2, epoch 79, cost -46.6923049545
Pre-training layer 2, epoch 80, cost -46.6552359161
Pre-training layer 2, epoch 80, representative training free energy 321905.754172
Pre-training layer 2, epoch 80, validation free energy 320346.37893
Pre-training layer 2, epoch 81, cost -46.6183037109
Pre-training layer 2, epoch 82, cost -46.6270986977
Pre-training layer 2, epoch 83, cost -46.5299548454
Pre-training layer 2, epoch 84, cost -46.6105026779
Pre-training layer 2, epoch 85, cost -46.5801767197
Pre-training layer 2, epoch 85, representative training free energy 326062.339
Pre-training layer 2, epoch 85, validation free energy 324530.077477
Pre-training layer 2, epoch 86, cost -46.473860424
Pre-training layer 2, epoch 87, cost -46.5163992195
Pre-training layer 2, epoch 88, cost -46.425570961
Pre-training layer 2, epoch 89, cost -46.4678799896
Pre-training layer 2, epoch 90, cost -46.405034771
Pre-training layer 2, epoch 90, representative training free energy 328466.330289
Pre-training layer 2, epoch 90, validation free energy 326876.063047
Pre-training layer 2, epoch 91, cost -46.3943632584
Pre-training layer 2, epoch 92, cost -46.3606984329
Pre-training layer 2, epoch 93, cost -46.3173426743
Pre-training layer 2, epoch 94, cost -46.2955812683
Pre-training layer 2, epoch 95, cost -46.3001073494
Pre-training layer 2, epoch 95, representative training free energy 330526.170398
Pre-training layer 2, epoch 95, validation free energy 328981.167625
Pre-training layer 2, epoch 96, cost -46.2591087952
Pre-training layer 2, epoch 97, cost -46.3155851669
Pre-training layer 2, epoch 98, cost -46.2618024216
Pre-training layer 2, epoch 99, cost -46.2277917747
The pretraining code for file dbn_loop.pyc ran for 4.74m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 13.100000 %
     epoch 1, minibatch 500/500, test error of best model 13.500000 %
epoch 2, minibatch 500/500, validation error 9.000000 %
     epoch 2, minibatch 500/500, test error of best model 8.100000 %
epoch 3, minibatch 500/500, validation error 7.300000 %
     epoch 3, minibatch 500/500, test error of best model 7.300000 %
epoch 4, minibatch 500/500, validation error 6.600000 %
     epoch 4, minibatch 500/500, test error of best model 7.000000 %
epoch 5, minibatch 500/500, validation error 5.700000 %
     epoch 5, minibatch 500/500, test error of best model 6.000000 %
epoch 6, minibatch 500/500, validation error 5.600000 %
     epoch 6, minibatch 500/500, test error of best model 5.700000 %
epoch 7, minibatch 500/500, validation error 5.500000 %
     epoch 7, minibatch 500/500, test error of best model 5.600000 %
epoch 8, minibatch 500/500, validation error 5.400000 %
     epoch 8, minibatch 500/500, test error of best model 5.300000 %
epoch 9, minibatch 500/500, validation error 5.300000 %
     epoch 9, minibatch 500/500, test error of best model 5.200000 %
epoch 10, minibatch 500/500, validation error 5.400000 %
epoch 11, minibatch 500/500, validation error 5.200000 %
     epoch 11, minibatch 500/500, test error of best model 5.200000 %
epoch 12, minibatch 500/500, validation error 5.100000 %
     epoch 12, minibatch 500/500, test error of best model 5.000000 %
epoch 13, minibatch 500/500, validation error 5.200000 %
epoch 14, minibatch 500/500, validation error 5.200000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
epoch 16, minibatch 500/500, validation error 5.100000 %
epoch 17, minibatch 500/500, validation error 5.200000 %
epoch 18, minibatch 500/500, validation error 5.200000 %
epoch 19, minibatch 500/500, validation error 5.000000 %
     epoch 19, minibatch 500/500, test error of best model 4.800000 %
epoch 20, minibatch 500/500, validation error 5.000000 %
epoch 21, minibatch 500/500, validation error 5.000000 %
epoch 22, minibatch 500/500, validation error 5.000000 %
epoch 23, minibatch 500/500, validation error 5.000000 %
epoch 24, minibatch 500/500, validation error 5.000000 %
epoch 25, minibatch 500/500, validation error 5.000000 %
epoch 26, minibatch 500/500, validation error 5.000000 %
epoch 27, minibatch 500/500, validation error 4.900000 %
     epoch 27, minibatch 500/500, test error of best model 4.700000 %
epoch 28, minibatch 500/500, validation error 4.800000 %
     epoch 28, minibatch 500/500, test error of best model 4.700000 %
epoch 29, minibatch 500/500, validation error 4.800000 %
epoch 30, minibatch 500/500, validation error 4.800000 %
epoch 31, minibatch 500/500, validation error 4.800000 %
epoch 32, minibatch 500/500, validation error 4.800000 %
epoch 33, minibatch 500/500, validation error 4.800000 %
epoch 34, minibatch 500/500, validation error 4.800000 %
epoch 35, minibatch 500/500, validation error 4.800000 %
epoch 36, minibatch 500/500, validation error 4.800000 %
epoch 37, minibatch 500/500, validation error 4.800000 %
epoch 38, minibatch 500/500, validation error 4.800000 %
epoch 39, minibatch 500/500, validation error 4.700000 %
     epoch 39, minibatch 500/500, test error of best model 4.600000 %
epoch 40, minibatch 500/500, validation error 4.700000 %
epoch 41, minibatch 500/500, validation error 4.700000 %
epoch 42, minibatch 500/500, validation error 4.700000 %
epoch 43, minibatch 500/500, validation error 4.600000 %
     epoch 43, minibatch 500/500, test error of best model 4.600000 %
epoch 44, minibatch 500/500, validation error 4.600000 %
epoch 45, minibatch 500/500, validation error 4.600000 %
epoch 46, minibatch 500/500, validation error 4.600000 %
epoch 47, minibatch 500/500, validation error 4.600000 %
epoch 48, minibatch 500/500, validation error 4.600000 %
epoch 49, minibatch 500/500, validation error 4.600000 %
epoch 50, minibatch 500/500, validation error 4.600000 %
epoch 51, minibatch 500/500, validation error 4.600000 %
epoch 52, minibatch 500/500, validation error 4.600000 %
epoch 53, minibatch 500/500, validation error 4.600000 %
epoch 54, minibatch 500/500, validation error 4.600000 %
epoch 55, minibatch 500/500, validation error 4.500000 %
     epoch 55, minibatch 500/500, test error of best model 4.600000 %
epoch 56, minibatch 500/500, validation error 4.500000 %
epoch 57, minibatch 500/500, validation error 4.500000 %
epoch 58, minibatch 500/500, validation error 4.500000 %
epoch 59, minibatch 500/500, validation error 4.500000 %
epoch 60, minibatch 500/500, validation error 4.500000 %
epoch 61, minibatch 500/500, validation error 4.500000 %
epoch 62, minibatch 500/500, validation error 4.500000 %
epoch 63, minibatch 500/500, validation error 4.500000 %
epoch 64, minibatch 500/500, validation error 4.500000 %
epoch 65, minibatch 500/500, validation error 4.500000 %
epoch 66, minibatch 500/500, validation error 4.500000 %
epoch 67, minibatch 500/500, validation error 4.500000 %
epoch 68, minibatch 500/500, validation error 4.500000 %
epoch 69, minibatch 500/500, validation error 4.500000 %
epoch 70, minibatch 500/500, validation error 4.500000 %
epoch 71, minibatch 500/500, validation error 4.500000 %
epoch 72, minibatch 500/500, validation error 4.500000 %
epoch 73, minibatch 500/500, validation error 4.500000 %
epoch 74, minibatch 500/500, validation error 4.500000 %
epoch 75, minibatch 500/500, validation error 4.500000 %
epoch 76, minibatch 500/500, validation error 4.500000 %
epoch 77, minibatch 500/500, validation error 4.500000 %
epoch 78, minibatch 500/500, validation error 4.500000 %
epoch 79, minibatch 500/500, validation error 4.500000 %
epoch 80, minibatch 500/500, validation error 4.500000 %
epoch 81, minibatch 500/500, validation error 4.500000 %
epoch 82, minibatch 500/500, validation error 4.500000 %
epoch 83, minibatch 500/500, validation error 4.500000 %
epoch 84, minibatch 500/500, validation error 4.500000 %
epoch 85, minibatch 500/500, validation error 4.500000 %
epoch 86, minibatch 500/500, validation error 4.500000 %
epoch 87, minibatch 500/500, validation error 4.500000 %
epoch 88, minibatch 500/500, validation error 4.500000 %
epoch 89, minibatch 500/500, validation error 4.500000 %
epoch 90, minibatch 500/500, validation error 4.500000 %
epoch 91, minibatch 500/500, validation error 4.500000 %
epoch 92, minibatch 500/500, validation error 4.500000 %
epoch 93, minibatch 500/500, validation error 4.500000 %
epoch 94, minibatch 500/500, validation error 4.500000 %
epoch 95, minibatch 500/500, validation error 4.500000 %
epoch 96, minibatch 500/500, validation error 4.500000 %
epoch 97, minibatch 500/500, validation error 4.500000 %
epoch 98, minibatch 500/500, validation error 4.500000 %
epoch 99, minibatch 500/500, validation error 4.500000 %
epoch 100, minibatch 500/500, validation error 4.500000 %
epoch 101, minibatch 500/500, validation error 4.500000 %
epoch 102, minibatch 500/500, validation error 4.500000 %
epoch 103, minibatch 500/500, validation error 4.500000 %
epoch 104, minibatch 500/500, validation error 4.500000 %
epoch 105, minibatch 500/500, validation error 4.500000 %
epoch 106, minibatch 500/500, validation error 4.500000 %
epoch 107, minibatch 500/500, validation error 4.500000 %
epoch 108, minibatch 500/500, validation error 4.500000 %
epoch 109, minibatch 500/500, validation error 4.500000 %
Optimization complete with best validation score of 4.500000 %, obtained at iteration 27500, with test performance 4.600000 %
The fine tuning code for file dbn_loop.pyc ran for 2.25m


==========Sample Size: (5000, 1500, 1500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.045566452
Pre-training layer 0, epoch 0, representative training free energy -255.868216197
Pre-training layer 0, epoch 0, validation free energy -251.193462738
Pre-training layer 0, epoch 1, cost -95.5412946014
Pre-training layer 0, epoch 2, cost -90.1894476624
Pre-training layer 0, epoch 3, cost -87.2084181976
Pre-training layer 0, epoch 4, cost -85.2869128113
Pre-training layer 0, epoch 5, cost -83.6429538269
Pre-training layer 0, epoch 5, representative training free energy -267.013941294
Pre-training layer 0, epoch 5, validation free energy -261.314057882
Pre-training layer 0, epoch 6, cost -82.5072763824
Pre-training layer 0, epoch 7, cost -81.6927917786
Pre-training layer 0, epoch 8, cost -80.8535371246
Pre-training layer 0, epoch 9, cost -80.1683092422
Pre-training layer 0, epoch 10, cost -79.4969605103
Pre-training layer 0, epoch 10, representative training free energy -266.898165914
Pre-training layer 0, epoch 10, validation free energy -258.0300631
Pre-training layer 0, epoch 11, cost -78.9602036438
Pre-training layer 0, epoch 12, cost -78.5779647217
Pre-training layer 0, epoch 13, cost -77.976608963
Pre-training layer 0, epoch 14, cost -77.6346034698
Pre-training layer 0, epoch 15, cost -77.2364612122
Pre-training layer 0, epoch 15, representative training free energy -265.902327474
Pre-training layer 0, epoch 15, validation free energy -256.489883881
Pre-training layer 0, epoch 16, cost -76.9581691284
Pre-training layer 0, epoch 17, cost -76.7250926514
Pre-training layer 0, epoch 18, cost -76.4694773178
Pre-training layer 0, epoch 19, cost -76.2052072144
Pre-training layer 0, epoch 20, cost -75.8204491882
Pre-training layer 0, epoch 20, representative training free energy -260.409017263
Pre-training layer 0, epoch 20, validation free energy -251.060468241
Pre-training layer 0, epoch 21, cost -75.7401701965
Pre-training layer 0, epoch 22, cost -75.4446999664
Pre-training layer 0, epoch 23, cost -75.285179985
Pre-training layer 0, epoch 24, cost -75.0484879532
Pre-training layer 0, epoch 25, cost -74.8491944122
Pre-training layer 0, epoch 25, representative training free energy -257.348170675
Pre-training layer 0, epoch 25, validation free energy -247.302185333
Pre-training layer 0, epoch 26, cost -74.6667338409
Pre-training layer 0, epoch 27, cost -74.6020381546
Pre-training layer 0, epoch 28, cost -74.3205242615
Pre-training layer 0, epoch 29, cost -74.2573907623
Pre-training layer 0, epoch 30, cost -74.0464896698
Pre-training layer 0, epoch 30, representative training free energy -257.663246582
Pre-training layer 0, epoch 30, validation free energy -247.533512787
Pre-training layer 0, epoch 31, cost -73.9625198975
Pre-training layer 0, epoch 32, cost -73.7350312881
Pre-training layer 0, epoch 33, cost -73.654146843
Pre-training layer 0, epoch 34, cost -73.5274876175
Pre-training layer 0, epoch 35, cost -73.3279993439
Pre-training layer 0, epoch 35, representative training free energy -253.936547089
Pre-training layer 0, epoch 35, validation free energy -242.335568792
Pre-training layer 0, epoch 36, cost -73.2839212036
Pre-training layer 0, epoch 37, cost -73.2486066055
Pre-training layer 0, epoch 38, cost -73.0706645813
Pre-training layer 0, epoch 39, cost -73.0169164734
Pre-training layer 0, epoch 40, cost -72.7934406891
Pre-training layer 0, epoch 40, representative training free energy -251.554575297
Pre-training layer 0, epoch 40, validation free energy -239.578184102
Pre-training layer 0, epoch 41, cost -72.8200335693
Pre-training layer 0, epoch 42, cost -72.5716835937
Pre-training layer 0, epoch 43, cost -72.5758487091
Pre-training layer 0, epoch 44, cost -72.4893811951
Pre-training layer 0, epoch 45, cost -72.3222894211
Pre-training layer 0, epoch 45, representative training free energy -248.087573466
Pre-training layer 0, epoch 45, validation free energy -236.251139445
Pre-training layer 0, epoch 46, cost -72.2639556732
Pre-training layer 0, epoch 47, cost -72.1211480637
Pre-training layer 0, epoch 48, cost -72.1151661911
Pre-training layer 0, epoch 49, cost -72.0187467194
Pre-training layer 0, epoch 50, cost -71.9028881149
Pre-training layer 0, epoch 50, representative training free energy -242.445182454
Pre-training layer 0, epoch 50, validation free energy -230.397890223
Pre-training layer 0, epoch 51, cost -71.7380532684
Pre-training layer 0, epoch 52, cost -71.7576567917
Pre-training layer 0, epoch 53, cost -71.7088613129
Pre-training layer 0, epoch 54, cost -71.6117440796
Pre-training layer 0, epoch 55, cost -71.5055237427
Pre-training layer 0, epoch 55, representative training free energy -237.130394257
Pre-training layer 0, epoch 55, validation free energy -224.478453786
Pre-training layer 0, epoch 56, cost -71.6166719742
Pre-training layer 0, epoch 57, cost -71.3837595978
Pre-training layer 0, epoch 58, cost -71.4118329468
Pre-training layer 0, epoch 59, cost -71.2347108154
Pre-training layer 0, epoch 60, cost -71.1976863632
Pre-training layer 0, epoch 60, representative training free energy -230.155691976
Pre-training layer 0, epoch 60, validation free energy -217.087327499
Pre-training layer 0, epoch 61, cost -71.1567139206
Pre-training layer 0, epoch 62, cost -71.135156723
Pre-training layer 0, epoch 63, cost -70.924755188
Pre-training layer 0, epoch 64, cost -70.9677949448
Pre-training layer 0, epoch 65, cost -70.9139123077
Pre-training layer 0, epoch 65, representative training free energy -233.285842845
Pre-training layer 0, epoch 65, validation free energy -219.257874237
Pre-training layer 0, epoch 66, cost -70.7803785324
Pre-training layer 0, epoch 67, cost -70.7718470154
Pre-training layer 0, epoch 68, cost -70.7595852509
Pre-training layer 0, epoch 69, cost -70.6204038086
Pre-training layer 0, epoch 70, cost -70.5746442947
Pre-training layer 0, epoch 70, representative training free energy -223.863031148
Pre-training layer 0, epoch 70, validation free energy -209.447846792
Pre-training layer 0, epoch 71, cost -70.5565471878
Pre-training layer 0, epoch 72, cost -70.4797276001
Pre-training layer 0, epoch 73, cost -70.3241899185
Pre-training layer 0, epoch 74, cost -70.3963352203
Pre-training layer 0, epoch 75, cost -70.2054731293
Pre-training layer 0, epoch 75, representative training free energy -223.252198374
Pre-training layer 0, epoch 75, validation free energy -208.463428538
Pre-training layer 0, epoch 76, cost -70.3638189316
Pre-training layer 0, epoch 77, cost -70.1549369888
Pre-training layer 0, epoch 78, cost -70.2444484787
Pre-training layer 0, epoch 79, cost -70.0492192001
Pre-training layer 0, epoch 80, cost -70.0424857788
Pre-training layer 0, epoch 80, representative training free energy -222.448146362
Pre-training layer 0, epoch 80, validation free energy -207.483762365
Pre-training layer 0, epoch 81, cost -69.9629584045
Pre-training layer 0, epoch 82, cost -69.8980266571
Pre-training layer 0, epoch 83, cost -69.8564256668
Pre-training layer 0, epoch 84, cost -69.8156262817
Pre-training layer 0, epoch 85, cost -69.7207257309
Pre-training layer 0, epoch 85, representative training free energy -215.080903483
Pre-training layer 0, epoch 85, validation free energy -200.168765569
Pre-training layer 0, epoch 86, cost -69.8059706268
Pre-training layer 0, epoch 87, cost -69.767860527
Pre-training layer 0, epoch 88, cost -69.5930873184
Pre-training layer 0, epoch 89, cost -69.6195856247
Pre-training layer 0, epoch 90, cost -69.5878258362
Pre-training layer 0, epoch 90, representative training free energy -213.141562469
Pre-training layer 0, epoch 90, validation free energy -197.824118347
Pre-training layer 0, epoch 91, cost -69.554039711
Pre-training layer 0, epoch 92, cost -69.5437194672
Pre-training layer 0, epoch 93, cost -69.5604563751
Pre-training layer 0, epoch 94, cost -69.3707337418
Pre-training layer 0, epoch 95, cost -69.4399100342
Pre-training layer 0, epoch 95, representative training free energy -209.00880897
Pre-training layer 0, epoch 95, validation free energy -193.098701675
Pre-training layer 0, epoch 96, cost -69.2535497437
Pre-training layer 0, epoch 97, cost -69.3901057053
Pre-training layer 0, epoch 98, cost -69.321685936
Pre-training layer 0, epoch 99, cost -69.3026212616
Pre-training layer 1, epoch 0, cost -108.935994019
Pre-training layer 1, epoch 0, representative training free energy -334239.130104
Pre-training layer 1, epoch 0, validation free energy -332875.614359
Pre-training layer 1, epoch 1, cost -85.2440624237
Pre-training layer 1, epoch 2, cost -79.1177714539
Pre-training layer 1, epoch 3, cost -75.8228737793
Pre-training layer 1, epoch 4, cost -73.5712865295
Pre-training layer 1, epoch 5, cost -71.8604401474
Pre-training layer 1, epoch 5, representative training free energy -448193.222219
Pre-training layer 1, epoch 5, validation free energy -446422.879781
Pre-training layer 1, epoch 6, cost -70.7056122894
Pre-training layer 1, epoch 7, cost -69.5208755722
Pre-training layer 1, epoch 8, cost -68.7028838882
Pre-training layer 1, epoch 9, cost -67.9309179459
Pre-training layer 1, epoch 10, cost -67.2544861832
Pre-training layer 1, epoch 10, representative training free energy -499445.845021
Pre-training layer 1, epoch 10, validation free energy -497554.129292
Pre-training layer 1, epoch 11, cost -66.6623980026
Pre-training layer 1, epoch 12, cost -66.1585356827
Pre-training layer 1, epoch 13, cost -65.78640345
Pre-training layer 1, epoch 14, cost -65.1914657745
Pre-training layer 1, epoch 15, cost -64.9462395096
Pre-training layer 1, epoch 15, representative training free energy -538485.197469
Pre-training layer 1, epoch 15, validation free energy -536550.787656
Pre-training layer 1, epoch 16, cost -64.6252308655
Pre-training layer 1, epoch 17, cost -64.1907471313
Pre-training layer 1, epoch 18, cost -63.8709439926
Pre-training layer 1, epoch 19, cost -63.6240907974
Pre-training layer 1, epoch 20, cost -63.4054064102
Pre-training layer 1, epoch 20, representative training free energy -566196.289156
Pre-training layer 1, epoch 20, validation free energy -564235.067521
Pre-training layer 1, epoch 21, cost -63.1063771744
Pre-training layer 1, epoch 22, cost -62.9111436081
Pre-training layer 1, epoch 23, cost -62.7724074173
Pre-training layer 1, epoch 24, cost -62.4676287842
Pre-training layer 1, epoch 25, cost -62.2744543228
Pre-training layer 1, epoch 25, representative training free energy -590751.361865
Pre-training layer 1, epoch 25, validation free energy -588729.061813
Pre-training layer 1, epoch 26, cost -62.1258141937
Pre-training layer 1, epoch 27, cost -61.9750736389
Pre-training layer 1, epoch 28, cost -61.790606575
Pre-training layer 1, epoch 29, cost -61.5758568954
Pre-training layer 1, epoch 30, cost -61.4404783325
Pre-training layer 1, epoch 30, representative training free energy -612054.549396
Pre-training layer 1, epoch 30, validation free energy -609966.748646
Pre-training layer 1, epoch 31, cost -61.3199686203
Pre-training layer 1, epoch 32, cost -61.2130453949
Pre-training layer 1, epoch 33, cost -61.1040728226
Pre-training layer 1, epoch 34, cost -60.8631043472
Pre-training layer 1, epoch 35, cost -60.8204868202
Pre-training layer 1, epoch 35, representative training free energy -629846.672
Pre-training layer 1, epoch 35, validation free energy -627640.829125
Pre-training layer 1, epoch 36, cost -60.7847393608
Pre-training layer 1, epoch 37, cost -60.6368615417
Pre-training layer 1, epoch 38, cost -60.4713894806
Pre-training layer 1, epoch 39, cost -60.4402898941
Pre-training layer 1, epoch 40, cost -60.2373364906
Pre-training layer 1, epoch 40, representative training free energy -645543.149615
Pre-training layer 1, epoch 40, validation free energy -643368.491823
Pre-training layer 1, epoch 41, cost -60.1761972389
Pre-training layer 1, epoch 42, cost -60.1473646088
Pre-training layer 1, epoch 43, cost -60.0872884216
Pre-training layer 1, epoch 44, cost -59.9345683365
Pre-training layer 1, epoch 45, cost -59.8534528923
Pre-training layer 1, epoch 45, representative training free energy -659534.450656
Pre-training layer 1, epoch 45, validation free energy -657241.89775
Pre-training layer 1, epoch 46, cost -59.7449112015
Pre-training layer 1, epoch 47, cost -59.6894790344
Pre-training layer 1, epoch 48, cost -59.6506288681
Pre-training layer 1, epoch 49, cost -59.5649847336
Pre-training layer 1, epoch 50, cost -59.4676259003
Pre-training layer 1, epoch 50, representative training free energy -672741.00451
Pre-training layer 1, epoch 50, validation free energy -670504.906615
Pre-training layer 1, epoch 51, cost -59.3923563538
Pre-training layer 1, epoch 52, cost -59.4355075188
Pre-training layer 1, epoch 53, cost -59.2695920868
Pre-training layer 1, epoch 54, cost -59.2517101097
Pre-training layer 1, epoch 55, cost -59.2061615601
Pre-training layer 1, epoch 55, representative training free energy -684824.757698
Pre-training layer 1, epoch 55, validation free energy -682501.593469
Pre-training layer 1, epoch 56, cost -59.0662020073
Pre-training layer 1, epoch 57, cost -59.0833088379
Pre-training layer 1, epoch 58, cost -58.950487442
Pre-training layer 1, epoch 59, cost -58.9525047035
Pre-training layer 1, epoch 60, cost -58.956841423
Pre-training layer 1, epoch 60, representative training free energy -694718.385375
Pre-training layer 1, epoch 60, validation free energy -692464.721646
Pre-training layer 1, epoch 61, cost -58.7826304092
Pre-training layer 1, epoch 62, cost -58.7520723648
Pre-training layer 1, epoch 63, cost -58.7231305084
Pre-training layer 1, epoch 64, cost -58.7033192902
Pre-training layer 1, epoch 65, cost -58.6427576103
Pre-training layer 1, epoch 65, representative training free energy -704919.283344
Pre-training layer 1, epoch 65, validation free energy -702577.715906
Pre-training layer 1, epoch 66, cost -58.6472922249
Pre-training layer 1, epoch 67, cost -58.6098298531
Pre-training layer 1, epoch 68, cost -58.5810927124
Pre-training layer 1, epoch 69, cost -58.511100708
Pre-training layer 1, epoch 70, cost -58.54164991
Pre-training layer 1, epoch 70, representative training free energy -714488.813906
Pre-training layer 1, epoch 70, validation free energy -712122.547333
Pre-training layer 1, epoch 71, cost -58.4454921341
Pre-training layer 1, epoch 72, cost -58.3872688599
Pre-training layer 1, epoch 73, cost -58.2925520897
Pre-training layer 1, epoch 74, cost -58.2551052399
Pre-training layer 1, epoch 75, cost -58.2609381332
Pre-training layer 1, epoch 75, representative training free energy -723991.459323
Pre-training layer 1, epoch 75, validation free energy -721605.613656
Pre-training layer 1, epoch 76, cost -58.274925045
Pre-training layer 1, epoch 77, cost -58.1979568062
Pre-training layer 1, epoch 78, cost -58.2087080727
Pre-training layer 1, epoch 79, cost -58.1263927956
Pre-training layer 1, epoch 80, cost -58.1063961334
Pre-training layer 1, epoch 80, representative training free energy -732387.731177
Pre-training layer 1, epoch 80, validation free energy -729983.930979
Pre-training layer 1, epoch 81, cost -58.0508298302
Pre-training layer 1, epoch 82, cost -58.0595356865
Pre-training layer 1, epoch 83, cost -58.0240120163
Pre-training layer 1, epoch 84, cost -57.9617786255
Pre-training layer 1, epoch 85, cost -57.9825881767
Pre-training layer 1, epoch 85, representative training free energy -740276.94049
Pre-training layer 1, epoch 85, validation free energy -737854.183917
Pre-training layer 1, epoch 86, cost -57.9687146225
Pre-training layer 1, epoch 87, cost -57.8918878632
Pre-training layer 1, epoch 88, cost -57.8525918274
Pre-training layer 1, epoch 89, cost -57.8291513329
Pre-training layer 1, epoch 90, cost -57.8157737732
Pre-training layer 1, epoch 90, representative training free energy -747665.265781
Pre-training layer 1, epoch 90, validation free energy -745254.051917
Pre-training layer 1, epoch 91, cost -57.764993084
Pre-training layer 1, epoch 92, cost -57.6543567238
Pre-training layer 1, epoch 93, cost -57.7223913307
Pre-training layer 1, epoch 94, cost -57.6448696518
Pre-training layer 1, epoch 95, cost -57.6185391464
Pre-training layer 1, epoch 95, representative training free energy -755206.283531
Pre-training layer 1, epoch 95, validation free energy -752722.197208
Pre-training layer 1, epoch 96, cost -57.585033535
Pre-training layer 1, epoch 97, cost -57.5643164253
Pre-training layer 1, epoch 98, cost -57.5930954819
Pre-training layer 1, epoch 99, cost -57.4797144165
Pre-training layer 2, epoch 0, cost -92.3772361298
Pre-training layer 2, epoch 0, representative training free energy 39858.0802624
Pre-training layer 2, epoch 0, validation free energy 39766.2772298
Pre-training layer 2, epoch 1, cost -68.7460464478
Pre-training layer 2, epoch 2, cost -63.6584194717
Pre-training layer 2, epoch 3, cost -61.115963501
Pre-training layer 2, epoch 4, cost -59.339572113
Pre-training layer 2, epoch 5, cost -58.1581483765
Pre-training layer 2, epoch 5, representative training free energy 161509.678049
Pre-training layer 2, epoch 5, validation free energy 161285.362844
Pre-training layer 2, epoch 6, cost -57.1134247208
Pre-training layer 2, epoch 7, cost -56.3349173584
Pre-training layer 2, epoch 8, cost -55.6234533005
Pre-training layer 2, epoch 9, cost -55.2022297974
Pre-training layer 2, epoch 10, cost -54.6825899124
Pre-training layer 2, epoch 10, representative training free energy 224513.053089
Pre-training layer 2, epoch 10, validation free energy 224290.416844
Pre-training layer 2, epoch 11, cost -54.254940506
Pre-training layer 2, epoch 12, cost -53.9218521805
Pre-training layer 2, epoch 13, cost -53.5401335678
Pre-training layer 2, epoch 14, cost -53.3001544342
Pre-training layer 2, epoch 15, cost -53.0495143356
Pre-training layer 2, epoch 15, representative training free energy 262818.697375
Pre-training layer 2, epoch 15, validation free energy 262577.718182
Pre-training layer 2, epoch 16, cost -52.765242897
Pre-training layer 2, epoch 17, cost -52.5387957687
Pre-training layer 2, epoch 18, cost -52.3353255234
Pre-training layer 2, epoch 19, cost -52.1161190948
Pre-training layer 2, epoch 20, cost -52.0563794403
Pre-training layer 2, epoch 20, representative training free energy 290836.09049
Pre-training layer 2, epoch 20, validation free energy 290617.797083
Pre-training layer 2, epoch 21, cost -51.7486954193
Pre-training layer 2, epoch 22, cost -51.5830280685
Pre-training layer 2, epoch 23, cost -51.4731376266
Pre-training layer 2, epoch 24, cost -51.2669446945
Pre-training layer 2, epoch 25, cost -51.231527916
Pre-training layer 2, epoch 25, representative training free energy 312255.886703
Pre-training layer 2, epoch 25, validation free energy 312027.443042
Pre-training layer 2, epoch 26, cost -51.0964666443
Pre-training layer 2, epoch 27, cost -50.9926916656
Pre-training layer 2, epoch 28, cost -50.8362832947
Pre-training layer 2, epoch 29, cost -50.6796794662
Pre-training layer 2, epoch 30, cost -50.6621449051
Pre-training layer 2, epoch 30, representative training free energy 328764.836172
Pre-training layer 2, epoch 30, validation free energy 328553.544286
Pre-training layer 2, epoch 31, cost -50.5335992355
Pre-training layer 2, epoch 32, cost -50.4512004852
Pre-training layer 2, epoch 33, cost -50.308922348
Pre-training layer 2, epoch 34, cost -50.2494657593
Pre-training layer 2, epoch 35, cost -50.1531374054
Pre-training layer 2, epoch 35, representative training free energy 343144.20762
Pre-training layer 2, epoch 35, validation free energy 342879.099089
Pre-training layer 2, epoch 36, cost -50.0255215759
Pre-training layer 2, epoch 37, cost -49.9703842697
Pre-training layer 2, epoch 38, cost -49.8956448669
Pre-training layer 2, epoch 39, cost -49.8996928635
Pre-training layer 2, epoch 40, cost -49.8011949158
Pre-training layer 2, epoch 40, representative training free energy 354562.587953
Pre-training layer 2, epoch 40, validation free energy 354292.923057
Pre-training layer 2, epoch 41, cost -49.6530786133
Pre-training layer 2, epoch 42, cost -49.6535909958
Pre-training layer 2, epoch 43, cost -49.5614978943
Pre-training layer 2, epoch 44, cost -49.5231494141
Pre-training layer 2, epoch 45, cost -49.4864815674
Pre-training layer 2, epoch 45, representative training free energy 365481.459432
Pre-training layer 2, epoch 45, validation free energy 365230.944667
Pre-training layer 2, epoch 46, cost -49.4304688339
Pre-training layer 2, epoch 47, cost -49.3418258286
Pre-training layer 2, epoch 48, cost -49.2764184265
Pre-training layer 2, epoch 49, cost -49.2142296906
Pre-training layer 2, epoch 50, cost -49.2450595398
Pre-training layer 2, epoch 50, representative training free energy 372139.328401
Pre-training layer 2, epoch 50, validation free energy 371919.434786
Pre-training layer 2, epoch 51, cost -49.1614719543
Pre-training layer 2, epoch 52, cost -49.1011303787
Pre-training layer 2, epoch 53, cost -49.0628011398
Pre-training layer 2, epoch 54, cost -49.003759903
Pre-training layer 2, epoch 55, cost -48.9164243622
Pre-training layer 2, epoch 55, representative training free energy 380473.307396
Pre-training layer 2, epoch 55, validation free energy 380225.036344
Pre-training layer 2, epoch 56, cost -48.9141401443
Pre-training layer 2, epoch 57, cost -48.8359108047
Pre-training layer 2, epoch 58, cost -48.8221092529
Pre-training layer 2, epoch 59, cost -48.7388833771
Pre-training layer 2, epoch 60, cost -48.6883955994
Pre-training layer 2, epoch 60, representative training free energy 388282.127182
Pre-training layer 2, epoch 60, validation free energy 388007.459177
Pre-training layer 2, epoch 61, cost -48.6439207764
Pre-training layer 2, epoch 62, cost -48.7281171188
Pre-training layer 2, epoch 63, cost -48.6570003586
Pre-training layer 2, epoch 64, cost -48.5088115463
Pre-training layer 2, epoch 65, cost -48.5739210739
Pre-training layer 2, epoch 65, representative training free energy 395336.521937
Pre-training layer 2, epoch 65, validation free energy 395067.679333
Pre-training layer 2, epoch 66, cost -48.5317913055
Pre-training layer 2, epoch 67, cost -48.4947211685
Pre-training layer 2, epoch 68, cost -48.4159559708
Pre-training layer 2, epoch 69, cost -48.3662680969
Pre-training layer 2, epoch 70, cost -48.4074196396
Pre-training layer 2, epoch 70, representative training free energy 400720.915807
Pre-training layer 2, epoch 70, validation free energy 400434.14937
Pre-training layer 2, epoch 71, cost -48.3386863861
Pre-training layer 2, epoch 72, cost -48.2948102264
Pre-training layer 2, epoch 73, cost -48.288056572
Pre-training layer 2, epoch 74, cost -48.2659503479
Pre-training layer 2, epoch 75, cost -48.2429410706
Pre-training layer 2, epoch 75, representative training free energy 405452.747917
Pre-training layer 2, epoch 75, validation free energy 405190.157167
Pre-training layer 2, epoch 76, cost -48.1701621361
Pre-training layer 2, epoch 77, cost -48.1676147003
Pre-training layer 2, epoch 78, cost -48.1429000893
Pre-training layer 2, epoch 79, cost -48.1874514771
Pre-training layer 2, epoch 80, cost -48.0532526016
Pre-training layer 2, epoch 80, representative training free energy 412766.481286
Pre-training layer 2, epoch 80, validation free energy 412470.380458
Pre-training layer 2, epoch 81, cost -48.0645051498
Pre-training layer 2, epoch 82, cost -48.035023098
Pre-training layer 2, epoch 83, cost -48.0544575577
Pre-training layer 2, epoch 84, cost -48.0241678085
Pre-training layer 2, epoch 85, cost -47.925884285
Pre-training layer 2, epoch 85, representative training free energy 416736.936292
Pre-training layer 2, epoch 85, validation free energy 416439.610115
Pre-training layer 2, epoch 86, cost -47.9412291946
Pre-training layer 2, epoch 87, cost -47.8993414001
Pre-training layer 2, epoch 88, cost -47.8614761696
Pre-training layer 2, epoch 89, cost -47.8878941574
Pre-training layer 2, epoch 90, cost -47.8352039757
Pre-training layer 2, epoch 90, representative training free energy 420783.929464
Pre-training layer 2, epoch 90, validation free energy 420499.88851
Pre-training layer 2, epoch 91, cost -47.8242097626
Pre-training layer 2, epoch 92, cost -47.8028228493
Pre-training layer 2, epoch 93, cost -47.7576784058
Pre-training layer 2, epoch 94, cost -47.7976194458
Pre-training layer 2, epoch 95, cost -47.8095563049
Pre-training layer 2, epoch 95, representative training free energy 424484.489312
Pre-training layer 2, epoch 95, validation free energy 424149.635667
Pre-training layer 2, epoch 96, cost -47.7505425949
Pre-training layer 2, epoch 97, cost -47.6834957581
Pre-training layer 2, epoch 98, cost -47.696609436
Pre-training layer 2, epoch 99, cost -47.6512415848
The pretraining code for file dbn_loop.pyc ran for 4.74m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 11.066667 %
     epoch 1, minibatch 500/500, test error of best model 14.000000 %
epoch 2, minibatch 500/500, validation error 7.466667 %
     epoch 2, minibatch 500/500, test error of best model 8.600000 %
epoch 3, minibatch 500/500, validation error 6.266667 %
     epoch 3, minibatch 500/500, test error of best model 7.466667 %
epoch 4, minibatch 500/500, validation error 5.666667 %
     epoch 4, minibatch 500/500, test error of best model 7.000000 %
epoch 5, minibatch 500/500, validation error 5.533333 %
     epoch 5, minibatch 500/500, test error of best model 6.466667 %
epoch 6, minibatch 500/500, validation error 5.200000 %
     epoch 6, minibatch 500/500, test error of best model 5.933333 %
epoch 7, minibatch 500/500, validation error 4.933333 %
     epoch 7, minibatch 500/500, test error of best model 5.733333 %
epoch 8, minibatch 500/500, validation error 4.800000 %
     epoch 8, minibatch 500/500, test error of best model 5.600000 %
epoch 9, minibatch 500/500, validation error 4.733333 %
     epoch 9, minibatch 500/500, test error of best model 5.533333 %
epoch 10, minibatch 500/500, validation error 4.600000 %
     epoch 10, minibatch 500/500, test error of best model 5.333333 %
epoch 11, minibatch 500/500, validation error 4.533333 %
     epoch 11, minibatch 500/500, test error of best model 5.266667 %
epoch 12, minibatch 500/500, validation error 4.466667 %
     epoch 12, minibatch 500/500, test error of best model 5.133333 %
epoch 13, minibatch 500/500, validation error 4.333333 %
     epoch 13, minibatch 500/500, test error of best model 5.133333 %
epoch 14, minibatch 500/500, validation error 4.333333 %
epoch 15, minibatch 500/500, validation error 4.400000 %
epoch 16, minibatch 500/500, validation error 4.466667 %
epoch 17, minibatch 500/500, validation error 4.466667 %
epoch 18, minibatch 500/500, validation error 4.466667 %
epoch 19, minibatch 500/500, validation error 4.400000 %
epoch 20, minibatch 500/500, validation error 4.400000 %
epoch 21, minibatch 500/500, validation error 4.400000 %
epoch 22, minibatch 500/500, validation error 4.400000 %
epoch 23, minibatch 500/500, validation error 4.400000 %
epoch 24, minibatch 500/500, validation error 4.400000 %
epoch 25, minibatch 500/500, validation error 4.333333 %
Optimization complete with best validation score of 4.333333 %, obtained at iteration 6500, with test performance 5.133333 %
The fine tuning code for file dbn_loop.pyc ran for 0.57m


==========Sample Size: (5000, 2000, 2000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.258496307
Pre-training layer 0, epoch 0, representative training free energy -252.861490494
Pre-training layer 0, epoch 0, validation free energy -249.154345253
Pre-training layer 0, epoch 1, cost -95.6599064026
Pre-training layer 0, epoch 2, cost -90.3754230423
Pre-training layer 0, epoch 3, cost -87.3007301559
Pre-training layer 0, epoch 4, cost -85.2872266464
Pre-training layer 0, epoch 5, cost -83.8152441559
Pre-training layer 0, epoch 5, representative training free energy -259.466765198
Pre-training layer 0, epoch 5, validation free energy -253.472565842
Pre-training layer 0, epoch 6, cost -82.6134403305
Pre-training layer 0, epoch 7, cost -81.6914653778
Pre-training layer 0, epoch 8, cost -80.8409775925
Pre-training layer 0, epoch 9, cost -80.2164469833
Pre-training layer 0, epoch 10, cost -79.6133132019
Pre-training layer 0, epoch 10, representative training free energy -265.576552612
Pre-training layer 0, epoch 10, validation free energy -256.925263855
Pre-training layer 0, epoch 11, cost -79.117633667
Pre-training layer 0, epoch 12, cost -78.5810911865
Pre-training layer 0, epoch 13, cost -78.2751886826
Pre-training layer 0, epoch 14, cost -77.7127448807
Pre-training layer 0, epoch 15, cost -77.4386266556
Pre-training layer 0, epoch 15, representative training free energy -254.834081696
Pre-training layer 0, epoch 15, validation free energy -245.750572548
Pre-training layer 0, epoch 16, cost -77.0963150101
Pre-training layer 0, epoch 17, cost -76.8274336166
Pre-training layer 0, epoch 18, cost -76.5093148041
Pre-training layer 0, epoch 19, cost -76.3116502686
Pre-training layer 0, epoch 20, cost -76.0587775879
Pre-training layer 0, epoch 20, representative training free energy -258.748348648
Pre-training layer 0, epoch 20, validation free energy -248.739535606
Pre-training layer 0, epoch 21, cost -75.7412387314
Pre-training layer 0, epoch 22, cost -75.6776941757
Pre-training layer 0, epoch 23, cost -75.3634862976
Pre-training layer 0, epoch 24, cost -75.2507243118
Pre-training layer 0, epoch 25, cost -74.972455719
Pre-training layer 0, epoch 25, representative training free energy -255.284240845
Pre-training layer 0, epoch 25, validation free energy -244.326154411
Pre-training layer 0, epoch 26, cost -74.7456934052
Pre-training layer 0, epoch 27, cost -74.5396839752
Pre-training layer 0, epoch 28, cost -74.4905643082
Pre-training layer 0, epoch 29, cost -74.3981298065
Pre-training layer 0, epoch 30, cost -74.1121073608
Pre-training layer 0, epoch 30, representative training free energy -252.130039452
Pre-training layer 0, epoch 30, validation free energy -241.324801399
Pre-training layer 0, epoch 31, cost -73.9821755066
Pre-training layer 0, epoch 32, cost -73.9915799179
Pre-training layer 0, epoch 33, cost -73.7382738037
Pre-training layer 0, epoch 34, cost -73.6569606171
Pre-training layer 0, epoch 35, cost -73.5365096436
Pre-training layer 0, epoch 35, representative training free energy -248.364996719
Pre-training layer 0, epoch 35, validation free energy -235.768401329
Pre-training layer 0, epoch 36, cost -73.3934850616
Pre-training layer 0, epoch 37, cost -73.3085258789
Pre-training layer 0, epoch 38, cost -73.1058206177
Pre-training layer 0, epoch 39, cost -72.9822186661
Pre-training layer 0, epoch 40, cost -72.9462493286
Pre-training layer 0, epoch 40, representative training free energy -242.512275902
Pre-training layer 0, epoch 40, validation free energy -230.633286522
Pre-training layer 0, epoch 41, cost -72.8070931778
Pre-training layer 0, epoch 42, cost -72.7376681061
Pre-training layer 0, epoch 43, cost -72.685322052
Pre-training layer 0, epoch 44, cost -72.5363498306
Pre-training layer 0, epoch 45, cost -72.3956890411
Pre-training layer 0, epoch 45, representative training free energy -239.966300728
Pre-training layer 0, epoch 45, validation free energy -227.294907757
Pre-training layer 0, epoch 46, cost -72.1617397842
Pre-training layer 0, epoch 47, cost -72.2544033356
Pre-training layer 0, epoch 48, cost -72.186840004
Pre-training layer 0, epoch 49, cost -72.1775367737
Pre-training layer 0, epoch 50, cost -72.0377930679
Pre-training layer 0, epoch 50, representative training free energy -233.222408554
Pre-training layer 0, epoch 50, validation free energy -219.717536896
Pre-training layer 0, epoch 51, cost -71.8865180664
Pre-training layer 0, epoch 52, cost -71.8226536331
Pre-training layer 0, epoch 53, cost -71.8777772293
Pre-training layer 0, epoch 54, cost -71.7976531448
Pre-training layer 0, epoch 55, cost -71.5170507507
Pre-training layer 0, epoch 55, representative training free energy -232.109789948
Pre-training layer 0, epoch 55, validation free energy -218.32116547
Pre-training layer 0, epoch 56, cost -71.5776966248
Pre-training layer 0, epoch 57, cost -71.4796057281
Pre-training layer 0, epoch 58, cost -71.3235662994
Pre-training layer 0, epoch 59, cost -71.3530543289
Pre-training layer 0, epoch 60, cost -71.3002494888
Pre-training layer 0, epoch 60, representative training free energy -222.075727882
Pre-training layer 0, epoch 60, validation free energy -208.918139778
Pre-training layer 0, epoch 61, cost -71.2063629303
Pre-training layer 0, epoch 62, cost -71.077140419
Pre-training layer 0, epoch 63, cost -71.0541201553
Pre-training layer 0, epoch 64, cost -70.9835214691
Pre-training layer 0, epoch 65, cost -70.8932758636
Pre-training layer 0, epoch 65, representative training free energy -219.726271378
Pre-training layer 0, epoch 65, validation free energy -205.948180595
Pre-training layer 0, epoch 66, cost -70.8733902359
Pre-training layer 0, epoch 67, cost -70.8167792435
Pre-training layer 0, epoch 68, cost -70.7819623947
Pre-training layer 0, epoch 69, cost -70.5707502975
Pre-training layer 0, epoch 70, cost -70.5423528061
Pre-training layer 0, epoch 70, representative training free energy -216.296177147
Pre-training layer 0, epoch 70, validation free energy -202.027519421
Pre-training layer 0, epoch 71, cost -70.5352319183
Pre-training layer 0, epoch 72, cost -70.4832644958
Pre-training layer 0, epoch 73, cost -70.4726388168
Pre-training layer 0, epoch 74, cost -70.3942307816
Pre-training layer 0, epoch 75, cost -70.3432930908
Pre-training layer 0, epoch 75, representative training free energy -212.600505142
Pre-training layer 0, epoch 75, validation free energy -198.440542755
Pre-training layer 0, epoch 76, cost -70.1829614639
Pre-training layer 0, epoch 77, cost -70.3450187531
Pre-training layer 0, epoch 78, cost -70.2041900101
Pre-training layer 0, epoch 79, cost -70.1371951828
Pre-training layer 0, epoch 80, cost -70.102612854
Pre-training layer 0, epoch 80, representative training free energy -208.539664444
Pre-training layer 0, epoch 80, validation free energy -193.161045597
Pre-training layer 0, epoch 81, cost -70.0015270767
Pre-training layer 0, epoch 82, cost -69.9411876678
Pre-training layer 0, epoch 83, cost -70.0527848206
Pre-training layer 0, epoch 84, cost -70.0114617538
Pre-training layer 0, epoch 85, cost -69.8433077621
Pre-training layer 0, epoch 85, representative training free energy -205.266754227
Pre-training layer 0, epoch 85, validation free energy -190.233908997
Pre-training layer 0, epoch 86, cost -69.760086319
Pre-training layer 0, epoch 87, cost -69.7578579102
Pre-training layer 0, epoch 88, cost -69.6239069138
Pre-training layer 0, epoch 89, cost -69.6646977692
Pre-training layer 0, epoch 90, cost -69.6029857559
Pre-training layer 0, epoch 90, representative training free energy -201.769493835
Pre-training layer 0, epoch 90, validation free energy -186.65542469
Pre-training layer 0, epoch 91, cost -69.6738785706
Pre-training layer 0, epoch 92, cost -69.5676026382
Pre-training layer 0, epoch 93, cost -69.4637506104
Pre-training layer 0, epoch 94, cost -69.3866820602
Pre-training layer 0, epoch 95, cost -69.4058101044
Pre-training layer 0, epoch 95, representative training free energy -199.453597839
Pre-training layer 0, epoch 95, validation free energy -184.018680195
Pre-training layer 0, epoch 96, cost -69.3950305405
Pre-training layer 0, epoch 97, cost -69.3149586334
Pre-training layer 0, epoch 98, cost -69.2879457626
Pre-training layer 0, epoch 99, cost -69.2377794495
Pre-training layer 1, epoch 0, cost -107.628453751
Pre-training layer 1, epoch 0, representative training free energy -338627.561246
Pre-training layer 1, epoch 0, validation free energy -336168.923395
Pre-training layer 1, epoch 1, cost -83.7388763351
Pre-training layer 1, epoch 2, cost -77.9275160904
Pre-training layer 1, epoch 3, cost -74.5266648865
Pre-training layer 1, epoch 4, cost -72.3903833008
Pre-training layer 1, epoch 5, cost -70.6726367187
Pre-training layer 1, epoch 5, representative training free energy -454755.651281
Pre-training layer 1, epoch 5, validation free energy -451429.019207
Pre-training layer 1, epoch 6, cost -69.3350776749
Pre-training layer 1, epoch 7, cost -68.3955630798
Pre-training layer 1, epoch 8, cost -67.5050283432
Pre-training layer 1, epoch 9, cost -66.7064810562
Pre-training layer 1, epoch 10, cost -66.0403343201
Pre-training layer 1, epoch 10, representative training free energy -507954.411086
Pre-training layer 1, epoch 10, validation free energy -504364.167996
Pre-training layer 1, epoch 11, cost -65.4443322525
Pre-training layer 1, epoch 12, cost -64.9658691254
Pre-training layer 1, epoch 13, cost -64.5185273666
Pre-training layer 1, epoch 14, cost -64.1472143555
Pre-training layer 1, epoch 15, cost -63.7475990295
Pre-training layer 1, epoch 15, representative training free energy -544968.563469
Pre-training layer 1, epoch 15, validation free energy -541208.501937
Pre-training layer 1, epoch 16, cost -63.3257615967
Pre-training layer 1, epoch 17, cost -63.027689003
Pre-training layer 1, epoch 18, cost -62.7923091125
Pre-training layer 1, epoch 19, cost -62.469677887
Pre-training layer 1, epoch 20, cost -62.2281013336
Pre-training layer 1, epoch 20, representative training free energy -573318.796148
Pre-training layer 1, epoch 20, validation free energy -569437.185398
Pre-training layer 1, epoch 21, cost -62.0299102631
Pre-training layer 1, epoch 22, cost -61.7995387115
Pre-training layer 1, epoch 23, cost -61.5608841705
Pre-training layer 1, epoch 24, cost -61.3646634064
Pre-training layer 1, epoch 25, cost -61.2277824554
Pre-training layer 1, epoch 25, representative training free energy -598454.957102
Pre-training layer 1, epoch 25, validation free energy -594406.520203
Pre-training layer 1, epoch 26, cost -61.0507823563
Pre-training layer 1, epoch 27, cost -60.8174368896
Pre-training layer 1, epoch 28, cost -60.6793751984
Pre-training layer 1, epoch 29, cost -60.5036461945
Pre-training layer 1, epoch 30, cost -60.3380128708
Pre-training layer 1, epoch 30, representative training free energy -617887.954398
Pre-training layer 1, epoch 30, validation free energy -613779.921773
Pre-training layer 1, epoch 31, cost -60.2260287247
Pre-training layer 1, epoch 32, cost -60.1055127258
Pre-training layer 1, epoch 33, cost -59.9953053665
Pre-training layer 1, epoch 34, cost -59.8160255814
Pre-training layer 1, epoch 35, cost -59.6810843582
Pre-training layer 1, epoch 35, representative training free energy -635412.751484
Pre-training layer 1, epoch 35, validation free energy -631257.660008
Pre-training layer 1, epoch 36, cost -59.646834198
Pre-training layer 1, epoch 37, cost -59.5038392868
Pre-training layer 1, epoch 38, cost -59.4334833069
Pre-training layer 1, epoch 39, cost -59.3195067978
Pre-training layer 1, epoch 40, cost -59.1953665009
Pre-training layer 1, epoch 40, representative training free energy -652264.255992
Pre-training layer 1, epoch 40, validation free energy -647993.019375
Pre-training layer 1, epoch 41, cost -59.1505810318
Pre-training layer 1, epoch 42, cost -59.0392531891
Pre-training layer 1, epoch 43, cost -58.9615615387
Pre-training layer 1, epoch 44, cost -58.8623399353
Pre-training layer 1, epoch 45, cost -58.8122208862
Pre-training layer 1, epoch 45, representative training free energy -665137.838523
Pre-training layer 1, epoch 45, validation free energy -660862.210125
Pre-training layer 1, epoch 46, cost -58.7234095306
Pre-training layer 1, epoch 47, cost -58.6800027161
Pre-training layer 1, epoch 48, cost -58.5817271881
Pre-training layer 1, epoch 49, cost -58.5328399353
Pre-training layer 1, epoch 50, cost -58.4598381271
Pre-training layer 1, epoch 50, representative training free energy -678869.16857
Pre-training layer 1, epoch 50, validation free energy -674428.241406
Pre-training layer 1, epoch 51, cost -58.452120285
Pre-training layer 1, epoch 52, cost -58.2771223145
Pre-training layer 1, epoch 53, cost -58.2541193848
Pre-training layer 1, epoch 54, cost -58.2252982864
Pre-training layer 1, epoch 55, cost -58.1417924042
Pre-training layer 1, epoch 55, representative training free energy -689368.15807
Pre-training layer 1, epoch 55, validation free energy -685004.551266
Pre-training layer 1, epoch 56, cost -58.0963477478
Pre-training layer 1, epoch 57, cost -58.1438194962
Pre-training layer 1, epoch 58, cost -57.974353302
Pre-training layer 1, epoch 59, cost -57.924096283
Pre-training layer 1, epoch 60, cost -57.9246568069
Pre-training layer 1, epoch 60, representative training free energy -700812.087445
Pre-training layer 1, epoch 60, validation free energy -696344.761039
Pre-training layer 1, epoch 61, cost -57.8580922852
Pre-training layer 1, epoch 62, cost -57.7618118668
Pre-training layer 1, epoch 63, cost -57.6657340851
Pre-training layer 1, epoch 64, cost -57.6940934143
Pre-training layer 1, epoch 65, cost -57.6191692352
Pre-training layer 1, epoch 65, representative training free energy -711831.169969
Pre-training layer 1, epoch 65, validation free energy -707408.78743
Pre-training layer 1, epoch 66, cost -57.5897505798
Pre-training layer 1, epoch 67, cost -57.5173529663
Pre-training layer 1, epoch 68, cost -57.4503977814
Pre-training layer 1, epoch 69, cost -57.5271433029
Pre-training layer 1, epoch 70, cost -57.4382767563
Pre-training layer 1, epoch 70, representative training free energy -720480.366813
Pre-training layer 1, epoch 70, validation free energy -716008.279555
Pre-training layer 1, epoch 71, cost -57.4145522766
Pre-training layer 1, epoch 72, cost -57.308032505
Pre-training layer 1, epoch 73, cost -57.3061183319
Pre-training layer 1, epoch 74, cost -57.3501421356
Pre-training layer 1, epoch 75, cost -57.2489482727
Pre-training layer 1, epoch 75, representative training free energy -729836.387031
Pre-training layer 1, epoch 75, validation free energy -725245.90393
Pre-training layer 1, epoch 76, cost -57.2244632645
Pre-training layer 1, epoch 77, cost -57.1755595322
Pre-training layer 1, epoch 78, cost -57.0573660583
Pre-training layer 1, epoch 79, cost -57.1417590942
Pre-training layer 1, epoch 80, cost -57.0527635193
Pre-training layer 1, epoch 80, representative training free energy -738463.698047
Pre-training layer 1, epoch 80, validation free energy -733871.168484
Pre-training layer 1, epoch 81, cost -57.0443834915
Pre-training layer 1, epoch 82, cost -57.0572343712
Pre-training layer 1, epoch 83, cost -56.9740313606
Pre-training layer 1, epoch 84, cost -56.9630751724
Pre-training layer 1, epoch 85, cost -56.9293908997
Pre-training layer 1, epoch 85, representative training free energy -746814.098797
Pre-training layer 1, epoch 85, validation free energy -742183.069398
Pre-training layer 1, epoch 86, cost -56.8432231827
Pre-training layer 1, epoch 87, cost -56.8392612076
Pre-training layer 1, epoch 88, cost -56.7585873108
Pre-training layer 1, epoch 89, cost -56.7652363968
Pre-training layer 1, epoch 90, cost -56.6969590225
Pre-training layer 1, epoch 90, representative training free energy -754629.90875
Pre-training layer 1, epoch 90, validation free energy -750009.051031
Pre-training layer 1, epoch 91, cost -56.7134694519
Pre-training layer 1, epoch 92, cost -56.7059864883
Pre-training layer 1, epoch 93, cost -56.6560523796
Pre-training layer 1, epoch 94, cost -56.6563759537
Pre-training layer 1, epoch 95, cost -56.5990554657
Pre-training layer 1, epoch 95, representative training free energy -762138.457797
Pre-training layer 1, epoch 95, validation free energy -757453.446375
Pre-training layer 1, epoch 96, cost -56.5996785583
Pre-training layer 1, epoch 97, cost -56.5960675468
Pre-training layer 1, epoch 98, cost -56.5745583649
Pre-training layer 1, epoch 99, cost -56.5527960434
Pre-training layer 2, epoch 0, cost -92.1170439377
Pre-training layer 2, epoch 0, representative training free energy 38808.5126851
Pre-training layer 2, epoch 0, validation free energy 38677.9055552
Pre-training layer 2, epoch 1, cost -68.7159192276
Pre-training layer 2, epoch 2, cost -63.7272846146
Pre-training layer 2, epoch 3, cost -61.1418945541
Pre-training layer 2, epoch 4, cost -59.4313628616
Pre-training layer 2, epoch 5, cost -58.2651900406
Pre-training layer 2, epoch 5, representative training free energy 149309.373986
Pre-training layer 2, epoch 5, validation free energy 148644.875971
Pre-training layer 2, epoch 6, cost -57.2550841751
Pre-training layer 2, epoch 7, cost -56.5156688461
Pre-training layer 2, epoch 8, cost -55.8657203598
Pre-training layer 2, epoch 9, cost -55.2963586655
Pre-training layer 2, epoch 10, cost -54.7367673721
Pre-training layer 2, epoch 10, representative training free energy 198482.220285
Pre-training layer 2, epoch 10, validation free energy 197639.836459
Pre-training layer 2, epoch 11, cost -54.415335022
Pre-training layer 2, epoch 12, cost -54.1426154251
Pre-training layer 2, epoch 13, cost -53.7711425552
Pre-training layer 2, epoch 14, cost -53.5425033951
Pre-training layer 2, epoch 15, cost -53.2436438522
Pre-training layer 2, epoch 15, representative training free energy 234188.848871
Pre-training layer 2, epoch 15, validation free energy 233278.975283
Pre-training layer 2, epoch 16, cost -53.0612420197
Pre-training layer 2, epoch 17, cost -52.7670652084
Pre-training layer 2, epoch 18, cost -52.4863658905
Pre-training layer 2, epoch 19, cost -52.3425683212
Pre-training layer 2, epoch 20, cost -52.2523740616
Pre-training layer 2, epoch 20, representative training free energy 255996.596078
Pre-training layer 2, epoch 20, validation free energy 255004.694732
Pre-training layer 2, epoch 21, cost -52.0284457169
Pre-training layer 2, epoch 22, cost -51.8977338867
Pre-training layer 2, epoch 23, cost -51.7373565292
Pre-training layer 2, epoch 24, cost -51.6048898621
Pre-training layer 2, epoch 25, cost -51.4246432495
Pre-training layer 2, epoch 25, representative training free energy 272701.641926
Pre-training layer 2, epoch 25, validation free energy 271696.572635
Pre-training layer 2, epoch 26, cost -51.3442095337
Pre-training layer 2, epoch 27, cost -51.1913286743
Pre-training layer 2, epoch 28, cost -51.048620575
Pre-training layer 2, epoch 29, cost -50.9987397919
Pre-training layer 2, epoch 30, cost -50.8682926636
Pre-training layer 2, epoch 30, representative training free energy 287270.744449
Pre-training layer 2, epoch 30, validation free energy 286211.13225
Pre-training layer 2, epoch 31, cost -50.8115130157
Pre-training layer 2, epoch 32, cost -50.6778856964
Pre-training layer 2, epoch 33, cost -50.6309078522
Pre-training layer 2, epoch 34, cost -50.5366476822
Pre-training layer 2, epoch 35, cost -50.4048163605
Pre-training layer 2, epoch 35, representative training free energy 299112.681758
Pre-training layer 2, epoch 35, validation free energy 298010.229359
Pre-training layer 2, epoch 36, cost -50.3283388596
Pre-training layer 2, epoch 37, cost -50.2888950424
Pre-training layer 2, epoch 38, cost -50.2134274902
Pre-training layer 2, epoch 39, cost -50.1372840576
Pre-training layer 2, epoch 40, cost -50.0062063293
Pre-training layer 2, epoch 40, representative training free energy 310172.758641
Pre-training layer 2, epoch 40, validation free energy 309064.239566
Pre-training layer 2, epoch 41, cost -50.0044339066
Pre-training layer 2, epoch 42, cost -49.971921669
Pre-training layer 2, epoch 43, cost -49.8099775391
Pre-training layer 2, epoch 44, cost -49.7368418503
Pre-training layer 2, epoch 45, cost -49.6998533859
Pre-training layer 2, epoch 45, representative training free energy 319064.167211
Pre-training layer 2, epoch 45, validation free energy 317912.098949
Pre-training layer 2, epoch 46, cost -49.7059396286
Pre-training layer 2, epoch 47, cost -49.6380361404
Pre-training layer 2, epoch 48, cost -49.5285220947
Pre-training layer 2, epoch 49, cost -49.6414780731
Pre-training layer 2, epoch 50, cost -49.4786761246
Pre-training layer 2, epoch 50, representative training free energy 326412.479738
Pre-training layer 2, epoch 50, validation free energy 325253.370773
Pre-training layer 2, epoch 51, cost -49.4077811127
Pre-training layer 2, epoch 52, cost -49.325405632
Pre-training layer 2, epoch 53, cost -49.2951929398
Pre-training layer 2, epoch 54, cost -49.2322020111
Pre-training layer 2, epoch 55, cost -49.2606203613
Pre-training layer 2, epoch 55, representative training free energy 334236.238703
Pre-training layer 2, epoch 55, validation free energy 333048.134059
Pre-training layer 2, epoch 56, cost -49.1985527954
Pre-training layer 2, epoch 57, cost -49.2148042297
Pre-training layer 2, epoch 58, cost -49.1132802048
Pre-training layer 2, epoch 59, cost -49.0800424347
Pre-training layer 2, epoch 60, cost -49.1132438278
Pre-training layer 2, epoch 60, representative training free energy 338184.043547
Pre-training layer 2, epoch 60, validation free energy 336987.26677
Pre-training layer 2, epoch 61, cost -48.9433273239
Pre-training layer 2, epoch 62, cost -48.9297161179
Pre-training layer 2, epoch 63, cost -48.8957709961
Pre-training layer 2, epoch 64, cost -48.9169183121
Pre-training layer 2, epoch 65, cost -48.8497911682
Pre-training layer 2, epoch 65, representative training free energy 344518.385672
Pre-training layer 2, epoch 65, validation free energy 343318.401707
Pre-training layer 2, epoch 66, cost -48.7786698685
Pre-training layer 2, epoch 67, cost -48.7819034348
Pre-training layer 2, epoch 68, cost -48.7616744156
Pre-training layer 2, epoch 69, cost -48.7166923981
Pre-training layer 2, epoch 70, cost -48.6825550766
Pre-training layer 2, epoch 70, representative training free energy 349245.847
Pre-training layer 2, epoch 70, validation free energy 348033.031496
Pre-training layer 2, epoch 71, cost -48.6765366135
Pre-training layer 2, epoch 72, cost -48.6663149796
Pre-training layer 2, epoch 73, cost -48.6128765106
Pre-training layer 2, epoch 74, cost -48.5406351166
Pre-training layer 2, epoch 75, cost -48.5207838058
Pre-training layer 2, epoch 75, representative training free energy 352121.150031
Pre-training layer 2, epoch 75, validation free energy 350853.395551
Pre-training layer 2, epoch 76, cost -48.5125174332
Pre-training layer 2, epoch 77, cost -48.4598093185
Pre-training layer 2, epoch 78, cost -48.4664294281
Pre-training layer 2, epoch 79, cost -48.3929159851
Pre-training layer 2, epoch 80, cost -48.4033712769
Pre-training layer 2, epoch 80, representative training free energy 356383.382895
Pre-training layer 2, epoch 80, validation free energy 355133.817895
Pre-training layer 2, epoch 81, cost -48.3730044632
Pre-training layer 2, epoch 82, cost -48.3394840469
Pre-training layer 2, epoch 83, cost -48.3146272049
Pre-training layer 2, epoch 84, cost -48.3052171402
Pre-training layer 2, epoch 85, cost -48.2641953278
Pre-training layer 2, epoch 85, representative training free energy 360189.835004
Pre-training layer 2, epoch 85, validation free energy 358935.584074
Pre-training layer 2, epoch 86, cost -48.2638424683
Pre-training layer 2, epoch 87, cost -48.2040259323
Pre-training layer 2, epoch 88, cost -48.1666368179
Pre-training layer 2, epoch 89, cost -48.1471453781
Pre-training layer 2, epoch 90, cost -48.1272592392
Pre-training layer 2, epoch 90, representative training free energy 364041.765918
Pre-training layer 2, epoch 90, validation free energy 362773.770371
Pre-training layer 2, epoch 91, cost -48.1202511444
Pre-training layer 2, epoch 92, cost -48.1207031555
Pre-training layer 2, epoch 93, cost -48.1610604324
Pre-training layer 2, epoch 94, cost -48.09560289
Pre-training layer 2, epoch 95, cost -48.029429306
Pre-training layer 2, epoch 95, representative training free energy 366723.569539
Pre-training layer 2, epoch 95, validation free energy 365453.70123
Pre-training layer 2, epoch 96, cost -48.0228896942
Pre-training layer 2, epoch 97, cost -47.9839145966
Pre-training layer 2, epoch 98, cost -47.9943865509
Pre-training layer 2, epoch 99, cost -47.9506885071
The pretraining code for file dbn_loop.pyc ran for 4.73m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 11.200000 %
     epoch 1, minibatch 500/500, test error of best model 13.550000 %
epoch 2, minibatch 500/500, validation error 7.700000 %
     epoch 2, minibatch 500/500, test error of best model 9.950000 %
epoch 3, minibatch 500/500, validation error 6.250000 %
     epoch 3, minibatch 500/500, test error of best model 8.700000 %
epoch 4, minibatch 500/500, validation error 5.700000 %
     epoch 4, minibatch 500/500, test error of best model 7.850000 %
epoch 5, minibatch 500/500, validation error 5.150000 %
     epoch 5, minibatch 500/500, test error of best model 7.350000 %
epoch 6, minibatch 500/500, validation error 4.850000 %
     epoch 6, minibatch 500/500, test error of best model 7.050000 %
epoch 7, minibatch 500/500, validation error 4.650000 %
     epoch 7, minibatch 500/500, test error of best model 6.800000 %
epoch 8, minibatch 500/500, validation error 4.400000 %
     epoch 8, minibatch 500/500, test error of best model 6.550000 %
epoch 9, minibatch 500/500, validation error 4.200000 %
     epoch 9, minibatch 500/500, test error of best model 6.400000 %
epoch 10, minibatch 500/500, validation error 4.150000 %
     epoch 10, minibatch 500/500, test error of best model 6.300000 %
epoch 11, minibatch 500/500, validation error 4.150000 %
epoch 12, minibatch 500/500, validation error 4.100000 %
     epoch 12, minibatch 500/500, test error of best model 6.050000 %
epoch 13, minibatch 500/500, validation error 4.050000 %
     epoch 13, minibatch 500/500, test error of best model 6.100000 %
epoch 14, minibatch 500/500, validation error 3.950000 %
     epoch 14, minibatch 500/500, test error of best model 6.050000 %
epoch 15, minibatch 500/500, validation error 3.900000 %
     epoch 15, minibatch 500/500, test error of best model 6.000000 %
epoch 16, minibatch 500/500, validation error 3.850000 %
     epoch 16, minibatch 500/500, test error of best model 5.950000 %
epoch 17, minibatch 500/500, validation error 3.850000 %
epoch 18, minibatch 500/500, validation error 3.900000 %
epoch 19, minibatch 500/500, validation error 3.850000 %
epoch 20, minibatch 500/500, validation error 3.850000 %
epoch 21, minibatch 500/500, validation error 3.850000 %
epoch 22, minibatch 500/500, validation error 3.850000 %
epoch 23, minibatch 500/500, validation error 3.800000 %
     epoch 23, minibatch 500/500, test error of best model 5.500000 %
epoch 24, minibatch 500/500, validation error 3.800000 %
epoch 25, minibatch 500/500, validation error 3.750000 %
     epoch 25, minibatch 500/500, test error of best model 5.350000 %
epoch 26, minibatch 500/500, validation error 3.750000 %
epoch 27, minibatch 500/500, validation error 3.750000 %
epoch 28, minibatch 500/500, validation error 3.750000 %
epoch 29, minibatch 500/500, validation error 3.750000 %
epoch 30, minibatch 500/500, validation error 3.750000 %
epoch 31, minibatch 500/500, validation error 3.750000 %
epoch 32, minibatch 500/500, validation error 3.750000 %
epoch 33, minibatch 500/500, validation error 3.700000 %
     epoch 33, minibatch 500/500, test error of best model 5.400000 %
epoch 34, minibatch 500/500, validation error 3.750000 %
epoch 35, minibatch 500/500, validation error 3.750000 %
epoch 36, minibatch 500/500, validation error 3.750000 %
epoch 37, minibatch 500/500, validation error 3.750000 %
epoch 38, minibatch 500/500, validation error 3.750000 %
epoch 39, minibatch 500/500, validation error 3.800000 %
epoch 40, minibatch 500/500, validation error 3.800000 %
epoch 41, minibatch 500/500, validation error 3.800000 %
epoch 42, minibatch 500/500, validation error 3.800000 %
epoch 43, minibatch 500/500, validation error 3.800000 %
epoch 44, minibatch 500/500, validation error 3.800000 %
epoch 45, minibatch 500/500, validation error 3.800000 %
epoch 46, minibatch 500/500, validation error 3.800000 %
epoch 47, minibatch 500/500, validation error 3.750000 %
epoch 48, minibatch 500/500, validation error 3.750000 %
epoch 49, minibatch 500/500, validation error 3.700000 %
epoch 50, minibatch 500/500, validation error 3.700000 %
epoch 51, minibatch 500/500, validation error 3.700000 %
epoch 52, minibatch 500/500, validation error 3.750000 %
epoch 53, minibatch 500/500, validation error 3.700000 %
epoch 54, minibatch 500/500, validation error 3.700000 %
epoch 55, minibatch 500/500, validation error 3.700000 %
epoch 56, minibatch 500/500, validation error 3.700000 %
epoch 57, minibatch 500/500, validation error 3.700000 %
epoch 58, minibatch 500/500, validation error 3.700000 %
epoch 59, minibatch 500/500, validation error 3.700000 %
epoch 60, minibatch 500/500, validation error 3.700000 %
epoch 61, minibatch 500/500, validation error 3.700000 %
epoch 62, minibatch 500/500, validation error 3.700000 %
epoch 63, minibatch 500/500, validation error 3.700000 %
epoch 64, minibatch 500/500, validation error 3.700000 %
epoch 65, minibatch 500/500, validation error 3.700000 %
Optimization complete with best validation score of 3.700000 %, obtained at iteration 16500, with test performance 5.400000 %
The fine tuning code for file dbn_loop.pyc ran for 1.47m
_______RUN: 1

==========Sample Size: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.860565857
Pre-training layer 0, epoch 0, representative training free energy -258.265059601
Pre-training layer 0, epoch 0, validation free energy -252.393258728
Pre-training layer 0, epoch 1, cost -95.5051795044
Pre-training layer 0, epoch 2, cost -90.1495387344
Pre-training layer 0, epoch 3, cost -87.0909361572
Pre-training layer 0, epoch 4, cost -85.1195702438
Pre-training layer 0, epoch 5, cost -83.6690696945
Pre-training layer 0, epoch 5, representative training free energy -266.481435455
Pre-training layer 0, epoch 5, validation free energy -256.847264587
Pre-training layer 0, epoch 6, cost -82.4720511169
Pre-training layer 0, epoch 7, cost -81.443925766
Pre-training layer 0, epoch 8, cost -80.6617700806
Pre-training layer 0, epoch 9, cost -80.1195153198
Pre-training layer 0, epoch 10, cost -79.5260460052
Pre-training layer 0, epoch 10, representative training free energy -268.546538177
Pre-training layer 0, epoch 10, validation free energy -258.912871307
Pre-training layer 0, epoch 11, cost -79.0170153809
Pre-training layer 0, epoch 12, cost -78.4231304703
Pre-training layer 0, epoch 13, cost -78.0601003342
Pre-training layer 0, epoch 14, cost -77.7635378036
Pre-training layer 0, epoch 15, cost -77.411053009
Pre-training layer 0, epoch 15, representative training free energy -263.80625705
Pre-training layer 0, epoch 15, validation free energy -252.191698608
Pre-training layer 0, epoch 16, cost -77.1090108414
Pre-training layer 0, epoch 17, cost -76.7644370499
Pre-training layer 0, epoch 18, cost -76.4561551208
Pre-training layer 0, epoch 19, cost -76.3170174713
Pre-training layer 0, epoch 20, cost -75.981664772
Pre-training layer 0, epoch 20, representative training free energy -260.992415771
Pre-training layer 0, epoch 20, validation free energy -248.04283844
Pre-training layer 0, epoch 21, cost -75.848967598
Pre-training layer 0, epoch 22, cost -75.5779949265
Pre-training layer 0, epoch 23, cost -75.3725738907
Pre-training layer 0, epoch 24, cost -75.2366944275
Pre-training layer 0, epoch 25, cost -75.0317798538
Pre-training layer 0, epoch 25, representative training free energy -257.84430835
Pre-training layer 0, epoch 25, validation free energy -245.091782837
Pre-training layer 0, epoch 26, cost -74.8113255997
Pre-training layer 0, epoch 27, cost -74.6261818085
Pre-training layer 0, epoch 28, cost -74.5425429764
Pre-training layer 0, epoch 29, cost -74.396048111
Pre-training layer 0, epoch 30, cost -74.2137909088
Pre-training layer 0, epoch 30, representative training free energy -255.183318939
Pre-training layer 0, epoch 30, validation free energy -241.744786285
Pre-training layer 0, epoch 31, cost -74.0393769608
Pre-training layer 0, epoch 32, cost -73.8877244492
Pre-training layer 0, epoch 33, cost -73.7934886703
Pre-training layer 0, epoch 34, cost -73.6729563446
Pre-training layer 0, epoch 35, cost -73.5376862411
Pre-training layer 0, epoch 35, representative training free energy -254.228054474
Pre-training layer 0, epoch 35, validation free energy -240.047700836
Pre-training layer 0, epoch 36, cost -73.4232606277
Pre-training layer 0, epoch 37, cost -73.2594632416
Pre-training layer 0, epoch 38, cost -73.188840683
Pre-training layer 0, epoch 39, cost -73.1629510956
Pre-training layer 0, epoch 40, cost -72.9502528381
Pre-training layer 0, epoch 40, representative training free energy -243.722761658
Pre-training layer 0, epoch 40, validation free energy -228.859125366
Pre-training layer 0, epoch 41, cost -72.8842024231
Pre-training layer 0, epoch 42, cost -72.7570068665
Pre-training layer 0, epoch 43, cost -72.5559497986
Pre-training layer 0, epoch 44, cost -72.5441764069
Pre-training layer 0, epoch 45, cost -72.4759946136
Pre-training layer 0, epoch 45, representative training free energy -243.689899536
Pre-training layer 0, epoch 45, validation free energy -228.564791351
Pre-training layer 0, epoch 46, cost -72.3355832214
Pre-training layer 0, epoch 47, cost -72.2919187088
Pre-training layer 0, epoch 48, cost -72.2015081177
Pre-training layer 0, epoch 49, cost -72.1348374786
Pre-training layer 0, epoch 50, cost -72.0771081238
Pre-training layer 0, epoch 50, representative training free energy -237.235557312
Pre-training layer 0, epoch 50, validation free energy -222.006738983
Pre-training layer 0, epoch 51, cost -71.9317547989
Pre-training layer 0, epoch 52, cost -71.7951253815
Pre-training layer 0, epoch 53, cost -71.7562305527
Pre-training layer 0, epoch 54, cost -71.6008894882
Pre-training layer 0, epoch 55, cost -71.6196188278
Pre-training layer 0, epoch 55, representative training free energy -234.284017487
Pre-training layer 0, epoch 55, validation free energy -219.825333374
Pre-training layer 0, epoch 56, cost -71.5649135513
Pre-training layer 0, epoch 57, cost -71.5788589325
Pre-training layer 0, epoch 58, cost -71.3997524185
Pre-training layer 0, epoch 59, cost -71.3565622101
Pre-training layer 0, epoch 60, cost -71.2283032761
Pre-training layer 0, epoch 60, representative training free energy -233.598562866
Pre-training layer 0, epoch 60, validation free energy -217.70394278
Pre-training layer 0, epoch 61, cost -71.3276908417
Pre-training layer 0, epoch 62, cost -71.1539321976
Pre-training layer 0, epoch 63, cost -71.0718745575
Pre-training layer 0, epoch 64, cost -70.9684775391
Pre-training layer 0, epoch 65, cost -70.9404563293
Pre-training layer 0, epoch 65, representative training free energy -227.289633301
Pre-training layer 0, epoch 65, validation free energy -211.379725037
Pre-training layer 0, epoch 66, cost -70.8177213058
Pre-training layer 0, epoch 67, cost -70.8681076126
Pre-training layer 0, epoch 68, cost -70.6794847717
Pre-training layer 0, epoch 69, cost -70.6744297638
Pre-training layer 0, epoch 70, cost -70.7086803513
Pre-training layer 0, epoch 70, representative training free energy -224.747777832
Pre-training layer 0, epoch 70, validation free energy -208.097071259
Pre-training layer 0, epoch 71, cost -70.6258070602
Pre-training layer 0, epoch 72, cost -70.5245029755
Pre-training layer 0, epoch 73, cost -70.4663993759
Pre-training layer 0, epoch 74, cost -70.3700673981
Pre-training layer 0, epoch 75, cost -70.3425024185
Pre-training layer 0, epoch 75, representative training free energy -219.746366913
Pre-training layer 0, epoch 75, validation free energy -202.459713013
Pre-training layer 0, epoch 76, cost -70.3120165329
Pre-training layer 0, epoch 77, cost -70.2987011719
Pre-training layer 0, epoch 78, cost -70.2057112808
Pre-training layer 0, epoch 79, cost -70.2637740707
Pre-training layer 0, epoch 80, cost -70.0742840958
Pre-training layer 0, epoch 80, representative training free energy -219.656354736
Pre-training layer 0, epoch 80, validation free energy -203.049476257
Pre-training layer 0, epoch 81, cost -70.0062940598
Pre-training layer 0, epoch 82, cost -70.0136463242
Pre-training layer 0, epoch 83, cost -70.0206537552
Pre-training layer 0, epoch 84, cost -69.9513245163
Pre-training layer 0, epoch 85, cost -69.9126451263
Pre-training layer 0, epoch 85, representative training free energy -212.237183472
Pre-training layer 0, epoch 85, validation free energy -195.18955513
Pre-training layer 0, epoch 86, cost -69.9176236191
Pre-training layer 0, epoch 87, cost -69.86986026
Pre-training layer 0, epoch 88, cost -69.7856490479
Pre-training layer 0, epoch 89, cost -69.7952021484
Pre-training layer 0, epoch 90, cost -69.654482048
Pre-training layer 0, epoch 90, representative training free energy -205.596419281
Pre-training layer 0, epoch 90, validation free energy -188.591305084
Pre-training layer 0, epoch 91, cost -69.6388109512
Pre-training layer 0, epoch 92, cost -69.6595168686
Pre-training layer 0, epoch 93, cost -69.6291023178
Pre-training layer 0, epoch 94, cost -69.5169194183
Pre-training layer 0, epoch 95, cost -69.4780665588
Pre-training layer 0, epoch 95, representative training free energy -205.887593994
Pre-training layer 0, epoch 95, validation free energy -188.753835953
Pre-training layer 0, epoch 96, cost -69.3860649185
Pre-training layer 0, epoch 97, cost -69.4312615204
Pre-training layer 0, epoch 98, cost -69.3325410919
Pre-training layer 0, epoch 99, cost -69.3146099472
Pre-training layer 1, epoch 0, cost -113.851840866
Pre-training layer 1, epoch 0, representative training free energy -328319.333781
Pre-training layer 1, epoch 0, validation free energy -325349.717312
Pre-training layer 1, epoch 1, cost -89.2935508194
Pre-training layer 1, epoch 2, cost -83.2668063812
Pre-training layer 1, epoch 3, cost -79.8614980469
Pre-training layer 1, epoch 4, cost -77.493215065
Pre-training layer 1, epoch 5, cost -75.8729034119
Pre-training layer 1, epoch 5, representative training free energy -434997.918719
Pre-training layer 1, epoch 5, validation free energy -431057.954875
Pre-training layer 1, epoch 6, cost -74.5457957077
Pre-training layer 1, epoch 7, cost -73.5396367874
Pre-training layer 1, epoch 8, cost -72.5980989456
Pre-training layer 1, epoch 9, cost -71.8084235306
Pre-training layer 1, epoch 10, cost -71.1957924957
Pre-training layer 1, epoch 10, representative training free energy -484178.42325
Pre-training layer 1, epoch 10, validation free energy -480005.959313
Pre-training layer 1, epoch 11, cost -70.5936104126
Pre-training layer 1, epoch 12, cost -70.0943697968
Pre-training layer 1, epoch 13, cost -69.6746067047
Pre-training layer 1, epoch 14, cost -69.1948907547
Pre-training layer 1, epoch 15, cost -68.7787320251
Pre-training layer 1, epoch 15, representative training free energy -519257.448938
Pre-training layer 1, epoch 15, validation free energy -514858.384406
Pre-training layer 1, epoch 16, cost -68.4980965424
Pre-training layer 1, epoch 17, cost -68.1734742355
Pre-training layer 1, epoch 18, cost -67.7901697617
Pre-training layer 1, epoch 19, cost -67.6337917252
Pre-training layer 1, epoch 20, cost -67.3115218658
Pre-training layer 1, epoch 20, representative training free energy -543816.269656
Pre-training layer 1, epoch 20, validation free energy -539357.05425
Pre-training layer 1, epoch 21, cost -67.037392662
Pre-training layer 1, epoch 22, cost -66.9327869339
Pre-training layer 1, epoch 23, cost -66.6017589645
Pre-training layer 1, epoch 24, cost -66.4621036148
Pre-training layer 1, epoch 25, cost -66.2763594666
Pre-training layer 1, epoch 25, representative training free energy -565843.947812
Pre-training layer 1, epoch 25, validation free energy -561183.491844
Pre-training layer 1, epoch 26, cost -66.0587267838
Pre-training layer 1, epoch 27, cost -65.8438221283
Pre-training layer 1, epoch 28, cost -65.7885478592
Pre-training layer 1, epoch 29, cost -65.6389130936
Pre-training layer 1, epoch 30, cost -65.4587128067
Pre-training layer 1, epoch 30, representative training free energy -584341.437031
Pre-training layer 1, epoch 30, validation free energy -579580.049094
Pre-training layer 1, epoch 31, cost -65.2514299164
Pre-training layer 1, epoch 32, cost -65.2311091385
Pre-training layer 1, epoch 33, cost -65.128148674
Pre-training layer 1, epoch 34, cost -64.9800022659
Pre-training layer 1, epoch 35, cost -64.8097824097
Pre-training layer 1, epoch 35, representative training free energy -600309.540656
Pre-training layer 1, epoch 35, validation free energy -595445.755719
Pre-training layer 1, epoch 36, cost -64.7171439819
Pre-training layer 1, epoch 37, cost -64.6374099045
Pre-training layer 1, epoch 38, cost -64.498601181
Pre-training layer 1, epoch 39, cost -64.428296524
Pre-training layer 1, epoch 40, cost -64.3123354568
Pre-training layer 1, epoch 40, representative training free energy -615123.332594
Pre-training layer 1, epoch 40, validation free energy -610115.526219
Pre-training layer 1, epoch 41, cost -64.2627638626
Pre-training layer 1, epoch 42, cost -64.0967511444
Pre-training layer 1, epoch 43, cost -64.0009856033
Pre-training layer 1, epoch 44, cost -63.8920272446
Pre-training layer 1, epoch 45, cost -63.8388448257
Pre-training layer 1, epoch 45, representative training free energy -627284.098687
Pre-training layer 1, epoch 45, validation free energy -622220.044063
Pre-training layer 1, epoch 46, cost -63.7681981735
Pre-training layer 1, epoch 47, cost -63.7176062965
Pre-training layer 1, epoch 48, cost -63.5988473129
Pre-training layer 1, epoch 49, cost -63.5340712242
Pre-training layer 1, epoch 50, cost -63.5409848251
Pre-training layer 1, epoch 50, representative training free energy -638846.843531
Pre-training layer 1, epoch 50, validation free energy -633674.535875
Pre-training layer 1, epoch 51, cost -63.4687488327
Pre-training layer 1, epoch 52, cost -63.4293239822
Pre-training layer 1, epoch 53, cost -63.3381289062
Pre-training layer 1, epoch 54, cost -63.2960338974
Pre-training layer 1, epoch 55, cost -63.2433317642
Pre-training layer 1, epoch 55, representative training free energy -650624.986531
Pre-training layer 1, epoch 55, validation free energy -645347.711219
Pre-training layer 1, epoch 56, cost -63.1649101868
Pre-training layer 1, epoch 57, cost -63.0900331955
Pre-training layer 1, epoch 58, cost -63.0046252556
Pre-training layer 1, epoch 59, cost -62.9669645233
Pre-training layer 1, epoch 60, cost -62.8750057831
Pre-training layer 1, epoch 60, representative training free energy -659450.563438
Pre-training layer 1, epoch 60, validation free energy -654159.842438
Pre-training layer 1, epoch 61, cost -62.8103602142
Pre-training layer 1, epoch 62, cost -62.7513514633
Pre-training layer 1, epoch 63, cost -62.789494957
Pre-training layer 1, epoch 64, cost -62.7421729279
Pre-training layer 1, epoch 65, cost -62.7629194412
Pre-training layer 1, epoch 65, representative training free energy -669579.8745
Pre-training layer 1, epoch 65, validation free energy -664172.924656
Pre-training layer 1, epoch 66, cost -62.6039503174
Pre-training layer 1, epoch 67, cost -62.5977628288
Pre-training layer 1, epoch 68, cost -62.5311852951
Pre-training layer 1, epoch 69, cost -62.5236454544
Pre-training layer 1, epoch 70, cost -62.3873869858
Pre-training layer 1, epoch 70, representative training free energy -677724.933375
Pre-training layer 1, epoch 70, validation free energy -672293.420312
Pre-training layer 1, epoch 71, cost -62.3599248543
Pre-training layer 1, epoch 72, cost -62.4114494476
Pre-training layer 1, epoch 73, cost -62.3753290596
Pre-training layer 1, epoch 74, cost -62.2713176041
Pre-training layer 1, epoch 75, cost -62.229264946
Pre-training layer 1, epoch 75, representative training free energy -685683.536094
Pre-training layer 1, epoch 75, validation free energy -680189.79875
Pre-training layer 1, epoch 76, cost -62.2368471947
Pre-training layer 1, epoch 77, cost -62.1299276886
Pre-training layer 1, epoch 78, cost -62.1449199905
Pre-training layer 1, epoch 79, cost -62.1033578796
Pre-training layer 1, epoch 80, cost -62.1081803131
Pre-training layer 1, epoch 80, representative training free energy -693741.341719
Pre-training layer 1, epoch 80, validation free energy -688143.21425
Pre-training layer 1, epoch 81, cost -62.0593317871
Pre-training layer 1, epoch 82, cost -62.0221928902
Pre-training layer 1, epoch 83, cost -61.9612696991
Pre-training layer 1, epoch 84, cost -61.9963740005
Pre-training layer 1, epoch 85, cost -61.9594622726
Pre-training layer 1, epoch 85, representative training free energy -701055.119
Pre-training layer 1, epoch 85, validation free energy -695433.588469
Pre-training layer 1, epoch 86, cost -61.8872783852
Pre-training layer 1, epoch 87, cost -61.9068272324
Pre-training layer 1, epoch 88, cost -61.8895026474
Pre-training layer 1, epoch 89, cost -61.8213148918
Pre-training layer 1, epoch 90, cost -61.799649025
Pre-training layer 1, epoch 90, representative training free energy -707332.450781
Pre-training layer 1, epoch 90, validation free energy -701730.575281
Pre-training layer 1, epoch 91, cost -61.7720394897
Pre-training layer 1, epoch 92, cost -61.7519276695
Pre-training layer 1, epoch 93, cost -61.7196585388
Pre-training layer 1, epoch 94, cost -61.6921533699
Pre-training layer 1, epoch 95, cost -61.6368224487
Pre-training layer 1, epoch 95, representative training free energy -714579.649906
Pre-training layer 1, epoch 95, validation free energy -708906.716813
Pre-training layer 1, epoch 96, cost -61.6301137047
Pre-training layer 1, epoch 97, cost -61.684290905
Pre-training layer 1, epoch 98, cost -61.6061564484
Pre-training layer 1, epoch 99, cost -61.6075538635
Pre-training layer 2, epoch 0, cost -89.1348059616
Pre-training layer 2, epoch 0, representative training free energy 33151.5174355
Pre-training layer 2, epoch 0, validation free energy 32910.2386426
Pre-training layer 2, epoch 1, cost -66.2499984818
Pre-training layer 2, epoch 2, cost -61.4604997406
Pre-training layer 2, epoch 3, cost -59.109778595
Pre-training layer 2, epoch 4, cost -57.1322801514
Pre-training layer 2, epoch 5, cost -55.9958928757
Pre-training layer 2, epoch 5, representative training free energy 132522.013992
Pre-training layer 2, epoch 5, validation free energy 131673.38607
Pre-training layer 2, epoch 6, cost -55.093573822
Pre-training layer 2, epoch 7, cost -54.220713707
Pre-training layer 2, epoch 8, cost -53.6331668243
Pre-training layer 2, epoch 9, cost -53.1060055084
Pre-training layer 2, epoch 10, cost -52.6342837524
Pre-training layer 2, epoch 10, representative training free energy 178641.575906
Pre-training layer 2, epoch 10, validation free energy 177560.723211
Pre-training layer 2, epoch 11, cost -52.2323409195
Pre-training layer 2, epoch 12, cost -51.917900238
Pre-training layer 2, epoch 13, cost -51.5883356323
Pre-training layer 2, epoch 14, cost -51.2776995926
Pre-training layer 2, epoch 15, cost -51.0438702774
Pre-training layer 2, epoch 15, representative training free energy 208784.801984
Pre-training layer 2, epoch 15, validation free energy 207538.807344
Pre-training layer 2, epoch 16, cost -50.751688736
Pre-training layer 2, epoch 17, cost -50.5702149734
Pre-training layer 2, epoch 18, cost -50.2748597412
Pre-training layer 2, epoch 19, cost -50.1726976166
Pre-training layer 2, epoch 20, cost -49.9860413589
Pre-training layer 2, epoch 20, representative training free energy 231684.908547
Pre-training layer 2, epoch 20, validation free energy 230323.260688
Pre-training layer 2, epoch 21, cost -49.7999124527
Pre-training layer 2, epoch 22, cost -49.6741068268
Pre-training layer 2, epoch 23, cost -49.556137886
Pre-training layer 2, epoch 24, cost -49.3555143013
Pre-training layer 2, epoch 25, cost -49.258160244
Pre-training layer 2, epoch 25, representative training free energy 247864.060375
Pre-training layer 2, epoch 25, validation free energy 246429.002547
Pre-training layer 2, epoch 26, cost -49.2086543121
Pre-training layer 2, epoch 27, cost -49.0462564011
Pre-training layer 2, epoch 28, cost -48.9567357559
Pre-training layer 2, epoch 29, cost -48.8765339775
Pre-training layer 2, epoch 30, cost -48.704271965
Pre-training layer 2, epoch 30, representative training free energy 260229.602453
Pre-training layer 2, epoch 30, validation free energy 258745.509187
Pre-training layer 2, epoch 31, cost -48.5944439735
Pre-training layer 2, epoch 32, cost -48.4103696518
Pre-training layer 2, epoch 33, cost -48.4474488449
Pre-training layer 2, epoch 34, cost -48.3532750244
Pre-training layer 2, epoch 35, cost -48.2650299377
Pre-training layer 2, epoch 35, representative training free energy 271559.692859
Pre-training layer 2, epoch 35, validation free energy 270026.401937
Pre-training layer 2, epoch 36, cost -48.2217664948
Pre-training layer 2, epoch 37, cost -48.1205461731
Pre-training layer 2, epoch 38, cost -47.9661664963
Pre-training layer 2, epoch 39, cost -47.9976937904
Pre-training layer 2, epoch 40, cost -47.9059143333
Pre-training layer 2, epoch 40, representative training free energy 280377.226641
Pre-training layer 2, epoch 40, validation free energy 278802.449234
Pre-training layer 2, epoch 41, cost -47.7803318634
Pre-training layer 2, epoch 42, cost -47.712978508
Pre-training layer 2, epoch 43, cost -47.6397638664
Pre-training layer 2, epoch 44, cost -47.6746156883
Pre-training layer 2, epoch 45, cost -47.4841813431
Pre-training layer 2, epoch 45, representative training free energy 288394.311687
Pre-training layer 2, epoch 45, validation free energy 286783.740312
Pre-training layer 2, epoch 46, cost -47.5675204506
Pre-training layer 2, epoch 47, cost -47.4793149414
Pre-training layer 2, epoch 48, cost -47.4459395218
Pre-training layer 2, epoch 49, cost -47.3119652061
Pre-training layer 2, epoch 50, cost -47.2921208839
Pre-training layer 2, epoch 50, representative training free energy 294684.579281
Pre-training layer 2, epoch 50, validation free energy 293040.656703
Pre-training layer 2, epoch 51, cost -47.300529026
Pre-training layer 2, epoch 52, cost -47.22606847
Pre-training layer 2, epoch 53, cost -47.1340874062
Pre-training layer 2, epoch 54, cost -47.1162693901
Pre-training layer 2, epoch 55, cost -47.0423471565
Pre-training layer 2, epoch 55, representative training free energy 300721.596672
Pre-training layer 2, epoch 55, validation free energy 299038.958703
Pre-training layer 2, epoch 56, cost -47.0135299263
Pre-training layer 2, epoch 57, cost -46.9542679482
Pre-training layer 2, epoch 58, cost -46.988560379
Pre-training layer 2, epoch 59, cost -46.9270795631
Pre-training layer 2, epoch 60, cost -46.9508150482
Pre-training layer 2, epoch 60, representative training free energy 306400.616125
Pre-training layer 2, epoch 60, validation free energy 304720.247125
Pre-training layer 2, epoch 61, cost -46.8197943497
Pre-training layer 2, epoch 62, cost -46.7975825462
Pre-training layer 2, epoch 63, cost -46.815912262
Pre-training layer 2, epoch 64, cost -46.7480864067
Pre-training layer 2, epoch 65, cost -46.7037774811
Pre-training layer 2, epoch 65, representative training free energy 310733.064281
Pre-training layer 2, epoch 65, validation free energy 309014.404547
Pre-training layer 2, epoch 66, cost -46.6421331253
Pre-training layer 2, epoch 67, cost -46.641133152
Pre-training layer 2, epoch 68, cost -46.5915854149
Pre-training layer 2, epoch 69, cost -46.5789254456
Pre-training layer 2, epoch 70, cost -46.5046176338
Pre-training layer 2, epoch 70, representative training free energy 315011.941031
Pre-training layer 2, epoch 70, validation free energy 313276.297109
Pre-training layer 2, epoch 71, cost -46.4528565102
Pre-training layer 2, epoch 72, cost -46.4768847771
Pre-training layer 2, epoch 73, cost -46.4634579659
Pre-training layer 2, epoch 74, cost -46.4564506302
Pre-training layer 2, epoch 75, cost -46.4000501785
Pre-training layer 2, epoch 75, representative training free energy 318722.60275
Pre-training layer 2, epoch 75, validation free energy 316978.680563
Pre-training layer 2, epoch 76, cost -46.3698740082
Pre-training layer 2, epoch 77, cost -46.3638063087
Pre-training layer 2, epoch 78, cost -46.2889811745
Pre-training layer 2, epoch 79, cost -46.2406842918
Pre-training layer 2, epoch 80, cost -46.2187359428
Pre-training layer 2, epoch 80, representative training free energy 321770.556062
Pre-training layer 2, epoch 80, validation free energy 319997.789203
Pre-training layer 2, epoch 81, cost -46.2334109688
Pre-training layer 2, epoch 82, cost -46.1985969505
Pre-training layer 2, epoch 83, cost -46.2581686058
Pre-training layer 2, epoch 84, cost -46.1216107025
Pre-training layer 2, epoch 85, cost -46.1757488251
Pre-training layer 2, epoch 85, representative training free energy 325445.920547
Pre-training layer 2, epoch 85, validation free energy 323675.215141
Pre-training layer 2, epoch 86, cost -46.0726798553
Pre-training layer 2, epoch 87, cost -46.1226092224
Pre-training layer 2, epoch 88, cost -46.0697966347
Pre-training layer 2, epoch 89, cost -46.0653971786
Pre-training layer 2, epoch 90, cost -45.986860817
Pre-training layer 2, epoch 90, representative training free energy 328341.710109
Pre-training layer 2, epoch 90, validation free energy 326567.515344
Pre-training layer 2, epoch 91, cost -46.0269977455
Pre-training layer 2, epoch 92, cost -45.9748759155
Pre-training layer 2, epoch 93, cost -45.9503886414
Pre-training layer 2, epoch 94, cost -45.9527472954
Pre-training layer 2, epoch 95, cost -45.9677140236
Pre-training layer 2, epoch 95, representative training free energy 331663.758062
Pre-training layer 2, epoch 95, validation free energy 329859.307125
Pre-training layer 2, epoch 96, cost -45.9310808449
Pre-training layer 2, epoch 97, cost -45.9243217201
Pre-training layer 2, epoch 98, cost -45.8237526779
Pre-training layer 2, epoch 99, cost -45.7523732986
The pretraining code for file dbn_loop.pyc ran for 4.74m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.200000 %
     epoch 1, minibatch 500/500, test error of best model 11.400000 %
epoch 2, minibatch 500/500, validation error 8.600000 %
     epoch 2, minibatch 500/500, test error of best model 7.000000 %
epoch 3, minibatch 500/500, validation error 7.200000 %
     epoch 3, minibatch 500/500, test error of best model 6.000000 %
epoch 4, minibatch 500/500, validation error 6.800000 %
     epoch 4, minibatch 500/500, test error of best model 5.600000 %
epoch 5, minibatch 500/500, validation error 6.600000 %
     epoch 5, minibatch 500/500, test error of best model 5.600000 %
epoch 6, minibatch 500/500, validation error 6.000000 %
     epoch 6, minibatch 500/500, test error of best model 5.400000 %
epoch 7, minibatch 500/500, validation error 6.200000 %
epoch 8, minibatch 500/500, validation error 5.800000 %
     epoch 8, minibatch 500/500, test error of best model 5.200000 %
epoch 9, minibatch 500/500, validation error 5.200000 %
     epoch 9, minibatch 500/500, test error of best model 5.400000 %
epoch 10, minibatch 500/500, validation error 5.000000 %
     epoch 10, minibatch 500/500, test error of best model 5.200000 %
epoch 11, minibatch 500/500, validation error 5.000000 %
epoch 12, minibatch 500/500, validation error 5.000000 %
epoch 13, minibatch 500/500, validation error 5.200000 %
epoch 14, minibatch 500/500, validation error 5.200000 %
epoch 15, minibatch 500/500, validation error 5.200000 %
epoch 16, minibatch 500/500, validation error 5.200000 %
epoch 17, minibatch 500/500, validation error 5.200000 %
epoch 18, minibatch 500/500, validation error 5.200000 %
epoch 19, minibatch 500/500, validation error 5.200000 %
Optimization complete with best validation score of 5.000000 %, obtained at iteration 5000, with test performance 5.200000 %
The fine tuning code for file dbn_loop.pyc ran for 0.40m


==========Sample Size: (5000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.815613052
Pre-training layer 0, epoch 0, representative training free energy -253.873769714
Pre-training layer 0, epoch 0, validation free energy -249.150878983
Pre-training layer 0, epoch 1, cost -95.6001540833
Pre-training layer 0, epoch 2, cost -90.2096096802
Pre-training layer 0, epoch 3, cost -87.12900737
Pre-training layer 0, epoch 4, cost -85.3290386276
Pre-training layer 0, epoch 5, cost -83.7850362854
Pre-training layer 0, epoch 5, representative training free energy -262.907135361
Pre-training layer 0, epoch 5, validation free energy -254.465008591
Pre-training layer 0, epoch 6, cost -82.5948456192
Pre-training layer 0, epoch 7, cost -81.6583613281
Pre-training layer 0, epoch 8, cost -80.6794678192
Pre-training layer 0, epoch 9, cost -80.1200151672
Pre-training layer 0, epoch 10, cost -79.4213173904
Pre-training layer 0, epoch 10, representative training free energy -265.592801834
Pre-training layer 0, epoch 10, validation free energy -257.15280954
Pre-training layer 0, epoch 11, cost -78.875615509
Pre-training layer 0, epoch 12, cost -78.494427887
Pre-training layer 0, epoch 13, cost -77.9469589767
Pre-training layer 0, epoch 14, cost -77.8244440536
Pre-training layer 0, epoch 15, cost -77.3240841675
Pre-training layer 0, epoch 15, representative training free energy -261.389467316
Pre-training layer 0, epoch 15, validation free energy -251.403852524
Pre-training layer 0, epoch 16, cost -77.0339127045
Pre-training layer 0, epoch 17, cost -76.712125
Pre-training layer 0, epoch 18, cost -76.2754409332
Pre-training layer 0, epoch 19, cost -76.149878479
Pre-training layer 0, epoch 20, cost -75.9060654984
Pre-training layer 0, epoch 20, representative training free energy -264.441583237
Pre-training layer 0, epoch 20, validation free energy -254.040259094
Pre-training layer 0, epoch 21, cost -75.7974847641
Pre-training layer 0, epoch 22, cost -75.4353703461
Pre-training layer 0, epoch 23, cost -75.2530575638
Pre-training layer 0, epoch 24, cost -75.0090845184
Pre-training layer 0, epoch 25, cost -74.9275173798
Pre-training layer 0, epoch 25, representative training free energy -255.394031723
Pre-training layer 0, epoch 25, validation free energy -245.323502274
Pre-training layer 0, epoch 26, cost -74.789788208
Pre-training layer 0, epoch 27, cost -74.4702935638
Pre-training layer 0, epoch 28, cost -74.3184706116
Pre-training layer 0, epoch 29, cost -74.1683376541
Pre-training layer 0, epoch 30, cost -73.9913102951
Pre-training layer 0, epoch 30, representative training free energy -255.005180161
Pre-training layer 0, epoch 30, validation free energy -242.855614731
Pre-training layer 0, epoch 31, cost -73.8807313614
Pre-training layer 0, epoch 32, cost -73.7364299698
Pre-training layer 0, epoch 33, cost -73.6426203232
Pre-training layer 0, epoch 34, cost -73.4464398193
Pre-training layer 0, epoch 35, cost -73.2664431763
Pre-training layer 0, epoch 35, representative training free energy -246.82793129
Pre-training layer 0, epoch 35, validation free energy -234.549227081
Pre-training layer 0, epoch 36, cost -73.3366175842
Pre-training layer 0, epoch 37, cost -73.1107035294
Pre-training layer 0, epoch 38, cost -73.1332479248
Pre-training layer 0, epoch 39, cost -72.9378315964
Pre-training layer 0, epoch 40, cost -72.7888115692
Pre-training layer 0, epoch 40, representative training free energy -249.128192642
Pre-training layer 0, epoch 40, validation free energy -235.821140381
Pre-training layer 0, epoch 41, cost -72.6201778107
Pre-training layer 0, epoch 42, cost -72.583401268
Pre-training layer 0, epoch 43, cost -72.4542272415
Pre-training layer 0, epoch 44, cost -72.4155548096
Pre-training layer 0, epoch 45, cost -72.2736806412
Pre-training layer 0, epoch 45, representative training free energy -241.096264389
Pre-training layer 0, epoch 45, validation free energy -227.25015535
Pre-training layer 0, epoch 46, cost -72.2525581131
Pre-training layer 0, epoch 47, cost -72.1126035004
Pre-training layer 0, epoch 48, cost -72.0771415253
Pre-training layer 0, epoch 49, cost -71.8790682068
Pre-training layer 0, epoch 50, cost -71.9192975311
Pre-training layer 0, epoch 50, representative training free energy -238.115993301
Pre-training layer 0, epoch 50, validation free energy -224.801708633
Pre-training layer 0, epoch 51, cost -71.7102849579
Pre-training layer 0, epoch 52, cost -71.7230520706
Pre-training layer 0, epoch 53, cost -71.5354952774
Pre-training layer 0, epoch 54, cost -71.5444169159
Pre-training layer 0, epoch 55, cost -71.5661757584
Pre-training layer 0, epoch 55, representative training free energy -233.573142715
Pre-training layer 0, epoch 55, validation free energy -219.142365921
Pre-training layer 0, epoch 56, cost -71.3617845459
Pre-training layer 0, epoch 57, cost -71.3523942871
Pre-training layer 0, epoch 58, cost -71.258074173
Pre-training layer 0, epoch 59, cost -71.2657633896
Pre-training layer 0, epoch 60, cost -71.0822187653
Pre-training layer 0, epoch 60, representative training free energy -230.77674205
Pre-training layer 0, epoch 60, validation free energy -216.334753029
Pre-training layer 0, epoch 61, cost -71.0716141663
Pre-training layer 0, epoch 62, cost -70.9790441742
Pre-training layer 0, epoch 63, cost -71.002272995
Pre-training layer 0, epoch 64, cost -70.8642343292
Pre-training layer 0, epoch 65, cost -70.7935608521
Pre-training layer 0, epoch 65, representative training free energy -224.204281616
Pre-training layer 0, epoch 65, validation free energy -208.791328781
Pre-training layer 0, epoch 66, cost -70.6961865311
Pre-training layer 0, epoch 67, cost -70.7033852539
Pre-training layer 0, epoch 68, cost -70.5989294662
Pre-training layer 0, epoch 69, cost -70.5460173798
Pre-training layer 0, epoch 70, cost -70.5203324127
Pre-training layer 0, epoch 70, representative training free energy -224.237775314
Pre-training layer 0, epoch 70, validation free energy -208.270020508
Pre-training layer 0, epoch 71, cost -70.4496976624
Pre-training layer 0, epoch 72, cost -70.363423378
Pre-training layer 0, epoch 73, cost -70.3469711075
Pre-training layer 0, epoch 74, cost -70.2783103027
Pre-training layer 0, epoch 75, cost -70.3103041306
Pre-training layer 0, epoch 75, representative training free energy -219.665591171
Pre-training layer 0, epoch 75, validation free energy -203.81252536
Pre-training layer 0, epoch 76, cost -70.2030332794
Pre-training layer 0, epoch 77, cost -70.0233267593
Pre-training layer 0, epoch 78, cost -70.0805558701
Pre-training layer 0, epoch 79, cost -69.9865075073
Pre-training layer 0, epoch 80, cost -69.8989337921
Pre-training layer 0, epoch 80, representative training free energy -218.216378189
Pre-training layer 0, epoch 80, validation free energy -201.893150131
Pre-training layer 0, epoch 81, cost -69.9050212936
Pre-training layer 0, epoch 82, cost -69.9442427521
Pre-training layer 0, epoch 83, cost -69.771305809
Pre-training layer 0, epoch 84, cost -69.7153067551
Pre-training layer 0, epoch 85, cost -69.7031094284
Pre-training layer 0, epoch 85, representative training free energy -211.646668915
Pre-training layer 0, epoch 85, validation free energy -195.378718208
Pre-training layer 0, epoch 86, cost -69.6879816589
Pre-training layer 0, epoch 87, cost -69.6278869934
Pre-training layer 0, epoch 88, cost -69.5711394806
Pre-training layer 0, epoch 89, cost -69.560575264
Pre-training layer 0, epoch 90, cost -69.5822546844
Pre-training layer 0, epoch 90, representative training free energy -212.119314255
Pre-training layer 0, epoch 90, validation free energy -195.222785477
Pre-training layer 0, epoch 91, cost -69.4736807556
Pre-training layer 0, epoch 92, cost -69.3619633408
Pre-training layer 0, epoch 93, cost -69.4112547684
Pre-training layer 0, epoch 94, cost -69.3183510895
Pre-training layer 0, epoch 95, cost -69.2818604507
Pre-training layer 0, epoch 95, representative training free energy -205.345321304
Pre-training layer 0, epoch 95, validation free energy -189.314186623
Pre-training layer 0, epoch 96, cost -69.3157284317
Pre-training layer 0, epoch 97, cost -69.3445012894
Pre-training layer 0, epoch 98, cost -69.1087756424
Pre-training layer 0, epoch 99, cost -69.1556187668
Pre-training layer 1, epoch 0, cost -109.189751724
Pre-training layer 1, epoch 0, representative training free energy -326274.739898
Pre-training layer 1, epoch 0, validation free energy -324348.222742
Pre-training layer 1, epoch 1, cost -84.9141256714
Pre-training layer 1, epoch 2, cost -78.9064141312
Pre-training layer 1, epoch 3, cost -75.5637639771
Pre-training layer 1, epoch 4, cost -73.429121048
Pre-training layer 1, epoch 5, cost -71.7274586029
Pre-training layer 1, epoch 5, representative training free energy -437112.102281
Pre-training layer 1, epoch 5, validation free energy -433922.95325
Pre-training layer 1, epoch 6, cost -70.3198081894
Pre-training layer 1, epoch 7, cost -69.3184732971
Pre-training layer 1, epoch 8, cost -68.4177100525
Pre-training layer 1, epoch 9, cost -67.6761014328
Pre-training layer 1, epoch 10, cost -66.9821964188
Pre-training layer 1, epoch 10, representative training free energy -489256.693734
Pre-training layer 1, epoch 10, validation free energy -485890.006672
Pre-training layer 1, epoch 11, cost -66.4420624542
Pre-training layer 1, epoch 12, cost -65.9239641724
Pre-training layer 1, epoch 13, cost -65.4286796265
Pre-training layer 1, epoch 14, cost -64.9645717163
Pre-training layer 1, epoch 15, cost -64.6469801407
Pre-training layer 1, epoch 15, representative training free energy -525002.853859
Pre-training layer 1, epoch 15, validation free energy -521357.980062
Pre-training layer 1, epoch 16, cost -64.2782799835
Pre-training layer 1, epoch 17, cost -63.9943852844
Pre-training layer 1, epoch 18, cost -63.7138244705
Pre-training layer 1, epoch 19, cost -63.5160461884
Pre-training layer 1, epoch 20, cost -63.2302241592
Pre-training layer 1, epoch 20, representative training free energy -552568.829297
Pre-training layer 1, epoch 20, validation free energy -548668.699063
Pre-training layer 1, epoch 21, cost -63.0117994995
Pre-training layer 1, epoch 22, cost -62.750202095
Pre-training layer 1, epoch 23, cost -62.4766848145
Pre-training layer 1, epoch 24, cost -62.3138822937
Pre-training layer 1, epoch 25, cost -62.0905413284
Pre-training layer 1, epoch 25, representative training free energy -576327.253766
Pre-training layer 1, epoch 25, validation free energy -572253.341953
Pre-training layer 1, epoch 26, cost -61.9374738998
Pre-training layer 1, epoch 27, cost -61.828559639
Pre-training layer 1, epoch 28, cost -61.6489247894
Pre-training layer 1, epoch 29, cost -61.4346168289
Pre-training layer 1, epoch 30, cost -61.3575848694
Pre-training layer 1, epoch 30, representative training free energy -594665.733359
Pre-training layer 1, epoch 30, validation free energy -590408.231234
Pre-training layer 1, epoch 31, cost -61.2141064606
Pre-training layer 1, epoch 32, cost -61.0940525055
Pre-training layer 1, epoch 33, cost -60.957416954
Pre-training layer 1, epoch 34, cost -60.8101168518
Pre-training layer 1, epoch 35, cost -60.7269563599
Pre-training layer 1, epoch 35, representative training free energy -612548.416734
Pre-training layer 1, epoch 35, validation free energy -608051.986172
Pre-training layer 1, epoch 36, cost -60.6200825119
Pre-training layer 1, epoch 37, cost -60.5112752686
Pre-training layer 1, epoch 38, cost -60.3969202576
Pre-training layer 1, epoch 39, cost -60.2851193161
Pre-training layer 1, epoch 40, cost -60.1176381149
Pre-training layer 1, epoch 40, representative training free energy -627735.428125
Pre-training layer 1, epoch 40, validation free energy -623161.330375
Pre-training layer 1, epoch 41, cost -60.0812256622
Pre-training layer 1, epoch 42, cost -60.0105764236
Pre-training layer 1, epoch 43, cost -59.9205935745
Pre-training layer 1, epoch 44, cost -59.8337554855
Pre-training layer 1, epoch 45, cost -59.7289577484
Pre-training layer 1, epoch 45, representative training free energy -641985.709844
Pre-training layer 1, epoch 45, validation free energy -637271.755328
Pre-training layer 1, epoch 46, cost -59.7099568939
Pre-training layer 1, epoch 47, cost -59.6283498611
Pre-training layer 1, epoch 48, cost -59.5774572296
Pre-training layer 1, epoch 49, cost -59.4562789307
Pre-training layer 1, epoch 50, cost -59.4381508331
Pre-training layer 1, epoch 50, representative training free energy -653642.028953
Pre-training layer 1, epoch 50, validation free energy -648758.782547
Pre-training layer 1, epoch 51, cost -59.3176453743
Pre-training layer 1, epoch 52, cost -59.2726980438
Pre-training layer 1, epoch 53, cost -59.2446016083
Pre-training layer 1, epoch 54, cost -59.1627015228
Pre-training layer 1, epoch 55, cost -59.1053843002
Pre-training layer 1, epoch 55, representative training free energy -665033.7675
Pre-training layer 1, epoch 55, validation free energy -660142.289828
Pre-training layer 1, epoch 56, cost -59.1250434494
Pre-training layer 1, epoch 57, cost -59.0543722458
Pre-training layer 1, epoch 58, cost -58.9492577324
Pre-training layer 1, epoch 59, cost -58.9368608856
Pre-training layer 1, epoch 60, cost -58.8814244461
Pre-training layer 1, epoch 60, representative training free energy -675591.536062
Pre-training layer 1, epoch 60, validation free energy -670513.06725
Pre-training layer 1, epoch 61, cost -58.8363273468
Pre-training layer 1, epoch 62, cost -58.6662307587
Pre-training layer 1, epoch 63, cost -58.7207995377
Pre-training layer 1, epoch 64, cost -58.6820353165
Pre-training layer 1, epoch 65, cost -58.6710447083
Pre-training layer 1, epoch 65, representative training free energy -685569.942641
Pre-training layer 1, epoch 65, validation free energy -680396.208734
Pre-training layer 1, epoch 66, cost -58.5686974068
Pre-training layer 1, epoch 67, cost -58.4947493134
Pre-training layer 1, epoch 68, cost -58.5190115776
Pre-training layer 1, epoch 69, cost -58.4085197563
Pre-training layer 1, epoch 70, cost -58.3517362976
Pre-training layer 1, epoch 70, representative training free energy -694996.234578
Pre-training layer 1, epoch 70, validation free energy -689722.360734
Pre-training layer 1, epoch 71, cost -58.3232646408
Pre-training layer 1, epoch 72, cost -58.2952525177
Pre-training layer 1, epoch 73, cost -58.2655058708
Pre-training layer 1, epoch 74, cost -58.1704268532
Pre-training layer 1, epoch 75, cost -58.2109075737
Pre-training layer 1, epoch 75, representative training free energy -702853.564141
Pre-training layer 1, epoch 75, validation free energy -697609.276156
Pre-training layer 1, epoch 76, cost -58.1531524734
Pre-training layer 1, epoch 77, cost -58.018718895
Pre-training layer 1, epoch 78, cost -58.0975033951
Pre-training layer 1, epoch 79, cost -58.0797367401
Pre-training layer 1, epoch 80, cost -58.0302911911
Pre-training layer 1, epoch 80, representative training free energy -711321.264562
Pre-training layer 1, epoch 80, validation free energy -705912.415156
Pre-training layer 1, epoch 81, cost -58.0546427078
Pre-training layer 1, epoch 82, cost -57.9109825096
Pre-training layer 1, epoch 83, cost -57.9262197037
Pre-training layer 1, epoch 84, cost -57.8997616615
Pre-training layer 1, epoch 85, cost -57.8439947014
Pre-training layer 1, epoch 85, representative training free energy -719764.075516
Pre-training layer 1, epoch 85, validation free energy -714405.281656
Pre-training layer 1, epoch 86, cost -57.7744153671
Pre-training layer 1, epoch 87, cost -57.7326109505
Pre-training layer 1, epoch 88, cost -57.8728461037
Pre-training layer 1, epoch 89, cost -57.7477291412
Pre-training layer 1, epoch 90, cost -57.6722361984
Pre-training layer 1, epoch 90, representative training free energy -726511.459625
Pre-training layer 1, epoch 90, validation free energy -721048.100484
Pre-training layer 1, epoch 91, cost -57.6926636696
Pre-training layer 1, epoch 92, cost -57.6340246544
Pre-training layer 1, epoch 93, cost -57.560677124
Pre-training layer 1, epoch 94, cost -57.6278621292
Pre-training layer 1, epoch 95, cost -57.6003228188
Pre-training layer 1, epoch 95, representative training free energy -733437.680797
Pre-training layer 1, epoch 95, validation free energy -727890.517562
Pre-training layer 1, epoch 96, cost -57.5802550468
Pre-training layer 1, epoch 97, cost -57.523434391
Pre-training layer 1, epoch 98, cost -57.562614212
Pre-training layer 1, epoch 99, cost -57.4392790146
Pre-training layer 2, epoch 0, cost -93.0218837128
Pre-training layer 2, epoch 0, representative training free energy 43434.1805156
Pre-training layer 2, epoch 0, validation free energy 42913.8491641
Pre-training layer 2, epoch 1, cost -69.3271638031
Pre-training layer 2, epoch 2, cost -64.3037200241
Pre-training layer 2, epoch 3, cost -61.5251518021
Pre-training layer 2, epoch 4, cost -59.9165679245
Pre-training layer 2, epoch 5, cost -58.6642028122
Pre-training layer 2, epoch 5, representative training free energy 150576.902914
Pre-training layer 2, epoch 5, validation free energy 149354.034039
Pre-training layer 2, epoch 6, cost -57.6577694778
Pre-training layer 2, epoch 7, cost -56.9397408752
Pre-training layer 2, epoch 8, cost -56.2162858276
Pre-training layer 2, epoch 9, cost -55.7551180267
Pre-training layer 2, epoch 10, cost -55.1737896423
Pre-training layer 2, epoch 10, representative training free energy 199334.649563
Pre-training layer 2, epoch 10, validation free energy 197890.774812
Pre-training layer 2, epoch 11, cost -54.7844231186
Pre-training layer 2, epoch 12, cost -54.443102623
Pre-training layer 2, epoch 13, cost -54.1139409943
Pre-training layer 2, epoch 14, cost -53.8076799088
Pre-training layer 2, epoch 15, cost -53.582715889
Pre-training layer 2, epoch 15, representative training free energy 230613.380492
Pre-training layer 2, epoch 15, validation free energy 229024.096227
Pre-training layer 2, epoch 16, cost -53.3618288574
Pre-training layer 2, epoch 17, cost -53.0796439819
Pre-training layer 2, epoch 18, cost -52.9275254974
Pre-training layer 2, epoch 19, cost -52.7008881531
Pre-training layer 2, epoch 20, cost -52.4846345596
Pre-training layer 2, epoch 20, representative training free energy 253607.207562
Pre-training layer 2, epoch 20, validation free energy 251881.396125
Pre-training layer 2, epoch 21, cost -52.4142931061
Pre-training layer 2, epoch 22, cost -52.2203178558
Pre-training layer 2, epoch 23, cost -52.0599079819
Pre-training layer 2, epoch 24, cost -51.9055324936
Pre-training layer 2, epoch 25, cost -51.7795229416
Pre-training layer 2, epoch 25, representative training free energy 269833.471773
Pre-training layer 2, epoch 25, validation free energy 268044.228695
Pre-training layer 2, epoch 26, cost -51.668284729
Pre-training layer 2, epoch 27, cost -51.5808748245
Pre-training layer 2, epoch 28, cost -51.4462410812
Pre-training layer 2, epoch 29, cost -51.3585423355
Pre-training layer 2, epoch 30, cost -51.24934729
Pre-training layer 2, epoch 30, representative training free energy 283494.140797
Pre-training layer 2, epoch 30, validation free energy 281666.019812
Pre-training layer 2, epoch 31, cost -51.1790529556
Pre-training layer 2, epoch 32, cost -51.0370661316
Pre-training layer 2, epoch 33, cost -50.9671406021
Pre-training layer 2, epoch 34, cost -50.9366483231
Pre-training layer 2, epoch 35, cost -50.7620311508
Pre-training layer 2, epoch 35, representative training free energy 294649.546094
Pre-training layer 2, epoch 35, validation free energy 292748.417562
Pre-training layer 2, epoch 36, cost -50.7319621887
Pre-training layer 2, epoch 37, cost -50.6386919937
Pre-training layer 2, epoch 38, cost -50.5295691071
Pre-training layer 2, epoch 39, cost -50.5114458694
Pre-training layer 2, epoch 40, cost -50.477898735
Pre-training layer 2, epoch 40, representative training free energy 305012.125758
Pre-training layer 2, epoch 40, validation free energy 303086.443172
Pre-training layer 2, epoch 41, cost -50.392884346
Pre-training layer 2, epoch 42, cost -50.3062167435
Pre-training layer 2, epoch 43, cost -50.2432756271
Pre-training layer 2, epoch 44, cost -50.1409031982
Pre-training layer 2, epoch 45, cost -50.069908844
Pre-training layer 2, epoch 45, representative training free energy 312165.890664
Pre-training layer 2, epoch 45, validation free energy 310166.661516
Pre-training layer 2, epoch 46, cost -50.0108751831
Pre-training layer 2, epoch 47, cost -49.9387893982
Pre-training layer 2, epoch 48, cost -49.9484626083
Pre-training layer 2, epoch 49, cost -49.8781968689
Pre-training layer 2, epoch 50, cost -49.8621684494
Pre-training layer 2, epoch 50, representative training free energy 318601.077414
Pre-training layer 2, epoch 50, validation free energy 316631.675289
Pre-training layer 2, epoch 51, cost -49.8065692062
Pre-training layer 2, epoch 52, cost -49.733376709
Pre-training layer 2, epoch 53, cost -49.6592763824
Pre-training layer 2, epoch 54, cost -49.6860925446
Pre-training layer 2, epoch 55, cost -49.5603909073
Pre-training layer 2, epoch 55, representative training free energy 324500.046344
Pre-training layer 2, epoch 55, validation free energy 322430.107766
Pre-training layer 2, epoch 56, cost -49.6234437332
Pre-training layer 2, epoch 57, cost -49.614320488
Pre-training layer 2, epoch 58, cost -49.4624072342
Pre-training layer 2, epoch 59, cost -49.4659851532
Pre-training layer 2, epoch 60, cost -49.3720339432
Pre-training layer 2, epoch 60, representative training free energy 331306.358859
Pre-training layer 2, epoch 60, validation free energy 329238.831867
Pre-training layer 2, epoch 61, cost -49.3962802963
Pre-training layer 2, epoch 62, cost -49.2751414261
Pre-training layer 2, epoch 63, cost -49.2161571274
Pre-training layer 2, epoch 64, cost -49.2608219986
Pre-training layer 2, epoch 65, cost -49.1658745651
Pre-training layer 2, epoch 65, representative training free energy 335461.687508
Pre-training layer 2, epoch 65, validation free energy 333390.866422
Pre-training layer 2, epoch 66, cost -49.148295372
Pre-training layer 2, epoch 67, cost -49.0725227814
Pre-training layer 2, epoch 68, cost -49.1145895233
Pre-training layer 2, epoch 69, cost -49.0689213409
Pre-training layer 2, epoch 70, cost -49.0889371033
Pre-training layer 2, epoch 70, representative training free energy 341203.789953
Pre-training layer 2, epoch 70, validation free energy 339053.423906
Pre-training layer 2, epoch 71, cost -49.0992122345
Pre-training layer 2, epoch 72, cost -48.9674528427
Pre-training layer 2, epoch 73, cost -49.0271892929
Pre-training layer 2, epoch 74, cost -48.9481558762
Pre-training layer 2, epoch 75, cost -48.8997560196
Pre-training layer 2, epoch 75, representative training free energy 344780.596352
Pre-training layer 2, epoch 75, validation free energy 342628.344953
Pre-training layer 2, epoch 76, cost -48.8768574142
Pre-training layer 2, epoch 77, cost -48.8535228806
Pre-training layer 2, epoch 78, cost -48.79524543
Pre-training layer 2, epoch 79, cost -48.7875427933
Pre-training layer 2, epoch 80, cost -48.7979850388
Pre-training layer 2, epoch 80, representative training free energy 348048.210469
Pre-training layer 2, epoch 80, validation free energy 345833.498359
Pre-training layer 2, epoch 81, cost -48.7458738937
Pre-training layer 2, epoch 82, cost -48.7852670441
Pre-training layer 2, epoch 83, cost -48.6796268082
Pre-training layer 2, epoch 84, cost -48.6380147629
Pre-training layer 2, epoch 85, cost -48.6236309509
Pre-training layer 2, epoch 85, representative training free energy 350166.224906
Pre-training layer 2, epoch 85, validation free energy 347971.635125
Pre-training layer 2, epoch 86, cost -48.6284404144
Pre-training layer 2, epoch 87, cost -48.542083622
Pre-training layer 2, epoch 88, cost -48.5497942009
Pre-training layer 2, epoch 89, cost -48.5473560944
Pre-training layer 2, epoch 90, cost -48.5112704773
Pre-training layer 2, epoch 90, representative training free energy 354173.50082
Pre-training layer 2, epoch 90, validation free energy 352021.067406
Pre-training layer 2, epoch 91, cost -48.468188179
Pre-training layer 2, epoch 92, cost -48.5076872177
Pre-training layer 2, epoch 93, cost -48.4528034363
Pre-training layer 2, epoch 94, cost -48.4241216507
Pre-training layer 2, epoch 95, cost -48.4227453232
Pre-training layer 2, epoch 95, representative training free energy 355980.316617
Pre-training layer 2, epoch 95, validation free energy 353801.047688
Pre-training layer 2, epoch 96, cost -48.3929143181
Pre-training layer 2, epoch 97, cost -48.3896434479
Pre-training layer 2, epoch 98, cost -48.3350492706
Pre-training layer 2, epoch 99, cost -48.319862381
The pretraining code for file dbn_loop.pyc ran for 4.74m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.700000 %
     epoch 1, minibatch 500/500, test error of best model 11.800000 %
epoch 2, minibatch 500/500, validation error 9.800000 %
     epoch 2, minibatch 500/500, test error of best model 8.700000 %
epoch 3, minibatch 500/500, validation error 7.600000 %
     epoch 3, minibatch 500/500, test error of best model 7.300000 %
epoch 4, minibatch 500/500, validation error 7.100000 %
     epoch 4, minibatch 500/500, test error of best model 6.900000 %
epoch 5, minibatch 500/500, validation error 6.200000 %
     epoch 5, minibatch 500/500, test error of best model 6.700000 %
epoch 6, minibatch 500/500, validation error 6.000000 %
     epoch 6, minibatch 500/500, test error of best model 5.600000 %
epoch 7, minibatch 500/500, validation error 5.900000 %
     epoch 7, minibatch 500/500, test error of best model 5.500000 %
epoch 8, minibatch 500/500, validation error 5.800000 %
     epoch 8, minibatch 500/500, test error of best model 5.200000 %
epoch 9, minibatch 500/500, validation error 5.700000 %
     epoch 9, minibatch 500/500, test error of best model 5.000000 %
epoch 10, minibatch 500/500, validation error 5.400000 %
     epoch 10, minibatch 500/500, test error of best model 5.100000 %
epoch 11, minibatch 500/500, validation error 5.300000 %
     epoch 11, minibatch 500/500, test error of best model 5.100000 %
epoch 12, minibatch 500/500, validation error 5.300000 %
epoch 13, minibatch 500/500, validation error 5.300000 %
epoch 14, minibatch 500/500, validation error 5.200000 %
     epoch 14, minibatch 500/500, test error of best model 4.900000 %
epoch 15, minibatch 500/500, validation error 5.100000 %
     epoch 15, minibatch 500/500, test error of best model 4.700000 %
epoch 16, minibatch 500/500, validation error 5.000000 %
     epoch 16, minibatch 500/500, test error of best model 4.800000 %
epoch 17, minibatch 500/500, validation error 4.900000 %
     epoch 17, minibatch 500/500, test error of best model 4.800000 %
epoch 18, minibatch 500/500, validation error 5.000000 %
epoch 19, minibatch 500/500, validation error 5.000000 %
epoch 20, minibatch 500/500, validation error 5.000000 %
epoch 21, minibatch 500/500, validation error 4.900000 %
epoch 22, minibatch 500/500, validation error 4.900000 %
epoch 23, minibatch 500/500, validation error 4.900000 %
epoch 24, minibatch 500/500, validation error 4.800000 %
     epoch 24, minibatch 500/500, test error of best model 5.000000 %
epoch 25, minibatch 500/500, validation error 4.800000 %
epoch 26, minibatch 500/500, validation error 4.800000 %
epoch 27, minibatch 500/500, validation error 4.800000 %
epoch 28, minibatch 500/500, validation error 4.800000 %
epoch 29, minibatch 500/500, validation error 4.700000 %
     epoch 29, minibatch 500/500, test error of best model 4.800000 %
epoch 30, minibatch 500/500, validation error 4.700000 %
epoch 31, minibatch 500/500, validation error 4.700000 %
epoch 32, minibatch 500/500, validation error 4.700000 %
epoch 33, minibatch 500/500, validation error 4.700000 %
epoch 34, minibatch 500/500, validation error 4.700000 %
epoch 35, minibatch 500/500, validation error 4.600000 %
     epoch 35, minibatch 500/500, test error of best model 4.800000 %
epoch 36, minibatch 500/500, validation error 4.600000 %
epoch 37, minibatch 500/500, validation error 4.700000 %
epoch 38, minibatch 500/500, validation error 4.700000 %
epoch 39, minibatch 500/500, validation error 4.700000 %
epoch 40, minibatch 500/500, validation error 4.700000 %
epoch 41, minibatch 500/500, validation error 4.700000 %
epoch 42, minibatch 500/500, validation error 4.700000 %
epoch 43, minibatch 500/500, validation error 4.800000 %
epoch 44, minibatch 500/500, validation error 4.800000 %
epoch 45, minibatch 500/500, validation error 4.800000 %
epoch 46, minibatch 500/500, validation error 4.800000 %
epoch 47, minibatch 500/500, validation error 4.800000 %
epoch 48, minibatch 500/500, validation error 4.800000 %
epoch 49, minibatch 500/500, validation error 4.800000 %
epoch 50, minibatch 500/500, validation error 4.800000 %
epoch 51, minibatch 500/500, validation error 4.800000 %
epoch 52, minibatch 500/500, validation error 4.800000 %
epoch 53, minibatch 500/500, validation error 4.800000 %
epoch 54, minibatch 500/500, validation error 4.800000 %
epoch 55, minibatch 500/500, validation error 4.800000 %
epoch 56, minibatch 500/500, validation error 4.800000 %
epoch 57, minibatch 500/500, validation error 4.800000 %
epoch 58, minibatch 500/500, validation error 4.800000 %
epoch 59, minibatch 500/500, validation error 4.800000 %
epoch 60, minibatch 500/500, validation error 4.800000 %
epoch 61, minibatch 500/500, validation error 4.800000 %
epoch 62, minibatch 500/500, validation error 4.800000 %
epoch 63, minibatch 500/500, validation error 4.800000 %
epoch 64, minibatch 500/500, validation error 4.900000 %
epoch 65, minibatch 500/500, validation error 4.900000 %
epoch 66, minibatch 500/500, validation error 4.900000 %
epoch 67, minibatch 500/500, validation error 4.900000 %
epoch 68, minibatch 500/500, validation error 4.900000 %
epoch 69, minibatch 500/500, validation error 4.900000 %
Optimization complete with best validation score of 4.600000 %, obtained at iteration 17500, with test performance 4.800000 %
The fine tuning code for file dbn_loop.pyc ran for 1.44m


==========Sample Size: (5000, 1500, 1500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.860912018
Pre-training layer 0, epoch 0, representative training free energy -257.187422709
Pre-training layer 0, epoch 0, validation free energy -253.391437327
Pre-training layer 0, epoch 1, cost -95.5245005646
Pre-training layer 0, epoch 2, cost -90.217965271
Pre-training layer 0, epoch 3, cost -87.3263767166
Pre-training layer 0, epoch 4, cost -85.2308655396
Pre-training layer 0, epoch 5, cost -83.7254275513
Pre-training layer 0, epoch 5, representative training free energy -265.023499268
Pre-training layer 0, epoch 5, validation free energy -258.338904144
Pre-training layer 0, epoch 6, cost -82.6026915283
Pre-training layer 0, epoch 7, cost -81.6127059555
Pre-training layer 0, epoch 8, cost -80.7964921341
Pre-training layer 0, epoch 9, cost -80.1623425446
Pre-training layer 0, epoch 10, cost -79.548939743
Pre-training layer 0, epoch 10, representative training free energy -266.679231415
Pre-training layer 0, epoch 10, validation free energy -259.205857249
Pre-training layer 0, epoch 11, cost -79.0782017746
Pre-training layer 0, epoch 12, cost -78.536558342
Pre-training layer 0, epoch 13, cost -78.0180739975
Pre-training layer 0, epoch 14, cost -77.7740786743
Pre-training layer 0, epoch 15, cost -77.4070495987
Pre-training layer 0, epoch 15, representative training free energy -263.34191922
Pre-training layer 0, epoch 15, validation free energy -254.31046696
Pre-training layer 0, epoch 16, cost -77.1194666443
Pre-training layer 0, epoch 17, cost -76.8384410706
Pre-training layer 0, epoch 18, cost -76.5101838379
Pre-training layer 0, epoch 19, cost -76.1641779709
Pre-training layer 0, epoch 20, cost -76.0402741318
Pre-training layer 0, epoch 20, representative training free energy -263.241444153
Pre-training layer 0, epoch 20, validation free energy -253.629034505
Pre-training layer 0, epoch 21, cost -75.8273328323
Pre-training layer 0, epoch 22, cost -75.608117836
Pre-training layer 0, epoch 23, cost -75.2643687897
Pre-training layer 0, epoch 24, cost -75.2871707687
Pre-training layer 0, epoch 25, cost -74.9764375076
Pre-training layer 0, epoch 25, representative training free energy -262.248605275
Pre-training layer 0, epoch 25, validation free energy -251.1347435
Pre-training layer 0, epoch 26, cost -74.8538192444
Pre-training layer 0, epoch 27, cost -74.6654811401
Pre-training layer 0, epoch 28, cost -74.4838218536
Pre-training layer 0, epoch 29, cost -74.29454319
Pre-training layer 0, epoch 30, cost -74.1911136246
Pre-training layer 0, epoch 30, representative training free energy -252.159577799
Pre-training layer 0, epoch 30, validation free energy -240.757797409
Pre-training layer 0, epoch 31, cost -74.0249147797
Pre-training layer 0, epoch 32, cost -73.996193573
Pre-training layer 0, epoch 33, cost -73.8644680481
Pre-training layer 0, epoch 34, cost -73.7348643188
Pre-training layer 0, epoch 35, cost -73.553322525
Pre-training layer 0, epoch 35, representative training free energy -249.683637767
Pre-training layer 0, epoch 35, validation free energy -238.445024689
Pre-training layer 0, epoch 36, cost -73.5185585938
Pre-training layer 0, epoch 37, cost -73.3004750671
Pre-training layer 0, epoch 38, cost -73.2295617981
Pre-training layer 0, epoch 39, cost -73.0845108109
Pre-training layer 0, epoch 40, cost -73.0709382477
Pre-training layer 0, epoch 40, representative training free energy -253.045311462
Pre-training layer 0, epoch 40, validation free energy -240.622206248
Pre-training layer 0, epoch 41, cost -72.7912051163
Pre-training layer 0, epoch 42, cost -72.7563207016
Pre-training layer 0, epoch 43, cost -72.6501841202
Pre-training layer 0, epoch 44, cost -72.4253000183
Pre-training layer 0, epoch 45, cost -72.4406292801
Pre-training layer 0, epoch 45, representative training free energy -245.164781494
Pre-training layer 0, epoch 45, validation free energy -232.714124451
Pre-training layer 0, epoch 46, cost -72.4538525391
Pre-training layer 0, epoch 47, cost -72.2562201767
Pre-training layer 0, epoch 48, cost -72.2826695557
Pre-training layer 0, epoch 49, cost -72.1735695801
Pre-training layer 0, epoch 50, cost -71.9968058167
Pre-training layer 0, epoch 50, representative training free energy -238.830147675
Pre-training layer 0, epoch 50, validation free energy -225.72424733
Pre-training layer 0, epoch 51, cost -71.9794610138
Pre-training layer 0, epoch 52, cost -71.8964645615
Pre-training layer 0, epoch 53, cost -71.7904309082
Pre-training layer 0, epoch 54, cost -71.6857224045
Pre-training layer 0, epoch 55, cost -71.6528371658
Pre-training layer 0, epoch 55, representative training free energy -235.813786845
Pre-training layer 0, epoch 55, validation free energy -222.282254023
Pre-training layer 0, epoch 56, cost -71.4270363617
Pre-training layer 0, epoch 57, cost -71.4776207657
Pre-training layer 0, epoch 58, cost -71.4797029572
Pre-training layer 0, epoch 59, cost -71.2828762131
Pre-training layer 0, epoch 60, cost -71.3213179474
Pre-training layer 0, epoch 60, representative training free energy -230.678294708
Pre-training layer 0, epoch 60, validation free energy -216.574503677
Pre-training layer 0, epoch 61, cost -71.1919667206
Pre-training layer 0, epoch 62, cost -71.1785760498
Pre-training layer 0, epoch 63, cost -71.035206192
Pre-training layer 0, epoch 64, cost -71.0091672745
Pre-training layer 0, epoch 65, cost -71.0199293976
Pre-training layer 0, epoch 65, representative training free energy -230.533245005
Pre-training layer 0, epoch 65, validation free energy -215.36786467
Pre-training layer 0, epoch 66, cost -70.876060173
Pre-training layer 0, epoch 67, cost -70.8645562515
Pre-training layer 0, epoch 68, cost -70.7566078644
Pre-training layer 0, epoch 69, cost -70.6107129593
Pre-training layer 0, epoch 70, cost -70.6860772324
Pre-training layer 0, epoch 70, representative training free energy -224.455107442
Pre-training layer 0, epoch 70, validation free energy -209.668799184
Pre-training layer 0, epoch 71, cost -70.6011955109
Pre-training layer 0, epoch 72, cost -70.4489482346
Pre-training layer 0, epoch 73, cost -70.4563196259
Pre-training layer 0, epoch 74, cost -70.4114000092
Pre-training layer 0, epoch 75, cost -70.287378418
Pre-training layer 0, epoch 75, representative training free energy -221.731902171
Pre-training layer 0, epoch 75, validation free energy -207.103929454
Pre-training layer 0, epoch 76, cost -70.2425231781
Pre-training layer 0, epoch 77, cost -70.2482891159
Pre-training layer 0, epoch 78, cost -70.1663373718
Pre-training layer 0, epoch 79, cost -70.1759155197
Pre-training layer 0, epoch 80, cost -70.1714853592
Pre-training layer 0, epoch 80, representative training free energy -217.015971761
Pre-training layer 0, epoch 80, validation free energy -201.812636724
Pre-training layer 0, epoch 81, cost -70.167755043
Pre-training layer 0, epoch 82, cost -70.0010348663
Pre-training layer 0, epoch 83, cost -69.9506234131
Pre-training layer 0, epoch 84, cost -69.9536855927
Pre-training layer 0, epoch 85, cost -69.9091758575
Pre-training layer 0, epoch 85, representative training free energy -215.773126394
Pre-training layer 0, epoch 85, validation free energy -200.741744497
Pre-training layer 0, epoch 86, cost -69.7836272278
Pre-training layer 0, epoch 87, cost -69.7433806763
Pre-training layer 0, epoch 88, cost -69.7119545898
Pre-training layer 0, epoch 89, cost -69.5221794281
Pre-training layer 0, epoch 90, cost -69.5968058167
Pre-training layer 0, epoch 90, representative training free energy -211.791294525
Pre-training layer 0, epoch 90, validation free energy -197.186002116
Pre-training layer 0, epoch 91, cost -69.561525856
Pre-training layer 0, epoch 92, cost -69.5827501221
Pre-training layer 0, epoch 93, cost -69.5384685974
Pre-training layer 0, epoch 94, cost -69.4721567154
Pre-training layer 0, epoch 95, cost -69.3612119064
Pre-training layer 0, epoch 95, representative training free energy -204.693145467
Pre-training layer 0, epoch 95, validation free energy -189.430208776
Pre-training layer 0, epoch 96, cost -69.4105895309
Pre-training layer 0, epoch 97, cost -69.260199234
Pre-training layer 0, epoch 98, cost -69.3650183868
Pre-training layer 0, epoch 99, cost -69.3128254929
Pre-training layer 1, epoch 0, cost -110.712312462
Pre-training layer 1, epoch 0, representative training free energy -342197.441198
Pre-training layer 1, epoch 0, validation free energy -340850.755391
Pre-training layer 1, epoch 1, cost -86.2008510208
Pre-training layer 1, epoch 2, cost -80.3009622498
Pre-training layer 1, epoch 3, cost -76.9625545578
Pre-training layer 1, epoch 4, cost -74.5938594894
Pre-training layer 1, epoch 5, cost -73.0962620926
Pre-training layer 1, epoch 5, representative training free energy -455636.041031
Pre-training layer 1, epoch 5, validation free energy -453838.171542
Pre-training layer 1, epoch 6, cost -71.7668494492
Pre-training layer 1, epoch 7, cost -70.6936523895
Pre-training layer 1, epoch 8, cost -69.7607296829
Pre-training layer 1, epoch 9, cost -69.0304085083
Pre-training layer 1, epoch 10, cost -68.2896252899
Pre-training layer 1, epoch 10, representative training free energy -508821.436813
Pre-training layer 1, epoch 10, validation free energy -506855.036042
Pre-training layer 1, epoch 11, cost -67.7611453552
Pre-training layer 1, epoch 12, cost -67.2705705109
Pre-training layer 1, epoch 13, cost -66.8423444519
Pre-training layer 1, epoch 14, cost -66.3610450592
Pre-training layer 1, epoch 15, cost -66.0219876785
Pre-training layer 1, epoch 15, representative training free energy -546009.067563
Pre-training layer 1, epoch 15, validation free energy -543965.964719
Pre-training layer 1, epoch 16, cost -65.653594635
Pre-training layer 1, epoch 17, cost -65.3311898499
Pre-training layer 1, epoch 18, cost -64.9919225616
Pre-training layer 1, epoch 19, cost -64.7570074539
Pre-training layer 1, epoch 20, cost -64.4524301376
Pre-training layer 1, epoch 20, representative training free energy -573925.563906
Pre-training layer 1, epoch 20, validation free energy -571859.234094
Pre-training layer 1, epoch 21, cost -64.3018172836
Pre-training layer 1, epoch 22, cost -64.0009826202
Pre-training layer 1, epoch 23, cost -63.8782070541
Pre-training layer 1, epoch 24, cost -63.6813346863
Pre-training layer 1, epoch 25, cost -63.4512161789
Pre-training layer 1, epoch 25, representative training free energy -596741.426135
Pre-training layer 1, epoch 25, validation free energy -594564.005792
Pre-training layer 1, epoch 26, cost -63.3259005737
Pre-training layer 1, epoch 27, cost -63.074027092
Pre-training layer 1, epoch 28, cost -62.9508006134
Pre-training layer 1, epoch 29, cost -62.7313717041
Pre-training layer 1, epoch 30, cost -62.6913725815
Pre-training layer 1, epoch 30, representative training free energy -616799.169417
Pre-training layer 1, epoch 30, validation free energy -614645.471646
Pre-training layer 1, epoch 31, cost -62.5079135208
Pre-training layer 1, epoch 32, cost -62.3977311554
Pre-training layer 1, epoch 33, cost -62.2198024902
Pre-training layer 1, epoch 34, cost -62.0645351486
Pre-training layer 1, epoch 35, cost -61.9655585175
Pre-training layer 1, epoch 35, representative training free energy -634777.643604
Pre-training layer 1, epoch 35, validation free energy -632502.764385
Pre-training layer 1, epoch 36, cost -61.9562883835
Pre-training layer 1, epoch 37, cost -61.8757219925
Pre-training layer 1, epoch 38, cost -61.7724910202
Pre-training layer 1, epoch 39, cost -61.6305981827
Pre-training layer 1, epoch 40, cost -61.5255804138
Pre-training layer 1, epoch 40, representative training free energy -649715.827708
Pre-training layer 1, epoch 40, validation free energy -647455.399458
Pre-training layer 1, epoch 41, cost -61.3675855713
Pre-training layer 1, epoch 42, cost -61.2609506454
Pre-training layer 1, epoch 43, cost -61.2656296997
Pre-training layer 1, epoch 44, cost -61.1787305069
Pre-training layer 1, epoch 45, cost -61.077083313
Pre-training layer 1, epoch 45, representative training free energy -663946.427917
Pre-training layer 1, epoch 45, validation free energy -661690.934562
Pre-training layer 1, epoch 46, cost -60.944843441
Pre-training layer 1, epoch 47, cost -60.9629723434
Pre-training layer 1, epoch 48, cost -60.8416912613
Pre-training layer 1, epoch 49, cost -60.8824894867
Pre-training layer 1, epoch 50, cost -60.7173288727
Pre-training layer 1, epoch 50, representative training free energy -676083.264979
Pre-training layer 1, epoch 50, validation free energy -673773.248344
Pre-training layer 1, epoch 51, cost -60.686432354
Pre-training layer 1, epoch 52, cost -60.5806314621
Pre-training layer 1, epoch 53, cost -60.5293426743
Pre-training layer 1, epoch 54, cost -60.5331155586
Pre-training layer 1, epoch 55, cost -60.4645455704
Pre-training layer 1, epoch 55, representative training free energy -686748.487896
Pre-training layer 1, epoch 55, validation free energy -684411.724156
Pre-training layer 1, epoch 56, cost -60.3436806488
Pre-training layer 1, epoch 57, cost -60.365193924
Pre-training layer 1, epoch 58, cost -60.2327617645
Pre-training layer 1, epoch 59, cost -60.1671709137
Pre-training layer 1, epoch 60, cost -60.1199392242
Pre-training layer 1, epoch 60, representative training free energy -697768.880948
Pre-training layer 1, epoch 60, validation free energy -695406.971292
Pre-training layer 1, epoch 61, cost -60.0799534149
Pre-training layer 1, epoch 62, cost -60.0352538605
Pre-training layer 1, epoch 63, cost -59.9565408859
Pre-training layer 1, epoch 64, cost -59.95685252
Pre-training layer 1, epoch 65, cost -59.8685650482
Pre-training layer 1, epoch 65, representative training free energy -708616.689
Pre-training layer 1, epoch 65, validation free energy -706215.095958
Pre-training layer 1, epoch 66, cost -59.8148305664
Pre-training layer 1, epoch 67, cost -59.8035325012
Pre-training layer 1, epoch 68, cost -59.7933690796
Pre-training layer 1, epoch 69, cost -59.7789328308
Pre-training layer 1, epoch 70, cost -59.6912936935
Pre-training layer 1, epoch 70, representative training free energy -717417.251615
Pre-training layer 1, epoch 70, validation free energy -715061.140073
Pre-training layer 1, epoch 71, cost -59.683350174
Pre-training layer 1, epoch 72, cost -59.6403502121
Pre-training layer 1, epoch 73, cost -59.5822530632
Pre-training layer 1, epoch 74, cost -59.5141788483
Pre-training layer 1, epoch 75, cost -59.4952846985
Pre-training layer 1, epoch 75, representative training free energy -725559.341521
Pre-training layer 1, epoch 75, validation free energy -723119.927
Pre-training layer 1, epoch 76, cost -59.4374169197
Pre-training layer 1, epoch 77, cost -59.462897625
Pre-training layer 1, epoch 78, cost -59.3714835205
Pre-training layer 1, epoch 79, cost -59.4281562996
Pre-training layer 1, epoch 80, cost -59.3386142502
Pre-training layer 1, epoch 80, representative training free energy -734390.050625
Pre-training layer 1, epoch 80, validation free energy -731949.745708
Pre-training layer 1, epoch 81, cost -59.261724205
Pre-training layer 1, epoch 82, cost -59.2491548767
Pre-training layer 1, epoch 83, cost -59.191406456
Pre-training layer 1, epoch 84, cost -59.216214489
Pre-training layer 1, epoch 85, cost -59.2260717506
Pre-training layer 1, epoch 85, representative training free energy -741790.327833
Pre-training layer 1, epoch 85, validation free energy -739334.871469
Pre-training layer 1, epoch 86, cost -59.1898675499
Pre-training layer 1, epoch 87, cost -59.1613147545
Pre-training layer 1, epoch 88, cost -59.0629473572
Pre-training layer 1, epoch 89, cost -59.1639104614
Pre-training layer 1, epoch 90, cost -59.1085457573
Pre-training layer 1, epoch 90, representative training free energy -749706.124687
Pre-training layer 1, epoch 90, validation free energy -747319.502302
Pre-training layer 1, epoch 91, cost -59.0300736542
Pre-training layer 1, epoch 92, cost -58.9694420891
Pre-training layer 1, epoch 93, cost -58.9713021545
Pre-training layer 1, epoch 94, cost -58.9780312614
Pre-training layer 1, epoch 95, cost -58.879677063
Pre-training layer 1, epoch 95, representative training free energy -756492.928417
Pre-training layer 1, epoch 95, validation free energy -754043.173021
Pre-training layer 1, epoch 96, cost -58.8739505653
Pre-training layer 1, epoch 97, cost -58.8592926483
Pre-training layer 1, epoch 98, cost -58.8565041428
Pre-training layer 1, epoch 99, cost -58.8311284218
Pre-training layer 2, epoch 0, cost -91.7953438263
Pre-training layer 2, epoch 0, representative training free energy 38542.2478678
Pre-training layer 2, epoch 0, validation free energy 38477.4227637
Pre-training layer 2, epoch 1, cost -68.3460152664
Pre-training layer 2, epoch 2, cost -63.313582489
Pre-training layer 2, epoch 3, cost -60.7695000153
Pre-training layer 2, epoch 4, cost -59.0641765442
Pre-training layer 2, epoch 5, cost -57.8287581329
Pre-training layer 2, epoch 5, representative training free energy 149448.448057
Pre-training layer 2, epoch 5, validation free energy 149318.526107
Pre-training layer 2, epoch 6, cost -56.9010032272
Pre-training layer 2, epoch 7, cost -56.1069342728
Pre-training layer 2, epoch 8, cost -55.4698210831
Pre-training layer 2, epoch 9, cost -55.0034632492
Pre-training layer 2, epoch 10, cost -54.4872823639
Pre-training layer 2, epoch 10, representative training free energy 202450.705359
Pre-training layer 2, epoch 10, validation free energy 202325.917263
Pre-training layer 2, epoch 11, cost -54.1006197205
Pre-training layer 2, epoch 12, cost -53.7625430222
Pre-training layer 2, epoch 13, cost -53.4950907974
Pre-training layer 2, epoch 14, cost -53.0957686691
Pre-training layer 2, epoch 15, cost -52.8926110077
Pre-training layer 2, epoch 15, representative training free energy 237097.25238
Pre-training layer 2, epoch 15, validation free energy 237037.831073
Pre-training layer 2, epoch 16, cost -52.6667132263
Pre-training layer 2, epoch 17, cost -52.4055830612
Pre-training layer 2, epoch 18, cost -52.2044732285
Pre-training layer 2, epoch 19, cost -52.0341550751
Pre-training layer 2, epoch 20, cost -51.7502811203
Pre-training layer 2, epoch 20, representative training free energy 260415.510281
Pre-training layer 2, epoch 20, validation free energy 260418.242724
Pre-training layer 2, epoch 21, cost -51.6914524689
Pre-training layer 2, epoch 22, cost -51.5021891632
Pre-training layer 2, epoch 23, cost -51.3704518356
Pre-training layer 2, epoch 24, cost -51.1782765503
Pre-training layer 2, epoch 25, cost -51.1049731827
Pre-training layer 2, epoch 25, representative training free energy 278770.70438
Pre-training layer 2, epoch 25, validation free energy 278815.13574
Pre-training layer 2, epoch 26, cost -50.9851742477
Pre-training layer 2, epoch 27, cost -50.9067234421
Pre-training layer 2, epoch 28, cost -50.7419279251
Pre-training layer 2, epoch 29, cost -50.6401560059
Pre-training layer 2, epoch 30, cost -50.4778577423
Pre-training layer 2, epoch 30, representative training free energy 295008.910344
Pre-training layer 2, epoch 30, validation free energy 295087.958573
Pre-training layer 2, epoch 31, cost -50.4840416641
Pre-training layer 2, epoch 32, cost -50.3218389664
Pre-training layer 2, epoch 33, cost -50.2261933136
Pre-training layer 2, epoch 34, cost -50.1230776901
Pre-training layer 2, epoch 35, cost -50.0150084457
Pre-training layer 2, epoch 35, representative training free energy 306862.548047
Pre-training layer 2, epoch 35, validation free energy 306965.26813
Pre-training layer 2, epoch 36, cost -49.9827811737
Pre-training layer 2, epoch 37, cost -49.9907476501
Pre-training layer 2, epoch 38, cost -49.8635958862
Pre-training layer 2, epoch 39, cost -49.7937331238
Pre-training layer 2, epoch 40, cost -49.7105210495
Pre-training layer 2, epoch 40, representative training free energy 316619.299495
Pre-training layer 2, epoch 40, validation free energy 316716.193682
Pre-training layer 2, epoch 41, cost -49.6543748856
Pre-training layer 2, epoch 42, cost -49.5721119003
Pre-training layer 2, epoch 43, cost -49.4720143967
Pre-training layer 2, epoch 44, cost -49.4691136246
Pre-training layer 2, epoch 45, cost -49.4361409988
Pre-training layer 2, epoch 45, representative training free energy 326588.785943
Pre-training layer 2, epoch 45, validation free energy 326750.968422
Pre-training layer 2, epoch 46, cost -49.4151573105
Pre-training layer 2, epoch 47, cost -49.2820251541
Pre-training layer 2, epoch 48, cost -49.1889882965
Pre-training layer 2, epoch 49, cost -49.1508259354
Pre-training layer 2, epoch 50, cost -49.1703629761
Pre-training layer 2, epoch 50, representative training free energy 333437.886708
Pre-training layer 2, epoch 50, validation free energy 333561.734177
Pre-training layer 2, epoch 51, cost -49.0795500717
Pre-training layer 2, epoch 52, cost -49.0120416718
Pre-training layer 2, epoch 53, cost -48.9779308014
Pre-training layer 2, epoch 54, cost -48.8993533325
Pre-training layer 2, epoch 55, cost -48.8836125031
Pre-training layer 2, epoch 55, representative training free energy 340335.953563
Pre-training layer 2, epoch 55, validation free energy 340519.92162
Pre-training layer 2, epoch 56, cost -48.8615294876
Pre-training layer 2, epoch 57, cost -48.7760575638
Pre-training layer 2, epoch 58, cost -48.7671080284
Pre-training layer 2, epoch 59, cost -48.7242918549
Pre-training layer 2, epoch 60, cost -48.7381386337
Pre-training layer 2, epoch 60, representative training free energy 347281.679922
Pre-training layer 2, epoch 60, validation free energy 347471.171281
Pre-training layer 2, epoch 61, cost -48.6772641373
Pre-training layer 2, epoch 62, cost -48.5937366791
Pre-training layer 2, epoch 63, cost -48.5512938538
Pre-training layer 2, epoch 64, cost -48.5510128937
Pre-training layer 2, epoch 65, cost -48.5223796234
Pre-training layer 2, epoch 65, representative training free energy 353996.586474
Pre-training layer 2, epoch 65, validation free energy 354181.748724
Pre-training layer 2, epoch 66, cost -48.4932756577
Pre-training layer 2, epoch 67, cost -48.4637484818
Pre-training layer 2, epoch 68, cost -48.3512286911
Pre-training layer 2, epoch 69, cost -48.322395813
Pre-training layer 2, epoch 70, cost -48.4280808792
Pre-training layer 2, epoch 70, representative training free energy 357938.80913
Pre-training layer 2, epoch 70, validation free energy 358184.506672
Pre-training layer 2, epoch 71, cost -48.3160115585
Pre-training layer 2, epoch 72, cost -48.2944970398
Pre-training layer 2, epoch 73, cost -48.2271219177
Pre-training layer 2, epoch 74, cost -48.2207009354
Pre-training layer 2, epoch 75, cost -48.1551257019
Pre-training layer 2, epoch 75, representative training free energy 362950.866271
Pre-training layer 2, epoch 75, validation free energy 363157.299729
Pre-training layer 2, epoch 76, cost -48.1594525146
Pre-training layer 2, epoch 77, cost -48.0999159927
Pre-training layer 2, epoch 78, cost -48.049830864
Pre-training layer 2, epoch 79, cost -48.0533146667
Pre-training layer 2, epoch 80, cost -47.9884920502
Pre-training layer 2, epoch 80, representative training free energy 367121.964797
Pre-training layer 2, epoch 80, validation free energy 367318.221865
Pre-training layer 2, epoch 81, cost -47.9791125641
Pre-training layer 2, epoch 82, cost -47.9801170731
Pre-training layer 2, epoch 83, cost -47.8858246613
Pre-training layer 2, epoch 84, cost -47.9328059959
Pre-training layer 2, epoch 85, cost -47.8654524307
Pre-training layer 2, epoch 85, representative training free energy 371979.259859
Pre-training layer 2, epoch 85, validation free energy 372179.811078
Pre-training layer 2, epoch 86, cost -47.9390185013
Pre-training layer 2, epoch 87, cost -47.8504684601
Pre-training layer 2, epoch 88, cost -47.8793196526
Pre-training layer 2, epoch 89, cost -47.8398030357
Pre-training layer 2, epoch 90, cost -47.8638347778
Pre-training layer 2, epoch 90, representative training free energy 375942.988656
Pre-training layer 2, epoch 90, validation free energy 376166.033328
Pre-training layer 2, epoch 91, cost -47.7280154648
Pre-training layer 2, epoch 92, cost -47.7306552582
Pre-training layer 2, epoch 93, cost -47.7350228806
Pre-training layer 2, epoch 94, cost -47.7186967468
Pre-training layer 2, epoch 95, cost -47.6420790215
Pre-training layer 2, epoch 95, representative training free energy 377977.00451
Pre-training layer 2, epoch 95, validation free energy 378247.196589
Pre-training layer 2, epoch 96, cost -47.753946991
Pre-training layer 2, epoch 97, cost -47.6514508438
Pre-training layer 2, epoch 98, cost -47.6472010651
Pre-training layer 2, epoch 99, cost -47.6068193283
The pretraining code for file dbn_loop.pyc ran for 4.75m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.133333 %
     epoch 1, minibatch 500/500, test error of best model 14.666667 %
epoch 2, minibatch 500/500, validation error 8.266667 %
     epoch 2, minibatch 500/500, test error of best model 10.933333 %
epoch 3, minibatch 500/500, validation error 6.800000 %
     epoch 3, minibatch 500/500, test error of best model 8.933333 %
epoch 4, minibatch 500/500, validation error 6.400000 %
     epoch 4, minibatch 500/500, test error of best model 8.000000 %
epoch 5, minibatch 500/500, validation error 5.600000 %
     epoch 5, minibatch 500/500, test error of best model 7.666667 %
epoch 6, minibatch 500/500, validation error 5.400000 %
     epoch 6, minibatch 500/500, test error of best model 7.200000 %
epoch 7, minibatch 500/500, validation error 5.200000 %
     epoch 7, minibatch 500/500, test error of best model 6.800000 %
epoch 8, minibatch 500/500, validation error 5.133333 %
     epoch 8, minibatch 500/500, test error of best model 6.666667 %
epoch 9, minibatch 500/500, validation error 5.066667 %
     epoch 9, minibatch 500/500, test error of best model 6.666667 %
epoch 10, minibatch 500/500, validation error 4.933333 %
     epoch 10, minibatch 500/500, test error of best model 6.533333 %
epoch 11, minibatch 500/500, validation error 4.533333 %
     epoch 11, minibatch 500/500, test error of best model 6.266667 %
epoch 12, minibatch 500/500, validation error 4.400000 %
     epoch 12, minibatch 500/500, test error of best model 6.266667 %
epoch 13, minibatch 500/500, validation error 4.400000 %
epoch 14, minibatch 500/500, validation error 4.266667 %
     epoch 14, minibatch 500/500, test error of best model 6.200000 %
epoch 15, minibatch 500/500, validation error 4.200000 %
     epoch 15, minibatch 500/500, test error of best model 6.200000 %
epoch 16, minibatch 500/500, validation error 4.200000 %
epoch 17, minibatch 500/500, validation error 4.133333 %
     epoch 17, minibatch 500/500, test error of best model 6.000000 %
epoch 18, minibatch 500/500, validation error 4.133333 %
epoch 19, minibatch 500/500, validation error 4.066667 %
     epoch 19, minibatch 500/500, test error of best model 6.133333 %
epoch 20, minibatch 500/500, validation error 4.133333 %
epoch 21, minibatch 500/500, validation error 4.133333 %
epoch 22, minibatch 500/500, validation error 4.133333 %
epoch 23, minibatch 500/500, validation error 4.066667 %
epoch 24, minibatch 500/500, validation error 4.066667 %
epoch 25, minibatch 500/500, validation error 4.000000 %
     epoch 25, minibatch 500/500, test error of best model 6.066667 %
epoch 26, minibatch 500/500, validation error 3.933333 %
     epoch 26, minibatch 500/500, test error of best model 5.933333 %
epoch 27, minibatch 500/500, validation error 3.933333 %
epoch 28, minibatch 500/500, validation error 3.933333 %
epoch 29, minibatch 500/500, validation error 3.933333 %
epoch 30, minibatch 500/500, validation error 3.933333 %
epoch 31, minibatch 500/500, validation error 4.000000 %
epoch 32, minibatch 500/500, validation error 4.000000 %
epoch 33, minibatch 500/500, validation error 4.000000 %
epoch 34, minibatch 500/500, validation error 4.066667 %
epoch 35, minibatch 500/500, validation error 4.000000 %
epoch 36, minibatch 500/500, validation error 4.000000 %
epoch 37, minibatch 500/500, validation error 4.000000 %
epoch 38, minibatch 500/500, validation error 4.000000 %
epoch 39, minibatch 500/500, validation error 4.000000 %
epoch 40, minibatch 500/500, validation error 4.000000 %
epoch 41, minibatch 500/500, validation error 3.933333 %
epoch 42, minibatch 500/500, validation error 3.933333 %
epoch 43, minibatch 500/500, validation error 3.933333 %
epoch 44, minibatch 500/500, validation error 3.933333 %
epoch 45, minibatch 500/500, validation error 3.933333 %
epoch 46, minibatch 500/500, validation error 3.933333 %
epoch 47, minibatch 500/500, validation error 3.933333 %
epoch 48, minibatch 500/500, validation error 3.933333 %
epoch 49, minibatch 500/500, validation error 4.000000 %
epoch 50, minibatch 500/500, validation error 4.000000 %
epoch 51, minibatch 500/500, validation error 4.066667 %
Optimization complete with best validation score of 3.933333 %, obtained at iteration 13000, with test performance 5.933333 %
The fine tuning code for file dbn_loop.pyc ran for 1.13m


==========Sample Size: (5000, 2000, 2000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.992696182
Pre-training layer 0, epoch 0, representative training free energy -256.618377625
Pre-training layer 0, epoch 0, validation free energy -252.620257515
Pre-training layer 0, epoch 1, cost -95.7750818176
Pre-training layer 0, epoch 2, cost -90.2279593201
Pre-training layer 0, epoch 3, cost -87.2665585022
Pre-training layer 0, epoch 4, cost -85.2795950623
Pre-training layer 0, epoch 5, cost -83.7272259064
Pre-training layer 0, epoch 5, representative training free energy -262.683136017
Pre-training layer 0, epoch 5, validation free energy -256.573055687
Pre-training layer 0, epoch 6, cost -82.6757607117
Pre-training layer 0, epoch 7, cost -81.6333580627
Pre-training layer 0, epoch 8, cost -80.764357254
Pre-training layer 0, epoch 9, cost -80.1474240723
Pre-training layer 0, epoch 10, cost -79.5352352753
Pre-training layer 0, epoch 10, representative training free energy -267.659490715
Pre-training layer 0, epoch 10, validation free energy -259.616287987
Pre-training layer 0, epoch 11, cost -78.9771392517
Pre-training layer 0, epoch 12, cost -78.504288414
Pre-training layer 0, epoch 13, cost -78.0705334778
Pre-training layer 0, epoch 14, cost -77.7940966492
Pre-training layer 0, epoch 15, cost -77.4453279877
Pre-training layer 0, epoch 15, representative training free energy -263.424233208
Pre-training layer 0, epoch 15, validation free energy -254.059606613
Pre-training layer 0, epoch 16, cost -77.0429659042
Pre-training layer 0, epoch 17, cost -76.839575676
Pre-training layer 0, epoch 18, cost -76.527675972
Pre-training layer 0, epoch 19, cost -76.2295744934
Pre-training layer 0, epoch 20, cost -75.9316348724
Pre-training layer 0, epoch 20, representative training free energy -260.391606934
Pre-training layer 0, epoch 20, validation free energy -250.155517982
Pre-training layer 0, epoch 21, cost -75.792674736
Pre-training layer 0, epoch 22, cost -75.4482768555
Pre-training layer 0, epoch 23, cost -75.3179730148
Pre-training layer 0, epoch 24, cost -75.2446667786
Pre-training layer 0, epoch 25, cost -74.9008572159
Pre-training layer 0, epoch 25, representative training free energy -257.771597603
Pre-training layer 0, epoch 25, validation free energy -246.617558838
Pre-training layer 0, epoch 26, cost -74.8376318359
Pre-training layer 0, epoch 27, cost -74.6043658447
Pre-training layer 0, epoch 28, cost -74.4162022552
Pre-training layer 0, epoch 29, cost -74.3370528412
Pre-training layer 0, epoch 30, cost -74.1884901047
Pre-training layer 0, epoch 30, representative training free energy -250.370568161
Pre-training layer 0, epoch 30, validation free energy -239.031464531
Pre-training layer 0, epoch 31, cost -74.0033739243
Pre-training layer 0, epoch 32, cost -73.8435217667
Pre-training layer 0, epoch 33, cost -73.7626302032
Pre-training layer 0, epoch 34, cost -73.5717607498
Pre-training layer 0, epoch 35, cost -73.4547052002
Pre-training layer 0, epoch 35, representative training free energy -246.358728241
Pre-training layer 0, epoch 35, validation free energy -234.537656208
Pre-training layer 0, epoch 36, cost -73.4558070908
Pre-training layer 0, epoch 37, cost -73.2590917816
Pre-training layer 0, epoch 38, cost -73.1522750931
Pre-training layer 0, epoch 39, cost -73.0834196625
Pre-training layer 0, epoch 40, cost -72.9421099319
Pre-training layer 0, epoch 40, representative training free energy -243.957725082
Pre-training layer 0, epoch 40, validation free energy -231.49050766
Pre-training layer 0, epoch 41, cost -72.7676143799
Pre-training layer 0, epoch 42, cost -72.7326093979
Pre-training layer 0, epoch 43, cost -72.6219204636
Pre-training layer 0, epoch 44, cost -72.5326736832
Pre-training layer 0, epoch 45, cost -72.4081161041
Pre-training layer 0, epoch 45, representative training free energy -237.091404472
Pre-training layer 0, epoch 45, validation free energy -225.167943604
Pre-training layer 0, epoch 46, cost -72.2703218613
Pre-training layer 0, epoch 47, cost -72.2392614212
Pre-training layer 0, epoch 48, cost -72.0683709869
Pre-training layer 0, epoch 49, cost -72.0435375595
Pre-training layer 0, epoch 50, cost -72.0178694763
Pre-training layer 0, epoch 50, representative training free energy -237.579652672
Pre-training layer 0, epoch 50, validation free energy -224.504747723
Pre-training layer 0, epoch 51, cost -71.8957973251
Pre-training layer 0, epoch 52, cost -71.8087229767
Pre-training layer 0, epoch 53, cost -71.7224588699
Pre-training layer 0, epoch 54, cost -71.6625420685
Pre-training layer 0, epoch 55, cost -71.5114808426
Pre-training layer 0, epoch 55, representative training free energy -231.243490158
Pre-training layer 0, epoch 55, validation free energy -217.826233974
Pre-training layer 0, epoch 56, cost -71.5516475983
Pre-training layer 0, epoch 57, cost -71.4333554001
Pre-training layer 0, epoch 58, cost -71.3605390549
Pre-training layer 0, epoch 59, cost -71.3629636002
Pre-training layer 0, epoch 60, cost -71.298955368
Pre-training layer 0, epoch 60, representative training free energy -224.083213928
Pre-training layer 0, epoch 60, validation free energy -211.02836541
Pre-training layer 0, epoch 61, cost -71.1834856339
Pre-training layer 0, epoch 62, cost -71.1337233429
Pre-training layer 0, epoch 63, cost -70.9905806274
Pre-training layer 0, epoch 64, cost -70.9731839828
Pre-training layer 0, epoch 65, cost -70.8520597992
Pre-training layer 0, epoch 65, representative training free energy -224.14091552
Pre-training layer 0, epoch 65, validation free energy -210.087657375
Pre-training layer 0, epoch 66, cost -70.8375812454
Pre-training layer 0, epoch 67, cost -70.8137014465
Pre-training layer 0, epoch 68, cost -70.7658425217
Pre-training layer 0, epoch 69, cost -70.7534677505
Pre-training layer 0, epoch 70, cost -70.641014183
Pre-training layer 0, epoch 70, representative training free energy -219.044334267
Pre-training layer 0, epoch 70, validation free energy -205.286294739
Pre-training layer 0, epoch 71, cost -70.553993927
Pre-training layer 0, epoch 72, cost -70.4016081543
Pre-training layer 0, epoch 73, cost -70.4415987625
Pre-training layer 0, epoch 74, cost -70.4309142914
Pre-training layer 0, epoch 75, cost -70.302431839
Pre-training layer 0, epoch 75, representative training free energy -219.548732918
Pre-training layer 0, epoch 75, validation free energy -204.821801987
Pre-training layer 0, epoch 76, cost -70.3369265518
Pre-training layer 0, epoch 77, cost -70.1943246994
Pre-training layer 0, epoch 78, cost -70.1292268906
Pre-training layer 0, epoch 79, cost -70.1284848862
Pre-training layer 0, epoch 80, cost -69.9536490479
Pre-training layer 0, epoch 80, representative training free energy -216.410801407
Pre-training layer 0, epoch 80, validation free energy -201.457189705
Pre-training layer 0, epoch 81, cost -70.0186210403
Pre-training layer 0, epoch 82, cost -69.9889595566
Pre-training layer 0, epoch 83, cost -69.9932836304
Pre-training layer 0, epoch 84, cost -69.9528276596
Pre-training layer 0, epoch 85, cost -69.8912384796
Pre-training layer 0, epoch 85, representative training free energy -207.439548241
Pre-training layer 0, epoch 85, validation free energy -192.330668159
Pre-training layer 0, epoch 86, cost -69.8041729126
Pre-training layer 0, epoch 87, cost -69.8152105484
Pre-training layer 0, epoch 88, cost -69.7788397903
Pre-training layer 0, epoch 89, cost -69.6814445267
Pre-training layer 0, epoch 90, cost -69.6286051483
Pre-training layer 0, epoch 90, representative training free energy -206.475770279
Pre-training layer 0, epoch 90, validation free energy -190.651736717
Pre-training layer 0, epoch 91, cost -69.5341027145
Pre-training layer 0, epoch 92, cost -69.4764102402
Pre-training layer 0, epoch 93, cost -69.4963300247
Pre-training layer 0, epoch 94, cost -69.4823326645
Pre-training layer 0, epoch 95, cost -69.3799473572
Pre-training layer 0, epoch 95, representative training free energy -203.04209362
Pre-training layer 0, epoch 95, validation free energy -187.562321194
Pre-training layer 0, epoch 96, cost -69.3511503677
Pre-training layer 0, epoch 97, cost -69.3193406982
Pre-training layer 0, epoch 98, cost -69.2858059464
Pre-training layer 0, epoch 99, cost -69.2108249435
Pre-training layer 1, epoch 0, cost -113.726480057
Pre-training layer 1, epoch 0, representative training free energy -337013.207348
Pre-training layer 1, epoch 0, validation free energy -334563.543848
Pre-training layer 1, epoch 1, cost -89.1760921402
Pre-training layer 1, epoch 2, cost -83.1666403275
Pre-training layer 1, epoch 3, cost -79.6553491516
Pre-training layer 1, epoch 4, cost -77.5185137253
Pre-training layer 1, epoch 5, cost -75.8085417099
Pre-training layer 1, epoch 5, representative training free energy -447940.622336
Pre-training layer 1, epoch 5, validation free energy -444838.274812
Pre-training layer 1, epoch 6, cost -74.4927522736
Pre-training layer 1, epoch 7, cost -73.358034996
Pre-training layer 1, epoch 8, cost -72.4758408356
Pre-training layer 1, epoch 9, cost -71.754140831
Pre-training layer 1, epoch 10, cost -71.1082701416
Pre-training layer 1, epoch 10, representative training free energy -499534.4465
Pre-training layer 1, epoch 10, validation free energy -496186.944398
Pre-training layer 1, epoch 11, cost -70.55841642
Pre-training layer 1, epoch 12, cost -69.9834663773
Pre-training layer 1, epoch 13, cost -69.6058241348
Pre-training layer 1, epoch 14, cost -69.1692152328
Pre-training layer 1, epoch 15, cost -68.6943200378
Pre-training layer 1, epoch 15, representative training free energy -535159.390391
Pre-training layer 1, epoch 15, validation free energy -531710.647141
Pre-training layer 1, epoch 16, cost -68.4026654816
Pre-training layer 1, epoch 17, cost -68.0261665344
Pre-training layer 1, epoch 18, cost -67.7034868164
Pre-training layer 1, epoch 19, cost -67.4626039658
Pre-training layer 1, epoch 20, cost -67.1966032486
Pre-training layer 1, epoch 20, representative training free energy -561726.960102
Pre-training layer 1, epoch 20, validation free energy -558109.386914
Pre-training layer 1, epoch 21, cost -67.0555519257
Pre-training layer 1, epoch 22, cost -66.6969652939
Pre-training layer 1, epoch 23, cost -66.4844337311
Pre-training layer 1, epoch 24, cost -66.3371704941
Pre-training layer 1, epoch 25, cost -66.1626776352
Pre-training layer 1, epoch 25, representative training free energy -584908.391758
Pre-training layer 1, epoch 25, validation free energy -581268.186664
Pre-training layer 1, epoch 26, cost -65.9464649506
Pre-training layer 1, epoch 27, cost -65.7263872833
Pre-training layer 1, epoch 28, cost -65.6839745407
Pre-training layer 1, epoch 29, cost -65.4955280075
Pre-training layer 1, epoch 30, cost -65.33201194
Pre-training layer 1, epoch 30, representative training free energy -604180.342516
Pre-training layer 1, epoch 30, validation free energy -600417.160422
Pre-training layer 1, epoch 31, cost -65.1999029236
Pre-training layer 1, epoch 32, cost -65.1546913376
Pre-training layer 1, epoch 33, cost -65.0369154816
Pre-training layer 1, epoch 34, cost -64.8220617752
Pre-training layer 1, epoch 35, cost -64.7263931046
Pre-training layer 1, epoch 35, representative training free energy -621837.422227
Pre-training layer 1, epoch 35, validation free energy -617954.176492
Pre-training layer 1, epoch 36, cost -64.5469309006
Pre-training layer 1, epoch 37, cost -64.4755105286
Pre-training layer 1, epoch 38, cost -64.3436327362
Pre-training layer 1, epoch 39, cost -64.3404182587
Pre-training layer 1, epoch 40, cost -64.2001081467
Pre-training layer 1, epoch 40, representative training free energy -635817.976719
Pre-training layer 1, epoch 40, validation free energy -631892.551297
Pre-training layer 1, epoch 41, cost -64.1148237762
Pre-training layer 1, epoch 42, cost -64.025017067
Pre-training layer 1, epoch 43, cost -63.9474082794
Pre-training layer 1, epoch 44, cost -63.8525522003
Pre-training layer 1, epoch 45, cost -63.777213089
Pre-training layer 1, epoch 45, representative training free energy -649058.431523
Pre-training layer 1, epoch 45, validation free energy -645041.388086
Pre-training layer 1, epoch 46, cost -63.6633851929
Pre-training layer 1, epoch 47, cost -63.6399089966
Pre-training layer 1, epoch 48, cost -63.5366919403
Pre-training layer 1, epoch 49, cost -63.517675087
Pre-training layer 1, epoch 50, cost -63.493830986
Pre-training layer 1, epoch 50, representative training free energy -660944.053578
Pre-training layer 1, epoch 50, validation free energy -656880.290969
Pre-training layer 1, epoch 51, cost -63.3601518173
Pre-training layer 1, epoch 52, cost -63.273142395
Pre-training layer 1, epoch 53, cost -63.2263393097
Pre-training layer 1, epoch 54, cost -63.2375881424
Pre-training layer 1, epoch 55, cost -63.1029383621
Pre-training layer 1, epoch 55, representative training free energy -671537.954273
Pre-training layer 1, epoch 55, validation free energy -667435.113383
Pre-training layer 1, epoch 56, cost -63.0340851746
Pre-training layer 1, epoch 57, cost -62.9861377411
Pre-training layer 1, epoch 58, cost -62.9199551392
Pre-training layer 1, epoch 59, cost -62.8697076035
Pre-training layer 1, epoch 60, cost -62.8434874954
Pre-training layer 1, epoch 60, representative training free energy -682344.033539
Pre-training layer 1, epoch 60, validation free energy -678135.00818
Pre-training layer 1, epoch 61, cost -62.8642002029
Pre-training layer 1, epoch 62, cost -62.7665463181
Pre-training layer 1, epoch 63, cost -62.737796875
Pre-training layer 1, epoch 64, cost -62.6168539124
Pre-training layer 1, epoch 65, cost -62.5848772049
Pre-training layer 1, epoch 65, representative training free energy -691436.771859
Pre-training layer 1, epoch 65, validation free energy -687233.841727
Pre-training layer 1, epoch 66, cost -62.5443816376
Pre-training layer 1, epoch 67, cost -62.4706485596
Pre-training layer 1, epoch 68, cost -62.5018420258
Pre-training layer 1, epoch 69, cost -62.4880280228
Pre-training layer 1, epoch 70, cost -62.2756540375
Pre-training layer 1, epoch 70, representative training free energy -700777.062852
Pre-training layer 1, epoch 70, validation free energy -696551.172656
Pre-training layer 1, epoch 71, cost -62.258700798
Pre-training layer 1, epoch 72, cost -62.2619254456
Pre-training layer 1, epoch 73, cost -62.2337302933
Pre-training layer 1, epoch 74, cost -62.2210845642
Pre-training layer 1, epoch 75, cost -62.2072060471
Pre-training layer 1, epoch 75, representative training free energy -709667.599781
Pre-training layer 1, epoch 75, validation free energy -705392.718203
Pre-training layer 1, epoch 76, cost -62.1744557266
Pre-training layer 1, epoch 77, cost -62.1457428894
Pre-training layer 1, epoch 78, cost -62.0745574799
Pre-training layer 1, epoch 79, cost -62.0714823608
Pre-training layer 1, epoch 80, cost -62.0190117645
Pre-training layer 1, epoch 80, representative training free energy -717533.421375
Pre-training layer 1, epoch 80, validation free energy -713200.959102
Pre-training layer 1, epoch 81, cost -61.9858955994
Pre-training layer 1, epoch 82, cost -61.9680244598
Pre-training layer 1, epoch 83, cost -61.9305690689
Pre-training layer 1, epoch 84, cost -61.9327647018
Pre-training layer 1, epoch 85, cost -61.8803085709
Pre-training layer 1, epoch 85, representative training free energy -723842.468125
Pre-training layer 1, epoch 85, validation free energy -719523.170398
Pre-training layer 1, epoch 86, cost -61.7930372086
Pre-training layer 1, epoch 87, cost -61.7237306671
Pre-training layer 1, epoch 88, cost -61.8393269005
Pre-training layer 1, epoch 89, cost -61.7079123993
Pre-training layer 1, epoch 90, cost -61.7693203278
Pre-training layer 1, epoch 90, representative training free energy -731488.032984
Pre-training layer 1, epoch 90, validation free energy -727110.220219
Pre-training layer 1, epoch 91, cost -61.7310224152
Pre-training layer 1, epoch 92, cost -61.6058726578
Pre-training layer 1, epoch 93, cost -61.6718458481
Pre-training layer 1, epoch 94, cost -61.587968811
Pre-training layer 1, epoch 95, cost -61.5715285416
Pre-training layer 1, epoch 95, representative training free energy -737646.45257
Pre-training layer 1, epoch 95, validation free energy -733263.933992
Pre-training layer 1, epoch 96, cost -61.5948316116
Pre-training layer 1, epoch 97, cost -61.4807177582
Pre-training layer 1, epoch 98, cost -61.5229584503
Pre-training layer 1, epoch 99, cost -61.4695828476
Pre-training layer 2, epoch 0, cost -89.998909668
Pre-training layer 2, epoch 0, representative training free energy 40507.0510854
Pre-training layer 2, epoch 0, validation free energy 40388.3827988
Pre-training layer 2, epoch 1, cost -66.4816745911
Pre-training layer 2, epoch 2, cost -61.5259534683
Pre-training layer 2, epoch 3, cost -58.9708448563
Pre-training layer 2, epoch 4, cost -57.2954406433
Pre-training layer 2, epoch 5, cost -55.9972246246
Pre-training layer 2, epoch 5, representative training free energy 137963.432639
Pre-training layer 2, epoch 5, validation free energy 137423.761574
Pre-training layer 2, epoch 6, cost -55.0228590622
Pre-training layer 2, epoch 7, cost -54.330510376
Pre-training layer 2, epoch 8, cost -53.6654771881
Pre-training layer 2, epoch 9, cost -53.1424426117
Pre-training layer 2, epoch 10, cost -52.7146158295
Pre-training layer 2, epoch 10, representative training free energy 187998.632229
Pre-training layer 2, epoch 10, validation free energy 187326.869275
Pre-training layer 2, epoch 11, cost -52.2622700424
Pre-training layer 2, epoch 12, cost -51.9335750427
Pre-training layer 2, epoch 13, cost -51.606110527
Pre-training layer 2, epoch 14, cost -51.2389502106
Pre-training layer 2, epoch 15, cost -50.9937359085
Pre-training layer 2, epoch 15, representative training free energy 217859.808797
Pre-training layer 2, epoch 15, validation free energy 217095.774344
Pre-training layer 2, epoch 16, cost -50.7921286697
Pre-training layer 2, epoch 17, cost -50.5739524918
Pre-training layer 2, epoch 18, cost -50.335733223
Pre-training layer 2, epoch 19, cost -50.1465332031
Pre-training layer 2, epoch 20, cost -50.0051258392
Pre-training layer 2, epoch 20, representative training free energy 238876.324922
Pre-training layer 2, epoch 20, validation free energy 238088.996572
Pre-training layer 2, epoch 21, cost -49.7877835083
Pre-training layer 2, epoch 22, cost -49.7114365692
Pre-training layer 2, epoch 23, cost -49.5313162918
Pre-training layer 2, epoch 24, cost -49.4136074295
Pre-training layer 2, epoch 25, cost -49.2889964066
Pre-training layer 2, epoch 25, representative training free energy 256336.672512
Pre-training layer 2, epoch 25, validation free energy 255489.933211
Pre-training layer 2, epoch 26, cost -49.1681518326
Pre-training layer 2, epoch 27, cost -48.998128479
Pre-training layer 2, epoch 28, cost -48.9504928513
Pre-training layer 2, epoch 29, cost -48.8153949738
Pre-training layer 2, epoch 30, cost -48.7269340973
Pre-training layer 2, epoch 30, representative training free energy 268642.677926
Pre-training layer 2, epoch 30, validation free energy 267770.405322
Pre-training layer 2, epoch 31, cost -48.6159271622
Pre-training layer 2, epoch 32, cost -48.534462513
Pre-training layer 2, epoch 33, cost -48.441849884
Pre-training layer 2, epoch 34, cost -48.3987883759
Pre-training layer 2, epoch 35, cost -48.3176450958
Pre-training layer 2, epoch 35, representative training free energy 278758.671812
Pre-training layer 2, epoch 35, validation free energy 277868.602074
Pre-training layer 2, epoch 36, cost -48.2059199028
Pre-training layer 2, epoch 37, cost -48.1399794464
Pre-training layer 2, epoch 38, cost -48.113659565
Pre-training layer 2, epoch 39, cost -47.9172556725
Pre-training layer 2, epoch 40, cost -47.8938717346
Pre-training layer 2, epoch 40, representative training free energy 288246.321883
Pre-training layer 2, epoch 40, validation free energy 287307.567969
Pre-training layer 2, epoch 41, cost -47.7964584923
Pre-training layer 2, epoch 42, cost -47.796539299
Pre-training layer 2, epoch 43, cost -47.7018218613
Pre-training layer 2, epoch 44, cost -47.7021472778
Pre-training layer 2, epoch 45, cost -47.6209420395
Pre-training layer 2, epoch 45, representative training free energy 294407.677289
Pre-training layer 2, epoch 45, validation free energy 293470.858645
Pre-training layer 2, epoch 46, cost -47.5951606522
Pre-training layer 2, epoch 47, cost -47.5277171288
Pre-training layer 2, epoch 48, cost -47.4988192329
Pre-training layer 2, epoch 49, cost -47.4293406067
Pre-training layer 2, epoch 50, cost -47.3497523003
Pre-training layer 2, epoch 50, representative training free energy 300492.024672
Pre-training layer 2, epoch 50, validation free energy 299546.696668
Pre-training layer 2, epoch 51, cost -47.3600063553
Pre-training layer 2, epoch 52, cost -47.2636372719
Pre-training layer 2, epoch 53, cost -47.1380502701
Pre-training layer 2, epoch 54, cost -47.1723689156
Pre-training layer 2, epoch 55, cost -47.1004020653
Pre-training layer 2, epoch 55, representative training free energy 306972.860348
Pre-training layer 2, epoch 55, validation free energy 305988.353176
Pre-training layer 2, epoch 56, cost -47.0873288803
Pre-training layer 2, epoch 57, cost -46.9822721672
Pre-training layer 2, epoch 58, cost -46.959848156
Pre-training layer 2, epoch 59, cost -46.9700302429
Pre-training layer 2, epoch 60, cost -46.973475872
Pre-training layer 2, epoch 60, representative training free energy 310640.799383
Pre-training layer 2, epoch 60, validation free energy 309658.554297
Pre-training layer 2, epoch 61, cost -46.9126541901
Pre-training layer 2, epoch 62, cost -46.8561372147
Pre-training layer 2, epoch 63, cost -46.8279056511
Pre-training layer 2, epoch 64, cost -46.7043694229
Pre-training layer 2, epoch 65, cost -46.6808454094
Pre-training layer 2, epoch 65, representative training free energy 315908.933934
Pre-training layer 2, epoch 65, validation free energy 314905.349969
Pre-training layer 2, epoch 66, cost -46.6621121063
Pre-training layer 2, epoch 67, cost -46.6122313232
Pre-training layer 2, epoch 68, cost -46.5842303314
Pre-training layer 2, epoch 69, cost -46.6284758873
Pre-training layer 2, epoch 70, cost -46.5977152328
Pre-training layer 2, epoch 70, representative training free energy 319538.890785
Pre-training layer 2, epoch 70, validation free energy 318536.083758
Pre-training layer 2, epoch 71, cost -46.5192998962
Pre-training layer 2, epoch 72, cost -46.5152408218
Pre-training layer 2, epoch 73, cost -46.4698513832
Pre-training layer 2, epoch 74, cost -46.4185085449
Pre-training layer 2, epoch 75, cost -46.4118907242
Pre-training layer 2, epoch 75, representative training free energy 322709.958387
Pre-training layer 2, epoch 75, validation free energy 321748.674223
Pre-training layer 2, epoch 76, cost -46.3486992798
Pre-training layer 2, epoch 77, cost -46.4195339165
Pre-training layer 2, epoch 78, cost -46.3400710907
Pre-training layer 2, epoch 79, cost -46.3284451027
Pre-training layer 2, epoch 80, cost -46.2287758751
Pre-training layer 2, epoch 80, representative training free energy 325879.41582
Pre-training layer 2, epoch 80, validation free energy 324868.309617
Pre-training layer 2, epoch 81, cost -46.2054367905
Pre-training layer 2, epoch 82, cost -46.2104282913
Pre-training layer 2, epoch 83, cost -46.2473818321
Pre-training layer 2, epoch 84, cost -46.2070508232
Pre-training layer 2, epoch 85, cost -46.1311936226
Pre-training layer 2, epoch 85, representative training free energy 327612.200977
Pre-training layer 2, epoch 85, validation free energy 326635.046824
Pre-training layer 2, epoch 86, cost -46.057111763
Pre-training layer 2, epoch 87, cost -46.0845747719
Pre-training layer 2, epoch 88, cost -46.0655375862
Pre-training layer 2, epoch 89, cost -46.0698416672
Pre-training layer 2, epoch 90, cost -45.9776134605
Pre-training layer 2, epoch 90, representative training free energy 330939.314461
Pre-training layer 2, epoch 90, validation free energy 329945.275109
Pre-training layer 2, epoch 91, cost -45.9679072037
Pre-training layer 2, epoch 92, cost -45.967401413
Pre-training layer 2, epoch 93, cost -45.9562232094
Pre-training layer 2, epoch 94, cost -45.9680933762
Pre-training layer 2, epoch 95, cost -45.9490314827
Pre-training layer 2, epoch 95, representative training free energy 335005.497121
Pre-training layer 2, epoch 95, validation free energy 333989.863758
Pre-training layer 2, epoch 96, cost -45.9077009125
Pre-training layer 2, epoch 97, cost -45.8674851608
Pre-training layer 2, epoch 98, cost -45.8550237274
Pre-training layer 2, epoch 99, cost -45.8606382637
The pretraining code for file dbn_loop.pyc ran for 4.75m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 11.500000 %
     epoch 1, minibatch 500/500, test error of best model 14.000000 %
epoch 2, minibatch 500/500, validation error 7.550000 %
     epoch 2, minibatch 500/500, test error of best model 9.800000 %
epoch 3, minibatch 500/500, validation error 6.400000 %
     epoch 3, minibatch 500/500, test error of best model 8.450000 %
epoch 4, minibatch 500/500, validation error 5.600000 %
     epoch 4, minibatch 500/500, test error of best model 7.800000 %
epoch 5, minibatch 500/500, validation error 5.100000 %
     epoch 5, minibatch 500/500, test error of best model 7.050000 %
epoch 6, minibatch 500/500, validation error 5.000000 %
     epoch 6, minibatch 500/500, test error of best model 6.900000 %
epoch 7, minibatch 500/500, validation error 4.800000 %
     epoch 7, minibatch 500/500, test error of best model 6.750000 %
epoch 8, minibatch 500/500, validation error 4.750000 %
     epoch 8, minibatch 500/500, test error of best model 6.500000 %
epoch 9, minibatch 500/500, validation error 4.600000 %
     epoch 9, minibatch 500/500, test error of best model 6.450000 %
epoch 10, minibatch 500/500, validation error 4.500000 %
     epoch 10, minibatch 500/500, test error of best model 6.200000 %
epoch 11, minibatch 500/500, validation error 4.450000 %
     epoch 11, minibatch 500/500, test error of best model 6.150000 %
epoch 12, minibatch 500/500, validation error 4.350000 %
     epoch 12, minibatch 500/500, test error of best model 6.200000 %
epoch 13, minibatch 500/500, validation error 4.250000 %
     epoch 13, minibatch 500/500, test error of best model 6.100000 %
epoch 14, minibatch 500/500, validation error 4.200000 %
     epoch 14, minibatch 500/500, test error of best model 6.100000 %
epoch 15, minibatch 500/500, validation error 4.250000 %
epoch 16, minibatch 500/500, validation error 4.150000 %
     epoch 16, minibatch 500/500, test error of best model 6.000000 %
epoch 17, minibatch 500/500, validation error 4.050000 %
     epoch 17, minibatch 500/500, test error of best model 5.950000 %
epoch 18, minibatch 500/500, validation error 4.050000 %
epoch 19, minibatch 500/500, validation error 4.050000 %
epoch 20, minibatch 500/500, validation error 4.100000 %
epoch 21, minibatch 500/500, validation error 4.100000 %
epoch 22, minibatch 500/500, validation error 4.200000 %
epoch 23, minibatch 500/500, validation error 4.200000 %
epoch 24, minibatch 500/500, validation error 4.200000 %
epoch 25, minibatch 500/500, validation error 4.200000 %
epoch 26, minibatch 500/500, validation error 4.150000 %
epoch 27, minibatch 500/500, validation error 4.150000 %
epoch 28, minibatch 500/500, validation error 4.200000 %
epoch 29, minibatch 500/500, validation error 4.250000 %
epoch 30, minibatch 500/500, validation error 4.200000 %
epoch 31, minibatch 500/500, validation error 4.200000 %
epoch 32, minibatch 500/500, validation error 4.200000 %
epoch 33, minibatch 500/500, validation error 4.200000 %
Optimization complete with best validation score of 4.050000 %, obtained at iteration 8500, with test performance 5.950000 %
The fine tuning code for file dbn_loop.pyc ran for 0.77m
_______RUN: 2

==========Sample Size: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.846699631
Pre-training layer 0, epoch 0, representative training free energy -260.487043182
Pre-training layer 0, epoch 0, validation free energy -253.672332001
Pre-training layer 0, epoch 1, cost -95.585081543
Pre-training layer 0, epoch 2, cost -89.9807875824
Pre-training layer 0, epoch 3, cost -87.1672491379
Pre-training layer 0, epoch 4, cost -85.1089174347
Pre-training layer 0, epoch 5, cost -83.6201331024
Pre-training layer 0, epoch 5, representative training free energy -268.355058777
Pre-training layer 0, epoch 5, validation free energy -258.161446381
Pre-training layer 0, epoch 6, cost -82.5010204468
Pre-training layer 0, epoch 7, cost -81.5445103531
Pre-training layer 0, epoch 8, cost -80.6262814026
Pre-training layer 0, epoch 9, cost -80.0739438782
Pre-training layer 0, epoch 10, cost -79.4850577164
Pre-training layer 0, epoch 10, representative training free energy -265.798205383
Pre-training layer 0, epoch 10, validation free energy -255.08752356
Pre-training layer 0, epoch 11, cost -78.9041521225
Pre-training layer 0, epoch 12, cost -78.3468063431
Pre-training layer 0, epoch 13, cost -77.9911635818
Pre-training layer 0, epoch 14, cost -77.6243036041
Pre-training layer 0, epoch 15, cost -77.1838303986
Pre-training layer 0, epoch 15, representative training free energy -266.241724335
Pre-training layer 0, epoch 15, validation free energy -254.725115845
Pre-training layer 0, epoch 16, cost -76.9952759857
Pre-training layer 0, epoch 17, cost -76.6417751541
Pre-training layer 0, epoch 18, cost -76.503939682
Pre-training layer 0, epoch 19, cost -76.2196141357
Pre-training layer 0, epoch 20, cost -75.9804032211
Pre-training layer 0, epoch 20, representative training free energy -264.291362885
Pre-training layer 0, epoch 20, validation free energy -251.490470551
Pre-training layer 0, epoch 21, cost -75.7165661469
Pre-training layer 0, epoch 22, cost -75.5013739319
Pre-training layer 0, epoch 23, cost -75.3005849609
Pre-training layer 0, epoch 24, cost -75.1163973694
Pre-training layer 0, epoch 25, cost -74.9145070724
Pre-training layer 0, epoch 25, representative training free energy -259.592185028
Pre-training layer 0, epoch 25, validation free energy -246.250266205
Pre-training layer 0, epoch 26, cost -74.7768684845
Pre-training layer 0, epoch 27, cost -74.6848006744
Pre-training layer 0, epoch 28, cost -74.4678454361
Pre-training layer 0, epoch 29, cost -74.3546897507
Pre-training layer 0, epoch 30, cost -74.0411764908
Pre-training layer 0, epoch 30, representative training free energy -256.438319977
Pre-training layer 0, epoch 30, validation free energy -243.160720551
Pre-training layer 0, epoch 31, cost -74.1057267075
Pre-training layer 0, epoch 32, cost -73.9509461594
Pre-training layer 0, epoch 33, cost -73.7403680801
Pre-training layer 0, epoch 34, cost -73.5872487488
Pre-training layer 0, epoch 35, cost -73.5186190796
Pre-training layer 0, epoch 35, representative training free energy -251.181517822
Pre-training layer 0, epoch 35, validation free energy -236.219077454
Pre-training layer 0, epoch 36, cost -73.3214416199
Pre-training layer 0, epoch 37, cost -73.3403242416
Pre-training layer 0, epoch 38, cost -73.0563694916
Pre-training layer 0, epoch 39, cost -73.0247449036
Pre-training layer 0, epoch 40, cost -73.00869841
Pre-training layer 0, epoch 40, representative training free energy -250.983952118
Pre-training layer 0, epoch 40, validation free energy -236.539152313
Pre-training layer 0, epoch 41, cost -72.8207737045
Pre-training layer 0, epoch 42, cost -72.6821115112
Pre-training layer 0, epoch 43, cost -72.6938564072
Pre-training layer 0, epoch 44, cost -72.5377333679
Pre-training layer 0, epoch 45, cost -72.5633258591
Pre-training layer 0, epoch 45, representative training free energy -242.937732361
Pre-training layer 0, epoch 45, validation free energy -228.014396606
Pre-training layer 0, epoch 46, cost -72.3533376007
Pre-training layer 0, epoch 47, cost -72.2615818024
Pre-training layer 0, epoch 48, cost -72.1651730499
Pre-training layer 0, epoch 49, cost -72.136820488
Pre-training layer 0, epoch 50, cost -72.0096282578
Pre-training layer 0, epoch 50, representative training free energy -246.028789734
Pre-training layer 0, epoch 50, validation free energy -229.957059448
Pre-training layer 0, epoch 51, cost -71.926954895
Pre-training layer 0, epoch 52, cost -71.8302074814
Pre-training layer 0, epoch 53, cost -71.8756113892
Pre-training layer 0, epoch 54, cost -71.644361618
Pre-training layer 0, epoch 55, cost -71.6220789566
Pre-training layer 0, epoch 55, representative training free energy -237.534551636
Pre-training layer 0, epoch 55, validation free energy -221.087545227
Pre-training layer 0, epoch 56, cost -71.5226216507
Pre-training layer 0, epoch 57, cost -71.4457558899
Pre-training layer 0, epoch 58, cost -71.3748486633
Pre-training layer 0, epoch 59, cost -71.3217834702
Pre-training layer 0, epoch 60, cost -71.2374401474
Pre-training layer 0, epoch 60, representative training free energy -237.535224335
Pre-training layer 0, epoch 60, validation free energy -221.037376709
Pre-training layer 0, epoch 61, cost -71.2300516357
Pre-training layer 0, epoch 62, cost -71.0948948898
Pre-training layer 0, epoch 63, cost -71.0647872543
Pre-training layer 0, epoch 64, cost -71.0060470047
Pre-training layer 0, epoch 65, cost -70.9216896515
Pre-training layer 0, epoch 65, representative training free energy -232.387393555
Pre-training layer 0, epoch 65, validation free energy -215.888743164
Pre-training layer 0, epoch 66, cost -70.823858139
Pre-training layer 0, epoch 67, cost -70.8858155594
Pre-training layer 0, epoch 68, cost -70.6683303833
Pre-training layer 0, epoch 69, cost -70.7071127472
Pre-training layer 0, epoch 70, cost -70.6588124161
Pre-training layer 0, epoch 70, representative training free energy -225.162645142
Pre-training layer 0, epoch 70, validation free energy -208.683438614
Pre-training layer 0, epoch 71, cost -70.6269561081
Pre-training layer 0, epoch 72, cost -70.5588668518
Pre-training layer 0, epoch 73, cost -70.5538970413
Pre-training layer 0, epoch 74, cost -70.3264811096
Pre-training layer 0, epoch 75, cost -70.4463164825
Pre-training layer 0, epoch 75, representative training free energy -225.05994046
Pre-training layer 0, epoch 75, validation free energy -208.074481522
Pre-training layer 0, epoch 76, cost -70.2525573273
Pre-training layer 0, epoch 77, cost -70.2560686951
Pre-training layer 0, epoch 78, cost -70.221462616
Pre-training layer 0, epoch 79, cost -70.1847358322
Pre-training layer 0, epoch 80, cost -70.1604597397
Pre-training layer 0, epoch 80, representative training free energy -222.400561798
Pre-training layer 0, epoch 80, validation free energy -203.852369553
Pre-training layer 0, epoch 81, cost -70.0417210007
Pre-training layer 0, epoch 82, cost -69.9816789246
Pre-training layer 0, epoch 83, cost -69.8897369766
Pre-training layer 0, epoch 84, cost -69.8985473633
Pre-training layer 0, epoch 85, cost -69.9295057297
Pre-training layer 0, epoch 85, representative training free energy -220.747759125
Pre-training layer 0, epoch 85, validation free energy -202.770401825
Pre-training layer 0, epoch 86, cost -69.8917668839
Pre-training layer 0, epoch 87, cost -69.7916649628
Pre-training layer 0, epoch 88, cost -69.8085825195
Pre-training layer 0, epoch 89, cost -69.6405992813
Pre-training layer 0, epoch 90, cost -69.6641022873
Pre-training layer 0, epoch 90, representative training free energy -218.253016663
Pre-training layer 0, epoch 90, validation free energy -200.231234039
Pre-training layer 0, epoch 91, cost -69.6027740021
Pre-training layer 0, epoch 92, cost -69.6113409042
Pre-training layer 0, epoch 93, cost -69.5764648743
Pre-training layer 0, epoch 94, cost -69.5665305176
Pre-training layer 0, epoch 95, cost -69.425465538
Pre-training layer 0, epoch 95, representative training free energy -218.351356537
Pre-training layer 0, epoch 95, validation free energy -200.178484116
Pre-training layer 0, epoch 96, cost -69.3414982986
Pre-training layer 0, epoch 97, cost -69.3367112961
Pre-training layer 0, epoch 98, cost -69.261108757
Pre-training layer 0, epoch 99, cost -69.3444737473
Pre-training layer 1, epoch 0, cost -112.36345755
Pre-training layer 1, epoch 0, representative training free energy -322829.772719
Pre-training layer 1, epoch 0, validation free energy -320068.868656
Pre-training layer 1, epoch 1, cost -88.0262186966
Pre-training layer 1, epoch 2, cost -82.0751612778
Pre-training layer 1, epoch 3, cost -78.5977943115
Pre-training layer 1, epoch 4, cost -76.2916442795
Pre-training layer 1, epoch 5, cost -74.572875145
Pre-training layer 1, epoch 5, representative training free energy -426097.608156
Pre-training layer 1, epoch 5, validation free energy -422582.670156
Pre-training layer 1, epoch 6, cost -73.230694252
Pre-training layer 1, epoch 7, cost -72.1949327774
Pre-training layer 1, epoch 8, cost -71.3042403564
Pre-training layer 1, epoch 9, cost -70.5015097122
Pre-training layer 1, epoch 10, cost -69.9135523987
Pre-training layer 1, epoch 10, representative training free energy -475177.584344
Pre-training layer 1, epoch 10, validation free energy -471391.028969
Pre-training layer 1, epoch 11, cost -69.2352221527
Pre-training layer 1, epoch 12, cost -68.6924409332
Pre-training layer 1, epoch 13, cost -68.2393022537
Pre-training layer 1, epoch 14, cost -67.757039978
Pre-training layer 1, epoch 15, cost -67.4381446762
Pre-training layer 1, epoch 15, representative training free energy -509430.448531
Pre-training layer 1, epoch 15, validation free energy -505427.773312
Pre-training layer 1, epoch 16, cost -67.1291313324
Pre-training layer 1, epoch 17, cost -66.7231637955
Pre-training layer 1, epoch 18, cost -66.399860405
Pre-training layer 1, epoch 19, cost -66.1510987015
Pre-training layer 1, epoch 20, cost -65.9392172699
Pre-training layer 1, epoch 20, representative training free energy -536385.024313
Pre-training layer 1, epoch 20, validation free energy -532241.880719
Pre-training layer 1, epoch 21, cost -65.6618250656
Pre-training layer 1, epoch 22, cost -65.4449132462
Pre-training layer 1, epoch 23, cost -65.2453389282
Pre-training layer 1, epoch 24, cost -64.9661956482
Pre-training layer 1, epoch 25, cost -64.8320107269
Pre-training layer 1, epoch 25, representative training free energy -558651.436844
Pre-training layer 1, epoch 25, validation free energy -554409.774156
Pre-training layer 1, epoch 26, cost -64.6935626373
Pre-training layer 1, epoch 27, cost -64.5800085754
Pre-training layer 1, epoch 28, cost -64.3421587067
Pre-training layer 1, epoch 29, cost -64.1706861572
Pre-training layer 1, epoch 30, cost -64.0414482956
Pre-training layer 1, epoch 30, representative training free energy -576853.009875
Pre-training layer 1, epoch 30, validation free energy -572512.335219
Pre-training layer 1, epoch 31, cost -63.8703281097
Pre-training layer 1, epoch 32, cost -63.7695918121
Pre-training layer 1, epoch 33, cost -63.7249265823
Pre-training layer 1, epoch 34, cost -63.5170352936
Pre-training layer 1, epoch 35, cost -63.4278901978
Pre-training layer 1, epoch 35, representative training free energy -593105.992313
Pre-training layer 1, epoch 35, validation free energy -588655.468938
Pre-training layer 1, epoch 36, cost -63.3740801773
Pre-training layer 1, epoch 37, cost -63.1735845337
Pre-training layer 1, epoch 38, cost -63.0810902634
Pre-training layer 1, epoch 39, cost -63.0021660995
Pre-training layer 1, epoch 40, cost -62.9429499359
Pre-training layer 1, epoch 40, representative training free energy -606963.025813
Pre-training layer 1, epoch 40, validation free energy -602465.213219
Pre-training layer 1, epoch 41, cost -62.7428660049
Pre-training layer 1, epoch 42, cost -62.7380942688
Pre-training layer 1, epoch 43, cost -62.6043179359
Pre-training layer 1, epoch 44, cost -62.5500979919
Pre-training layer 1, epoch 45, cost -62.4768042221
Pre-training layer 1, epoch 45, representative training free energy -619366.355438
Pre-training layer 1, epoch 45, validation free energy -614797.633375
Pre-training layer 1, epoch 46, cost -62.4400934753
Pre-training layer 1, epoch 47, cost -62.2839690247
Pre-training layer 1, epoch 48, cost -62.257284668
Pre-training layer 1, epoch 49, cost -62.0587872849
Pre-training layer 1, epoch 50, cost -62.05160326
Pre-training layer 1, epoch 50, representative training free energy -631336.275156
Pre-training layer 1, epoch 50, validation free energy -626694.181844
Pre-training layer 1, epoch 51, cost -61.9663984222
Pre-training layer 1, epoch 52, cost -62.0130589828
Pre-training layer 1, epoch 53, cost -61.9346777649
Pre-training layer 1, epoch 54, cost -61.8442364159
Pre-training layer 1, epoch 55, cost -61.8224182281
Pre-training layer 1, epoch 55, representative training free energy -641982.02575
Pre-training layer 1, epoch 55, validation free energy -637297.980562
Pre-training layer 1, epoch 56, cost -61.7146801376
Pre-training layer 1, epoch 57, cost -61.7428419266
Pre-training layer 1, epoch 58, cost -61.6472437057
Pre-training layer 1, epoch 59, cost -61.5153692169
Pre-training layer 1, epoch 60, cost -61.5505716171
Pre-training layer 1, epoch 60, representative training free energy -652067.868656
Pre-training layer 1, epoch 60, validation free energy -647334.685344
Pre-training layer 1, epoch 61, cost -61.4959320984
Pre-training layer 1, epoch 62, cost -61.3592303696
Pre-training layer 1, epoch 63, cost -61.3331327858
Pre-training layer 1, epoch 64, cost -61.3199362411
Pre-training layer 1, epoch 65, cost -61.2514409294
Pre-training layer 1, epoch 65, representative training free energy -661302.397969
Pre-training layer 1, epoch 65, validation free energy -656489.571625
Pre-training layer 1, epoch 66, cost -61.2416138535
Pre-training layer 1, epoch 67, cost -61.1460247231
Pre-training layer 1, epoch 68, cost -61.1670265274
Pre-training layer 1, epoch 69, cost -61.1404196854
Pre-training layer 1, epoch 70, cost -61.1019137001
Pre-training layer 1, epoch 70, representative training free energy -669597.437281
Pre-training layer 1, epoch 70, validation free energy -664719.741875
Pre-training layer 1, epoch 71, cost -61.0411163406
Pre-training layer 1, epoch 72, cost -60.9485405655
Pre-training layer 1, epoch 73, cost -60.9513001022
Pre-training layer 1, epoch 74, cost -60.8932818756
Pre-training layer 1, epoch 75, cost -60.8438606567
Pre-training layer 1, epoch 75, representative training free energy -678278.076188
Pre-training layer 1, epoch 75, validation free energy -673368.109062
Pre-training layer 1, epoch 76, cost -60.8206266098
Pre-training layer 1, epoch 77, cost -60.782472126
Pre-training layer 1, epoch 78, cost -60.6855821838
Pre-training layer 1, epoch 79, cost -60.759069355
Pre-training layer 1, epoch 80, cost -60.7028240852
Pre-training layer 1, epoch 80, representative training free energy -685936.973844
Pre-training layer 1, epoch 80, validation free energy -680946.038625
Pre-training layer 1, epoch 81, cost -60.6483048668
Pre-training layer 1, epoch 82, cost -60.660944088
Pre-training layer 1, epoch 83, cost -60.5770902786
Pre-training layer 1, epoch 84, cost -60.5459822083
Pre-training layer 1, epoch 85, cost -60.5798419266
Pre-training layer 1, epoch 85, representative training free energy -693509.293375
Pre-training layer 1, epoch 85, validation free energy -688480.49475
Pre-training layer 1, epoch 86, cost -60.4304754105
Pre-training layer 1, epoch 87, cost -60.4321122894
Pre-training layer 1, epoch 88, cost -60.3859934235
Pre-training layer 1, epoch 89, cost -60.4716963654
Pre-training layer 1, epoch 90, cost -60.4039728851
Pre-training layer 1, epoch 90, representative training free energy -701550.384625
Pre-training layer 1, epoch 90, validation free energy -696490.881375
Pre-training layer 1, epoch 91, cost -60.3574150734
Pre-training layer 1, epoch 92, cost -60.3334300346
Pre-training layer 1, epoch 93, cost -60.254951973
Pre-training layer 1, epoch 94, cost -60.2504232407
Pre-training layer 1, epoch 95, cost -60.2263807755
Pre-training layer 1, epoch 95, representative training free energy -707686.432469
Pre-training layer 1, epoch 95, validation free energy -702580.5725
Pre-training layer 1, epoch 96, cost -60.1841453705
Pre-training layer 1, epoch 97, cost -60.2044499626
Pre-training layer 1, epoch 98, cost -60.2269272461
Pre-training layer 1, epoch 99, cost -60.103782547
Pre-training layer 2, epoch 0, cost -89.4840361481
Pre-training layer 2, epoch 0, representative training free energy 38736.6237598
Pre-training layer 2, epoch 0, validation free energy 38498.9211289
Pre-training layer 2, epoch 1, cost -66.1730044937
Pre-training layer 2, epoch 2, cost -61.2970539246
Pre-training layer 2, epoch 3, cost -58.8472006149
Pre-training layer 2, epoch 4, cost -57.0643867416
Pre-training layer 2, epoch 5, cost -55.7362600327
Pre-training layer 2, epoch 5, representative training free energy 130866.58957
Pre-training layer 2, epoch 5, validation free energy 130105.722039
Pre-training layer 2, epoch 6, cost -54.8696671982
Pre-training layer 2, epoch 7, cost -54.0900296173
Pre-training layer 2, epoch 8, cost -53.4578488388
Pre-training layer 2, epoch 9, cost -52.9657829819
Pre-training layer 2, epoch 10, cost -52.4233044968
Pre-training layer 2, epoch 10, representative training free energy 174713.589875
Pre-training layer 2, epoch 10, validation free energy 173756.648891
Pre-training layer 2, epoch 11, cost -52.0815638123
Pre-training layer 2, epoch 12, cost -51.7080496674
Pre-training layer 2, epoch 13, cost -51.3943304138
Pre-training layer 2, epoch 14, cost -51.1811169434
Pre-training layer 2, epoch 15, cost -50.911804184
Pre-training layer 2, epoch 15, representative training free energy 204347.766234
Pre-training layer 2, epoch 15, validation free energy 203240.669187
Pre-training layer 2, epoch 16, cost -50.6848520508
Pre-training layer 2, epoch 17, cost -50.5038106308
Pre-training layer 2, epoch 18, cost -50.1957590256
Pre-training layer 2, epoch 19, cost -50.0377544556
Pre-training layer 2, epoch 20, cost -49.915186676
Pre-training layer 2, epoch 20, representative training free energy 224303.423141
Pre-training layer 2, epoch 20, validation free energy 223146.025687
Pre-training layer 2, epoch 21, cost -49.7145211105
Pre-training layer 2, epoch 22, cost -49.5890056534
Pre-training layer 2, epoch 23, cost -49.3915486984
Pre-training layer 2, epoch 24, cost -49.2351083374
Pre-training layer 2, epoch 25, cost -49.1096528511
Pre-training layer 2, epoch 25, representative training free energy 239934.186359
Pre-training layer 2, epoch 25, validation free energy 238716.611906
Pre-training layer 2, epoch 26, cost -48.9691084824
Pre-training layer 2, epoch 27, cost -48.8906428795
Pre-training layer 2, epoch 28, cost -48.8328106537
Pre-training layer 2, epoch 29, cost -48.6970503006
Pre-training layer 2, epoch 30, cost -48.6061049042
Pre-training layer 2, epoch 30, representative training free energy 254444.102109
Pre-training layer 2, epoch 30, validation free energy 253176.315891
Pre-training layer 2, epoch 31, cost -48.5288632774
Pre-training layer 2, epoch 32, cost -48.3359405441
Pre-training layer 2, epoch 33, cost -48.3001452408
Pre-training layer 2, epoch 34, cost -48.2191750069
Pre-training layer 2, epoch 35, cost -48.0953249702
Pre-training layer 2, epoch 35, representative training free energy 266087.5765
Pre-training layer 2, epoch 35, validation free energy 264781.660344
Pre-training layer 2, epoch 36, cost -48.0577012558
Pre-training layer 2, epoch 37, cost -47.9828901939
Pre-training layer 2, epoch 38, cost -47.8766457443
Pre-training layer 2, epoch 39, cost -47.8445370483
Pre-training layer 2, epoch 40, cost -47.8111285019
Pre-training layer 2, epoch 40, representative training free energy 276470.833203
Pre-training layer 2, epoch 40, validation free energy 275086.599297
Pre-training layer 2, epoch 41, cost -47.7544033394
Pre-training layer 2, epoch 42, cost -47.5975625343
Pre-training layer 2, epoch 43, cost -47.4773891258
Pre-training layer 2, epoch 44, cost -47.5403392677
Pre-training layer 2, epoch 45, cost -47.4726400223
Pre-training layer 2, epoch 45, representative training free energy 283223.554609
Pre-training layer 2, epoch 45, validation free energy 281810.71575
Pre-training layer 2, epoch 46, cost -47.4307170296
Pre-training layer 2, epoch 47, cost -47.2839867477
Pre-training layer 2, epoch 48, cost -47.2752302399
Pre-training layer 2, epoch 49, cost -47.3106631927
Pre-training layer 2, epoch 50, cost -47.2198507996
Pre-training layer 2, epoch 50, representative training free energy 289853.838781
Pre-training layer 2, epoch 50, validation free energy 288418.290141
Pre-training layer 2, epoch 51, cost -47.1083983078
Pre-training layer 2, epoch 52, cost -47.0942316742
Pre-training layer 2, epoch 53, cost -47.0565498352
Pre-training layer 2, epoch 54, cost -46.99073703
Pre-training layer 2, epoch 55, cost -46.8924790192
Pre-training layer 2, epoch 55, representative training free energy 295035.906656
Pre-training layer 2, epoch 55, validation free energy 293586.479016
Pre-training layer 2, epoch 56, cost -46.8744632492
Pre-training layer 2, epoch 57, cost -46.8673575821
Pre-training layer 2, epoch 58, cost -46.81459795
Pre-training layer 2, epoch 59, cost -46.7745329208
Pre-training layer 2, epoch 60, cost -46.7472333107
Pre-training layer 2, epoch 60, representative training free energy 301504.396969
Pre-training layer 2, epoch 60, validation free energy 300020.092312
Pre-training layer 2, epoch 61, cost -46.6996568832
Pre-training layer 2, epoch 62, cost -46.6695204353
Pre-training layer 2, epoch 63, cost -46.580818676
Pre-training layer 2, epoch 64, cost -46.5479054871
Pre-training layer 2, epoch 65, cost -46.5690409927
Pre-training layer 2, epoch 65, representative training free energy 306009.300984
Pre-training layer 2, epoch 65, validation free energy 304475.507703
Pre-training layer 2, epoch 66, cost -46.5057172737
Pre-training layer 2, epoch 67, cost -46.5168760834
Pre-training layer 2, epoch 68, cost -46.3894516335
Pre-training layer 2, epoch 69, cost -46.4439623222
Pre-training layer 2, epoch 70, cost -46.3533896675
Pre-training layer 2, epoch 70, representative training free energy 308358.329
Pre-training layer 2, epoch 70, validation free energy 306820.179875
Pre-training layer 2, epoch 71, cost -46.3616880722
Pre-training layer 2, epoch 72, cost -46.4017656937
Pre-training layer 2, epoch 73, cost -46.3094309959
Pre-training layer 2, epoch 74, cost -46.2693000793
Pre-training layer 2, epoch 75, cost -46.2745469055
Pre-training layer 2, epoch 75, representative training free energy 313478.556203
Pre-training layer 2, epoch 75, validation free energy 311901.262359
Pre-training layer 2, epoch 76, cost -46.2166553268
Pre-training layer 2, epoch 77, cost -46.1538593941
Pre-training layer 2, epoch 78, cost -46.2128193741
Pre-training layer 2, epoch 79, cost -46.0944338417
Pre-training layer 2, epoch 80, cost -46.0439066315
Pre-training layer 2, epoch 80, representative training free energy 318327.640453
Pre-training layer 2, epoch 80, validation free energy 316752.645172
Pre-training layer 2, epoch 81, cost -46.0222486267
Pre-training layer 2, epoch 82, cost -46.0460178032
Pre-training layer 2, epoch 83, cost -46.1243923378
Pre-training layer 2, epoch 84, cost -45.9787809372
Pre-training layer 2, epoch 85, cost -45.9320679626
Pre-training layer 2, epoch 85, representative training free energy 321782.041094
Pre-training layer 2, epoch 85, validation free energy 320170.295359
Pre-training layer 2, epoch 86, cost -45.979338707
Pre-training layer 2, epoch 87, cost -45.8980396385
Pre-training layer 2, epoch 88, cost -45.8740443153
Pre-training layer 2, epoch 89, cost -45.8922981911
Pre-training layer 2, epoch 90, cost -45.8664822693
Pre-training layer 2, epoch 90, representative training free energy 323209.949797
Pre-training layer 2, epoch 90, validation free energy 321595.055813
Pre-training layer 2, epoch 91, cost -45.8588004379
Pre-training layer 2, epoch 92, cost -45.9124665527
Pre-training layer 2, epoch 93, cost -45.7669449158
Pre-training layer 2, epoch 94, cost -45.7404002838
Pre-training layer 2, epoch 95, cost -45.759722683
Pre-training layer 2, epoch 95, representative training free energy 326411.917703
Pre-training layer 2, epoch 95, validation free energy 324785.208375
Pre-training layer 2, epoch 96, cost -45.7499597702
Pre-training layer 2, epoch 97, cost -45.7198039474
Pre-training layer 2, epoch 98, cost -45.6552123871
Pre-training layer 2, epoch 99, cost -45.6771325493
The pretraining code for file dbn_loop.pyc ran for 4.80m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.000000 %
     epoch 1, minibatch 500/500, test error of best model 13.000000 %
epoch 2, minibatch 500/500, validation error 9.200000 %
     epoch 2, minibatch 500/500, test error of best model 7.800000 %
epoch 3, minibatch 500/500, validation error 7.800000 %
     epoch 3, minibatch 500/500, test error of best model 6.600000 %
epoch 4, minibatch 500/500, validation error 6.800000 %
     epoch 4, minibatch 500/500, test error of best model 5.600000 %
epoch 5, minibatch 500/500, validation error 6.400000 %
     epoch 5, minibatch 500/500, test error of best model 5.200000 %
epoch 6, minibatch 500/500, validation error 6.200000 %
     epoch 6, minibatch 500/500, test error of best model 5.400000 %
epoch 7, minibatch 500/500, validation error 6.000000 %
     epoch 7, minibatch 500/500, test error of best model 5.400000 %
epoch 8, minibatch 500/500, validation error 5.800000 %
     epoch 8, minibatch 500/500, test error of best model 5.400000 %
epoch 9, minibatch 500/500, validation error 5.800000 %
epoch 10, minibatch 500/500, validation error 5.800000 %
epoch 11, minibatch 500/500, validation error 6.000000 %
epoch 12, minibatch 500/500, validation error 6.200000 %
epoch 13, minibatch 500/500, validation error 6.400000 %
epoch 14, minibatch 500/500, validation error 6.400000 %
epoch 15, minibatch 500/500, validation error 6.400000 %
Optimization complete with best validation score of 5.800000 %, obtained at iteration 4000, with test performance 5.400000 %
The fine tuning code for file dbn_loop.pyc ran for 0.31m


==========Sample Size: (5000, 1000, 1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.045392059
Pre-training layer 0, epoch 0, representative training free energy -256.266362564
Pre-training layer 0, epoch 0, validation free energy -252.523145187
Pre-training layer 0, epoch 1, cost -95.6944818115
Pre-training layer 0, epoch 2, cost -90.3084879608
Pre-training layer 0, epoch 3, cost -87.3391754379
Pre-training layer 0, epoch 4, cost -85.277563942
Pre-training layer 0, epoch 5, cost -83.785043663
Pre-training layer 0, epoch 5, representative training free energy -265.603102814
Pre-training layer 0, epoch 5, validation free energy -258.86773143
Pre-training layer 0, epoch 6, cost -82.572890274
Pre-training layer 0, epoch 7, cost -81.6106914673
Pre-training layer 0, epoch 8, cost -80.717086586
Pre-training layer 0, epoch 9, cost -80.0554259415
Pre-training layer 0, epoch 10, cost -79.5649085159
Pre-training layer 0, epoch 10, representative training free energy -268.574945969
Pre-training layer 0, epoch 10, validation free energy -259.12902652
Pre-training layer 0, epoch 11, cost -79.0348176041
Pre-training layer 0, epoch 12, cost -78.5801318436
Pre-training layer 0, epoch 13, cost -78.0884142838
Pre-training layer 0, epoch 14, cost -77.7626859131
Pre-training layer 0, epoch 15, cost -77.2887233734
Pre-training layer 0, epoch 15, representative training free energy -265.604151749
Pre-training layer 0, epoch 15, validation free energy -254.156575012
Pre-training layer 0, epoch 16, cost -77.0215673523
Pre-training layer 0, epoch 17, cost -76.7174110565
Pre-training layer 0, epoch 18, cost -76.4165441589
Pre-training layer 0, epoch 19, cost -76.2002957306
Pre-training layer 0, epoch 20, cost -75.980506134
Pre-training layer 0, epoch 20, representative training free energy -261.855130676
Pre-training layer 0, epoch 20, validation free energy -250.648592621
Pre-training layer 0, epoch 21, cost -75.660862709
Pre-training layer 0, epoch 22, cost -75.5842364044
Pre-training layer 0, epoch 23, cost -75.257626709
Pre-training layer 0, epoch 24, cost -74.9852069702
Pre-training layer 0, epoch 25, cost -74.9378203659
Pre-training layer 0, epoch 25, representative training free energy -260.830417328
Pre-training layer 0, epoch 25, validation free energy -248.685792526
Pre-training layer 0, epoch 26, cost -74.7499118729
Pre-training layer 0, epoch 27, cost -74.5869757004
Pre-training layer 0, epoch 28, cost -74.3670994873
Pre-training layer 0, epoch 29, cost -74.2528847809
Pre-training layer 0, epoch 30, cost -74.091259758
Pre-training layer 0, epoch 30, representative training free energy -261.509246109
Pre-training layer 0, epoch 30, validation free energy -249.221422302
Pre-training layer 0, epoch 31, cost -74.050867569
Pre-training layer 0, epoch 32, cost -73.8462578583
Pre-training layer 0, epoch 33, cost -73.7033547897
Pre-training layer 0, epoch 34, cost -73.5245737915
Pre-training layer 0, epoch 35, cost -73.4226102448
Pre-training layer 0, epoch 35, representative training free energy -253.914912369
Pre-training layer 0, epoch 35, validation free energy -240.978651947
Pre-training layer 0, epoch 36, cost -73.3173038712
Pre-training layer 0, epoch 37, cost -73.1591886139
Pre-training layer 0, epoch 38, cost -73.0802926407
Pre-training layer 0, epoch 39, cost -72.9759342651
Pre-training layer 0, epoch 40, cost -73.019377243
Pre-training layer 0, epoch 40, representative training free energy -250.683497742
Pre-training layer 0, epoch 40, validation free energy -237.608207382
Pre-training layer 0, epoch 41, cost -72.8430199203
Pre-training layer 0, epoch 42, cost -72.6852802505
Pre-training layer 0, epoch 43, cost -72.5532221146
Pre-training layer 0, epoch 44, cost -72.4416246033
Pre-training layer 0, epoch 45, cost -72.4541936188
Pre-training layer 0, epoch 45, representative training free energy -242.960509369
Pre-training layer 0, epoch 45, validation free energy -229.684663315
Pre-training layer 0, epoch 46, cost -72.3538595428
Pre-training layer 0, epoch 47, cost -72.2272240372
Pre-training layer 0, epoch 48, cost -72.1324398193
Pre-training layer 0, epoch 49, cost -72.1028316727
Pre-training layer 0, epoch 50, cost -71.9775350037
Pre-training layer 0, epoch 50, representative training free energy -245.266292282
Pre-training layer 0, epoch 50, validation free energy -230.798037941
Pre-training layer 0, epoch 51, cost -71.9158189926
Pre-training layer 0, epoch 52, cost -71.8489992142
Pre-training layer 0, epoch 53, cost -71.752206131
Pre-training layer 0, epoch 54, cost -71.55608255
Pre-training layer 0, epoch 55, cost -71.5946186752
Pre-training layer 0, epoch 55, representative training free energy -241.347352325
Pre-training layer 0, epoch 55, validation free energy -226.681288422
Pre-training layer 0, epoch 56, cost -71.5225544205
Pre-training layer 0, epoch 57, cost -71.3798877563
Pre-training layer 0, epoch 58, cost -71.4665781784
Pre-training layer 0, epoch 59, cost -71.2022830124
Pre-training layer 0, epoch 60, cost -71.2136941986
Pre-training layer 0, epoch 60, representative training free energy -237.187508423
Pre-training layer 0, epoch 60, validation free energy -221.270712578
Pre-training layer 0, epoch 61, cost -71.1439057541
Pre-training layer 0, epoch 62, cost -71.1328782883
Pre-training layer 0, epoch 63, cost -70.9935568314
Pre-training layer 0, epoch 64, cost -70.9946312256
Pre-training layer 0, epoch 65, cost -70.8672324982
Pre-training layer 0, epoch 65, representative training free energy -233.556673477
Pre-training layer 0, epoch 65, validation free energy -219.781914017
Pre-training layer 0, epoch 66, cost -70.6736756134
Pre-training layer 0, epoch 67, cost -70.6738813477
Pre-training layer 0, epoch 68, cost -70.6775566788
Pre-training layer 0, epoch 69, cost -70.6591577148
Pre-training layer 0, epoch 70, cost -70.5760699615
Pre-training layer 0, epoch 70, representative training free energy -229.08790451
Pre-training layer 0, epoch 70, validation free energy -213.213539162
Pre-training layer 0, epoch 71, cost -70.4913238449
Pre-training layer 0, epoch 72, cost -70.4743238449
Pre-training layer 0, epoch 73, cost -70.463451622
Pre-training layer 0, epoch 74, cost -70.3654146957
Pre-training layer 0, epoch 75, cost -70.2885755081
Pre-training layer 0, epoch 75, representative training free energy -230.3919263
Pre-training layer 0, epoch 75, validation free energy -215.411214394
Pre-training layer 0, epoch 76, cost -70.1463941269
Pre-training layer 0, epoch 77, cost -70.1882533798
Pre-training layer 0, epoch 78, cost -70.0842517929
Pre-training layer 0, epoch 79, cost -70.101588623
Pre-training layer 0, epoch 80, cost -70.0715541306
Pre-training layer 0, epoch 80, representative training free energy -224.701534042
Pre-training layer 0, epoch 80, validation free energy -209.397509811
Pre-training layer 0, epoch 81, cost -69.9666055069
Pre-training layer 0, epoch 82, cost -69.9404752121
Pre-training layer 0, epoch 83, cost -69.9227576752
Pre-training layer 0, epoch 84, cost -69.8533278427
Pre-training layer 0, epoch 85, cost -69.7875699921
Pre-training layer 0, epoch 85, representative training free energy -216.131184799
Pre-training layer 0, epoch 85, validation free energy -201.179244247
Pre-training layer 0, epoch 86, cost -69.7398079071
Pre-training layer 0, epoch 87, cost -69.7655101089
Pre-training layer 0, epoch 88, cost -69.6042833328
Pre-training layer 0, epoch 89, cost -69.6767729721
Pre-training layer 0, epoch 90, cost -69.5163861618
Pre-training layer 0, epoch 90, representative training free energy -219.100617767
Pre-training layer 0, epoch 90, validation free energy -201.748208534
Pre-training layer 0, epoch 91, cost -69.6431145401
Pre-training layer 0, epoch 92, cost -69.3978991928
Pre-training layer 0, epoch 93, cost -69.5128365784
Pre-training layer 0, epoch 94, cost -69.4401656723
Pre-training layer 0, epoch 95, cost -69.3781715469
Pre-training layer 0, epoch 95, representative training free energy -217.498226608
Pre-training layer 0, epoch 95, validation free energy -199.391946159
Pre-training layer 0, epoch 96, cost -69.3262338867
Pre-training layer 0, epoch 97, cost -69.2322844543
Pre-training layer 0, epoch 98, cost -69.2769669952
Pre-training layer 0, epoch 99, cost -69.1519622803
Pre-training layer 1, epoch 0, cost -112.134290237
Pre-training layer 1, epoch 0, representative training free energy -331866.718141
Pre-training layer 1, epoch 0, validation free energy -329422.057719
Pre-training layer 1, epoch 1, cost -87.5894613953
Pre-training layer 1, epoch 2, cost -81.5555082779
Pre-training layer 1, epoch 3, cost -78.0567219772
Pre-training layer 1, epoch 4, cost -75.6849130859
Pre-training layer 1, epoch 5, cost -73.9963709335
Pre-training layer 1, epoch 5, representative training free energy -442010.884562
Pre-training layer 1, epoch 5, validation free energy -438457.495703
Pre-training layer 1, epoch 6, cost -72.6950974808
Pre-training layer 1, epoch 7, cost -71.6099895935
Pre-training layer 1, epoch 8, cost -70.6789522629
Pre-training layer 1, epoch 9, cost -70.0634206161
Pre-training layer 1, epoch 10, cost -69.2568967667
Pre-training layer 1, epoch 10, representative training free energy -493247.781469
Pre-training layer 1, epoch 10, validation free energy -489182.330234
Pre-training layer 1, epoch 11, cost -68.7061382446
Pre-training layer 1, epoch 12, cost -68.2278380432
Pre-training layer 1, epoch 13, cost -67.7027465744
Pre-training layer 1, epoch 14, cost -67.3274968643
Pre-training layer 1, epoch 15, cost -66.9289749451
Pre-training layer 1, epoch 15, representative training free energy -527499.063969
Pre-training layer 1, epoch 15, validation free energy -523231.529656
Pre-training layer 1, epoch 16, cost -66.7288229065
Pre-training layer 1, epoch 17, cost -66.2863979187
Pre-training layer 1, epoch 18, cost -65.9433628082
Pre-training layer 1, epoch 19, cost -65.6742132263
Pre-training layer 1, epoch 20, cost -65.3952279129
Pre-training layer 1, epoch 20, representative training free energy -554674.807266
Pre-training layer 1, epoch 20, validation free energy -550186.45675
Pre-training layer 1, epoch 21, cost -65.2827848358
Pre-training layer 1, epoch 22, cost -64.9828427505
Pre-training layer 1, epoch 23, cost -64.8311181183
Pre-training layer 1, epoch 24, cost -64.5666339111
Pre-training layer 1, epoch 25, cost -64.4759584198
Pre-training layer 1, epoch 25, representative training free energy -577696.953469
Pre-training layer 1, epoch 25, validation free energy -572851.305156
Pre-training layer 1, epoch 26, cost -64.2518040009
Pre-training layer 1, epoch 27, cost -64.0808691864
Pre-training layer 1, epoch 28, cost -63.8918530502
Pre-training layer 1, epoch 29, cost -63.7079990311
Pre-training layer 1, epoch 30, cost -63.5522933426
Pre-training layer 1, epoch 30, representative training free energy -595940.352859
Pre-training layer 1, epoch 30, validation free energy -590903.264453
Pre-training layer 1, epoch 31, cost -63.5029825363
Pre-training layer 1, epoch 32, cost -63.3931755447
Pre-training layer 1, epoch 33, cost -63.2479509811
Pre-training layer 1, epoch 34, cost -63.1279574814
Pre-training layer 1, epoch 35, cost -62.9487865295
Pre-training layer 1, epoch 35, representative training free energy -612848.49775
Pre-training layer 1, epoch 35, validation free energy -607650.325641
Pre-training layer 1, epoch 36, cost -62.8280511398
Pre-training layer 1, epoch 37, cost -62.7733552055
Pre-training layer 1, epoch 38, cost -62.705861496
Pre-training layer 1, epoch 39, cost -62.5840715714
Pre-training layer 1, epoch 40, cost -62.3771374817
Pre-training layer 1, epoch 40, representative training free energy -626722.545594
Pre-training layer 1, epoch 40, validation free energy -621452.633063
Pre-training layer 1, epoch 41, cost -62.3401146317
Pre-training layer 1, epoch 42, cost -62.2903265762
Pre-training layer 1, epoch 43, cost -62.1774533844
Pre-training layer 1, epoch 44, cost -62.0429090042
Pre-training layer 1, epoch 45, cost -61.9627015305
Pre-training layer 1, epoch 45, representative training free energy -641222.832953
Pre-training layer 1, epoch 45, validation free energy -635856.618375
Pre-training layer 1, epoch 46, cost -62.0018369942
Pre-training layer 1, epoch 47, cost -61.9118237381
Pre-training layer 1, epoch 48, cost -61.835850399
Pre-training layer 1, epoch 49, cost -61.8829894562
Pre-training layer 1, epoch 50, cost -61.7730186768
Pre-training layer 1, epoch 50, representative training free energy -652247.259297
Pre-training layer 1, epoch 50, validation free energy -646717.819672
Pre-training layer 1, epoch 51, cost -61.6385012894
Pre-training layer 1, epoch 52, cost -61.5407612152
Pre-training layer 1, epoch 53, cost -61.4869910736
Pre-training layer 1, epoch 54, cost -61.491211647
Pre-training layer 1, epoch 55, cost -61.4067610779
Pre-training layer 1, epoch 55, representative training free energy -663019.234125
Pre-training layer 1, epoch 55, validation free energy -657463.948203
Pre-training layer 1, epoch 56, cost -61.2956361847
Pre-training layer 1, epoch 57, cost -61.2635232544
Pre-training layer 1, epoch 58, cost -61.2190702515
Pre-training layer 1, epoch 59, cost -61.1635752602
Pre-training layer 1, epoch 60, cost -61.1025921745
Pre-training layer 1, epoch 60, representative training free energy -673046.328203
Pre-training layer 1, epoch 60, validation free energy -667442.464719
Pre-training layer 1, epoch 61, cost -61.0274679298
Pre-training layer 1, epoch 62, cost -61.0064936066
Pre-training layer 1, epoch 63, cost -60.9415040398
Pre-training layer 1, epoch 64, cost -60.966371357
Pre-training layer 1, epoch 65, cost -60.8502911148
Pre-training layer 1, epoch 65, representative training free energy -682487.049437
Pre-training layer 1, epoch 65, validation free energy -676715.214
Pre-training layer 1, epoch 66, cost -60.8252609978
Pre-training layer 1, epoch 67, cost -60.7808959503
Pre-training layer 1, epoch 68, cost -60.7568501892
Pre-training layer 1, epoch 69, cost -60.7381422272
Pre-training layer 1, epoch 70, cost -60.5984560432
Pre-training layer 1, epoch 70, representative training free energy -692304.960109
Pre-training layer 1, epoch 70, validation free energy -686505.349438
Pre-training layer 1, epoch 71, cost -60.5828987885
Pre-training layer 1, epoch 72, cost -60.5671611252
Pre-training layer 1, epoch 73, cost -60.5782498436
Pre-training layer 1, epoch 74, cost -60.5089479141
Pre-training layer 1, epoch 75, cost -60.4432174301
Pre-training layer 1, epoch 75, representative training free energy -700321.117906
Pre-training layer 1, epoch 75, validation free energy -694429.049156
Pre-training layer 1, epoch 76, cost -60.4126423454
Pre-training layer 1, epoch 77, cost -60.3686225853
Pre-training layer 1, epoch 78, cost -60.2924693642
Pre-training layer 1, epoch 79, cost -60.326011837
Pre-training layer 1, epoch 80, cost -60.318593483
Pre-training layer 1, epoch 80, representative training free energy -707336.566844
Pre-training layer 1, epoch 80, validation free energy -701276.445781
Pre-training layer 1, epoch 81, cost -60.2106963425
Pre-training layer 1, epoch 82, cost -60.1604235115
Pre-training layer 1, epoch 83, cost -60.1544730988
Pre-training layer 1, epoch 84, cost -60.1567986679
Pre-training layer 1, epoch 85, cost -60.1500132408
Pre-training layer 1, epoch 85, representative training free energy -714886.534141
Pre-training layer 1, epoch 85, validation free energy -708783.771859
Pre-training layer 1, epoch 86, cost -60.0970398483
Pre-training layer 1, epoch 87, cost -60.0099817123
Pre-training layer 1, epoch 88, cost -60.058680397
Pre-training layer 1, epoch 89, cost -60.0403847122
Pre-training layer 1, epoch 90, cost -60.0086551476
Pre-training layer 1, epoch 90, representative training free energy -721908.908922
Pre-training layer 1, epoch 90, validation free energy -715723.823812
Pre-training layer 1, epoch 91, cost -59.9628404961
Pre-training layer 1, epoch 92, cost -59.9691907883
Pre-training layer 1, epoch 93, cost -59.9215688133
Pre-training layer 1, epoch 94, cost -59.8901597214
Pre-training layer 1, epoch 95, cost -59.8813724556
Pre-training layer 1, epoch 95, representative training free energy -728655.709141
Pre-training layer 1, epoch 95, validation free energy -722452.018469
Pre-training layer 1, epoch 96, cost -59.8461462212
Pre-training layer 1, epoch 97, cost -59.8141439171
Pre-training layer 1, epoch 98, cost -59.7798948555
Pre-training layer 1, epoch 99, cost -59.7676315041
Pre-training layer 2, epoch 0, cost -89.8644485397
Pre-training layer 2, epoch 0, representative training free energy 35773.6202197
Pre-training layer 2, epoch 0, validation free energy 35207.3799062
Pre-training layer 2, epoch 1, cost -66.2881698074
Pre-training layer 2, epoch 2, cost -61.5870083923
Pre-training layer 2, epoch 3, cost -58.9886164246
Pre-training layer 2, epoch 4, cost -57.334739296
Pre-training layer 2, epoch 5, cost -56.2038226852
Pre-training layer 2, epoch 5, representative training free energy 144508.065461
Pre-training layer 2, epoch 5, validation free energy 143175.234703
Pre-training layer 2, epoch 6, cost -55.1810594635
Pre-training layer 2, epoch 7, cost -54.5327641373
Pre-training layer 2, epoch 8, cost -53.7634996643
Pre-training layer 2, epoch 9, cost -53.3245369186
Pre-training layer 2, epoch 10, cost -52.8587931824
Pre-training layer 2, epoch 10, representative training free energy 200605.198719
Pre-training layer 2, epoch 10, validation free energy 198954.721687
Pre-training layer 2, epoch 11, cost -52.4819394989
Pre-training layer 2, epoch 12, cost -52.1334951553
Pre-training layer 2, epoch 13, cost -51.7359234924
Pre-training layer 2, epoch 14, cost -51.555467598
Pre-training layer 2, epoch 15, cost -51.2012922363
Pre-training layer 2, epoch 15, representative training free energy 234174.67107
Pre-training layer 2, epoch 15, validation free energy 232347.009758
Pre-training layer 2, epoch 16, cost -50.9750220337
Pre-training layer 2, epoch 17, cost -50.7976804886
Pre-training layer 2, epoch 18, cost -50.5868986206
Pre-training layer 2, epoch 19, cost -50.3776993256
Pre-training layer 2, epoch 20, cost -50.2403619614
Pre-training layer 2, epoch 20, representative training free energy 257452.892984
Pre-training layer 2, epoch 20, validation free energy 255517.144453
Pre-training layer 2, epoch 21, cost -50.0896450653
Pre-training layer 2, epoch 22, cost -49.8950062027
Pre-training layer 2, epoch 23, cost -49.8078783112
Pre-training layer 2, epoch 24, cost -49.6396006012
Pre-training layer 2, epoch 25, cost -49.4940699768
Pre-training layer 2, epoch 25, representative training free energy 277277.931641
Pre-training layer 2, epoch 25, validation free energy 275244.077063
Pre-training layer 2, epoch 26, cost -49.2577491837
Pre-training layer 2, epoch 27, cost -49.25445784
Pre-training layer 2, epoch 28, cost -49.1051591263
Pre-training layer 2, epoch 29, cost -49.0918674164
Pre-training layer 2, epoch 30, cost -48.8796491776
Pre-training layer 2, epoch 30, representative training free energy 290791.641461
Pre-training layer 2, epoch 30, validation free energy 288694.064688
Pre-training layer 2, epoch 31, cost -48.8603554688
Pre-training layer 2, epoch 32, cost -48.6743750305
Pre-training layer 2, epoch 33, cost -48.6524950867
Pre-training layer 2, epoch 34, cost -48.545193573
Pre-training layer 2, epoch 35, cost -48.5280095062
Pre-training layer 2, epoch 35, representative training free energy 303596.047187
Pre-training layer 2, epoch 35, validation free energy 301469.320063
Pre-training layer 2, epoch 36, cost -48.4471095734
Pre-training layer 2, epoch 37, cost -48.3093765717
Pre-training layer 2, epoch 38, cost -48.3219387741
Pre-training layer 2, epoch 39, cost -48.2081357269
Pre-training layer 2, epoch 40, cost -48.1672984848
Pre-training layer 2, epoch 40, representative training free energy 313825.964094
Pre-training layer 2, epoch 40, validation free energy 311609.313867
Pre-training layer 2, epoch 41, cost -48.0605920639
Pre-training layer 2, epoch 42, cost -47.9562430801
Pre-training layer 2, epoch 43, cost -47.9073782196
Pre-training layer 2, epoch 44, cost -47.8913263397
Pre-training layer 2, epoch 45, cost -47.8009040375
Pre-training layer 2, epoch 45, representative training free energy 323027.242516
Pre-training layer 2, epoch 45, validation free energy 320831.243859
Pre-training layer 2, epoch 46, cost -47.731141449
Pre-training layer 2, epoch 47, cost -47.6915437393
Pre-training layer 2, epoch 48, cost -47.6397434464
Pre-training layer 2, epoch 49, cost -47.6428223419
Pre-training layer 2, epoch 50, cost -47.5440351486
Pre-training layer 2, epoch 50, representative training free energy 331620.227586
Pre-training layer 2, epoch 50, validation free energy 329388.832867
Pre-training layer 2, epoch 51, cost -47.5022817383
Pre-training layer 2, epoch 52, cost -47.4324655609
Pre-training layer 2, epoch 53, cost -47.4107801514
Pre-training layer 2, epoch 54, cost -47.3256543655
Pre-training layer 2, epoch 55, cost -47.3471733398
Pre-training layer 2, epoch 55, representative training free energy 338082.82818
Pre-training layer 2, epoch 55, validation free energy 335733.937125
Pre-training layer 2, epoch 56, cost -47.3017638016
Pre-training layer 2, epoch 57, cost -47.2128679047
Pre-training layer 2, epoch 58, cost -47.1339287796
Pre-training layer 2, epoch 59, cost -47.1371078186
Pre-training layer 2, epoch 60, cost -47.1381711197
Pre-training layer 2, epoch 60, representative training free energy 343627.311383
Pre-training layer 2, epoch 60, validation free energy 341327.106625
Pre-training layer 2, epoch 61, cost -47.1122223434
Pre-training layer 2, epoch 62, cost -47.0381755447
Pre-training layer 2, epoch 63, cost -47.0206242447
Pre-training layer 2, epoch 64, cost -46.9642766876
Pre-training layer 2, epoch 65, cost -46.8860809097
Pre-training layer 2, epoch 65, representative training free energy 350910.394688
Pre-training layer 2, epoch 65, validation free energy 348487.812344
Pre-training layer 2, epoch 66, cost -46.9033698196
Pre-training layer 2, epoch 67, cost -46.8435557098
Pre-training layer 2, epoch 68, cost -46.8464396133
Pre-training layer 2, epoch 69, cost -46.7889394913
Pre-training layer 2, epoch 70, cost -46.76702285
Pre-training layer 2, epoch 70, representative training free energy 353570.775844
Pre-training layer 2, epoch 70, validation free energy 351140.296797
Pre-training layer 2, epoch 71, cost -46.6802398605
Pre-training layer 2, epoch 72, cost -46.7167592163
Pre-training layer 2, epoch 73, cost -46.7215607452
Pre-training layer 2, epoch 74, cost -46.6273560829
Pre-training layer 2, epoch 75, cost -46.6150693054
Pre-training layer 2, epoch 75, representative training free energy 357513.611641
Pre-training layer 2, epoch 75, validation free energy 355026.72057
Pre-training layer 2, epoch 76, cost -46.5607939453
Pre-training layer 2, epoch 77, cost -46.5734901047
Pre-training layer 2, epoch 78, cost -46.5128855667
Pre-training layer 2, epoch 79, cost -46.5337932816
Pre-training layer 2, epoch 80, cost -46.4853264389
Pre-training layer 2, epoch 80, representative training free energy 360981.82157
Pre-training layer 2, epoch 80, validation free energy 358535.285133
Pre-training layer 2, epoch 81, cost -46.48461689
Pre-training layer 2, epoch 82, cost -46.3724606361
Pre-training layer 2, epoch 83, cost -46.4439916077
Pre-training layer 2, epoch 84, cost -46.3683840599
Pre-training layer 2, epoch 85, cost -46.3918286133
Pre-training layer 2, epoch 85, representative training free energy 365486.571422
Pre-training layer 2, epoch 85, validation free energy 362966.468109
Pre-training layer 2, epoch 86, cost -46.2989194984
Pre-training layer 2, epoch 87, cost -46.3516100159
Pre-training layer 2, epoch 88, cost -46.2758316803
Pre-training layer 2, epoch 89, cost -46.2849085236
Pre-training layer 2, epoch 90, cost -46.1860927811
Pre-training layer 2, epoch 90, representative training free energy 367180.371367
Pre-training layer 2, epoch 90, validation free energy 364692.151031
Pre-training layer 2, epoch 91, cost -46.2030563622
Pre-training layer 2, epoch 92, cost -46.2124709854
Pre-training layer 2, epoch 93, cost -46.17499263
Pre-training layer 2, epoch 94, cost -46.1783026962
Pre-training layer 2, epoch 95, cost -46.1506363792
Pre-training layer 2, epoch 95, representative training free energy 370840.059656
Pre-training layer 2, epoch 95, validation free energy 368281.749453
Pre-training layer 2, epoch 96, cost -46.1550936584
Pre-training layer 2, epoch 97, cost -46.1225467644
Pre-training layer 2, epoch 98, cost -46.0853641891
Pre-training layer 2, epoch 99, cost -46.0424056931
The pretraining code for file dbn_loop.pyc ran for 4.68m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.600000 %
     epoch 1, minibatch 500/500, test error of best model 12.500000 %
epoch 2, minibatch 500/500, validation error 8.600000 %
     epoch 2, minibatch 500/500, test error of best model 8.600000 %
epoch 3, minibatch 500/500, validation error 7.900000 %
     epoch 3, minibatch 500/500, test error of best model 7.500000 %
epoch 4, minibatch 500/500, validation error 7.100000 %
     epoch 4, minibatch 500/500, test error of best model 6.500000 %
epoch 5, minibatch 500/500, validation error 6.300000 %
     epoch 5, minibatch 500/500, test error of best model 6.200000 %
epoch 6, minibatch 500/500, validation error 5.800000 %
     epoch 6, minibatch 500/500, test error of best model 5.700000 %
epoch 7, minibatch 500/500, validation error 5.300000 %
     epoch 7, minibatch 500/500, test error of best model 5.600000 %
epoch 8, minibatch 500/500, validation error 4.900000 %
     epoch 8, minibatch 500/500, test error of best model 5.400000 %
epoch 9, minibatch 500/500, validation error 4.900000 %
epoch 10, minibatch 500/500, validation error 4.800000 %
     epoch 10, minibatch 500/500, test error of best model 5.100000 %
epoch 11, minibatch 500/500, validation error 4.800000 %
epoch 12, minibatch 500/500, validation error 4.800000 %
epoch 13, minibatch 500/500, validation error 4.900000 %
epoch 14, minibatch 500/500, validation error 5.000000 %
epoch 15, minibatch 500/500, validation error 5.000000 %
epoch 16, minibatch 500/500, validation error 5.000000 %
epoch 17, minibatch 500/500, validation error 4.900000 %
epoch 18, minibatch 500/500, validation error 4.800000 %
epoch 19, minibatch 500/500, validation error 4.700000 %
     epoch 19, minibatch 500/500, test error of best model 5.000000 %
epoch 20, minibatch 500/500, validation error 4.800000 %
epoch 21, minibatch 500/500, validation error 5.000000 %
epoch 22, minibatch 500/500, validation error 5.000000 %
epoch 23, minibatch 500/500, validation error 5.000000 %
epoch 24, minibatch 500/500, validation error 5.100000 %
epoch 25, minibatch 500/500, validation error 5.100000 %
epoch 26, minibatch 500/500, validation error 5.000000 %
epoch 27, minibatch 500/500, validation error 5.000000 %
epoch 28, minibatch 500/500, validation error 5.000000 %
epoch 29, minibatch 500/500, validation error 5.000000 %
epoch 30, minibatch 500/500, validation error 5.000000 %
epoch 31, minibatch 500/500, validation error 5.000000 %
epoch 32, minibatch 500/500, validation error 4.900000 %
epoch 33, minibatch 500/500, validation error 4.900000 %
epoch 34, minibatch 500/500, validation error 4.800000 %
epoch 35, minibatch 500/500, validation error 4.800000 %
epoch 36, minibatch 500/500, validation error 4.800000 %
epoch 37, minibatch 500/500, validation error 4.800000 %
Optimization complete with best validation score of 4.700000 %, obtained at iteration 9500, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.77m


==========Sample Size: (5000, 1500, 1500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -120.00231987
Pre-training layer 0, epoch 0, representative training free energy -258.978816966
Pre-training layer 0, epoch 0, validation free energy -255.30919519
Pre-training layer 0, epoch 1, cost -95.502386261
Pre-training layer 0, epoch 2, cost -90.2187540359
Pre-training layer 0, epoch 3, cost -87.1702798004
Pre-training layer 0, epoch 4, cost -85.1678720093
Pre-training layer 0, epoch 5, cost -83.7407978363
Pre-training layer 0, epoch 5, representative training free energy -263.229867625
Pre-training layer 0, epoch 5, validation free energy -257.250434479
Pre-training layer 0, epoch 6, cost -82.6463237076
Pre-training layer 0, epoch 7, cost -81.4968398743
Pre-training layer 0, epoch 8, cost -80.8322618637
Pre-training layer 0, epoch 9, cost -80.2923054276
Pre-training layer 0, epoch 10, cost -79.535201088
Pre-training layer 0, epoch 10, representative training free energy -271.720248718
Pre-training layer 0, epoch 10, validation free energy -263.249669718
Pre-training layer 0, epoch 11, cost -78.9112048111
Pre-training layer 0, epoch 12, cost -78.555289856
Pre-training layer 0, epoch 13, cost -78.0634717789
Pre-training layer 0, epoch 14, cost -77.6013306427
Pre-training layer 0, epoch 15, cost -77.3732229843
Pre-training layer 0, epoch 15, representative training free energy -259.882306163
Pre-training layer 0, epoch 15, validation free energy -250.945633118
Pre-training layer 0, epoch 16, cost -77.0441531296
Pre-training layer 0, epoch 17, cost -76.7415519867
Pre-training layer 0, epoch 18, cost -76.4379220886
Pre-training layer 0, epoch 19, cost -76.0863496552
Pre-training layer 0, epoch 20, cost -75.9059441376
Pre-training layer 0, epoch 20, representative training free energy -262.99626298
Pre-training layer 0, epoch 20, validation free energy -253.323528666
Pre-training layer 0, epoch 21, cost -75.730886673
Pre-training layer 0, epoch 22, cost -75.5409413452
Pre-training layer 0, epoch 23, cost -75.3188733139
Pre-training layer 0, epoch 24, cost -75.2031946411
Pre-training layer 0, epoch 25, cost -74.7759338837
Pre-training layer 0, epoch 25, representative training free energy -255.391906006
Pre-training layer 0, epoch 25, validation free energy -245.310632945
Pre-training layer 0, epoch 26, cost -74.716890152
Pre-training layer 0, epoch 27, cost -74.5884539337
Pre-training layer 0, epoch 28, cost -74.4617000427
Pre-training layer 0, epoch 29, cost -74.2422589722
Pre-training layer 0, epoch 30, cost -74.0681243515
Pre-training layer 0, epoch 30, representative training free energy -253.598707876
Pre-training layer 0, epoch 30, validation free energy -242.710298482
Pre-training layer 0, epoch 31, cost -74.0574140472
Pre-training layer 0, epoch 32, cost -73.9394021835
Pre-training layer 0, epoch 33, cost -73.7614230576
Pre-training layer 0, epoch 34, cost -73.5401736832
Pre-training layer 0, epoch 35, cost -73.4283824463
Pre-training layer 0, epoch 35, representative training free energy -247.375747253
Pre-training layer 0, epoch 35, validation free energy -235.600225077
Pre-training layer 0, epoch 36, cost -73.3363693924
Pre-training layer 0, epoch 37, cost -73.2533770599
Pre-training layer 0, epoch 38, cost -73.2549618607
Pre-training layer 0, epoch 39, cost -72.9774573059
Pre-training layer 0, epoch 40, cost -72.9312485809
Pre-training layer 0, epoch 40, representative training free energy -244.816090851
Pre-training layer 0, epoch 40, validation free energy -233.201072052
Pre-training layer 0, epoch 41, cost -72.8418550797
Pre-training layer 0, epoch 42, cost -72.6672345428
Pre-training layer 0, epoch 43, cost -72.504269104
Pre-training layer 0, epoch 44, cost -72.5377438507
Pre-training layer 0, epoch 45, cost -72.4648915329
Pre-training layer 0, epoch 45, representative training free energy -243.444010935
Pre-training layer 0, epoch 45, validation free energy -230.675853388
Pre-training layer 0, epoch 46, cost -72.3759652405
Pre-training layer 0, epoch 47, cost -72.120644783
Pre-training layer 0, epoch 48, cost -72.2182369537
Pre-training layer 0, epoch 49, cost -72.0734251328
Pre-training layer 0, epoch 50, cost -72.0189237289
Pre-training layer 0, epoch 50, representative training free energy -238.562861552
Pre-training layer 0, epoch 50, validation free energy -225.845652496
Pre-training layer 0, epoch 51, cost -71.8954470596
Pre-training layer 0, epoch 52, cost -71.8132643814
Pre-training layer 0, epoch 53, cost -71.8103503189
Pre-training layer 0, epoch 54, cost -71.7194342117
Pre-training layer 0, epoch 55, cost -71.5558199463
Pre-training layer 0, epoch 55, representative training free energy -233.784586639
Pre-training layer 0, epoch 55, validation free energy -220.873275197
Pre-training layer 0, epoch 56, cost -71.623228714
Pre-training layer 0, epoch 57, cost -71.5033890762
Pre-training layer 0, epoch 58, cost -71.3400140915
Pre-training layer 0, epoch 59, cost -71.2924498215
Pre-training layer 0, epoch 60, cost -71.2590463181
Pre-training layer 0, epoch 60, representative training free energy -233.139302856
Pre-training layer 0, epoch 60, validation free energy -219.059928497
Pre-training layer 0, epoch 61, cost -71.1361313171
Pre-training layer 0, epoch 62, cost -71.1548232193
Pre-training layer 0, epoch 63, cost -71.0788189926
Pre-training layer 0, epoch 64, cost -71.0511131058
Pre-training layer 0, epoch 65, cost -70.8587164612
Pre-training layer 0, epoch 65, representative training free energy -227.610913228
Pre-training layer 0, epoch 65, validation free energy -213.47379425
Pre-training layer 0, epoch 66, cost -70.8503789063
Pre-training layer 0, epoch 67, cost -70.837719101
Pre-training layer 0, epoch 68, cost -70.740945549
Pre-training layer 0, epoch 69, cost -70.6730715866
Pre-training layer 0, epoch 70, cost -70.5824491425
Pre-training layer 0, epoch 70, representative training free energy -226.916682017
Pre-training layer 0, epoch 70, validation free energy -212.892606801
Pre-training layer 0, epoch 71, cost -70.5055769196
Pre-training layer 0, epoch 72, cost -70.5456384506
Pre-training layer 0, epoch 73, cost -70.4262007446
Pre-training layer 0, epoch 74, cost -70.4043789749
Pre-training layer 0, epoch 75, cost -70.3004315109
Pre-training layer 0, epoch 75, representative training free energy -221.784994456
Pre-training layer 0, epoch 75, validation free energy -207.83066714
Pre-training layer 0, epoch 76, cost -70.3566918411
Pre-training layer 0, epoch 77, cost -70.3104251099
Pre-training layer 0, epoch 78, cost -70.228551178
Pre-training layer 0, epoch 79, cost -70.192573143
Pre-training layer 0, epoch 80, cost -70.0044789124
Pre-training layer 0, epoch 80, representative training free energy -219.581671692
Pre-training layer 0, epoch 80, validation free energy -204.531263855
Pre-training layer 0, epoch 81, cost -70.0435789032
Pre-training layer 0, epoch 82, cost -69.982328125
Pre-training layer 0, epoch 83, cost -70.0056553497
Pre-training layer 0, epoch 84, cost -69.9130049133
Pre-training layer 0, epoch 85, cost -69.8522768936
Pre-training layer 0, epoch 85, representative training free energy -218.128559814
Pre-training layer 0, epoch 85, validation free energy -202.219836639
Pre-training layer 0, epoch 86, cost -69.8270957031
Pre-training layer 0, epoch 87, cost -69.7613562393
Pre-training layer 0, epoch 88, cost -69.7009502029
Pre-training layer 0, epoch 89, cost -69.6689225235
Pre-training layer 0, epoch 90, cost -69.6732496109
Pre-training layer 0, epoch 90, representative training free energy -211.06718397
Pre-training layer 0, epoch 90, validation free energy -196.089117996
Pre-training layer 0, epoch 91, cost -69.5842941284
Pre-training layer 0, epoch 92, cost -69.5685144043
Pre-training layer 0, epoch 93, cost -69.4885169144
Pre-training layer 0, epoch 94, cost -69.5330436859
Pre-training layer 0, epoch 95, cost -69.4158987656
Pre-training layer 0, epoch 95, representative training free energy -210.65728299
Pre-training layer 0, epoch 95, validation free energy -195.642583603
Pre-training layer 0, epoch 96, cost -69.4420020065
Pre-training layer 0, epoch 97, cost -69.3840136795
Pre-training layer 0, epoch 98, cost -69.3323342285
Pre-training layer 0, epoch 99, cost -69.2999746933
Pre-training layer 1, epoch 0, cost -110.584069366
Pre-training layer 1, epoch 0, representative training free energy -336771.431568
Pre-training layer 1, epoch 0, validation free energy -335815.907375
Pre-training layer 1, epoch 1, cost -86.3084457932
Pre-training layer 1, epoch 2, cost -80.286673439
Pre-training layer 1, epoch 3, cost -76.9253759308
Pre-training layer 1, epoch 4, cost -74.6025580215
Pre-training layer 1, epoch 5, cost -72.8680662231
Pre-training layer 1, epoch 5, representative training free energy -447263.331375
Pre-training layer 1, epoch 5, validation free energy -445935.17549
Pre-training layer 1, epoch 6, cost -71.5330846558
Pre-training layer 1, epoch 7, cost -70.3962281647
Pre-training layer 1, epoch 8, cost -69.6188692551
Pre-training layer 1, epoch 9, cost -68.7853140945
Pre-training layer 1, epoch 10, cost -68.152957222
Pre-training layer 1, epoch 10, representative training free energy -497922.221708
Pre-training layer 1, epoch 10, validation free energy -496602.231688
Pre-training layer 1, epoch 11, cost -67.630743721
Pre-training layer 1, epoch 12, cost -67.1179804993
Pre-training layer 1, epoch 13, cost -66.6343571701
Pre-training layer 1, epoch 14, cost -66.2213027878
Pre-training layer 1, epoch 15, cost -65.66615979
Pre-training layer 1, epoch 15, representative training free energy -533622.085083
Pre-training layer 1, epoch 15, validation free energy -532326.754229
Pre-training layer 1, epoch 16, cost -65.4594130554
Pre-training layer 1, epoch 17, cost -65.2037904968
Pre-training layer 1, epoch 18, cost -64.7850688477
Pre-training layer 1, epoch 19, cost -64.5453191223
Pre-training layer 1, epoch 20, cost -64.2237978058
Pre-training layer 1, epoch 20, representative training free energy -560700.493979
Pre-training layer 1, epoch 20, validation free energy -559416.027219
Pre-training layer 1, epoch 21, cost -64.0483451385
Pre-training layer 1, epoch 22, cost -63.9077413864
Pre-training layer 1, epoch 23, cost -63.6333883209
Pre-training layer 1, epoch 24, cost -63.4591936264
Pre-training layer 1, epoch 25, cost -63.2732213974
Pre-training layer 1, epoch 25, representative training free energy -582850.871167
Pre-training layer 1, epoch 25, validation free energy -581509.309146
Pre-training layer 1, epoch 26, cost -63.0337136917
Pre-training layer 1, epoch 27, cost -62.8565080719
Pre-training layer 1, epoch 28, cost -62.7554303284
Pre-training layer 1, epoch 29, cost -62.6298097458
Pre-training layer 1, epoch 30, cost -62.4209185104
Pre-training layer 1, epoch 30, representative training free energy -602055.184833
Pre-training layer 1, epoch 30, validation free energy -600679.201219
Pre-training layer 1, epoch 31, cost -62.351209198
Pre-training layer 1, epoch 32, cost -62.1457201691
Pre-training layer 1, epoch 33, cost -62.1000112114
Pre-training layer 1, epoch 34, cost -61.9880109329
Pre-training layer 1, epoch 35, cost -61.8011937408
Pre-training layer 1, epoch 35, representative training free energy -619152.075302
Pre-training layer 1, epoch 35, validation free energy -617823.317635
Pre-training layer 1, epoch 36, cost -61.6812325287
Pre-training layer 1, epoch 37, cost -61.6638426819
Pre-training layer 1, epoch 38, cost -61.5804079628
Pre-training layer 1, epoch 39, cost -61.3699558029
Pre-training layer 1, epoch 40, cost -61.3278490143
Pre-training layer 1, epoch 40, representative training free energy -634083.117875
Pre-training layer 1, epoch 40, validation free energy -632662.794594
Pre-training layer 1, epoch 41, cost -61.1755437393
Pre-training layer 1, epoch 42, cost -61.1492406464
Pre-training layer 1, epoch 43, cost -61.044856411
Pre-training layer 1, epoch 44, cost -61.0139744492
Pre-training layer 1, epoch 45, cost -60.8508793182
Pre-training layer 1, epoch 45, representative training free energy -647738.177208
Pre-training layer 1, epoch 45, validation free energy -646365.402583
Pre-training layer 1, epoch 46, cost -60.9092957535
Pre-training layer 1, epoch 47, cost -60.7427826614
Pre-training layer 1, epoch 48, cost -60.6820944633
Pre-training layer 1, epoch 49, cost -60.6505469971
Pre-training layer 1, epoch 50, cost -60.5881459503
Pre-training layer 1, epoch 50, representative training free energy -660968.312
Pre-training layer 1, epoch 50, validation free energy -659493.10224
Pre-training layer 1, epoch 51, cost -60.5224137955
Pre-training layer 1, epoch 52, cost -60.4336373863
Pre-training layer 1, epoch 53, cost -60.3399025574
Pre-training layer 1, epoch 54, cost -60.3350775566
Pre-training layer 1, epoch 55, cost -60.2810422325
Pre-training layer 1, epoch 55, representative training free energy -671747.833125
Pre-training layer 1, epoch 55, validation free energy -670268.883594
Pre-training layer 1, epoch 56, cost -60.1342917633
Pre-training layer 1, epoch 57, cost -60.1179063377
Pre-training layer 1, epoch 58, cost -60.1240864792
Pre-training layer 1, epoch 59, cost -60.0054867935
Pre-training layer 1, epoch 60, cost -59.8864449883
Pre-training layer 1, epoch 60, representative training free energy -682574.224354
Pre-training layer 1, epoch 60, validation free energy -681069.727594
Pre-training layer 1, epoch 61, cost -59.9147237854
Pre-training layer 1, epoch 62, cost -59.8806029358
Pre-training layer 1, epoch 63, cost -59.8205178871
Pre-training layer 1, epoch 64, cost -59.7465430946
Pre-training layer 1, epoch 65, cost -59.7494363098
Pre-training layer 1, epoch 65, representative training free energy -692862.631583
Pre-training layer 1, epoch 65, validation free energy -691429.075333
Pre-training layer 1, epoch 66, cost -59.6926859818
Pre-training layer 1, epoch 67, cost -59.6217864914
Pre-training layer 1, epoch 68, cost -59.6215147095
Pre-training layer 1, epoch 69, cost -59.5603488121
Pre-training layer 1, epoch 70, cost -59.5479770317
Pre-training layer 1, epoch 70, representative training free energy -701202.727177
Pre-training layer 1, epoch 70, validation free energy -699685.20699
Pre-training layer 1, epoch 71, cost -59.4498100662
Pre-training layer 1, epoch 72, cost -59.4616146927
Pre-training layer 1, epoch 73, cost -59.35288554
Pre-training layer 1, epoch 74, cost -59.2975306168
Pre-training layer 1, epoch 75, cost -59.3226250763
Pre-training layer 1, epoch 75, representative training free energy -710419.1655
Pre-training layer 1, epoch 75, validation free energy -708868.01226
Pre-training layer 1, epoch 76, cost -59.2677569885
Pre-training layer 1, epoch 77, cost -59.1799666557
Pre-training layer 1, epoch 78, cost -59.2101173401
Pre-training layer 1, epoch 79, cost -59.1211924286
Pre-training layer 1, epoch 80, cost -59.0861228981
Pre-training layer 1, epoch 80, representative training free energy -718558.520594
Pre-training layer 1, epoch 80, validation free energy -716996.308875
Pre-training layer 1, epoch 81, cost -59.0401145706
Pre-training layer 1, epoch 82, cost -59.0742390366
Pre-training layer 1, epoch 83, cost -58.9957414894
Pre-training layer 1, epoch 84, cost -58.9998012428
Pre-training layer 1, epoch 85, cost -58.9573897781
Pre-training layer 1, epoch 85, representative training free energy -725540.888437
Pre-training layer 1, epoch 85, validation free energy -723983.359365
Pre-training layer 1, epoch 86, cost -59.0068831291
Pre-training layer 1, epoch 87, cost -58.9834163361
Pre-training layer 1, epoch 88, cost -58.8956669846
Pre-training layer 1, epoch 89, cost -58.8521163254
Pre-training layer 1, epoch 90, cost -58.8019656181
Pre-training layer 1, epoch 90, representative training free energy -733279.463594
Pre-training layer 1, epoch 90, validation free energy -731683.562052
Pre-training layer 1, epoch 91, cost -58.7860526009
Pre-training layer 1, epoch 92, cost -58.8170000458
Pre-training layer 1, epoch 93, cost -58.76474897
Pre-training layer 1, epoch 94, cost -58.68958004
Pre-training layer 1, epoch 95, cost -58.6327145004
Pre-training layer 1, epoch 95, representative training free energy -740118.420052
Pre-training layer 1, epoch 95, validation free energy -738538.89399
Pre-training layer 1, epoch 96, cost -58.6279642944
Pre-training layer 1, epoch 97, cost -58.6161947556
Pre-training layer 1, epoch 98, cost -58.6097633743
Pre-training layer 1, epoch 99, cost -58.5963851013
Pre-training layer 2, epoch 0, cost -90.1758259354
Pre-training layer 2, epoch 0, representative training free energy 44492.0542832
Pre-training layer 2, epoch 0, validation free energy 44380.9605443
Pre-training layer 2, epoch 1, cost -66.8997176208
Pre-training layer 2, epoch 2, cost -61.9182097092
Pre-training layer 2, epoch 3, cost -59.3611371384
Pre-training layer 2, epoch 4, cost -57.5796868973
Pre-training layer 2, epoch 5, cost -56.4616626663
Pre-training layer 2, epoch 5, representative training free energy 140578.980229
Pre-training layer 2, epoch 5, validation free energy 140421.422661
Pre-training layer 2, epoch 6, cost -55.5614893417
Pre-training layer 2, epoch 7, cost -54.728658905
Pre-training layer 2, epoch 8, cost -54.0915860138
Pre-training layer 2, epoch 9, cost -53.6275960999
Pre-training layer 2, epoch 10, cost -53.0778697662
Pre-training layer 2, epoch 10, representative training free energy 186064.230164
Pre-training layer 2, epoch 10, validation free energy 185958.888172
Pre-training layer 2, epoch 11, cost -52.7147096405
Pre-training layer 2, epoch 12, cost -52.3331333542
Pre-training layer 2, epoch 13, cost -52.0523760757
Pre-training layer 2, epoch 14, cost -51.7410042267
Pre-training layer 2, epoch 15, cost -51.4523580475
Pre-training layer 2, epoch 15, representative training free energy 212942.401703
Pre-training layer 2, epoch 15, validation free energy 212849.476917
Pre-training layer 2, epoch 16, cost -51.1989225388
Pre-training layer 2, epoch 17, cost -51.005521637
Pre-training layer 2, epoch 18, cost -50.8194641647
Pre-training layer 2, epoch 19, cost -50.6730030518
Pre-training layer 2, epoch 20, cost -50.4465830536
Pre-training layer 2, epoch 20, representative training free energy 232544.509807
Pre-training layer 2, epoch 20, validation free energy 232480.439417
Pre-training layer 2, epoch 21, cost -50.2298312378
Pre-training layer 2, epoch 22, cost -50.087718071
Pre-training layer 2, epoch 23, cost -49.9771022339
Pre-training layer 2, epoch 24, cost -49.8614150772
Pre-training layer 2, epoch 25, cost -49.6966058807
Pre-training layer 2, epoch 25, representative training free energy 248719.383031
Pre-training layer 2, epoch 25, validation free energy 248711.617302
Pre-training layer 2, epoch 26, cost -49.5704052658
Pre-training layer 2, epoch 27, cost -49.4244728317
Pre-training layer 2, epoch 28, cost -49.3665590515
Pre-training layer 2, epoch 29, cost -49.2717566986
Pre-training layer 2, epoch 30, cost -49.1347617798
Pre-training layer 2, epoch 30, representative training free energy 259841.281693
Pre-training layer 2, epoch 30, validation free energy 259829.303615
Pre-training layer 2, epoch 31, cost -49.0044857864
Pre-training layer 2, epoch 32, cost -48.9727145309
Pre-training layer 2, epoch 33, cost -48.9232628479
Pre-training layer 2, epoch 34, cost -48.7445662842
Pre-training layer 2, epoch 35, cost -48.6928162079
Pre-training layer 2, epoch 35, representative training free energy 271008.84125
Pre-training layer 2, epoch 35, validation free energy 270991.423401
Pre-training layer 2, epoch 36, cost -48.699536438
Pre-training layer 2, epoch 37, cost -48.5603903732
Pre-training layer 2, epoch 38, cost -48.5237901688
Pre-training layer 2, epoch 39, cost -48.4154009705
Pre-training layer 2, epoch 40, cost -48.3375027237
Pre-training layer 2, epoch 40, representative training free energy 280249.461068
Pre-training layer 2, epoch 40, validation free energy 280268.729552
Pre-training layer 2, epoch 41, cost -48.2994186707
Pre-training layer 2, epoch 42, cost -48.206539917
Pre-training layer 2, epoch 43, cost -48.1053190689
Pre-training layer 2, epoch 44, cost -48.0937361069
Pre-training layer 2, epoch 45, cost -48.0054476318
Pre-training layer 2, epoch 45, representative training free energy 287520.179745
Pre-training layer 2, epoch 45, validation free energy 287537.655318
Pre-training layer 2, epoch 46, cost -48.0387006912
Pre-training layer 2, epoch 47, cost -47.9376332016
Pre-training layer 2, epoch 48, cost -47.910279953
Pre-training layer 2, epoch 49, cost -47.8278462524
Pre-training layer 2, epoch 50, cost -47.8105960693
Pre-training layer 2, epoch 50, representative training free energy 294404.005286
Pre-training layer 2, epoch 50, validation free energy 294445.256271
Pre-training layer 2, epoch 51, cost -47.7505051422
Pre-training layer 2, epoch 52, cost -47.7112954559
Pre-training layer 2, epoch 53, cost -47.6596996841
Pre-training layer 2, epoch 54, cost -47.620715683
Pre-training layer 2, epoch 55, cost -47.5407786865
Pre-training layer 2, epoch 55, representative training free energy 299591.406943
Pre-training layer 2, epoch 55, validation free energy 299634.468182
Pre-training layer 2, epoch 56, cost -47.5320595398
Pre-training layer 2, epoch 57, cost -47.4831776047
Pre-training layer 2, epoch 58, cost -47.4276406097
Pre-training layer 2, epoch 59, cost -47.3761081467
Pre-training layer 2, epoch 60, cost -47.3399776917
Pre-training layer 2, epoch 60, representative training free energy 304393.363849
Pre-training layer 2, epoch 60, validation free energy 304505.359422
Pre-training layer 2, epoch 61, cost -47.32529496
Pre-training layer 2, epoch 62, cost -47.3081385727
Pre-training layer 2, epoch 63, cost -47.2232770615
Pre-training layer 2, epoch 64, cost -47.2006134109
Pre-training layer 2, epoch 65, cost -47.180656395
Pre-training layer 2, epoch 65, representative training free energy 308179.351458
Pre-training layer 2, epoch 65, validation free energy 308233.848479
Pre-training layer 2, epoch 66, cost -47.192926445
Pre-training layer 2, epoch 67, cost -47.1582202835
Pre-training layer 2, epoch 68, cost -47.0632869339
Pre-training layer 2, epoch 69, cost -47.0508822021
Pre-training layer 2, epoch 70, cost -46.9659598846
Pre-training layer 2, epoch 70, representative training free energy 311854.00912
Pre-training layer 2, epoch 70, validation free energy 311930.930031
Pre-training layer 2, epoch 71, cost -46.9417735138
Pre-training layer 2, epoch 72, cost -46.9558977509
Pre-training layer 2, epoch 73, cost -46.9300971909
Pre-training layer 2, epoch 74, cost -46.9247226715
Pre-training layer 2, epoch 75, cost -46.8804913559
Pre-training layer 2, epoch 75, representative training free energy 316504.493099
Pre-training layer 2, epoch 75, validation free energy 316608.010474
Pre-training layer 2, epoch 76, cost -46.8897820435
Pre-training layer 2, epoch 77, cost -46.8426574326
Pre-training layer 2, epoch 78, cost -46.8158240967
Pre-training layer 2, epoch 79, cost -46.7826661606
Pre-training layer 2, epoch 80, cost -46.7271719666
Pre-training layer 2, epoch 80, representative training free energy 319058.224375
Pre-training layer 2, epoch 80, validation free energy 319116.663281
Pre-training layer 2, epoch 81, cost -46.7630520706
Pre-training layer 2, epoch 82, cost -46.7479465561
Pre-training layer 2, epoch 83, cost -46.6744427795
Pre-training layer 2, epoch 84, cost -46.6546511612
Pre-training layer 2, epoch 85, cost -46.662331665
Pre-training layer 2, epoch 85, representative training free energy 323036.817354
Pre-training layer 2, epoch 85, validation free energy 323093.263943
Pre-training layer 2, epoch 86, cost -46.5905646439
Pre-training layer 2, epoch 87, cost -46.5620206451
Pre-training layer 2, epoch 88, cost -46.5303887253
Pre-training layer 2, epoch 89, cost -46.5108893127
Pre-training layer 2, epoch 90, cost -46.4863880844
Pre-training layer 2, epoch 90, representative training free energy 324881.934568
Pre-training layer 2, epoch 90, validation free energy 324981.109453
Pre-training layer 2, epoch 91, cost -46.5036327209
Pre-training layer 2, epoch 92, cost -46.527999855
Pre-training layer 2, epoch 93, cost -46.4451179428
Pre-training layer 2, epoch 94, cost -46.4125014954
Pre-training layer 2, epoch 95, cost -46.3976883621
Pre-training layer 2, epoch 95, representative training free energy 327867.876651
Pre-training layer 2, epoch 95, validation free energy 327939.79076
Pre-training layer 2, epoch 96, cost -46.4282329941
Pre-training layer 2, epoch 97, cost -46.378391346
Pre-training layer 2, epoch 98, cost -46.359905838
Pre-training layer 2, epoch 99, cost -46.3086148911
The pretraining code for file dbn_loop.pyc ran for 4.69m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 12.400000 %
     epoch 1, minibatch 500/500, test error of best model 14.933333 %
epoch 2, minibatch 500/500, validation error 8.400000 %
     epoch 2, minibatch 500/500, test error of best model 10.600000 %
epoch 3, minibatch 500/500, validation error 7.200000 %
     epoch 3, minibatch 500/500, test error of best model 8.533333 %
epoch 4, minibatch 500/500, validation error 6.600000 %
     epoch 4, minibatch 500/500, test error of best model 7.733333 %
epoch 5, minibatch 500/500, validation error 6.133333 %
     epoch 5, minibatch 500/500, test error of best model 7.133333 %
epoch 6, minibatch 500/500, validation error 5.800000 %
     epoch 6, minibatch 500/500, test error of best model 6.666667 %
epoch 7, minibatch 500/500, validation error 5.666667 %
     epoch 7, minibatch 500/500, test error of best model 6.533333 %
epoch 8, minibatch 500/500, validation error 5.200000 %
     epoch 8, minibatch 500/500, test error of best model 6.333333 %
epoch 9, minibatch 500/500, validation error 5.133333 %
     epoch 9, minibatch 500/500, test error of best model 6.333333 %
epoch 10, minibatch 500/500, validation error 4.933333 %
     epoch 10, minibatch 500/500, test error of best model 6.266667 %
epoch 11, minibatch 500/500, validation error 4.800000 %
     epoch 11, minibatch 500/500, test error of best model 6.200000 %
epoch 12, minibatch 500/500, validation error 4.800000 %
epoch 13, minibatch 500/500, validation error 4.800000 %
epoch 14, minibatch 500/500, validation error 4.733333 %
     epoch 14, minibatch 500/500, test error of best model 6.133333 %
epoch 15, minibatch 500/500, validation error 4.733333 %
epoch 16, minibatch 500/500, validation error 4.666667 %
     epoch 16, minibatch 500/500, test error of best model 6.133333 %
epoch 17, minibatch 500/500, validation error 4.666667 %
epoch 18, minibatch 500/500, validation error 4.533333 %
     epoch 18, minibatch 500/500, test error of best model 5.933333 %
epoch 19, minibatch 500/500, validation error 4.466667 %
     epoch 19, minibatch 500/500, test error of best model 5.933333 %
epoch 20, minibatch 500/500, validation error 4.600000 %
epoch 21, minibatch 500/500, validation error 4.533333 %
epoch 22, minibatch 500/500, validation error 4.533333 %
epoch 23, minibatch 500/500, validation error 4.533333 %
epoch 24, minibatch 500/500, validation error 4.533333 %
epoch 25, minibatch 500/500, validation error 4.466667 %
epoch 26, minibatch 500/500, validation error 4.466667 %
epoch 27, minibatch 500/500, validation error 4.466667 %
epoch 28, minibatch 500/500, validation error 4.466667 %
epoch 29, minibatch 500/500, validation error 4.466667 %
epoch 30, minibatch 500/500, validation error 4.466667 %
epoch 31, minibatch 500/500, validation error 4.466667 %
epoch 32, minibatch 500/500, validation error 4.466667 %
epoch 33, minibatch 500/500, validation error 4.400000 %
     epoch 33, minibatch 500/500, test error of best model 5.600000 %
epoch 34, minibatch 500/500, validation error 4.400000 %
epoch 35, minibatch 500/500, validation error 4.400000 %
     epoch 35, minibatch 500/500, test error of best model 5.600000 %
epoch 36, minibatch 500/500, validation error 4.400000 %
epoch 37, minibatch 500/500, validation error 4.400000 %
epoch 38, minibatch 500/500, validation error 4.333333 %
     epoch 38, minibatch 500/500, test error of best model 5.666667 %
epoch 39, minibatch 500/500, validation error 4.333333 %
epoch 40, minibatch 500/500, validation error 4.333333 %
epoch 41, minibatch 500/500, validation error 4.333333 %
epoch 42, minibatch 500/500, validation error 4.333333 %
epoch 43, minibatch 500/500, validation error 4.333333 %
epoch 44, minibatch 500/500, validation error 4.333333 %
epoch 45, minibatch 500/500, validation error 4.333333 %
epoch 46, minibatch 500/500, validation error 4.333333 %
epoch 47, minibatch 500/500, validation error 4.266667 %
     epoch 47, minibatch 500/500, test error of best model 5.600000 %
epoch 48, minibatch 500/500, validation error 4.200000 %
     epoch 48, minibatch 500/500, test error of best model 5.600000 %
epoch 49, minibatch 500/500, validation error 4.200000 %
epoch 50, minibatch 500/500, validation error 4.200000 %
epoch 51, minibatch 500/500, validation error 4.200000 %
epoch 52, minibatch 500/500, validation error 4.266667 %
epoch 53, minibatch 500/500, validation error 4.266667 %
epoch 54, minibatch 500/500, validation error 4.266667 %
epoch 55, minibatch 500/500, validation error 4.266667 %
epoch 56, minibatch 500/500, validation error 4.266667 %
epoch 57, minibatch 500/500, validation error 4.266667 %
epoch 58, minibatch 500/500, validation error 4.266667 %
epoch 59, minibatch 500/500, validation error 4.266667 %
epoch 60, minibatch 500/500, validation error 4.266667 %
epoch 61, minibatch 500/500, validation error 4.200000 %
epoch 62, minibatch 500/500, validation error 4.200000 %
epoch 63, minibatch 500/500, validation error 4.200000 %
epoch 64, minibatch 500/500, validation error 4.200000 %
epoch 65, minibatch 500/500, validation error 4.200000 %
epoch 66, minibatch 500/500, validation error 4.200000 %
epoch 67, minibatch 500/500, validation error 4.200000 %
epoch 68, minibatch 500/500, validation error 4.200000 %
epoch 69, minibatch 500/500, validation error 4.200000 %
epoch 70, minibatch 500/500, validation error 4.200000 %
epoch 71, minibatch 500/500, validation error 4.200000 %
epoch 72, minibatch 500/500, validation error 4.200000 %
epoch 73, minibatch 500/500, validation error 4.200000 %
epoch 74, minibatch 500/500, validation error 4.200000 %
epoch 75, minibatch 500/500, validation error 4.200000 %
epoch 76, minibatch 500/500, validation error 4.200000 %
epoch 77, minibatch 500/500, validation error 4.200000 %
epoch 78, minibatch 500/500, validation error 4.200000 %
epoch 79, minibatch 500/500, validation error 4.200000 %
epoch 80, minibatch 500/500, validation error 4.200000 %
epoch 81, minibatch 500/500, validation error 4.200000 %
epoch 82, minibatch 500/500, validation error 4.200000 %
epoch 83, minibatch 500/500, validation error 4.200000 %
epoch 84, minibatch 500/500, validation error 4.200000 %
epoch 85, minibatch 500/500, validation error 4.200000 %
epoch 86, minibatch 500/500, validation error 4.200000 %
epoch 87, minibatch 500/500, validation error 4.200000 %
epoch 88, minibatch 500/500, validation error 4.200000 %
epoch 89, minibatch 500/500, validation error 4.200000 %
epoch 90, minibatch 500/500, validation error 4.200000 %
epoch 91, minibatch 500/500, validation error 4.200000 %
epoch 92, minibatch 500/500, validation error 4.200000 %
epoch 93, minibatch 500/500, validation error 4.200000 %
epoch 94, minibatch 500/500, validation error 4.200000 %
epoch 95, minibatch 500/500, validation error 4.200000 %
Optimization complete with best validation score of 4.200000 %, obtained at iteration 24000, with test performance 5.600000 %
The fine tuning code for file dbn_loop.pyc ran for 2.02m


==========Sample Size: (5000, 2000, 2000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -119.848663742
Pre-training layer 0, epoch 0, representative training free energy -255.240092667
Pre-training layer 0, epoch 0, validation free energy -251.768105133
Pre-training layer 0, epoch 1, cost -95.5819584808
Pre-training layer 0, epoch 2, cost -90.3418432617
Pre-training layer 0, epoch 3, cost -87.340200798
Pre-training layer 0, epoch 4, cost -85.3458759995
Pre-training layer 0, epoch 5, cost -83.7895573654
Pre-training layer 0, epoch 5, representative training free energy -266.006342194
Pre-training layer 0, epoch 5, validation free energy -259.320968529
Pre-training layer 0, epoch 6, cost -82.6536775894
Pre-training layer 0, epoch 7, cost -81.7221459274
Pre-training layer 0, epoch 8, cost -81.0324534836
Pre-training layer 0, epoch 9, cost -80.2612486496
Pre-training layer 0, epoch 10, cost -79.6991604996
Pre-training layer 0, epoch 10, representative training free energy -267.360325111
Pre-training layer 0, epoch 10, validation free energy -258.72562838
Pre-training layer 0, epoch 11, cost -79.1077981415
Pre-training layer 0, epoch 12, cost -78.6203183746
Pre-training layer 0, epoch 13, cost -78.2579391403
Pre-training layer 0, epoch 14, cost -77.8443824615
Pre-training layer 0, epoch 15, cost -77.4574957352
Pre-training layer 0, epoch 15, representative training free energy -264.823514427
Pre-training layer 0, epoch 15, validation free energy -255.695493721
Pre-training layer 0, epoch 16, cost -77.2646315765
Pre-training layer 0, epoch 17, cost -76.8325641785
Pre-training layer 0, epoch 18, cost -76.5561625519
Pre-training layer 0, epoch 19, cost -76.4066310959
Pre-training layer 0, epoch 20, cost -76.0522230377
Pre-training layer 0, epoch 20, representative training free energy -262.517903015
Pre-training layer 0, epoch 20, validation free energy -252.377544937
Pre-training layer 0, epoch 21, cost -75.8967469025
Pre-training layer 0, epoch 22, cost -75.6166536331
Pre-training layer 0, epoch 23, cost -75.5372687531
Pre-training layer 0, epoch 24, cost -75.423819519
Pre-training layer 0, epoch 25, cost -75.1173536987
Pre-training layer 0, epoch 25, representative training free energy -260.571436272
Pre-training layer 0, epoch 25, validation free energy -249.629979637
Pre-training layer 0, epoch 26, cost -74.9816570892
Pre-training layer 0, epoch 27, cost -74.7387879791
Pre-training layer 0, epoch 28, cost -74.6340425491
Pre-training layer 0, epoch 29, cost -74.4741099548
Pre-training layer 0, epoch 30, cost -74.297635376
Pre-training layer 0, epoch 30, representative training free energy -255.998935791
Pre-training layer 0, epoch 30, validation free energy -244.277653557
Pre-training layer 0, epoch 31, cost -74.1000141602
Pre-training layer 0, epoch 32, cost -74.0257593994
Pre-training layer 0, epoch 33, cost -73.9081717453
Pre-training layer 0, epoch 34, cost -73.8436848831
Pre-training layer 0, epoch 35, cost -73.6834871063
Pre-training layer 0, epoch 35, representative training free energy -249.189613144
Pre-training layer 0, epoch 35, validation free energy -237.52293412
Pre-training layer 0, epoch 36, cost -73.5224340973
Pre-training layer 0, epoch 37, cost -73.3935403137
Pre-training layer 0, epoch 38, cost -73.3190618362
Pre-training layer 0, epoch 39, cost -73.1235248871
Pre-training layer 0, epoch 40, cost -73.0966171875
Pre-training layer 0, epoch 40, representative training free energy -247.020617889
Pre-training layer 0, epoch 40, validation free energy -234.318595501
Pre-training layer 0, epoch 41, cost -73.0346478348
Pre-training layer 0, epoch 42, cost -72.9165828629
Pre-training layer 0, epoch 43, cost -72.8817091293
Pre-training layer 0, epoch 44, cost -72.6681190414
Pre-training layer 0, epoch 45, cost -72.6135067444
Pre-training layer 0, epoch 45, representative training free energy -245.104164429
Pre-training layer 0, epoch 45, validation free energy -232.096616993
Pre-training layer 0, epoch 46, cost -72.5837596436
Pre-training layer 0, epoch 47, cost -72.3554318314
Pre-training layer 0, epoch 48, cost -72.28915448
Pre-training layer 0, epoch 49, cost -72.2803234024
Pre-training layer 0, epoch 50, cost -72.1293802109
Pre-training layer 0, epoch 50, representative training free energy -238.440169098
Pre-training layer 0, epoch 50, validation free energy -225.134333206
Pre-training layer 0, epoch 51, cost -72.0511096878
Pre-training layer 0, epoch 52, cost -72.0683543549
Pre-training layer 0, epoch 53, cost -71.9481735153
Pre-training layer 0, epoch 54, cost -71.9017681274
Pre-training layer 0, epoch 55, cost -71.784657341
Pre-training layer 0, epoch 55, representative training free energy -242.937636414
Pre-training layer 0, epoch 55, validation free energy -228.398883274
Pre-training layer 0, epoch 56, cost -71.7986252518
Pre-training layer 0, epoch 57, cost -71.6872520142
Pre-training layer 0, epoch 58, cost -71.5821447678
Pre-training layer 0, epoch 59, cost -71.5503576508
Pre-training layer 0, epoch 60, cost -71.5372363434
Pre-training layer 0, epoch 60, representative training free energy -232.259129608
Pre-training layer 0, epoch 60, validation free energy -218.146259056
Pre-training layer 0, epoch 61, cost -71.5433251953
Pre-training layer 0, epoch 62, cost -71.306731102
Pre-training layer 0, epoch 63, cost -71.2879403687
Pre-training layer 0, epoch 64, cost -71.161352623
Pre-training layer 0, epoch 65, cost -71.175690918
Pre-training layer 0, epoch 65, representative training free energy -233.272508156
Pre-training layer 0, epoch 65, validation free energy -218.932169334
Pre-training layer 0, epoch 66, cost -71.0394197845
Pre-training layer 0, epoch 67, cost -71.0658134384
Pre-training layer 0, epoch 68, cost -70.8841322021
Pre-training layer 0, epoch 69, cost -70.7897502213
Pre-training layer 0, epoch 70, cost -70.8227691879
Pre-training layer 0, epoch 70, representative training free energy -227.671863144
Pre-training layer 0, epoch 70, validation free energy -213.131680958
Pre-training layer 0, epoch 71, cost -70.7873694916
Pre-training layer 0, epoch 72, cost -70.7110204086
Pre-training layer 0, epoch 73, cost -70.7030633011
Pre-training layer 0, epoch 74, cost -70.5518824615
Pre-training layer 0, epoch 75, cost -70.5833433228
Pre-training layer 0, epoch 75, representative training free energy -229.779568596
Pre-training layer 0, epoch 75, validation free energy -214.201682636
Pre-training layer 0, epoch 76, cost -70.3976504059
Pre-training layer 0, epoch 77, cost -70.4025413818
Pre-training layer 0, epoch 78, cost -70.4308290634
Pre-training layer 0, epoch 79, cost -70.2437952805
Pre-training layer 0, epoch 80, cost -70.1703094559
Pre-training layer 0, epoch 80, representative training free energy -224.171944084
Pre-training layer 0, epoch 80, validation free energy -208.469915592
Pre-training layer 0, epoch 81, cost -70.1984197083
Pre-training layer 0, epoch 82, cost -70.1803550949
Pre-training layer 0, epoch 83, cost -70.1023411026
Pre-training layer 0, epoch 84, cost -70.090796463
Pre-training layer 0, epoch 85, cost -70.0226924438
Pre-training layer 0, epoch 85, representative training free energy -219.948125694
Pre-training layer 0, epoch 85, validation free energy -204.129692787
Pre-training layer 0, epoch 86, cost -69.9869387436
Pre-training layer 0, epoch 87, cost -69.9742337341
Pre-training layer 0, epoch 88, cost -69.98915345
Pre-training layer 0, epoch 89, cost -69.8702697601
Pre-training layer 0, epoch 90, cost -69.8199963989
Pre-training layer 0, epoch 90, representative training free energy -215.733619141
Pre-training layer 0, epoch 90, validation free energy -199.90196423
Pre-training layer 0, epoch 91, cost -69.6479654617
Pre-training layer 0, epoch 92, cost -69.5816752625
Pre-training layer 0, epoch 93, cost -69.6915290298
Pre-training layer 0, epoch 94, cost -69.6504221649
Pre-training layer 0, epoch 95, cost -69.5702429199
Pre-training layer 0, epoch 95, representative training free energy -213.869775589
Pre-training layer 0, epoch 95, validation free energy -197.809690521
Pre-training layer 0, epoch 96, cost -69.6029640656
Pre-training layer 0, epoch 97, cost -69.4565027924
Pre-training layer 0, epoch 98, cost -69.4896012497
Pre-training layer 0, epoch 99, cost -69.480039444
Pre-training layer 1, epoch 0, cost -112.713640732
Pre-training layer 1, epoch 0, representative training free energy -339373.645867
Pre-training layer 1, epoch 0, validation free energy -336823.954187
Pre-training layer 1, epoch 1, cost -88.2566642456
Pre-training layer 1, epoch 2, cost -82.2148159714
Pre-training layer 1, epoch 3, cost -78.8074084091
Pre-training layer 1, epoch 4, cost -76.3535677948
Pre-training layer 1, epoch 5, cost -74.6541202621
Pre-training layer 1, epoch 5, representative training free energy -445813.736102
Pre-training layer 1, epoch 5, validation free energy -442523.003277
Pre-training layer 1, epoch 6, cost -73.2844178543
Pre-training layer 1, epoch 7, cost -72.3587576904
Pre-training layer 1, epoch 8, cost -71.3455774307
Pre-training layer 1, epoch 9, cost -70.6058394623
Pre-training layer 1, epoch 10, cost -69.9689767303
Pre-training layer 1, epoch 10, representative training free energy -494665.375922
Pre-training layer 1, epoch 10, validation free energy -491206.317344
Pre-training layer 1, epoch 11, cost -69.3878498459
Pre-training layer 1, epoch 12, cost -68.8251556015
Pre-training layer 1, epoch 13, cost -68.2903440399
Pre-training layer 1, epoch 14, cost -67.8927060318
Pre-training layer 1, epoch 15, cost -67.5154550705
Pre-training layer 1, epoch 15, representative training free energy -528207.882445
Pre-training layer 1, epoch 15, validation free energy -524566.645242
Pre-training layer 1, epoch 16, cost -67.1953873291
Pre-training layer 1, epoch 17, cost -66.8900798111
Pre-training layer 1, epoch 18, cost -66.5787286072
Pre-training layer 1, epoch 19, cost -66.3006823196
Pre-training layer 1, epoch 20, cost -65.954915184
Pre-training layer 1, epoch 20, representative training free energy -554036.849164
Pre-training layer 1, epoch 20, validation free energy -550347.07325
Pre-training layer 1, epoch 21, cost -65.7861839294
Pre-training layer 1, epoch 22, cost -65.5026123123
Pre-training layer 1, epoch 23, cost -65.3015537491
Pre-training layer 1, epoch 24, cost -65.1397015686
Pre-training layer 1, epoch 25, cost -65.0185681763
Pre-training layer 1, epoch 25, representative training free energy -574512.180086
Pre-training layer 1, epoch 25, validation free energy -570774.12107
Pre-training layer 1, epoch 26, cost -64.8102698441
Pre-training layer 1, epoch 27, cost -64.6992841568
Pre-training layer 1, epoch 28, cost -64.436923111
Pre-training layer 1, epoch 29, cost -64.3461153107
Pre-training layer 1, epoch 30, cost -64.1957496033
Pre-training layer 1, epoch 30, representative training free energy -593335.935734
Pre-training layer 1, epoch 30, validation free energy -589526.52843
Pre-training layer 1, epoch 31, cost -64.0440069504
Pre-training layer 1, epoch 32, cost -63.872182106
Pre-training layer 1, epoch 33, cost -63.7316682358
Pre-training layer 1, epoch 34, cost -63.6181930466
Pre-training layer 1, epoch 35, cost -63.5191809311
Pre-training layer 1, epoch 35, representative training free energy -610219.425031
Pre-training layer 1, epoch 35, validation free energy -606324.281461
Pre-training layer 1, epoch 36, cost -63.4063015366
Pre-training layer 1, epoch 37, cost -63.3521388588
Pre-training layer 1, epoch 38, cost -63.1561773529
Pre-training layer 1, epoch 39, cost -63.0452309799
Pre-training layer 1, epoch 40, cost -62.9624297409
Pre-training layer 1, epoch 40, representative training free energy -624160.100406
Pre-training layer 1, epoch 40, validation free energy -620263.393937
Pre-training layer 1, epoch 41, cost -62.9602228508
Pre-training layer 1, epoch 42, cost -62.7573683968
Pre-training layer 1, epoch 43, cost -62.7587457581
Pre-training layer 1, epoch 44, cost -62.6279115219
Pre-training layer 1, epoch 45, cost -62.5969681244
Pre-training layer 1, epoch 45, representative training free energy -636769.313516
Pre-training layer 1, epoch 45, validation free energy -632792.618016
Pre-training layer 1, epoch 46, cost -62.4559671326
Pre-training layer 1, epoch 47, cost -62.4417181244
Pre-training layer 1, epoch 48, cost -62.3134900742
Pre-training layer 1, epoch 49, cost -62.2896400528
Pre-training layer 1, epoch 50, cost -62.2520228539
Pre-training layer 1, epoch 50, representative training free energy -648606.77768
Pre-training layer 1, epoch 50, validation free energy -644580.999336
Pre-training layer 1, epoch 51, cost -62.2189999084
Pre-training layer 1, epoch 52, cost -62.1021439972
Pre-training layer 1, epoch 53, cost -62.0874553146
Pre-training layer 1, epoch 54, cost -62.0472734528
Pre-training layer 1, epoch 55, cost -61.9784217453
Pre-training layer 1, epoch 55, representative training free energy -659454.746656
Pre-training layer 1, epoch 55, validation free energy -655331.833328
Pre-training layer 1, epoch 56, cost -61.8153400116
Pre-training layer 1, epoch 57, cost -61.7962801514
Pre-training layer 1, epoch 58, cost -61.7271334915
Pre-training layer 1, epoch 59, cost -61.6783343239
Pre-training layer 1, epoch 60, cost -61.7749459801
Pre-training layer 1, epoch 60, representative training free energy -669702.454766
Pre-training layer 1, epoch 60, validation free energy -665503.123312
Pre-training layer 1, epoch 61, cost -61.6358465004
Pre-training layer 1, epoch 62, cost -61.6413104324
Pre-training layer 1, epoch 63, cost -61.5260668716
Pre-training layer 1, epoch 64, cost -61.5377643089
Pre-training layer 1, epoch 65, cost -61.4523460121
Pre-training layer 1, epoch 65, representative training free energy -678004.578766
Pre-training layer 1, epoch 65, validation free energy -673786.194352
Pre-training layer 1, epoch 66, cost -61.4674881172
Pre-training layer 1, epoch 67, cost -61.3469743881
Pre-training layer 1, epoch 68, cost -61.3784603767
Pre-training layer 1, epoch 69, cost -61.3047125015
Pre-training layer 1, epoch 70, cost -61.2179056129
Pre-training layer 1, epoch 70, representative training free energy -687613.025875
Pre-training layer 1, epoch 70, validation free energy -683371.923148
Pre-training layer 1, epoch 71, cost -61.2416973305
Pre-training layer 1, epoch 72, cost -61.1539040794
Pre-training layer 1, epoch 73, cost -61.109449543
Pre-training layer 1, epoch 74, cost -61.0800203781
Pre-training layer 1, epoch 75, cost -61.0702506638
Pre-training layer 1, epoch 75, representative training free energy -695491.631273
Pre-training layer 1, epoch 75, validation free energy -691235.262594
Pre-training layer 1, epoch 76, cost -61.0652172012
Pre-training layer 1, epoch 77, cost -60.950908535
Pre-training layer 1, epoch 78, cost -60.9024667473
Pre-training layer 1, epoch 79, cost -60.8527498627
Pre-training layer 1, epoch 80, cost -60.9117544708
Pre-training layer 1, epoch 80, representative training free energy -703664.646898
Pre-training layer 1, epoch 80, validation free energy -699330.068711
Pre-training layer 1, epoch 81, cost -60.8267956352
Pre-training layer 1, epoch 82, cost -60.7939293594
Pre-training layer 1, epoch 83, cost -60.8149595947
Pre-training layer 1, epoch 84, cost -60.7161000443
Pre-training layer 1, epoch 85, cost -60.693288414
Pre-training layer 1, epoch 85, representative training free energy -711212.407734
Pre-training layer 1, epoch 85, validation free energy -706848.228805
Pre-training layer 1, epoch 86, cost -60.6977823486
Pre-training layer 1, epoch 87, cost -60.5857545929
Pre-training layer 1, epoch 88, cost -60.6196269073
Pre-training layer 1, epoch 89, cost -60.549755024
Pre-training layer 1, epoch 90, cost -60.6118634224
Pre-training layer 1, epoch 90, representative training free energy -718602.852438
Pre-training layer 1, epoch 90, validation free energy -714209.929422
Pre-training layer 1, epoch 91, cost -60.533714016
Pre-training layer 1, epoch 92, cost -60.50126437
Pre-training layer 1, epoch 93, cost -60.442195385
Pre-training layer 1, epoch 94, cost -60.4189251099
Pre-training layer 1, epoch 95, cost -60.4298444862
Pre-training layer 1, epoch 95, representative training free energy -725099.230984
Pre-training layer 1, epoch 95, validation free energy -720692.042531
Pre-training layer 1, epoch 96, cost -60.3717584915
Pre-training layer 1, epoch 97, cost -60.3889871178
Pre-training layer 1, epoch 98, cost -60.3457515907
Pre-training layer 1, epoch 99, cost -60.3347617073
Pre-training layer 2, epoch 0, cost -89.6755488892
Pre-training layer 2, epoch 0, representative training free energy 44556.8163296
Pre-training layer 2, epoch 0, validation free energy 44376.9629194
Pre-training layer 2, epoch 1, cost -66.2791384583
Pre-training layer 2, epoch 2, cost -61.5132091599
Pre-training layer 2, epoch 3, cost -58.8901474991
Pre-training layer 2, epoch 4, cost -57.3006655655
Pre-training layer 2, epoch 5, cost -56.1234031296
Pre-training layer 2, epoch 5, representative training free energy 133894.297354
Pre-training layer 2, epoch 5, validation free energy 133273.23198
Pre-training layer 2, epoch 6, cost -55.143823288
Pre-training layer 2, epoch 7, cost -54.3993880615
Pre-training layer 2, epoch 8, cost -53.7284209137
Pre-training layer 2, epoch 9, cost -53.2082645416
Pre-training layer 2, epoch 10, cost -52.7516211014
Pre-training layer 2, epoch 10, representative training free energy 170733.102416
Pre-training layer 2, epoch 10, validation free energy 170017.320799
Pre-training layer 2, epoch 11, cost -52.4155030594
Pre-training layer 2, epoch 12, cost -51.9651192856
Pre-training layer 2, epoch 13, cost -51.7004910889
Pre-training layer 2, epoch 14, cost -51.4450330353
Pre-training layer 2, epoch 15, cost -51.0727560883
Pre-training layer 2, epoch 15, representative training free energy 193840.871885
Pre-training layer 2, epoch 15, validation free energy 193062.591619
Pre-training layer 2, epoch 16, cost -50.8884961319
Pre-training layer 2, epoch 17, cost -50.7519935837
Pre-training layer 2, epoch 18, cost -50.4726494064
Pre-training layer 2, epoch 19, cost -50.2298993073
Pre-training layer 2, epoch 20, cost -50.1156649475
Pre-training layer 2, epoch 20, representative training free energy 209761.750072
Pre-training layer 2, epoch 20, validation free energy 208925.067746
Pre-training layer 2, epoch 21, cost -49.909355011
Pre-training layer 2, epoch 22, cost -49.8392763062
Pre-training layer 2, epoch 23, cost -49.695346077
Pre-training layer 2, epoch 24, cost -49.5483825531
Pre-training layer 2, epoch 25, cost -49.4482503891
Pre-training layer 2, epoch 25, representative training free energy 222438.190082
Pre-training layer 2, epoch 25, validation free energy 221586.602006
Pre-training layer 2, epoch 26, cost -49.3201897736
Pre-training layer 2, epoch 27, cost -49.1918726578
Pre-training layer 2, epoch 28, cost -49.0562723541
Pre-training layer 2, epoch 29, cost -48.9611349411
Pre-training layer 2, epoch 30, cost -48.8844945679
Pre-training layer 2, epoch 30, representative training free energy 233512.820961
Pre-training layer 2, epoch 30, validation free energy 232639.059361
Pre-training layer 2, epoch 31, cost -48.6371684418
Pre-training layer 2, epoch 32, cost -48.6680220032
Pre-training layer 2, epoch 33, cost -48.518124733
Pre-training layer 2, epoch 34, cost -48.4523437195
Pre-training layer 2, epoch 35, cost -48.3664924393
Pre-training layer 2, epoch 35, representative training free energy 240943.009484
Pre-training layer 2, epoch 35, validation free energy 240075.125018
Pre-training layer 2, epoch 36, cost -48.2426591721
Pre-training layer 2, epoch 37, cost -48.300034481
Pre-training layer 2, epoch 38, cost -48.1561062012
Pre-training layer 2, epoch 39, cost -48.139717823
Pre-training layer 2, epoch 40, cost -47.9752759705
Pre-training layer 2, epoch 40, representative training free energy 248021.158711
Pre-training layer 2, epoch 40, validation free energy 247101.057791
Pre-training layer 2, epoch 41, cost -47.8765012283
Pre-training layer 2, epoch 42, cost -47.8930494995
Pre-training layer 2, epoch 43, cost -47.833581398
Pre-training layer 2, epoch 44, cost -47.8011324921
Pre-training layer 2, epoch 45, cost -47.7199884338
Pre-training layer 2, epoch 45, representative training free energy 254030.76857
Pre-training layer 2, epoch 45, validation free energy 253078.572
Pre-training layer 2, epoch 46, cost -47.6619427948
Pre-training layer 2, epoch 47, cost -47.6703686066
Pre-training layer 2, epoch 48, cost -47.5600164337
Pre-training layer 2, epoch 49, cost -47.5599933853
Pre-training layer 2, epoch 50, cost -47.4349912453
Pre-training layer 2, epoch 50, representative training free energy 259239.993176
Pre-training layer 2, epoch 50, validation free energy 258274.789895
Pre-training layer 2, epoch 51, cost -47.459900528
Pre-training layer 2, epoch 52, cost -47.3226025009
Pre-training layer 2, epoch 53, cost -47.2953997955
Pre-training layer 2, epoch 54, cost -47.2724399338
Pre-training layer 2, epoch 55, cost -47.1961087723
Pre-training layer 2, epoch 55, representative training free energy 265538.077262
Pre-training layer 2, epoch 55, validation free energy 264564.06898
Pre-training layer 2, epoch 56, cost -47.3144702721
Pre-training layer 2, epoch 57, cost -47.1243173752
Pre-training layer 2, epoch 58, cost -47.0797923584
Pre-training layer 2, epoch 59, cost -47.088134388
Pre-training layer 2, epoch 60, cost -47.0869194946
Pre-training layer 2, epoch 60, representative training free energy 267208.034184
Pre-training layer 2, epoch 60, validation free energy 266206.42041
Pre-training layer 2, epoch 61, cost -46.9730026855
Pre-training layer 2, epoch 62, cost -46.9393301849
Pre-training layer 2, epoch 63, cost -46.8910242233
Pre-training layer 2, epoch 64, cost -46.8788984261
Pre-training layer 2, epoch 65, cost -46.7499644203
Pre-training layer 2, epoch 65, representative training free energy 271577.021766
Pre-training layer 2, epoch 65, validation free energy 270519.662637
Pre-training layer 2, epoch 66, cost -46.7918717384
Pre-training layer 2, epoch 67, cost -46.8061812973
Pre-training layer 2, epoch 68, cost -46.6737473373
Pre-training layer 2, epoch 69, cost -46.6606257935
Pre-training layer 2, epoch 70, cost -46.6453930511
Pre-training layer 2, epoch 70, representative training free energy 274891.663813
Pre-training layer 2, epoch 70, validation free energy 273847.783424
Pre-training layer 2, epoch 71, cost -46.6041732101
Pre-training layer 2, epoch 72, cost -46.6232238617
Pre-training layer 2, epoch 73, cost -46.5840139236
Pre-training layer 2, epoch 74, cost -46.5077420883
Pre-training layer 2, epoch 75, cost -46.4481712112
Pre-training layer 2, epoch 75, representative training free energy 277282.807422
Pre-training layer 2, epoch 75, validation free energy 276224.305195
Pre-training layer 2, epoch 76, cost -46.4957409706
Pre-training layer 2, epoch 77, cost -46.4886526985
Pre-training layer 2, epoch 78, cost -46.4836764679
Pre-training layer 2, epoch 79, cost -46.4279462013
Pre-training layer 2, epoch 80, cost -46.3709172096
Pre-training layer 2, epoch 80, representative training free energy 281293.347813
Pre-training layer 2, epoch 80, validation free energy 280203.063684
Pre-training layer 2, epoch 81, cost -46.3381602745
Pre-training layer 2, epoch 82, cost -46.3169695778
Pre-training layer 2, epoch 83, cost -46.3372539062
Pre-training layer 2, epoch 84, cost -46.2908687439
Pre-training layer 2, epoch 85, cost -46.2600391006
Pre-training layer 2, epoch 85, representative training free energy 282836.643949
Pre-training layer 2, epoch 85, validation free energy 281763.228375
Pre-training layer 2, epoch 86, cost -46.205397049
Pre-training layer 2, epoch 87, cost -46.2224663086
Pre-training layer 2, epoch 88, cost -46.2153508415
Pre-training layer 2, epoch 89, cost -46.1520037384
Pre-training layer 2, epoch 90, cost -46.0992320175
Pre-training layer 2, epoch 90, representative training free energy 285108.889035
Pre-training layer 2, epoch 90, validation free energy 283993.422293
Pre-training layer 2, epoch 91, cost -46.1029384308
Pre-training layer 2, epoch 92, cost -46.1461552086
Pre-training layer 2, epoch 93, cost -46.0851672783
Pre-training layer 2, epoch 94, cost -46.0557006836
Pre-training layer 2, epoch 95, cost -46.0037625122
Pre-training layer 2, epoch 95, representative training free energy 285755.427426
Pre-training layer 2, epoch 95, validation free energy 284644.889004
Pre-training layer 2, epoch 96, cost -46.0184418373
Pre-training layer 2, epoch 97, cost -46.0401017952
Pre-training layer 2, epoch 98, cost -46.0103652534
Pre-training layer 2, epoch 99, cost -45.9828212166
The pretraining code for file dbn_loop.pyc ran for 4.73m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 11.550000 %
     epoch 1, minibatch 500/500, test error of best model 14.400000 %
epoch 2, minibatch 500/500, validation error 8.050000 %
     epoch 2, minibatch 500/500, test error of best model 10.550000 %
epoch 3, minibatch 500/500, validation error 6.500000 %
     epoch 3, minibatch 500/500, test error of best model 8.350000 %
epoch 4, minibatch 500/500, validation error 5.300000 %
     epoch 4, minibatch 500/500, test error of best model 7.900000 %
epoch 5, minibatch 500/500, validation error 5.250000 %
     epoch 5, minibatch 500/500, test error of best model 7.600000 %
epoch 6, minibatch 500/500, validation error 5.100000 %
     epoch 6, minibatch 500/500, test error of best model 7.100000 %
epoch 7, minibatch 500/500, validation error 4.900000 %
     epoch 7, minibatch 500/500, test error of best model 6.950000 %
epoch 8, minibatch 500/500, validation error 4.650000 %
     epoch 8, minibatch 500/500, test error of best model 6.550000 %
epoch 9, minibatch 500/500, validation error 4.350000 %
     epoch 9, minibatch 500/500, test error of best model 6.450000 %
epoch 10, minibatch 500/500, validation error 4.400000 %
epoch 11, minibatch 500/500, validation error 4.400000 %
epoch 12, minibatch 500/500, validation error 4.400000 %
epoch 13, minibatch 500/500, validation error 4.400000 %
epoch 14, minibatch 500/500, validation error 4.450000 %
epoch 15, minibatch 500/500, validation error 4.450000 %
epoch 16, minibatch 500/500, validation error 4.550000 %
epoch 17, minibatch 500/500, validation error 4.400000 %
Optimization complete with best validation score of 4.350000 %, obtained at iteration 4500, with test performance 6.450000 %
The fine tuning code for file dbn_loop.pyc ran for 0.41m
