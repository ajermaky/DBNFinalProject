_______RUN: 0

==========Sample: (1000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.13641861
Pre-training layer 0, epoch 0, representative training free energy -596.771287903
Pre-training layer 0, epoch 0, validation free energy -591.763180115
Pre-training layer 0, epoch 1, cost -136.727891541
Pre-training layer 0, epoch 2, cost -124.552837524
Pre-training layer 0, epoch 3, cost -118.299224014
Pre-training layer 0, epoch 4, cost -113.321978455
Pre-training layer 0, epoch 5, cost -110.040425491
Pre-training layer 0, epoch 5, representative training free energy -550.436948059
Pre-training layer 0, epoch 5, validation free energy -538.363585693
Pre-training layer 0, epoch 6, cost -107.116442871
Pre-training layer 0, epoch 7, cost -104.486088486
Pre-training layer 0, epoch 8, cost -102.554856567
Pre-training layer 0, epoch 9, cost -101.124120178
Pre-training layer 0, epoch 10, cost -99.2725986481
Pre-training layer 0, epoch 10, representative training free energy -531.203143616
Pre-training layer 0, epoch 10, validation free energy -517.313290771
Pre-training layer 0, epoch 11, cost -97.9701531982
Pre-training layer 0, epoch 12, cost -97.0011864471
Pre-training layer 0, epoch 13, cost -95.5742719269
Pre-training layer 0, epoch 14, cost -94.5598245239
Pre-training layer 0, epoch 15, cost -93.7198339081
Pre-training layer 0, epoch 15, representative training free energy -522.116751892
Pre-training layer 0, epoch 15, validation free energy -507.381484436
Pre-training layer 0, epoch 16, cost -92.8597145081
Pre-training layer 0, epoch 17, cost -92.1134674835
Pre-training layer 0, epoch 18, cost -91.3433866882
Pre-training layer 0, epoch 19, cost -90.5011927032
Pre-training layer 0, epoch 20, cost -90.2177619934
Pre-training layer 0, epoch 20, representative training free energy -509.86114325
Pre-training layer 0, epoch 20, validation free energy -494.868863647
Pre-training layer 0, epoch 21, cost -89.144320755
Pre-training layer 0, epoch 22, cost -88.9766976929
Pre-training layer 0, epoch 23, cost -88.360945816
Pre-training layer 0, epoch 24, cost -87.8679354095
Pre-training layer 0, epoch 25, cost -87.2685012054
Pre-training layer 0, epoch 25, representative training free energy -504.737066528
Pre-training layer 0, epoch 25, validation free energy -488.682613098
Pre-training layer 0, epoch 26, cost -86.9133444977
Pre-training layer 0, epoch 27, cost -86.3731511688
Pre-training layer 0, epoch 28, cost -85.923664856
Pre-training layer 0, epoch 29, cost -85.6036077118
Pre-training layer 0, epoch 30, cost -85.1005587769
Pre-training layer 0, epoch 30, representative training free energy -501.021738586
Pre-training layer 0, epoch 30, validation free energy -484.331477905
Pre-training layer 0, epoch 31, cost -84.9517810059
Pre-training layer 0, epoch 32, cost -84.4482312012
Pre-training layer 0, epoch 33, cost -84.1830870438
Pre-training layer 0, epoch 34, cost -83.9327570343
Pre-training layer 0, epoch 35, cost -83.5211623383
Pre-training layer 0, epoch 35, representative training free energy -495.311106689
Pre-training layer 0, epoch 35, validation free energy -478.287232971
Pre-training layer 0, epoch 36, cost -83.0736738586
Pre-training layer 0, epoch 37, cost -82.9985673523
Pre-training layer 0, epoch 38, cost -82.5705724335
Pre-training layer 0, epoch 39, cost -82.3528213501
Pre-training layer 0, epoch 40, cost -81.9739497375
Pre-training layer 0, epoch 40, representative training free energy -489.843277649
Pre-training layer 0, epoch 40, validation free energy -471.739945129
Pre-training layer 0, epoch 41, cost -81.8828794098
Pre-training layer 0, epoch 42, cost -81.5484920502
Pre-training layer 0, epoch 43, cost -81.6451056671
Pre-training layer 0, epoch 44, cost -81.0642043686
Pre-training layer 0, epoch 45, cost -81.0513433838
Pre-training layer 0, epoch 45, representative training free energy -486.912813965
Pre-training layer 0, epoch 45, validation free energy -468.714359619
Pre-training layer 0, epoch 46, cost -80.8278781891
Pre-training layer 0, epoch 47, cost -80.4272071838
Pre-training layer 0, epoch 48, cost -80.5546239471
Pre-training layer 0, epoch 49, cost -80.1596000671
Pre-training layer 0, epoch 50, cost -80.0505716705
Pre-training layer 0, epoch 50, representative training free energy -481.739676208
Pre-training layer 0, epoch 50, validation free energy -462.980376587
Pre-training layer 0, epoch 51, cost -79.7003581238
Pre-training layer 0, epoch 52, cost -79.651857872
Pre-training layer 0, epoch 53, cost -79.5718546677
Pre-training layer 0, epoch 54, cost -79.248499527
Pre-training layer 0, epoch 55, cost -79.0537015152
Pre-training layer 0, epoch 55, representative training free energy -481.196136841
Pre-training layer 0, epoch 55, validation free energy -462.319962402
Pre-training layer 0, epoch 56, cost -79.0025258636
Pre-training layer 0, epoch 57, cost -78.7214550018
Pre-training layer 0, epoch 58, cost -78.5235456467
Pre-training layer 0, epoch 59, cost -78.4667025757
Pre-training layer 0, epoch 60, cost -78.3213167572
Pre-training layer 0, epoch 60, representative training free energy -479.761003174
Pre-training layer 0, epoch 60, validation free energy -460.078521606
Pre-training layer 0, epoch 61, cost -78.2366795349
Pre-training layer 0, epoch 62, cost -77.9027133942
Pre-training layer 0, epoch 63, cost -77.814512291
Pre-training layer 0, epoch 64, cost -77.7326329041
Pre-training layer 0, epoch 65, cost -77.7256947327
Pre-training layer 0, epoch 65, representative training free energy -475.600330322
Pre-training layer 0, epoch 65, validation free energy -455.366593567
Pre-training layer 0, epoch 66, cost -77.4306315994
Pre-training layer 0, epoch 67, cost -77.4765534973
Pre-training layer 0, epoch 68, cost -77.2966683578
Pre-training layer 0, epoch 69, cost -77.0939824295
Pre-training layer 0, epoch 70, cost -77.0995561981
Pre-training layer 0, epoch 70, representative training free energy -478.662891541
Pre-training layer 0, epoch 70, validation free energy -458.510024658
Pre-training layer 0, epoch 71, cost -76.7815914917
Pre-training layer 0, epoch 72, cost -77.0697306824
Pre-training layer 0, epoch 73, cost -76.6659894562
Pre-training layer 0, epoch 74, cost -76.6169659042
Pre-training layer 0, epoch 75, cost -76.407661972
Pre-training layer 0, epoch 75, representative training free energy -475.095964539
Pre-training layer 0, epoch 75, validation free energy -454.383232727
Pre-training layer 0, epoch 76, cost -76.4360340118
Pre-training layer 0, epoch 77, cost -76.1667625046
Pre-training layer 0, epoch 78, cost -76.0035465622
Pre-training layer 0, epoch 79, cost -75.7413280487
Pre-training layer 0, epoch 80, cost -76.0357938385
Pre-training layer 0, epoch 80, representative training free energy -472.095401978
Pre-training layer 0, epoch 80, validation free energy -451.960844666
Pre-training layer 0, epoch 81, cost -75.9281373596
Pre-training layer 0, epoch 82, cost -75.4811991119
Pre-training layer 0, epoch 83, cost -75.7579994583
Pre-training layer 0, epoch 84, cost -75.4788868332
Pre-training layer 0, epoch 85, cost -75.4377607727
Pre-training layer 0, epoch 85, representative training free energy -468.940586182
Pre-training layer 0, epoch 85, validation free energy -447.518231995
Pre-training layer 0, epoch 86, cost -75.3741903687
Pre-training layer 0, epoch 87, cost -75.2302545547
Pre-training layer 0, epoch 88, cost -74.8496162033
Pre-training layer 0, epoch 89, cost -74.8192214203
Pre-training layer 0, epoch 90, cost -75.0147738266
Pre-training layer 0, epoch 90, representative training free energy -471.0625271
Pre-training layer 0, epoch 90, validation free energy -449.74683905
Pre-training layer 0, epoch 91, cost -74.8693035889
Pre-training layer 0, epoch 92, cost -74.8018700409
Pre-training layer 0, epoch 93, cost -74.6816664124
Pre-training layer 0, epoch 94, cost -74.4825857162
Pre-training layer 0, epoch 95, cost -74.6816448212
Pre-training layer 0, epoch 95, representative training free energy -470.213908142
Pre-training layer 0, epoch 95, validation free energy -448.44995575
Pre-training layer 0, epoch 96, cost -74.522498436
Pre-training layer 0, epoch 97, cost -74.2555447769
Pre-training layer 0, epoch 98, cost -74.329726944
Pre-training layer 0, epoch 99, cost -74.1897234344
Pre-training layer 1, epoch 0, cost -431.821483765
Pre-training layer 1, epoch 0, representative training free energy -32388.0378672
Pre-training layer 1, epoch 0, validation free energy -32084.4558223
Pre-training layer 1, epoch 1, cost -370.396916199
Pre-training layer 1, epoch 2, cost -351.337014771
Pre-training layer 1, epoch 3, cost -339.598793335
Pre-training layer 1, epoch 4, cost -331.399674377
Pre-training layer 1, epoch 5, cost -325.123830566
Pre-training layer 1, epoch 5, representative training free energy -46173.9518809
Pre-training layer 1, epoch 5, validation free energy -45822.6177852
Pre-training layer 1, epoch 6, cost -320.162843018
Pre-training layer 1, epoch 7, cost -316.144259949
Pre-training layer 1, epoch 8, cost -312.564201355
Pre-training layer 1, epoch 9, cost -309.265839539
Pre-training layer 1, epoch 10, cost -306.877315674
Pre-training layer 1, epoch 10, representative training free energy -50483.1504512
Pre-training layer 1, epoch 10, validation free energy -50121.4974375
Pre-training layer 1, epoch 11, cost -304.710750122
Pre-training layer 1, epoch 12, cost -302.582330627
Pre-training layer 1, epoch 13, cost -300.799890442
Pre-training layer 1, epoch 14, cost -298.990397339
Pre-training layer 1, epoch 15, cost -297.566114197
Pre-training layer 1, epoch 15, representative training free energy -53014.9601406
Pre-training layer 1, epoch 15, validation free energy -52654.8494023
Pre-training layer 1, epoch 16, cost -295.929161072
Pre-training layer 1, epoch 17, cost -294.765314331
Pre-training layer 1, epoch 18, cost -293.558673553
Pre-training layer 1, epoch 19, cost -292.471616364
Pre-training layer 1, epoch 20, cost -291.691777191
Pre-training layer 1, epoch 20, representative training free energy -54746.8832734
Pre-training layer 1, epoch 20, validation free energy -54384.6140898
Pre-training layer 1, epoch 21, cost -290.428264618
Pre-training layer 1, epoch 22, cost -289.434403992
Pre-training layer 1, epoch 23, cost -288.852853699
Pre-training layer 1, epoch 24, cost -287.790547791
Pre-training layer 1, epoch 25, cost -287.220026093
Pre-training layer 1, epoch 25, representative training free energy -56145.6232266
Pre-training layer 1, epoch 25, validation free energy -55780.8428867
Pre-training layer 1, epoch 26, cost -286.337423706
Pre-training layer 1, epoch 27, cost -285.777031403
Pre-training layer 1, epoch 28, cost -285.052436218
Pre-training layer 1, epoch 29, cost -284.425058136
Pre-training layer 1, epoch 30, cost -284.048699799
Pre-training layer 1, epoch 30, representative training free energy -57275.3294219
Pre-training layer 1, epoch 30, validation free energy -56906.5835391
Pre-training layer 1, epoch 31, cost -283.256446075
Pre-training layer 1, epoch 32, cost -282.902093658
Pre-training layer 1, epoch 33, cost -282.361880493
Pre-training layer 1, epoch 34, cost -281.867253571
Pre-training layer 1, epoch 35, cost -281.481957245
Pre-training layer 1, epoch 35, representative training free energy -58157.5647148
Pre-training layer 1, epoch 35, validation free energy -57784.7936172
Pre-training layer 1, epoch 36, cost -280.887115021
Pre-training layer 1, epoch 37, cost -280.823065948
Pre-training layer 1, epoch 38, cost -280.014592285
Pre-training layer 1, epoch 39, cost -279.817948608
Pre-training layer 1, epoch 40, cost -279.312077942
Pre-training layer 1, epoch 40, representative training free energy -58988.3614688
Pre-training layer 1, epoch 40, validation free energy -58617.0484063
Pre-training layer 1, epoch 41, cost -279.042701416
Pre-training layer 1, epoch 42, cost -278.586955109
Pre-training layer 1, epoch 43, cost -278.325828247
Pre-training layer 1, epoch 44, cost -277.969880219
Pre-training layer 1, epoch 45, cost -277.639354706
Pre-training layer 1, epoch 45, representative training free energy -59645.4706328
Pre-training layer 1, epoch 45, validation free energy -59276.4349805
Pre-training layer 1, epoch 46, cost -277.44651413
Pre-training layer 1, epoch 47, cost -277.112225037
Pre-training layer 1, epoch 48, cost -276.66100647
Pre-training layer 1, epoch 49, cost -276.473258209
Pre-training layer 1, epoch 50, cost -276.125041351
Pre-training layer 1, epoch 50, representative training free energy -60266.0614141
Pre-training layer 1, epoch 50, validation free energy -59889.985793
Pre-training layer 1, epoch 51, cost -276.029723969
Pre-training layer 1, epoch 52, cost -275.55522995
Pre-training layer 1, epoch 53, cost -275.514091034
Pre-training layer 1, epoch 54, cost -275.245798035
Pre-training layer 1, epoch 55, cost -275.223274078
Pre-training layer 1, epoch 55, representative training free energy -60832.4122383
Pre-training layer 1, epoch 55, validation free energy -60450.7546289
Pre-training layer 1, epoch 56, cost -274.780618286
Pre-training layer 1, epoch 57, cost -274.569817657
Pre-training layer 1, epoch 58, cost -274.439343567
Pre-training layer 1, epoch 59, cost -274.194323578
Pre-training layer 1, epoch 60, cost -273.896845245
Pre-training layer 1, epoch 60, representative training free energy -61305.1584922
Pre-training layer 1, epoch 60, validation free energy -60927.0115312
Pre-training layer 1, epoch 61, cost -273.780224152
Pre-training layer 1, epoch 62, cost -273.508985901
Pre-training layer 1, epoch 63, cost -273.451623535
Pre-training layer 1, epoch 64, cost -273.240632629
Pre-training layer 1, epoch 65, cost -273.131595459
Pre-training layer 1, epoch 65, representative training free energy -61790.8508477
Pre-training layer 1, epoch 65, validation free energy -61407.9461016
Pre-training layer 1, epoch 66, cost -272.98019165
Pre-training layer 1, epoch 67, cost -272.734342499
Pre-training layer 1, epoch 68, cost -272.571552582
Pre-training layer 1, epoch 69, cost -272.454747162
Pre-training layer 1, epoch 70, cost -272.430309753
Pre-training layer 1, epoch 70, representative training free energy -62156.143293
Pre-training layer 1, epoch 70, validation free energy -61773.819043
Pre-training layer 1, epoch 71, cost -271.992382507
Pre-training layer 1, epoch 72, cost -271.977583313
Pre-training layer 1, epoch 73, cost -271.915475616
Pre-training layer 1, epoch 74, cost -271.681361084
Pre-training layer 1, epoch 75, cost -271.576697083
Pre-training layer 1, epoch 75, representative training free energy -62582.3424648
Pre-training layer 1, epoch 75, validation free energy -62201.3239453
Pre-training layer 1, epoch 76, cost -271.534836731
Pre-training layer 1, epoch 77, cost -271.432447662
Pre-training layer 1, epoch 78, cost -271.221280365
Pre-training layer 1, epoch 79, cost -271.093166046
Pre-training layer 1, epoch 80, cost -270.93707962
Pre-training layer 1, epoch 80, representative training free energy -63004.687
Pre-training layer 1, epoch 80, validation free energy -62619.6960664
Pre-training layer 1, epoch 81, cost -270.615709534
Pre-training layer 1, epoch 82, cost -270.666973572
Pre-training layer 1, epoch 83, cost -270.520586548
Pre-training layer 1, epoch 84, cost -270.475003967
Pre-training layer 1, epoch 85, cost -270.266137085
Pre-training layer 1, epoch 85, representative training free energy -63325.5071367
Pre-training layer 1, epoch 85, validation free energy -62937.3475547
Pre-training layer 1, epoch 86, cost -270.207156525
Pre-training layer 1, epoch 87, cost -270.25064682
Pre-training layer 1, epoch 88, cost -270.006577148
Pre-training layer 1, epoch 89, cost -269.907930145
Pre-training layer 1, epoch 90, cost -269.850983734
Pre-training layer 1, epoch 90, representative training free energy -63693.3217383
Pre-training layer 1, epoch 90, validation free energy -63304.238832
Pre-training layer 1, epoch 91, cost -269.543056335
Pre-training layer 1, epoch 92, cost -269.517077789
Pre-training layer 1, epoch 93, cost -269.428960419
Pre-training layer 1, epoch 94, cost -269.300159149
Pre-training layer 1, epoch 95, cost -269.397454071
Pre-training layer 1, epoch 95, representative training free energy -64031.346957
Pre-training layer 1, epoch 95, validation free energy -63637.9416484
Pre-training layer 1, epoch 96, cost -269.393679199
Pre-training layer 1, epoch 97, cost -269.095761414
Pre-training layer 1, epoch 98, cost -269.031001434
Pre-training layer 1, epoch 99, cost -269.012397766
Pre-training layer 2, epoch 0, cost -160.708840714
Pre-training layer 2, epoch 0, representative training free energy 1795.88014984
Pre-training layer 2, epoch 0, validation free energy 1807.16058948
Pre-training layer 2, epoch 1, cost -106.727697144
Pre-training layer 2, epoch 2, cost -96.8730326843
Pre-training layer 2, epoch 3, cost -90.8459107971
Pre-training layer 2, epoch 4, cost -87.3863754272
Pre-training layer 2, epoch 5, cost -85.080141449
Pre-training layer 2, epoch 5, representative training free energy 2625.92319275
Pre-training layer 2, epoch 5, validation free energy 2625.2215957
Pre-training layer 2, epoch 6, cost -82.6228722
Pre-training layer 2, epoch 7, cost -80.9525499344
Pre-training layer 2, epoch 8, cost -79.1149218369
Pre-training layer 2, epoch 9, cost -78.1210226059
Pre-training layer 2, epoch 10, cost -77.1237812805
Pre-training layer 2, epoch 10, representative training free energy 3039.74022913
Pre-training layer 2, epoch 10, validation free energy 3029.85195581
Pre-training layer 2, epoch 11, cost -76.097871933
Pre-training layer 2, epoch 12, cost -75.2138815308
Pre-training layer 2, epoch 13, cost -74.4725532913
Pre-training layer 2, epoch 14, cost -73.68254879
Pre-training layer 2, epoch 15, cost -73.1328468323
Pre-training layer 2, epoch 15, representative training free energy 3341.94393335
Pre-training layer 2, epoch 15, validation free energy 3326.19535242
Pre-training layer 2, epoch 16, cost -72.4190566254
Pre-training layer 2, epoch 17, cost -72.0715151215
Pre-training layer 2, epoch 18, cost -71.47140625
Pre-training layer 2, epoch 19, cost -71.2596805191
Pre-training layer 2, epoch 20, cost -70.8849311066
Pre-training layer 2, epoch 20, representative training free energy 3563.93266284
Pre-training layer 2, epoch 20, validation free energy 3541.79564709
Pre-training layer 2, epoch 21, cost -70.5125991058
Pre-training layer 2, epoch 22, cost -69.9982488251
Pre-training layer 2, epoch 23, cost -69.831882019
Pre-training layer 2, epoch 24, cost -69.3624103546
Pre-training layer 2, epoch 25, cost -69.0804764175
Pre-training layer 2, epoch 25, representative training free energy 3797.32663318
Pre-training layer 2, epoch 25, validation free energy 3772.51692749
Pre-training layer 2, epoch 26, cost -68.7201569748
Pre-training layer 2, epoch 27, cost -68.6583440399
Pre-training layer 2, epoch 28, cost -68.3236771011
Pre-training layer 2, epoch 29, cost -68.1386482239
Pre-training layer 2, epoch 30, cost -67.8652790451
Pre-training layer 2, epoch 30, representative training free energy 3983.77484326
Pre-training layer 2, epoch 30, validation free energy 3955.56840063
Pre-training layer 2, epoch 31, cost -67.6364076614
Pre-training layer 2, epoch 32, cost -67.4257778168
Pre-training layer 2, epoch 33, cost -67.32151577
Pre-training layer 2, epoch 34, cost -66.9761536789
Pre-training layer 2, epoch 35, cost -66.9558281326
Pre-training layer 2, epoch 35, representative training free energy 4162.70424927
Pre-training layer 2, epoch 35, validation free energy 4131.46322925
Pre-training layer 2, epoch 36, cost -66.8331407928
Pre-training layer 2, epoch 37, cost -66.3313507843
Pre-training layer 2, epoch 38, cost -66.1601535034
Pre-training layer 2, epoch 39, cost -66.1468406296
Pre-training layer 2, epoch 40, cost -65.9383200455
Pre-training layer 2, epoch 40, representative training free energy 4316.27693164
Pre-training layer 2, epoch 40, validation free energy 4283.90377368
Pre-training layer 2, epoch 41, cost -65.8370478439
Pre-training layer 2, epoch 42, cost -65.5545425415
Pre-training layer 2, epoch 43, cost -65.5908773041
Pre-training layer 2, epoch 44, cost -65.3800511932
Pre-training layer 2, epoch 45, cost -65.4425047684
Pre-training layer 2, epoch 45, representative training free energy 4465.09826978
Pre-training layer 2, epoch 45, validation free energy 4429.8868042
Pre-training layer 2, epoch 46, cost -65.3213528061
Pre-training layer 2, epoch 47, cost -65.0866994095
Pre-training layer 2, epoch 48, cost -65.0397232819
Pre-training layer 2, epoch 49, cost -64.7994667435
Pre-training layer 2, epoch 50, cost -64.7509350204
Pre-training layer 2, epoch 50, representative training free energy 4604.34802661
Pre-training layer 2, epoch 50, validation free energy 4567.95693066
Pre-training layer 2, epoch 51, cost -64.7653783417
Pre-training layer 2, epoch 52, cost -64.5309607697
Pre-training layer 2, epoch 53, cost -64.527317009
Pre-training layer 2, epoch 54, cost -64.4859735107
Pre-training layer 2, epoch 55, cost -64.2878720474
Pre-training layer 2, epoch 55, representative training free energy 4717.87321021
Pre-training layer 2, epoch 55, validation free energy 4680.39854004
Pre-training layer 2, epoch 56, cost -64.0056010818
Pre-training layer 2, epoch 57, cost -64.1643974304
Pre-training layer 2, epoch 58, cost -63.9231643677
Pre-training layer 2, epoch 59, cost -64.0344280624
Pre-training layer 2, epoch 60, cost -63.8483023071
Pre-training layer 2, epoch 60, representative training free energy 4846.88272778
Pre-training layer 2, epoch 60, validation free energy 4808.45720337
Pre-training layer 2, epoch 61, cost -63.8181151199
Pre-training layer 2, epoch 62, cost -63.9172239685
Pre-training layer 2, epoch 63, cost -63.8692824936
Pre-training layer 2, epoch 64, cost -63.5497838974
Pre-training layer 2, epoch 65, cost -63.5297424698
Pre-training layer 2, epoch 65, representative training free energy 4965.50604663
Pre-training layer 2, epoch 65, validation free energy 4925.15876953
Pre-training layer 2, epoch 66, cost -63.419862442
Pre-training layer 2, epoch 67, cost -63.4009263229
Pre-training layer 2, epoch 68, cost -63.3959624481
Pre-training layer 2, epoch 69, cost -63.2881357956
Pre-training layer 2, epoch 70, cost -63.2364283752
Pre-training layer 2, epoch 70, representative training free energy 5060.03808179
Pre-training layer 2, epoch 70, validation free energy 5019.8970603
Pre-training layer 2, epoch 71, cost -63.2122277832
Pre-training layer 2, epoch 72, cost -63.0278351974
Pre-training layer 2, epoch 73, cost -63.1740018845
Pre-training layer 2, epoch 74, cost -62.9510773468
Pre-training layer 2, epoch 75, cost -62.8882301331
Pre-training layer 2, epoch 75, representative training free energy 5166.92768677
Pre-training layer 2, epoch 75, validation free energy 5125.31226172
Pre-training layer 2, epoch 76, cost -62.7616493607
Pre-training layer 2, epoch 77, cost -62.8433259964
Pre-training layer 2, epoch 78, cost -62.8602060699
Pre-training layer 2, epoch 79, cost -62.7555872345
Pre-training layer 2, epoch 80, cost -62.6519176102
Pre-training layer 2, epoch 80, representative training free energy 5271.22236841
Pre-training layer 2, epoch 80, validation free energy 5227.88187939
Pre-training layer 2, epoch 81, cost -62.6658283615
Pre-training layer 2, epoch 82, cost -62.5611276245
Pre-training layer 2, epoch 83, cost -62.516756897
Pre-training layer 2, epoch 84, cost -62.6965971375
Pre-training layer 2, epoch 85, cost -62.4767193222
Pre-training layer 2, epoch 85, representative training free energy 5359.24228027
Pre-training layer 2, epoch 85, validation free energy 5315.25361328
Pre-training layer 2, epoch 86, cost -62.325099144
Pre-training layer 2, epoch 87, cost -62.4532958984
Pre-training layer 2, epoch 88, cost -62.2479549789
Pre-training layer 2, epoch 89, cost -62.2893379211
Pre-training layer 2, epoch 90, cost -62.3877535248
Pre-training layer 2, epoch 90, representative training free energy 5457.18782227
Pre-training layer 2, epoch 90, validation free energy 5411.95151465
Pre-training layer 2, epoch 91, cost -62.1996129227
Pre-training layer 2, epoch 92, cost -62.0438034821
Pre-training layer 2, epoch 93, cost -62.059044342
Pre-training layer 2, epoch 94, cost -62.0207030106
Pre-training layer 2, epoch 95, cost -62.0772284317
Pre-training layer 2, epoch 95, representative training free energy 5544.03222925
Pre-training layer 2, epoch 95, validation free energy 5498.34193164
Pre-training layer 2, epoch 96, cost -62.0664936066
Pre-training layer 2, epoch 97, cost -61.9007169724
Pre-training layer 2, epoch 98, cost -61.7103339386
Pre-training layer 2, epoch 99, cost -61.9318402863
The pretraining code for file dbn_loop.pyc ran for 2.76m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 33.800000 %
     epoch 1, minibatch 100/100, test error of best model 29.800000 %
epoch 2, minibatch 100/100, validation error 29.400000 %
     epoch 2, minibatch 100/100, test error of best model 21.800000 %
epoch 3, minibatch 100/100, validation error 27.000000 %
     epoch 3, minibatch 100/100, test error of best model 17.400000 %
epoch 4, minibatch 100/100, validation error 25.800000 %
     epoch 4, minibatch 100/100, test error of best model 16.800000 %
epoch 5, minibatch 100/100, validation error 25.000000 %
     epoch 5, minibatch 100/100, test error of best model 16.400000 %
epoch 6, minibatch 100/100, validation error 23.800000 %
     epoch 6, minibatch 100/100, test error of best model 15.400000 %
epoch 7, minibatch 100/100, validation error 23.000000 %
     epoch 7, minibatch 100/100, test error of best model 15.000000 %
epoch 8, minibatch 100/100, validation error 22.600000 %
     epoch 8, minibatch 100/100, test error of best model 14.400000 %
epoch 9, minibatch 100/100, validation error 22.400000 %
     epoch 9, minibatch 100/100, test error of best model 14.000000 %
epoch 10, minibatch 100/100, validation error 22.200000 %
     epoch 10, minibatch 100/100, test error of best model 13.600000 %
epoch 11, minibatch 100/100, validation error 22.600000 %
epoch 12, minibatch 100/100, validation error 21.800000 %
     epoch 12, minibatch 100/100, test error of best model 13.200000 %
epoch 13, minibatch 100/100, validation error 21.800000 %
epoch 14, minibatch 100/100, validation error 21.800000 %
epoch 15, minibatch 100/100, validation error 21.400000 %
     epoch 15, minibatch 100/100, test error of best model 12.800000 %
epoch 16, minibatch 100/100, validation error 21.000000 %
     epoch 16, minibatch 100/100, test error of best model 12.800000 %
epoch 17, minibatch 100/100, validation error 21.200000 %
epoch 18, minibatch 100/100, validation error 20.800000 %
     epoch 18, minibatch 100/100, test error of best model 12.600000 %
epoch 19, minibatch 100/100, validation error 20.800000 %
epoch 20, minibatch 100/100, validation error 20.800000 %
epoch 21, minibatch 100/100, validation error 20.800000 %
epoch 22, minibatch 100/100, validation error 21.000000 %
epoch 23, minibatch 100/100, validation error 21.200000 %
epoch 24, minibatch 100/100, validation error 21.200000 %
epoch 25, minibatch 100/100, validation error 21.200000 %
epoch 26, minibatch 100/100, validation error 21.000000 %
epoch 27, minibatch 100/100, validation error 21.000000 %
epoch 28, minibatch 100/100, validation error 21.000000 %
epoch 29, minibatch 100/100, validation error 21.000000 %
epoch 30, minibatch 100/100, validation error 20.800000 %
epoch 31, minibatch 100/100, validation error 21.000000 %
epoch 32, minibatch 100/100, validation error 21.000000 %
epoch 33, minibatch 100/100, validation error 21.000000 %
epoch 34, minibatch 100/100, validation error 21.000000 %
epoch 35, minibatch 100/100, validation error 21.000000 %
Optimization complete with best validation score of 20.800000 %, obtained at iteration 1800, with test performance 12.600000 %
The fine tuning code for file dbn_loop.pyc ran for 0.36m


==========Sample: (2000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.488170128
Pre-training layer 0, epoch 0, representative training free energy -583.349419312
Pre-training layer 0, epoch 0, validation free energy -579.753861572
Pre-training layer 0, epoch 1, cost -123.39996994
Pre-training layer 0, epoch 2, cost -114.064844475
Pre-training layer 0, epoch 3, cost -108.529257011
Pre-training layer 0, epoch 4, cost -104.472336044
Pre-training layer 0, epoch 5, cost -101.376616554
Pre-training layer 0, epoch 5, representative training free energy -524.772657471
Pre-training layer 0, epoch 5, validation free energy -515.060102722
Pre-training layer 0, epoch 6, cost -98.9139211273
Pre-training layer 0, epoch 7, cost -96.8556187057
Pre-training layer 0, epoch 8, cost -95.328575058
Pre-training layer 0, epoch 9, cost -93.7537099457
Pre-training layer 0, epoch 10, cost -92.4888901901
Pre-training layer 0, epoch 10, representative training free energy -507.240666382
Pre-training layer 0, epoch 10, validation free energy -496.848929443
Pre-training layer 0, epoch 11, cost -91.5725721741
Pre-training layer 0, epoch 12, cost -90.6267072678
Pre-training layer 0, epoch 13, cost -89.7392630005
Pre-training layer 0, epoch 14, cost -89.0156894684
Pre-training layer 0, epoch 15, cost -88.4364077759
Pre-training layer 0, epoch 15, representative training free energy -497.860987
Pre-training layer 0, epoch 15, validation free energy -487.206143066
Pre-training layer 0, epoch 16, cost -87.8143413544
Pre-training layer 0, epoch 17, cost -86.9142346954
Pre-training layer 0, epoch 18, cost -86.5333277512
Pre-training layer 0, epoch 19, cost -85.7578820038
Pre-training layer 0, epoch 20, cost -85.3522546387
Pre-training layer 0, epoch 20, representative training free energy -481.615648132
Pre-training layer 0, epoch 20, validation free energy -470.876536072
Pre-training layer 0, epoch 21, cost -84.9054592896
Pre-training layer 0, epoch 22, cost -84.6126613998
Pre-training layer 0, epoch 23, cost -84.2371560669
Pre-training layer 0, epoch 24, cost -83.7893314362
Pre-training layer 0, epoch 25, cost -83.4046998215
Pre-training layer 0, epoch 25, representative training free energy -480.35136554
Pre-training layer 0, epoch 25, validation free energy -469.037628296
Pre-training layer 0, epoch 26, cost -83.2257073784
Pre-training layer 0, epoch 27, cost -82.8255923462
Pre-training layer 0, epoch 28, cost -82.3330544662
Pre-training layer 0, epoch 29, cost -82.3365001678
Pre-training layer 0, epoch 30, cost -81.9526497269
Pre-training layer 0, epoch 30, representative training free energy -474.702772583
Pre-training layer 0, epoch 30, validation free energy -462.958174316
Pre-training layer 0, epoch 31, cost -81.4398094749
Pre-training layer 0, epoch 32, cost -81.2725569534
Pre-training layer 0, epoch 33, cost -81.1779755211
Pre-training layer 0, epoch 34, cost -80.8565775871
Pre-training layer 0, epoch 35, cost -80.6268181419
Pre-training layer 0, epoch 35, representative training free energy -468.665542542
Pre-training layer 0, epoch 35, validation free energy -456.212010193
Pre-training layer 0, epoch 36, cost -80.2628527832
Pre-training layer 0, epoch 37, cost -80.1414658737
Pre-training layer 0, epoch 38, cost -80.0908773804
Pre-training layer 0, epoch 39, cost -79.9225123405
Pre-training layer 0, epoch 40, cost -79.5174407959
Pre-training layer 0, epoch 40, representative training free energy -466.621269226
Pre-training layer 0, epoch 40, validation free energy -453.794458801
Pre-training layer 0, epoch 41, cost -79.4301852226
Pre-training layer 0, epoch 42, cost -79.2303900719
Pre-training layer 0, epoch 43, cost -79.1169654274
Pre-training layer 0, epoch 44, cost -79.0133831978
Pre-training layer 0, epoch 45, cost -78.7577749443
Pre-training layer 0, epoch 45, representative training free energy -465.591460571
Pre-training layer 0, epoch 45, validation free energy -452.767244568
Pre-training layer 0, epoch 46, cost -78.5611804199
Pre-training layer 0, epoch 47, cost -78.2861570549
Pre-training layer 0, epoch 48, cost -78.3642556953
Pre-training layer 0, epoch 49, cost -78.050376606
Pre-training layer 0, epoch 50, cost -78.0932553101
Pre-training layer 0, epoch 50, representative training free energy -466.636816772
Pre-training layer 0, epoch 50, validation free energy -453.241154968
Pre-training layer 0, epoch 51, cost -77.8170029449
Pre-training layer 0, epoch 52, cost -77.7089713669
Pre-training layer 0, epoch 53, cost -77.6650646019
Pre-training layer 0, epoch 54, cost -77.4297526169
Pre-training layer 0, epoch 55, cost -77.3135057259
Pre-training layer 0, epoch 55, representative training free energy -459.139025391
Pre-training layer 0, epoch 55, validation free energy -445.741231567
Pre-training layer 0, epoch 56, cost -77.2073698807
Pre-training layer 0, epoch 57, cost -77.0597122955
Pre-training layer 0, epoch 58, cost -77.0384202194
Pre-training layer 0, epoch 59, cost -76.7078138161
Pre-training layer 0, epoch 60, cost -76.6009036446
Pre-training layer 0, epoch 60, representative training free energy -461.147471436
Pre-training layer 0, epoch 60, validation free energy -447.319936523
Pre-training layer 0, epoch 61, cost -76.6101808548
Pre-training layer 0, epoch 62, cost -76.4661733437
Pre-training layer 0, epoch 63, cost -76.3417012787
Pre-training layer 0, epoch 64, cost -76.3089577675
Pre-training layer 0, epoch 65, cost -76.2054421997
Pre-training layer 0, epoch 65, representative training free energy -460.614396179
Pre-training layer 0, epoch 65, validation free energy -446.23535199
Pre-training layer 0, epoch 66, cost -76.1263504791
Pre-training layer 0, epoch 67, cost -76.1336828423
Pre-training layer 0, epoch 68, cost -75.8762106705
Pre-training layer 0, epoch 69, cost -75.8505591583
Pre-training layer 0, epoch 70, cost -75.7598616028
Pre-training layer 0, epoch 70, representative training free energy -457.119071899
Pre-training layer 0, epoch 70, validation free energy -442.754847839
Pre-training layer 0, epoch 71, cost -75.759139843
Pre-training layer 0, epoch 72, cost -75.5758478928
Pre-training layer 0, epoch 73, cost -75.5252967262
Pre-training layer 0, epoch 74, cost -75.5120834541
Pre-training layer 0, epoch 75, cost -75.1593417358
Pre-training layer 0, epoch 75, representative training free energy -455.010718445
Pre-training layer 0, epoch 75, validation free energy -440.476234314
Pre-training layer 0, epoch 76, cost -75.2686711121
Pre-training layer 0, epoch 77, cost -75.2522366333
Pre-training layer 0, epoch 78, cost -75.0611169624
Pre-training layer 0, epoch 79, cost -74.8805143547
Pre-training layer 0, epoch 80, cost -74.8538023567
Pre-training layer 0, epoch 80, representative training free energy -456.105177612
Pre-training layer 0, epoch 80, validation free energy -441.366356628
Pre-training layer 0, epoch 81, cost -74.8568000031
Pre-training layer 0, epoch 82, cost -74.6273635101
Pre-training layer 0, epoch 83, cost -74.6904590988
Pre-training layer 0, epoch 84, cost -74.6325196457
Pre-training layer 0, epoch 85, cost -74.6316098404
Pre-training layer 0, epoch 85, representative training free energy -452.457164185
Pre-training layer 0, epoch 85, validation free energy -437.770360107
Pre-training layer 0, epoch 86, cost -74.4997386742
Pre-training layer 0, epoch 87, cost -74.5049440193
Pre-training layer 0, epoch 88, cost -74.3256812286
Pre-training layer 0, epoch 89, cost -74.3127203941
Pre-training layer 0, epoch 90, cost -74.2250972557
Pre-training layer 0, epoch 90, representative training free energy -455.584267639
Pre-training layer 0, epoch 90, validation free energy -441.077157898
Pre-training layer 0, epoch 91, cost -74.1171300888
Pre-training layer 0, epoch 92, cost -74.0333154106
Pre-training layer 0, epoch 93, cost -74.0894969177
Pre-training layer 0, epoch 94, cost -73.7724965096
Pre-training layer 0, epoch 95, cost -74.0269146919
Pre-training layer 0, epoch 95, representative training free energy -452.654714355
Pre-training layer 0, epoch 95, validation free energy -437.307131653
Pre-training layer 0, epoch 96, cost -73.8283897591
Pre-training layer 0, epoch 97, cost -73.655648613
Pre-training layer 0, epoch 98, cost -73.6034852982
Pre-training layer 0, epoch 99, cost -73.5667483902
Pre-training layer 1, epoch 0, cost -374.539696579
Pre-training layer 1, epoch 0, representative training free energy -42195.2916699
Pre-training layer 1, epoch 0, validation free energy -41875.6694863
Pre-training layer 1, epoch 1, cost -322.275142517
Pre-training layer 1, epoch 2, cost -305.998157806
Pre-training layer 1, epoch 3, cost -295.994312897
Pre-training layer 1, epoch 4, cost -289.25615036
Pre-training layer 1, epoch 5, cost -283.844344101
Pre-training layer 1, epoch 5, representative training free energy -57954.3344844
Pre-training layer 1, epoch 5, validation free energy -57494.6191484
Pre-training layer 1, epoch 6, cost -279.678780441
Pre-training layer 1, epoch 7, cost -276.413364487
Pre-training layer 1, epoch 8, cost -273.455042191
Pre-training layer 1, epoch 9, cost -271.123675613
Pre-training layer 1, epoch 10, cost -268.935503922
Pre-training layer 1, epoch 10, representative training free energy -62616.3561797
Pre-training layer 1, epoch 10, validation free energy -62137.4279102
Pre-training layer 1, epoch 11, cost -267.155259171
Pre-training layer 1, epoch 12, cost -265.563511353
Pre-training layer 1, epoch 13, cost -264.067144394
Pre-training layer 1, epoch 14, cost -262.781123505
Pre-training layer 1, epoch 15, cost -261.686504974
Pre-training layer 1, epoch 15, representative training free energy -65466.7507188
Pre-training layer 1, epoch 15, validation free energy -64964.9856641
Pre-training layer 1, epoch 16, cost -260.570843201
Pre-training layer 1, epoch 17, cost -259.768776779
Pre-training layer 1, epoch 18, cost -258.62096962
Pre-training layer 1, epoch 19, cost -257.813847961
Pre-training layer 1, epoch 20, cost -257.141968536
Pre-training layer 1, epoch 20, representative training free energy -67421.7153984
Pre-training layer 1, epoch 20, validation free energy -66905.8053867
Pre-training layer 1, epoch 21, cost -256.544321823
Pre-training layer 1, epoch 22, cost -255.522723465
Pre-training layer 1, epoch 23, cost -255.170797729
Pre-training layer 1, epoch 24, cost -254.669507675
Pre-training layer 1, epoch 25, cost -254.052089844
Pre-training layer 1, epoch 25, representative training free energy -68919.3338008
Pre-training layer 1, epoch 25, validation free energy -68393.1169375
Pre-training layer 1, epoch 26, cost -253.497596054
Pre-training layer 1, epoch 27, cost -253.003981094
Pre-training layer 1, epoch 28, cost -252.709154053
Pre-training layer 1, epoch 29, cost -252.166395264
Pre-training layer 1, epoch 30, cost -251.718207855
Pre-training layer 1, epoch 30, representative training free energy -70160.4366133
Pre-training layer 1, epoch 30, validation free energy -69622.2858789
Pre-training layer 1, epoch 31, cost -251.394835281
Pre-training layer 1, epoch 32, cost -250.986983032
Pre-training layer 1, epoch 33, cost -250.620303879
Pre-training layer 1, epoch 34, cost -250.235529861
Pre-training layer 1, epoch 35, cost -250.003305283
Pre-training layer 1, epoch 35, representative training free energy -71156.4688984
Pre-training layer 1, epoch 35, validation free energy -70609.4945859
Pre-training layer 1, epoch 36, cost -249.644542618
Pre-training layer 1, epoch 37, cost -249.433364944
Pre-training layer 1, epoch 38, cost -249.204251862
Pre-training layer 1, epoch 39, cost -248.865050659
Pre-training layer 1, epoch 40, cost -248.608696365
Pre-training layer 1, epoch 40, representative training free energy -72106.7512266
Pre-training layer 1, epoch 40, validation free energy -71552.4018672
Pre-training layer 1, epoch 41, cost -248.368726959
Pre-training layer 1, epoch 42, cost -248.245701447
Pre-training layer 1, epoch 43, cost -247.943227768
Pre-training layer 1, epoch 44, cost -247.759339676
Pre-training layer 1, epoch 45, cost -247.502787399
Pre-training layer 1, epoch 45, representative training free energy -72851.5307305
Pre-training layer 1, epoch 45, validation free energy -72286.2521094
Pre-training layer 1, epoch 46, cost -247.214694138
Pre-training layer 1, epoch 47, cost -247.008162766
Pre-training layer 1, epoch 48, cost -246.926952896
Pre-training layer 1, epoch 49, cost -246.803930359
Pre-training layer 1, epoch 50, cost -246.580926971
Pre-training layer 1, epoch 50, representative training free energy -73441.3703711
Pre-training layer 1, epoch 50, validation free energy -72877.6257656
Pre-training layer 1, epoch 51, cost -246.376793213
Pre-training layer 1, epoch 52, cost -246.270979614
Pre-training layer 1, epoch 53, cost -246.035976257
Pre-training layer 1, epoch 54, cost -245.857695847
Pre-training layer 1, epoch 55, cost -245.73372612
Pre-training layer 1, epoch 55, representative training free energy -74139.1092852
Pre-training layer 1, epoch 55, validation free energy -73567.4928867
Pre-training layer 1, epoch 56, cost -245.682080536
Pre-training layer 1, epoch 57, cost -245.417210999
Pre-training layer 1, epoch 58, cost -245.288412781
Pre-training layer 1, epoch 59, cost -245.232105026
Pre-training layer 1, epoch 60, cost -244.99445076
Pre-training layer 1, epoch 60, representative training free energy -74746.5745859
Pre-training layer 1, epoch 60, validation free energy -74173.6283828
Pre-training layer 1, epoch 61, cost -244.881759796
Pre-training layer 1, epoch 62, cost -244.712973785
Pre-training layer 1, epoch 63, cost -244.676972961
Pre-training layer 1, epoch 64, cost -244.489239578
Pre-training layer 1, epoch 65, cost -244.521991119
Pre-training layer 1, epoch 65, representative training free energy -75228.6638203
Pre-training layer 1, epoch 65, validation free energy -74648.221418
Pre-training layer 1, epoch 66, cost -244.176248169
Pre-training layer 1, epoch 67, cost -244.159279556
Pre-training layer 1, epoch 68, cost -243.942321472
Pre-training layer 1, epoch 69, cost -243.913446808
Pre-training layer 1, epoch 70, cost -243.842723236
Pre-training layer 1, epoch 70, representative training free energy -75704.9102578
Pre-training layer 1, epoch 70, validation free energy -75122.5188906
Pre-training layer 1, epoch 71, cost -243.852748795
Pre-training layer 1, epoch 72, cost -243.619062271
Pre-training layer 1, epoch 73, cost -243.475705032
Pre-training layer 1, epoch 74, cost -243.508773499
Pre-training layer 1, epoch 75, cost -243.286188812
Pre-training layer 1, epoch 75, representative training free energy -76246.0196289
Pre-training layer 1, epoch 75, validation free energy -75658.6303164
Pre-training layer 1, epoch 76, cost -243.460884399
Pre-training layer 1, epoch 77, cost -243.229956055
Pre-training layer 1, epoch 78, cost -243.09138855
Pre-training layer 1, epoch 79, cost -242.992772675
Pre-training layer 1, epoch 80, cost -242.885029297
Pre-training layer 1, epoch 80, representative training free energy -76544.7176562
Pre-training layer 1, epoch 80, validation free energy -75957.6274961
Pre-training layer 1, epoch 81, cost -242.878721619
Pre-training layer 1, epoch 82, cost -242.646665726
Pre-training layer 1, epoch 83, cost -242.627190552
Pre-training layer 1, epoch 84, cost -242.618749619
Pre-training layer 1, epoch 85, cost -242.53320343
Pre-training layer 1, epoch 85, representative training free energy -76962.2431836
Pre-training layer 1, epoch 85, validation free energy -76371.9932305
Pre-training layer 1, epoch 86, cost -242.54339859
Pre-training layer 1, epoch 87, cost -242.32573349
Pre-training layer 1, epoch 88, cost -242.191737976
Pre-training layer 1, epoch 89, cost -242.232868652
Pre-training layer 1, epoch 90, cost -242.138272476
Pre-training layer 1, epoch 90, representative training free energy -77394.3795937
Pre-training layer 1, epoch 90, validation free energy -76802.7683242
Pre-training layer 1, epoch 91, cost -242.006927338
Pre-training layer 1, epoch 92, cost -242.028898926
Pre-training layer 1, epoch 93, cost -241.841873779
Pre-training layer 1, epoch 94, cost -241.747985611
Pre-training layer 1, epoch 95, cost -241.803568878
Pre-training layer 1, epoch 95, representative training free energy -77663.3182734
Pre-training layer 1, epoch 95, validation free energy -77073.2599727
Pre-training layer 1, epoch 96, cost -241.622814407
Pre-training layer 1, epoch 97, cost -241.781979599
Pre-training layer 1, epoch 98, cost -241.656999817
Pre-training layer 1, epoch 99, cost -241.625136032
Pre-training layer 2, epoch 0, cost -137.170611343
Pre-training layer 2, epoch 0, representative training free energy 2437.85054138
Pre-training layer 2, epoch 0, validation free energy 2444.34446301
Pre-training layer 2, epoch 1, cost -97.4922776413
Pre-training layer 2, epoch 2, cost -89.678803978
Pre-training layer 2, epoch 3, cost -85.0775214005
Pre-training layer 2, epoch 4, cost -82.2289026833
Pre-training layer 2, epoch 5, cost -79.9149146271
Pre-training layer 2, epoch 5, representative training free energy 3712.27790942
Pre-training layer 2, epoch 5, validation free energy 3698.14641565
Pre-training layer 2, epoch 6, cost -78.2410747719
Pre-training layer 2, epoch 7, cost -76.7519347382
Pre-training layer 2, epoch 8, cost -75.350656929
Pre-training layer 2, epoch 9, cost -74.5651376152
Pre-training layer 2, epoch 10, cost -73.5988480949
Pre-training layer 2, epoch 10, representative training free energy 4361.34175659
Pre-training layer 2, epoch 10, validation free energy 4340.31226392
Pre-training layer 2, epoch 11, cost -72.7939320183
Pre-training layer 2, epoch 12, cost -72.1809295845
Pre-training layer 2, epoch 13, cost -71.7225124931
Pre-training layer 2, epoch 14, cost -71.1318300629
Pre-training layer 2, epoch 15, cost -70.5929540634
Pre-training layer 2, epoch 15, representative training free energy 4809.76679956
Pre-training layer 2, epoch 15, validation free energy 4781.70255127
Pre-training layer 2, epoch 16, cost -70.0684539413
Pre-training layer 2, epoch 17, cost -69.7754158783
Pre-training layer 2, epoch 18, cost -69.3085448647
Pre-training layer 2, epoch 19, cost -68.9193566132
Pre-training layer 2, epoch 20, cost -68.6371825409
Pre-training layer 2, epoch 20, representative training free energy 5200.81361108
Pre-training layer 2, epoch 20, validation free energy 5170.57056714
Pre-training layer 2, epoch 21, cost -68.2570038223
Pre-training layer 2, epoch 22, cost -67.9436106682
Pre-training layer 2, epoch 23, cost -67.8408001709
Pre-training layer 2, epoch 24, cost -67.5307153893
Pre-training layer 2, epoch 25, cost -67.1924830818
Pre-training layer 2, epoch 25, representative training free energy 5513.88569189
Pre-training layer 2, epoch 25, validation free energy 5481.66333521
Pre-training layer 2, epoch 26, cost -67.0412040138
Pre-training layer 2, epoch 27, cost -66.8905088043
Pre-training layer 2, epoch 28, cost -66.6836884117
Pre-training layer 2, epoch 29, cost -66.509664917
Pre-training layer 2, epoch 30, cost -66.4080405235
Pre-training layer 2, epoch 30, representative training free energy 5831.7905979
Pre-training layer 2, epoch 30, validation free energy 5793.14577612
Pre-training layer 2, epoch 31, cost -66.1797120857
Pre-training layer 2, epoch 32, cost -66.0434142494
Pre-training layer 2, epoch 33, cost -65.9508986282
Pre-training layer 2, epoch 34, cost -65.7259584618
Pre-training layer 2, epoch 35, cost -65.6061292076
Pre-training layer 2, epoch 35, representative training free energy 6109.89264136
Pre-training layer 2, epoch 35, validation free energy 6066.23382568
Pre-training layer 2, epoch 36, cost -65.5037072945
Pre-training layer 2, epoch 37, cost -65.4773007965
Pre-training layer 2, epoch 38, cost -65.4519663429
Pre-training layer 2, epoch 39, cost -65.1307714272
Pre-training layer 2, epoch 40, cost -65.1333384705
Pre-training layer 2, epoch 40, representative training free energy 6375.98348682
Pre-training layer 2, epoch 40, validation free energy 6331.84326343
Pre-training layer 2, epoch 41, cost -64.9345908928
Pre-training layer 2, epoch 42, cost -64.9164748192
Pre-training layer 2, epoch 43, cost -64.7709041405
Pre-training layer 2, epoch 44, cost -64.6996249962
Pre-training layer 2, epoch 45, cost -64.6129647636
Pre-training layer 2, epoch 45, representative training free energy 6591.86559521
Pre-training layer 2, epoch 45, validation free energy 6549.55340332
Pre-training layer 2, epoch 46, cost -64.5146639442
Pre-training layer 2, epoch 47, cost -64.442227211
Pre-training layer 2, epoch 48, cost -64.3324834442
Pre-training layer 2, epoch 49, cost -64.2521669197
Pre-training layer 2, epoch 50, cost -64.1649384117
Pre-training layer 2, epoch 50, representative training free energy 6808.65357227
Pre-training layer 2, epoch 50, validation free energy 6756.74664648
Pre-training layer 2, epoch 51, cost -63.9296626854
Pre-training layer 2, epoch 52, cost -64.0374305534
Pre-training layer 2, epoch 53, cost -63.9395133972
Pre-training layer 2, epoch 54, cost -63.9574352264
Pre-training layer 2, epoch 55, cost -63.7334994888
Pre-training layer 2, epoch 55, representative training free energy 7004.44822852
Pre-training layer 2, epoch 55, validation free energy 6949.16593848
Pre-training layer 2, epoch 56, cost -63.7890466309
Pre-training layer 2, epoch 57, cost -63.6914509201
Pre-training layer 2, epoch 58, cost -63.6203723145
Pre-training layer 2, epoch 59, cost -63.6833226585
Pre-training layer 2, epoch 60, cost -63.7130058861
Pre-training layer 2, epoch 60, representative training free energy 7215.40907861
Pre-training layer 2, epoch 60, validation free energy 7159.08232324
Pre-training layer 2, epoch 61, cost -63.5182540321
Pre-training layer 2, epoch 62, cost -63.3217498779
Pre-training layer 2, epoch 63, cost -63.2785481834
Pre-training layer 2, epoch 64, cost -63.3150765038
Pre-training layer 2, epoch 65, cost -63.3712652779
Pre-training layer 2, epoch 65, representative training free energy 7396.41280859
Pre-training layer 2, epoch 65, validation free energy 7335.65245068
Pre-training layer 2, epoch 66, cost -63.2876605415
Pre-training layer 2, epoch 67, cost -63.1828487015
Pre-training layer 2, epoch 68, cost -63.2053111458
Pre-training layer 2, epoch 69, cost -63.0922688103
Pre-training layer 2, epoch 70, cost -63.0542433548
Pre-training layer 2, epoch 70, representative training free energy 7572.72975635
Pre-training layer 2, epoch 70, validation free energy 7509.58611377
Pre-training layer 2, epoch 71, cost -63.1122056198
Pre-training layer 2, epoch 72, cost -62.9613247108
Pre-training layer 2, epoch 73, cost -62.8892698479
Pre-training layer 2, epoch 74, cost -63.0119330406
Pre-training layer 2, epoch 75, cost -62.7814823723
Pre-training layer 2, epoch 75, representative training free energy 7737.18109326
Pre-training layer 2, epoch 75, validation free energy 7671.48383594
Pre-training layer 2, epoch 76, cost -62.7654267502
Pre-training layer 2, epoch 77, cost -62.8143479347
Pre-training layer 2, epoch 78, cost -62.6880841637
Pre-training layer 2, epoch 79, cost -62.7618564796
Pre-training layer 2, epoch 80, cost -62.5901372528
Pre-training layer 2, epoch 80, representative training free energy 7932.44066309
Pre-training layer 2, epoch 80, validation free energy 7866.10557471
Pre-training layer 2, epoch 81, cost -62.7373464203
Pre-training layer 2, epoch 82, cost -62.6431375504
Pre-training layer 2, epoch 83, cost -62.4865599823
Pre-training layer 2, epoch 84, cost -62.5562811089
Pre-training layer 2, epoch 85, cost -62.6333854866
Pre-training layer 2, epoch 85, representative training free energy 8091.70957861
Pre-training layer 2, epoch 85, validation free energy 8023.82467578
Pre-training layer 2, epoch 86, cost -62.431385994
Pre-training layer 2, epoch 87, cost -62.4783566093
Pre-training layer 2, epoch 88, cost -62.3496794128
Pre-training layer 2, epoch 89, cost -62.495087986
Pre-training layer 2, epoch 90, cost -62.4834173965
Pre-training layer 2, epoch 90, representative training free energy 8247.80065381
Pre-training layer 2, epoch 90, validation free energy 8174.93485205
Pre-training layer 2, epoch 91, cost -62.383556118
Pre-training layer 2, epoch 92, cost -62.3434624672
Pre-training layer 2, epoch 93, cost -62.2949450493
Pre-training layer 2, epoch 94, cost -62.1255405426
Pre-training layer 2, epoch 95, cost -62.2021741486
Pre-training layer 2, epoch 95, representative training free energy 8394.87095166
Pre-training layer 2, epoch 95, validation free energy 8319.87527051
Pre-training layer 2, epoch 96, cost -62.2741855049
Pre-training layer 2, epoch 97, cost -62.1736385918
Pre-training layer 2, epoch 98, cost -62.1217885399
Pre-training layer 2, epoch 99, cost -62.0704750252
The pretraining code for file dbn_loop.pyc ran for 5.41m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 33.800000 %
     epoch 1, minibatch 200/200, test error of best model 27.600000 %
epoch 2, minibatch 200/200, validation error 26.000000 %
     epoch 2, minibatch 200/200, test error of best model 16.800000 %
epoch 3, minibatch 200/200, validation error 24.600000 %
     epoch 3, minibatch 200/200, test error of best model 14.200000 %
epoch 4, minibatch 200/200, validation error 22.800000 %
     epoch 4, minibatch 200/200, test error of best model 12.200000 %
epoch 5, minibatch 200/200, validation error 21.800000 %
     epoch 5, minibatch 200/200, test error of best model 11.000000 %
epoch 6, minibatch 200/200, validation error 21.000000 %
     epoch 6, minibatch 200/200, test error of best model 9.600000 %
epoch 7, minibatch 200/200, validation error 20.600000 %
     epoch 7, minibatch 200/200, test error of best model 8.400000 %
epoch 8, minibatch 200/200, validation error 19.800000 %
     epoch 8, minibatch 200/200, test error of best model 8.800000 %
epoch 9, minibatch 200/200, validation error 20.000000 %
epoch 10, minibatch 200/200, validation error 20.000000 %
epoch 11, minibatch 200/200, validation error 19.000000 %
     epoch 11, minibatch 200/200, test error of best model 7.800000 %
epoch 12, minibatch 200/200, validation error 18.800000 %
     epoch 12, minibatch 200/200, test error of best model 7.600000 %
epoch 13, minibatch 200/200, validation error 18.600000 %
     epoch 13, minibatch 200/200, test error of best model 7.400000 %
epoch 14, minibatch 200/200, validation error 18.400000 %
     epoch 14, minibatch 200/200, test error of best model 7.400000 %
epoch 15, minibatch 200/200, validation error 18.000000 %
     epoch 15, minibatch 200/200, test error of best model 7.400000 %
epoch 16, minibatch 200/200, validation error 17.400000 %
     epoch 16, minibatch 200/200, test error of best model 7.200000 %
epoch 17, minibatch 200/200, validation error 17.400000 %
epoch 18, minibatch 200/200, validation error 17.400000 %
epoch 19, minibatch 200/200, validation error 17.400000 %
epoch 20, minibatch 200/200, validation error 17.600000 %
epoch 21, minibatch 200/200, validation error 17.600000 %
epoch 22, minibatch 200/200, validation error 17.400000 %
epoch 23, minibatch 200/200, validation error 17.400000 %
epoch 24, minibatch 200/200, validation error 17.400000 %
epoch 25, minibatch 200/200, validation error 17.400000 %
epoch 26, minibatch 200/200, validation error 17.400000 %
epoch 27, minibatch 200/200, validation error 17.400000 %
epoch 28, minibatch 200/200, validation error 17.400000 %
epoch 29, minibatch 200/200, validation error 17.400000 %
epoch 30, minibatch 200/200, validation error 17.400000 %
epoch 31, minibatch 200/200, validation error 17.400000 %
Optimization complete with best validation score of 17.400000 %, obtained at iteration 3200, with test performance 7.200000 %
The fine tuning code for file dbn_loop.pyc ran for 0.56m


==========Sample: (3000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.793059769
Pre-training layer 0, epoch 0, representative training free energy -561.386277954
Pre-training layer 0, epoch 0, validation free energy -555.645898254
Pre-training layer 0, epoch 1, cost -116.744912872
Pre-training layer 0, epoch 2, cost -108.070322342
Pre-training layer 0, epoch 3, cost -102.651903966
Pre-training layer 0, epoch 4, cost -99.4535554504
Pre-training layer 0, epoch 5, cost -96.6119871775
Pre-training layer 0, epoch 5, representative training free energy -503.026285278
Pre-training layer 0, epoch 5, validation free energy -494.051715576
Pre-training layer 0, epoch 6, cost -94.5089456431
Pre-training layer 0, epoch 7, cost -92.7471588898
Pre-training layer 0, epoch 8, cost -91.523343811
Pre-training layer 0, epoch 9, cost -90.1048709869
Pre-training layer 0, epoch 10, cost -89.2015055084
Pre-training layer 0, epoch 10, representative training free energy -481.272772766
Pre-training layer 0, epoch 10, validation free energy -472.605023376
Pre-training layer 0, epoch 11, cost -88.2178350576
Pre-training layer 0, epoch 12, cost -87.3045841726
Pre-training layer 0, epoch 13, cost -86.5740170288
Pre-training layer 0, epoch 14, cost -85.9673647436
Pre-training layer 0, epoch 15, cost -85.2473636754
Pre-training layer 0, epoch 15, representative training free energy -469.458938049
Pre-training layer 0, epoch 15, validation free energy -460.499661621
Pre-training layer 0, epoch 16, cost -84.7667057419
Pre-training layer 0, epoch 17, cost -84.193770752
Pre-training layer 0, epoch 18, cost -83.9466854095
Pre-training layer 0, epoch 19, cost -83.4732323329
Pre-training layer 0, epoch 20, cost -83.016976827
Pre-training layer 0, epoch 20, representative training free energy -458.959785095
Pre-training layer 0, epoch 20, validation free energy -448.863530762
Pre-training layer 0, epoch 21, cost -82.6995372899
Pre-training layer 0, epoch 22, cost -82.3975321198
Pre-training layer 0, epoch 23, cost -82.0026461029
Pre-training layer 0, epoch 24, cost -81.8461682383
Pre-training layer 0, epoch 25, cost -81.5536383057
Pre-training layer 0, epoch 25, representative training free energy -451.965088135
Pre-training layer 0, epoch 25, validation free energy -442.292463623
Pre-training layer 0, epoch 26, cost -81.06915109
Pre-training layer 0, epoch 27, cost -80.8545134608
Pre-training layer 0, epoch 28, cost -80.5500576401
Pre-training layer 0, epoch 29, cost -80.2329661814
Pre-training layer 0, epoch 30, cost -80.1552304077
Pre-training layer 0, epoch 30, representative training free energy -450.596664734
Pre-training layer 0, epoch 30, validation free energy -440.451860474
Pre-training layer 0, epoch 31, cost -79.9067255529
Pre-training layer 0, epoch 32, cost -79.9096704229
Pre-training layer 0, epoch 33, cost -79.4942265193
Pre-training layer 0, epoch 34, cost -79.2721051025
Pre-training layer 0, epoch 35, cost -79.1221212514
Pre-training layer 0, epoch 35, representative training free energy -447.714827271
Pre-training layer 0, epoch 35, validation free energy -437.119666077
Pre-training layer 0, epoch 36, cost -78.9186028926
Pre-training layer 0, epoch 37, cost -78.9039796956
Pre-training layer 0, epoch 38, cost -78.4509639994
Pre-training layer 0, epoch 39, cost -78.5364023463
Pre-training layer 0, epoch 40, cost -78.3916155116
Pre-training layer 0, epoch 40, representative training free energy -445.498503174
Pre-training layer 0, epoch 40, validation free energy -435.448535767
Pre-training layer 0, epoch 41, cost -78.1481939316
Pre-training layer 0, epoch 42, cost -78.0472009532
Pre-training layer 0, epoch 43, cost -78.000671374
Pre-training layer 0, epoch 44, cost -77.8653691101
Pre-training layer 0, epoch 45, cost -77.5096942774
Pre-training layer 0, epoch 45, representative training free energy -443.274696533
Pre-training layer 0, epoch 45, validation free energy -432.160541077
Pre-training layer 0, epoch 46, cost -77.3261736552
Pre-training layer 0, epoch 47, cost -77.1951615397
Pre-training layer 0, epoch 48, cost -77.0538021342
Pre-training layer 0, epoch 49, cost -76.9942385483
Pre-training layer 0, epoch 50, cost -76.8641453171
Pre-training layer 0, epoch 50, representative training free energy -438.614744751
Pre-training layer 0, epoch 50, validation free energy -427.636084229
Pre-training layer 0, epoch 51, cost -76.6849141057
Pre-training layer 0, epoch 52, cost -76.7085001246
Pre-training layer 0, epoch 53, cost -76.4898839442
Pre-training layer 0, epoch 54, cost -76.3872419357
Pre-training layer 0, epoch 55, cost -76.2906875356
Pre-training layer 0, epoch 55, representative training free energy -438.370358276
Pre-training layer 0, epoch 55, validation free energy -427.077303955
Pre-training layer 0, epoch 56, cost -76.2485705058
Pre-training layer 0, epoch 57, cost -76.2439101664
Pre-training layer 0, epoch 58, cost -76.1877231089
Pre-training layer 0, epoch 59, cost -75.9185056814
Pre-training layer 0, epoch 60, cost -75.884134407
Pre-training layer 0, epoch 60, representative training free energy -435.523662109
Pre-training layer 0, epoch 60, validation free energy -423.749593201
Pre-training layer 0, epoch 61, cost -75.7141427867
Pre-training layer 0, epoch 62, cost -75.6029454803
Pre-training layer 0, epoch 63, cost -75.4689101283
Pre-training layer 0, epoch 64, cost -75.4455257161
Pre-training layer 0, epoch 65, cost -75.3604443614
Pre-training layer 0, epoch 65, representative training free energy -434.534073242
Pre-training layer 0, epoch 65, validation free energy -423.236967285
Pre-training layer 0, epoch 66, cost -75.3741726049
Pre-training layer 0, epoch 67, cost -75.2667171097
Pre-training layer 0, epoch 68, cost -74.9786077881
Pre-training layer 0, epoch 69, cost -75.1999619929
Pre-training layer 0, epoch 70, cost -74.9728964996
Pre-training layer 0, epoch 70, representative training free energy -436.053147949
Pre-training layer 0, epoch 70, validation free energy -423.781905457
Pre-training layer 0, epoch 71, cost -75.02185407
Pre-training layer 0, epoch 72, cost -74.9343476868
Pre-training layer 0, epoch 73, cost -74.7003197352
Pre-training layer 0, epoch 74, cost -74.738789533
Pre-training layer 0, epoch 75, cost -74.5859855779
Pre-training layer 0, epoch 75, representative training free energy -434.197052429
Pre-training layer 0, epoch 75, validation free energy -421.810334045
Pre-training layer 0, epoch 76, cost -74.5998439407
Pre-training layer 0, epoch 77, cost -74.5173801549
Pre-training layer 0, epoch 78, cost -74.274715449
Pre-training layer 0, epoch 79, cost -74.2459602737
Pre-training layer 0, epoch 80, cost -74.2549668121
Pre-training layer 0, epoch 80, representative training free energy -433.424725342
Pre-training layer 0, epoch 80, validation free energy -421.222218628
Pre-training layer 0, epoch 81, cost -74.1409962718
Pre-training layer 0, epoch 82, cost -74.2410624441
Pre-training layer 0, epoch 83, cost -74.1185291926
Pre-training layer 0, epoch 84, cost -74.0079640961
Pre-training layer 0, epoch 85, cost -73.9157276026
Pre-training layer 0, epoch 85, representative training free energy -431.573334961
Pre-training layer 0, epoch 85, validation free energy -419.095760498
Pre-training layer 0, epoch 86, cost -73.9978025309
Pre-training layer 0, epoch 87, cost -73.813129247
Pre-training layer 0, epoch 88, cost -73.6951043574
Pre-training layer 0, epoch 89, cost -73.7854592641
Pre-training layer 0, epoch 90, cost -73.7946118673
Pre-training layer 0, epoch 90, representative training free energy -432.979846375
Pre-training layer 0, epoch 90, validation free energy -420.786429382
Pre-training layer 0, epoch 91, cost -73.6503224309
Pre-training layer 0, epoch 92, cost -73.6312792969
Pre-training layer 0, epoch 93, cost -73.4384689204
Pre-training layer 0, epoch 94, cost -73.5230489731
Pre-training layer 0, epoch 95, cost -73.5540677389
Pre-training layer 0, epoch 95, representative training free energy -429.100475403
Pre-training layer 0, epoch 95, validation free energy -416.620768433
Pre-training layer 0, epoch 96, cost -73.4571482595
Pre-training layer 0, epoch 97, cost -73.2200670751
Pre-training layer 0, epoch 98, cost -73.2377543004
Pre-training layer 0, epoch 99, cost -73.3400752894
Pre-training layer 1, epoch 0, cost -343.735772502
Pre-training layer 1, epoch 0, representative training free energy -50605.5218242
Pre-training layer 1, epoch 0, validation free energy -50188.0086563
Pre-training layer 1, epoch 1, cost -295.12538681
Pre-training layer 1, epoch 2, cost -280.052249095
Pre-training layer 1, epoch 3, cost -271.214558716
Pre-training layer 1, epoch 4, cost -265.298822123
Pre-training layer 1, epoch 5, cost -260.631237183
Pre-training layer 1, epoch 5, representative training free energy -68574.6413164
Pre-training layer 1, epoch 5, validation free energy -68019.8669023
Pre-training layer 1, epoch 6, cost -257.051335398
Pre-training layer 1, epoch 7, cost -254.196773783
Pre-training layer 1, epoch 8, cost -251.882071889
Pre-training layer 1, epoch 9, cost -249.724093119
Pre-training layer 1, epoch 10, cost -248.050517527
Pre-training layer 1, epoch 10, representative training free energy -73968.7493398
Pre-training layer 1, epoch 10, validation free energy -73364.7970117
Pre-training layer 1, epoch 11, cost -246.37055542
Pre-training layer 1, epoch 12, cost -245.109227549
Pre-training layer 1, epoch 13, cost -243.981609141
Pre-training layer 1, epoch 14, cost -242.966314596
Pre-training layer 1, epoch 15, cost -242.038689117
Pre-training layer 1, epoch 15, representative training free energy -77096.9246992
Pre-training layer 1, epoch 15, validation free energy -76470.2349531
Pre-training layer 1, epoch 16, cost -241.250195109
Pre-training layer 1, epoch 17, cost -240.286059265
Pre-training layer 1, epoch 18, cost -239.49926295
Pre-training layer 1, epoch 19, cost -239.008243256
Pre-training layer 1, epoch 20, cost -238.425604146
Pre-training layer 1, epoch 20, representative training free energy -79503.2425312
Pre-training layer 1, epoch 20, validation free energy -78853.5236797
Pre-training layer 1, epoch 21, cost -237.797644297
Pre-training layer 1, epoch 22, cost -237.245404205
Pre-training layer 1, epoch 23, cost -236.800291239
Pre-training layer 1, epoch 24, cost -236.277307332
Pre-training layer 1, epoch 25, cost -235.828659566
Pre-training layer 1, epoch 25, representative training free energy -81187.9517344
Pre-training layer 1, epoch 25, validation free energy -80527.5971719
Pre-training layer 1, epoch 26, cost -235.567689056
Pre-training layer 1, epoch 27, cost -235.041851095
Pre-training layer 1, epoch 28, cost -234.818447418
Pre-training layer 1, epoch 29, cost -234.314502462
Pre-training layer 1, epoch 30, cost -234.05913564
Pre-training layer 1, epoch 30, representative training free energy -82680.1791055
Pre-training layer 1, epoch 30, validation free energy -82004.0179883
Pre-training layer 1, epoch 31, cost -233.756185354
Pre-training layer 1, epoch 32, cost -233.543037364
Pre-training layer 1, epoch 33, cost -233.180667369
Pre-training layer 1, epoch 34, cost -233.133771617
Pre-training layer 1, epoch 35, cost -232.723321686
Pre-training layer 1, epoch 35, representative training free energy -83941.5762109
Pre-training layer 1, epoch 35, validation free energy -83248.6114297
Pre-training layer 1, epoch 36, cost -232.538399913
Pre-training layer 1, epoch 37, cost -232.271736755
Pre-training layer 1, epoch 38, cost -231.961417745
Pre-training layer 1, epoch 39, cost -231.821342367
Pre-training layer 1, epoch 40, cost -231.574145966
Pre-training layer 1, epoch 40, representative training free energy -84948.6138906
Pre-training layer 1, epoch 40, validation free energy -84261.0929609
Pre-training layer 1, epoch 41, cost -231.436293589
Pre-training layer 1, epoch 42, cost -231.148197225
Pre-training layer 1, epoch 43, cost -231.037730713
Pre-training layer 1, epoch 44, cost -230.751027069
Pre-training layer 1, epoch 45, cost -230.704349162
Pre-training layer 1, epoch 45, representative training free energy -85837.7630234
Pre-training layer 1, epoch 45, validation free energy -85139.1271875
Pre-training layer 1, epoch 46, cost -230.471650187
Pre-training layer 1, epoch 47, cost -230.453000844
Pre-training layer 1, epoch 48, cost -230.138464457
Pre-training layer 1, epoch 49, cost -229.941917216
Pre-training layer 1, epoch 50, cost -229.945652313
Pre-training layer 1, epoch 50, representative training free energy -86662.8934766
Pre-training layer 1, epoch 50, validation free energy -85957.3176055
Pre-training layer 1, epoch 51, cost -229.755791626
Pre-training layer 1, epoch 52, cost -229.648826141
Pre-training layer 1, epoch 53, cost -229.458650055
Pre-training layer 1, epoch 54, cost -229.28669632
Pre-training layer 1, epoch 55, cost -229.246187083
Pre-training layer 1, epoch 55, representative training free energy -87551.8390625
Pre-training layer 1, epoch 55, validation free energy -86834.3613398
Pre-training layer 1, epoch 56, cost -229.142121328
Pre-training layer 1, epoch 57, cost -228.931013997
Pre-training layer 1, epoch 58, cost -228.895908915
Pre-training layer 1, epoch 59, cost -228.808021291
Pre-training layer 1, epoch 60, cost -228.494190063
Pre-training layer 1, epoch 60, representative training free energy -88193.5991953
Pre-training layer 1, epoch 60, validation free energy -87479.1521602
Pre-training layer 1, epoch 61, cost -228.486681061
Pre-training layer 1, epoch 62, cost -228.443292033
Pre-training layer 1, epoch 63, cost -228.317118835
Pre-training layer 1, epoch 64, cost -228.134784342
Pre-training layer 1, epoch 65, cost -228.064659678
Pre-training layer 1, epoch 65, representative training free energy -88886.4294727
Pre-training layer 1, epoch 65, validation free energy -88160.487875
Pre-training layer 1, epoch 66, cost -228.058060252
Pre-training layer 1, epoch 67, cost -227.952646942
Pre-training layer 1, epoch 68, cost -227.799677785
Pre-training layer 1, epoch 69, cost -227.854712626
Pre-training layer 1, epoch 70, cost -227.67042923
Pre-training layer 1, epoch 70, representative training free energy -89477.5885078
Pre-training layer 1, epoch 70, validation free energy -88752.4221055
Pre-training layer 1, epoch 71, cost -227.500305176
Pre-training layer 1, epoch 72, cost -227.386581828
Pre-training layer 1, epoch 73, cost -227.391344554
Pre-training layer 1, epoch 74, cost -227.285620117
Pre-training layer 1, epoch 75, cost -227.062428996
Pre-training layer 1, epoch 75, representative training free energy -89970.7561289
Pre-training layer 1, epoch 75, validation free energy -89243.6983867
Pre-training layer 1, epoch 76, cost -227.071777496
Pre-training layer 1, epoch 77, cost -227.095397898
Pre-training layer 1, epoch 78, cost -226.9916804
Pre-training layer 1, epoch 79, cost -226.953313548
Pre-training layer 1, epoch 80, cost -226.826437581
Pre-training layer 1, epoch 80, representative training free energy -90548.3810078
Pre-training layer 1, epoch 80, validation free energy -89814.5087109
Pre-training layer 1, epoch 81, cost -226.713183594
Pre-training layer 1, epoch 82, cost -226.760521088
Pre-training layer 1, epoch 83, cost -226.670917257
Pre-training layer 1, epoch 84, cost -226.626497192
Pre-training layer 1, epoch 85, cost -226.553812917
Pre-training layer 1, epoch 85, representative training free energy -90954.3568203
Pre-training layer 1, epoch 85, validation free energy -90214.9153477
Pre-training layer 1, epoch 86, cost -226.428326721
Pre-training layer 1, epoch 87, cost -226.408914083
Pre-training layer 1, epoch 88, cost -226.373054555
Pre-training layer 1, epoch 89, cost -226.181353963
Pre-training layer 1, epoch 90, cost -226.09674408
Pre-training layer 1, epoch 90, representative training free energy -91538.4169219
Pre-training layer 1, epoch 90, validation free energy -90795.1544844
Pre-training layer 1, epoch 91, cost -226.020386353
Pre-training layer 1, epoch 92, cost -225.968432515
Pre-training layer 1, epoch 93, cost -225.972693024
Pre-training layer 1, epoch 94, cost -225.915016988
Pre-training layer 1, epoch 95, cost -225.900261993
Pre-training layer 1, epoch 95, representative training free energy -91953.5044375
Pre-training layer 1, epoch 95, validation free energy -91201.6706641
Pre-training layer 1, epoch 96, cost -225.849779867
Pre-training layer 1, epoch 97, cost -225.843153788
Pre-training layer 1, epoch 98, cost -225.757017517
Pre-training layer 1, epoch 99, cost -225.64375529
Pre-training layer 2, epoch 0, cost -128.030472412
Pre-training layer 2, epoch 0, representative training free energy 2874.26707898
Pre-training layer 2, epoch 0, validation free energy 2845.45808813
Pre-training layer 2, epoch 1, cost -93.9085639318
Pre-training layer 2, epoch 2, cost -86.6991962941
Pre-training layer 2, epoch 3, cost -82.5523516591
Pre-training layer 2, epoch 4, cost -79.7895133718
Pre-training layer 2, epoch 5, cost -77.8350641886
Pre-training layer 2, epoch 5, representative training free energy 4553.24879468
Pre-training layer 2, epoch 5, validation free energy 4517.1636875
Pre-training layer 2, epoch 6, cost -76.3128699239
Pre-training layer 2, epoch 7, cost -74.9343006261
Pre-training layer 2, epoch 8, cost -73.9124444071
Pre-training layer 2, epoch 9, cost -73.0503996658
Pre-training layer 2, epoch 10, cost -72.3468121719
Pre-training layer 2, epoch 10, representative training free energy 5568.16193286
Pre-training layer 2, epoch 10, validation free energy 5528.2527771
Pre-training layer 2, epoch 11, cost -71.5389937846
Pre-training layer 2, epoch 12, cost -71.0650588608
Pre-training layer 2, epoch 13, cost -70.5004356257
Pre-training layer 2, epoch 14, cost -69.815725174
Pre-training layer 2, epoch 15, cost -69.5316377767
Pre-training layer 2, epoch 15, representative training free energy 6246.70943188
Pre-training layer 2, epoch 15, validation free energy 6199.28610303
Pre-training layer 2, epoch 16, cost -69.2565690486
Pre-training layer 2, epoch 17, cost -68.8586730067
Pre-training layer 2, epoch 18, cost -68.5448965327
Pre-training layer 2, epoch 19, cost -68.1689264552
Pre-training layer 2, epoch 20, cost -67.8970344925
Pre-training layer 2, epoch 20, representative training free energy 6755.46696484
Pre-training layer 2, epoch 20, validation free energy 6699.39594727
Pre-training layer 2, epoch 21, cost -67.6615461858
Pre-training layer 2, epoch 22, cost -67.418460935
Pre-training layer 2, epoch 23, cost -67.20981589
Pre-training layer 2, epoch 24, cost -66.9806305822
Pre-training layer 2, epoch 25, cost -66.6851526515
Pre-training layer 2, epoch 25, representative training free energy 7194.67589404
Pre-training layer 2, epoch 25, validation free energy 7135.17084668
Pre-training layer 2, epoch 26, cost -66.5751684062
Pre-training layer 2, epoch 27, cost -66.4557035955
Pre-training layer 2, epoch 28, cost -66.295248553
Pre-training layer 2, epoch 29, cost -66.072098465
Pre-training layer 2, epoch 30, cost -65.9746665573
Pre-training layer 2, epoch 30, representative training free energy 7586.81929785
Pre-training layer 2, epoch 30, validation free energy 7523.08649365
Pre-training layer 2, epoch 31, cost -65.8857709376
Pre-training layer 2, epoch 32, cost -65.6560580571
Pre-training layer 2, epoch 33, cost -65.6470746613
Pre-training layer 2, epoch 34, cost -65.3706031545
Pre-training layer 2, epoch 35, cost -65.3506153361
Pre-training layer 2, epoch 35, representative training free energy 7928.30866113
Pre-training layer 2, epoch 35, validation free energy 7860.35984961
Pre-training layer 2, epoch 36, cost -65.2209001795
Pre-training layer 2, epoch 37, cost -65.1368958155
Pre-training layer 2, epoch 38, cost -64.9531613286
Pre-training layer 2, epoch 39, cost -65.0070202764
Pre-training layer 2, epoch 40, cost -64.9591116333
Pre-training layer 2, epoch 40, representative training free energy 8268.8540791
Pre-training layer 2, epoch 40, validation free energy 8198.001021
Pre-training layer 2, epoch 41, cost -64.7754392242
Pre-training layer 2, epoch 42, cost -64.7154442596
Pre-training layer 2, epoch 43, cost -64.6025995382
Pre-training layer 2, epoch 44, cost -64.5311936315
Pre-training layer 2, epoch 45, cost -64.5133477783
Pre-training layer 2, epoch 45, representative training free energy 8527.65108789
Pre-training layer 2, epoch 45, validation free energy 8458.15359814
Pre-training layer 2, epoch 46, cost -64.4664795685
Pre-training layer 2, epoch 47, cost -64.3807634099
Pre-training layer 2, epoch 48, cost -64.2982429759
Pre-training layer 2, epoch 49, cost -64.2690082041
Pre-training layer 2, epoch 50, cost -64.2203357951
Pre-training layer 2, epoch 50, representative training free energy 8831.39662939
Pre-training layer 2, epoch 50, validation free energy 8757.31808789
Pre-training layer 2, epoch 51, cost -64.1218880208
Pre-training layer 2, epoch 52, cost -63.9968984095
Pre-training layer 2, epoch 53, cost -64.0304418691
Pre-training layer 2, epoch 54, cost -63.8552817917
Pre-training layer 2, epoch 55, cost -63.9099255753
Pre-training layer 2, epoch 55, representative training free energy 9099.95910645
Pre-training layer 2, epoch 55, validation free energy 9026.78371094
Pre-training layer 2, epoch 56, cost -63.9183940252
Pre-training layer 2, epoch 57, cost -63.8535245641
Pre-training layer 2, epoch 58, cost -63.7586334483
Pre-training layer 2, epoch 59, cost -63.6045110575
Pre-training layer 2, epoch 60, cost -63.6431632106
Pre-training layer 2, epoch 60, representative training free energy 9346.46148682
Pre-training layer 2, epoch 60, validation free energy 9268.59088281
Pre-training layer 2, epoch 61, cost -63.5349723434
Pre-training layer 2, epoch 62, cost -63.4671223577
Pre-training layer 2, epoch 63, cost -63.5065868123
Pre-training layer 2, epoch 64, cost -63.3860717773
Pre-training layer 2, epoch 65, cost -63.3681523641
Pre-training layer 2, epoch 65, representative training free energy 9610.03940869
Pre-training layer 2, epoch 65, validation free energy 9531.63935889
Pre-training layer 2, epoch 66, cost -63.4500006485
Pre-training layer 2, epoch 67, cost -63.3641974513
Pre-training layer 2, epoch 68, cost -63.238923912
Pre-training layer 2, epoch 69, cost -63.221845665
Pre-training layer 2, epoch 70, cost -63.2329180654
Pre-training layer 2, epoch 70, representative training free energy 9808.6280625
Pre-training layer 2, epoch 70, validation free energy 9729.94438867
Pre-training layer 2, epoch 71, cost -63.2549462509
Pre-training layer 2, epoch 72, cost -63.3027628199
Pre-training layer 2, epoch 73, cost -63.13575737
Pre-training layer 2, epoch 74, cost -63.0233649445
Pre-training layer 2, epoch 75, cost -63.0401022593
Pre-training layer 2, epoch 75, representative training free energy 10043.1711821
Pre-training layer 2, epoch 75, validation free energy 9961.931125
Pre-training layer 2, epoch 76, cost -62.9699759165
Pre-training layer 2, epoch 77, cost -62.8970345179
Pre-training layer 2, epoch 78, cost -62.9337067795
Pre-training layer 2, epoch 79, cost -62.9449604543
Pre-training layer 2, epoch 80, cost -62.9119053777
Pre-training layer 2, epoch 80, representative training free energy 10223.6126577
Pre-training layer 2, epoch 80, validation free energy 10139.7596182
Pre-training layer 2, epoch 81, cost -62.8258885701
Pre-training layer 2, epoch 82, cost -62.7014935557
Pre-training layer 2, epoch 83, cost -62.7436285909
Pre-training layer 2, epoch 84, cost -62.7247074382
Pre-training layer 2, epoch 85, cost -62.7020297368
Pre-training layer 2, epoch 85, representative training free energy 10429.3217783
Pre-training layer 2, epoch 85, validation free energy 10343.692605
Pre-training layer 2, epoch 86, cost -62.7178562673
Pre-training layer 2, epoch 87, cost -62.7113313421
Pre-training layer 2, epoch 88, cost -62.7845999273
Pre-training layer 2, epoch 89, cost -62.6224893697
Pre-training layer 2, epoch 90, cost -62.590941391
Pre-training layer 2, epoch 90, representative training free energy 10630.6724619
Pre-training layer 2, epoch 90, validation free energy 10543.3955615
Pre-training layer 2, epoch 91, cost -62.6382308451
Pre-training layer 2, epoch 92, cost -62.5952817663
Pre-training layer 2, epoch 93, cost -62.4880577469
Pre-training layer 2, epoch 94, cost -62.4333155696
Pre-training layer 2, epoch 95, cost -62.4001941427
Pre-training layer 2, epoch 95, representative training free energy 10835.126688
Pre-training layer 2, epoch 95, validation free energy 10745.7513584
Pre-training layer 2, epoch 96, cost -62.4119284058
Pre-training layer 2, epoch 97, cost -62.3472036616
Pre-training layer 2, epoch 98, cost -62.4343755341
Pre-training layer 2, epoch 99, cost -62.4160948944
The pretraining code for file dbn_loop.pyc ran for 8.03m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 35.000000 %
     epoch 1, minibatch 300/300, test error of best model 30.800000 %
epoch 2, minibatch 300/300, validation error 28.000000 %
     epoch 2, minibatch 300/300, test error of best model 20.200000 %
epoch 3, minibatch 300/300, validation error 25.400000 %
     epoch 3, minibatch 300/300, test error of best model 16.800000 %
epoch 4, minibatch 300/300, validation error 24.400000 %
     epoch 4, minibatch 300/300, test error of best model 14.600000 %
epoch 5, minibatch 300/300, validation error 23.600000 %
     epoch 5, minibatch 300/300, test error of best model 13.000000 %
epoch 6, minibatch 300/300, validation error 23.000000 %
     epoch 6, minibatch 300/300, test error of best model 11.600000 %
epoch 7, minibatch 300/300, validation error 21.200000 %
     epoch 7, minibatch 300/300, test error of best model 10.000000 %
epoch 8, minibatch 300/300, validation error 20.000000 %
     epoch 8, minibatch 300/300, test error of best model 9.400000 %
epoch 9, minibatch 300/300, validation error 19.800000 %
     epoch 9, minibatch 300/300, test error of best model 9.000000 %
epoch 10, minibatch 300/300, validation error 19.200000 %
     epoch 10, minibatch 300/300, test error of best model 9.000000 %
epoch 11, minibatch 300/300, validation error 19.200000 %
epoch 12, minibatch 300/300, validation error 19.000000 %
     epoch 12, minibatch 300/300, test error of best model 7.400000 %
epoch 13, minibatch 300/300, validation error 18.800000 %
     epoch 13, minibatch 300/300, test error of best model 7.200000 %
epoch 14, minibatch 300/300, validation error 17.800000 %
     epoch 14, minibatch 300/300, test error of best model 6.600000 %
epoch 15, minibatch 300/300, validation error 17.600000 %
     epoch 15, minibatch 300/300, test error of best model 6.400000 %
epoch 16, minibatch 300/300, validation error 17.600000 %
epoch 17, minibatch 300/300, validation error 17.600000 %
epoch 18, minibatch 300/300, validation error 17.400000 %
     epoch 18, minibatch 300/300, test error of best model 6.400000 %
epoch 19, minibatch 300/300, validation error 17.200000 %
     epoch 19, minibatch 300/300, test error of best model 6.200000 %
epoch 20, minibatch 300/300, validation error 17.200000 %
epoch 21, minibatch 300/300, validation error 17.000000 %
     epoch 21, minibatch 300/300, test error of best model 6.200000 %
epoch 22, minibatch 300/300, validation error 17.200000 %
epoch 23, minibatch 300/300, validation error 17.000000 %
epoch 24, minibatch 300/300, validation error 16.800000 %
     epoch 24, minibatch 300/300, test error of best model 7.200000 %
epoch 25, minibatch 300/300, validation error 16.600000 %
     epoch 25, minibatch 300/300, test error of best model 7.000000 %
epoch 26, minibatch 300/300, validation error 16.400000 %
     epoch 26, minibatch 300/300, test error of best model 7.000000 %
epoch 27, minibatch 300/300, validation error 16.400000 %
epoch 28, minibatch 300/300, validation error 16.400000 %
epoch 29, minibatch 300/300, validation error 16.200000 %
     epoch 29, minibatch 300/300, test error of best model 7.000000 %
epoch 30, minibatch 300/300, validation error 16.200000 %
epoch 31, minibatch 300/300, validation error 16.200000 %
epoch 32, minibatch 300/300, validation error 16.400000 %
epoch 33, minibatch 300/300, validation error 16.800000 %
epoch 34, minibatch 300/300, validation error 16.800000 %
epoch 35, minibatch 300/300, validation error 16.600000 %
epoch 36, minibatch 300/300, validation error 16.200000 %
epoch 37, minibatch 300/300, validation error 16.200000 %
epoch 38, minibatch 300/300, validation error 16.200000 %
epoch 39, minibatch 300/300, validation error 16.200000 %
epoch 40, minibatch 300/300, validation error 16.200000 %
epoch 41, minibatch 300/300, validation error 16.400000 %
epoch 42, minibatch 300/300, validation error 16.400000 %
epoch 43, minibatch 300/300, validation error 16.400000 %
epoch 44, minibatch 300/300, validation error 16.400000 %
epoch 45, minibatch 300/300, validation error 16.200000 %
epoch 46, minibatch 300/300, validation error 16.200000 %
epoch 47, minibatch 300/300, validation error 16.000000 %
     epoch 47, minibatch 300/300, test error of best model 6.200000 %
epoch 48, minibatch 300/300, validation error 16.000000 %
epoch 49, minibatch 300/300, validation error 16.000000 %
epoch 50, minibatch 300/300, validation error 16.000000 %
epoch 51, minibatch 300/300, validation error 16.000000 %
epoch 52, minibatch 300/300, validation error 16.000000 %
epoch 53, minibatch 300/300, validation error 16.000000 %
epoch 54, minibatch 300/300, validation error 16.000000 %
epoch 55, minibatch 300/300, validation error 16.000000 %
epoch 56, minibatch 300/300, validation error 16.000000 %
epoch 57, minibatch 300/300, validation error 16.000000 %
epoch 58, minibatch 300/300, validation error 16.000000 %
epoch 59, minibatch 300/300, validation error 16.200000 %
epoch 60, minibatch 300/300, validation error 16.200000 %
epoch 61, minibatch 300/300, validation error 16.200000 %
epoch 62, minibatch 300/300, validation error 16.200000 %
epoch 63, minibatch 300/300, validation error 16.200000 %
epoch 64, minibatch 300/300, validation error 16.000000 %
epoch 65, minibatch 300/300, validation error 16.000000 %
epoch 66, minibatch 300/300, validation error 16.000000 %
epoch 67, minibatch 300/300, validation error 16.000000 %
epoch 68, minibatch 300/300, validation error 16.000000 %
epoch 69, minibatch 300/300, validation error 16.000000 %
epoch 70, minibatch 300/300, validation error 16.000000 %
epoch 71, minibatch 300/300, validation error 16.000000 %
epoch 72, minibatch 300/300, validation error 16.000000 %
epoch 73, minibatch 300/300, validation error 16.000000 %
epoch 74, minibatch 300/300, validation error 16.000000 %
epoch 75, minibatch 300/300, validation error 16.000000 %
epoch 76, minibatch 300/300, validation error 16.000000 %
epoch 77, minibatch 300/300, validation error 16.000000 %
epoch 78, minibatch 300/300, validation error 16.000000 %
epoch 79, minibatch 300/300, validation error 16.000000 %
epoch 80, minibatch 300/300, validation error 16.000000 %
epoch 81, minibatch 300/300, validation error 16.000000 %
epoch 82, minibatch 300/300, validation error 16.000000 %
epoch 83, minibatch 300/300, validation error 16.000000 %
epoch 84, minibatch 300/300, validation error 16.000000 %
epoch 85, minibatch 300/300, validation error 15.800000 %
     epoch 85, minibatch 300/300, test error of best model 6.800000 %
epoch 86, minibatch 300/300, validation error 15.800000 %
epoch 87, minibatch 300/300, validation error 15.800000 %
epoch 88, minibatch 300/300, validation error 15.800000 %
epoch 89, minibatch 300/300, validation error 15.800000 %
epoch 90, minibatch 300/300, validation error 15.800000 %
epoch 91, minibatch 300/300, validation error 15.800000 %
epoch 92, minibatch 300/300, validation error 15.800000 %
epoch 93, minibatch 300/300, validation error 15.800000 %
epoch 94, minibatch 300/300, validation error 15.800000 %
epoch 95, minibatch 300/300, validation error 15.800000 %
epoch 96, minibatch 300/300, validation error 15.800000 %
epoch 97, minibatch 300/300, validation error 15.600000 %
     epoch 97, minibatch 300/300, test error of best model 6.800000 %
epoch 98, minibatch 300/300, validation error 15.600000 %
epoch 99, minibatch 300/300, validation error 15.600000 %
epoch 100, minibatch 300/300, validation error 15.600000 %
epoch 101, minibatch 300/300, validation error 15.600000 %
epoch 102, minibatch 300/300, validation error 15.600000 %
epoch 103, minibatch 300/300, validation error 15.600000 %
epoch 104, minibatch 300/300, validation error 15.600000 %
epoch 105, minibatch 300/300, validation error 15.600000 %
epoch 106, minibatch 300/300, validation error 15.600000 %
epoch 107, minibatch 300/300, validation error 15.600000 %
epoch 108, minibatch 300/300, validation error 15.600000 %
epoch 109, minibatch 300/300, validation error 15.600000 %
epoch 110, minibatch 300/300, validation error 15.600000 %
epoch 111, minibatch 300/300, validation error 15.600000 %
epoch 112, minibatch 300/300, validation error 15.600000 %
epoch 113, minibatch 300/300, validation error 15.600000 %
epoch 114, minibatch 300/300, validation error 15.600000 %
epoch 115, minibatch 300/300, validation error 15.600000 %
epoch 116, minibatch 300/300, validation error 15.600000 %
epoch 117, minibatch 300/300, validation error 15.600000 %
epoch 118, minibatch 300/300, validation error 15.600000 %
epoch 119, minibatch 300/300, validation error 15.600000 %
epoch 120, minibatch 300/300, validation error 15.600000 %
epoch 121, minibatch 300/300, validation error 15.600000 %
epoch 122, minibatch 300/300, validation error 15.600000 %
epoch 123, minibatch 300/300, validation error 15.600000 %
epoch 124, minibatch 300/300, validation error 15.600000 %
epoch 125, minibatch 300/300, validation error 15.600000 %
epoch 126, minibatch 300/300, validation error 15.600000 %
epoch 127, minibatch 300/300, validation error 15.600000 %
epoch 128, minibatch 300/300, validation error 15.600000 %
epoch 129, minibatch 300/300, validation error 15.600000 %
epoch 130, minibatch 300/300, validation error 15.600000 %
epoch 131, minibatch 300/300, validation error 15.600000 %
epoch 132, minibatch 300/300, validation error 15.600000 %
epoch 133, minibatch 300/300, validation error 15.600000 %
epoch 134, minibatch 300/300, validation error 15.600000 %
epoch 135, minibatch 300/300, validation error 15.600000 %
epoch 136, minibatch 300/300, validation error 15.600000 %
epoch 137, minibatch 300/300, validation error 15.600000 %
epoch 138, minibatch 300/300, validation error 15.600000 %
epoch 139, minibatch 300/300, validation error 15.600000 %
epoch 140, minibatch 300/300, validation error 15.600000 %
epoch 141, minibatch 300/300, validation error 15.600000 %
epoch 142, minibatch 300/300, validation error 15.600000 %
epoch 143, minibatch 300/300, validation error 15.600000 %
epoch 144, minibatch 300/300, validation error 15.600000 %
epoch 145, minibatch 300/300, validation error 15.600000 %
epoch 146, minibatch 300/300, validation error 15.600000 %
epoch 147, minibatch 300/300, validation error 15.600000 %
epoch 148, minibatch 300/300, validation error 15.600000 %
epoch 149, minibatch 300/300, validation error 15.600000 %
epoch 150, minibatch 300/300, validation error 15.600000 %
epoch 151, minibatch 300/300, validation error 15.600000 %
epoch 152, minibatch 300/300, validation error 15.600000 %
epoch 153, minibatch 300/300, validation error 15.600000 %
epoch 154, minibatch 300/300, validation error 15.600000 %
epoch 155, minibatch 300/300, validation error 15.600000 %
epoch 156, minibatch 300/300, validation error 15.600000 %
epoch 157, minibatch 300/300, validation error 15.600000 %
epoch 158, minibatch 300/300, validation error 15.600000 %
epoch 159, minibatch 300/300, validation error 15.600000 %
epoch 160, minibatch 300/300, validation error 15.600000 %
epoch 161, minibatch 300/300, validation error 15.600000 %
epoch 162, minibatch 300/300, validation error 15.600000 %
epoch 163, minibatch 300/300, validation error 15.600000 %
epoch 164, minibatch 300/300, validation error 15.600000 %
epoch 165, minibatch 300/300, validation error 15.600000 %
epoch 166, minibatch 300/300, validation error 15.600000 %
epoch 167, minibatch 300/300, validation error 15.600000 %
epoch 168, minibatch 300/300, validation error 15.600000 %
epoch 169, minibatch 300/300, validation error 15.600000 %
epoch 170, minibatch 300/300, validation error 15.600000 %
epoch 171, minibatch 300/300, validation error 15.600000 %
epoch 172, minibatch 300/300, validation error 15.600000 %
epoch 173, minibatch 300/300, validation error 15.600000 %
epoch 174, minibatch 300/300, validation error 15.600000 %
epoch 175, minibatch 300/300, validation error 15.600000 %
epoch 176, minibatch 300/300, validation error 15.600000 %
epoch 177, minibatch 300/300, validation error 15.600000 %
epoch 178, minibatch 300/300, validation error 15.600000 %
epoch 179, minibatch 300/300, validation error 15.600000 %
epoch 180, minibatch 300/300, validation error 15.600000 %
epoch 181, minibatch 300/300, validation error 15.600000 %
epoch 182, minibatch 300/300, validation error 15.600000 %
epoch 183, minibatch 300/300, validation error 15.600000 %
epoch 184, minibatch 300/300, validation error 15.600000 %
epoch 185, minibatch 300/300, validation error 15.600000 %
epoch 186, minibatch 300/300, validation error 15.600000 %
epoch 187, minibatch 300/300, validation error 15.600000 %
epoch 188, minibatch 300/300, validation error 15.600000 %
epoch 189, minibatch 300/300, validation error 15.600000 %
epoch 190, minibatch 300/300, validation error 15.600000 %
epoch 191, minibatch 300/300, validation error 15.600000 %
epoch 192, minibatch 300/300, validation error 15.600000 %
epoch 193, minibatch 300/300, validation error 15.600000 %
Optimization complete with best validation score of 15.600000 %, obtained at iteration 29100, with test performance 6.800000 %
The fine tuning code for file dbn_loop.pyc ran for 4.93m


==========Sample: (4000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.288644466
Pre-training layer 0, epoch 0, representative training free energy -552.731021851
Pre-training layer 0, epoch 0, validation free energy -546.780763
Pre-training layer 0, epoch 1, cost -112.042449493
Pre-training layer 0, epoch 2, cost -103.871240959
Pre-training layer 0, epoch 3, cost -98.9272462273
Pre-training layer 0, epoch 4, cost -95.9726541901
Pre-training layer 0, epoch 5, cost -93.4420834732
Pre-training layer 0, epoch 5, representative training free energy -497.237087524
Pre-training layer 0, epoch 5, validation free energy -489.416801086
Pre-training layer 0, epoch 6, cost -91.7001010704
Pre-training layer 0, epoch 7, cost -90.0427134323
Pre-training layer 0, epoch 8, cost -89.0261446762
Pre-training layer 0, epoch 9, cost -87.8926608276
Pre-training layer 0, epoch 10, cost -86.8223317719
Pre-training layer 0, epoch 10, representative training free energy -472.792795166
Pre-training layer 0, epoch 10, validation free energy -464.563174744
Pre-training layer 0, epoch 11, cost -86.0355346203
Pre-training layer 0, epoch 12, cost -85.6234345055
Pre-training layer 0, epoch 13, cost -84.7147737122
Pre-training layer 0, epoch 14, cost -84.2077904415
Pre-training layer 0, epoch 15, cost -83.6671982574
Pre-training layer 0, epoch 15, representative training free energy -460.123432617
Pre-training layer 0, epoch 15, validation free energy -452.099502136
Pre-training layer 0, epoch 16, cost -83.2507840061
Pre-training layer 0, epoch 17, cost -82.704753685
Pre-training layer 0, epoch 18, cost -82.2921266079
Pre-training layer 0, epoch 19, cost -81.8878005695
Pre-training layer 0, epoch 20, cost -81.586851263
Pre-training layer 0, epoch 20, representative training free energy -452.968547119
Pre-training layer 0, epoch 20, validation free energy -444.044923401
Pre-training layer 0, epoch 21, cost -81.3080854893
Pre-training layer 0, epoch 22, cost -80.9709606075
Pre-training layer 0, epoch 23, cost -80.7611981106
Pre-training layer 0, epoch 24, cost -80.3628858662
Pre-training layer 0, epoch 25, cost -80.139997673
Pre-training layer 0, epoch 25, representative training free energy -447.044594543
Pre-training layer 0, epoch 25, validation free energy -438.097101746
Pre-training layer 0, epoch 26, cost -79.912732029
Pre-training layer 0, epoch 27, cost -79.7684366035
Pre-training layer 0, epoch 28, cost -79.4009958935
Pre-training layer 0, epoch 29, cost -79.3692093658
Pre-training layer 0, epoch 30, cost -79.015594244
Pre-training layer 0, epoch 30, representative training free energy -438.833169006
Pre-training layer 0, epoch 30, validation free energy -430.156429688
Pre-training layer 0, epoch 31, cost -78.7944559002
Pre-training layer 0, epoch 32, cost -78.5558731556
Pre-training layer 0, epoch 33, cost -78.5042783356
Pre-training layer 0, epoch 34, cost -78.2220566177
Pre-training layer 0, epoch 35, cost -78.1042342949
Pre-training layer 0, epoch 35, representative training free energy -433.786647217
Pre-training layer 0, epoch 35, validation free energy -425.278935974
Pre-training layer 0, epoch 36, cost -77.8724696922
Pre-training layer 0, epoch 37, cost -77.7917572117
Pre-training layer 0, epoch 38, cost -77.6994688702
Pre-training layer 0, epoch 39, cost -77.4798225403
Pre-training layer 0, epoch 40, cost -77.364223032
Pre-training layer 0, epoch 40, representative training free energy -436.379117981
Pre-training layer 0, epoch 40, validation free energy -427.10405304
Pre-training layer 0, epoch 41, cost -77.2505782986
Pre-training layer 0, epoch 42, cost -77.1216989517
Pre-training layer 0, epoch 43, cost -76.8932484627
Pre-training layer 0, epoch 44, cost -76.7949861813
Pre-training layer 0, epoch 45, cost -76.6700755596
Pre-training layer 0, epoch 45, representative training free energy -433.656909241
Pre-training layer 0, epoch 45, validation free energy -423.779326477
Pre-training layer 0, epoch 46, cost -76.6526830959
Pre-training layer 0, epoch 47, cost -76.4782570362
Pre-training layer 0, epoch 48, cost -76.3495150948
Pre-training layer 0, epoch 49, cost -76.3184032059
Pre-training layer 0, epoch 50, cost -76.0413479614
Pre-training layer 0, epoch 50, representative training free energy -433.374320129
Pre-training layer 0, epoch 50, validation free energy -423.2877146
Pre-training layer 0, epoch 51, cost -76.2352241993
Pre-training layer 0, epoch 52, cost -75.9257790184
Pre-training layer 0, epoch 53, cost -75.9186064529
Pre-training layer 0, epoch 54, cost -75.8764946461
Pre-training layer 0, epoch 55, cost -75.6567342854
Pre-training layer 0, epoch 55, representative training free energy -431.310552307
Pre-training layer 0, epoch 55, validation free energy -420.791108215
Pre-training layer 0, epoch 56, cost -75.5810315323
Pre-training layer 0, epoch 57, cost -75.580538969
Pre-training layer 0, epoch 58, cost -75.4615344715
Pre-training layer 0, epoch 59, cost -75.2517945671
Pre-training layer 0, epoch 60, cost -75.321523037
Pre-training layer 0, epoch 60, representative training free energy -429.369706787
Pre-training layer 0, epoch 60, validation free energy -419.358178955
Pre-training layer 0, epoch 61, cost -75.1814041138
Pre-training layer 0, epoch 62, cost -75.1351024818
Pre-training layer 0, epoch 63, cost -75.0865655041
Pre-training layer 0, epoch 64, cost -74.8039000416
Pre-training layer 0, epoch 65, cost -74.8844093513
Pre-training layer 0, epoch 65, representative training free energy -425.72304541
Pre-training layer 0, epoch 65, validation free energy -415.70884967
Pre-training layer 0, epoch 66, cost -74.7870960045
Pre-training layer 0, epoch 67, cost -74.8263225365
Pre-training layer 0, epoch 68, cost -74.6671280193
Pre-training layer 0, epoch 69, cost -74.6741260624
Pre-training layer 0, epoch 70, cost -74.5375375652
Pre-training layer 0, epoch 70, representative training free energy -425.834965027
Pre-training layer 0, epoch 70, validation free energy -415.12885083
Pre-training layer 0, epoch 71, cost -74.4852442455
Pre-training layer 0, epoch 72, cost -74.4801585102
Pre-training layer 0, epoch 73, cost -74.3431006622
Pre-training layer 0, epoch 74, cost -74.2834715366
Pre-training layer 0, epoch 75, cost -74.3004430294
Pre-training layer 0, epoch 75, representative training free energy -422.062688477
Pre-training layer 0, epoch 75, validation free energy -411.646803284
Pre-training layer 0, epoch 76, cost -74.2496436119
Pre-training layer 0, epoch 77, cost -74.0271952248
Pre-training layer 0, epoch 78, cost -74.1481460667
Pre-training layer 0, epoch 79, cost -74.0359455681
Pre-training layer 0, epoch 80, cost -73.8010577297
Pre-training layer 0, epoch 80, representative training free energy -422.167078796
Pre-training layer 0, epoch 80, validation free energy -411.57940271
Pre-training layer 0, epoch 81, cost -73.8699374676
Pre-training layer 0, epoch 82, cost -73.9728395367
Pre-training layer 0, epoch 83, cost -73.8499238873
Pre-training layer 0, epoch 84, cost -73.7436423969
Pre-training layer 0, epoch 85, cost -73.6916762829
Pre-training layer 0, epoch 85, representative training free energy -423.233960815
Pre-training layer 0, epoch 85, validation free energy -412.342904541
Pre-training layer 0, epoch 86, cost -73.5379053974
Pre-training layer 0, epoch 87, cost -73.59360466
Pre-training layer 0, epoch 88, cost -73.6017747498
Pre-training layer 0, epoch 89, cost -73.397108717
Pre-training layer 0, epoch 90, cost -73.3850585175
Pre-training layer 0, epoch 90, representative training free energy -421.597771057
Pre-training layer 0, epoch 90, validation free energy -410.716322449
Pre-training layer 0, epoch 91, cost -73.4206591034
Pre-training layer 0, epoch 92, cost -73.1602680683
Pre-training layer 0, epoch 93, cost -73.3432115936
Pre-training layer 0, epoch 94, cost -73.2062957001
Pre-training layer 0, epoch 95, cost -73.2052717876
Pre-training layer 0, epoch 95, representative training free energy -421.013125061
Pre-training layer 0, epoch 95, validation free energy -409.956083679
Pre-training layer 0, epoch 96, cost -73.089618578
Pre-training layer 0, epoch 97, cost -73.0925870132
Pre-training layer 0, epoch 98, cost -72.9848483753
Pre-training layer 0, epoch 99, cost -73.0609928226
Pre-training layer 1, epoch 0, cost -324.568277664
Pre-training layer 1, epoch 0, representative training free energy -56955.8947539
Pre-training layer 1, epoch 0, validation free energy -56459.1278477
Pre-training layer 1, epoch 1, cost -278.795306168
Pre-training layer 1, epoch 2, cost -265.036703796
Pre-training layer 1, epoch 3, cost -256.802867279
Pre-training layer 1, epoch 4, cost -251.192032623
Pre-training layer 1, epoch 5, cost -247.076407013
Pre-training layer 1, epoch 5, representative training free energy -76392.106082
Pre-training layer 1, epoch 5, validation free energy -75739.3738008
Pre-training layer 1, epoch 6, cost -243.750413742
Pre-training layer 1, epoch 7, cost -241.182712021
Pre-training layer 1, epoch 8, cost -239.117188187
Pre-training layer 1, epoch 9, cost -237.174647026
Pre-training layer 1, epoch 10, cost -235.836212578
Pre-training layer 1, epoch 10, representative training free energy -82350.6757695
Pre-training layer 1, epoch 10, validation free energy -81646.2342539
Pre-training layer 1, epoch 11, cost -234.461926727
Pre-training layer 1, epoch 12, cost -233.32410553
Pre-training layer 1, epoch 13, cost -232.265649223
Pre-training layer 1, epoch 14, cost -231.400964355
Pre-training layer 1, epoch 15, cost -230.658016472
Pre-training layer 1, epoch 15, representative training free energy -85750.9933906
Pre-training layer 1, epoch 15, validation free energy -85012.9692852
Pre-training layer 1, epoch 16, cost -229.876112442
Pre-training layer 1, epoch 17, cost -229.198844337
Pre-training layer 1, epoch 18, cost -228.496706543
Pre-training layer 1, epoch 19, cost -228.11151226
Pre-training layer 1, epoch 20, cost -227.463850288
Pre-training layer 1, epoch 20, representative training free energy -88182.6475625
Pre-training layer 1, epoch 20, validation free energy -87427.4425391
Pre-training layer 1, epoch 21, cost -226.918682289
Pre-training layer 1, epoch 22, cost -226.613369789
Pre-training layer 1, epoch 23, cost -226.163717461
Pre-training layer 1, epoch 24, cost -225.799865074
Pre-training layer 1, epoch 25, cost -225.282631302
Pre-training layer 1, epoch 25, representative training free energy -90183.1563594
Pre-training layer 1, epoch 25, validation free energy -89420.7866289
Pre-training layer 1, epoch 26, cost -225.016499825
Pre-training layer 1, epoch 27, cost -224.772038498
Pre-training layer 1, epoch 28, cost -224.438135796
Pre-training layer 1, epoch 29, cost -224.012253304
Pre-training layer 1, epoch 30, cost -223.692825546
Pre-training layer 1, epoch 30, representative training free energy -91765.6202695
Pre-training layer 1, epoch 30, validation free energy -90986.4615977
Pre-training layer 1, epoch 31, cost -223.558401642
Pre-training layer 1, epoch 32, cost -223.285461159
Pre-training layer 1, epoch 33, cost -223.042575455
Pre-training layer 1, epoch 34, cost -222.891936951
Pre-training layer 1, epoch 35, cost -222.513059387
Pre-training layer 1, epoch 35, representative training free energy -93172.6992109
Pre-training layer 1, epoch 35, validation free energy -92382.2628516
Pre-training layer 1, epoch 36, cost -222.382220383
Pre-training layer 1, epoch 37, cost -222.094165001
Pre-training layer 1, epoch 38, cost -221.95690239
Pre-training layer 1, epoch 39, cost -221.839159775
Pre-training layer 1, epoch 40, cost -221.624845467
Pre-training layer 1, epoch 40, representative training free energy -94404.279168
Pre-training layer 1, epoch 40, validation free energy -93603.0505703
Pre-training layer 1, epoch 41, cost -221.40385128
Pre-training layer 1, epoch 42, cost -221.26365181
Pre-training layer 1, epoch 43, cost -221.122961922
Pre-training layer 1, epoch 44, cost -220.893189926
Pre-training layer 1, epoch 45, cost -220.708050919
Pre-training layer 1, epoch 45, representative training free energy -95371.7887461
Pre-training layer 1, epoch 45, validation free energy -94565.3544883
Pre-training layer 1, epoch 46, cost -220.699927368
Pre-training layer 1, epoch 47, cost -220.509468346
Pre-training layer 1, epoch 48, cost -220.312062798
Pre-training layer 1, epoch 49, cost -220.170238762
Pre-training layer 1, epoch 50, cost -220.091409874
Pre-training layer 1, epoch 50, representative training free energy -96339.5029492
Pre-training layer 1, epoch 50, validation free energy -95524.441668
Pre-training layer 1, epoch 51, cost -219.872820053
Pre-training layer 1, epoch 52, cost -219.784048843
Pre-training layer 1, epoch 53, cost -219.672626266
Pre-training layer 1, epoch 54, cost -219.497092781
Pre-training layer 1, epoch 55, cost -219.493962517
Pre-training layer 1, epoch 55, representative training free energy -97278.237375
Pre-training layer 1, epoch 55, validation free energy -96459.7921016
Pre-training layer 1, epoch 56, cost -219.38329422
Pre-training layer 1, epoch 57, cost -219.250938644
Pre-training layer 1, epoch 58, cost -219.152963562
Pre-training layer 1, epoch 59, cost -219.006756172
Pre-training layer 1, epoch 60, cost -218.892793465
Pre-training layer 1, epoch 60, representative training free energy -98106.3118437
Pre-training layer 1, epoch 60, validation free energy -97274.1648008
Pre-training layer 1, epoch 61, cost -218.806349525
Pre-training layer 1, epoch 62, cost -218.619941559
Pre-training layer 1, epoch 63, cost -218.539230766
Pre-training layer 1, epoch 64, cost -218.592229767
Pre-training layer 1, epoch 65, cost -218.299982872
Pre-training layer 1, epoch 65, representative training free energy -98925.3910781
Pre-training layer 1, epoch 65, validation free energy -98082.9148516
Pre-training layer 1, epoch 66, cost -218.422276917
Pre-training layer 1, epoch 67, cost -218.2917342
Pre-training layer 1, epoch 68, cost -218.122812119
Pre-training layer 1, epoch 69, cost -218.07912674
Pre-training layer 1, epoch 70, cost -218.011886787
Pre-training layer 1, epoch 70, representative training free energy -99671.9365078
Pre-training layer 1, epoch 70, validation free energy -98832.3484688
Pre-training layer 1, epoch 71, cost -217.974243126
Pre-training layer 1, epoch 72, cost -217.882820206
Pre-training layer 1, epoch 73, cost -217.701743698
Pre-training layer 1, epoch 74, cost -217.707715263
Pre-training layer 1, epoch 75, cost -217.618665466
Pre-training layer 1, epoch 75, representative training free energy -100362.529844
Pre-training layer 1, epoch 75, validation free energy -99513.7593672
Pre-training layer 1, epoch 76, cost -217.478845062
Pre-training layer 1, epoch 77, cost -217.536435623
Pre-training layer 1, epoch 78, cost -217.446395531
Pre-training layer 1, epoch 79, cost -217.389501381
Pre-training layer 1, epoch 80, cost -217.223578949
Pre-training layer 1, epoch 80, representative training free energy -100993.620117
Pre-training layer 1, epoch 80, validation free energy -100140.459977
Pre-training layer 1, epoch 81, cost -217.185880852
Pre-training layer 1, epoch 82, cost -217.086703224
Pre-training layer 1, epoch 83, cost -216.966398048
Pre-training layer 1, epoch 84, cost -217.024847679
Pre-training layer 1, epoch 85, cost -216.921301003
Pre-training layer 1, epoch 85, representative training free energy -101609.651195
Pre-training layer 1, epoch 85, validation free energy -100754.802219
Pre-training layer 1, epoch 86, cost -216.800933189
Pre-training layer 1, epoch 87, cost -216.825146637
Pre-training layer 1, epoch 88, cost -216.713328171
Pre-training layer 1, epoch 89, cost -216.661173592
Pre-training layer 1, epoch 90, cost -216.67225647
Pre-training layer 1, epoch 90, representative training free energy -102147.062586
Pre-training layer 1, epoch 90, validation free energy -101287.976812
Pre-training layer 1, epoch 91, cost -216.574764137
Pre-training layer 1, epoch 92, cost -216.438284721
Pre-training layer 1, epoch 93, cost -216.437074928
Pre-training layer 1, epoch 94, cost -216.371505165
Pre-training layer 1, epoch 95, cost -216.361028481
Pre-training layer 1, epoch 95, representative training free energy -102634.357758
Pre-training layer 1, epoch 95, validation free energy -101766.68293
Pre-training layer 1, epoch 96, cost -216.318438148
Pre-training layer 1, epoch 97, cost -216.263731842
Pre-training layer 1, epoch 98, cost -216.190522308
Pre-training layer 1, epoch 99, cost -216.073599625
Pre-training layer 2, epoch 0, cost -118.826301937
Pre-training layer 2, epoch 0, representative training free energy 3539.47579065
Pre-training layer 2, epoch 0, validation free energy 3478.81866479
Pre-training layer 2, epoch 1, cost -88.6890197945
Pre-training layer 2, epoch 2, cost -82.2036648941
Pre-training layer 2, epoch 3, cost -78.3675920582
Pre-training layer 2, epoch 4, cost -76.019239006
Pre-training layer 2, epoch 5, cost -74.1053946877
Pre-training layer 2, epoch 5, representative training free energy 5937.74637305
Pre-training layer 2, epoch 5, validation free energy 5884.33167773
Pre-training layer 2, epoch 6, cost -72.5321808624
Pre-training layer 2, epoch 7, cost -71.5750713539
Pre-training layer 2, epoch 8, cost -70.6375833511
Pre-training layer 2, epoch 9, cost -69.9204948997
Pre-training layer 2, epoch 10, cost -69.1860371494
Pre-training layer 2, epoch 10, representative training free energy 7029.62321094
Pre-training layer 2, epoch 10, validation free energy 6963.3687334
Pre-training layer 2, epoch 11, cost -68.5866145897
Pre-training layer 2, epoch 12, cost -68.0141189766
Pre-training layer 2, epoch 13, cost -67.5681528187
Pre-training layer 2, epoch 14, cost -67.2059444714
Pre-training layer 2, epoch 15, cost -66.8342912579
Pre-training layer 2, epoch 15, representative training free energy 7845.85891455
Pre-training layer 2, epoch 15, validation free energy 7773.04863867
Pre-training layer 2, epoch 16, cost -66.5044700909
Pre-training layer 2, epoch 17, cost -66.1799248219
Pre-training layer 2, epoch 18, cost -65.8746860409
Pre-training layer 2, epoch 19, cost -65.6604152489
Pre-training layer 2, epoch 20, cost -65.4552663803
Pre-training layer 2, epoch 20, representative training free energy 8546.3065874
Pre-training layer 2, epoch 20, validation free energy 8466.52662109
Pre-training layer 2, epoch 21, cost -65.1697254276
Pre-training layer 2, epoch 22, cost -64.9204639149
Pre-training layer 2, epoch 23, cost -64.8060294819
Pre-training layer 2, epoch 24, cost -64.6336218452
Pre-training layer 2, epoch 25, cost -64.3820288754
Pre-training layer 2, epoch 25, representative training free energy 9082.4673335
Pre-training layer 2, epoch 25, validation free energy 8999.28533057
Pre-training layer 2, epoch 26, cost -64.2886903381
Pre-training layer 2, epoch 27, cost -64.1545511055
Pre-training layer 2, epoch 28, cost -64.0481348419
Pre-training layer 2, epoch 29, cost -63.810460043
Pre-training layer 2, epoch 30, cost -63.8229762077
Pre-training layer 2, epoch 30, representative training free energy 9548.14456982
Pre-training layer 2, epoch 30, validation free energy 9459.48660352
Pre-training layer 2, epoch 31, cost -63.6101105022
Pre-training layer 2, epoch 32, cost -63.5315955734
Pre-training layer 2, epoch 33, cost -63.4769343853
Pre-training layer 2, epoch 34, cost -63.3738604736
Pre-training layer 2, epoch 35, cost -63.1822064018
Pre-training layer 2, epoch 35, representative training free energy 9951.56088135
Pre-training layer 2, epoch 35, validation free energy 9858.68976074
Pre-training layer 2, epoch 36, cost -63.1797838306
Pre-training layer 2, epoch 37, cost -63.1062151718
Pre-training layer 2, epoch 38, cost -63.0239260578
Pre-training layer 2, epoch 39, cost -62.8877808285
Pre-training layer 2, epoch 40, cost -62.7591901112
Pre-training layer 2, epoch 40, representative training free energy 10362.8091367
Pre-training layer 2, epoch 40, validation free energy 10265.2839004
Pre-training layer 2, epoch 41, cost -62.7723260593
Pre-training layer 2, epoch 42, cost -62.6495769882
Pre-training layer 2, epoch 43, cost -62.6722727203
Pre-training layer 2, epoch 44, cost -62.4367086315
Pre-training layer 2, epoch 45, cost -62.4826519299
Pre-training layer 2, epoch 45, representative training free energy 10737.6826177
Pre-training layer 2, epoch 45, validation free energy 10637.6697339
Pre-training layer 2, epoch 46, cost -62.391170969
Pre-training layer 2, epoch 47, cost -62.2956037045
Pre-training layer 2, epoch 48, cost -62.2519567299
Pre-training layer 2, epoch 49, cost -62.230017004
Pre-training layer 2, epoch 50, cost -62.1757401848
Pre-training layer 2, epoch 50, representative training free energy 11065.4413096
Pre-training layer 2, epoch 50, validation free energy 10960.5961187
Pre-training layer 2, epoch 51, cost -62.1086921406
Pre-training layer 2, epoch 52, cost -62.0628933239
Pre-training layer 2, epoch 53, cost -62.0788252449
Pre-training layer 2, epoch 54, cost -61.9018430519
Pre-training layer 2, epoch 55, cost -61.8447603226
Pre-training layer 2, epoch 55, representative training free energy 11417.5589707
Pre-training layer 2, epoch 55, validation free energy 11310.3017754
Pre-training layer 2, epoch 56, cost -61.8726283455
Pre-training layer 2, epoch 57, cost -61.783794136
Pre-training layer 2, epoch 58, cost -61.8498182869
Pre-training layer 2, epoch 59, cost -61.7249605179
Pre-training layer 2, epoch 60, cost -61.6552597904
Pre-training layer 2, epoch 60, representative training free energy 11716.4197383
Pre-training layer 2, epoch 60, validation free energy 11606.3550205
Pre-training layer 2, epoch 61, cost -61.6638762951
Pre-training layer 2, epoch 62, cost -61.6394454288
Pre-training layer 2, epoch 63, cost -61.6359824657
Pre-training layer 2, epoch 64, cost -61.6091131401
Pre-training layer 2, epoch 65, cost -61.553428278
Pre-training layer 2, epoch 65, representative training free energy 12039.9994102
Pre-training layer 2, epoch 65, validation free energy 11926.8096494
Pre-training layer 2, epoch 66, cost -61.5485685539
Pre-training layer 2, epoch 67, cost -61.5088003063
Pre-training layer 2, epoch 68, cost -61.4599417686
Pre-training layer 2, epoch 69, cost -61.3629646587
Pre-training layer 2, epoch 70, cost -61.3195044518
Pre-training layer 2, epoch 70, representative training free energy 12347.27221
Pre-training layer 2, epoch 70, validation free energy 12231.2376387
Pre-training layer 2, epoch 71, cost -61.3665679169
Pre-training layer 2, epoch 72, cost -61.3190023136
Pre-training layer 2, epoch 73, cost -61.2670660305
Pre-training layer 2, epoch 74, cost -61.1948678875
Pre-training layer 2, epoch 75, cost -61.188296566
Pre-training layer 2, epoch 75, representative training free energy 12573.8250303
Pre-training layer 2, epoch 75, validation free energy 12455.0881191
Pre-training layer 2, epoch 76, cost -61.1692318439
Pre-training layer 2, epoch 77, cost -61.1058349514
Pre-training layer 2, epoch 78, cost -61.1271163177
Pre-training layer 2, epoch 79, cost -61.0727307701
Pre-training layer 2, epoch 80, cost -61.0801405334
Pre-training layer 2, epoch 80, representative training free energy 12879.6371064
Pre-training layer 2, epoch 80, validation free energy 12758.5243379
Pre-training layer 2, epoch 81, cost -61.043809948
Pre-training layer 2, epoch 82, cost -61.0320911503
Pre-training layer 2, epoch 83, cost -61.0417940426
Pre-training layer 2, epoch 84, cost -60.9400667381
Pre-training layer 2, epoch 85, cost -60.9893910503
Pre-training layer 2, epoch 85, representative training free energy 13153.7149033
Pre-training layer 2, epoch 85, validation free energy 13030.0963467
Pre-training layer 2, epoch 86, cost -60.9473826981
Pre-training layer 2, epoch 87, cost -60.9016422844
Pre-training layer 2, epoch 88, cost -60.8920299149
Pre-training layer 2, epoch 89, cost -60.8169396877
Pre-training layer 2, epoch 90, cost -60.8333662796
Pre-training layer 2, epoch 90, representative training free energy 13399.9601201
Pre-training layer 2, epoch 90, validation free energy 13272.2823506
Pre-training layer 2, epoch 91, cost -60.7743640518
Pre-training layer 2, epoch 92, cost -60.8040343189
Pre-training layer 2, epoch 93, cost -60.7181460667
Pre-training layer 2, epoch 94, cost -60.6270725822
Pre-training layer 2, epoch 95, cost -60.7300623798
Pre-training layer 2, epoch 95, representative training free energy 13636.201915
Pre-training layer 2, epoch 95, validation free energy 13508.4695264
Pre-training layer 2, epoch 96, cost -60.7046791458
Pre-training layer 2, epoch 97, cost -60.7048843098
Pre-training layer 2, epoch 98, cost -60.7199346066
Pre-training layer 2, epoch 99, cost -60.5982718658
The pretraining code for file dbn_loop.pyc ran for 10.76m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 36.400000 %
     epoch 1, minibatch 400/400, test error of best model 31.800000 %
epoch 2, minibatch 400/400, validation error 26.200000 %
     epoch 2, minibatch 400/400, test error of best model 17.800000 %
epoch 3, minibatch 400/400, validation error 24.000000 %
     epoch 3, minibatch 400/400, test error of best model 14.400000 %
epoch 4, minibatch 400/400, validation error 21.400000 %
     epoch 4, minibatch 400/400, test error of best model 11.800000 %
epoch 5, minibatch 400/400, validation error 20.200000 %
     epoch 5, minibatch 400/400, test error of best model 11.000000 %
epoch 6, minibatch 400/400, validation error 20.400000 %
epoch 7, minibatch 400/400, validation error 19.400000 %
     epoch 7, minibatch 400/400, test error of best model 9.000000 %
epoch 8, minibatch 400/400, validation error 18.600000 %
     epoch 8, minibatch 400/400, test error of best model 8.200000 %
epoch 9, minibatch 400/400, validation error 18.200000 %
     epoch 9, minibatch 400/400, test error of best model 7.400000 %
epoch 10, minibatch 400/400, validation error 17.000000 %
     epoch 10, minibatch 400/400, test error of best model 7.600000 %
epoch 11, minibatch 400/400, validation error 17.000000 %
epoch 12, minibatch 400/400, validation error 17.000000 %
epoch 13, minibatch 400/400, validation error 16.800000 %
     epoch 13, minibatch 400/400, test error of best model 7.400000 %
epoch 14, minibatch 400/400, validation error 16.600000 %
     epoch 14, minibatch 400/400, test error of best model 7.000000 %
epoch 15, minibatch 400/400, validation error 16.600000 %
epoch 16, minibatch 400/400, validation error 16.800000 %
epoch 17, minibatch 400/400, validation error 16.600000 %
epoch 18, minibatch 400/400, validation error 16.600000 %
epoch 19, minibatch 400/400, validation error 16.600000 %
epoch 20, minibatch 400/400, validation error 16.600000 %
epoch 21, minibatch 400/400, validation error 16.800000 %
epoch 22, minibatch 400/400, validation error 16.800000 %
epoch 23, minibatch 400/400, validation error 16.600000 %
epoch 24, minibatch 400/400, validation error 16.600000 %
epoch 25, minibatch 400/400, validation error 16.600000 %
epoch 26, minibatch 400/400, validation error 16.600000 %
epoch 27, minibatch 400/400, validation error 16.400000 %
     epoch 27, minibatch 400/400, test error of best model 5.800000 %
epoch 28, minibatch 400/400, validation error 16.400000 %
epoch 29, minibatch 400/400, validation error 16.600000 %
epoch 30, minibatch 400/400, validation error 16.600000 %
epoch 31, minibatch 400/400, validation error 16.600000 %
epoch 32, minibatch 400/400, validation error 16.400000 %
epoch 33, minibatch 400/400, validation error 16.600000 %
epoch 34, minibatch 400/400, validation error 16.400000 %
epoch 35, minibatch 400/400, validation error 16.400000 %
epoch 36, minibatch 400/400, validation error 16.400000 %
epoch 37, minibatch 400/400, validation error 16.400000 %
epoch 38, minibatch 400/400, validation error 16.400000 %
epoch 39, minibatch 400/400, validation error 16.400000 %
epoch 40, minibatch 400/400, validation error 16.400000 %
epoch 41, minibatch 400/400, validation error 16.600000 %
epoch 42, minibatch 400/400, validation error 16.600000 %
epoch 43, minibatch 400/400, validation error 16.600000 %
epoch 44, minibatch 400/400, validation error 16.800000 %
epoch 45, minibatch 400/400, validation error 16.600000 %
epoch 46, minibatch 400/400, validation error 16.800000 %
epoch 47, minibatch 400/400, validation error 16.800000 %
epoch 48, minibatch 400/400, validation error 16.800000 %
epoch 49, minibatch 400/400, validation error 16.800000 %
epoch 50, minibatch 400/400, validation error 16.800000 %
epoch 51, minibatch 400/400, validation error 16.800000 %
epoch 52, minibatch 400/400, validation error 16.800000 %
epoch 53, minibatch 400/400, validation error 16.800000 %
Optimization complete with best validation score of 16.400000 %, obtained at iteration 10800, with test performance 5.800000 %
The fine tuning code for file dbn_loop.pyc ran for 1.73m


==========Sample: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.552441254
Pre-training layer 0, epoch 0, representative training free energy -546.826876343
Pre-training layer 0, epoch 0, validation free energy -540.235111206
Pre-training layer 0, epoch 1, cost -108.692114944
Pre-training layer 0, epoch 2, cost -100.847324814
Pre-training layer 0, epoch 3, cost -96.375210968
Pre-training layer 0, epoch 4, cost -93.5914134064
Pre-training layer 0, epoch 5, cost -91.2489125977
Pre-training layer 0, epoch 5, representative training free energy -489.896064941
Pre-training layer 0, epoch 5, validation free energy -482.739450989
Pre-training layer 0, epoch 6, cost -89.5395116882
Pre-training layer 0, epoch 7, cost -88.2312384338
Pre-training layer 0, epoch 8, cost -87.0797205505
Pre-training layer 0, epoch 9, cost -86.1034923935
Pre-training layer 0, epoch 10, cost -85.2979600372
Pre-training layer 0, epoch 10, representative training free energy -468.284209229
Pre-training layer 0, epoch 10, validation free energy -461.055428406
Pre-training layer 0, epoch 11, cost -84.5719844284
Pre-training layer 0, epoch 12, cost -83.7720772095
Pre-training layer 0, epoch 13, cost -83.3855696487
Pre-training layer 0, epoch 14, cost -82.7905334778
Pre-training layer 0, epoch 15, cost -82.335029129
Pre-training layer 0, epoch 15, representative training free energy -456.42598291
Pre-training layer 0, epoch 15, validation free energy -448.56262085
Pre-training layer 0, epoch 16, cost -82.1507733765
Pre-training layer 0, epoch 17, cost -81.5299389572
Pre-training layer 0, epoch 18, cost -81.3422198639
Pre-training layer 0, epoch 19, cost -80.8378055954
Pre-training layer 0, epoch 20, cost -80.5327532883
Pre-training layer 0, epoch 20, representative training free energy -453.624159424
Pre-training layer 0, epoch 20, validation free energy -445.440912903
Pre-training layer 0, epoch 21, cost -80.2276689911
Pre-training layer 0, epoch 22, cost -80.0389217453
Pre-training layer 0, epoch 23, cost -79.5895377884
Pre-training layer 0, epoch 24, cost -79.43066436
Pre-training layer 0, epoch 25, cost -79.2958055191
Pre-training layer 0, epoch 25, representative training free energy -444.866656128
Pre-training layer 0, epoch 25, validation free energy -436.323797791
Pre-training layer 0, epoch 26, cost -79.0206998215
Pre-training layer 0, epoch 27, cost -78.782497139
Pre-training layer 0, epoch 28, cost -78.5628285522
Pre-training layer 0, epoch 29, cost -78.3687365646
Pre-training layer 0, epoch 30, cost -78.1518499908
Pre-training layer 0, epoch 30, representative training free energy -442.084140442
Pre-training layer 0, epoch 30, validation free energy -433.957042725
Pre-training layer 0, epoch 31, cost -77.9407150497
Pre-training layer 0, epoch 32, cost -77.7888996201
Pre-training layer 0, epoch 33, cost -77.7965331039
Pre-training layer 0, epoch 34, cost -77.6370898361
Pre-training layer 0, epoch 35, cost -77.3780537949
Pre-training layer 0, epoch 35, representative training free energy -439.991700317
Pre-training layer 0, epoch 35, validation free energy -431.194303345
Pre-training layer 0, epoch 36, cost -77.3282465286
Pre-training layer 0, epoch 37, cost -77.1367435455
Pre-training layer 0, epoch 38, cost -77.0722095566
Pre-training layer 0, epoch 39, cost -76.8125671158
Pre-training layer 0, epoch 40, cost -76.6559454269
Pre-training layer 0, epoch 40, representative training free energy -439.247128357
Pre-training layer 0, epoch 40, validation free energy -429.966735718
Pre-training layer 0, epoch 41, cost -76.6038962708
Pre-training layer 0, epoch 42, cost -76.5566773224
Pre-training layer 0, epoch 43, cost -76.3568322144
Pre-training layer 0, epoch 44, cost -76.3170046616
Pre-training layer 0, epoch 45, cost -76.0744522934
Pre-training layer 0, epoch 45, representative training free energy -437.241773682
Pre-training layer 0, epoch 45, validation free energy -427.814487549
Pre-training layer 0, epoch 46, cost -75.9897619095
Pre-training layer 0, epoch 47, cost -75.8687018661
Pre-training layer 0, epoch 48, cost -75.7926843948
Pre-training layer 0, epoch 49, cost -75.6987649689
Pre-training layer 0, epoch 50, cost -75.6460025024
Pre-training layer 0, epoch 50, representative training free energy -433.314280029
Pre-training layer 0, epoch 50, validation free energy -424.323440308
Pre-training layer 0, epoch 51, cost -75.5398375778
Pre-training layer 0, epoch 52, cost -75.3745186691
Pre-training layer 0, epoch 53, cost -75.2533616943
Pre-training layer 0, epoch 54, cost -75.3071809235
Pre-training layer 0, epoch 55, cost -75.278224968
Pre-training layer 0, epoch 55, representative training free energy -432.236945007
Pre-training layer 0, epoch 55, validation free energy -423.183646851
Pre-training layer 0, epoch 56, cost -75.03467099
Pre-training layer 0, epoch 57, cost -75.1188614044
Pre-training layer 0, epoch 58, cost -74.9471072006
Pre-training layer 0, epoch 59, cost -74.842072113
Pre-training layer 0, epoch 60, cost -74.8001265335
Pre-training layer 0, epoch 60, representative training free energy -430.361903687
Pre-training layer 0, epoch 60, validation free energy -421.393262146
Pre-training layer 0, epoch 61, cost -74.7121168518
Pre-training layer 0, epoch 62, cost -74.5777472763
Pre-training layer 0, epoch 63, cost -74.5825725327
Pre-training layer 0, epoch 64, cost -74.5485686874
Pre-training layer 0, epoch 65, cost -74.4243685913
Pre-training layer 0, epoch 65, representative training free energy -430.989839783
Pre-training layer 0, epoch 65, validation free energy -421.585293701
Pre-training layer 0, epoch 66, cost -74.404935524
Pre-training layer 0, epoch 67, cost -74.2541417084
Pre-training layer 0, epoch 68, cost -74.3022527084
Pre-training layer 0, epoch 69, cost -74.07790242
Pre-training layer 0, epoch 70, cost -74.1440153275
Pre-training layer 0, epoch 70, representative training free energy -431.354534668
Pre-training layer 0, epoch 70, validation free energy -421.711771851
Pre-training layer 0, epoch 71, cost -74.1158782272
Pre-training layer 0, epoch 72, cost -73.9997904968
Pre-training layer 0, epoch 73, cost -73.9455075531
Pre-training layer 0, epoch 74, cost -73.9089723282
Pre-training layer 0, epoch 75, cost -73.8642316284
Pre-training layer 0, epoch 75, representative training free energy -425.575826294
Pre-training layer 0, epoch 75, validation free energy -415.676661255
Pre-training layer 0, epoch 76, cost -73.8431731262
Pre-training layer 0, epoch 77, cost -73.730721283
Pre-training layer 0, epoch 78, cost -73.7824004822
Pre-training layer 0, epoch 79, cost -73.6908632126
Pre-training layer 0, epoch 80, cost -73.5682124176
Pre-training layer 0, epoch 80, representative training free energy -426.48283728
Pre-training layer 0, epoch 80, validation free energy -416.988930603
Pre-training layer 0, epoch 81, cost -73.4982690659
Pre-training layer 0, epoch 82, cost -73.5139329376
Pre-training layer 0, epoch 83, cost -73.4450335007
Pre-training layer 0, epoch 84, cost -73.2209783554
Pre-training layer 0, epoch 85, cost -73.2702987747
Pre-training layer 0, epoch 85, representative training free energy -424.515814392
Pre-training layer 0, epoch 85, validation free energy -414.347798035
Pre-training layer 0, epoch 86, cost -73.3218267975
Pre-training layer 0, epoch 87, cost -73.2588114243
Pre-training layer 0, epoch 88, cost -73.1411439743
Pre-training layer 0, epoch 89, cost -73.1378916321
Pre-training layer 0, epoch 90, cost -72.959627449
Pre-training layer 0, epoch 90, representative training free energy -424.994131714
Pre-training layer 0, epoch 90, validation free energy -415.311076965
Pre-training layer 0, epoch 91, cost -73.0757616806
Pre-training layer 0, epoch 92, cost -72.8790988541
Pre-training layer 0, epoch 93, cost -72.9770567551
Pre-training layer 0, epoch 94, cost -72.8323886642
Pre-training layer 0, epoch 95, cost -72.8535716629
Pre-training layer 0, epoch 95, representative training free energy -423.392394348
Pre-training layer 0, epoch 95, validation free energy -413.366679871
Pre-training layer 0, epoch 96, cost -72.7451891708
Pre-training layer 0, epoch 97, cost -72.7656230545
Pre-training layer 0, epoch 98, cost -72.8240572052
Pre-training layer 0, epoch 99, cost -72.6785106277
Pre-training layer 1, epoch 0, cost -311.917609619
Pre-training layer 1, epoch 0, representative training free energy -60581.9834453
Pre-training layer 1, epoch 0, validation free energy -60030.461918
Pre-training layer 1, epoch 1, cost -267.691971313
Pre-training layer 1, epoch 2, cost -254.425565277
Pre-training layer 1, epoch 3, cost -246.691402435
Pre-training layer 1, epoch 4, cost -241.5995578
Pre-training layer 1, epoch 5, cost -237.798001648
Pre-training layer 1, epoch 5, representative training free energy -80304.5457539
Pre-training layer 1, epoch 5, validation free energy -79577.6306055
Pre-training layer 1, epoch 6, cost -234.877323853
Pre-training layer 1, epoch 7, cost -232.548232361
Pre-training layer 1, epoch 8, cost -230.660777771
Pre-training layer 1, epoch 9, cost -229.104026031
Pre-training layer 1, epoch 10, cost -227.781798309
Pre-training layer 1, epoch 10, representative training free energy -86336.0989414
Pre-training layer 1, epoch 10, validation free energy -85541.3065
Pre-training layer 1, epoch 11, cost -226.532861389
Pre-training layer 1, epoch 12, cost -225.588007355
Pre-training layer 1, epoch 13, cost -224.651068787
Pre-training layer 1, epoch 14, cost -223.873961548
Pre-training layer 1, epoch 15, cost -223.099110687
Pre-training layer 1, epoch 15, representative training free energy -89853.943
Pre-training layer 1, epoch 15, validation free energy -89029.0874922
Pre-training layer 1, epoch 16, cost -222.471285126
Pre-training layer 1, epoch 17, cost -221.823208557
Pre-training layer 1, epoch 18, cost -221.319148132
Pre-training layer 1, epoch 19, cost -220.74527359
Pre-training layer 1, epoch 20, cost -220.278068024
Pre-training layer 1, epoch 20, representative training free energy -92342.8737539
Pre-training layer 1, epoch 20, validation free energy -91487.317168
Pre-training layer 1, epoch 21, cost -219.836777313
Pre-training layer 1, epoch 22, cost -219.428343475
Pre-training layer 1, epoch 23, cost -219.062439484
Pre-training layer 1, epoch 24, cost -218.721214569
Pre-training layer 1, epoch 25, cost -218.394639008
Pre-training layer 1, epoch 25, representative training free energy -94555.5484844
Pre-training layer 1, epoch 25, validation free energy -93681.5159141
Pre-training layer 1, epoch 26, cost -218.151111938
Pre-training layer 1, epoch 27, cost -217.845405243
Pre-training layer 1, epoch 28, cost -217.567492554
Pre-training layer 1, epoch 29, cost -217.271060547
Pre-training layer 1, epoch 30, cost -216.83390741
Pre-training layer 1, epoch 30, representative training free energy -96210.3875859
Pre-training layer 1, epoch 30, validation free energy -95318.0064102
Pre-training layer 1, epoch 31, cost -216.666116882
Pre-training layer 1, epoch 32, cost -216.508805969
Pre-training layer 1, epoch 33, cost -216.220154877
Pre-training layer 1, epoch 34, cost -216.067111816
Pre-training layer 1, epoch 35, cost -215.848378845
Pre-training layer 1, epoch 35, representative training free energy -97677.970625
Pre-training layer 1, epoch 35, validation free energy -96766.9992734
Pre-training layer 1, epoch 36, cost -215.541342468
Pre-training layer 1, epoch 37, cost -215.473531189
Pre-training layer 1, epoch 38, cost -215.244902405
Pre-training layer 1, epoch 39, cost -215.061537262
Pre-training layer 1, epoch 40, cost -214.866255127
Pre-training layer 1, epoch 40, representative training free energy -99020.1414687
Pre-training layer 1, epoch 40, validation free energy -98106.1877344
Pre-training layer 1, epoch 41, cost -214.766677521
Pre-training layer 1, epoch 42, cost -214.497556885
Pre-training layer 1, epoch 43, cost -214.422500275
Pre-training layer 1, epoch 44, cost -214.265949524
Pre-training layer 1, epoch 45, cost -214.070731201
Pre-training layer 1, epoch 45, representative training free energy -100197.879977
Pre-training layer 1, epoch 45, validation free energy -99265.4970625
Pre-training layer 1, epoch 46, cost -213.886932526
Pre-training layer 1, epoch 47, cost -213.753232391
Pre-training layer 1, epoch 48, cost -213.680179474
Pre-training layer 1, epoch 49, cost -213.591673401
Pre-training layer 1, epoch 50, cost -213.377060425
Pre-training layer 1, epoch 50, representative training free energy -101196.2135
Pre-training layer 1, epoch 50, validation free energy -100253.833141
Pre-training layer 1, epoch 51, cost -213.266515503
Pre-training layer 1, epoch 52, cost -213.208781067
Pre-training layer 1, epoch 53, cost -212.995592651
Pre-training layer 1, epoch 54, cost -212.925836426
Pre-training layer 1, epoch 55, cost -212.901339844
Pre-training layer 1, epoch 55, representative training free energy -102145.701875
Pre-training layer 1, epoch 55, validation free energy -101196.419195
Pre-training layer 1, epoch 56, cost -212.735020721
Pre-training layer 1, epoch 57, cost -212.619191437
Pre-training layer 1, epoch 58, cost -212.54017392
Pre-training layer 1, epoch 59, cost -212.446144073
Pre-training layer 1, epoch 60, cost -212.346420654
Pre-training layer 1, epoch 60, representative training free energy -103065.628063
Pre-training layer 1, epoch 60, validation free energy -102106.98618
Pre-training layer 1, epoch 61, cost -212.198507202
Pre-training layer 1, epoch 62, cost -212.101040955
Pre-training layer 1, epoch 63, cost -212.106174957
Pre-training layer 1, epoch 64, cost -211.952933777
Pre-training layer 1, epoch 65, cost -211.845275787
Pre-training layer 1, epoch 65, representative training free energy -103869.570164
Pre-training layer 1, epoch 65, validation free energy -102907.613727
Pre-training layer 1, epoch 66, cost -211.743489746
Pre-training layer 1, epoch 67, cost -211.749532349
Pre-training layer 1, epoch 68, cost -211.5808526
Pre-training layer 1, epoch 69, cost -211.522724762
Pre-training layer 1, epoch 70, cost -211.466338531
Pre-training layer 1, epoch 70, representative training free energy -104658.732898
Pre-training layer 1, epoch 70, validation free energy -103689.341805
Pre-training layer 1, epoch 71, cost -211.453879059
Pre-training layer 1, epoch 72, cost -211.287994904
Pre-training layer 1, epoch 73, cost -211.179498932
Pre-training layer 1, epoch 74, cost -211.1758815
Pre-training layer 1, epoch 75, cost -211.043381012
Pre-training layer 1, epoch 75, representative training free energy -105390.935289
Pre-training layer 1, epoch 75, validation free energy -104409.86693
Pre-training layer 1, epoch 76, cost -211.024131348
Pre-training layer 1, epoch 77, cost -211.037823822
Pre-training layer 1, epoch 78, cost -210.863202484
Pre-training layer 1, epoch 79, cost -210.880243439
Pre-training layer 1, epoch 80, cost -210.676823486
Pre-training layer 1, epoch 80, representative training free energy -105940.065969
Pre-training layer 1, epoch 80, validation free energy -104951.723695
Pre-training layer 1, epoch 81, cost -210.650474548
Pre-training layer 1, epoch 82, cost -210.686994995
Pre-training layer 1, epoch 83, cost -210.547725464
Pre-training layer 1, epoch 84, cost -210.503489655
Pre-training layer 1, epoch 85, cost -210.52204303
Pre-training layer 1, epoch 85, representative training free energy -106606.420164
Pre-training layer 1, epoch 85, validation free energy -105616.84693
Pre-training layer 1, epoch 86, cost -210.391090607
Pre-training layer 1, epoch 87, cost -210.392873291
Pre-training layer 1, epoch 88, cost -210.301163635
Pre-training layer 1, epoch 89, cost -210.271653412
Pre-training layer 1, epoch 90, cost -210.209421783
Pre-training layer 1, epoch 90, representative training free energy -107196.086844
Pre-training layer 1, epoch 90, validation free energy -106198.934352
Pre-training layer 1, epoch 91, cost -210.154563385
Pre-training layer 1, epoch 92, cost -210.137252472
Pre-training layer 1, epoch 93, cost -210.051390045
Pre-training layer 1, epoch 94, cost -210.030274628
Pre-training layer 1, epoch 95, cost -209.969158417
Pre-training layer 1, epoch 95, representative training free energy -107774.491422
Pre-training layer 1, epoch 95, validation free energy -106769.421242
Pre-training layer 1, epoch 96, cost -209.962572235
Pre-training layer 1, epoch 97, cost -209.911330475
Pre-training layer 1, epoch 98, cost -209.851018799
Pre-training layer 1, epoch 99, cost -209.773998596
Pre-training layer 2, epoch 0, cost -112.534654724
Pre-training layer 2, epoch 0, representative training free energy 3905.29224854
Pre-training layer 2, epoch 0, validation free energy 3888.23694446
Pre-training layer 2, epoch 1, cost -84.6986265259
Pre-training layer 2, epoch 2, cost -78.5535017471
Pre-training layer 2, epoch 3, cost -75.2397938232
Pre-training layer 2, epoch 4, cost -72.9194934692
Pre-training layer 2, epoch 5, cost -71.2250849533
Pre-training layer 2, epoch 5, representative training free energy 6179.36757813
Pre-training layer 2, epoch 5, validation free energy 6145.06771387
Pre-training layer 2, epoch 6, cost -69.8116717682
Pre-training layer 2, epoch 7, cost -68.8287206879
Pre-training layer 2, epoch 8, cost -67.884904953
Pre-training layer 2, epoch 9, cost -67.281974617
Pre-training layer 2, epoch 10, cost -66.6288898697
Pre-training layer 2, epoch 10, representative training free energy 7469.62523291
Pre-training layer 2, epoch 10, validation free energy 7409.06632666
Pre-training layer 2, epoch 11, cost -66.1645725327
Pre-training layer 2, epoch 12, cost -65.6997469254
Pre-training layer 2, epoch 13, cost -65.20099646
Pre-training layer 2, epoch 14, cost -64.8659398422
Pre-training layer 2, epoch 15, cost -64.4942033463
Pre-training layer 2, epoch 15, representative training free energy 8316.85775635
Pre-training layer 2, epoch 15, validation free energy 8249.04871484
Pre-training layer 2, epoch 16, cost -64.2365102386
Pre-training layer 2, epoch 17, cost -63.9287152176
Pre-training layer 2, epoch 18, cost -63.7172669449
Pre-training layer 2, epoch 19, cost -63.4551959839
Pre-training layer 2, epoch 20, cost -63.2221371384
Pre-training layer 2, epoch 20, representative training free energy 9048.84408887
Pre-training layer 2, epoch 20, validation free energy 8973.48696143
Pre-training layer 2, epoch 21, cost -63.1145555954
Pre-training layer 2, epoch 22, cost -62.8965632858
Pre-training layer 2, epoch 23, cost -62.7263035812
Pre-training layer 2, epoch 24, cost -62.6060473022
Pre-training layer 2, epoch 25, cost -62.4118846436
Pre-training layer 2, epoch 25, representative training free energy 9719.38245361
Pre-training layer 2, epoch 25, validation free energy 9634.76422363
Pre-training layer 2, epoch 26, cost -62.3166266556
Pre-training layer 2, epoch 27, cost -62.0780542679
Pre-training layer 2, epoch 28, cost -61.9431480408
Pre-training layer 2, epoch 29, cost -61.9167593384
Pre-training layer 2, epoch 30, cost -61.802455368
Pre-training layer 2, epoch 30, representative training free energy 10315.5702075
Pre-training layer 2, epoch 30, validation free energy 10221.7549214
Pre-training layer 2, epoch 31, cost -61.7115037384
Pre-training layer 2, epoch 32, cost -61.5692804718
Pre-training layer 2, epoch 33, cost -61.4573641663
Pre-training layer 2, epoch 34, cost -61.3504945602
Pre-training layer 2, epoch 35, cost -61.2989781265
Pre-training layer 2, epoch 35, representative training free energy 10793.3365005
Pre-training layer 2, epoch 35, validation free energy 10703.4951694
Pre-training layer 2, epoch 36, cost -61.2541573257
Pre-training layer 2, epoch 37, cost -61.1919553757
Pre-training layer 2, epoch 38, cost -61.0318650818
Pre-training layer 2, epoch 39, cost -60.9579532242
Pre-training layer 2, epoch 40, cost -60.9391532669
Pre-training layer 2, epoch 40, representative training free energy 11274.6307817
Pre-training layer 2, epoch 40, validation free energy 11180.6786177
Pre-training layer 2, epoch 41, cost -60.8487358246
Pre-training layer 2, epoch 42, cost -60.7559057465
Pre-training layer 2, epoch 43, cost -60.7222918777
Pre-training layer 2, epoch 44, cost -60.6600977478
Pre-training layer 2, epoch 45, cost -60.626628685
Pre-training layer 2, epoch 45, representative training free energy 11731.5994756
Pre-training layer 2, epoch 45, validation free energy 11634.6531577
Pre-training layer 2, epoch 46, cost -60.5483236771
Pre-training layer 2, epoch 47, cost -60.5416834259
Pre-training layer 2, epoch 48, cost -60.4981677017
Pre-training layer 2, epoch 49, cost -60.3900651321
Pre-training layer 2, epoch 50, cost -60.3415896988
Pre-training layer 2, epoch 50, representative training free energy 12069.3757187
Pre-training layer 2, epoch 50, validation free energy 11978.0377891
Pre-training layer 2, epoch 51, cost -60.2386346893
Pre-training layer 2, epoch 52, cost -60.2691623383
Pre-training layer 2, epoch 53, cost -60.2243995285
Pre-training layer 2, epoch 54, cost -60.2592102509
Pre-training layer 2, epoch 55, cost -60.1670040817
Pre-training layer 2, epoch 55, representative training free energy 12497.3937783
Pre-training layer 2, epoch 55, validation free energy 12398.583416
Pre-training layer 2, epoch 56, cost -60.1079891968
Pre-training layer 2, epoch 57, cost -60.0512825012
Pre-training layer 2, epoch 58, cost -60.0423999634
Pre-training layer 2, epoch 59, cost -59.9919236069
Pre-training layer 2, epoch 60, cost -59.9106608734
Pre-training layer 2, epoch 60, representative training free energy 12847.4443672
Pre-training layer 2, epoch 60, validation free energy 12750.7862129
Pre-training layer 2, epoch 61, cost -59.8181668854
Pre-training layer 2, epoch 62, cost -59.9095649261
Pre-training layer 2, epoch 63, cost -59.7972804413
Pre-training layer 2, epoch 64, cost -59.8261714783
Pre-training layer 2, epoch 65, cost -59.7197973938
Pre-training layer 2, epoch 65, representative training free energy 13198.5326152
Pre-training layer 2, epoch 65, validation free energy 13094.6950693
Pre-training layer 2, epoch 66, cost -59.6739326553
Pre-training layer 2, epoch 67, cost -59.7331887589
Pre-training layer 2, epoch 68, cost -59.6604093475
Pre-training layer 2, epoch 69, cost -59.6258604126
Pre-training layer 2, epoch 70, cost -59.5876778946
Pre-training layer 2, epoch 70, representative training free energy 13523.7753975
Pre-training layer 2, epoch 70, validation free energy 13425.5793604
Pre-training layer 2, epoch 71, cost -59.5781391907
Pre-training layer 2, epoch 72, cost -59.5467067642
Pre-training layer 2, epoch 73, cost -59.5084634399
Pre-training layer 2, epoch 74, cost -59.5116872025
Pre-training layer 2, epoch 75, cost -59.4598708572
Pre-training layer 2, epoch 75, representative training free energy 13842.4999512
Pre-training layer 2, epoch 75, validation free energy 13737.3919648
Pre-training layer 2, epoch 76, cost -59.4344669724
Pre-training layer 2, epoch 77, cost -59.3900099335
Pre-training layer 2, epoch 78, cost -59.3946055222
Pre-training layer 2, epoch 79, cost -59.4080409317
Pre-training layer 2, epoch 80, cost -59.3952663422
Pre-training layer 2, epoch 80, representative training free energy 14154.0419502
Pre-training layer 2, epoch 80, validation free energy 14042.9964385
Pre-training layer 2, epoch 81, cost -59.3214494629
Pre-training layer 2, epoch 82, cost -59.2853188705
Pre-training layer 2, epoch 83, cost -59.2813221054
Pre-training layer 2, epoch 84, cost -59.2816719055
Pre-training layer 2, epoch 85, cost -59.1766133652
Pre-training layer 2, epoch 85, representative training free energy 14377.1547842
Pre-training layer 2, epoch 85, validation free energy 14276.0328984
Pre-training layer 2, epoch 86, cost -59.1613817749
Pre-training layer 2, epoch 87, cost -59.1210777435
Pre-training layer 2, epoch 88, cost -59.1119104462
Pre-training layer 2, epoch 89, cost -59.1485527878
Pre-training layer 2, epoch 90, cost -59.1335563431
Pre-training layer 2, epoch 90, representative training free energy 14742.3741504
Pre-training layer 2, epoch 90, validation free energy 14631.1714209
Pre-training layer 2, epoch 91, cost -59.0668798676
Pre-training layer 2, epoch 92, cost -59.1139967728
Pre-training layer 2, epoch 93, cost -59.1042352524
Pre-training layer 2, epoch 94, cost -59.0155239868
Pre-training layer 2, epoch 95, cost -58.9827660446
Pre-training layer 2, epoch 95, representative training free energy 15004.4946553
Pre-training layer 2, epoch 95, validation free energy 14891.5392041
Pre-training layer 2, epoch 96, cost -58.9827277069
Pre-training layer 2, epoch 97, cost -58.9837839661
Pre-training layer 2, epoch 98, cost -58.9969525757
Pre-training layer 2, epoch 99, cost -58.9494022141
The pretraining code for file dbn_loop.pyc ran for 13.05m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 32.600000 %
     epoch 1, minibatch 500/500, test error of best model 26.800000 %
epoch 2, minibatch 500/500, validation error 25.000000 %
     epoch 2, minibatch 500/500, test error of best model 17.600000 %
epoch 3, minibatch 500/500, validation error 22.400000 %
     epoch 3, minibatch 500/500, test error of best model 14.200000 %
epoch 4, minibatch 500/500, validation error 21.200000 %
     epoch 4, minibatch 500/500, test error of best model 12.800000 %
epoch 5, minibatch 500/500, validation error 20.800000 %
     epoch 5, minibatch 500/500, test error of best model 11.400000 %
epoch 6, minibatch 500/500, validation error 19.200000 %
     epoch 6, minibatch 500/500, test error of best model 9.400000 %
epoch 7, minibatch 500/500, validation error 19.000000 %
     epoch 7, minibatch 500/500, test error of best model 7.800000 %
epoch 8, minibatch 500/500, validation error 18.600000 %
     epoch 8, minibatch 500/500, test error of best model 6.600000 %
epoch 9, minibatch 500/500, validation error 18.000000 %
     epoch 9, minibatch 500/500, test error of best model 6.000000 %
epoch 10, minibatch 500/500, validation error 17.400000 %
     epoch 10, minibatch 500/500, test error of best model 6.000000 %
epoch 11, minibatch 500/500, validation error 17.400000 %
epoch 12, minibatch 500/500, validation error 17.400000 %
epoch 13, minibatch 500/500, validation error 17.200000 %
     epoch 13, minibatch 500/500, test error of best model 5.200000 %
epoch 14, minibatch 500/500, validation error 17.200000 %
epoch 15, minibatch 500/500, validation error 17.000000 %
     epoch 15, minibatch 500/500, test error of best model 5.000000 %
epoch 16, minibatch 500/500, validation error 17.200000 %
epoch 17, minibatch 500/500, validation error 17.200000 %
epoch 18, minibatch 500/500, validation error 17.200000 %
epoch 19, minibatch 500/500, validation error 17.200000 %
epoch 20, minibatch 500/500, validation error 17.000000 %
epoch 21, minibatch 500/500, validation error 17.000000 %
epoch 22, minibatch 500/500, validation error 17.000000 %
epoch 23, minibatch 500/500, validation error 16.800000 %
     epoch 23, minibatch 500/500, test error of best model 5.600000 %
epoch 24, minibatch 500/500, validation error 17.000000 %
epoch 25, minibatch 500/500, validation error 17.000000 %
epoch 26, minibatch 500/500, validation error 16.800000 %
epoch 27, minibatch 500/500, validation error 16.400000 %
     epoch 27, minibatch 500/500, test error of best model 5.400000 %
epoch 28, minibatch 500/500, validation error 16.400000 %
epoch 29, minibatch 500/500, validation error 16.400000 %
epoch 30, minibatch 500/500, validation error 16.200000 %
     epoch 30, minibatch 500/500, test error of best model 5.400000 %
epoch 31, minibatch 500/500, validation error 16.200000 %
epoch 32, minibatch 500/500, validation error 16.200000 %
epoch 33, minibatch 500/500, validation error 16.200000 %
epoch 34, minibatch 500/500, validation error 16.200000 %
epoch 35, minibatch 500/500, validation error 16.200000 %
epoch 36, minibatch 500/500, validation error 16.200000 %
epoch 37, minibatch 500/500, validation error 16.400000 %
epoch 38, minibatch 500/500, validation error 16.400000 %
epoch 39, minibatch 500/500, validation error 16.200000 %
epoch 40, minibatch 500/500, validation error 16.000000 %
     epoch 40, minibatch 500/500, test error of best model 5.000000 %
epoch 41, minibatch 500/500, validation error 16.000000 %
epoch 42, minibatch 500/500, validation error 16.000000 %
epoch 43, minibatch 500/500, validation error 16.000000 %
epoch 44, minibatch 500/500, validation error 16.000000 %
epoch 45, minibatch 500/500, validation error 16.200000 %
epoch 46, minibatch 500/500, validation error 16.200000 %
epoch 47, minibatch 500/500, validation error 16.200000 %
epoch 48, minibatch 500/500, validation error 16.200000 %
epoch 49, minibatch 500/500, validation error 16.200000 %
epoch 50, minibatch 500/500, validation error 16.200000 %
epoch 51, minibatch 500/500, validation error 16.200000 %
epoch 52, minibatch 500/500, validation error 16.400000 %
epoch 53, minibatch 500/500, validation error 16.400000 %
epoch 54, minibatch 500/500, validation error 16.400000 %
epoch 55, minibatch 500/500, validation error 16.400000 %
epoch 56, minibatch 500/500, validation error 16.400000 %
epoch 57, minibatch 500/500, validation error 16.400000 %
epoch 58, minibatch 500/500, validation error 16.400000 %
epoch 59, minibatch 500/500, validation error 16.400000 %
epoch 60, minibatch 500/500, validation error 16.400000 %
epoch 61, minibatch 500/500, validation error 16.400000 %
epoch 62, minibatch 500/500, validation error 16.400000 %
epoch 63, minibatch 500/500, validation error 16.400000 %
epoch 64, minibatch 500/500, validation error 16.400000 %
epoch 65, minibatch 500/500, validation error 16.400000 %
epoch 66, minibatch 500/500, validation error 16.400000 %
epoch 67, minibatch 500/500, validation error 16.400000 %
epoch 68, minibatch 500/500, validation error 16.400000 %
epoch 69, minibatch 500/500, validation error 16.200000 %
epoch 70, minibatch 500/500, validation error 16.200000 %
epoch 71, minibatch 500/500, validation error 16.200000 %
epoch 72, minibatch 500/500, validation error 16.200000 %
epoch 73, minibatch 500/500, validation error 16.200000 %
epoch 74, minibatch 500/500, validation error 16.200000 %
epoch 75, minibatch 500/500, validation error 16.200000 %
epoch 76, minibatch 500/500, validation error 16.200000 %
epoch 77, minibatch 500/500, validation error 16.200000 %
epoch 78, minibatch 500/500, validation error 16.200000 %
epoch 79, minibatch 500/500, validation error 16.200000 %
Optimization complete with best validation score of 16.000000 %, obtained at iteration 20000, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 3.15m
_______RUN: 1

==========Sample: (1000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -185.106142426
Pre-training layer 0, epoch 0, representative training free energy -597.022633667
Pre-training layer 0, epoch 0, validation free energy -591.818294861
Pre-training layer 0, epoch 1, cost -136.775545044
Pre-training layer 0, epoch 2, cost -124.61947876
Pre-training layer 0, epoch 3, cost -118.020405884
Pre-training layer 0, epoch 4, cost -113.436987228
Pre-training layer 0, epoch 5, cost -109.974368973
Pre-training layer 0, epoch 5, representative training free energy -548.664902161
Pre-training layer 0, epoch 5, validation free energy -536.134452759
Pre-training layer 0, epoch 6, cost -107.052876053
Pre-training layer 0, epoch 7, cost -104.628655472
Pre-training layer 0, epoch 8, cost -102.855746002
Pre-training layer 0, epoch 9, cost -100.906590347
Pre-training layer 0, epoch 10, cost -99.5640852356
Pre-training layer 0, epoch 10, representative training free energy -528.671775696
Pre-training layer 0, epoch 10, validation free energy -514.980064636
Pre-training layer 0, epoch 11, cost -97.944858551
Pre-training layer 0, epoch 12, cost -96.7586267853
Pre-training layer 0, epoch 13, cost -95.9786302948
Pre-training layer 0, epoch 14, cost -94.6858280182
Pre-training layer 0, epoch 15, cost -94.098274231
Pre-training layer 0, epoch 15, representative training free energy -518.0667005
Pre-training layer 0, epoch 15, validation free energy -503.62949115
Pre-training layer 0, epoch 16, cost -93.1220844269
Pre-training layer 0, epoch 17, cost -91.9889875031
Pre-training layer 0, epoch 18, cost -91.3599830627
Pre-training layer 0, epoch 19, cost -90.5875302124
Pre-training layer 0, epoch 20, cost -89.8953619385
Pre-training layer 0, epoch 20, representative training free energy -510.919906677
Pre-training layer 0, epoch 20, validation free energy -495.406927368
Pre-training layer 0, epoch 21, cost -89.4747596741
Pre-training layer 0, epoch 22, cost -88.4850537109
Pre-training layer 0, epoch 23, cost -88.4322863007
Pre-training layer 0, epoch 24, cost -87.8253953552
Pre-training layer 0, epoch 25, cost -87.1576230621
Pre-training layer 0, epoch 25, representative training free energy -501.007696533
Pre-training layer 0, epoch 25, validation free energy -484.607981567
Pre-training layer 0, epoch 26, cost -86.8779144287
Pre-training layer 0, epoch 27, cost -86.4662795258
Pre-training layer 0, epoch 28, cost -86.2402366638
Pre-training layer 0, epoch 29, cost -85.4840322876
Pre-training layer 0, epoch 30, cost -85.3350527954
Pre-training layer 0, epoch 30, representative training free energy -501.292544861
Pre-training layer 0, epoch 30, validation free energy -483.919573181
Pre-training layer 0, epoch 31, cost -84.8018312073
Pre-training layer 0, epoch 32, cost -84.4419132996
Pre-training layer 0, epoch 33, cost -84.0307447815
Pre-training layer 0, epoch 34, cost -83.9287412262
Pre-training layer 0, epoch 35, cost -83.719196701
Pre-training layer 0, epoch 35, representative training free energy -495.519740723
Pre-training layer 0, epoch 35, validation free energy -478.185824707
Pre-training layer 0, epoch 36, cost -83.0976300812
Pre-training layer 0, epoch 37, cost -82.7602697754
Pre-training layer 0, epoch 38, cost -82.3998706818
Pre-training layer 0, epoch 39, cost -82.5260958099
Pre-training layer 0, epoch 40, cost -82.0610561371
Pre-training layer 0, epoch 40, representative training free energy -488.598188721
Pre-training layer 0, epoch 40, validation free energy -470.98340686
Pre-training layer 0, epoch 41, cost -81.9237329102
Pre-training layer 0, epoch 42, cost -81.5972852325
Pre-training layer 0, epoch 43, cost -81.4934522247
Pre-training layer 0, epoch 44, cost -81.2464453125
Pre-training layer 0, epoch 45, cost -80.8610863495
Pre-training layer 0, epoch 45, representative training free energy -484.396716858
Pre-training layer 0, epoch 45, validation free energy -466.083133362
Pre-training layer 0, epoch 46, cost -80.557805481
Pre-training layer 0, epoch 47, cost -80.6736729431
Pre-training layer 0, epoch 48, cost -80.3443362045
Pre-training layer 0, epoch 49, cost -80.2686019897
Pre-training layer 0, epoch 50, cost -79.8266043854
Pre-training layer 0, epoch 50, representative training free energy -484.070127441
Pre-training layer 0, epoch 50, validation free energy -465.764235596
Pre-training layer 0, epoch 51, cost -79.7526832199
Pre-training layer 0, epoch 52, cost -79.4509374237
Pre-training layer 0, epoch 53, cost -79.6825606918
Pre-training layer 0, epoch 54, cost -79.5376241302
Pre-training layer 0, epoch 55, cost -79.0724209213
Pre-training layer 0, epoch 55, representative training free energy -479.972549194
Pre-training layer 0, epoch 55, validation free energy -461.006040527
Pre-training layer 0, epoch 56, cost -79.0076573944
Pre-training layer 0, epoch 57, cost -78.8481243515
Pre-training layer 0, epoch 58, cost -78.8748171997
Pre-training layer 0, epoch 59, cost -78.3046100998
Pre-training layer 0, epoch 60, cost -78.4266947937
Pre-training layer 0, epoch 60, representative training free energy -479.195671936
Pre-training layer 0, epoch 60, validation free energy -459.602854675
Pre-training layer 0, epoch 61, cost -78.0356280899
Pre-training layer 0, epoch 62, cost -77.848097496
Pre-training layer 0, epoch 63, cost -77.8379775238
Pre-training layer 0, epoch 64, cost -77.8974338531
Pre-training layer 0, epoch 65, cost -77.4928875351
Pre-training layer 0, epoch 65, representative training free energy -479.331071106
Pre-training layer 0, epoch 65, validation free energy -459.59073999
Pre-training layer 0, epoch 66, cost -77.5629459
Pre-training layer 0, epoch 67, cost -77.4525396729
Pre-training layer 0, epoch 68, cost -77.1075227737
Pre-training layer 0, epoch 69, cost -77.0933358002
Pre-training layer 0, epoch 70, cost -76.9066547394
Pre-training layer 0, epoch 70, representative training free energy -471.973128174
Pre-training layer 0, epoch 70, validation free energy -452.037667114
Pre-training layer 0, epoch 71, cost -76.7395188141
Pre-training layer 0, epoch 72, cost -77.1738371277
Pre-training layer 0, epoch 73, cost -76.6617749023
Pre-training layer 0, epoch 74, cost -76.4293407059
Pre-training layer 0, epoch 75, cost -76.4446578217
Pre-training layer 0, epoch 75, representative training free energy -474.07026239
Pre-training layer 0, epoch 75, validation free energy -453.80201825
Pre-training layer 0, epoch 76, cost -76.3729652405
Pre-training layer 0, epoch 77, cost -76.2071869278
Pre-training layer 0, epoch 78, cost -76.1854378128
Pre-training layer 0, epoch 79, cost -75.9799731064
Pre-training layer 0, epoch 80, cost -75.771397171
Pre-training layer 0, epoch 80, representative training free energy -473.635763733
Pre-training layer 0, epoch 80, validation free energy -452.533742126
Pre-training layer 0, epoch 81, cost -75.8573186111
Pre-training layer 0, epoch 82, cost -75.3806892395
Pre-training layer 0, epoch 83, cost -75.4850278091
Pre-training layer 0, epoch 84, cost -75.5693200302
Pre-training layer 0, epoch 85, cost -75.3438930511
Pre-training layer 0, epoch 85, representative training free energy -471.041004089
Pre-training layer 0, epoch 85, validation free energy -450.195953857
Pre-training layer 0, epoch 86, cost -75.2448789215
Pre-training layer 0, epoch 87, cost -75.0632923889
Pre-training layer 0, epoch 88, cost -75.1598225403
Pre-training layer 0, epoch 89, cost -75.092974205
Pre-training layer 0, epoch 90, cost -74.7848623657
Pre-training layer 0, epoch 90, representative training free energy -470.423821228
Pre-training layer 0, epoch 90, validation free energy -449.6244646
Pre-training layer 0, epoch 91, cost -74.8396814728
Pre-training layer 0, epoch 92, cost -74.7327483749
Pre-training layer 0, epoch 93, cost -74.5163116455
Pre-training layer 0, epoch 94, cost -74.6380359268
Pre-training layer 0, epoch 95, cost -74.3887004852
Pre-training layer 0, epoch 95, representative training free energy -469.563553528
Pre-training layer 0, epoch 95, validation free energy -447.65003833
Pre-training layer 0, epoch 96, cost -74.4266577148
Pre-training layer 0, epoch 97, cost -74.232052536
Pre-training layer 0, epoch 98, cost -74.1187343597
Pre-training layer 0, epoch 99, cost -74.0938877487
Pre-training layer 1, epoch 0, cost -431.198955078
Pre-training layer 1, epoch 0, representative training free energy -32461.4239375
Pre-training layer 1, epoch 0, validation free energy -32154.7980664
Pre-training layer 1, epoch 1, cost -370.284514465
Pre-training layer 1, epoch 2, cost -350.731680298
Pre-training layer 1, epoch 3, cost -339.042119446
Pre-training layer 1, epoch 4, cost -330.633831177
Pre-training layer 1, epoch 5, cost -324.111755676
Pre-training layer 1, epoch 5, representative training free energy -46703.2920625
Pre-training layer 1, epoch 5, validation free energy -46351.7092285
Pre-training layer 1, epoch 6, cost -319.386996765
Pre-training layer 1, epoch 7, cost -315.09286377
Pre-training layer 1, epoch 8, cost -311.884346924
Pre-training layer 1, epoch 9, cost -308.618191223
Pre-training layer 1, epoch 10, cost -306.042388611
Pre-training layer 1, epoch 10, representative training free energy -51160.8470625
Pre-training layer 1, epoch 10, validation free energy -50789.4144551
Pre-training layer 1, epoch 11, cost -303.704072876
Pre-training layer 1, epoch 12, cost -301.710266724
Pre-training layer 1, epoch 13, cost -299.854534302
Pre-training layer 1, epoch 14, cost -298.228971863
Pre-training layer 1, epoch 15, cost -296.504069519
Pre-training layer 1, epoch 15, representative training free energy -53641.7129453
Pre-training layer 1, epoch 15, validation free energy -53276.1409219
Pre-training layer 1, epoch 16, cost -295.119751282
Pre-training layer 1, epoch 17, cost -294.070903473
Pre-training layer 1, epoch 18, cost -292.6963414
Pre-training layer 1, epoch 19, cost -291.681969757
Pre-training layer 1, epoch 20, cost -290.881021118
Pre-training layer 1, epoch 20, representative training free energy -55390.8922227
Pre-training layer 1, epoch 20, validation free energy -55022.8002617
Pre-training layer 1, epoch 21, cost -289.388592834
Pre-training layer 1, epoch 22, cost -288.831134949
Pre-training layer 1, epoch 23, cost -287.869684448
Pre-training layer 1, epoch 24, cost -287.141117401
Pre-training layer 1, epoch 25, cost -286.431395264
Pre-training layer 1, epoch 25, representative training free energy -56792.7941445
Pre-training layer 1, epoch 25, validation free energy -56419.5541953
Pre-training layer 1, epoch 26, cost -285.47933609
Pre-training layer 1, epoch 27, cost -284.863651886
Pre-training layer 1, epoch 28, cost -284.408335114
Pre-training layer 1, epoch 29, cost -283.942674561
Pre-training layer 1, epoch 30, cost -283.152975006
Pre-training layer 1, epoch 30, representative training free energy -57810.6400352
Pre-training layer 1, epoch 30, validation free energy -57431.9566406
Pre-training layer 1, epoch 31, cost -282.696625061
Pre-training layer 1, epoch 32, cost -282.0077948
Pre-training layer 1, epoch 33, cost -281.518547974
Pre-training layer 1, epoch 34, cost -281.1070401
Pre-training layer 1, epoch 35, cost -280.613507843
Pre-training layer 1, epoch 35, representative training free energy -58719.6571797
Pre-training layer 1, epoch 35, validation free energy -58340.6131445
Pre-training layer 1, epoch 36, cost -280.092892303
Pre-training layer 1, epoch 37, cost -279.716992188
Pre-training layer 1, epoch 38, cost -279.458489685
Pre-training layer 1, epoch 39, cost -279.148952179
Pre-training layer 1, epoch 40, cost -278.853200073
Pre-training layer 1, epoch 40, representative training free energy -59428.2303945
Pre-training layer 1, epoch 40, validation free energy -59053.2274492
Pre-training layer 1, epoch 41, cost -278.281655121
Pre-training layer 1, epoch 42, cost -278.015606689
Pre-training layer 1, epoch 43, cost -277.508720551
Pre-training layer 1, epoch 44, cost -277.301833038
Pre-training layer 1, epoch 45, cost -277.068900604
Pre-training layer 1, epoch 45, representative training free energy -60180.1789883
Pre-training layer 1, epoch 45, validation free energy -59795.640207
Pre-training layer 1, epoch 46, cost -276.560282593
Pre-training layer 1, epoch 47, cost -276.397001038
Pre-training layer 1, epoch 48, cost -276.152494049
Pre-training layer 1, epoch 49, cost -275.950106964
Pre-training layer 1, epoch 50, cost -275.736965637
Pre-training layer 1, epoch 50, representative training free energy -60681.6965469
Pre-training layer 1, epoch 50, validation free energy -60297.2205742
Pre-training layer 1, epoch 51, cost -275.265300446
Pre-training layer 1, epoch 52, cost -275.14052536
Pre-training layer 1, epoch 53, cost -274.756380463
Pre-training layer 1, epoch 54, cost -274.55958847
Pre-training layer 1, epoch 55, cost -274.237333527
Pre-training layer 1, epoch 55, representative training free energy -61261.7291992
Pre-training layer 1, epoch 55, validation free energy -60879.0416289
Pre-training layer 1, epoch 56, cost -274.186119537
Pre-training layer 1, epoch 57, cost -274.073690948
Pre-training layer 1, epoch 58, cost -273.736228943
Pre-training layer 1, epoch 59, cost -273.551821442
Pre-training layer 1, epoch 60, cost -273.395396729
Pre-training layer 1, epoch 60, representative training free energy -61805.5108867
Pre-training layer 1, epoch 60, validation free energy -61419.2908633
Pre-training layer 1, epoch 61, cost -273.310033722
Pre-training layer 1, epoch 62, cost -272.98594101
Pre-training layer 1, epoch 63, cost -272.663185577
Pre-training layer 1, epoch 64, cost -272.406155243
Pre-training layer 1, epoch 65, cost -272.500161438
Pre-training layer 1, epoch 65, representative training free energy -62227.0135391
Pre-training layer 1, epoch 65, validation free energy -61841.1694922
Pre-training layer 1, epoch 66, cost -272.322706604
Pre-training layer 1, epoch 67, cost -272.082288818
Pre-training layer 1, epoch 68, cost -271.930053253
Pre-training layer 1, epoch 69, cost -271.816107025
Pre-training layer 1, epoch 70, cost -271.695042419
Pre-training layer 1, epoch 70, representative training free energy -62708.7183672
Pre-training layer 1, epoch 70, validation free energy -62316.3394297
Pre-training layer 1, epoch 71, cost -271.461930237
Pre-training layer 1, epoch 72, cost -271.388831024
Pre-training layer 1, epoch 73, cost -271.172914276
Pre-training layer 1, epoch 74, cost -271.012344513
Pre-training layer 1, epoch 75, cost -270.98080719
Pre-training layer 1, epoch 75, representative training free energy -63130.8319961
Pre-training layer 1, epoch 75, validation free energy -62734.3500156
Pre-training layer 1, epoch 76, cost -270.824963684
Pre-training layer 1, epoch 77, cost -270.641556396
Pre-training layer 1, epoch 78, cost -270.629999084
Pre-training layer 1, epoch 79, cost -270.312516785
Pre-training layer 1, epoch 80, cost -270.205418549
Pre-training layer 1, epoch 80, representative training free energy -63462.0214609
Pre-training layer 1, epoch 80, validation free energy -63068.9982227
Pre-training layer 1, epoch 81, cost -270.297451782
Pre-training layer 1, epoch 82, cost -270.138912811
Pre-training layer 1, epoch 83, cost -270.135523224
Pre-training layer 1, epoch 84, cost -269.716071472
Pre-training layer 1, epoch 85, cost -269.680005951
Pre-training layer 1, epoch 85, representative training free energy -63810.7885117
Pre-training layer 1, epoch 85, validation free energy -63415.3973398
Pre-training layer 1, epoch 86, cost -269.581559296
Pre-training layer 1, epoch 87, cost -269.544903107
Pre-training layer 1, epoch 88, cost -269.382448883
Pre-training layer 1, epoch 89, cost -269.272569122
Pre-training layer 1, epoch 90, cost -269.091162415
Pre-training layer 1, epoch 90, representative training free energy -64123.8136328
Pre-training layer 1, epoch 90, validation free energy -63727.4405937
Pre-training layer 1, epoch 91, cost -269.133644257
Pre-training layer 1, epoch 92, cost -268.869414673
Pre-training layer 1, epoch 93, cost -268.783406982
Pre-training layer 1, epoch 94, cost -268.737747498
Pre-training layer 1, epoch 95, cost -268.612736816
Pre-training layer 1, epoch 95, representative training free energy -64445.8329414
Pre-training layer 1, epoch 95, validation free energy -64049.4320078
Pre-training layer 1, epoch 96, cost -268.469135742
Pre-training layer 1, epoch 97, cost -268.494229431
Pre-training layer 1, epoch 98, cost -268.36761795
Pre-training layer 1, epoch 99, cost -268.283814697
Pre-training layer 2, epoch 0, cost -160.888678513
Pre-training layer 2, epoch 0, representative training free energy 1797.58945459
Pre-training layer 2, epoch 0, validation free energy 1813.07467877
Pre-training layer 2, epoch 1, cost -107.459989929
Pre-training layer 2, epoch 2, cost -97.2815608978
Pre-training layer 2, epoch 3, cost -91.5841374207
Pre-training layer 2, epoch 4, cost -87.7684053802
Pre-training layer 2, epoch 5, cost -84.9834429932
Pre-training layer 2, epoch 5, representative training free energy 2677.95489661
Pre-training layer 2, epoch 5, validation free energy 2675.44063501
Pre-training layer 2, epoch 6, cost -82.9493622589
Pre-training layer 2, epoch 7, cost -81.1251050949
Pre-training layer 2, epoch 8, cost -79.5916049957
Pre-training layer 2, epoch 9, cost -78.1794603348
Pre-training layer 2, epoch 10, cost -77.4016627884
Pre-training layer 2, epoch 10, representative training free energy 3067.9502467
Pre-training layer 2, epoch 10, validation free energy 3056.76072131
Pre-training layer 2, epoch 11, cost -76.1186421585
Pre-training layer 2, epoch 12, cost -75.300438385
Pre-training layer 2, epoch 13, cost -74.4318992615
Pre-training layer 2, epoch 14, cost -74.0174466324
Pre-training layer 2, epoch 15, cost -73.1916218185
Pre-training layer 2, epoch 15, representative training free energy 3374.57217566
Pre-training layer 2, epoch 15, validation free energy 3359.1033407
Pre-training layer 2, epoch 16, cost -72.7101122665
Pre-training layer 2, epoch 17, cost -72.314443779
Pre-training layer 2, epoch 18, cost -71.7043805695
Pre-training layer 2, epoch 19, cost -71.308181572
Pre-training layer 2, epoch 20, cost -70.8141136551
Pre-training layer 2, epoch 20, representative training free energy 3610.04355835
Pre-training layer 2, epoch 20, validation free energy 3592.50096313
Pre-training layer 2, epoch 21, cost -70.4127870178
Pre-training layer 2, epoch 22, cost -69.9307529831
Pre-training layer 2, epoch 23, cost -69.9138940048
Pre-training layer 2, epoch 24, cost -69.5716221237
Pre-training layer 2, epoch 25, cost -69.218531456
Pre-training layer 2, epoch 25, representative training free energy 3826.53016821
Pre-training layer 2, epoch 25, validation free energy 3800.85817114
Pre-training layer 2, epoch 26, cost -69.0775859833
Pre-training layer 2, epoch 27, cost -68.5732151413
Pre-training layer 2, epoch 28, cost -68.3597941208
Pre-training layer 2, epoch 29, cost -68.0567439651
Pre-training layer 2, epoch 30, cost -67.9405830765
Pre-training layer 2, epoch 30, representative training free energy 4018.57869751
Pre-training layer 2, epoch 30, validation free energy 3991.17341626
Pre-training layer 2, epoch 31, cost -67.7587271118
Pre-training layer 2, epoch 32, cost -67.5563441849
Pre-training layer 2, epoch 33, cost -67.2589394379
Pre-training layer 2, epoch 34, cost -67.195924263
Pre-training layer 2, epoch 35, cost -66.8353039169
Pre-training layer 2, epoch 35, representative training free energy 4220.8842439
Pre-training layer 2, epoch 35, validation free energy 4189.64669678
Pre-training layer 2, epoch 36, cost -66.8543200302
Pre-training layer 2, epoch 37, cost -66.6371785355
Pre-training layer 2, epoch 38, cost -66.3463290405
Pre-training layer 2, epoch 39, cost -66.2657437515
Pre-training layer 2, epoch 40, cost -66.2663145065
Pre-training layer 2, epoch 40, representative training free energy 4363.47820264
Pre-training layer 2, epoch 40, validation free energy 4330.85320239
Pre-training layer 2, epoch 41, cost -66.0310052109
Pre-training layer 2, epoch 42, cost -66.0057988358
Pre-training layer 2, epoch 43, cost -65.9139446259
Pre-training layer 2, epoch 44, cost -65.5240340805
Pre-training layer 2, epoch 45, cost -65.4823472977
Pre-training layer 2, epoch 45, representative training free energy 4507.7164729
Pre-training layer 2, epoch 45, validation free energy 4473.45237939
Pre-training layer 2, epoch 46, cost -65.3143987656
Pre-training layer 2, epoch 47, cost -65.3185569382
Pre-training layer 2, epoch 48, cost -65.1561736679
Pre-training layer 2, epoch 49, cost -65.1631954956
Pre-training layer 2, epoch 50, cost -64.959293251
Pre-training layer 2, epoch 50, representative training free energy 4647.68469385
Pre-training layer 2, epoch 50, validation free energy 4610.26968115
Pre-training layer 2, epoch 51, cost -64.8857642746
Pre-training layer 2, epoch 52, cost -64.7218673706
Pre-training layer 2, epoch 53, cost -64.5897369766
Pre-training layer 2, epoch 54, cost -64.4572930145
Pre-training layer 2, epoch 55, cost -64.3825548935
Pre-training layer 2, epoch 55, representative training free energy 4762.20547046
Pre-training layer 2, epoch 55, validation free energy 4724.05271558
Pre-training layer 2, epoch 56, cost -64.2431355667
Pre-training layer 2, epoch 57, cost -64.3402561569
Pre-training layer 2, epoch 58, cost -64.2411485672
Pre-training layer 2, epoch 59, cost -64.131396904
Pre-training layer 2, epoch 60, cost -63.9638018036
Pre-training layer 2, epoch 60, representative training free energy 4914.53116162
Pre-training layer 2, epoch 60, validation free energy 4874.79289746
Pre-training layer 2, epoch 61, cost -64.0406024933
Pre-training layer 2, epoch 62, cost -63.8741789246
Pre-training layer 2, epoch 63, cost -63.7582351685
Pre-training layer 2, epoch 64, cost -63.773338623
Pre-training layer 2, epoch 65, cost -63.7525442505
Pre-training layer 2, epoch 65, representative training free energy 5028.11715479
Pre-training layer 2, epoch 65, validation free energy 4984.44350464
Pre-training layer 2, epoch 66, cost -63.7111252594
Pre-training layer 2, epoch 67, cost -63.8948093033
Pre-training layer 2, epoch 68, cost -63.5714977646
Pre-training layer 2, epoch 69, cost -63.4448704529
Pre-training layer 2, epoch 70, cost -63.4862368011
Pre-training layer 2, epoch 70, representative training free energy 5131.91882031
Pre-training layer 2, epoch 70, validation free energy 5087.46424512
Pre-training layer 2, epoch 71, cost -63.0698457718
Pre-training layer 2, epoch 72, cost -63.3615614319
Pre-training layer 2, epoch 73, cost -63.2402888107
Pre-training layer 2, epoch 74, cost -63.0216516113
Pre-training layer 2, epoch 75, cost -62.9078601456
Pre-training layer 2, epoch 75, representative training free energy 5237.53487842
Pre-training layer 2, epoch 75, validation free energy 5193.78160181
Pre-training layer 2, epoch 76, cost -63.0183626175
Pre-training layer 2, epoch 77, cost -62.9477751923
Pre-training layer 2, epoch 78, cost -63.0670429611
Pre-training layer 2, epoch 79, cost -62.7301553345
Pre-training layer 2, epoch 80, cost -62.9887865829
Pre-training layer 2, epoch 80, representative training free energy 5344.77421777
Pre-training layer 2, epoch 80, validation free energy 5299.14491504
Pre-training layer 2, epoch 81, cost -62.7557658768
Pre-training layer 2, epoch 82, cost -62.7347122574
Pre-training layer 2, epoch 83, cost -62.6132733536
Pre-training layer 2, epoch 84, cost -62.6711534882
Pre-training layer 2, epoch 85, cost -62.5209056091
Pre-training layer 2, epoch 85, representative training free energy 5439.63059106
Pre-training layer 2, epoch 85, validation free energy 5391.78996094
Pre-training layer 2, epoch 86, cost -62.4979877472
Pre-training layer 2, epoch 87, cost -62.4752904129
Pre-training layer 2, epoch 88, cost -62.3886362457
Pre-training layer 2, epoch 89, cost -62.422751503
Pre-training layer 2, epoch 90, cost -62.4358217239
Pre-training layer 2, epoch 90, representative training free energy 5528.59317041
Pre-training layer 2, epoch 90, validation free energy 5479.75801416
Pre-training layer 2, epoch 91, cost -62.3539379501
Pre-training layer 2, epoch 92, cost -62.262436676
Pre-training layer 2, epoch 93, cost -62.2909518433
Pre-training layer 2, epoch 94, cost -62.2347748566
Pre-training layer 2, epoch 95, cost -62.1599190903
Pre-training layer 2, epoch 95, representative training free energy 5645.29494507
Pre-training layer 2, epoch 95, validation free energy 5595.47377002
Pre-training layer 2, epoch 96, cost -62.2180089951
Pre-training layer 2, epoch 97, cost -62.0778635406
Pre-training layer 2, epoch 98, cost -62.0676078796
Pre-training layer 2, epoch 99, cost -62.0205015945
The pretraining code for file dbn_loop.pyc ran for 2.80m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 33.200000 %
     epoch 1, minibatch 100/100, test error of best model 28.000000 %
epoch 2, minibatch 100/100, validation error 28.000000 %
     epoch 2, minibatch 100/100, test error of best model 20.600000 %
epoch 3, minibatch 100/100, validation error 25.400000 %
     epoch 3, minibatch 100/100, test error of best model 17.000000 %
epoch 4, minibatch 100/100, validation error 24.800000 %
     epoch 4, minibatch 100/100, test error of best model 16.600000 %
epoch 5, minibatch 100/100, validation error 24.200000 %
     epoch 5, minibatch 100/100, test error of best model 15.800000 %
epoch 6, minibatch 100/100, validation error 23.600000 %
     epoch 6, minibatch 100/100, test error of best model 14.600000 %
epoch 7, minibatch 100/100, validation error 23.200000 %
     epoch 7, minibatch 100/100, test error of best model 14.400000 %
epoch 8, minibatch 100/100, validation error 23.200000 %
epoch 9, minibatch 100/100, validation error 22.600000 %
     epoch 9, minibatch 100/100, test error of best model 13.800000 %
epoch 10, minibatch 100/100, validation error 22.400000 %
     epoch 10, minibatch 100/100, test error of best model 13.800000 %
epoch 11, minibatch 100/100, validation error 21.800000 %
     epoch 11, minibatch 100/100, test error of best model 13.200000 %
epoch 12, minibatch 100/100, validation error 21.200000 %
     epoch 12, minibatch 100/100, test error of best model 12.800000 %
epoch 13, minibatch 100/100, validation error 21.200000 %
epoch 14, minibatch 100/100, validation error 21.200000 %
epoch 15, minibatch 100/100, validation error 21.400000 %
epoch 16, minibatch 100/100, validation error 21.600000 %
epoch 17, minibatch 100/100, validation error 21.600000 %
epoch 18, minibatch 100/100, validation error 21.200000 %
epoch 19, minibatch 100/100, validation error 21.200000 %
epoch 20, minibatch 100/100, validation error 21.200000 %
epoch 21, minibatch 100/100, validation error 21.200000 %
epoch 22, minibatch 100/100, validation error 21.400000 %
epoch 23, minibatch 100/100, validation error 21.000000 %
     epoch 23, minibatch 100/100, test error of best model 11.000000 %
epoch 24, minibatch 100/100, validation error 21.400000 %
epoch 25, minibatch 100/100, validation error 21.400000 %
epoch 26, minibatch 100/100, validation error 21.600000 %
epoch 27, minibatch 100/100, validation error 21.600000 %
epoch 28, minibatch 100/100, validation error 21.600000 %
epoch 29, minibatch 100/100, validation error 21.600000 %
epoch 30, minibatch 100/100, validation error 21.600000 %
epoch 31, minibatch 100/100, validation error 21.800000 %
epoch 32, minibatch 100/100, validation error 21.800000 %
epoch 33, minibatch 100/100, validation error 21.800000 %
epoch 34, minibatch 100/100, validation error 21.800000 %
epoch 35, minibatch 100/100, validation error 21.800000 %
epoch 36, minibatch 100/100, validation error 21.600000 %
epoch 37, minibatch 100/100, validation error 21.600000 %
epoch 38, minibatch 100/100, validation error 21.600000 %
epoch 39, minibatch 100/100, validation error 21.600000 %
epoch 40, minibatch 100/100, validation error 21.600000 %
epoch 41, minibatch 100/100, validation error 21.600000 %
epoch 42, minibatch 100/100, validation error 21.600000 %
epoch 43, minibatch 100/100, validation error 21.600000 %
epoch 44, minibatch 100/100, validation error 21.600000 %
epoch 45, minibatch 100/100, validation error 21.600000 %
Optimization complete with best validation score of 21.000000 %, obtained at iteration 2300, with test performance 11.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.45m


==========Sample: (2000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.85627491
Pre-training layer 0, epoch 0, representative training free energy -581.917776611
Pre-training layer 0, epoch 0, validation free energy -577.133796021
Pre-training layer 0, epoch 1, cost -123.386354942
Pre-training layer 0, epoch 2, cost -114.050521851
Pre-training layer 0, epoch 3, cost -108.414329491
Pre-training layer 0, epoch 4, cost -104.140946236
Pre-training layer 0, epoch 5, cost -101.094280014
Pre-training layer 0, epoch 5, representative training free energy -526.857719238
Pre-training layer 0, epoch 5, validation free energy -517.659510559
Pre-training layer 0, epoch 6, cost -98.9629739761
Pre-training layer 0, epoch 7, cost -96.9258031845
Pre-training layer 0, epoch 8, cost -95.1419678497
Pre-training layer 0, epoch 9, cost -93.7442380905
Pre-training layer 0, epoch 10, cost -92.3879846573
Pre-training layer 0, epoch 10, representative training free energy -504.959323242
Pre-training layer 0, epoch 10, validation free energy -494.874903625
Pre-training layer 0, epoch 11, cost -91.6573793793
Pre-training layer 0, epoch 12, cost -90.6242843628
Pre-training layer 0, epoch 13, cost -89.6103263092
Pre-training layer 0, epoch 14, cost -88.9039551163
Pre-training layer 0, epoch 15, cost -88.2894129944
Pre-training layer 0, epoch 15, representative training free energy -492.267703247
Pre-training layer 0, epoch 15, validation free energy -481.41918219
Pre-training layer 0, epoch 16, cost -87.5012784958
Pre-training layer 0, epoch 17, cost -86.9932888412
Pre-training layer 0, epoch 18, cost -86.6716599274
Pre-training layer 0, epoch 19, cost -85.8907567978
Pre-training layer 0, epoch 20, cost -85.4740971375
Pre-training layer 0, epoch 20, representative training free energy -484.710323425
Pre-training layer 0, epoch 20, validation free energy -473.082104431
Pre-training layer 0, epoch 21, cost -85.080034256
Pre-training layer 0, epoch 22, cost -84.6108553696
Pre-training layer 0, epoch 23, cost -84.1685923767
Pre-training layer 0, epoch 24, cost -83.7806192017
Pre-training layer 0, epoch 25, cost -83.3828962708
Pre-training layer 0, epoch 25, representative training free energy -479.86004425
Pre-training layer 0, epoch 25, validation free energy -468.116097229
Pre-training layer 0, epoch 26, cost -82.9116217041
Pre-training layer 0, epoch 27, cost -82.7323305893
Pre-training layer 0, epoch 28, cost -82.390878334
Pre-training layer 0, epoch 29, cost -82.3460982132
Pre-training layer 0, epoch 30, cost -81.6905980301
Pre-training layer 0, epoch 30, representative training free energy -474.174694031
Pre-training layer 0, epoch 30, validation free energy -462.002455872
Pre-training layer 0, epoch 31, cost -81.5939022446
Pre-training layer 0, epoch 32, cost -81.3445108414
Pre-training layer 0, epoch 33, cost -80.8693341064
Pre-training layer 0, epoch 34, cost -80.8332872963
Pre-training layer 0, epoch 35, cost -80.5837972641
Pre-training layer 0, epoch 35, representative training free energy -471.657211975
Pre-training layer 0, epoch 35, validation free energy -459.477009277
Pre-training layer 0, epoch 36, cost -80.4747379112
Pre-training layer 0, epoch 37, cost -80.1102933502
Pre-training layer 0, epoch 38, cost -80.1457162857
Pre-training layer 0, epoch 39, cost -79.7896208
Pre-training layer 0, epoch 40, cost -79.6043808937
Pre-training layer 0, epoch 40, representative training free energy -468.895947815
Pre-training layer 0, epoch 40, validation free energy -456.169030334
Pre-training layer 0, epoch 41, cost -79.4341802788
Pre-training layer 0, epoch 42, cost -79.2965150261
Pre-training layer 0, epoch 43, cost -79.0860419083
Pre-training layer 0, epoch 44, cost -78.8797655106
Pre-training layer 0, epoch 45, cost -78.6373044205
Pre-training layer 0, epoch 45, representative training free energy -466.269527344
Pre-training layer 0, epoch 45, validation free energy -453.165706787
Pre-training layer 0, epoch 46, cost -78.6633218956
Pre-training layer 0, epoch 47, cost -78.2895818138
Pre-training layer 0, epoch 48, cost -78.3390004921
Pre-training layer 0, epoch 49, cost -77.9987820816
Pre-training layer 0, epoch 50, cost -78.0197032166
Pre-training layer 0, epoch 50, representative training free energy -464.447414917
Pre-training layer 0, epoch 50, validation free energy -450.911069031
Pre-training layer 0, epoch 51, cost -77.7735934067
Pre-training layer 0, epoch 52, cost -77.6228731155
Pre-training layer 0, epoch 53, cost -77.5470700455
Pre-training layer 0, epoch 54, cost -77.4684589195
Pre-training layer 0, epoch 55, cost -77.342020607
Pre-training layer 0, epoch 55, representative training free energy -464.202925476
Pre-training layer 0, epoch 55, validation free energy -450.838387817
Pre-training layer 0, epoch 56, cost -77.2096444511
Pre-training layer 0, epoch 57, cost -77.1170316505
Pre-training layer 0, epoch 58, cost -76.9001215935
Pre-training layer 0, epoch 59, cost -76.9806068611
Pre-training layer 0, epoch 60, cost -76.8057246971
Pre-training layer 0, epoch 60, representative training free energy -460.151985657
Pre-training layer 0, epoch 60, validation free energy -446.282990845
Pre-training layer 0, epoch 61, cost -76.4414214706
Pre-training layer 0, epoch 62, cost -76.5337435341
Pre-training layer 0, epoch 63, cost -76.4584817123
Pre-training layer 0, epoch 64, cost -76.3612764549
Pre-training layer 0, epoch 65, cost -76.1375080299
Pre-training layer 0, epoch 65, representative training free energy -459.26558075
Pre-training layer 0, epoch 65, validation free energy -445.332046387
Pre-training layer 0, epoch 66, cost -76.1975172234
Pre-training layer 0, epoch 67, cost -76.117843914
Pre-training layer 0, epoch 68, cost -75.8085867691
Pre-training layer 0, epoch 69, cost -75.6889951515
Pre-training layer 0, epoch 70, cost -75.6107930756
Pre-training layer 0, epoch 70, representative training free energy -454.9326427
Pre-training layer 0, epoch 70, validation free energy -441.149363037
Pre-training layer 0, epoch 71, cost -75.6469968224
Pre-training layer 0, epoch 72, cost -75.5248963928
Pre-training layer 0, epoch 73, cost -75.432446804
Pre-training layer 0, epoch 74, cost -75.4037304687
Pre-training layer 0, epoch 75, cost -75.3630005074
Pre-training layer 0, epoch 75, representative training free energy -457.320272217
Pre-training layer 0, epoch 75, validation free energy -442.677572388
Pre-training layer 0, epoch 76, cost -75.2298353958
Pre-training layer 0, epoch 77, cost -75.0462694931
Pre-training layer 0, epoch 78, cost -74.99420187
Pre-training layer 0, epoch 79, cost -74.9886968613
Pre-training layer 0, epoch 80, cost -74.7638800812
Pre-training layer 0, epoch 80, representative training free energy -455.39487323
Pre-training layer 0, epoch 80, validation free energy -440.692067627
Pre-training layer 0, epoch 81, cost -74.8494745445
Pre-training layer 0, epoch 82, cost -74.7275213623
Pre-training layer 0, epoch 83, cost -74.5520443535
Pre-training layer 0, epoch 84, cost -74.5920314789
Pre-training layer 0, epoch 85, cost -74.4388585281
Pre-training layer 0, epoch 85, representative training free energy -454.552825073
Pre-training layer 0, epoch 85, validation free energy -439.273071289
Pre-training layer 0, epoch 86, cost -74.332750721
Pre-training layer 0, epoch 87, cost -74.5231359482
Pre-training layer 0, epoch 88, cost -74.2236250687
Pre-training layer 0, epoch 89, cost -74.2487114716
Pre-training layer 0, epoch 90, cost -74.1189982224
Pre-training layer 0, epoch 90, representative training free energy -452.87355426
Pre-training layer 0, epoch 90, validation free energy -437.640250854
Pre-training layer 0, epoch 91, cost -74.266844368
Pre-training layer 0, epoch 92, cost -74.0865924072
Pre-training layer 0, epoch 93, cost -74.0254518127
Pre-training layer 0, epoch 94, cost -73.9113345528
Pre-training layer 0, epoch 95, cost -73.9525878334
Pre-training layer 0, epoch 95, representative training free energy -452.512475769
Pre-training layer 0, epoch 95, validation free energy -437.509435181
Pre-training layer 0, epoch 96, cost -73.8419746017
Pre-training layer 0, epoch 97, cost -73.6491998482
Pre-training layer 0, epoch 98, cost -73.7939084053
Pre-training layer 0, epoch 99, cost -73.6926599884
Pre-training layer 1, epoch 0, cost -375.963214417
Pre-training layer 1, epoch 0, representative training free energy -41880.4461543
Pre-training layer 1, epoch 0, validation free energy -41590.2345391
Pre-training layer 1, epoch 1, cost -323.28515686
Pre-training layer 1, epoch 2, cost -306.867919617
Pre-training layer 1, epoch 3, cost -297.326865158
Pre-training layer 1, epoch 4, cost -290.134995575
Pre-training layer 1, epoch 5, cost -284.969998856
Pre-training layer 1, epoch 5, representative training free energy -57533.4711992
Pre-training layer 1, epoch 5, validation free energy -57120.1409336
Pre-training layer 1, epoch 6, cost -280.879488831
Pre-training layer 1, epoch 7, cost -277.445013046
Pre-training layer 1, epoch 8, cost -274.584511032
Pre-training layer 1, epoch 9, cost -272.164196243
Pre-training layer 1, epoch 10, cost -270.185485077
Pre-training layer 1, epoch 10, representative training free energy -62168.6422266
Pre-training layer 1, epoch 10, validation free energy -61720.1680781
Pre-training layer 1, epoch 11, cost -268.413893204
Pre-training layer 1, epoch 12, cost -266.855674362
Pre-training layer 1, epoch 13, cost -265.352060318
Pre-training layer 1, epoch 14, cost -263.87791275
Pre-training layer 1, epoch 15, cost -262.706012955
Pre-training layer 1, epoch 15, representative training free energy -65096.7370312
Pre-training layer 1, epoch 15, validation free energy -64635.8278633
Pre-training layer 1, epoch 16, cost -261.800888519
Pre-training layer 1, epoch 17, cost -260.615123825
Pre-training layer 1, epoch 18, cost -259.913668137
Pre-training layer 1, epoch 19, cost -258.97503685
Pre-training layer 1, epoch 20, cost -258.267410965
Pre-training layer 1, epoch 20, representative training free energy -67006.8761016
Pre-training layer 1, epoch 20, validation free energy -66540.958668
Pre-training layer 1, epoch 21, cost -257.601794815
Pre-training layer 1, epoch 22, cost -256.981035843
Pre-training layer 1, epoch 23, cost -256.441553116
Pre-training layer 1, epoch 24, cost -255.635393143
Pre-training layer 1, epoch 25, cost -255.229904785
Pre-training layer 1, epoch 25, representative training free energy -68524.3441406
Pre-training layer 1, epoch 25, validation free energy -68045.4540273
Pre-training layer 1, epoch 26, cost -254.768483658
Pre-training layer 1, epoch 27, cost -254.224025574
Pre-training layer 1, epoch 28, cost -253.937733765
Pre-training layer 1, epoch 29, cost -253.304492416
Pre-training layer 1, epoch 30, cost -252.964988174
Pre-training layer 1, epoch 30, representative training free energy -69705.2388984
Pre-training layer 1, epoch 30, validation free energy -69223.9256602
Pre-training layer 1, epoch 31, cost -252.601961365
Pre-training layer 1, epoch 32, cost -252.289437714
Pre-training layer 1, epoch 33, cost -251.833619232
Pre-training layer 1, epoch 34, cost -251.530670776
Pre-training layer 1, epoch 35, cost -251.213714676
Pre-training layer 1, epoch 35, representative training free energy -70815.2153867
Pre-training layer 1, epoch 35, validation free energy -70326.2179102
Pre-training layer 1, epoch 36, cost -250.926272736
Pre-training layer 1, epoch 37, cost -250.649541855
Pre-training layer 1, epoch 38, cost -250.417345428
Pre-training layer 1, epoch 39, cost -250.208560944
Pre-training layer 1, epoch 40, cost -249.867929382
Pre-training layer 1, epoch 40, representative training free energy -71737.6464453
Pre-training layer 1, epoch 40, validation free energy -71240.2708281
Pre-training layer 1, epoch 41, cost -249.615393982
Pre-training layer 1, epoch 42, cost -249.338764267
Pre-training layer 1, epoch 43, cost -249.112758713
Pre-training layer 1, epoch 44, cost -248.887484512
Pre-training layer 1, epoch 45, cost -248.701587219
Pre-training layer 1, epoch 45, representative training free energy -72487.3622891
Pre-training layer 1, epoch 45, validation free energy -71983.3496992
Pre-training layer 1, epoch 46, cost -248.577430878
Pre-training layer 1, epoch 47, cost -248.332630157
Pre-training layer 1, epoch 48, cost -248.093535233
Pre-training layer 1, epoch 49, cost -247.946092072
Pre-training layer 1, epoch 50, cost -247.661547089
Pre-training layer 1, epoch 50, representative training free energy -73213.6599609
Pre-training layer 1, epoch 50, validation free energy -72707.0833477
Pre-training layer 1, epoch 51, cost -247.618863449
Pre-training layer 1, epoch 52, cost -247.409771729
Pre-training layer 1, epoch 53, cost -247.264112015
Pre-training layer 1, epoch 54, cost -246.962780762
Pre-training layer 1, epoch 55, cost -246.959917755
Pre-training layer 1, epoch 55, representative training free energy -73816.6361406
Pre-training layer 1, epoch 55, validation free energy -73304.853832
Pre-training layer 1, epoch 56, cost -246.708452988
Pre-training layer 1, epoch 57, cost -246.626773987
Pre-training layer 1, epoch 58, cost -246.468555603
Pre-training layer 1, epoch 59, cost -246.384028702
Pre-training layer 1, epoch 60, cost -246.178064346
Pre-training layer 1, epoch 60, representative training free energy -74479.3241641
Pre-training layer 1, epoch 60, validation free energy -73965.0236797
Pre-training layer 1, epoch 61, cost -246.05555397
Pre-training layer 1, epoch 62, cost -245.920627823
Pre-training layer 1, epoch 63, cost -245.898179626
Pre-training layer 1, epoch 64, cost -245.708981857
Pre-training layer 1, epoch 65, cost -245.528494339
Pre-training layer 1, epoch 65, representative training free energy -74902.9978789
Pre-training layer 1, epoch 65, validation free energy -74384.8877383
Pre-training layer 1, epoch 66, cost -245.54836853
Pre-training layer 1, epoch 67, cost -245.310203018
Pre-training layer 1, epoch 68, cost -245.170054245
Pre-training layer 1, epoch 69, cost -245.017524872
Pre-training layer 1, epoch 70, cost -245.115288391
Pre-training layer 1, epoch 70, representative training free energy -75511.9631914
Pre-training layer 1, epoch 70, validation free energy -74992.2817773
Pre-training layer 1, epoch 71, cost -244.939652557
Pre-training layer 1, epoch 72, cost -244.945559311
Pre-training layer 1, epoch 73, cost -244.82325325
Pre-training layer 1, epoch 74, cost -244.722381363
Pre-training layer 1, epoch 75, cost -244.50772316
Pre-training layer 1, epoch 75, representative training free energy -75870.5981953
Pre-training layer 1, epoch 75, validation free energy -75348.2274766
Pre-training layer 1, epoch 76, cost -244.413206787
Pre-training layer 1, epoch 77, cost -244.382449341
Pre-training layer 1, epoch 78, cost -244.30780426
Pre-training layer 1, epoch 79, cost -244.15776886
Pre-training layer 1, epoch 80, cost -243.959253006
Pre-training layer 1, epoch 80, representative training free energy -76341.6966055
Pre-training layer 1, epoch 80, validation free energy -75811.9873398
Pre-training layer 1, epoch 81, cost -244.003803329
Pre-training layer 1, epoch 82, cost -243.903155365
Pre-training layer 1, epoch 83, cost -243.922667389
Pre-training layer 1, epoch 84, cost -243.795265808
Pre-training layer 1, epoch 85, cost -243.808804245
Pre-training layer 1, epoch 85, representative training free energy -76767.5970859
Pre-training layer 1, epoch 85, validation free energy -76239.0681406
Pre-training layer 1, epoch 86, cost -243.622410583
Pre-training layer 1, epoch 87, cost -243.511547852
Pre-training layer 1, epoch 88, cost -243.416132965
Pre-training layer 1, epoch 89, cost -243.335265121
Pre-training layer 1, epoch 90, cost -243.269449615
Pre-training layer 1, epoch 90, representative training free energy -77139.5456563
Pre-training layer 1, epoch 90, validation free energy -76609.4052734
Pre-training layer 1, epoch 91, cost -243.278450623
Pre-training layer 1, epoch 92, cost -243.189781189
Pre-training layer 1, epoch 93, cost -243.108774185
Pre-training layer 1, epoch 94, cost -242.988787231
Pre-training layer 1, epoch 95, cost -242.942754135
Pre-training layer 1, epoch 95, representative training free energy -77446.3954336
Pre-training layer 1, epoch 95, validation free energy -76911.1248281
Pre-training layer 1, epoch 96, cost -242.788566132
Pre-training layer 1, epoch 97, cost -242.781399918
Pre-training layer 1, epoch 98, cost -242.810615997
Pre-training layer 1, epoch 99, cost -242.682301865
Pre-training layer 2, epoch 0, cost -136.700699615
Pre-training layer 2, epoch 0, representative training free energy 2329.7260033
Pre-training layer 2, epoch 0, validation free energy 2320.24999792
Pre-training layer 2, epoch 1, cost -97.052924881
Pre-training layer 2, epoch 2, cost -88.9779886627
Pre-training layer 2, epoch 3, cost -84.6177466011
Pre-training layer 2, epoch 4, cost -81.6187630272
Pre-training layer 2, epoch 5, cost -79.2174459076
Pre-training layer 2, epoch 5, representative training free energy 3606.62680847
Pre-training layer 2, epoch 5, validation free energy 3582.68545435
Pre-training layer 2, epoch 6, cost -77.4794340515
Pre-training layer 2, epoch 7, cost -75.8900538063
Pre-training layer 2, epoch 8, cost -74.7263331223
Pre-training layer 2, epoch 9, cost -73.6648772049
Pre-training layer 2, epoch 10, cost -72.8030118752
Pre-training layer 2, epoch 10, representative training free energy 4213.37636938
Pre-training layer 2, epoch 10, validation free energy 4189.53619446
Pre-training layer 2, epoch 11, cost -72.2140841484
Pre-training layer 2, epoch 12, cost -71.4291096687
Pre-training layer 2, epoch 13, cost -70.9085844994
Pre-training layer 2, epoch 14, cost -70.3345810127
Pre-training layer 2, epoch 15, cost -69.8633896637
Pre-training layer 2, epoch 15, representative training free energy 4672.76284229
Pre-training layer 2, epoch 15, validation free energy 4643.47444678
Pre-training layer 2, epoch 16, cost -69.4730329895
Pre-training layer 2, epoch 17, cost -68.9167313957
Pre-training layer 2, epoch 18, cost -68.6500853729
Pre-training layer 2, epoch 19, cost -68.2788463593
Pre-training layer 2, epoch 20, cost -67.8627468872
Pre-training layer 2, epoch 20, representative training free energy 5066.30711475
Pre-training layer 2, epoch 20, validation free energy 5028.28196875
Pre-training layer 2, epoch 21, cost -67.7020257568
Pre-training layer 2, epoch 22, cost -67.3984986496
Pre-training layer 2, epoch 23, cost -67.2272112656
Pre-training layer 2, epoch 24, cost -66.8964838028
Pre-training layer 2, epoch 25, cost -66.7786177444
Pre-training layer 2, epoch 25, representative training free energy 5419.50631885
Pre-training layer 2, epoch 25, validation free energy 5380.28687866
Pre-training layer 2, epoch 26, cost -66.3693762398
Pre-training layer 2, epoch 27, cost -66.2207676315
Pre-training layer 2, epoch 28, cost -66.0334669304
Pre-training layer 2, epoch 29, cost -65.9350700951
Pre-training layer 2, epoch 30, cost -65.8593152046
Pre-training layer 2, epoch 30, representative training free energy 5694.92748511
Pre-training layer 2, epoch 30, validation free energy 5654.61233179
Pre-training layer 2, epoch 31, cost -65.5325526619
Pre-training layer 2, epoch 32, cost -65.3563499069
Pre-training layer 2, epoch 33, cost -65.208655014
Pre-training layer 2, epoch 34, cost -65.0755373192
Pre-training layer 2, epoch 35, cost -64.9547714615
Pre-training layer 2, epoch 35, representative training free energy 5988.64548657
Pre-training layer 2, epoch 35, validation free energy 5942.61402686
Pre-training layer 2, epoch 36, cost -64.8934037018
Pre-training layer 2, epoch 37, cost -64.7087850952
Pre-training layer 2, epoch 38, cost -64.5626891708
Pre-training layer 2, epoch 39, cost -64.5342551231
Pre-training layer 2, epoch 40, cost -64.4078236961
Pre-training layer 2, epoch 40, representative training free energy 6204.54975879
Pre-training layer 2, epoch 40, validation free energy 6158.45075317
Pre-training layer 2, epoch 41, cost -64.3230694389
Pre-training layer 2, epoch 42, cost -64.2730678558
Pre-training layer 2, epoch 43, cost -64.0948228836
Pre-training layer 2, epoch 44, cost -63.9821871948
Pre-training layer 2, epoch 45, cost -64.0182841492
Pre-training layer 2, epoch 45, representative training free energy 6453.07562695
Pre-training layer 2, epoch 45, validation free energy 6402.74857861
Pre-training layer 2, epoch 46, cost -63.8094874954
Pre-training layer 2, epoch 47, cost -63.7882974815
Pre-training layer 2, epoch 48, cost -63.7228533363
Pre-training layer 2, epoch 49, cost -63.628249836
Pre-training layer 2, epoch 50, cost -63.4348221397
Pre-training layer 2, epoch 50, representative training free energy 6669.42258154
Pre-training layer 2, epoch 50, validation free energy 6616.73404492
Pre-training layer 2, epoch 51, cost -63.4522515488
Pre-training layer 2, epoch 52, cost -63.2589884567
Pre-training layer 2, epoch 53, cost -63.3906828308
Pre-training layer 2, epoch 54, cost -63.3159970474
Pre-training layer 2, epoch 55, cost -63.264304657
Pre-training layer 2, epoch 55, representative training free energy 6864.82424512
Pre-training layer 2, epoch 55, validation free energy 6810.76148389
Pre-training layer 2, epoch 56, cost -62.9404637718
Pre-training layer 2, epoch 57, cost -62.9950839806
Pre-training layer 2, epoch 58, cost -63.0010853767
Pre-training layer 2, epoch 59, cost -62.9731666565
Pre-training layer 2, epoch 60, cost -62.8450847435
Pre-training layer 2, epoch 60, representative training free energy 7061.92549414
Pre-training layer 2, epoch 60, validation free energy 7003.30764697
Pre-training layer 2, epoch 61, cost -62.8165791321
Pre-training layer 2, epoch 62, cost -62.7198288918
Pre-training layer 2, epoch 63, cost -62.7342935944
Pre-training layer 2, epoch 64, cost -62.646484642
Pre-training layer 2, epoch 65, cost -62.7550655174
Pre-training layer 2, epoch 65, representative training free energy 7255.41933447
Pre-training layer 2, epoch 65, validation free energy 7196.3241377
Pre-training layer 2, epoch 66, cost -62.5762910652
Pre-training layer 2, epoch 67, cost -62.4732175255
Pre-training layer 2, epoch 68, cost -62.5850457954
Pre-training layer 2, epoch 69, cost -62.4685822105
Pre-training layer 2, epoch 70, cost -62.3893916512
Pre-training layer 2, epoch 70, representative training free energy 7433.26646484
Pre-training layer 2, epoch 70, validation free energy 7371.10437988
Pre-training layer 2, epoch 71, cost -62.3722927475
Pre-training layer 2, epoch 72, cost -62.356331749
Pre-training layer 2, epoch 73, cost -62.2768525505
Pre-training layer 2, epoch 74, cost -62.2369716263
Pre-training layer 2, epoch 75, cost -62.1068210793
Pre-training layer 2, epoch 75, representative training free energy 7599.50462305
Pre-training layer 2, epoch 75, validation free energy 7537.54289062
Pre-training layer 2, epoch 76, cost -62.1552891731
Pre-training layer 2, epoch 77, cost -62.1311017799
Pre-training layer 2, epoch 78, cost -62.0875861359
Pre-training layer 2, epoch 79, cost -61.9068743896
Pre-training layer 2, epoch 80, cost -62.0553145409
Pre-training layer 2, epoch 80, representative training free energy 7762.95720703
Pre-training layer 2, epoch 80, validation free energy 7701.8303877
Pre-training layer 2, epoch 81, cost -62.0191183472
Pre-training layer 2, epoch 82, cost -61.8886142349
Pre-training layer 2, epoch 83, cost -61.9240512085
Pre-training layer 2, epoch 84, cost -61.8719281197
Pre-training layer 2, epoch 85, cost -61.8238821793
Pre-training layer 2, epoch 85, representative training free energy 7924.67108447
Pre-training layer 2, epoch 85, validation free energy 7860.1652417
Pre-training layer 2, epoch 86, cost -61.8511894989
Pre-training layer 2, epoch 87, cost -61.646537323
Pre-training layer 2, epoch 88, cost -61.731955986
Pre-training layer 2, epoch 89, cost -61.8125823021
Pre-training layer 2, epoch 90, cost -61.7484677505
Pre-training layer 2, epoch 90, representative training free energy 8077.56513281
Pre-training layer 2, epoch 90, validation free energy 8011.75179443
Pre-training layer 2, epoch 91, cost -61.5565959167
Pre-training layer 2, epoch 92, cost -61.58778162
Pre-training layer 2, epoch 93, cost -61.6243880463
Pre-training layer 2, epoch 94, cost -61.6776908112
Pre-training layer 2, epoch 95, cost -61.580309906
Pre-training layer 2, epoch 95, representative training free energy 8209.69646777
Pre-training layer 2, epoch 95, validation free energy 8141.43074854
Pre-training layer 2, epoch 96, cost -61.561360054
Pre-training layer 2, epoch 97, cost -61.4459325027
Pre-training layer 2, epoch 98, cost -61.417682457
Pre-training layer 2, epoch 99, cost -61.4714058304
The pretraining code for file dbn_loop.pyc ran for 5.40m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 36.000000 %
     epoch 1, minibatch 200/200, test error of best model 30.600000 %
epoch 2, minibatch 200/200, validation error 27.400000 %
     epoch 2, minibatch 200/200, test error of best model 19.000000 %
epoch 3, minibatch 200/200, validation error 24.400000 %
     epoch 3, minibatch 200/200, test error of best model 15.000000 %
epoch 4, minibatch 200/200, validation error 22.800000 %
     epoch 4, minibatch 200/200, test error of best model 13.000000 %
epoch 5, minibatch 200/200, validation error 21.800000 %
     epoch 5, minibatch 200/200, test error of best model 11.400000 %
epoch 6, minibatch 200/200, validation error 21.400000 %
     epoch 6, minibatch 200/200, test error of best model 11.000000 %
epoch 7, minibatch 200/200, validation error 21.600000 %
epoch 8, minibatch 200/200, validation error 20.800000 %
     epoch 8, minibatch 200/200, test error of best model 9.800000 %
epoch 9, minibatch 200/200, validation error 20.400000 %
     epoch 9, minibatch 200/200, test error of best model 9.000000 %
epoch 10, minibatch 200/200, validation error 20.200000 %
     epoch 10, minibatch 200/200, test error of best model 8.200000 %
epoch 11, minibatch 200/200, validation error 19.800000 %
     epoch 11, minibatch 200/200, test error of best model 7.400000 %
epoch 12, minibatch 200/200, validation error 19.600000 %
     epoch 12, minibatch 200/200, test error of best model 7.400000 %
epoch 13, minibatch 200/200, validation error 19.400000 %
     epoch 13, minibatch 200/200, test error of best model 7.000000 %
epoch 14, minibatch 200/200, validation error 19.000000 %
     epoch 14, minibatch 200/200, test error of best model 7.000000 %
epoch 15, minibatch 200/200, validation error 18.600000 %
     epoch 15, minibatch 200/200, test error of best model 6.600000 %
epoch 16, minibatch 200/200, validation error 18.200000 %
     epoch 16, minibatch 200/200, test error of best model 7.000000 %
epoch 17, minibatch 200/200, validation error 18.000000 %
     epoch 17, minibatch 200/200, test error of best model 7.200000 %
epoch 18, minibatch 200/200, validation error 17.800000 %
     epoch 18, minibatch 200/200, test error of best model 7.600000 %
epoch 19, minibatch 200/200, validation error 17.600000 %
     epoch 19, minibatch 200/200, test error of best model 7.600000 %
epoch 20, minibatch 200/200, validation error 17.600000 %
epoch 21, minibatch 200/200, validation error 17.600000 %
epoch 22, minibatch 200/200, validation error 17.400000 %
     epoch 22, minibatch 200/200, test error of best model 8.000000 %
epoch 23, minibatch 200/200, validation error 17.400000 %
epoch 24, minibatch 200/200, validation error 17.400000 %
epoch 25, minibatch 200/200, validation error 17.400000 %
epoch 26, minibatch 200/200, validation error 17.200000 %
     epoch 26, minibatch 200/200, test error of best model 7.600000 %
epoch 27, minibatch 200/200, validation error 17.200000 %
epoch 28, minibatch 200/200, validation error 17.200000 %
epoch 29, minibatch 200/200, validation error 17.200000 %
epoch 30, minibatch 200/200, validation error 17.200000 %
epoch 31, minibatch 200/200, validation error 17.200000 %
epoch 32, minibatch 200/200, validation error 17.200000 %
epoch 33, minibatch 200/200, validation error 17.200000 %
epoch 34, minibatch 200/200, validation error 17.400000 %
epoch 35, minibatch 200/200, validation error 17.400000 %
epoch 36, minibatch 200/200, validation error 17.400000 %
epoch 37, minibatch 200/200, validation error 17.400000 %
epoch 38, minibatch 200/200, validation error 17.400000 %
epoch 39, minibatch 200/200, validation error 17.400000 %
epoch 40, minibatch 200/200, validation error 17.200000 %
epoch 41, minibatch 200/200, validation error 17.200000 %
epoch 42, minibatch 200/200, validation error 17.200000 %
epoch 43, minibatch 200/200, validation error 17.200000 %
epoch 44, minibatch 200/200, validation error 17.200000 %
epoch 45, minibatch 200/200, validation error 17.200000 %
epoch 46, minibatch 200/200, validation error 17.200000 %
epoch 47, minibatch 200/200, validation error 17.200000 %
epoch 48, minibatch 200/200, validation error 17.200000 %
epoch 49, minibatch 200/200, validation error 17.200000 %
epoch 50, minibatch 200/200, validation error 17.200000 %
epoch 51, minibatch 200/200, validation error 17.200000 %
Optimization complete with best validation score of 17.200000 %, obtained at iteration 5200, with test performance 7.600000 %
The fine tuning code for file dbn_loop.pyc ran for 0.91m


==========Sample: (3000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.952183533
Pre-training layer 0, epoch 0, representative training free energy -561.01148175
Pre-training layer 0, epoch 0, validation free energy -555.079238037
Pre-training layer 0, epoch 1, cost -116.859782333
Pre-training layer 0, epoch 2, cost -108.098069763
Pre-training layer 0, epoch 3, cost -102.731573664
Pre-training layer 0, epoch 4, cost -99.3440986888
Pre-training layer 0, epoch 5, cost -96.6470982869
Pre-training layer 0, epoch 5, representative training free energy -504.360066589
Pre-training layer 0, epoch 5, validation free energy -495.781779175
Pre-training layer 0, epoch 6, cost -94.3891120911
Pre-training layer 0, epoch 7, cost -92.7908963521
Pre-training layer 0, epoch 8, cost -91.3919061534
Pre-training layer 0, epoch 9, cost -90.1397321828
Pre-training layer 0, epoch 10, cost -89.0471281433
Pre-training layer 0, epoch 10, representative training free energy -479.327114319
Pre-training layer 0, epoch 10, validation free energy -470.27468042
Pre-training layer 0, epoch 11, cost -88.1459591166
Pre-training layer 0, epoch 12, cost -87.3868219757
Pre-training layer 0, epoch 13, cost -86.7614006933
Pre-training layer 0, epoch 14, cost -86.0257375081
Pre-training layer 0, epoch 15, cost -85.3570276515
Pre-training layer 0, epoch 15, representative training free energy -470.454895691
Pre-training layer 0, epoch 15, validation free energy -460.89521637
Pre-training layer 0, epoch 16, cost -84.8492125193
Pre-training layer 0, epoch 17, cost -84.467431132
Pre-training layer 0, epoch 18, cost -84.0779493078
Pre-training layer 0, epoch 19, cost -83.5036369197
Pre-training layer 0, epoch 20, cost -82.9961625163
Pre-training layer 0, epoch 20, representative training free energy -462.761414612
Pre-training layer 0, epoch 20, validation free energy -453.458221863
Pre-training layer 0, epoch 21, cost -82.6717935944
Pre-training layer 0, epoch 22, cost -82.3446514638
Pre-training layer 0, epoch 23, cost -82.0481348292
Pre-training layer 0, epoch 24, cost -81.7131560644
Pre-training layer 0, epoch 25, cost -81.5189599609
Pre-training layer 0, epoch 25, representative training free energy -454.155890564
Pre-training layer 0, epoch 25, validation free energy -444.451516479
Pre-training layer 0, epoch 26, cost -81.1466246668
Pre-training layer 0, epoch 27, cost -80.8599068451
Pre-training layer 0, epoch 28, cost -80.6808234024
Pre-training layer 0, epoch 29, cost -80.3977892176
Pre-training layer 0, epoch 30, cost -80.066267039
Pre-training layer 0, epoch 30, representative training free energy -448.248508179
Pre-training layer 0, epoch 30, validation free energy -438.790416626
Pre-training layer 0, epoch 31, cost -79.7484270477
Pre-training layer 0, epoch 32, cost -79.6279529826
Pre-training layer 0, epoch 33, cost -79.4830003993
Pre-training layer 0, epoch 34, cost -79.0832704544
Pre-training layer 0, epoch 35, cost -79.0028537242
Pre-training layer 0, epoch 35, representative training free energy -448.603022766
Pre-training layer 0, epoch 35, validation free energy -438.199703613
Pre-training layer 0, epoch 36, cost -78.8412666321
Pre-training layer 0, epoch 37, cost -78.7701181539
Pre-training layer 0, epoch 38, cost -78.5463365428
Pre-training layer 0, epoch 39, cost -78.2816754278
Pre-training layer 0, epoch 40, cost -78.2039647166
Pre-training layer 0, epoch 40, representative training free energy -449.004670105
Pre-training layer 0, epoch 40, validation free energy -438.156541809
Pre-training layer 0, epoch 41, cost -78.1303994751
Pre-training layer 0, epoch 42, cost -77.8771900431
Pre-training layer 0, epoch 43, cost -77.7598944982
Pre-training layer 0, epoch 44, cost -77.6259461339
Pre-training layer 0, epoch 45, cost -77.506520017
Pre-training layer 0, epoch 45, representative training free energy -442.411119141
Pre-training layer 0, epoch 45, validation free energy -431.514201965
Pre-training layer 0, epoch 46, cost -77.4179191589
Pre-training layer 0, epoch 47, cost -77.2552250544
Pre-training layer 0, epoch 48, cost -77.1422766749
Pre-training layer 0, epoch 49, cost -77.1530108007
Pre-training layer 0, epoch 50, cost -77.0566746648
Pre-training layer 0, epoch 50, representative training free energy -440.483395264
Pre-training layer 0, epoch 50, validation free energy -429.508291382
Pre-training layer 0, epoch 51, cost -76.7788202922
Pre-training layer 0, epoch 52, cost -76.5565517426
Pre-training layer 0, epoch 53, cost -76.5525691986
Pre-training layer 0, epoch 54, cost -76.5571084086
Pre-training layer 0, epoch 55, cost -76.3043544896
Pre-training layer 0, epoch 55, representative training free energy -436.622836609
Pre-training layer 0, epoch 55, validation free energy -425.984574646
Pre-training layer 0, epoch 56, cost -76.2177129491
Pre-training layer 0, epoch 57, cost -76.0665444692
Pre-training layer 0, epoch 58, cost -76.1362021764
Pre-training layer 0, epoch 59, cost -75.9549716695
Pre-training layer 0, epoch 60, cost -75.7636445491
Pre-training layer 0, epoch 60, representative training free energy -438.571376465
Pre-training layer 0, epoch 60, validation free energy -427.091661743
Pre-training layer 0, epoch 61, cost -75.8628908539
Pre-training layer 0, epoch 62, cost -75.763844986
Pre-training layer 0, epoch 63, cost -75.4796389135
Pre-training layer 0, epoch 64, cost -75.4723763657
Pre-training layer 0, epoch 65, cost -75.567396253
Pre-training layer 0, epoch 65, representative training free energy -436.827896912
Pre-training layer 0, epoch 65, validation free energy -425.253850952
Pre-training layer 0, epoch 66, cost -75.2432026927
Pre-training layer 0, epoch 67, cost -75.077864596
Pre-training layer 0, epoch 68, cost -75.1745839818
Pre-training layer 0, epoch 69, cost -75.0905430349
Pre-training layer 0, epoch 70, cost -75.0242931875
Pre-training layer 0, epoch 70, representative training free energy -433.573015869
Pre-training layer 0, epoch 70, validation free energy -421.82729303
Pre-training layer 0, epoch 71, cost -74.9550880432
Pre-training layer 0, epoch 72, cost -74.7941942851
Pre-training layer 0, epoch 73, cost -74.8216353734
Pre-training layer 0, epoch 74, cost -74.77637544
Pre-training layer 0, epoch 75, cost -74.6223464966
Pre-training layer 0, epoch 75, representative training free energy -432.775354248
Pre-training layer 0, epoch 75, validation free energy -421.160897278
Pre-training layer 0, epoch 76, cost -74.5946304576
Pre-training layer 0, epoch 77, cost -74.4628379949
Pre-training layer 0, epoch 78, cost -74.497795372
Pre-training layer 0, epoch 79, cost -74.3552846781
Pre-training layer 0, epoch 80, cost -74.2106696955
Pre-training layer 0, epoch 80, representative training free energy -434.93074054
Pre-training layer 0, epoch 80, validation free energy -422.928195801
Pre-training layer 0, epoch 81, cost -74.363639679
Pre-training layer 0, epoch 82, cost -74.2449226379
Pre-training layer 0, epoch 83, cost -74.127329216
Pre-training layer 0, epoch 84, cost -74.0558545049
Pre-training layer 0, epoch 85, cost -74.0411755117
Pre-training layer 0, epoch 85, representative training free energy -432.633179382
Pre-training layer 0, epoch 85, validation free energy -420.669184753
Pre-training layer 0, epoch 86, cost -73.8467877833
Pre-training layer 0, epoch 87, cost -73.8584091949
Pre-training layer 0, epoch 88, cost -73.7809360631
Pre-training layer 0, epoch 89, cost -73.8145582453
Pre-training layer 0, epoch 90, cost -73.7658765793
Pre-training layer 0, epoch 90, representative training free energy -430.011903015
Pre-training layer 0, epoch 90, validation free energy -417.811906555
Pre-training layer 0, epoch 91, cost -73.7829588954
Pre-training layer 0, epoch 92, cost -73.5165909576
Pre-training layer 0, epoch 93, cost -73.6321489461
Pre-training layer 0, epoch 94, cost -73.59262839
Pre-training layer 0, epoch 95, cost -73.6068134054
Pre-training layer 0, epoch 95, representative training free energy -429.182677856
Pre-training layer 0, epoch 95, validation free energy -416.335243042
Pre-training layer 0, epoch 96, cost -73.3914493942
Pre-training layer 0, epoch 97, cost -73.3140893046
Pre-training layer 0, epoch 98, cost -73.1911683146
Pre-training layer 0, epoch 99, cost -73.273971494
Pre-training layer 1, epoch 0, cost -344.808951009
Pre-training layer 1, epoch 0, representative training free energy -50569.5089258
Pre-training layer 1, epoch 0, validation free energy -50134.7045234
Pre-training layer 1, epoch 1, cost -295.994968669
Pre-training layer 1, epoch 2, cost -280.954737295
Pre-training layer 1, epoch 3, cost -272.252193604
Pre-training layer 1, epoch 4, cost -265.91290329
Pre-training layer 1, epoch 5, cost -261.402730713
Pre-training layer 1, epoch 5, representative training free energy -68977.5545234
Pre-training layer 1, epoch 5, validation free energy -68388.7413281
Pre-training layer 1, epoch 6, cost -257.778434855
Pre-training layer 1, epoch 7, cost -254.958314158
Pre-training layer 1, epoch 8, cost -252.548003642
Pre-training layer 1, epoch 9, cost -250.476227163
Pre-training layer 1, epoch 10, cost -248.769235992
Pre-training layer 1, epoch 10, representative training free energy -74432.3356016
Pre-training layer 1, epoch 10, validation free energy -73799.1645
Pre-training layer 1, epoch 11, cost -247.290073802
Pre-training layer 1, epoch 12, cost -245.975610555
Pre-training layer 1, epoch 13, cost -244.646365662
Pre-training layer 1, epoch 14, cost -243.699763845
Pre-training layer 1, epoch 15, cost -242.883903859
Pre-training layer 1, epoch 15, representative training free energy -77748.90875
Pre-training layer 1, epoch 15, validation free energy -77088.229332
Pre-training layer 1, epoch 16, cost -241.773142446
Pre-training layer 1, epoch 17, cost -241.043152313
Pre-training layer 1, epoch 18, cost -240.237612406
Pre-training layer 1, epoch 19, cost -239.643629201
Pre-training layer 1, epoch 20, cost -239.087796631
Pre-training layer 1, epoch 20, representative training free energy -80119.7149727
Pre-training layer 1, epoch 20, validation free energy -79434.991957
Pre-training layer 1, epoch 21, cost -238.549880829
Pre-training layer 1, epoch 22, cost -237.99302892
Pre-training layer 1, epoch 23, cost -237.451836344
Pre-training layer 1, epoch 24, cost -236.966011251
Pre-training layer 1, epoch 25, cost -236.600171204
Pre-training layer 1, epoch 25, representative training free energy -81965.1917891
Pre-training layer 1, epoch 25, validation free energy -81270.5745469
Pre-training layer 1, epoch 26, cost -236.346696879
Pre-training layer 1, epoch 27, cost -235.85194046
Pre-training layer 1, epoch 28, cost -235.479644623
Pre-training layer 1, epoch 29, cost -235.060644582
Pre-training layer 1, epoch 30, cost -234.880510203
Pre-training layer 1, epoch 30, representative training free energy -83414.3103945
Pre-training layer 1, epoch 30, validation free energy -82712.6493633
Pre-training layer 1, epoch 31, cost -234.573115438
Pre-training layer 1, epoch 32, cost -234.22530721
Pre-training layer 1, epoch 33, cost -233.962637583
Pre-training layer 1, epoch 34, cost -233.861054331
Pre-training layer 1, epoch 35, cost -233.38357783
Pre-training layer 1, epoch 35, representative training free energy -84671.8957578
Pre-training layer 1, epoch 35, validation free energy -83960.3918672
Pre-training layer 1, epoch 36, cost -233.134584401
Pre-training layer 1, epoch 37, cost -233.004523468
Pre-training layer 1, epoch 38, cost -232.689687907
Pre-training layer 1, epoch 39, cost -232.436531576
Pre-training layer 1, epoch 40, cost -232.122452647
Pre-training layer 1, epoch 40, representative training free energy -85776.8283398
Pre-training layer 1, epoch 40, validation free energy -85062.644793
Pre-training layer 1, epoch 41, cost -232.123899994
Pre-training layer 1, epoch 42, cost -231.909658356
Pre-training layer 1, epoch 43, cost -231.718620707
Pre-training layer 1, epoch 44, cost -231.57559082
Pre-training layer 1, epoch 45, cost -231.300843302
Pre-training layer 1, epoch 45, representative training free energy -86637.3174258
Pre-training layer 1, epoch 45, validation free energy -85908.8188477
Pre-training layer 1, epoch 46, cost -231.277700399
Pre-training layer 1, epoch 47, cost -231.084048411
Pre-training layer 1, epoch 48, cost -230.970884247
Pre-training layer 1, epoch 49, cost -230.72712972
Pre-training layer 1, epoch 50, cost -230.57066569
Pre-training layer 1, epoch 50, representative training free energy -87502.351918
Pre-training layer 1, epoch 50, validation free energy -86771.6351133
Pre-training layer 1, epoch 51, cost -230.455226898
Pre-training layer 1, epoch 52, cost -230.240531006
Pre-training layer 1, epoch 53, cost -230.046794993
Pre-training layer 1, epoch 54, cost -230.079102681
Pre-training layer 1, epoch 55, cost -229.885052389
Pre-training layer 1, epoch 55, representative training free energy -88312.5263945
Pre-training layer 1, epoch 55, validation free energy -87572.1453047
Pre-training layer 1, epoch 56, cost -229.771727804
Pre-training layer 1, epoch 57, cost -229.536540985
Pre-training layer 1, epoch 58, cost -229.539243876
Pre-training layer 1, epoch 59, cost -229.463799082
Pre-training layer 1, epoch 60, cost -229.35965922
Pre-training layer 1, epoch 60, representative training free energy -89007.6399336
Pre-training layer 1, epoch 60, validation free energy -88264.5172422
Pre-training layer 1, epoch 61, cost -229.180457458
Pre-training layer 1, epoch 62, cost -229.059071198
Pre-training layer 1, epoch 63, cost -228.958241069
Pre-training layer 1, epoch 64, cost -228.866671397
Pre-training layer 1, epoch 65, cost -228.682343547
Pre-training layer 1, epoch 65, representative training free energy -89661.4404141
Pre-training layer 1, epoch 65, validation free energy -88904.1921289
Pre-training layer 1, epoch 66, cost -228.667008616
Pre-training layer 1, epoch 67, cost -228.477156474
Pre-training layer 1, epoch 68, cost -228.502215932
Pre-training layer 1, epoch 69, cost -228.437062378
Pre-training layer 1, epoch 70, cost -228.246639048
Pre-training layer 1, epoch 70, representative training free energy -90283.3672305
Pre-training layer 1, epoch 70, validation free energy -89521.8049023
Pre-training layer 1, epoch 71, cost -228.207523092
Pre-training layer 1, epoch 72, cost -228.09836731
Pre-training layer 1, epoch 73, cost -228.019686635
Pre-training layer 1, epoch 74, cost -227.907603861
Pre-training layer 1, epoch 75, cost -227.798295135
Pre-training layer 1, epoch 75, representative training free energy -90873.4800937
Pre-training layer 1, epoch 75, validation free energy -90107.6298672
Pre-training layer 1, epoch 76, cost -227.797842356
Pre-training layer 1, epoch 77, cost -227.577030436
Pre-training layer 1, epoch 78, cost -227.682179921
Pre-training layer 1, epoch 79, cost -227.507419179
Pre-training layer 1, epoch 80, cost -227.438016612
Pre-training layer 1, epoch 80, representative training free energy -91389.5189492
Pre-training layer 1, epoch 80, validation free energy -90623.5598047
Pre-training layer 1, epoch 81, cost -227.489109192
Pre-training layer 1, epoch 82, cost -227.363588003
Pre-training layer 1, epoch 83, cost -227.174242096
Pre-training layer 1, epoch 84, cost -227.155079041
Pre-training layer 1, epoch 85, cost -227.144450378
Pre-training layer 1, epoch 85, representative training free energy -91906.7747969
Pre-training layer 1, epoch 85, validation free energy -91140.4872969
Pre-training layer 1, epoch 86, cost -227.066054179
Pre-training layer 1, epoch 87, cost -226.909611613
Pre-training layer 1, epoch 88, cost -226.850068614
Pre-training layer 1, epoch 89, cost -226.864907786
Pre-training layer 1, epoch 90, cost -226.718438365
Pre-training layer 1, epoch 90, representative training free energy -92286.4912617
Pre-training layer 1, epoch 90, validation free energy -91513.3042305
Pre-training layer 1, epoch 91, cost -226.731067352
Pre-training layer 1, epoch 92, cost -226.632023163
Pre-training layer 1, epoch 93, cost -226.625515798
Pre-training layer 1, epoch 94, cost -226.483079325
Pre-training layer 1, epoch 95, cost -226.528159332
Pre-training layer 1, epoch 95, representative training free energy -92877.3769883
Pre-training layer 1, epoch 95, validation free energy -92095.5416797
Pre-training layer 1, epoch 96, cost -226.406538951
Pre-training layer 1, epoch 97, cost -226.404598185
Pre-training layer 1, epoch 98, cost -226.283524424
Pre-training layer 1, epoch 99, cost -226.192174072
Pre-training layer 2, epoch 0, cost -126.01951889
Pre-training layer 2, epoch 0, representative training free energy 3043.39283435
Pre-training layer 2, epoch 0, validation free energy 3045.71124634
Pre-training layer 2, epoch 1, cost -92.0854180145
Pre-training layer 2, epoch 2, cost -84.9420100149
Pre-training layer 2, epoch 3, cost -80.9807220968
Pre-training layer 2, epoch 4, cost -78.1904338201
Pre-training layer 2, epoch 5, cost -76.2429748535
Pre-training layer 2, epoch 5, representative training free energy 4869.71452466
Pre-training layer 2, epoch 5, validation free energy 4849.20320801
Pre-training layer 2, epoch 6, cost -74.6989844259
Pre-training layer 2, epoch 7, cost -73.5096635691
Pre-training layer 2, epoch 8, cost -72.3746113332
Pre-training layer 2, epoch 9, cost -71.6388084157
Pre-training layer 2, epoch 10, cost -70.7581126277
Pre-training layer 2, epoch 10, representative training free energy 5896.79233887
Pre-training layer 2, epoch 10, validation free energy 5857.65225342
Pre-training layer 2, epoch 11, cost -70.0426760101
Pre-training layer 2, epoch 12, cost -69.5347607168
Pre-training layer 2, epoch 13, cost -69.0211669159
Pre-training layer 2, epoch 14, cost -68.572136116
Pre-training layer 2, epoch 15, cost -68.175665156
Pre-training layer 2, epoch 15, representative training free energy 6600.63947461
Pre-training layer 2, epoch 15, validation free energy 6553.35003857
Pre-training layer 2, epoch 16, cost -67.7679096731
Pre-training layer 2, epoch 17, cost -67.4358114878
Pre-training layer 2, epoch 18, cost -67.0215686925
Pre-training layer 2, epoch 19, cost -66.8072859192
Pre-training layer 2, epoch 20, cost -66.5563849004
Pre-training layer 2, epoch 20, representative training free energy 7146.59925146
Pre-training layer 2, epoch 20, validation free energy 7087.74635937
Pre-training layer 2, epoch 21, cost -66.2240644455
Pre-training layer 2, epoch 22, cost -66.0563839086
Pre-training layer 2, epoch 23, cost -65.874982605
Pre-training layer 2, epoch 24, cost -65.7507763418
Pre-training layer 2, epoch 25, cost -65.3669117483
Pre-training layer 2, epoch 25, representative training free energy 7614.8294624
Pre-training layer 2, epoch 25, validation free energy 7549.16397412
Pre-training layer 2, epoch 26, cost -65.3223152161
Pre-training layer 2, epoch 27, cost -64.9613907369
Pre-training layer 2, epoch 28, cost -64.8895567067
Pre-training layer 2, epoch 29, cost -64.816120402
Pre-training layer 2, epoch 30, cost -64.5466827265
Pre-training layer 2, epoch 30, representative training free energy 8026.26066846
Pre-training layer 2, epoch 30, validation free energy 7955.1553667
Pre-training layer 2, epoch 31, cost -64.3836156718
Pre-training layer 2, epoch 32, cost -64.4298699061
Pre-training layer 2, epoch 33, cost -64.2003967539
Pre-training layer 2, epoch 34, cost -64.122755127
Pre-training layer 2, epoch 35, cost -63.9417196019
Pre-training layer 2, epoch 35, representative training free energy 8368.62200732
Pre-training layer 2, epoch 35, validation free energy 8293.55911182
Pre-training layer 2, epoch 36, cost -63.888633728
Pre-training layer 2, epoch 37, cost -63.7943621445
Pre-training layer 2, epoch 38, cost -63.6429618073
Pre-training layer 2, epoch 39, cost -63.5851103083
Pre-training layer 2, epoch 40, cost -63.5331248856
Pre-training layer 2, epoch 40, representative training free energy 8722.69867139
Pre-training layer 2, epoch 40, validation free energy 8643.88077393
Pre-training layer 2, epoch 41, cost -63.3836862946
Pre-training layer 2, epoch 42, cost -63.2556989288
Pre-training layer 2, epoch 43, cost -63.1716127141
Pre-training layer 2, epoch 44, cost -63.1896757889
Pre-training layer 2, epoch 45, cost -63.1857813263
Pre-training layer 2, epoch 45, representative training free energy 9042.75589795
Pre-training layer 2, epoch 45, validation free energy 8960.51903564
Pre-training layer 2, epoch 46, cost -63.0129067612
Pre-training layer 2, epoch 47, cost -63.000447553
Pre-training layer 2, epoch 48, cost -62.9469227727
Pre-training layer 2, epoch 49, cost -62.887814738
Pre-training layer 2, epoch 50, cost -62.7223451742
Pre-training layer 2, epoch 50, representative training free energy 9340.87940625
Pre-training layer 2, epoch 50, validation free energy 9255.99026074
Pre-training layer 2, epoch 51, cost -62.7750015895
Pre-training layer 2, epoch 52, cost -62.6655129369
Pre-training layer 2, epoch 53, cost -62.528952802
Pre-training layer 2, epoch 54, cost -62.6336249797
Pre-training layer 2, epoch 55, cost -62.5443103917
Pre-training layer 2, epoch 55, representative training free energy 9623.1383252
Pre-training layer 2, epoch 55, validation free energy 9535.26633496
Pre-training layer 2, epoch 56, cost -62.40915109
Pre-training layer 2, epoch 57, cost -62.4225729879
Pre-training layer 2, epoch 58, cost -62.3463970184
Pre-training layer 2, epoch 59, cost -62.2591159312
Pre-training layer 2, epoch 60, cost -62.2276827749
Pre-training layer 2, epoch 60, representative training free energy 9863.02680811
Pre-training layer 2, epoch 60, validation free energy 9772.80876611
Pre-training layer 2, epoch 61, cost -62.2676197433
Pre-training layer 2, epoch 62, cost -62.2005388387
Pre-training layer 2, epoch 63, cost -62.1325799433
Pre-training layer 2, epoch 64, cost -62.0301494471
Pre-training layer 2, epoch 65, cost -62.0795613861
Pre-training layer 2, epoch 65, representative training free energy 10147.8822451
Pre-training layer 2, epoch 65, validation free energy 10054.7679067
Pre-training layer 2, epoch 66, cost -61.9571117401
Pre-training layer 2, epoch 67, cost -61.8907894262
Pre-training layer 2, epoch 68, cost -62.0087221273
Pre-training layer 2, epoch 69, cost -61.8691184743
Pre-training layer 2, epoch 70, cost -61.9198484421
Pre-training layer 2, epoch 70, representative training free energy 10377.069877
Pre-training layer 2, epoch 70, validation free energy 10281.5180605
Pre-training layer 2, epoch 71, cost -61.7990499242
Pre-training layer 2, epoch 72, cost -61.7638845444
Pre-training layer 2, epoch 73, cost -61.7486618551
Pre-training layer 2, epoch 74, cost -61.6680656306
Pre-training layer 2, epoch 75, cost -61.7362145487
Pre-training layer 2, epoch 75, representative training free energy 10619.7587139
Pre-training layer 2, epoch 75, validation free energy 10521.4808062
Pre-training layer 2, epoch 76, cost -61.7285415522
Pre-training layer 2, epoch 77, cost -61.6275787099
Pre-training layer 2, epoch 78, cost -61.6225721232
Pre-training layer 2, epoch 79, cost -61.6265236282
Pre-training layer 2, epoch 80, cost -61.4807805506
Pre-training layer 2, epoch 80, representative training free energy 10847.9973828
Pre-training layer 2, epoch 80, validation free energy 10747.5902822
Pre-training layer 2, epoch 81, cost -61.5280151113
Pre-training layer 2, epoch 82, cost -61.4753827159
Pre-training layer 2, epoch 83, cost -61.528278567
Pre-training layer 2, epoch 84, cost -61.4585538228
Pre-training layer 2, epoch 85, cost -61.3870957311
Pre-training layer 2, epoch 85, representative training free energy 11061.0093516
Pre-training layer 2, epoch 85, validation free energy 10958.6461191
Pre-training layer 2, epoch 86, cost -61.3504538981
Pre-training layer 2, epoch 87, cost -61.2902204768
Pre-training layer 2, epoch 88, cost -61.3015844854
Pre-training layer 2, epoch 89, cost -61.241822141
Pre-training layer 2, epoch 90, cost -61.1695042674
Pre-training layer 2, epoch 90, representative training free energy 11282.4145791
Pre-training layer 2, epoch 90, validation free energy 11177.9007334
Pre-training layer 2, epoch 91, cost -61.1976601028
Pre-training layer 2, epoch 92, cost -61.2342142487
Pre-training layer 2, epoch 93, cost -61.146130689
Pre-training layer 2, epoch 94, cost -61.1608228302
Pre-training layer 2, epoch 95, cost -61.1575991948
Pre-training layer 2, epoch 95, representative training free energy 11449.0176729
Pre-training layer 2, epoch 95, validation free energy 11342.5648242
Pre-training layer 2, epoch 96, cost -61.1801811473
Pre-training layer 2, epoch 97, cost -61.0178431575
Pre-training layer 2, epoch 98, cost -61.1171348953
Pre-training layer 2, epoch 99, cost -61.0654079056
The pretraining code for file dbn_loop.pyc ran for 7.85m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 35.000000 %
     epoch 1, minibatch 300/300, test error of best model 31.600000 %
epoch 2, minibatch 300/300, validation error 27.800000 %
     epoch 2, minibatch 300/300, test error of best model 22.000000 %
epoch 3, minibatch 300/300, validation error 25.800000 %
     epoch 3, minibatch 300/300, test error of best model 17.600000 %
epoch 4, minibatch 300/300, validation error 24.800000 %
     epoch 4, minibatch 300/300, test error of best model 15.600000 %
epoch 5, minibatch 300/300, validation error 23.600000 %
     epoch 5, minibatch 300/300, test error of best model 13.400000 %
epoch 6, minibatch 300/300, validation error 23.000000 %
     epoch 6, minibatch 300/300, test error of best model 12.200000 %
epoch 7, minibatch 300/300, validation error 22.000000 %
     epoch 7, minibatch 300/300, test error of best model 10.600000 %
epoch 8, minibatch 300/300, validation error 21.600000 %
     epoch 8, minibatch 300/300, test error of best model 10.000000 %
epoch 9, minibatch 300/300, validation error 21.200000 %
     epoch 9, minibatch 300/300, test error of best model 9.200000 %
epoch 10, minibatch 300/300, validation error 20.400000 %
     epoch 10, minibatch 300/300, test error of best model 8.800000 %
epoch 11, minibatch 300/300, validation error 19.800000 %
     epoch 11, minibatch 300/300, test error of best model 8.800000 %
epoch 12, minibatch 300/300, validation error 19.400000 %
     epoch 12, minibatch 300/300, test error of best model 8.600000 %
epoch 13, minibatch 300/300, validation error 19.200000 %
     epoch 13, minibatch 300/300, test error of best model 9.000000 %
epoch 14, minibatch 300/300, validation error 18.200000 %
     epoch 14, minibatch 300/300, test error of best model 8.400000 %
epoch 15, minibatch 300/300, validation error 18.200000 %
epoch 16, minibatch 300/300, validation error 17.600000 %
     epoch 16, minibatch 300/300, test error of best model 8.000000 %
epoch 17, minibatch 300/300, validation error 17.400000 %
     epoch 17, minibatch 300/300, test error of best model 7.800000 %
epoch 18, minibatch 300/300, validation error 16.800000 %
     epoch 18, minibatch 300/300, test error of best model 7.800000 %
epoch 19, minibatch 300/300, validation error 16.800000 %
epoch 20, minibatch 300/300, validation error 16.800000 %
epoch 21, minibatch 300/300, validation error 16.600000 %
     epoch 21, minibatch 300/300, test error of best model 7.200000 %
epoch 22, minibatch 300/300, validation error 16.600000 %
epoch 23, minibatch 300/300, validation error 16.600000 %
epoch 24, minibatch 300/300, validation error 16.600000 %
epoch 25, minibatch 300/300, validation error 16.600000 %
epoch 26, minibatch 300/300, validation error 16.600000 %
epoch 27, minibatch 300/300, validation error 16.800000 %
epoch 28, minibatch 300/300, validation error 16.800000 %
epoch 29, minibatch 300/300, validation error 17.200000 %
epoch 30, minibatch 300/300, validation error 17.200000 %
epoch 31, minibatch 300/300, validation error 17.200000 %
epoch 32, minibatch 300/300, validation error 17.400000 %
epoch 33, minibatch 300/300, validation error 17.400000 %
epoch 34, minibatch 300/300, validation error 17.400000 %
epoch 35, minibatch 300/300, validation error 17.400000 %
epoch 36, minibatch 300/300, validation error 17.000000 %
epoch 37, minibatch 300/300, validation error 16.600000 %
epoch 38, minibatch 300/300, validation error 16.600000 %
epoch 39, minibatch 300/300, validation error 16.600000 %
epoch 40, minibatch 300/300, validation error 16.400000 %
     epoch 40, minibatch 300/300, test error of best model 5.800000 %
epoch 41, minibatch 300/300, validation error 16.200000 %
     epoch 41, minibatch 300/300, test error of best model 5.800000 %
epoch 42, minibatch 300/300, validation error 16.200000 %
epoch 43, minibatch 300/300, validation error 16.000000 %
     epoch 43, minibatch 300/300, test error of best model 6.000000 %
epoch 44, minibatch 300/300, validation error 16.000000 %
epoch 45, minibatch 300/300, validation error 16.000000 %
epoch 46, minibatch 300/300, validation error 16.000000 %
epoch 47, minibatch 300/300, validation error 16.000000 %
epoch 48, minibatch 300/300, validation error 16.000000 %
epoch 49, minibatch 300/300, validation error 16.000000 %
epoch 50, minibatch 300/300, validation error 16.000000 %
epoch 51, minibatch 300/300, validation error 16.000000 %
epoch 52, minibatch 300/300, validation error 16.000000 %
epoch 53, minibatch 300/300, validation error 16.000000 %
epoch 54, minibatch 300/300, validation error 16.000000 %
epoch 55, minibatch 300/300, validation error 16.000000 %
epoch 56, minibatch 300/300, validation error 16.000000 %
epoch 57, minibatch 300/300, validation error 16.000000 %
epoch 58, minibatch 300/300, validation error 16.000000 %
epoch 59, minibatch 300/300, validation error 16.000000 %
epoch 60, minibatch 300/300, validation error 16.000000 %
epoch 61, minibatch 300/300, validation error 16.000000 %
epoch 62, minibatch 300/300, validation error 16.000000 %
epoch 63, minibatch 300/300, validation error 16.000000 %
epoch 64, minibatch 300/300, validation error 16.000000 %
epoch 65, minibatch 300/300, validation error 16.000000 %
epoch 66, minibatch 300/300, validation error 16.000000 %
epoch 67, minibatch 300/300, validation error 16.000000 %
epoch 68, minibatch 300/300, validation error 16.000000 %
epoch 69, minibatch 300/300, validation error 16.000000 %
epoch 70, minibatch 300/300, validation error 16.000000 %
epoch 71, minibatch 300/300, validation error 16.000000 %
epoch 72, minibatch 300/300, validation error 16.000000 %
epoch 73, minibatch 300/300, validation error 16.000000 %
epoch 74, minibatch 300/300, validation error 16.000000 %
epoch 75, minibatch 300/300, validation error 16.000000 %
epoch 76, minibatch 300/300, validation error 16.000000 %
epoch 77, minibatch 300/300, validation error 16.000000 %
epoch 78, minibatch 300/300, validation error 16.000000 %
epoch 79, minibatch 300/300, validation error 16.000000 %
epoch 80, minibatch 300/300, validation error 16.000000 %
epoch 81, minibatch 300/300, validation error 16.000000 %
epoch 82, minibatch 300/300, validation error 16.000000 %
epoch 83, minibatch 300/300, validation error 16.000000 %
epoch 84, minibatch 300/300, validation error 16.000000 %
epoch 85, minibatch 300/300, validation error 16.000000 %
Optimization complete with best validation score of 16.000000 %, obtained at iteration 12900, with test performance 6.000000 %
The fine tuning code for file dbn_loop.pyc ran for 2.11m


==========Sample: (4000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.452372932
Pre-training layer 0, epoch 0, representative training free energy -556.258743408
Pre-training layer 0, epoch 0, validation free energy -550.071069031
Pre-training layer 0, epoch 1, cost -112.047867279
Pre-training layer 0, epoch 2, cost -103.737071285
Pre-training layer 0, epoch 3, cost -99.0376523209
Pre-training layer 0, epoch 4, cost -95.8169652367
Pre-training layer 0, epoch 5, cost -93.4724378204
Pre-training layer 0, epoch 5, representative training free energy -492.952182007
Pre-training layer 0, epoch 5, validation free energy -485.431476379
Pre-training layer 0, epoch 6, cost -91.6532880592
Pre-training layer 0, epoch 7, cost -90.0233411026
Pre-training layer 0, epoch 8, cost -88.9173807907
Pre-training layer 0, epoch 9, cost -87.7611474991
Pre-training layer 0, epoch 10, cost -86.7940883732
Pre-training layer 0, epoch 10, representative training free energy -469.868501953
Pre-training layer 0, epoch 10, validation free energy -462.214275696
Pre-training layer 0, epoch 11, cost -86.143733387
Pre-training layer 0, epoch 12, cost -85.4266680717
Pre-training layer 0, epoch 13, cost -84.7332931805
Pre-training layer 0, epoch 14, cost -84.1728612328
Pre-training layer 0, epoch 15, cost -83.6019553471
Pre-training layer 0, epoch 15, representative training free energy -458.970287537
Pre-training layer 0, epoch 15, validation free energy -450.610818848
Pre-training layer 0, epoch 16, cost -83.1457579803
Pre-training layer 0, epoch 17, cost -82.8118518448
Pre-training layer 0, epoch 18, cost -82.3630558777
Pre-training layer 0, epoch 19, cost -81.9095903301
Pre-training layer 0, epoch 20, cost -81.553597784
Pre-training layer 0, epoch 20, representative training free energy -451.709797058
Pre-training layer 0, epoch 20, validation free energy -443.13297229
Pre-training layer 0, epoch 21, cost -81.2983782196
Pre-training layer 0, epoch 22, cost -80.86836833
Pre-training layer 0, epoch 23, cost -80.7346393776
Pre-training layer 0, epoch 24, cost -80.3643176365
Pre-training layer 0, epoch 25, cost -80.1606955624
Pre-training layer 0, epoch 25, representative training free energy -444.53640155
Pre-training layer 0, epoch 25, validation free energy -435.572349487
Pre-training layer 0, epoch 26, cost -79.8155415821
Pre-training layer 0, epoch 27, cost -79.6971529198
Pre-training layer 0, epoch 28, cost -79.4235160637
Pre-training layer 0, epoch 29, cost -79.1790440845
Pre-training layer 0, epoch 30, cost -79.0332683659
Pre-training layer 0, epoch 30, representative training free energy -442.953358337
Pre-training layer 0, epoch 30, validation free energy -433.741039734
Pre-training layer 0, epoch 31, cost -78.7470515442
Pre-training layer 0, epoch 32, cost -78.6869595718
Pre-training layer 0, epoch 33, cost -78.4477445984
Pre-training layer 0, epoch 34, cost -78.1896508217
Pre-training layer 0, epoch 35, cost -78.0524625587
Pre-training layer 0, epoch 35, representative training free energy -436.083962952
Pre-training layer 0, epoch 35, validation free energy -427.144436829
Pre-training layer 0, epoch 36, cost -77.9713337708
Pre-training layer 0, epoch 37, cost -77.8105991745
Pre-training layer 0, epoch 38, cost -77.7078614998
Pre-training layer 0, epoch 39, cost -77.4737577724
Pre-training layer 0, epoch 40, cost -77.352894268
Pre-training layer 0, epoch 40, representative training free energy -436.240970337
Pre-training layer 0, epoch 40, validation free energy -427.129748291
Pre-training layer 0, epoch 41, cost -77.2720953941
Pre-training layer 0, epoch 42, cost -77.1035936069
Pre-training layer 0, epoch 43, cost -76.9752473354
Pre-training layer 0, epoch 44, cost -76.8872528648
Pre-training layer 0, epoch 45, cost -76.6814104652
Pre-training layer 0, epoch 45, representative training free energy -433.626101868
Pre-training layer 0, epoch 45, validation free energy -424.000051208
Pre-training layer 0, epoch 46, cost -76.5557155609
Pre-training layer 0, epoch 47, cost -76.5544218063
Pre-training layer 0, epoch 48, cost -76.3968847656
Pre-training layer 0, epoch 49, cost -76.3387900162
Pre-training layer 0, epoch 50, cost -76.189899044
Pre-training layer 0, epoch 50, representative training free energy -430.771022644
Pre-training layer 0, epoch 50, validation free energy -420.948112793
Pre-training layer 0, epoch 51, cost -75.9968836117
Pre-training layer 0, epoch 52, cost -75.8720897579
Pre-training layer 0, epoch 53, cost -75.8897162342
Pre-training layer 0, epoch 54, cost -75.8353779221
Pre-training layer 0, epoch 55, cost -75.748638649
Pre-training layer 0, epoch 55, representative training free energy -427.210614868
Pre-training layer 0, epoch 55, validation free energy -417.297250488
Pre-training layer 0, epoch 56, cost -75.5283529663
Pre-training layer 0, epoch 57, cost -75.437547493
Pre-training layer 0, epoch 58, cost -75.3551097012
Pre-training layer 0, epoch 59, cost -75.4043985653
Pre-training layer 0, epoch 60, cost -75.1557393074
Pre-training layer 0, epoch 60, representative training free energy -429.233815857
Pre-training layer 0, epoch 60, validation free energy -419.384134888
Pre-training layer 0, epoch 61, cost -75.2726100826
Pre-training layer 0, epoch 62, cost -75.143605423
Pre-training layer 0, epoch 63, cost -74.948533783
Pre-training layer 0, epoch 64, cost -75.0087180519
Pre-training layer 0, epoch 65, cost -74.8585116577
Pre-training layer 0, epoch 65, representative training free energy -427.835147644
Pre-training layer 0, epoch 65, validation free energy -417.612521729
Pre-training layer 0, epoch 66, cost -74.7767019081
Pre-training layer 0, epoch 67, cost -74.6876991367
Pre-training layer 0, epoch 68, cost -74.7487203884
Pre-training layer 0, epoch 69, cost -74.5741962147
Pre-training layer 0, epoch 70, cost -74.5798022747
Pre-training layer 0, epoch 70, representative training free energy -424.659266968
Pre-training layer 0, epoch 70, validation free energy -414.135698242
Pre-training layer 0, epoch 71, cost -74.4359599495
Pre-training layer 0, epoch 72, cost -74.405418005
Pre-training layer 0, epoch 73, cost -74.3510149384
Pre-training layer 0, epoch 74, cost -74.2529742813
Pre-training layer 0, epoch 75, cost -74.0605423832
Pre-training layer 0, epoch 75, representative training free energy -423.15284436
Pre-training layer 0, epoch 75, validation free energy -412.329307495
Pre-training layer 0, epoch 76, cost -74.1789387512
Pre-training layer 0, epoch 77, cost -74.0008527565
Pre-training layer 0, epoch 78, cost -74.0002346325
Pre-training layer 0, epoch 79, cost -73.9261849213
Pre-training layer 0, epoch 80, cost -73.8073893929
Pre-training layer 0, epoch 80, representative training free energy -425.374161804
Pre-training layer 0, epoch 80, validation free energy -414.650177917
Pre-training layer 0, epoch 81, cost -73.7236219978
Pre-training layer 0, epoch 82, cost -73.8255548573
Pre-training layer 0, epoch 83, cost -73.7478686142
Pre-training layer 0, epoch 84, cost -73.6921965504
Pre-training layer 0, epoch 85, cost -73.5416824913
Pre-training layer 0, epoch 85, representative training free energy -422.149503235
Pre-training layer 0, epoch 85, validation free energy -411.53303833
Pre-training layer 0, epoch 86, cost -73.6916681004
Pre-training layer 0, epoch 87, cost -73.3931269169
Pre-training layer 0, epoch 88, cost -73.4575974846
Pre-training layer 0, epoch 89, cost -73.3945021915
Pre-training layer 0, epoch 90, cost -73.3060468864
Pre-training layer 0, epoch 90, representative training free energy -422.553205139
Pre-training layer 0, epoch 90, validation free energy -411.359946106
Pre-training layer 0, epoch 91, cost -73.278966341
Pre-training layer 0, epoch 92, cost -73.3177808952
Pre-training layer 0, epoch 93, cost -73.2043958187
Pre-training layer 0, epoch 94, cost -73.1567412758
Pre-training layer 0, epoch 95, cost -73.078077507
Pre-training layer 0, epoch 95, representative training free energy -423.750971619
Pre-training layer 0, epoch 95, validation free energy -411.877622925
Pre-training layer 0, epoch 96, cost -73.2614611053
Pre-training layer 0, epoch 97, cost -72.9621832371
Pre-training layer 0, epoch 98, cost -72.9369432068
Pre-training layer 0, epoch 99, cost -72.8981133175
Pre-training layer 1, epoch 0, cost -323.117181854
Pre-training layer 1, epoch 0, representative training free energy -57308.0721016
Pre-training layer 1, epoch 0, validation free energy -56801.5252422
Pre-training layer 1, epoch 1, cost -277.484454002
Pre-training layer 1, epoch 2, cost -263.761513824
Pre-training layer 1, epoch 3, cost -255.51038868
Pre-training layer 1, epoch 4, cost -249.861116333
Pre-training layer 1, epoch 5, cost -245.787020073
Pre-training layer 1, epoch 5, representative training free energy -76812.2883086
Pre-training layer 1, epoch 5, validation free energy -76152.6901602
Pre-training layer 1, epoch 6, cost -242.539025269
Pre-training layer 1, epoch 7, cost -239.930609894
Pre-training layer 1, epoch 8, cost -237.83420784
Pre-training layer 1, epoch 9, cost -236.010299339
Pre-training layer 1, epoch 10, cost -234.616299973
Pre-training layer 1, epoch 10, representative training free energy -82861.5793086
Pre-training layer 1, epoch 10, validation free energy -82157.4072891
Pre-training layer 1, epoch 11, cost -233.23497261
Pre-training layer 1, epoch 12, cost -232.036175079
Pre-training layer 1, epoch 13, cost -231.012931404
Pre-training layer 1, epoch 14, cost -230.309870644
Pre-training layer 1, epoch 15, cost -229.356333504
Pre-training layer 1, epoch 15, representative training free energy -86248.0597305
Pre-training layer 1, epoch 15, validation free energy -85526.2696719
Pre-training layer 1, epoch 16, cost -228.610219841
Pre-training layer 1, epoch 17, cost -227.995485611
Pre-training layer 1, epoch 18, cost -227.400115318
Pre-training layer 1, epoch 19, cost -226.824458923
Pre-training layer 1, epoch 20, cost -226.311829071
Pre-training layer 1, epoch 20, representative training free energy -88830.5333867
Pre-training layer 1, epoch 20, validation free energy -88072.6495234
Pre-training layer 1, epoch 21, cost -225.826796417
Pre-training layer 1, epoch 22, cost -225.350468864
Pre-training layer 1, epoch 23, cost -224.972345314
Pre-training layer 1, epoch 24, cost -224.518140488
Pre-training layer 1, epoch 25, cost -224.075335655
Pre-training layer 1, epoch 25, representative training free energy -90769.9865195
Pre-training layer 1, epoch 25, validation free energy -90002.6391484
Pre-training layer 1, epoch 26, cost -223.829905357
Pre-training layer 1, epoch 27, cost -223.486501884
Pre-training layer 1, epoch 28, cost -223.24422123
Pre-training layer 1, epoch 29, cost -222.758753929
Pre-training layer 1, epoch 30, cost -222.61532856
Pre-training layer 1, epoch 30, representative training free energy -92473.7881211
Pre-training layer 1, epoch 30, validation free energy -91685.8731289
Pre-training layer 1, epoch 31, cost -222.266365738
Pre-training layer 1, epoch 32, cost -222.012652855
Pre-training layer 1, epoch 33, cost -221.898383141
Pre-training layer 1, epoch 34, cost -221.639663086
Pre-training layer 1, epoch 35, cost -221.457840652
Pre-training layer 1, epoch 35, representative training free energy -93750.5386133
Pre-training layer 1, epoch 35, validation free energy -92963.6958125
Pre-training layer 1, epoch 36, cost -221.223426476
Pre-training layer 1, epoch 37, cost -220.933390884
Pre-training layer 1, epoch 38, cost -220.760962639
Pre-training layer 1, epoch 39, cost -220.616964035
Pre-training layer 1, epoch 40, cost -220.380393562
Pre-training layer 1, epoch 40, representative training free energy -94988.3529219
Pre-training layer 1, epoch 40, validation free energy -94178.5092305
Pre-training layer 1, epoch 41, cost -220.245070724
Pre-training layer 1, epoch 42, cost -220.019730263
Pre-training layer 1, epoch 43, cost -219.8789674
Pre-training layer 1, epoch 44, cost -219.618654404
Pre-training layer 1, epoch 45, cost -219.640008774
Pre-training layer 1, epoch 45, representative training free energy -96066.0822695
Pre-training layer 1, epoch 45, validation free energy -95253.0155078
Pre-training layer 1, epoch 46, cost -219.520039291
Pre-training layer 1, epoch 47, cost -219.24548748
Pre-training layer 1, epoch 48, cost -219.197061577
Pre-training layer 1, epoch 49, cost -218.937560387
Pre-training layer 1, epoch 50, cost -218.766791496
Pre-training layer 1, epoch 50, representative training free energy -96974.1553828
Pre-training layer 1, epoch 50, validation free energy -96151.3231914
Pre-training layer 1, epoch 51, cost -218.795025024
Pre-training layer 1, epoch 52, cost -218.605115776
Pre-training layer 1, epoch 53, cost -218.507573891
Pre-training layer 1, epoch 54, cost -218.358838997
Pre-training layer 1, epoch 55, cost -218.283158417
Pre-training layer 1, epoch 55, representative training free energy -97905.5941484
Pre-training layer 1, epoch 55, validation free energy -97069.5791484
Pre-training layer 1, epoch 56, cost -218.14469265
Pre-training layer 1, epoch 57, cost -217.9950457
Pre-training layer 1, epoch 58, cost -217.932175751
Pre-training layer 1, epoch 59, cost -217.865513649
Pre-training layer 1, epoch 60, cost -217.714900284
Pre-training layer 1, epoch 60, representative training free energy -98604.5030547
Pre-training layer 1, epoch 60, validation free energy -97771.8113359
Pre-training layer 1, epoch 61, cost -217.570343857
Pre-training layer 1, epoch 62, cost -217.448153152
Pre-training layer 1, epoch 63, cost -217.421083755
Pre-training layer 1, epoch 64, cost -217.390339241
Pre-training layer 1, epoch 65, cost -217.295042305
Pre-training layer 1, epoch 65, representative training free energy -99382.0897656
Pre-training layer 1, epoch 65, validation free energy -98538.2063867
Pre-training layer 1, epoch 66, cost -217.153412819
Pre-training layer 1, epoch 67, cost -217.05378582
Pre-training layer 1, epoch 68, cost -217.061554146
Pre-training layer 1, epoch 69, cost -216.931296043
Pre-training layer 1, epoch 70, cost -216.873856201
Pre-training layer 1, epoch 70, representative training free energy -100040.547828
Pre-training layer 1, epoch 70, validation free energy -99198.235668
Pre-training layer 1, epoch 71, cost -216.726105804
Pre-training layer 1, epoch 72, cost -216.663883209
Pre-training layer 1, epoch 73, cost -216.613349609
Pre-training layer 1, epoch 74, cost -216.500151443
Pre-training layer 1, epoch 75, cost -216.417097702
Pre-training layer 1, epoch 75, representative training free energy -100717.29818
Pre-training layer 1, epoch 75, validation free energy -99861.7491875
Pre-training layer 1, epoch 76, cost -216.316805153
Pre-training layer 1, epoch 77, cost -216.301893692
Pre-training layer 1, epoch 78, cost -216.250994453
Pre-training layer 1, epoch 79, cost -216.160134277
Pre-training layer 1, epoch 80, cost -215.976717911
Pre-training layer 1, epoch 80, representative training free energy -101460.08293
Pre-training layer 1, epoch 80, validation free energy -100599.108461
Pre-training layer 1, epoch 81, cost -216.038036575
Pre-training layer 1, epoch 82, cost -215.923190727
Pre-training layer 1, epoch 83, cost -215.918029213
Pre-training layer 1, epoch 84, cost -215.847498817
Pre-training layer 1, epoch 85, cost -215.909956551
Pre-training layer 1, epoch 85, representative training free energy -101924.668672
Pre-training layer 1, epoch 85, validation free energy -101053.24557
Pre-training layer 1, epoch 86, cost -215.71343689
Pre-training layer 1, epoch 87, cost -215.637564659
Pre-training layer 1, epoch 88, cost -215.656967392
Pre-training layer 1, epoch 89, cost -215.56285759
Pre-training layer 1, epoch 90, cost -215.505393982
Pre-training layer 1, epoch 90, representative training free energy -102494.670664
Pre-training layer 1, epoch 90, validation free energy -101621.262414
Pre-training layer 1, epoch 91, cost -215.440053444
Pre-training layer 1, epoch 92, cost -215.329954605
Pre-training layer 1, epoch 93, cost -215.318236961
Pre-training layer 1, epoch 94, cost -215.222028465
Pre-training layer 1, epoch 95, cost -215.190698814
Pre-training layer 1, epoch 95, representative training free energy -103021.910172
Pre-training layer 1, epoch 95, validation free energy -102149.210516
Pre-training layer 1, epoch 96, cost -215.195036964
Pre-training layer 1, epoch 97, cost -215.142422905
Pre-training layer 1, epoch 98, cost -215.064925194
Pre-training layer 1, epoch 99, cost -215.025585861
Pre-training layer 2, epoch 0, cost -120.521793251
Pre-training layer 2, epoch 0, representative training free energy 3912.96210376
Pre-training layer 2, epoch 0, validation free energy 3871.86953687
Pre-training layer 2, epoch 1, cost -89.9361513805
Pre-training layer 2, epoch 2, cost -83.3372051716
Pre-training layer 2, epoch 3, cost -79.5699468994
Pre-training layer 2, epoch 4, cost -77.1727940083
Pre-training layer 2, epoch 5, cost -75.403134594
Pre-training layer 2, epoch 5, representative training free energy 6079.62883447
Pre-training layer 2, epoch 5, validation free energy 6025.95850244
Pre-training layer 2, epoch 6, cost -73.9286231899
Pre-training layer 2, epoch 7, cost -72.7622082806
Pre-training layer 2, epoch 8, cost -71.8549242496
Pre-training layer 2, epoch 9, cost -71.0613166142
Pre-training layer 2, epoch 10, cost -70.4836690998
Pre-training layer 2, epoch 10, representative training free energy 7187.59946484
Pre-training layer 2, epoch 10, validation free energy 7123.85311523
Pre-training layer 2, epoch 11, cost -69.797604084
Pre-training layer 2, epoch 12, cost -69.2971905518
Pre-training layer 2, epoch 13, cost -68.8030413246
Pre-training layer 2, epoch 14, cost -68.4847534943
Pre-training layer 2, epoch 15, cost -68.1038674545
Pre-training layer 2, epoch 15, representative training free energy 8044.73425146
Pre-training layer 2, epoch 15, validation free energy 7974.06101318
Pre-training layer 2, epoch 16, cost -67.6831396961
Pre-training layer 2, epoch 17, cost -67.5136581993
Pre-training layer 2, epoch 18, cost -67.1125630093
Pre-training layer 2, epoch 19, cost -66.9317297935
Pre-training layer 2, epoch 20, cost -66.6330661297
Pre-training layer 2, epoch 20, representative training free energy 8693.99260059
Pre-training layer 2, epoch 20, validation free energy 8616.316479
Pre-training layer 2, epoch 21, cost -66.3539936829
Pre-training layer 2, epoch 22, cost -66.2153699684
Pre-training layer 2, epoch 23, cost -66.0399121475
Pre-training layer 2, epoch 24, cost -65.819156208
Pre-training layer 2, epoch 25, cost -65.7046147823
Pre-training layer 2, epoch 25, representative training free energy 9235.97297656
Pre-training layer 2, epoch 25, validation free energy 9153.66064502
Pre-training layer 2, epoch 26, cost -65.5057143784
Pre-training layer 2, epoch 27, cost -65.4099575615
Pre-training layer 2, epoch 28, cost -65.2149688721
Pre-training layer 2, epoch 29, cost -65.1459818745
Pre-training layer 2, epoch 30, cost -65.0657325363
Pre-training layer 2, epoch 30, representative training free energy 9724.64809375
Pre-training layer 2, epoch 30, validation free energy 9637.93120654
Pre-training layer 2, epoch 31, cost -64.9316482735
Pre-training layer 2, epoch 32, cost -64.7536900711
Pre-training layer 2, epoch 33, cost -64.695649538
Pre-training layer 2, epoch 34, cost -64.6337842846
Pre-training layer 2, epoch 35, cost -64.4588748741
Pre-training layer 2, epoch 35, representative training free energy 10161.9387266
Pre-training layer 2, epoch 35, validation free energy 10070.4839136
Pre-training layer 2, epoch 36, cost -64.453433485
Pre-training layer 2, epoch 37, cost -64.3277221107
Pre-training layer 2, epoch 38, cost -64.2580855274
Pre-training layer 2, epoch 39, cost -64.187584877
Pre-training layer 2, epoch 40, cost -64.1121374035
Pre-training layer 2, epoch 40, representative training free energy 10560.5349971
Pre-training layer 2, epoch 40, validation free energy 10465.0482754
Pre-training layer 2, epoch 41, cost -63.9910781097
Pre-training layer 2, epoch 42, cost -63.8845714569
Pre-training layer 2, epoch 43, cost -63.8416369343
Pre-training layer 2, epoch 44, cost -63.7791951466
Pre-training layer 2, epoch 45, cost -63.7387430096
Pre-training layer 2, epoch 45, representative training free energy 10920.6200586
Pre-training layer 2, epoch 45, validation free energy 10822.1557422
Pre-training layer 2, epoch 46, cost -63.5889800549
Pre-training layer 2, epoch 47, cost -63.5324267673
Pre-training layer 2, epoch 48, cost -63.4544808865
Pre-training layer 2, epoch 49, cost -63.4248223209
Pre-training layer 2, epoch 50, cost -63.4329392433
Pre-training layer 2, epoch 50, representative training free energy 11261.0913569
Pre-training layer 2, epoch 50, validation free energy 11158.6539214
Pre-training layer 2, epoch 51, cost -63.3533695412
Pre-training layer 2, epoch 52, cost -63.3167479134
Pre-training layer 2, epoch 53, cost -63.3231743336
Pre-training layer 2, epoch 54, cost -63.2225064754
Pre-training layer 2, epoch 55, cost -63.2420518589
Pre-training layer 2, epoch 55, representative training free energy 11619.6410615
Pre-training layer 2, epoch 55, validation free energy 11512.9173081
Pre-training layer 2, epoch 56, cost -63.1626914692
Pre-training layer 2, epoch 57, cost -63.1155822659
Pre-training layer 2, epoch 58, cost -62.970628643
Pre-training layer 2, epoch 59, cost -62.9717908001
Pre-training layer 2, epoch 60, cost -62.9760299492
Pre-training layer 2, epoch 60, representative training free energy 11916.5800244
Pre-training layer 2, epoch 60, validation free energy 11807.2089473
Pre-training layer 2, epoch 61, cost -62.85158144
Pre-training layer 2, epoch 62, cost -62.9500039959
Pre-training layer 2, epoch 63, cost -62.9015682602
Pre-training layer 2, epoch 64, cost -62.8197876167
Pre-training layer 2, epoch 65, cost -62.8053923702
Pre-training layer 2, epoch 65, representative training free energy 12238.1497949
Pre-training layer 2, epoch 65, validation free energy 12126.1830186
Pre-training layer 2, epoch 66, cost -62.7015860176
Pre-training layer 2, epoch 67, cost -62.722333889
Pre-training layer 2, epoch 68, cost -62.6582806015
Pre-training layer 2, epoch 69, cost -62.7073701954
Pre-training layer 2, epoch 70, cost -62.6714044857
Pre-training layer 2, epoch 70, representative training free energy 12520.9815234
Pre-training layer 2, epoch 70, validation free energy 12406.1143682
Pre-training layer 2, epoch 71, cost -62.5929420376
Pre-training layer 2, epoch 72, cost -62.5576886654
Pre-training layer 2, epoch 73, cost -62.4580508709
Pre-training layer 2, epoch 74, cost -62.5145178699
Pre-training layer 2, epoch 75, cost -62.4367002964
Pre-training layer 2, epoch 75, representative training free energy 12830.6390566
Pre-training layer 2, epoch 75, validation free energy 12712.8808789
Pre-training layer 2, epoch 76, cost -62.4958119965
Pre-training layer 2, epoch 77, cost -62.4167837906
Pre-training layer 2, epoch 78, cost -62.3581381226
Pre-training layer 2, epoch 79, cost -62.3898254108
Pre-training layer 2, epoch 80, cost -62.2708327103
Pre-training layer 2, epoch 80, representative training free energy 13085.1388633
Pre-training layer 2, epoch 80, validation free energy 12963.6527813
Pre-training layer 2, epoch 81, cost -62.2757114887
Pre-training layer 2, epoch 82, cost -62.2767872047
Pre-training layer 2, epoch 83, cost -62.2141434765
Pre-training layer 2, epoch 84, cost -62.2741247177
Pre-training layer 2, epoch 85, cost -62.1750648022
Pre-training layer 2, epoch 85, representative training free energy 13385.0414619
Pre-training layer 2, epoch 85, validation free energy 13261.8952275
Pre-training layer 2, epoch 86, cost -62.1572147274
Pre-training layer 2, epoch 87, cost -62.1399849319
Pre-training layer 2, epoch 88, cost -62.1488648605
Pre-training layer 2, epoch 89, cost -62.0735781097
Pre-training layer 2, epoch 90, cost -62.1034644604
Pre-training layer 2, epoch 90, representative training free energy 13636.4618701
Pre-training layer 2, epoch 90, validation free energy 13510.379334
Pre-training layer 2, epoch 91, cost -62.0133801365
Pre-training layer 2, epoch 92, cost -62.0055125904
Pre-training layer 2, epoch 93, cost -61.9910647011
Pre-training layer 2, epoch 94, cost -61.9961218739
Pre-training layer 2, epoch 95, cost -61.9457029343
Pre-training layer 2, epoch 95, representative training free energy 13896.4553047
Pre-training layer 2, epoch 95, validation free energy 13767.8605029
Pre-training layer 2, epoch 96, cost -61.9782215595
Pre-training layer 2, epoch 97, cost -61.8662588692
Pre-training layer 2, epoch 98, cost -61.8934811783
Pre-training layer 2, epoch 99, cost -61.8127470303
The pretraining code for file dbn_loop.pyc ran for 10.38m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 34.600000 %
     epoch 1, minibatch 400/400, test error of best model 28.200000 %
epoch 2, minibatch 400/400, validation error 25.400000 %
     epoch 2, minibatch 400/400, test error of best model 16.400000 %
epoch 3, minibatch 400/400, validation error 22.600000 %
     epoch 3, minibatch 400/400, test error of best model 13.400000 %
epoch 4, minibatch 400/400, validation error 21.400000 %
     epoch 4, minibatch 400/400, test error of best model 11.400000 %
epoch 5, minibatch 400/400, validation error 20.800000 %
     epoch 5, minibatch 400/400, test error of best model 9.800000 %
epoch 6, minibatch 400/400, validation error 20.000000 %
     epoch 6, minibatch 400/400, test error of best model 8.800000 %
epoch 7, minibatch 400/400, validation error 19.200000 %
     epoch 7, minibatch 400/400, test error of best model 8.200000 %
epoch 8, minibatch 400/400, validation error 18.800000 %
     epoch 8, minibatch 400/400, test error of best model 7.400000 %
epoch 9, minibatch 400/400, validation error 18.400000 %
     epoch 9, minibatch 400/400, test error of best model 6.800000 %
epoch 10, minibatch 400/400, validation error 17.600000 %
     epoch 10, minibatch 400/400, test error of best model 6.400000 %
epoch 11, minibatch 400/400, validation error 17.400000 %
     epoch 11, minibatch 400/400, test error of best model 5.400000 %
epoch 12, minibatch 400/400, validation error 17.400000 %
epoch 13, minibatch 400/400, validation error 16.800000 %
     epoch 13, minibatch 400/400, test error of best model 5.400000 %
epoch 14, minibatch 400/400, validation error 16.600000 %
     epoch 14, minibatch 400/400, test error of best model 5.600000 %
epoch 15, minibatch 400/400, validation error 16.600000 %
epoch 16, minibatch 400/400, validation error 16.600000 %
epoch 17, minibatch 400/400, validation error 16.400000 %
     epoch 17, minibatch 400/400, test error of best model 5.800000 %
epoch 18, minibatch 400/400, validation error 16.400000 %
epoch 19, minibatch 400/400, validation error 16.400000 %
epoch 20, minibatch 400/400, validation error 16.400000 %
epoch 21, minibatch 400/400, validation error 16.400000 %
epoch 22, minibatch 400/400, validation error 16.400000 %
epoch 23, minibatch 400/400, validation error 16.400000 %
epoch 24, minibatch 400/400, validation error 16.200000 %
     epoch 24, minibatch 400/400, test error of best model 6.400000 %
epoch 25, minibatch 400/400, validation error 16.000000 %
     epoch 25, minibatch 400/400, test error of best model 6.200000 %
epoch 26, minibatch 400/400, validation error 16.000000 %
epoch 27, minibatch 400/400, validation error 16.000000 %
epoch 28, minibatch 400/400, validation error 15.800000 %
     epoch 28, minibatch 400/400, test error of best model 6.200000 %
epoch 29, minibatch 400/400, validation error 15.600000 %
     epoch 29, minibatch 400/400, test error of best model 5.800000 %
epoch 30, minibatch 400/400, validation error 15.600000 %
epoch 31, minibatch 400/400, validation error 15.600000 %
epoch 32, minibatch 400/400, validation error 15.600000 %
epoch 33, minibatch 400/400, validation error 15.600000 %
epoch 34, minibatch 400/400, validation error 15.600000 %
epoch 35, minibatch 400/400, validation error 15.400000 %
     epoch 35, minibatch 400/400, test error of best model 5.400000 %
epoch 36, minibatch 400/400, validation error 15.400000 %
epoch 37, minibatch 400/400, validation error 15.400000 %
epoch 38, minibatch 400/400, validation error 15.200000 %
     epoch 38, minibatch 400/400, test error of best model 5.400000 %
epoch 39, minibatch 400/400, validation error 15.200000 %
epoch 40, minibatch 400/400, validation error 15.200000 %
epoch 41, minibatch 400/400, validation error 15.400000 %
epoch 42, minibatch 400/400, validation error 15.600000 %
epoch 43, minibatch 400/400, validation error 15.600000 %
epoch 44, minibatch 400/400, validation error 15.600000 %
epoch 45, minibatch 400/400, validation error 15.600000 %
epoch 46, minibatch 400/400, validation error 15.600000 %
epoch 47, minibatch 400/400, validation error 15.600000 %
epoch 48, minibatch 400/400, validation error 15.600000 %
epoch 49, minibatch 400/400, validation error 15.400000 %
epoch 50, minibatch 400/400, validation error 15.400000 %
epoch 51, minibatch 400/400, validation error 15.400000 %
epoch 52, minibatch 400/400, validation error 15.400000 %
epoch 53, minibatch 400/400, validation error 15.400000 %
epoch 54, minibatch 400/400, validation error 15.400000 %
epoch 55, minibatch 400/400, validation error 15.600000 %
epoch 56, minibatch 400/400, validation error 15.600000 %
epoch 57, minibatch 400/400, validation error 15.600000 %
epoch 58, minibatch 400/400, validation error 15.600000 %
epoch 59, minibatch 400/400, validation error 15.600000 %
epoch 60, minibatch 400/400, validation error 15.600000 %
epoch 61, minibatch 400/400, validation error 15.600000 %
epoch 62, minibatch 400/400, validation error 15.600000 %
epoch 63, minibatch 400/400, validation error 15.600000 %
epoch 64, minibatch 400/400, validation error 15.600000 %
epoch 65, minibatch 400/400, validation error 15.600000 %
epoch 66, minibatch 400/400, validation error 15.600000 %
epoch 67, minibatch 400/400, validation error 15.600000 %
epoch 68, minibatch 400/400, validation error 15.600000 %
epoch 69, minibatch 400/400, validation error 15.600000 %
epoch 70, minibatch 400/400, validation error 15.600000 %
epoch 71, minibatch 400/400, validation error 15.600000 %
epoch 72, minibatch 400/400, validation error 15.600000 %
epoch 73, minibatch 400/400, validation error 15.600000 %
epoch 74, minibatch 400/400, validation error 15.600000 %
epoch 75, minibatch 400/400, validation error 15.600000 %
Optimization complete with best validation score of 15.200000 %, obtained at iteration 15200, with test performance 5.400000 %
The fine tuning code for file dbn_loop.pyc ran for 2.42m


==========Sample: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.253437393
Pre-training layer 0, epoch 0, representative training free energy -547.426231934
Pre-training layer 0, epoch 0, validation free energy -541.559780334
Pre-training layer 0, epoch 1, cost -108.599064774
Pre-training layer 0, epoch 2, cost -100.983639847
Pre-training layer 0, epoch 3, cost -96.521615097
Pre-training layer 0, epoch 4, cost -93.5446756287
Pre-training layer 0, epoch 5, cost -91.2705892334
Pre-training layer 0, epoch 5, representative training free energy -486.83620105
Pre-training layer 0, epoch 5, validation free energy -479.115521667
Pre-training layer 0, epoch 6, cost -89.6153940582
Pre-training layer 0, epoch 7, cost -88.274403183
Pre-training layer 0, epoch 8, cost -87.0383389359
Pre-training layer 0, epoch 9, cost -86.0220532227
Pre-training layer 0, epoch 10, cost -85.3481836014
Pre-training layer 0, epoch 10, representative training free energy -467.670804871
Pre-training layer 0, epoch 10, validation free energy -459.686241394
Pre-training layer 0, epoch 11, cost -84.6357130432
Pre-training layer 0, epoch 12, cost -83.8710201187
Pre-training layer 0, epoch 13, cost -83.3821106415
Pre-training layer 0, epoch 14, cost -82.7750591965
Pre-training layer 0, epoch 15, cost -82.3295386429
Pre-training layer 0, epoch 15, representative training free energy -458.266140503
Pre-training layer 0, epoch 15, validation free energy -450.229675415
Pre-training layer 0, epoch 16, cost -81.9740046158
Pre-training layer 0, epoch 17, cost -81.4982338486
Pre-training layer 0, epoch 18, cost -81.2512664261
Pre-training layer 0, epoch 19, cost -80.863567543
Pre-training layer 0, epoch 20, cost -80.6029128494
Pre-training layer 0, epoch 20, representative training free energy -448.655545227
Pre-training layer 0, epoch 20, validation free energy -440.231035034
Pre-training layer 0, epoch 21, cost -80.366753212
Pre-training layer 0, epoch 22, cost -79.9877812119
Pre-training layer 0, epoch 23, cost -79.6120693207
Pre-training layer 0, epoch 24, cost -79.5115633316
Pre-training layer 0, epoch 25, cost -79.2145578384
Pre-training layer 0, epoch 25, representative training free energy -442.619603027
Pre-training layer 0, epoch 25, validation free energy -434.298632324
Pre-training layer 0, epoch 26, cost -79.0260352936
Pre-training layer 0, epoch 27, cost -78.7317961884
Pre-training layer 0, epoch 28, cost -78.513267395
Pre-training layer 0, epoch 29, cost -78.2583149796
Pre-training layer 0, epoch 30, cost -78.2469384155
Pre-training layer 0, epoch 30, representative training free energy -442.86560083
Pre-training layer 0, epoch 30, validation free energy -434.081036865
Pre-training layer 0, epoch 31, cost -78.0184024887
Pre-training layer 0, epoch 32, cost -77.7824922333
Pre-training layer 0, epoch 33, cost -77.6007024994
Pre-training layer 0, epoch 34, cost -77.5569315643
Pre-training layer 0, epoch 35, cost -77.3773618088
Pre-training layer 0, epoch 35, representative training free energy -438.006007202
Pre-training layer 0, epoch 35, validation free energy -429.30781488
Pre-training layer 0, epoch 36, cost -77.2724219971
Pre-training layer 0, epoch 37, cost -77.037456604
Pre-training layer 0, epoch 38, cost -76.9558684387
Pre-training layer 0, epoch 39, cost -76.743470787
Pre-training layer 0, epoch 40, cost -76.7598195267
Pre-training layer 0, epoch 40, representative training free energy -438.109188293
Pre-training layer 0, epoch 40, validation free energy -429.002631409
Pre-training layer 0, epoch 41, cost -76.5483917923
Pre-training layer 0, epoch 42, cost -76.4172590256
Pre-training layer 0, epoch 43, cost -76.3340007935
Pre-training layer 0, epoch 44, cost -76.2162680206
Pre-training layer 0, epoch 45, cost -76.1560931778
Pre-training layer 0, epoch 45, representative training free energy -435.78890918
Pre-training layer 0, epoch 45, validation free energy -426.499797424
Pre-training layer 0, epoch 46, cost -75.9835879669
Pre-training layer 0, epoch 47, cost -76.0173893585
Pre-training layer 0, epoch 48, cost -75.912414566
Pre-training layer 0, epoch 49, cost -75.6634222565
Pre-training layer 0, epoch 50, cost -75.5625790253
Pre-training layer 0, epoch 50, representative training free energy -432.752532654
Pre-training layer 0, epoch 50, validation free energy -423.673273132
Pre-training layer 0, epoch 51, cost -75.6259230042
Pre-training layer 0, epoch 52, cost -75.4251478958
Pre-training layer 0, epoch 53, cost -75.3991688614
Pre-training layer 0, epoch 54, cost -75.3201090164
Pre-training layer 0, epoch 55, cost -75.1719041977
Pre-training layer 0, epoch 55, representative training free energy -430.617263306
Pre-training layer 0, epoch 55, validation free energy -421.306008667
Pre-training layer 0, epoch 56, cost -75.0758881226
Pre-training layer 0, epoch 57, cost -74.9944437943
Pre-training layer 0, epoch 58, cost -74.9709277573
Pre-training layer 0, epoch 59, cost -74.8459486694
Pre-training layer 0, epoch 60, cost -74.7873908157
Pre-training layer 0, epoch 60, representative training free energy -433.541002136
Pre-training layer 0, epoch 60, validation free energy -423.791520996
Pre-training layer 0, epoch 61, cost -74.6986308517
Pre-training layer 0, epoch 62, cost -74.6961629105
Pre-training layer 0, epoch 63, cost -74.6269092941
Pre-training layer 0, epoch 64, cost -74.4552199326
Pre-training layer 0, epoch 65, cost -74.3903327713
Pre-training layer 0, epoch 65, representative training free energy -430.297140564
Pre-training layer 0, epoch 65, validation free energy -421.16558313
Pre-training layer 0, epoch 66, cost -74.4207197723
Pre-training layer 0, epoch 67, cost -74.2045432053
Pre-training layer 0, epoch 68, cost -74.3276963425
Pre-training layer 0, epoch 69, cost -74.1867552109
Pre-training layer 0, epoch 70, cost -74.1569223557
Pre-training layer 0, epoch 70, representative training free energy -426.782188843
Pre-training layer 0, epoch 70, validation free energy -417.286177979
Pre-training layer 0, epoch 71, cost -73.9679213181
Pre-training layer 0, epoch 72, cost -73.9157065582
Pre-training layer 0, epoch 73, cost -73.9487739258
Pre-training layer 0, epoch 74, cost -73.820802948
Pre-training layer 0, epoch 75, cost -73.8686244507
Pre-training layer 0, epoch 75, representative training free energy -425.160418823
Pre-training layer 0, epoch 75, validation free energy -415.67248999
Pre-training layer 0, epoch 76, cost -73.7678435745
Pre-training layer 0, epoch 77, cost -73.7547639313
Pre-training layer 0, epoch 78, cost -73.6197726898
Pre-training layer 0, epoch 79, cost -73.5465127411
Pre-training layer 0, epoch 80, cost -73.5106939468
Pre-training layer 0, epoch 80, representative training free energy -427.107114929
Pre-training layer 0, epoch 80, validation free energy -417.304890137
Pre-training layer 0, epoch 81, cost -73.5070674591
Pre-training layer 0, epoch 82, cost -73.4207890091
Pre-training layer 0, epoch 83, cost -73.2912901764
Pre-training layer 0, epoch 84, cost -73.2856065063
Pre-training layer 0, epoch 85, cost -73.2877668152
Pre-training layer 0, epoch 85, representative training free energy -423.462616028
Pre-training layer 0, epoch 85, validation free energy -413.757017151
Pre-training layer 0, epoch 86, cost -73.269462616
Pre-training layer 0, epoch 87, cost -73.2195631027
Pre-training layer 0, epoch 88, cost -73.1431128693
Pre-training layer 0, epoch 89, cost -73.0278825226
Pre-training layer 0, epoch 90, cost -73.0972766953
Pre-training layer 0, epoch 90, representative training free energy -423.470471008
Pre-training layer 0, epoch 90, validation free energy -413.653084045
Pre-training layer 0, epoch 91, cost -72.9433769608
Pre-training layer 0, epoch 92, cost -72.9312447662
Pre-training layer 0, epoch 93, cost -72.8750973892
Pre-training layer 0, epoch 94, cost -72.8755217133
Pre-training layer 0, epoch 95, cost -72.82974543
Pre-training layer 0, epoch 95, representative training free energy -422.377036194
Pre-training layer 0, epoch 95, validation free energy -411.854054199
Pre-training layer 0, epoch 96, cost -72.889235199
Pre-training layer 0, epoch 97, cost -72.8322908173
Pre-training layer 0, epoch 98, cost -72.6618044052
Pre-training layer 0, epoch 99, cost -72.7335900345
Pre-training layer 1, epoch 0, cost -311.346345306
Pre-training layer 1, epoch 0, representative training free energy -61207.3400625
Pre-training layer 1, epoch 0, validation free energy -60647.8299297
Pre-training layer 1, epoch 1, cost -267.57013028
Pre-training layer 1, epoch 2, cost -254.334557159
Pre-training layer 1, epoch 3, cost -246.606226746
Pre-training layer 1, epoch 4, cost -241.460929077
Pre-training layer 1, epoch 5, cost -237.629099792
Pre-training layer 1, epoch 5, representative training free energy -81388.1342969
Pre-training layer 1, epoch 5, validation free energy -80662.5941406
Pre-training layer 1, epoch 6, cost -234.713802521
Pre-training layer 1, epoch 7, cost -232.399807953
Pre-training layer 1, epoch 8, cost -230.370572479
Pre-training layer 1, epoch 9, cost -228.835253815
Pre-training layer 1, epoch 10, cost -227.345243134
Pre-training layer 1, epoch 10, representative training free energy -87406.9116055
Pre-training layer 1, epoch 10, validation free energy -86629.4704922
Pre-training layer 1, epoch 11, cost -226.267037476
Pre-training layer 1, epoch 12, cost -225.174446838
Pre-training layer 1, epoch 13, cost -224.227167297
Pre-training layer 1, epoch 14, cost -223.300317322
Pre-training layer 1, epoch 15, cost -222.683241608
Pre-training layer 1, epoch 15, representative training free energy -90871.7764023
Pre-training layer 1, epoch 15, validation free energy -90064.9812344
Pre-training layer 1, epoch 16, cost -221.979736359
Pre-training layer 1, epoch 17, cost -221.449637634
Pre-training layer 1, epoch 18, cost -220.83669809
Pre-training layer 1, epoch 19, cost -220.372310272
Pre-training layer 1, epoch 20, cost -219.853725616
Pre-training layer 1, epoch 20, representative training free energy -93603.1973555
Pre-training layer 1, epoch 20, validation free energy -92782.9518711
Pre-training layer 1, epoch 21, cost -219.366342133
Pre-training layer 1, epoch 22, cost -219.02393573
Pre-training layer 1, epoch 23, cost -218.619827301
Pre-training layer 1, epoch 24, cost -218.205110352
Pre-training layer 1, epoch 25, cost -217.915187134
Pre-training layer 1, epoch 25, representative training free energy -95574.2979766
Pre-training layer 1, epoch 25, validation free energy -94725.4942773
Pre-training layer 1, epoch 26, cost -217.663376434
Pre-training layer 1, epoch 27, cost -217.377781952
Pre-training layer 1, epoch 28, cost -216.952292023
Pre-training layer 1, epoch 29, cost -216.750039215
Pre-training layer 1, epoch 30, cost -216.462604095
Pre-training layer 1, epoch 30, representative training free energy -97310.7445625
Pre-training layer 1, epoch 30, validation free energy -96450.0479453
Pre-training layer 1, epoch 31, cost -216.211215881
Pre-training layer 1, epoch 32, cost -215.924994354
Pre-training layer 1, epoch 33, cost -215.77792807
Pre-training layer 1, epoch 34, cost -215.542893158
Pre-training layer 1, epoch 35, cost -215.293029877
Pre-training layer 1, epoch 35, representative training free energy -98719.6707344
Pre-training layer 1, epoch 35, validation free energy -97844.925875
Pre-training layer 1, epoch 36, cost -215.071202454
Pre-training layer 1, epoch 37, cost -214.9019151
Pre-training layer 1, epoch 38, cost -214.773051331
Pre-training layer 1, epoch 39, cost -214.546770294
Pre-training layer 1, epoch 40, cost -214.418748871
Pre-training layer 1, epoch 40, representative training free energy -99995.2975234
Pre-training layer 1, epoch 40, validation free energy -99108.6565391
Pre-training layer 1, epoch 41, cost -214.288496002
Pre-training layer 1, epoch 42, cost -214.10668869
Pre-training layer 1, epoch 43, cost -213.872127838
Pre-training layer 1, epoch 44, cost -213.812177643
Pre-training layer 1, epoch 45, cost -213.66521109
Pre-training layer 1, epoch 45, representative training free energy -101189.628742
Pre-training layer 1, epoch 45, validation free energy -100282.383148
Pre-training layer 1, epoch 46, cost -213.395198486
Pre-training layer 1, epoch 47, cost -213.319651123
Pre-training layer 1, epoch 48, cost -213.238233246
Pre-training layer 1, epoch 49, cost -213.08872821
Pre-training layer 1, epoch 50, cost -212.944401611
Pre-training layer 1, epoch 50, representative training free energy -102257.445312
Pre-training layer 1, epoch 50, validation free energy -101347.806898
Pre-training layer 1, epoch 51, cost -212.810711029
Pre-training layer 1, epoch 52, cost -212.787535248
Pre-training layer 1, epoch 53, cost -212.560885254
Pre-training layer 1, epoch 54, cost -212.48804303
Pre-training layer 1, epoch 55, cost -212.45143396
Pre-training layer 1, epoch 55, representative training free energy -103266.068844
Pre-training layer 1, epoch 55, validation free energy -102348.072844
Pre-training layer 1, epoch 56, cost -212.32295047
Pre-training layer 1, epoch 57, cost -212.191240967
Pre-training layer 1, epoch 58, cost -212.14015332
Pre-training layer 1, epoch 59, cost -211.983277588
Pre-training layer 1, epoch 60, cost -211.886899017
Pre-training layer 1, epoch 60, representative training free energy -104181.031484
Pre-training layer 1, epoch 60, validation free energy -103261.172063
Pre-training layer 1, epoch 61, cost -211.807815643
Pre-training layer 1, epoch 62, cost -211.713292145
Pre-training layer 1, epoch 63, cost -211.709150848
Pre-training layer 1, epoch 64, cost -211.522887573
Pre-training layer 1, epoch 65, cost -211.502937256
Pre-training layer 1, epoch 65, representative training free energy -104970.410641
Pre-training layer 1, epoch 65, validation free energy -104031.372813
Pre-training layer 1, epoch 66, cost -211.416115509
Pre-training layer 1, epoch 67, cost -211.334931641
Pre-training layer 1, epoch 68, cost -211.222079285
Pre-training layer 1, epoch 69, cost -211.101354187
Pre-training layer 1, epoch 70, cost -211.23736026
Pre-training layer 1, epoch 70, representative training free energy -105855.642641
Pre-training layer 1, epoch 70, validation free energy -104916.187508
Pre-training layer 1, epoch 71, cost -210.976411682
Pre-training layer 1, epoch 72, cost -210.97453952
Pre-training layer 1, epoch 73, cost -210.835589569
Pre-training layer 1, epoch 74, cost -210.840452789
Pre-training layer 1, epoch 75, cost -210.709061279
Pre-training layer 1, epoch 75, representative training free energy -106612.781914
Pre-training layer 1, epoch 75, validation free energy -105666.025898
Pre-training layer 1, epoch 76, cost -210.679986511
Pre-training layer 1, epoch 77, cost -210.487438812
Pre-training layer 1, epoch 78, cost -210.499816528
Pre-training layer 1, epoch 79, cost -210.492577179
Pre-training layer 1, epoch 80, cost -210.401538147
Pre-training layer 1, epoch 80, representative training free energy -107307.361266
Pre-training layer 1, epoch 80, validation free energy -106343.392234
Pre-training layer 1, epoch 81, cost -210.267599518
Pre-training layer 1, epoch 82, cost -210.285082428
Pre-training layer 1, epoch 83, cost -210.289146698
Pre-training layer 1, epoch 84, cost -210.17830365
Pre-training layer 1, epoch 85, cost -210.14367038
Pre-training layer 1, epoch 85, representative training free energy -107948.792953
Pre-training layer 1, epoch 85, validation free energy -106987.185461
Pre-training layer 1, epoch 86, cost -210.014977295
Pre-training layer 1, epoch 87, cost -210.01846994
Pre-training layer 1, epoch 88, cost -209.909806793
Pre-training layer 1, epoch 89, cost -209.929243042
Pre-training layer 1, epoch 90, cost -209.765568024
Pre-training layer 1, epoch 90, representative training free energy -108650.276133
Pre-training layer 1, epoch 90, validation free energy -107680.80375
Pre-training layer 1, epoch 91, cost -209.777194305
Pre-training layer 1, epoch 92, cost -209.683962769
Pre-training layer 1, epoch 93, cost -209.673048035
Pre-training layer 1, epoch 94, cost -209.555332855
Pre-training layer 1, epoch 95, cost -209.579368195
Pre-training layer 1, epoch 95, representative training free energy -109179.467359
Pre-training layer 1, epoch 95, validation free energy -108205.363953
Pre-training layer 1, epoch 96, cost -209.553233124
Pre-training layer 1, epoch 97, cost -209.490567566
Pre-training layer 1, epoch 98, cost -209.330858307
Pre-training layer 1, epoch 99, cost -209.434737091
Pre-training layer 2, epoch 0, cost -114.38708609
Pre-training layer 2, epoch 0, representative training free energy 3917.99475952
Pre-training layer 2, epoch 0, validation free energy 3868.24824048
Pre-training layer 2, epoch 1, cost -86.105010231
Pre-training layer 2, epoch 2, cost -79.9278508453
Pre-training layer 2, epoch 3, cost -76.5589980545
Pre-training layer 2, epoch 4, cost -74.0966926346
Pre-training layer 2, epoch 5, cost -72.468647049
Pre-training layer 2, epoch 5, representative training free energy 6454.12882227
Pre-training layer 2, epoch 5, validation free energy 6391.80726904
Pre-training layer 2, epoch 6, cost -71.1015131378
Pre-training layer 2, epoch 7, cost -70.0104285431
Pre-training layer 2, epoch 8, cost -69.0116147766
Pre-training layer 2, epoch 9, cost -68.3966503296
Pre-training layer 2, epoch 10, cost -67.706819519
Pre-training layer 2, epoch 10, representative training free energy 7749.44160156
Pre-training layer 2, epoch 10, validation free energy 7678.41617285
Pre-training layer 2, epoch 11, cost -67.1802336197
Pre-training layer 2, epoch 12, cost -66.7907121811
Pre-training layer 2, epoch 13, cost -66.2222231216
Pre-training layer 2, epoch 14, cost -65.9125703812
Pre-training layer 2, epoch 15, cost -65.5602144775
Pre-training layer 2, epoch 15, representative training free energy 8606.95378174
Pre-training layer 2, epoch 15, validation free energy 8531.23048975
Pre-training layer 2, epoch 16, cost -65.2962489395
Pre-training layer 2, epoch 17, cost -64.9768612289
Pre-training layer 2, epoch 18, cost -64.741950676
Pre-training layer 2, epoch 19, cost -64.5213097916
Pre-training layer 2, epoch 20, cost -64.2706314316
Pre-training layer 2, epoch 20, representative training free energy 9372.30856836
Pre-training layer 2, epoch 20, validation free energy 9288.58683105
Pre-training layer 2, epoch 21, cost -64.1061780014
Pre-training layer 2, epoch 22, cost -63.8573272934
Pre-training layer 2, epoch 23, cost -63.799301857
Pre-training layer 2, epoch 24, cost -63.593648613
Pre-training layer 2, epoch 25, cost -63.4060541687
Pre-training layer 2, epoch 25, representative training free energy 9948.79016064
Pre-training layer 2, epoch 25, validation free energy 9860.88602441
Pre-training layer 2, epoch 26, cost -63.3089359131
Pre-training layer 2, epoch 27, cost -63.1610460129
Pre-training layer 2, epoch 28, cost -63.0374287796
Pre-training layer 2, epoch 29, cost -62.9841881561
Pre-training layer 2, epoch 30, cost -62.7823464584
Pre-training layer 2, epoch 30, representative training free energy 10475.8817842
Pre-training layer 2, epoch 30, validation free energy 10383.5289556
Pre-training layer 2, epoch 31, cost -62.6399156876
Pre-training layer 2, epoch 32, cost -62.6057541428
Pre-training layer 2, epoch 33, cost -62.4669643402
Pre-training layer 2, epoch 34, cost -62.3378522949
Pre-training layer 2, epoch 35, cost -62.2983479233
Pre-training layer 2, epoch 35, representative training free energy 10931.0616865
Pre-training layer 2, epoch 35, validation free energy 10836.2076597
Pre-training layer 2, epoch 36, cost -62.1572881012
Pre-training layer 2, epoch 37, cost -62.2451837616
Pre-training layer 2, epoch 38, cost -62.1443203659
Pre-training layer 2, epoch 39, cost -62.0587835464
Pre-training layer 2, epoch 40, cost -61.9977855606
Pre-training layer 2, epoch 40, representative training free energy 11372.271375
Pre-training layer 2, epoch 40, validation free energy 11272.7070562
Pre-training layer 2, epoch 41, cost -61.9006488342
Pre-training layer 2, epoch 42, cost -61.7801231079
Pre-training layer 2, epoch 43, cost -61.7321266403
Pre-training layer 2, epoch 44, cost -61.6688030319
Pre-training layer 2, epoch 45, cost -61.5451931839
Pre-training layer 2, epoch 45, representative training free energy 11776.1386143
Pre-training layer 2, epoch 45, validation free energy 11673.0207412
Pre-training layer 2, epoch 46, cost -61.4649325714
Pre-training layer 2, epoch 47, cost -61.4942556076
Pre-training layer 2, epoch 48, cost -61.3936724854
Pre-training layer 2, epoch 49, cost -61.4439552155
Pre-training layer 2, epoch 50, cost -61.2808283081
Pre-training layer 2, epoch 50, representative training free energy 12181.6122832
Pre-training layer 2, epoch 50, validation free energy 12073.9375723
Pre-training layer 2, epoch 51, cost -61.3510396729
Pre-training layer 2, epoch 52, cost -61.2392453613
Pre-training layer 2, epoch 53, cost -61.2099749451
Pre-training layer 2, epoch 54, cost -61.1760619125
Pre-training layer 2, epoch 55, cost -61.1084845047
Pre-training layer 2, epoch 55, representative training free energy 12552.9022207
Pre-training layer 2, epoch 55, validation free energy 12442.0577109
Pre-training layer 2, epoch 56, cost -61.0659101944
Pre-training layer 2, epoch 57, cost -61.0019212723
Pre-training layer 2, epoch 58, cost -61.0021499481
Pre-training layer 2, epoch 59, cost -60.9760406647
Pre-training layer 2, epoch 60, cost -60.9381021042
Pre-training layer 2, epoch 60, representative training free energy 12907.6343018
Pre-training layer 2, epoch 60, validation free energy 12796.2148906
Pre-training layer 2, epoch 61, cost -60.9239246902
Pre-training layer 2, epoch 62, cost -60.8692794952
Pre-training layer 2, epoch 63, cost -60.9139055634
Pre-training layer 2, epoch 64, cost -60.7841354141
Pre-training layer 2, epoch 65, cost -60.7919325943
Pre-training layer 2, epoch 65, representative training free energy 13278.1909668
Pre-training layer 2, epoch 65, validation free energy 13163.1412822
Pre-training layer 2, epoch 66, cost -60.732168396
Pre-training layer 2, epoch 67, cost -60.6570929871
Pre-training layer 2, epoch 68, cost -60.6303229675
Pre-training layer 2, epoch 69, cost -60.5301994705
Pre-training layer 2, epoch 70, cost -60.5947526932
Pre-training layer 2, epoch 70, representative training free energy 13600.8897236
Pre-training layer 2, epoch 70, validation free energy 13482.9105889
Pre-training layer 2, epoch 71, cost -60.4947594376
Pre-training layer 2, epoch 72, cost -60.5165054855
Pre-training layer 2, epoch 73, cost -60.5138451004
Pre-training layer 2, epoch 74, cost -60.470722023
Pre-training layer 2, epoch 75, cost -60.4411588516
Pre-training layer 2, epoch 75, representative training free energy 13945.5743721
Pre-training layer 2, epoch 75, validation free energy 13824.5271719
Pre-training layer 2, epoch 76, cost -60.3920610275
Pre-training layer 2, epoch 77, cost -60.3105525436
Pre-training layer 2, epoch 78, cost -60.2939371414
Pre-training layer 2, epoch 79, cost -60.3451146088
Pre-training layer 2, epoch 80, cost -60.2488570175
Pre-training layer 2, epoch 80, representative training free energy 14237.0120615
Pre-training layer 2, epoch 80, validation free energy 14113.1976416
Pre-training layer 2, epoch 81, cost -60.2942085266
Pre-training layer 2, epoch 82, cost -60.2196814499
Pre-training layer 2, epoch 83, cost -60.2520543823
Pre-training layer 2, epoch 84, cost -60.2199589081
Pre-training layer 2, epoch 85, cost -60.1197089233
Pre-training layer 2, epoch 85, representative training free energy 14496.7217129
Pre-training layer 2, epoch 85, validation free energy 14369.7850908
Pre-training layer 2, epoch 86, cost -60.2137270737
Pre-training layer 2, epoch 87, cost -60.1496483994
Pre-training layer 2, epoch 88, cost -60.0672355499
Pre-training layer 2, epoch 89, cost -60.1374318695
Pre-training layer 2, epoch 90, cost -60.0361089401
Pre-training layer 2, epoch 90, representative training free energy 14841.5455625
Pre-training layer 2, epoch 90, validation free energy 14710.9583877
Pre-training layer 2, epoch 91, cost -60.0897756348
Pre-training layer 2, epoch 92, cost -59.9966418304
Pre-training layer 2, epoch 93, cost -59.9987382126
Pre-training layer 2, epoch 94, cost -60.0222743073
Pre-training layer 2, epoch 95, cost -59.946452919
Pre-training layer 2, epoch 95, representative training free energy 15141.0421514
Pre-training layer 2, epoch 95, validation free energy 15008.3140771
Pre-training layer 2, epoch 96, cost -59.9697313232
Pre-training layer 2, epoch 97, cost -59.9602384491
Pre-training layer 2, epoch 98, cost -59.9880949173
Pre-training layer 2, epoch 99, cost -59.9418054352
The pretraining code for file dbn_loop.pyc ran for 12.95m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 34.600000 %
     epoch 1, minibatch 500/500, test error of best model 29.200000 %
epoch 2, minibatch 500/500, validation error 25.200000 %
     epoch 2, minibatch 500/500, test error of best model 18.800000 %
epoch 3, minibatch 500/500, validation error 23.000000 %
     epoch 3, minibatch 500/500, test error of best model 14.800000 %
epoch 4, minibatch 500/500, validation error 20.800000 %
     epoch 4, minibatch 500/500, test error of best model 12.600000 %
epoch 5, minibatch 500/500, validation error 19.600000 %
     epoch 5, minibatch 500/500, test error of best model 11.600000 %
epoch 6, minibatch 500/500, validation error 19.200000 %
     epoch 6, minibatch 500/500, test error of best model 10.800000 %
epoch 7, minibatch 500/500, validation error 18.600000 %
     epoch 7, minibatch 500/500, test error of best model 10.400000 %
epoch 8, minibatch 500/500, validation error 18.400000 %
     epoch 8, minibatch 500/500, test error of best model 8.600000 %
epoch 9, minibatch 500/500, validation error 18.000000 %
     epoch 9, minibatch 500/500, test error of best model 7.600000 %
epoch 10, minibatch 500/500, validation error 16.800000 %
     epoch 10, minibatch 500/500, test error of best model 6.600000 %
epoch 11, minibatch 500/500, validation error 16.400000 %
     epoch 11, minibatch 500/500, test error of best model 5.800000 %
epoch 12, minibatch 500/500, validation error 16.600000 %
epoch 13, minibatch 500/500, validation error 16.400000 %
     epoch 13, minibatch 500/500, test error of best model 5.600000 %
epoch 14, minibatch 500/500, validation error 16.400000 %
epoch 15, minibatch 500/500, validation error 16.200000 %
     epoch 15, minibatch 500/500, test error of best model 5.000000 %
epoch 16, minibatch 500/500, validation error 16.200000 %
epoch 17, minibatch 500/500, validation error 16.400000 %
epoch 18, minibatch 500/500, validation error 16.400000 %
epoch 19, minibatch 500/500, validation error 16.400000 %
epoch 20, minibatch 500/500, validation error 16.200000 %
epoch 21, minibatch 500/500, validation error 16.000000 %
     epoch 21, minibatch 500/500, test error of best model 4.400000 %
epoch 22, minibatch 500/500, validation error 15.800000 %
     epoch 22, minibatch 500/500, test error of best model 4.800000 %
epoch 23, minibatch 500/500, validation error 15.800000 %
epoch 24, minibatch 500/500, validation error 15.600000 %
     epoch 24, minibatch 500/500, test error of best model 5.000000 %
epoch 25, minibatch 500/500, validation error 15.400000 %
     epoch 25, minibatch 500/500, test error of best model 4.800000 %
epoch 26, minibatch 500/500, validation error 15.200000 %
     epoch 26, minibatch 500/500, test error of best model 4.800000 %
epoch 27, minibatch 500/500, validation error 15.000000 %
     epoch 27, minibatch 500/500, test error of best model 5.000000 %
epoch 28, minibatch 500/500, validation error 14.800000 %
     epoch 28, minibatch 500/500, test error of best model 5.000000 %
epoch 29, minibatch 500/500, validation error 14.800000 %
epoch 30, minibatch 500/500, validation error 14.800000 %
epoch 31, minibatch 500/500, validation error 14.800000 %
epoch 32, minibatch 500/500, validation error 14.800000 %
epoch 33, minibatch 500/500, validation error 14.800000 %
epoch 34, minibatch 500/500, validation error 14.800000 %
epoch 35, minibatch 500/500, validation error 14.800000 %
epoch 36, minibatch 500/500, validation error 14.800000 %
epoch 37, minibatch 500/500, validation error 14.800000 %
epoch 38, minibatch 500/500, validation error 15.000000 %
epoch 39, minibatch 500/500, validation error 15.200000 %
epoch 40, minibatch 500/500, validation error 15.200000 %
epoch 41, minibatch 500/500, validation error 15.200000 %
epoch 42, minibatch 500/500, validation error 15.200000 %
epoch 43, minibatch 500/500, validation error 15.200000 %
epoch 44, minibatch 500/500, validation error 15.200000 %
epoch 45, minibatch 500/500, validation error 15.200000 %
epoch 46, minibatch 500/500, validation error 15.200000 %
epoch 47, minibatch 500/500, validation error 15.200000 %
epoch 48, minibatch 500/500, validation error 15.200000 %
epoch 49, minibatch 500/500, validation error 15.200000 %
epoch 50, minibatch 500/500, validation error 15.200000 %
epoch 51, minibatch 500/500, validation error 15.200000 %
epoch 52, minibatch 500/500, validation error 15.200000 %
epoch 53, minibatch 500/500, validation error 15.200000 %
epoch 54, minibatch 500/500, validation error 15.200000 %
epoch 55, minibatch 500/500, validation error 15.200000 %
Optimization complete with best validation score of 14.800000 %, obtained at iteration 14000, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 2.23m
_______RUN: 2

==========Sample: (1000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.043189087
Pre-training layer 0, epoch 0, representative training free energy -595.889119751
Pre-training layer 0, epoch 0, validation free energy -590.619898193
Pre-training layer 0, epoch 1, cost -136.472100601
Pre-training layer 0, epoch 2, cost -125.128171692
Pre-training layer 0, epoch 3, cost -118.284975586
Pre-training layer 0, epoch 4, cost -113.428150177
Pre-training layer 0, epoch 5, cost -109.63169693
Pre-training layer 0, epoch 5, representative training free energy -548.883414307
Pre-training layer 0, epoch 5, validation free energy -536.633403748
Pre-training layer 0, epoch 6, cost -107.165702744
Pre-training layer 0, epoch 7, cost -104.681302414
Pre-training layer 0, epoch 8, cost -102.484861221
Pre-training layer 0, epoch 9, cost -101.058521423
Pre-training layer 0, epoch 10, cost -99.4899459076
Pre-training layer 0, epoch 10, representative training free energy -532.313694397
Pre-training layer 0, epoch 10, validation free energy -519.128973816
Pre-training layer 0, epoch 11, cost -98.238859787
Pre-training layer 0, epoch 12, cost -96.7534632874
Pre-training layer 0, epoch 13, cost -95.5578357697
Pre-training layer 0, epoch 14, cost -94.8008841705
Pre-training layer 0, epoch 15, cost -93.9573202515
Pre-training layer 0, epoch 15, representative training free energy -517.84208783
Pre-training layer 0, epoch 15, validation free energy -503.790120667
Pre-training layer 0, epoch 16, cost -92.7759661102
Pre-training layer 0, epoch 17, cost -92.0982598877
Pre-training layer 0, epoch 18, cost -91.3751959991
Pre-training layer 0, epoch 19, cost -90.6186144257
Pre-training layer 0, epoch 20, cost -89.9836988831
Pre-training layer 0, epoch 20, representative training free energy -507.526231628
Pre-training layer 0, epoch 20, validation free energy -492.839167175
Pre-training layer 0, epoch 21, cost -89.7651438141
Pre-training layer 0, epoch 22, cost -89.0625942993
Pre-training layer 0, epoch 23, cost -88.3815729523
Pre-training layer 0, epoch 24, cost -87.8640220642
Pre-training layer 0, epoch 25, cost -87.4096091461
Pre-training layer 0, epoch 25, representative training free energy -503.930374512
Pre-training layer 0, epoch 25, validation free energy -487.818567932
Pre-training layer 0, epoch 26, cost -86.9222665405
Pre-training layer 0, epoch 27, cost -86.2664929962
Pre-training layer 0, epoch 28, cost -85.8168328857
Pre-training layer 0, epoch 29, cost -85.7092076111
Pre-training layer 0, epoch 30, cost -85.2529852295
Pre-training layer 0, epoch 30, representative training free energy -497.194544312
Pre-training layer 0, epoch 30, validation free energy -480.173419067
Pre-training layer 0, epoch 31, cost -84.9366644287
Pre-training layer 0, epoch 32, cost -84.3386476135
Pre-training layer 0, epoch 33, cost -84.4326433563
Pre-training layer 0, epoch 34, cost -83.9403873444
Pre-training layer 0, epoch 35, cost -83.3279486847
Pre-training layer 0, epoch 35, representative training free energy -493.40841095
Pre-training layer 0, epoch 35, validation free energy -475.987074402
Pre-training layer 0, epoch 36, cost -83.4858027649
Pre-training layer 0, epoch 37, cost -83.0845994568
Pre-training layer 0, epoch 38, cost -82.8149003601
Pre-training layer 0, epoch 39, cost -82.5724768066
Pre-training layer 0, epoch 40, cost -82.2399372864
Pre-training layer 0, epoch 40, representative training free energy -490.2534021
Pre-training layer 0, epoch 40, validation free energy -472.45409198
Pre-training layer 0, epoch 41, cost -81.6954735565
Pre-training layer 0, epoch 42, cost -81.4539731598
Pre-training layer 0, epoch 43, cost -81.4695302582
Pre-training layer 0, epoch 44, cost -81.1526741028
Pre-training layer 0, epoch 45, cost -81.0662878418
Pre-training layer 0, epoch 45, representative training free energy -485.148361389
Pre-training layer 0, epoch 45, validation free energy -466.656837708
Pre-training layer 0, epoch 46, cost -80.8380030441
Pre-training layer 0, epoch 47, cost -80.5515162277
Pre-training layer 0, epoch 48, cost -80.3160176849
Pre-training layer 0, epoch 49, cost -80.1533053207
Pre-training layer 0, epoch 50, cost -80.0855866241
Pre-training layer 0, epoch 50, representative training free energy -484.220619934
Pre-training layer 0, epoch 50, validation free energy -465.675587891
Pre-training layer 0, epoch 51, cost -79.9358181763
Pre-training layer 0, epoch 52, cost -79.6661459351
Pre-training layer 0, epoch 53, cost -79.5442881012
Pre-training layer 0, epoch 54, cost -79.2705409241
Pre-training layer 0, epoch 55, cost -79.4564471817
Pre-training layer 0, epoch 55, representative training free energy -482.867759949
Pre-training layer 0, epoch 55, validation free energy -463.906469421
Pre-training layer 0, epoch 56, cost -78.87884655
Pre-training layer 0, epoch 57, cost -78.5342813873
Pre-training layer 0, epoch 58, cost -78.5868029785
Pre-training layer 0, epoch 59, cost -78.5066470337
Pre-training layer 0, epoch 60, cost -78.1739041138
Pre-training layer 0, epoch 60, representative training free energy -479.409493164
Pre-training layer 0, epoch 60, validation free energy -459.875624878
Pre-training layer 0, epoch 61, cost -78.2350206375
Pre-training layer 0, epoch 62, cost -77.9617185211
Pre-training layer 0, epoch 63, cost -77.9990694046
Pre-training layer 0, epoch 64, cost -77.7707526779
Pre-training layer 0, epoch 65, cost -77.6478490829
Pre-training layer 0, epoch 65, representative training free energy -476.039150024
Pre-training layer 0, epoch 65, validation free energy -456.139876831
Pre-training layer 0, epoch 66, cost -77.5000022888
Pre-training layer 0, epoch 67, cost -77.3960926056
Pre-training layer 0, epoch 68, cost -77.1139202118
Pre-training layer 0, epoch 69, cost -77.0852465057
Pre-training layer 0, epoch 70, cost -77.1659054565
Pre-training layer 0, epoch 70, representative training free energy -474.376198059
Pre-training layer 0, epoch 70, validation free energy -454.392613525
Pre-training layer 0, epoch 71, cost -76.8394102478
Pre-training layer 0, epoch 72, cost -76.8106327438
Pre-training layer 0, epoch 73, cost -76.8042741013
Pre-training layer 0, epoch 74, cost -76.5966850662
Pre-training layer 0, epoch 75, cost -76.3681761551
Pre-training layer 0, epoch 75, representative training free energy -475.406561035
Pre-training layer 0, epoch 75, validation free energy -454.358587219
Pre-training layer 0, epoch 76, cost -75.9707412338
Pre-training layer 0, epoch 77, cost -76.0213361359
Pre-training layer 0, epoch 78, cost -75.9721330643
Pre-training layer 0, epoch 79, cost -76.0253175354
Pre-training layer 0, epoch 80, cost -75.9528858566
Pre-training layer 0, epoch 80, representative training free energy -470.585083313
Pre-training layer 0, epoch 80, validation free energy -450.068463135
Pre-training layer 0, epoch 81, cost -75.8374982071
Pre-training layer 0, epoch 82, cost -75.6770450974
Pre-training layer 0, epoch 83, cost -75.5731023026
Pre-training layer 0, epoch 84, cost -75.2638222885
Pre-training layer 0, epoch 85, cost -75.4737820816
Pre-training layer 0, epoch 85, representative training free energy -473.374094482
Pre-training layer 0, epoch 85, validation free energy -452.295091797
Pre-training layer 0, epoch 86, cost -75.0034216309
Pre-training layer 0, epoch 87, cost -74.921907959
Pre-training layer 0, epoch 88, cost -75.200644989
Pre-training layer 0, epoch 89, cost -74.874732399
Pre-training layer 0, epoch 90, cost -74.6684869003
Pre-training layer 0, epoch 90, representative training free energy -473.007346924
Pre-training layer 0, epoch 90, validation free energy -451.638002319
Pre-training layer 0, epoch 91, cost -74.9276845932
Pre-training layer 0, epoch 92, cost -74.6288854218
Pre-training layer 0, epoch 93, cost -74.9827228165
Pre-training layer 0, epoch 94, cost -74.448895874
Pre-training layer 0, epoch 95, cost -74.3994270325
Pre-training layer 0, epoch 95, representative training free energy -469.517440796
Pre-training layer 0, epoch 95, validation free energy -447.991021729
Pre-training layer 0, epoch 96, cost -74.2488061523
Pre-training layer 0, epoch 97, cost -74.4555763626
Pre-training layer 0, epoch 98, cost -74.1879555511
Pre-training layer 0, epoch 99, cost -74.3549111938
Pre-training layer 1, epoch 0, cost -430.577184753
Pre-training layer 1, epoch 0, representative training free energy -32107.479373
Pre-training layer 1, epoch 0, validation free energy -31801.5804082
Pre-training layer 1, epoch 1, cost -369.960960693
Pre-training layer 1, epoch 2, cost -350.476341858
Pre-training layer 1, epoch 3, cost -338.821156006
Pre-training layer 1, epoch 4, cost -330.216763611
Pre-training layer 1, epoch 5, cost -323.965916443
Pre-training layer 1, epoch 5, representative training free energy -46028.8399336
Pre-training layer 1, epoch 5, validation free energy -45663.8291699
Pre-training layer 1, epoch 6, cost -319.127928772
Pre-training layer 1, epoch 7, cost -314.80794342
Pre-training layer 1, epoch 8, cost -311.291400452
Pre-training layer 1, epoch 9, cost -308.510078735
Pre-training layer 1, epoch 10, cost -306.162843323
Pre-training layer 1, epoch 10, representative training free energy -50297.2210996
Pre-training layer 1, epoch 10, validation free energy -49927.7388164
Pre-training layer 1, epoch 11, cost -303.535516357
Pre-training layer 1, epoch 12, cost -301.186134644
Pre-training layer 1, epoch 13, cost -299.548261719
Pre-training layer 1, epoch 14, cost -297.90450531
Pre-training layer 1, epoch 15, cost -296.327110596
Pre-training layer 1, epoch 15, representative training free energy -52790.6250234
Pre-training layer 1, epoch 15, validation free energy -52426.9191074
Pre-training layer 1, epoch 16, cost -294.909078827
Pre-training layer 1, epoch 17, cost -293.779243774
Pre-training layer 1, epoch 18, cost -292.42588562
Pre-training layer 1, epoch 19, cost -291.764444733
Pre-training layer 1, epoch 20, cost -290.332293396
Pre-training layer 1, epoch 20, representative training free energy -54498.3898477
Pre-training layer 1, epoch 20, validation free energy -54126.267957
Pre-training layer 1, epoch 21, cost -289.307091675
Pre-training layer 1, epoch 22, cost -288.321738892
Pre-training layer 1, epoch 23, cost -287.728697968
Pre-training layer 1, epoch 24, cost -286.955036316
Pre-training layer 1, epoch 25, cost -286.364444885
Pre-training layer 1, epoch 25, representative training free energy -55815.3986523
Pre-training layer 1, epoch 25, validation free energy -55445.77075
Pre-training layer 1, epoch 26, cost -285.37533432
Pre-training layer 1, epoch 27, cost -284.87660675
Pre-training layer 1, epoch 28, cost -284.258635101
Pre-training layer 1, epoch 29, cost -283.105394897
Pre-training layer 1, epoch 30, cost -283.074776917
Pre-training layer 1, epoch 30, representative training free energy -56929.9934648
Pre-training layer 1, epoch 30, validation free energy -56555.4532617
Pre-training layer 1, epoch 31, cost -282.525939026
Pre-training layer 1, epoch 32, cost -281.904763794
Pre-training layer 1, epoch 33, cost -281.41069809
Pre-training layer 1, epoch 34, cost -281.044350128
Pre-training layer 1, epoch 35, cost -280.346612854
Pre-training layer 1, epoch 35, representative training free energy -57799.814418
Pre-training layer 1, epoch 35, validation free energy -57430.3141758
Pre-training layer 1, epoch 36, cost -279.883988647
Pre-training layer 1, epoch 37, cost -279.776568909
Pre-training layer 1, epoch 38, cost -279.32145813
Pre-training layer 1, epoch 39, cost -278.904905548
Pre-training layer 1, epoch 40, cost -278.34724411
Pre-training layer 1, epoch 40, representative training free energy -58493.3052656
Pre-training layer 1, epoch 40, validation free energy -58119.1880703
Pre-training layer 1, epoch 41, cost -278.271392975
Pre-training layer 1, epoch 42, cost -277.837977295
Pre-training layer 1, epoch 43, cost -277.506596527
Pre-training layer 1, epoch 44, cost -277.219942169
Pre-training layer 1, epoch 45, cost -276.696249237
Pre-training layer 1, epoch 45, representative training free energy -59233.5338008
Pre-training layer 1, epoch 45, validation free energy -58855.2971094
Pre-training layer 1, epoch 46, cost -276.469264679
Pre-training layer 1, epoch 47, cost -276.300036163
Pre-training layer 1, epoch 48, cost -275.951200104
Pre-training layer 1, epoch 49, cost -275.56678833
Pre-training layer 1, epoch 50, cost -275.409062805
Pre-training layer 1, epoch 50, representative training free energy -59826.7152266
Pre-training layer 1, epoch 50, validation free energy -59445.571625
Pre-training layer 1, epoch 51, cost -274.938309937
Pre-training layer 1, epoch 52, cost -275.047410126
Pre-training layer 1, epoch 53, cost -274.507932434
Pre-training layer 1, epoch 54, cost -274.409963837
Pre-training layer 1, epoch 55, cost -274.082242584
Pre-training layer 1, epoch 55, representative training free energy -60443.5243203
Pre-training layer 1, epoch 55, validation free energy -60059.44575
Pre-training layer 1, epoch 56, cost -273.934833069
Pre-training layer 1, epoch 57, cost -273.837746277
Pre-training layer 1, epoch 58, cost -273.584664307
Pre-training layer 1, epoch 59, cost -273.226986694
Pre-training layer 1, epoch 60, cost -273.255337372
Pre-training layer 1, epoch 60, representative training free energy -60868.8618242
Pre-training layer 1, epoch 60, validation free energy -60484.1845273
Pre-training layer 1, epoch 61, cost -272.853373566
Pre-training layer 1, epoch 62, cost -272.768600311
Pre-training layer 1, epoch 63, cost -272.612248383
Pre-training layer 1, epoch 64, cost -272.277591858
Pre-training layer 1, epoch 65, cost -272.15904007
Pre-training layer 1, epoch 65, representative training free energy -61349.787043
Pre-training layer 1, epoch 65, validation free energy -60962.874832
Pre-training layer 1, epoch 66, cost -271.960254669
Pre-training layer 1, epoch 67, cost -271.991833344
Pre-training layer 1, epoch 68, cost -271.679141083
Pre-training layer 1, epoch 69, cost -271.803814697
Pre-training layer 1, epoch 70, cost -271.440477905
Pre-training layer 1, epoch 70, representative training free energy -61694.1466562
Pre-training layer 1, epoch 70, validation free energy -61308.9939648
Pre-training layer 1, epoch 71, cost -271.219955292
Pre-training layer 1, epoch 72, cost -271.142145386
Pre-training layer 1, epoch 73, cost -270.838344116
Pre-training layer 1, epoch 74, cost -270.832736816
Pre-training layer 1, epoch 75, cost -270.819335327
Pre-training layer 1, epoch 75, representative training free energy -62122.9319531
Pre-training layer 1, epoch 75, validation free energy -61734.0953203
Pre-training layer 1, epoch 76, cost -270.574863586
Pre-training layer 1, epoch 77, cost -270.42315033
Pre-training layer 1, epoch 78, cost -270.231528625
Pre-training layer 1, epoch 79, cost -270.290183868
Pre-training layer 1, epoch 80, cost -270.069274292
Pre-training layer 1, epoch 80, representative training free energy -62487.8887578
Pre-training layer 1, epoch 80, validation free energy -62097.8354453
Pre-training layer 1, epoch 81, cost -270.014069824
Pre-training layer 1, epoch 82, cost -269.922103729
Pre-training layer 1, epoch 83, cost -269.631268768
Pre-training layer 1, epoch 84, cost -269.601772003
Pre-training layer 1, epoch 85, cost -269.525292816
Pre-training layer 1, epoch 85, representative training free energy -62871.4801133
Pre-training layer 1, epoch 85, validation free energy -62477.4115156
Pre-training layer 1, epoch 86, cost -269.446362152
Pre-training layer 1, epoch 87, cost -269.272110596
Pre-training layer 1, epoch 88, cost -269.280471344
Pre-training layer 1, epoch 89, cost -269.122062836
Pre-training layer 1, epoch 90, cost -268.758178558
Pre-training layer 1, epoch 90, representative training free energy -63187.6154961
Pre-training layer 1, epoch 90, validation free energy -62798.6402852
Pre-training layer 1, epoch 91, cost -268.764603424
Pre-training layer 1, epoch 92, cost -268.778916016
Pre-training layer 1, epoch 93, cost -268.578972473
Pre-training layer 1, epoch 94, cost -268.392371521
Pre-training layer 1, epoch 95, cost -268.303805695
Pre-training layer 1, epoch 95, representative training free energy -63518.1179102
Pre-training layer 1, epoch 95, validation free energy -63127.5931836
Pre-training layer 1, epoch 96, cost -268.130078125
Pre-training layer 1, epoch 97, cost -268.174756317
Pre-training layer 1, epoch 98, cost -267.990988007
Pre-training layer 1, epoch 99, cost -268.197073212
Pre-training layer 2, epoch 0, cost -161.644596558
Pre-training layer 2, epoch 0, representative training free energy 1747.05411646
Pre-training layer 2, epoch 0, validation free energy 1756.28523975
Pre-training layer 2, epoch 1, cost -108.077160797
Pre-training layer 2, epoch 2, cost -97.7050727844
Pre-training layer 2, epoch 3, cost -92.1457401276
Pre-training layer 2, epoch 4, cost -88.0743817139
Pre-training layer 2, epoch 5, cost -85.227498436
Pre-training layer 2, epoch 5, representative training free energy 2657.48538586
Pre-training layer 2, epoch 5, validation free energy 2650.71683508
Pre-training layer 2, epoch 6, cost -83.0231480408
Pre-training layer 2, epoch 7, cost -81.503466568
Pre-training layer 2, epoch 8, cost -79.7691359329
Pre-training layer 2, epoch 9, cost -78.6121381378
Pre-training layer 2, epoch 10, cost -77.6404014969
Pre-training layer 2, epoch 10, representative training free energy 3084.74208044
Pre-training layer 2, epoch 10, validation free energy 3068.36283069
Pre-training layer 2, epoch 11, cost -76.6605444717
Pre-training layer 2, epoch 12, cost -75.5952902985
Pre-training layer 2, epoch 13, cost -75.1150872421
Pre-training layer 2, epoch 14, cost -74.3960360718
Pre-training layer 2, epoch 15, cost -73.5558872604
Pre-training layer 2, epoch 15, representative training free energy 3377.35366748
Pre-training layer 2, epoch 15, validation free energy 3357.45095142
Pre-training layer 2, epoch 16, cost -73.1076721954
Pre-training layer 2, epoch 17, cost -72.4579459763
Pre-training layer 2, epoch 18, cost -72.1477981186
Pre-training layer 2, epoch 19, cost -71.7608695602
Pre-training layer 2, epoch 20, cost -71.1732767105
Pre-training layer 2, epoch 20, representative training free energy 3666.97790454
Pre-training layer 2, epoch 20, validation free energy 3641.1352417
Pre-training layer 2, epoch 21, cost -71.0939682388
Pre-training layer 2, epoch 22, cost -70.5792154694
Pre-training layer 2, epoch 23, cost -70.1729029465
Pre-training layer 2, epoch 24, cost -69.8379794693
Pre-training layer 2, epoch 25, cost -69.5380999756
Pre-training layer 2, epoch 25, representative training free energy 3882.68916333
Pre-training layer 2, epoch 25, validation free energy 3853.84562329
Pre-training layer 2, epoch 26, cost -69.2444790268
Pre-training layer 2, epoch 27, cost -68.9880338669
Pre-training layer 2, epoch 28, cost -68.7636407089
Pre-training layer 2, epoch 29, cost -68.5523610306
Pre-training layer 2, epoch 30, cost -68.2042389297
Pre-training layer 2, epoch 30, representative training free energy 4050.19075513
Pre-training layer 2, epoch 30, validation free energy 4019.60191309
Pre-training layer 2, epoch 31, cost -68.1545730972
Pre-training layer 2, epoch 32, cost -67.8367335892
Pre-training layer 2, epoch 33, cost -67.7246360016
Pre-training layer 2, epoch 34, cost -67.3989930344
Pre-training layer 2, epoch 35, cost -67.3169920731
Pre-training layer 2, epoch 35, representative training free energy 4239.56777515
Pre-training layer 2, epoch 35, validation free energy 4205.07383496
Pre-training layer 2, epoch 36, cost -67.1084629059
Pre-training layer 2, epoch 37, cost -66.8706339264
Pre-training layer 2, epoch 38, cost -66.8680241013
Pre-training layer 2, epoch 39, cost -66.654045639
Pre-training layer 2, epoch 40, cost -66.5921276474
Pre-training layer 2, epoch 40, representative training free energy 4393.40134106
Pre-training layer 2, epoch 40, validation free energy 4355.82561572
Pre-training layer 2, epoch 41, cost -66.2991624832
Pre-training layer 2, epoch 42, cost -66.2583571625
Pre-training layer 2, epoch 43, cost -66.022891922
Pre-training layer 2, epoch 44, cost -65.8783695602
Pre-training layer 2, epoch 45, cost -65.7412512589
Pre-training layer 2, epoch 45, representative training free energy 4549.82260815
Pre-training layer 2, epoch 45, validation free energy 4511.91108887
Pre-training layer 2, epoch 46, cost -65.6974091339
Pre-training layer 2, epoch 47, cost -65.5600854111
Pre-training layer 2, epoch 48, cost -65.478205719
Pre-training layer 2, epoch 49, cost -65.3909065247
Pre-training layer 2, epoch 50, cost -65.3478950119
Pre-training layer 2, epoch 50, representative training free energy 4702.50599951
Pre-training layer 2, epoch 50, validation free energy 4661.00543555
Pre-training layer 2, epoch 51, cost -65.1890169525
Pre-training layer 2, epoch 52, cost -65.007121315
Pre-training layer 2, epoch 53, cost -65.0302518463
Pre-training layer 2, epoch 54, cost -64.8711507797
Pre-training layer 2, epoch 55, cost -64.7567595673
Pre-training layer 2, epoch 55, representative training free energy 4828.65521094
Pre-training layer 2, epoch 55, validation free energy 4784.79859741
Pre-training layer 2, epoch 56, cost -64.6165341568
Pre-training layer 2, epoch 57, cost -64.5440943146
Pre-training layer 2, epoch 58, cost -64.6774199677
Pre-training layer 2, epoch 59, cost -64.6119808578
Pre-training layer 2, epoch 60, cost -64.405078125
Pre-training layer 2, epoch 60, representative training free energy 4937.96538574
Pre-training layer 2, epoch 60, validation free energy 4893.95559839
Pre-training layer 2, epoch 61, cost -64.3582410812
Pre-training layer 2, epoch 62, cost -64.3727288818
Pre-training layer 2, epoch 63, cost -63.9553321457
Pre-training layer 2, epoch 64, cost -64.0390148544
Pre-training layer 2, epoch 65, cost -63.8766462326
Pre-training layer 2, epoch 65, representative training free energy 5060.9273623
Pre-training layer 2, epoch 65, validation free energy 5015.06936816
Pre-training layer 2, epoch 66, cost -64.0080059052
Pre-training layer 2, epoch 67, cost -63.8354423141
Pre-training layer 2, epoch 68, cost -63.7191077423
Pre-training layer 2, epoch 69, cost -63.8934627914
Pre-training layer 2, epoch 70, cost -63.492528801
Pre-training layer 2, epoch 70, representative training free energy 5160.9162998
Pre-training layer 2, epoch 70, validation free energy 5113.75450244
Pre-training layer 2, epoch 71, cost -63.6357167435
Pre-training layer 2, epoch 72, cost -63.5177117538
Pre-training layer 2, epoch 73, cost -63.6237233734
Pre-training layer 2, epoch 74, cost -63.2656856918
Pre-training layer 2, epoch 75, cost -63.3680797195
Pre-training layer 2, epoch 75, representative training free energy 5277.25410864
Pre-training layer 2, epoch 75, validation free energy 5228.54133862
Pre-training layer 2, epoch 76, cost -63.3745197678
Pre-training layer 2, epoch 77, cost -63.2646170044
Pre-training layer 2, epoch 78, cost -63.1174901581
Pre-training layer 2, epoch 79, cost -63.1767759705
Pre-training layer 2, epoch 80, cost -63.0919241333
Pre-training layer 2, epoch 80, representative training free energy 5377.2495144
Pre-training layer 2, epoch 80, validation free energy 5327.48577637
Pre-training layer 2, epoch 81, cost -62.9010349274
Pre-training layer 2, epoch 82, cost -62.9889198685
Pre-training layer 2, epoch 83, cost -62.8738696671
Pre-training layer 2, epoch 84, cost -62.6768767548
Pre-training layer 2, epoch 85, cost -62.8630489349
Pre-training layer 2, epoch 85, representative training free energy 5486.25526562
Pre-training layer 2, epoch 85, validation free energy 5434.94553198
Pre-training layer 2, epoch 86, cost -62.8803176498
Pre-training layer 2, epoch 87, cost -62.7048997498
Pre-training layer 2, epoch 88, cost -62.8193235397
Pre-training layer 2, epoch 89, cost -62.7323464966
Pre-training layer 2, epoch 90, cost -62.5960502243
Pre-training layer 2, epoch 90, representative training free energy 5594.94110107
Pre-training layer 2, epoch 90, validation free energy 5541.85976465
Pre-training layer 2, epoch 91, cost -62.7174880219
Pre-training layer 2, epoch 92, cost -62.5661862564
Pre-training layer 2, epoch 93, cost -62.6333502197
Pre-training layer 2, epoch 94, cost -62.5295232391
Pre-training layer 2, epoch 95, cost -62.511427803
Pre-training layer 2, epoch 95, representative training free energy 5670.56097705
Pre-training layer 2, epoch 95, validation free energy 5616.4224165
Pre-training layer 2, epoch 96, cost -62.6295698166
Pre-training layer 2, epoch 97, cost -62.5338121033
Pre-training layer 2, epoch 98, cost -62.3689266586
Pre-training layer 2, epoch 99, cost -62.318625946
The pretraining code for file dbn_loop.pyc ran for 2.72m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 32.600000 %
     epoch 1, minibatch 100/100, test error of best model 29.000000 %
epoch 2, minibatch 100/100, validation error 28.200000 %
     epoch 2, minibatch 100/100, test error of best model 21.600000 %
epoch 3, minibatch 100/100, validation error 25.600000 %
     epoch 3, minibatch 100/100, test error of best model 17.200000 %
epoch 4, minibatch 100/100, validation error 25.000000 %
     epoch 4, minibatch 100/100, test error of best model 16.000000 %
epoch 5, minibatch 100/100, validation error 25.000000 %
epoch 6, minibatch 100/100, validation error 24.000000 %
     epoch 6, minibatch 100/100, test error of best model 14.800000 %
epoch 7, minibatch 100/100, validation error 22.800000 %
     epoch 7, minibatch 100/100, test error of best model 14.200000 %
epoch 8, minibatch 100/100, validation error 22.800000 %
epoch 9, minibatch 100/100, validation error 22.200000 %
     epoch 9, minibatch 100/100, test error of best model 13.800000 %
epoch 10, minibatch 100/100, validation error 22.200000 %
epoch 11, minibatch 100/100, validation error 22.200000 %
epoch 12, minibatch 100/100, validation error 22.000000 %
     epoch 12, minibatch 100/100, test error of best model 12.800000 %
epoch 13, minibatch 100/100, validation error 22.200000 %
epoch 14, minibatch 100/100, validation error 21.400000 %
     epoch 14, minibatch 100/100, test error of best model 12.600000 %
epoch 15, minibatch 100/100, validation error 21.400000 %
epoch 16, minibatch 100/100, validation error 21.000000 %
     epoch 16, minibatch 100/100, test error of best model 12.000000 %
epoch 17, minibatch 100/100, validation error 21.400000 %
epoch 18, minibatch 100/100, validation error 21.200000 %
epoch 19, minibatch 100/100, validation error 21.400000 %
epoch 20, minibatch 100/100, validation error 21.000000 %
epoch 21, minibatch 100/100, validation error 20.800000 %
     epoch 21, minibatch 100/100, test error of best model 12.000000 %
epoch 22, minibatch 100/100, validation error 21.200000 %
epoch 23, minibatch 100/100, validation error 21.200000 %
epoch 24, minibatch 100/100, validation error 20.800000 %
epoch 25, minibatch 100/100, validation error 21.000000 %
epoch 26, minibatch 100/100, validation error 21.000000 %
epoch 27, minibatch 100/100, validation error 21.000000 %
epoch 28, minibatch 100/100, validation error 21.200000 %
epoch 29, minibatch 100/100, validation error 21.200000 %
epoch 30, minibatch 100/100, validation error 21.000000 %
epoch 31, minibatch 100/100, validation error 21.000000 %
epoch 32, minibatch 100/100, validation error 21.000000 %
epoch 33, minibatch 100/100, validation error 21.000000 %
epoch 34, minibatch 100/100, validation error 21.200000 %
epoch 35, minibatch 100/100, validation error 21.400000 %
epoch 36, minibatch 100/100, validation error 21.400000 %
epoch 37, minibatch 100/100, validation error 21.800000 %
epoch 38, minibatch 100/100, validation error 21.600000 %
epoch 39, minibatch 100/100, validation error 21.400000 %
epoch 40, minibatch 100/100, validation error 21.600000 %
epoch 41, minibatch 100/100, validation error 21.600000 %
Optimization complete with best validation score of 20.800000 %, obtained at iteration 2100, with test performance 12.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.40m


==========Sample: (2000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.551820564
Pre-training layer 0, epoch 0, representative training free energy -583.268895935
Pre-training layer 0, epoch 0, validation free energy -578.873087708
Pre-training layer 0, epoch 1, cost -123.5066819
Pre-training layer 0, epoch 2, cost -113.653483925
Pre-training layer 0, epoch 3, cost -108.280522766
Pre-training layer 0, epoch 4, cost -104.339578972
Pre-training layer 0, epoch 5, cost -101.241847878
Pre-training layer 0, epoch 5, representative training free energy -524.894030457
Pre-training layer 0, epoch 5, validation free energy -515.791604126
Pre-training layer 0, epoch 6, cost -99.0644111252
Pre-training layer 0, epoch 7, cost -96.9144490814
Pre-training layer 0, epoch 8, cost -95.0259326553
Pre-training layer 0, epoch 9, cost -93.8716557312
Pre-training layer 0, epoch 10, cost -92.6794205475
Pre-training layer 0, epoch 10, representative training free energy -509.401551819
Pre-training layer 0, epoch 10, validation free energy -499.423169922
Pre-training layer 0, epoch 11, cost -91.5208781815
Pre-training layer 0, epoch 12, cost -90.5600363159
Pre-training layer 0, epoch 13, cost -89.7355065155
Pre-training layer 0, epoch 14, cost -88.9414498138
Pre-training layer 0, epoch 15, cost -88.4356932831
Pre-training layer 0, epoch 15, representative training free energy -494.58107843
Pre-training layer 0, epoch 15, validation free energy -483.336581726
Pre-training layer 0, epoch 16, cost -87.5197088623
Pre-training layer 0, epoch 17, cost -87.0995711517
Pre-training layer 0, epoch 18, cost -86.4348006821
Pre-training layer 0, epoch 19, cost -85.898492775
Pre-training layer 0, epoch 20, cost -85.5702631378
Pre-training layer 0, epoch 20, representative training free energy -487.684571106
Pre-training layer 0, epoch 20, validation free energy -476.845374512
Pre-training layer 0, epoch 21, cost -85.0976770782
Pre-training layer 0, epoch 22, cost -84.507923584
Pre-training layer 0, epoch 23, cost -84.1729079819
Pre-training layer 0, epoch 24, cost -83.6058138275
Pre-training layer 0, epoch 25, cost -83.3323456955
Pre-training layer 0, epoch 25, representative training free energy -480.034008606
Pre-training layer 0, epoch 25, validation free energy -468.637286743
Pre-training layer 0, epoch 26, cost -82.9992834473
Pre-training layer 0, epoch 27, cost -82.7277345467
Pre-training layer 0, epoch 28, cost -82.4522795868
Pre-training layer 0, epoch 29, cost -82.2481089401
Pre-training layer 0, epoch 30, cost -81.9703071404
Pre-training layer 0, epoch 30, representative training free energy -475.145615051
Pre-training layer 0, epoch 30, validation free energy -463.041995117
Pre-training layer 0, epoch 31, cost -81.6202210236
Pre-training layer 0, epoch 32, cost -81.2476660919
Pre-training layer 0, epoch 33, cost -81.1972212219
Pre-training layer 0, epoch 34, cost -80.8637343979
Pre-training layer 0, epoch 35, cost -80.779327755
Pre-training layer 0, epoch 35, representative training free energy -471.225500916
Pre-training layer 0, epoch 35, validation free energy -458.72946637
Pre-training layer 0, epoch 36, cost -80.2459968758
Pre-training layer 0, epoch 37, cost -80.2711061096
Pre-training layer 0, epoch 38, cost -80.0306713295
Pre-training layer 0, epoch 39, cost -79.8438047981
Pre-training layer 0, epoch 40, cost -79.6510220718
Pre-training layer 0, epoch 40, representative training free energy -469.303645569
Pre-training layer 0, epoch 40, validation free energy -456.577901794
Pre-training layer 0, epoch 41, cost -79.4510031509
Pre-training layer 0, epoch 42, cost -79.3360974312
Pre-training layer 0, epoch 43, cost -79.0086608505
Pre-training layer 0, epoch 44, cost -78.9820875549
Pre-training layer 0, epoch 45, cost -78.7621713638
Pre-training layer 0, epoch 45, representative training free energy -464.923416504
Pre-training layer 0, epoch 45, validation free energy -452.413412292
Pre-training layer 0, epoch 46, cost -78.6744142151
Pre-training layer 0, epoch 47, cost -78.3079274559
Pre-training layer 0, epoch 48, cost -78.1718266869
Pre-training layer 0, epoch 49, cost -78.2108893967
Pre-training layer 0, epoch 50, cost -77.9017174721
Pre-training layer 0, epoch 50, representative training free energy -460.073447937
Pre-training layer 0, epoch 50, validation free energy -446.761394348
Pre-training layer 0, epoch 51, cost -77.8305130577
Pre-training layer 0, epoch 52, cost -77.6579253578
Pre-training layer 0, epoch 53, cost -77.5570243454
Pre-training layer 0, epoch 54, cost -77.5930710983
Pre-training layer 0, epoch 55, cost -77.2996051407
Pre-training layer 0, epoch 55, representative training free energy -462.352227051
Pre-training layer 0, epoch 55, validation free energy -448.511286255
Pre-training layer 0, epoch 56, cost -77.2667702866
Pre-training layer 0, epoch 57, cost -77.0650826263
Pre-training layer 0, epoch 58, cost -77.0447327423
Pre-training layer 0, epoch 59, cost -76.8341771126
Pre-training layer 0, epoch 60, cost -76.5922818565
Pre-training layer 0, epoch 60, representative training free energy -459.836710693
Pre-training layer 0, epoch 60, validation free energy -445.721930359
Pre-training layer 0, epoch 61, cost -76.6612759972
Pre-training layer 0, epoch 62, cost -76.5214708519
Pre-training layer 0, epoch 63, cost -76.3249641037
Pre-training layer 0, epoch 64, cost -76.1951843452
Pre-training layer 0, epoch 65, cost -76.2130565071
Pre-training layer 0, epoch 65, representative training free energy -460.360286682
Pre-training layer 0, epoch 65, validation free energy -446.907755737
Pre-training layer 0, epoch 66, cost -76.2059699631
Pre-training layer 0, epoch 67, cost -75.950288353
Pre-training layer 0, epoch 68, cost -75.7648643684
Pre-training layer 0, epoch 69, cost -75.7617412376
Pre-training layer 0, epoch 70, cost -75.6581380463
Pre-training layer 0, epoch 70, representative training free energy -458.008083923
Pre-training layer 0, epoch 70, validation free energy -443.339305725
Pre-training layer 0, epoch 71, cost -75.7031814194
Pre-training layer 0, epoch 72, cost -75.4546427345
Pre-training layer 0, epoch 73, cost -75.4814480209
Pre-training layer 0, epoch 74, cost -75.4010311317
Pre-training layer 0, epoch 75, cost -75.2082784271
Pre-training layer 0, epoch 75, representative training free energy -459.261020569
Pre-training layer 0, epoch 75, validation free energy -444.569501404
Pre-training layer 0, epoch 76, cost -75.1727823067
Pre-training layer 0, epoch 77, cost -75.203987751
Pre-training layer 0, epoch 78, cost -75.1531296158
Pre-training layer 0, epoch 79, cost -74.8753558159
Pre-training layer 0, epoch 80, cost -74.9790768623
Pre-training layer 0, epoch 80, representative training free energy -453.476707764
Pre-training layer 0, epoch 80, validation free energy -439.100479797
Pre-training layer 0, epoch 81, cost -74.7450590897
Pre-training layer 0, epoch 82, cost -74.6350646973
Pre-training layer 0, epoch 83, cost -74.7128093147
Pre-training layer 0, epoch 84, cost -74.4339927292
Pre-training layer 0, epoch 85, cost -74.5367359352
Pre-training layer 0, epoch 85, representative training free energy -451.735577637
Pre-training layer 0, epoch 85, validation free energy -437.006406006
Pre-training layer 0, epoch 86, cost -74.437205925
Pre-training layer 0, epoch 87, cost -74.4162232399
Pre-training layer 0, epoch 88, cost -74.3668619347
Pre-training layer 0, epoch 89, cost -74.1930259705
Pre-training layer 0, epoch 90, cost -74.2826515198
Pre-training layer 0, epoch 90, representative training free energy -452.284997009
Pre-training layer 0, epoch 90, validation free energy -437.225667725
Pre-training layer 0, epoch 91, cost -74.1557624245
Pre-training layer 0, epoch 92, cost -74.2079636002
Pre-training layer 0, epoch 93, cost -73.9044777298
Pre-training layer 0, epoch 94, cost -73.9751312065
Pre-training layer 0, epoch 95, cost -73.8992717361
Pre-training layer 0, epoch 95, representative training free energy -452.335658997
Pre-training layer 0, epoch 95, validation free energy -437.341202209
Pre-training layer 0, epoch 96, cost -73.7423326874
Pre-training layer 0, epoch 97, cost -73.6934917831
Pre-training layer 0, epoch 98, cost -73.6785050774
Pre-training layer 0, epoch 99, cost -73.6755811501
Pre-training layer 1, epoch 0, cost -376.334873047
Pre-training layer 1, epoch 0, representative training free energy -42238.3683027
Pre-training layer 1, epoch 0, validation free energy -41943.1158125
Pre-training layer 1, epoch 1, cost -323.550115585
Pre-training layer 1, epoch 2, cost -307.124118271
Pre-training layer 1, epoch 3, cost -297.504543304
Pre-training layer 1, epoch 4, cost -290.487844238
Pre-training layer 1, epoch 5, cost -285.194460754
Pre-training layer 1, epoch 5, representative training free energy -58017.6542227
Pre-training layer 1, epoch 5, validation free energy -57610.7124688
Pre-training layer 1, epoch 6, cost -281.03859581
Pre-training layer 1, epoch 7, cost -277.767498703
Pre-training layer 1, epoch 8, cost -274.905380783
Pre-training layer 1, epoch 9, cost -272.373574753
Pre-training layer 1, epoch 10, cost -270.332423859
Pre-training layer 1, epoch 10, representative training free energy -62774.0536484
Pre-training layer 1, epoch 10, validation free energy -62335.6183633
Pre-training layer 1, epoch 11, cost -268.687248306
Pre-training layer 1, epoch 12, cost -266.929573059
Pre-training layer 1, epoch 13, cost -265.351433105
Pre-training layer 1, epoch 14, cost -264.143243942
Pre-training layer 1, epoch 15, cost -262.965517502
Pre-training layer 1, epoch 15, representative training free energy -65588.5903594
Pre-training layer 1, epoch 15, validation free energy -65130.2459102
Pre-training layer 1, epoch 16, cost -261.964747009
Pre-training layer 1, epoch 17, cost -260.886558533
Pre-training layer 1, epoch 18, cost -259.934276047
Pre-training layer 1, epoch 19, cost -259.227332077
Pre-training layer 1, epoch 20, cost -258.495982132
Pre-training layer 1, epoch 20, representative training free energy -67519.2516484
Pre-training layer 1, epoch 20, validation free energy -67045.1541367
Pre-training layer 1, epoch 21, cost -257.710546875
Pre-training layer 1, epoch 22, cost -257.066568527
Pre-training layer 1, epoch 23, cost -256.281188126
Pre-training layer 1, epoch 24, cost -255.853452911
Pre-training layer 1, epoch 25, cost -255.257941208
Pre-training layer 1, epoch 25, representative training free energy -69044.0839297
Pre-training layer 1, epoch 25, validation free energy -68562.699582
Pre-training layer 1, epoch 26, cost -254.808272858
Pre-training layer 1, epoch 27, cost -254.237398376
Pre-training layer 1, epoch 28, cost -253.657857285
Pre-training layer 1, epoch 29, cost -253.484422913
Pre-training layer 1, epoch 30, cost -252.949874268
Pre-training layer 1, epoch 30, representative training free energy -70170.6776172
Pre-training layer 1, epoch 30, validation free energy -69680.9524766
Pre-training layer 1, epoch 31, cost -252.61432724
Pre-training layer 1, epoch 32, cost -252.160879059
Pre-training layer 1, epoch 33, cost -252.021469879
Pre-training layer 1, epoch 34, cost -251.67704155
Pre-training layer 1, epoch 35, cost -251.367903595
Pre-training layer 1, epoch 35, representative training free energy -71243.0093555
Pre-training layer 1, epoch 35, validation free energy -70745.1745703
Pre-training layer 1, epoch 36, cost -251.103884811
Pre-training layer 1, epoch 37, cost -250.777556
Pre-training layer 1, epoch 38, cost -250.457771683
Pre-training layer 1, epoch 39, cost -250.223778992
Pre-training layer 1, epoch 40, cost -250.032216644
Pre-training layer 1, epoch 40, representative training free energy -72016.5253594
Pre-training layer 1, epoch 40, validation free energy -71516.5845937
Pre-training layer 1, epoch 41, cost -249.648894653
Pre-training layer 1, epoch 42, cost -249.395745621
Pre-training layer 1, epoch 43, cost -249.176576614
Pre-training layer 1, epoch 44, cost -249.11134346
Pre-training layer 1, epoch 45, cost -248.810471802
Pre-training layer 1, epoch 45, representative training free energy -72812.8996016
Pre-training layer 1, epoch 45, validation free energy -72308.7569102
Pre-training layer 1, epoch 46, cost -248.606017761
Pre-training layer 1, epoch 47, cost -248.503562851
Pre-training layer 1, epoch 48, cost -248.235857391
Pre-training layer 1, epoch 49, cost -248.146208038
Pre-training layer 1, epoch 50, cost -247.897685699
Pre-training layer 1, epoch 50, representative training free energy -73571.6546133
Pre-training layer 1, epoch 50, validation free energy -73052.7640469
Pre-training layer 1, epoch 51, cost -247.651775742
Pre-training layer 1, epoch 52, cost -247.531502151
Pre-training layer 1, epoch 53, cost -247.457377701
Pre-training layer 1, epoch 54, cost -247.321138763
Pre-training layer 1, epoch 55, cost -247.174157486
Pre-training layer 1, epoch 55, representative training free energy -74156.9925898
Pre-training layer 1, epoch 55, validation free energy -73630.6771484
Pre-training layer 1, epoch 56, cost -246.943791275
Pre-training layer 1, epoch 57, cost -246.884592133
Pre-training layer 1, epoch 58, cost -246.73692688
Pre-training layer 1, epoch 59, cost -246.423102264
Pre-training layer 1, epoch 60, cost -246.395358505
Pre-training layer 1, epoch 60, representative training free energy -74737.6058047
Pre-training layer 1, epoch 60, validation free energy -74209.5688516
Pre-training layer 1, epoch 61, cost -246.184768753
Pre-training layer 1, epoch 62, cost -246.065951157
Pre-training layer 1, epoch 63, cost -245.974124069
Pre-training layer 1, epoch 64, cost -245.716541138
Pre-training layer 1, epoch 65, cost -245.683446045
Pre-training layer 1, epoch 65, representative training free energy -75259.3809219
Pre-training layer 1, epoch 65, validation free energy -74730.9647344
Pre-training layer 1, epoch 66, cost -245.522024994
Pre-training layer 1, epoch 67, cost -245.501025085
Pre-training layer 1, epoch 68, cost -245.45753418
Pre-training layer 1, epoch 69, cost -245.254532089
Pre-training layer 1, epoch 70, cost -245.296514664
Pre-training layer 1, epoch 70, representative training free energy -75754.3539492
Pre-training layer 1, epoch 70, validation free energy -75215.878582
Pre-training layer 1, epoch 71, cost -245.113283691
Pre-training layer 1, epoch 72, cost -245.057532654
Pre-training layer 1, epoch 73, cost -244.915213852
Pre-training layer 1, epoch 74, cost -244.794085236
Pre-training layer 1, epoch 75, cost -244.777650604
Pre-training layer 1, epoch 75, representative training free energy -76126.2508203
Pre-training layer 1, epoch 75, validation free energy -75587.7769063
Pre-training layer 1, epoch 76, cost -244.741669693
Pre-training layer 1, epoch 77, cost -244.476314163
Pre-training layer 1, epoch 78, cost -244.536476898
Pre-training layer 1, epoch 79, cost -244.343712463
Pre-training layer 1, epoch 80, cost -244.208297958
Pre-training layer 1, epoch 80, representative training free energy -76555.9817734
Pre-training layer 1, epoch 80, validation free energy -76014.8138008
Pre-training layer 1, epoch 81, cost -244.287586594
Pre-training layer 1, epoch 82, cost -244.152625504
Pre-training layer 1, epoch 83, cost -244.024066849
Pre-training layer 1, epoch 84, cost -243.985493469
Pre-training layer 1, epoch 85, cost -243.8661689
Pre-training layer 1, epoch 85, representative training free energy -76943.4888281
Pre-training layer 1, epoch 85, validation free energy -76399.2928359
Pre-training layer 1, epoch 86, cost -243.701734543
Pre-training layer 1, epoch 87, cost -243.668080292
Pre-training layer 1, epoch 88, cost -243.705796356
Pre-training layer 1, epoch 89, cost -243.479961548
Pre-training layer 1, epoch 90, cost -243.534624557
Pre-training layer 1, epoch 90, representative training free energy -77359.8487227
Pre-training layer 1, epoch 90, validation free energy -76812.3743828
Pre-training layer 1, epoch 91, cost -243.414619751
Pre-training layer 1, epoch 92, cost -243.23132103
Pre-training layer 1, epoch 93, cost -243.30123764
Pre-training layer 1, epoch 94, cost -243.352000732
Pre-training layer 1, epoch 95, cost -243.164473572
Pre-training layer 1, epoch 95, representative training free energy -77702.0699609
Pre-training layer 1, epoch 95, validation free energy -77153.8245352
Pre-training layer 1, epoch 96, cost -243.031591187
Pre-training layer 1, epoch 97, cost -243.081727829
Pre-training layer 1, epoch 98, cost -242.952869568
Pre-training layer 1, epoch 99, cost -242.803826294
Pre-training layer 2, epoch 0, cost -136.718191147
Pre-training layer 2, epoch 0, representative training free energy 2466.51821716
Pre-training layer 2, epoch 0, validation free energy 2455.86239453
Pre-training layer 2, epoch 1, cost -97.3761583328
Pre-training layer 2, epoch 2, cost -89.2122863579
Pre-training layer 2, epoch 3, cost -84.8043047333
Pre-training layer 2, epoch 4, cost -82.0596940804
Pre-training layer 2, epoch 5, cost -79.6692035675
Pre-training layer 2, epoch 5, representative training free energy 3663.96025293
Pre-training layer 2, epoch 5, validation free energy 3646.19386755
Pre-training layer 2, epoch 6, cost -77.981516304
Pre-training layer 2, epoch 7, cost -76.5023171043
Pre-training layer 2, epoch 8, cost -75.3814126205
Pre-training layer 2, epoch 9, cost -74.4089224052
Pre-training layer 2, epoch 10, cost -73.4630872917
Pre-training layer 2, epoch 10, representative training free energy 4211.12642529
Pre-training layer 2, epoch 10, validation free energy 4187.2332522
Pre-training layer 2, epoch 11, cost -72.673286438
Pre-training layer 2, epoch 12, cost -72.1258655548
Pre-training layer 2, epoch 13, cost -71.3970187187
Pre-training layer 2, epoch 14, cost -70.9090802956
Pre-training layer 2, epoch 15, cost -70.4512648392
Pre-training layer 2, epoch 15, representative training free energy 4662.16407544
Pre-training layer 2, epoch 15, validation free energy 4630.05766064
Pre-training layer 2, epoch 16, cost -70.0126882744
Pre-training layer 2, epoch 17, cost -69.5876979637
Pre-training layer 2, epoch 18, cost -69.197531929
Pre-training layer 2, epoch 19, cost -68.8671010017
Pre-training layer 2, epoch 20, cost -68.5573373795
Pre-training layer 2, epoch 20, representative training free energy 4994.76392529
Pre-training layer 2, epoch 20, validation free energy 4958.59545679
Pre-training layer 2, epoch 21, cost -68.3522945213
Pre-training layer 2, epoch 22, cost -67.9161546135
Pre-training layer 2, epoch 23, cost -67.6716703987
Pre-training layer 2, epoch 24, cost -67.3827741814
Pre-training layer 2, epoch 25, cost -67.1911360168
Pre-training layer 2, epoch 25, representative training free energy 5264.674521
Pre-training layer 2, epoch 25, validation free energy 5227.04666675
Pre-training layer 2, epoch 26, cost -66.9427155495
Pre-training layer 2, epoch 27, cost -66.8532629395
Pre-training layer 2, epoch 28, cost -66.6763378716
Pre-training layer 2, epoch 29, cost -66.4653645325
Pre-training layer 2, epoch 30, cost -66.3368488884
Pre-training layer 2, epoch 30, representative training free energy 5561.90545557
Pre-training layer 2, epoch 30, validation free energy 5519.67484033
Pre-training layer 2, epoch 31, cost -65.9760113525
Pre-training layer 2, epoch 32, cost -65.9358181572
Pre-training layer 2, epoch 33, cost -65.8687816429
Pre-training layer 2, epoch 34, cost -65.6558512497
Pre-training layer 2, epoch 35, cost -65.5227947044
Pre-training layer 2, epoch 35, representative training free energy 5801.0661106
Pre-training layer 2, epoch 35, validation free energy 5757.18262476
Pre-training layer 2, epoch 36, cost -65.3270777512
Pre-training layer 2, epoch 37, cost -65.2718874168
Pre-training layer 2, epoch 38, cost -65.3215855789
Pre-training layer 2, epoch 39, cost -64.9976104355
Pre-training layer 2, epoch 40, cost -64.9206082153
Pre-training layer 2, epoch 40, representative training free energy 6002.73398389
Pre-training layer 2, epoch 40, validation free energy 5956.66007666
Pre-training layer 2, epoch 41, cost -64.932159729
Pre-training layer 2, epoch 42, cost -64.6634950447
Pre-training layer 2, epoch 43, cost -64.6763094902
Pre-training layer 2, epoch 44, cost -64.5490992737
Pre-training layer 2, epoch 45, cost -64.3928883362
Pre-training layer 2, epoch 45, representative training free energy 6221.82150732
Pre-training layer 2, epoch 45, validation free energy 6172.11156006
Pre-training layer 2, epoch 46, cost -64.3688107109
Pre-training layer 2, epoch 47, cost -64.3063633537
Pre-training layer 2, epoch 48, cost -64.0943494987
Pre-training layer 2, epoch 49, cost -64.0004456902
Pre-training layer 2, epoch 50, cost -64.0158344841
Pre-training layer 2, epoch 50, representative training free energy 6419.72968921
Pre-training layer 2, epoch 50, validation free energy 6368.41580469
Pre-training layer 2, epoch 51, cost -63.9510371971
Pre-training layer 2, epoch 52, cost -64.0045643044
Pre-training layer 2, epoch 53, cost -63.8787190819
Pre-training layer 2, epoch 54, cost -63.7120964813
Pre-training layer 2, epoch 55, cost -63.7180379486
Pre-training layer 2, epoch 55, representative training free energy 6585.7827998
Pre-training layer 2, epoch 55, validation free energy 6534.29651611
Pre-training layer 2, epoch 56, cost -63.698693161
Pre-training layer 2, epoch 57, cost -63.6118522453
Pre-training layer 2, epoch 58, cost -63.4225058937
Pre-training layer 2, epoch 59, cost -63.5325188065
Pre-training layer 2, epoch 60, cost -63.2771273232
Pre-training layer 2, epoch 60, representative training free energy 6748.75412549
Pre-training layer 2, epoch 60, validation free energy 6695.83001221
Pre-training layer 2, epoch 61, cost -63.429068985
Pre-training layer 2, epoch 62, cost -63.310009346
Pre-training layer 2, epoch 63, cost -63.2222870636
Pre-training layer 2, epoch 64, cost -63.2215956116
Pre-training layer 2, epoch 65, cost -63.1050625229
Pre-training layer 2, epoch 65, representative training free energy 6904.20734131
Pre-training layer 2, epoch 65, validation free energy 6850.19911719
Pre-training layer 2, epoch 66, cost -63.1425301552
Pre-training layer 2, epoch 67, cost -62.9809185028
Pre-training layer 2, epoch 68, cost -63.073023262
Pre-training layer 2, epoch 69, cost -63.0250296783
Pre-training layer 2, epoch 70, cost -62.9693692589
Pre-training layer 2, epoch 70, representative training free energy 7062.06278613
Pre-training layer 2, epoch 70, validation free energy 7006.55819238
Pre-training layer 2, epoch 71, cost -62.9775559616
Pre-training layer 2, epoch 72, cost -62.9568272591
Pre-training layer 2, epoch 73, cost -62.8558328438
Pre-training layer 2, epoch 74, cost -62.7441786003
Pre-training layer 2, epoch 75, cost -62.7057236099
Pre-training layer 2, epoch 75, representative training free energy 7252.11741553
Pre-training layer 2, epoch 75, validation free energy 7192.93030176
Pre-training layer 2, epoch 76, cost -62.7898525429
Pre-training layer 2, epoch 77, cost -62.6819477081
Pre-training layer 2, epoch 78, cost -62.7139267731
Pre-training layer 2, epoch 79, cost -62.6119640732
Pre-training layer 2, epoch 80, cost -62.6389846992
Pre-training layer 2, epoch 80, representative training free energy 7375.10521875
Pre-training layer 2, epoch 80, validation free energy 7315.3876543
Pre-training layer 2, epoch 81, cost -62.6734895515
Pre-training layer 2, epoch 82, cost -62.6819098663
Pre-training layer 2, epoch 83, cost -62.4963058281
Pre-training layer 2, epoch 84, cost -62.5421492767
Pre-training layer 2, epoch 85, cost -62.3501096535
Pre-training layer 2, epoch 85, representative training free energy 7516.56989209
Pre-training layer 2, epoch 85, validation free energy 7453.86304346
Pre-training layer 2, epoch 86, cost -62.4360470963
Pre-training layer 2, epoch 87, cost -62.4181785774
Pre-training layer 2, epoch 88, cost -62.4011025238
Pre-training layer 2, epoch 89, cost -62.2947180557
Pre-training layer 2, epoch 90, cost -62.2224898148
Pre-training layer 2, epoch 90, representative training free energy 7653.41054443
Pre-training layer 2, epoch 90, validation free energy 7589.68419824
Pre-training layer 2, epoch 91, cost -62.1982304764
Pre-training layer 2, epoch 92, cost -62.2152655983
Pre-training layer 2, epoch 93, cost -62.1221551704
Pre-training layer 2, epoch 94, cost -62.1085108948
Pre-training layer 2, epoch 95, cost -62.1047881126
Pre-training layer 2, epoch 95, representative training free energy 7767.9086333
Pre-training layer 2, epoch 95, validation free energy 7704.10670459
Pre-training layer 2, epoch 96, cost -62.1799839592
Pre-training layer 2, epoch 97, cost -62.0018536949
Pre-training layer 2, epoch 98, cost -61.9989548874
Pre-training layer 2, epoch 99, cost -62.0293768501
The pretraining code for file dbn_loop.pyc ran for 5.42m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 35.000000 %
     epoch 1, minibatch 200/200, test error of best model 31.400000 %
epoch 2, minibatch 200/200, validation error 27.400000 %
     epoch 2, minibatch 200/200, test error of best model 19.600000 %
epoch 3, minibatch 200/200, validation error 24.400000 %
     epoch 3, minibatch 200/200, test error of best model 14.400000 %
epoch 4, minibatch 200/200, validation error 22.800000 %
     epoch 4, minibatch 200/200, test error of best model 13.400000 %
epoch 5, minibatch 200/200, validation error 22.000000 %
     epoch 5, minibatch 200/200, test error of best model 11.800000 %
epoch 6, minibatch 200/200, validation error 21.400000 %
     epoch 6, minibatch 200/200, test error of best model 11.000000 %
epoch 7, minibatch 200/200, validation error 21.200000 %
     epoch 7, minibatch 200/200, test error of best model 9.800000 %
epoch 8, minibatch 200/200, validation error 21.200000 %
epoch 9, minibatch 200/200, validation error 20.800000 %
     epoch 9, minibatch 200/200, test error of best model 8.600000 %
epoch 10, minibatch 200/200, validation error 19.800000 %
     epoch 10, minibatch 200/200, test error of best model 8.000000 %
epoch 11, minibatch 200/200, validation error 19.600000 %
     epoch 11, minibatch 200/200, test error of best model 8.000000 %
epoch 12, minibatch 200/200, validation error 19.400000 %
     epoch 12, minibatch 200/200, test error of best model 7.600000 %
epoch 13, minibatch 200/200, validation error 19.200000 %
     epoch 13, minibatch 200/200, test error of best model 7.400000 %
epoch 14, minibatch 200/200, validation error 18.800000 %
     epoch 14, minibatch 200/200, test error of best model 7.200000 %
epoch 15, minibatch 200/200, validation error 18.600000 %
     epoch 15, minibatch 200/200, test error of best model 7.000000 %
epoch 16, minibatch 200/200, validation error 18.200000 %
     epoch 16, minibatch 200/200, test error of best model 7.000000 %
epoch 17, minibatch 200/200, validation error 18.000000 %
     epoch 17, minibatch 200/200, test error of best model 6.600000 %
epoch 18, minibatch 200/200, validation error 18.000000 %
epoch 19, minibatch 200/200, validation error 17.800000 %
     epoch 19, minibatch 200/200, test error of best model 6.600000 %
epoch 20, minibatch 200/200, validation error 17.600000 %
     epoch 20, minibatch 200/200, test error of best model 7.000000 %
epoch 21, minibatch 200/200, validation error 17.800000 %
epoch 22, minibatch 200/200, validation error 17.800000 %
epoch 23, minibatch 200/200, validation error 17.800000 %
epoch 24, minibatch 200/200, validation error 17.800000 %
epoch 25, minibatch 200/200, validation error 17.600000 %
epoch 26, minibatch 200/200, validation error 17.600000 %
epoch 27, minibatch 200/200, validation error 17.600000 %
epoch 28, minibatch 200/200, validation error 17.600000 %
epoch 29, minibatch 200/200, validation error 17.400000 %
     epoch 29, minibatch 200/200, test error of best model 6.800000 %
epoch 30, minibatch 200/200, validation error 17.400000 %
epoch 31, minibatch 200/200, validation error 17.200000 %
     epoch 31, minibatch 200/200, test error of best model 6.800000 %
epoch 32, minibatch 200/200, validation error 17.000000 %
     epoch 32, minibatch 200/200, test error of best model 6.800000 %
epoch 33, minibatch 200/200, validation error 17.000000 %
epoch 34, minibatch 200/200, validation error 16.800000 %
     epoch 34, minibatch 200/200, test error of best model 6.800000 %
epoch 35, minibatch 200/200, validation error 16.800000 %
epoch 36, minibatch 200/200, validation error 16.800000 %
epoch 37, minibatch 200/200, validation error 16.800000 %
epoch 38, minibatch 200/200, validation error 16.800000 %
epoch 39, minibatch 200/200, validation error 16.800000 %
epoch 40, minibatch 200/200, validation error 16.800000 %
epoch 41, minibatch 200/200, validation error 16.800000 %
epoch 42, minibatch 200/200, validation error 16.800000 %
epoch 43, minibatch 200/200, validation error 16.800000 %
epoch 44, minibatch 200/200, validation error 16.800000 %
epoch 45, minibatch 200/200, validation error 16.800000 %
epoch 46, minibatch 200/200, validation error 17.000000 %
epoch 47, minibatch 200/200, validation error 17.000000 %
epoch 48, minibatch 200/200, validation error 17.000000 %
epoch 49, minibatch 200/200, validation error 17.000000 %
epoch 50, minibatch 200/200, validation error 17.000000 %
epoch 51, minibatch 200/200, validation error 17.000000 %
epoch 52, minibatch 200/200, validation error 17.000000 %
epoch 53, minibatch 200/200, validation error 17.000000 %
epoch 54, minibatch 200/200, validation error 17.000000 %
epoch 55, minibatch 200/200, validation error 17.000000 %
epoch 56, minibatch 200/200, validation error 17.000000 %
epoch 57, minibatch 200/200, validation error 17.000000 %
epoch 58, minibatch 200/200, validation error 17.000000 %
epoch 59, minibatch 200/200, validation error 17.000000 %
epoch 60, minibatch 200/200, validation error 17.000000 %
epoch 61, minibatch 200/200, validation error 17.000000 %
epoch 62, minibatch 200/200, validation error 17.000000 %
epoch 63, minibatch 200/200, validation error 17.000000 %
epoch 64, minibatch 200/200, validation error 17.000000 %
epoch 65, minibatch 200/200, validation error 17.000000 %
epoch 66, minibatch 200/200, validation error 17.000000 %
epoch 67, minibatch 200/200, validation error 17.000000 %
Optimization complete with best validation score of 16.800000 %, obtained at iteration 6800, with test performance 6.800000 %
The fine tuning code for file dbn_loop.pyc ran for 1.25m


==========Sample: (3000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.871839828
Pre-training layer 0, epoch 0, representative training free energy -560.863254089
Pre-training layer 0, epoch 0, validation free energy -554.96358313
Pre-training layer 0, epoch 1, cost -116.668319524
Pre-training layer 0, epoch 2, cost -108.05019371
Pre-training layer 0, epoch 3, cost -102.692484055
Pre-training layer 0, epoch 4, cost -99.0539503988
Pre-training layer 0, epoch 5, cost -96.5605050151
Pre-training layer 0, epoch 5, representative training free energy -501.729838989
Pre-training layer 0, epoch 5, validation free energy -492.99954541
Pre-training layer 0, epoch 6, cost -94.5517350769
Pre-training layer 0, epoch 7, cost -92.6706170146
Pre-training layer 0, epoch 8, cost -91.4635187276
Pre-training layer 0, epoch 9, cost -90.1140612793
Pre-training layer 0, epoch 10, cost -89.0870532227
Pre-training layer 0, epoch 10, representative training free energy -479.702977783
Pre-training layer 0, epoch 10, validation free energy -470.769453003
Pre-training layer 0, epoch 11, cost -88.1247325643
Pre-training layer 0, epoch 12, cost -87.3876913198
Pre-training layer 0, epoch 13, cost -86.6716420492
Pre-training layer 0, epoch 14, cost -86.0117345174
Pre-training layer 0, epoch 15, cost -85.4115293376
Pre-training layer 0, epoch 15, representative training free energy -467.671494568
Pre-training layer 0, epoch 15, validation free energy -458.387404114
Pre-training layer 0, epoch 16, cost -84.8936933263
Pre-training layer 0, epoch 17, cost -84.373200798
Pre-training layer 0, epoch 18, cost -83.8080330912
Pre-training layer 0, epoch 19, cost -83.4071973546
Pre-training layer 0, epoch 20, cost -82.993083636
Pre-training layer 0, epoch 20, representative training free energy -459.719790527
Pre-training layer 0, epoch 20, validation free energy -450.406427002
Pre-training layer 0, epoch 21, cost -82.6546844737
Pre-training layer 0, epoch 22, cost -82.3658608246
Pre-training layer 0, epoch 23, cost -81.8680433019
Pre-training layer 0, epoch 24, cost -81.6776732254
Pre-training layer 0, epoch 25, cost -81.3317359289
Pre-training layer 0, epoch 25, representative training free energy -452.623468689
Pre-training layer 0, epoch 25, validation free energy -443.072854919
Pre-training layer 0, epoch 26, cost -81.1862374369
Pre-training layer 0, epoch 27, cost -80.9778982544
Pre-training layer 0, epoch 28, cost -80.5028172302
Pre-training layer 0, epoch 29, cost -80.3663539632
Pre-training layer 0, epoch 30, cost -80.0099632645
Pre-training layer 0, epoch 30, representative training free energy -452.939861328
Pre-training layer 0, epoch 30, validation free energy -443.044912903
Pre-training layer 0, epoch 31, cost -79.9195870845
Pre-training layer 0, epoch 32, cost -79.670149587
Pre-training layer 0, epoch 33, cost -79.4468055471
Pre-training layer 0, epoch 34, cost -79.1727110163
Pre-training layer 0, epoch 35, cost -79.0626506297
Pre-training layer 0, epoch 35, representative training free energy -445.023371948
Pre-training layer 0, epoch 35, validation free energy -434.627447632
Pre-training layer 0, epoch 36, cost -78.9373109182
Pre-training layer 0, epoch 37, cost -78.868571434
Pre-training layer 0, epoch 38, cost -78.4797531255
Pre-training layer 0, epoch 39, cost -78.2933221817
Pre-training layer 0, epoch 40, cost -78.0600908152
Pre-training layer 0, epoch 40, representative training free energy -446.508338745
Pre-training layer 0, epoch 40, validation free energy -435.737058044
Pre-training layer 0, epoch 41, cost -77.9813593419
Pre-training layer 0, epoch 42, cost -77.9261273193
Pre-training layer 0, epoch 43, cost -77.696672554
Pre-training layer 0, epoch 44, cost -77.6345973969
Pre-training layer 0, epoch 45, cost -77.5981293869
Pre-training layer 0, epoch 45, representative training free energy -442.124552368
Pre-training layer 0, epoch 45, validation free energy -431.482358826
Pre-training layer 0, epoch 46, cost -77.2904634094
Pre-training layer 0, epoch 47, cost -77.0832101568
Pre-training layer 0, epoch 48, cost -77.131306076
Pre-training layer 0, epoch 49, cost -77.0473777644
Pre-training layer 0, epoch 50, cost -76.8605568441
Pre-training layer 0, epoch 50, representative training free energy -439.810098267
Pre-training layer 0, epoch 50, validation free energy -429.542058228
Pre-training layer 0, epoch 51, cost -76.7932024892
Pre-training layer 0, epoch 52, cost -76.5296538289
Pre-training layer 0, epoch 53, cost -76.5937862015
Pre-training layer 0, epoch 54, cost -76.3883238602
Pre-training layer 0, epoch 55, cost -76.3815410741
Pre-training layer 0, epoch 55, representative training free energy -439.870872131
Pre-training layer 0, epoch 55, validation free energy -428.593323181
Pre-training layer 0, epoch 56, cost -76.1764626821
Pre-training layer 0, epoch 57, cost -76.1303647614
Pre-training layer 0, epoch 58, cost -76.1372949473
Pre-training layer 0, epoch 59, cost -75.9889851252
Pre-training layer 0, epoch 60, cost -75.8422603353
Pre-training layer 0, epoch 60, representative training free energy -438.564095154
Pre-training layer 0, epoch 60, validation free energy -427.722397034
Pre-training layer 0, epoch 61, cost -75.6689357249
Pre-training layer 0, epoch 62, cost -75.7602262243
Pre-training layer 0, epoch 63, cost -75.62662721
Pre-training layer 0, epoch 64, cost -75.4587858582
Pre-training layer 0, epoch 65, cost -75.3908399582
Pre-training layer 0, epoch 65, representative training free energy -437.728890442
Pre-training layer 0, epoch 65, validation free energy -425.959286438
Pre-training layer 0, epoch 66, cost -75.461075058
Pre-training layer 0, epoch 67, cost -75.2998784256
Pre-training layer 0, epoch 68, cost -75.2455536143
Pre-training layer 0, epoch 69, cost -75.1128053029
Pre-training layer 0, epoch 70, cost -75.0008477656
Pre-training layer 0, epoch 70, representative training free energy -435.225627808
Pre-training layer 0, epoch 70, validation free energy -423.728859619
Pre-training layer 0, epoch 71, cost -74.8300804011
Pre-training layer 0, epoch 72, cost -74.84061807
Pre-training layer 0, epoch 73, cost -74.6944937642
Pre-training layer 0, epoch 74, cost -74.7148177592
Pre-training layer 0, epoch 75, cost -74.7199699275
Pre-training layer 0, epoch 75, representative training free energy -435.057526611
Pre-training layer 0, epoch 75, validation free energy -423.047640564
Pre-training layer 0, epoch 76, cost -74.5583923086
Pre-training layer 0, epoch 77, cost -74.5947388585
Pre-training layer 0, epoch 78, cost -74.3799255117
Pre-training layer 0, epoch 79, cost -74.3721309916
Pre-training layer 0, epoch 80, cost -74.190686264
Pre-training layer 0, epoch 80, representative training free energy -437.540116638
Pre-training layer 0, epoch 80, validation free energy -425.591822815
Pre-training layer 0, epoch 81, cost -74.164914856
Pre-training layer 0, epoch 82, cost -74.1732469432
Pre-training layer 0, epoch 83, cost -74.0911684163
Pre-training layer 0, epoch 84, cost -74.07368234
Pre-training layer 0, epoch 85, cost -74.0627444077
Pre-training layer 0, epoch 85, representative training free energy -435.422736328
Pre-training layer 0, epoch 85, validation free energy -423.159115662
Pre-training layer 0, epoch 86, cost -73.9609445953
Pre-training layer 0, epoch 87, cost -73.8612106578
Pre-training layer 0, epoch 88, cost -73.8905742137
Pre-training layer 0, epoch 89, cost -73.8493850327
Pre-training layer 0, epoch 90, cost -73.7808909734
Pre-training layer 0, epoch 90, representative training free energy -431.923533447
Pre-training layer 0, epoch 90, validation free energy -419.489703918
Pre-training layer 0, epoch 91, cost -73.6814617538
Pre-training layer 0, epoch 92, cost -73.5368652344
Pre-training layer 0, epoch 93, cost -73.6128727595
Pre-training layer 0, epoch 94, cost -73.4361785253
Pre-training layer 0, epoch 95, cost -73.517444191
Pre-training layer 0, epoch 95, representative training free energy -433.155396851
Pre-training layer 0, epoch 95, validation free energy -420.604727356
Pre-training layer 0, epoch 96, cost -73.3229640325
Pre-training layer 0, epoch 97, cost -73.2905397288
Pre-training layer 0, epoch 98, cost -73.2933910878
Pre-training layer 0, epoch 99, cost -73.280675354
Pre-training layer 1, epoch 0, cost -345.441945038
Pre-training layer 1, epoch 0, representative training free energy -50379.2196914
Pre-training layer 1, epoch 0, validation free energy -49936.7610273
Pre-training layer 1, epoch 1, cost -296.37853714
Pre-training layer 1, epoch 2, cost -281.529073537
Pre-training layer 1, epoch 3, cost -272.704695841
Pre-training layer 1, epoch 4, cost -266.518073629
Pre-training layer 1, epoch 5, cost -261.918801626
Pre-training layer 1, epoch 5, representative training free energy -68289.9828828
Pre-training layer 1, epoch 5, validation free energy -67715.6085586
Pre-training layer 1, epoch 6, cost -258.302559153
Pre-training layer 1, epoch 7, cost -255.436742605
Pre-training layer 1, epoch 8, cost -252.987692159
Pre-training layer 1, epoch 9, cost -250.765960693
Pre-training layer 1, epoch 10, cost -249.132680308
Pre-training layer 1, epoch 10, representative training free energy -73657.3639336
Pre-training layer 1, epoch 10, validation free energy -73041.8397969
Pre-training layer 1, epoch 11, cost -247.481590729
Pre-training layer 1, epoch 12, cost -246.299506175
Pre-training layer 1, epoch 13, cost -245.046260274
Pre-training layer 1, epoch 14, cost -243.984083964
Pre-training layer 1, epoch 15, cost -243.046318461
Pre-training layer 1, epoch 15, representative training free energy -76796.2307422
Pre-training layer 1, epoch 15, validation free energy -76161.6153867
Pre-training layer 1, epoch 16, cost -242.142738647
Pre-training layer 1, epoch 17, cost -241.457920481
Pre-training layer 1, epoch 18, cost -240.653713989
Pre-training layer 1, epoch 19, cost -240.046421102
Pre-training layer 1, epoch 20, cost -239.476333669
Pre-training layer 1, epoch 20, representative training free energy -78996.1890547
Pre-training layer 1, epoch 20, validation free energy -78339.6858672
Pre-training layer 1, epoch 21, cost -238.790445099
Pre-training layer 1, epoch 22, cost -238.3114033
Pre-training layer 1, epoch 23, cost -237.885587362
Pre-training layer 1, epoch 24, cost -237.290200958
Pre-training layer 1, epoch 25, cost -237.037892202
Pre-training layer 1, epoch 25, representative training free energy -80705.1397383
Pre-training layer 1, epoch 25, validation free energy -80030.7911484
Pre-training layer 1, epoch 26, cost -236.561467997
Pre-training layer 1, epoch 27, cost -236.257463582
Pre-training layer 1, epoch 28, cost -235.851335653
Pre-training layer 1, epoch 29, cost -235.402239889
Pre-training layer 1, epoch 30, cost -235.117304026
Pre-training layer 1, epoch 30, representative training free energy -82168.7505547
Pre-training layer 1, epoch 30, validation free energy -81487.8959297
Pre-training layer 1, epoch 31, cost -234.84964152
Pre-training layer 1, epoch 32, cost -234.575304515
Pre-training layer 1, epoch 33, cost -234.123432872
Pre-training layer 1, epoch 34, cost -234.000606944
Pre-training layer 1, epoch 35, cost -233.736513418
Pre-training layer 1, epoch 35, representative training free energy -83316.741418
Pre-training layer 1, epoch 35, validation free energy -82625.3739648
Pre-training layer 1, epoch 36, cost -233.410009511
Pre-training layer 1, epoch 37, cost -233.314676971
Pre-training layer 1, epoch 38, cost -233.058319346
Pre-training layer 1, epoch 39, cost -232.870125885
Pre-training layer 1, epoch 40, cost -232.562619019
Pre-training layer 1, epoch 40, representative training free energy -84348.1064297
Pre-training layer 1, epoch 40, validation free energy -83644.0037109
Pre-training layer 1, epoch 41, cost -232.373966827
Pre-training layer 1, epoch 42, cost -232.250984192
Pre-training layer 1, epoch 43, cost -232.045378927
Pre-training layer 1, epoch 44, cost -231.922722931
Pre-training layer 1, epoch 45, cost -231.715950673
Pre-training layer 1, epoch 45, representative training free energy -85295.3404961
Pre-training layer 1, epoch 45, validation free energy -84584.18975
Pre-training layer 1, epoch 46, cost -231.515281474
Pre-training layer 1, epoch 47, cost -231.438654175
Pre-training layer 1, epoch 48, cost -231.34109024
Pre-training layer 1, epoch 49, cost -231.025713755
Pre-training layer 1, epoch 50, cost -230.833536174
Pre-training layer 1, epoch 50, representative training free energy -86111.3139492
Pre-training layer 1, epoch 50, validation free energy -85389.1254883
Pre-training layer 1, epoch 51, cost -230.699751231
Pre-training layer 1, epoch 52, cost -230.599728597
Pre-training layer 1, epoch 53, cost -230.402712199
Pre-training layer 1, epoch 54, cost -230.241699473
Pre-training layer 1, epoch 55, cost -230.236980845
Pre-training layer 1, epoch 55, representative training free energy -86862.8778594
Pre-training layer 1, epoch 55, validation free energy -86138.1945898
Pre-training layer 1, epoch 56, cost -230.111696269
Pre-training layer 1, epoch 57, cost -229.90411677
Pre-training layer 1, epoch 58, cost -229.89765686
Pre-training layer 1, epoch 59, cost -229.816993612
Pre-training layer 1, epoch 60, cost -229.563568319
Pre-training layer 1, epoch 60, representative training free energy -87557.8541875
Pre-training layer 1, epoch 60, validation free energy -86824.1253711
Pre-training layer 1, epoch 61, cost -229.435776876
Pre-training layer 1, epoch 62, cost -229.441338094
Pre-training layer 1, epoch 63, cost -229.29029719
Pre-training layer 1, epoch 64, cost -229.087363485
Pre-training layer 1, epoch 65, cost -229.058044434
Pre-training layer 1, epoch 65, representative training free energy -88191.3216211
Pre-training layer 1, epoch 65, validation free energy -87450.8040938
Pre-training layer 1, epoch 66, cost -228.911619059
Pre-training layer 1, epoch 67, cost -228.711766764
Pre-training layer 1, epoch 68, cost -228.704473419
Pre-training layer 1, epoch 69, cost -228.666240489
Pre-training layer 1, epoch 70, cost -228.601254171
Pre-training layer 1, epoch 70, representative training free energy -88783.0529336
Pre-training layer 1, epoch 70, validation free energy -88037.4539648
Pre-training layer 1, epoch 71, cost -228.49274704
Pre-training layer 1, epoch 72, cost -228.36518926
Pre-training layer 1, epoch 73, cost -228.35659434
Pre-training layer 1, epoch 74, cost -228.236307322
Pre-training layer 1, epoch 75, cost -228.256149546
Pre-training layer 1, epoch 75, representative training free energy -89390.3207773
Pre-training layer 1, epoch 75, validation free energy -88643.3806641
Pre-training layer 1, epoch 76, cost -228.099804942
Pre-training layer 1, epoch 77, cost -227.952678731
Pre-training layer 1, epoch 78, cost -227.954832509
Pre-training layer 1, epoch 79, cost -227.918911896
Pre-training layer 1, epoch 80, cost -227.670774689
Pre-training layer 1, epoch 80, representative training free energy -89891.5558594
Pre-training layer 1, epoch 80, validation free energy -89136.8029023
Pre-training layer 1, epoch 81, cost -227.702394969
Pre-training layer 1, epoch 82, cost -227.582419484
Pre-training layer 1, epoch 83, cost -227.485101471
Pre-training layer 1, epoch 84, cost -227.440334574
Pre-training layer 1, epoch 85, cost -227.272989095
Pre-training layer 1, epoch 85, representative training free energy -90301.5032109
Pre-training layer 1, epoch 85, validation free energy -89542.5528945
Pre-training layer 1, epoch 86, cost -227.32620519
Pre-training layer 1, epoch 87, cost -227.27120931
Pre-training layer 1, epoch 88, cost -227.236334381
Pre-training layer 1, epoch 89, cost -227.098151093
Pre-training layer 1, epoch 90, cost -227.060408122
Pre-training layer 1, epoch 90, representative training free energy -90811.1884258
Pre-training layer 1, epoch 90, validation free energy -90045.5316914
Pre-training layer 1, epoch 91, cost -227.012234599
Pre-training layer 1, epoch 92, cost -226.932031148
Pre-training layer 1, epoch 93, cost -226.973432719
Pre-training layer 1, epoch 94, cost -226.905480499
Pre-training layer 1, epoch 95, cost -226.741577606
Pre-training layer 1, epoch 95, representative training free energy -91286.9957813
Pre-training layer 1, epoch 95, validation free energy -90521.9337891
Pre-training layer 1, epoch 96, cost -226.818522644
Pre-training layer 1, epoch 97, cost -226.55847229
Pre-training layer 1, epoch 98, cost -226.515849965
Pre-training layer 1, epoch 99, cost -226.51962148
Pre-training layer 2, epoch 0, cost -126.852573929
Pre-training layer 2, epoch 0, representative training free energy 2944.13741357
Pre-training layer 2, epoch 0, validation free energy 2903.8381532
Pre-training layer 2, epoch 1, cost -92.8825401052
Pre-training layer 2, epoch 2, cost -85.7634940338
Pre-training layer 2, epoch 3, cost -81.6201323573
Pre-training layer 2, epoch 4, cost -79.0801394399
Pre-training layer 2, epoch 5, cost -76.9790560277
Pre-training layer 2, epoch 5, representative training free energy 4496.28245789
Pre-training layer 2, epoch 5, validation free energy 4470.05485535
Pre-training layer 2, epoch 6, cost -75.2411984253
Pre-training layer 2, epoch 7, cost -74.1725815074
Pre-training layer 2, epoch 8, cost -72.9806152344
Pre-training layer 2, epoch 9, cost -72.2372148895
Pre-training layer 2, epoch 10, cost -71.3059653854
Pre-training layer 2, epoch 10, representative training free energy 5356.25205151
Pre-training layer 2, epoch 10, validation free energy 5315.90408569
Pre-training layer 2, epoch 11, cost -70.7396196365
Pre-training layer 2, epoch 12, cost -70.0361699422
Pre-training layer 2, epoch 13, cost -69.5877297846
Pre-training layer 2, epoch 14, cost -69.2198291651
Pre-training layer 2, epoch 15, cost -68.7632425054
Pre-training layer 2, epoch 15, representative training free energy 6006.91362256
Pre-training layer 2, epoch 15, validation free energy 5952.80711255
Pre-training layer 2, epoch 16, cost -68.2742586899
Pre-training layer 2, epoch 17, cost -67.8714053345
Pre-training layer 2, epoch 18, cost -67.6057783635
Pre-training layer 2, epoch 19, cost -67.2780810165
Pre-training layer 2, epoch 20, cost -67.1034664027
Pre-training layer 2, epoch 20, representative training free energy 6499.42049292
Pre-training layer 2, epoch 20, validation free energy 6440.0332168
Pre-training layer 2, epoch 21, cost -66.8015713374
Pre-training layer 2, epoch 22, cost -66.6082188416
Pre-training layer 2, epoch 23, cost -66.4917257563
Pre-training layer 2, epoch 24, cost -66.1002361043
Pre-training layer 2, epoch 25, cost -66.0811434428
Pre-training layer 2, epoch 25, representative training free energy 6973.28960303
Pre-training layer 2, epoch 25, validation free energy 6910.21787842
Pre-training layer 2, epoch 26, cost -65.8171804047
Pre-training layer 2, epoch 27, cost -65.6989804967
Pre-training layer 2, epoch 28, cost -65.4929829407
Pre-training layer 2, epoch 29, cost -65.251345431
Pre-training layer 2, epoch 30, cost -65.1697190603
Pre-training layer 2, epoch 30, representative training free energy 7399.16993555
Pre-training layer 2, epoch 30, validation free energy 7333.67042725
Pre-training layer 2, epoch 31, cost -65.0537215551
Pre-training layer 2, epoch 32, cost -64.9415252177
Pre-training layer 2, epoch 33, cost -64.7999028905
Pre-training layer 2, epoch 34, cost -64.6745452372
Pre-training layer 2, epoch 35, cost -64.5131156794
Pre-training layer 2, epoch 35, representative training free energy 7731.80546924
Pre-training layer 2, epoch 35, validation free energy 7662.22872705
Pre-training layer 2, epoch 36, cost -64.4398462423
Pre-training layer 2, epoch 37, cost -64.3324570974
Pre-training layer 2, epoch 38, cost -64.3179119619
Pre-training layer 2, epoch 39, cost -64.2576636378
Pre-training layer 2, epoch 40, cost -64.0652321625
Pre-training layer 2, epoch 40, representative training free energy 8037.27884277
Pre-training layer 2, epoch 40, validation free energy 7964.16813916
Pre-training layer 2, epoch 41, cost -63.9720212809
Pre-training layer 2, epoch 42, cost -63.8748895391
Pre-training layer 2, epoch 43, cost -63.8500792821
Pre-training layer 2, epoch 44, cost -63.7300316366
Pre-training layer 2, epoch 45, cost -63.7389450963
Pre-training layer 2, epoch 45, representative training free energy 8325.92029736
Pre-training layer 2, epoch 45, validation free energy 8250.49634961
Pre-training layer 2, epoch 46, cost -63.5750989532
Pre-training layer 2, epoch 47, cost -63.517759374
Pre-training layer 2, epoch 48, cost -63.4853140132
Pre-training layer 2, epoch 49, cost -63.3817753855
Pre-training layer 2, epoch 50, cost -63.3043984858
Pre-training layer 2, epoch 50, representative training free energy 8626.4281084
Pre-training layer 2, epoch 50, validation free energy 8547.29353076
Pre-training layer 2, epoch 51, cost -63.2949530029
Pre-training layer 2, epoch 52, cost -63.2890203222
Pre-training layer 2, epoch 53, cost -63.1536710103
Pre-training layer 2, epoch 54, cost -63.2136166128
Pre-training layer 2, epoch 55, cost -63.0093672307
Pre-training layer 2, epoch 55, representative training free energy 8886.93478662
Pre-training layer 2, epoch 55, validation free energy 8805.37955713
Pre-training layer 2, epoch 56, cost -63.0648994191
Pre-training layer 2, epoch 57, cost -63.0493021139
Pre-training layer 2, epoch 58, cost -62.9775663122
Pre-training layer 2, epoch 59, cost -62.8455072403
Pre-training layer 2, epoch 60, cost -62.7564611689
Pre-training layer 2, epoch 60, representative training free energy 9149.23460547
Pre-training layer 2, epoch 60, validation free energy 9064.89285449
Pre-training layer 2, epoch 61, cost -62.8344390106
Pre-training layer 2, epoch 62, cost -62.8264335124
Pre-training layer 2, epoch 63, cost -62.7282579295
Pre-training layer 2, epoch 64, cost -62.5780184428
Pre-training layer 2, epoch 65, cost -62.5344137446
Pre-training layer 2, epoch 65, representative training free energy 9393.84346094
Pre-training layer 2, epoch 65, validation free energy 9306.84787451
Pre-training layer 2, epoch 66, cost -62.5746562831
Pre-training layer 2, epoch 67, cost -62.5392326736
Pre-training layer 2, epoch 68, cost -62.4232976151
Pre-training layer 2, epoch 69, cost -62.4765034866
Pre-training layer 2, epoch 70, cost -62.3642139435
Pre-training layer 2, epoch 70, representative training free energy 9621.64942432
Pre-training layer 2, epoch 70, validation free energy 9532.67647461
Pre-training layer 2, epoch 71, cost -62.2963154093
Pre-training layer 2, epoch 72, cost -62.3890400696
Pre-training layer 2, epoch 73, cost -62.2855529149
Pre-training layer 2, epoch 74, cost -62.3494870504
Pre-training layer 2, epoch 75, cost -62.3023538589
Pre-training layer 2, epoch 75, representative training free energy 9831.72647412
Pre-training layer 2, epoch 75, validation free energy 9740.4967876
Pre-training layer 2, epoch 76, cost -62.1750941722
Pre-training layer 2, epoch 77, cost -62.0873727671
Pre-training layer 2, epoch 78, cost -62.0457663472
Pre-training layer 2, epoch 79, cost -62.0366765849
Pre-training layer 2, epoch 80, cost -62.1051550674
Pre-training layer 2, epoch 80, representative training free energy 10058.6591104
Pre-training layer 2, epoch 80, validation free energy 9964.11118164
Pre-training layer 2, epoch 81, cost -61.9126466878
Pre-training layer 2, epoch 82, cost -62.0369917425
Pre-training layer 2, epoch 83, cost -61.9116109848
Pre-training layer 2, epoch 84, cost -62.0333513387
Pre-training layer 2, epoch 85, cost -61.9324977875
Pre-training layer 2, epoch 85, representative training free energy 10280.7314609
Pre-training layer 2, epoch 85, validation free energy 10185.1940039
Pre-training layer 2, epoch 86, cost -61.9108802923
Pre-training layer 2, epoch 87, cost -61.8329211553
Pre-training layer 2, epoch 88, cost -61.77740846
Pre-training layer 2, epoch 89, cost -61.8097351456
Pre-training layer 2, epoch 90, cost -61.7315360387
Pre-training layer 2, epoch 90, representative training free energy 10456.7182183
Pre-training layer 2, epoch 90, validation free energy 10359.1854849
Pre-training layer 2, epoch 91, cost -61.8269722112
Pre-training layer 2, epoch 92, cost -61.5981114578
Pre-training layer 2, epoch 93, cost -61.7477924728
Pre-training layer 2, epoch 94, cost -61.6449162547
Pre-training layer 2, epoch 95, cost -61.5712507757
Pre-training layer 2, epoch 95, representative training free energy 10694.7670859
Pre-training layer 2, epoch 95, validation free energy 10594.1631533
Pre-training layer 2, epoch 96, cost -61.6201070658
Pre-training layer 2, epoch 97, cost -61.5454577255
Pre-training layer 2, epoch 98, cost -61.5690453466
Pre-training layer 2, epoch 99, cost -61.5857725525
The pretraining code for file dbn_loop.pyc ran for 8.00m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 36.000000 %
     epoch 1, minibatch 300/300, test error of best model 32.400000 %
epoch 2, minibatch 300/300, validation error 28.800000 %
     epoch 2, minibatch 300/300, test error of best model 22.600000 %
epoch 3, minibatch 300/300, validation error 26.000000 %
     epoch 3, minibatch 300/300, test error of best model 19.000000 %
epoch 4, minibatch 300/300, validation error 24.600000 %
     epoch 4, minibatch 300/300, test error of best model 15.400000 %
epoch 5, minibatch 300/300, validation error 23.600000 %
     epoch 5, minibatch 300/300, test error of best model 14.000000 %
epoch 6, minibatch 300/300, validation error 22.800000 %
     epoch 6, minibatch 300/300, test error of best model 12.200000 %
epoch 7, minibatch 300/300, validation error 22.200000 %
     epoch 7, minibatch 300/300, test error of best model 11.400000 %
epoch 8, minibatch 300/300, validation error 21.200000 %
     epoch 8, minibatch 300/300, test error of best model 10.400000 %
epoch 9, minibatch 300/300, validation error 20.600000 %
     epoch 9, minibatch 300/300, test error of best model 10.000000 %
epoch 10, minibatch 300/300, validation error 20.600000 %
epoch 11, minibatch 300/300, validation error 20.200000 %
     epoch 11, minibatch 300/300, test error of best model 9.200000 %
epoch 12, minibatch 300/300, validation error 19.800000 %
     epoch 12, minibatch 300/300, test error of best model 8.200000 %
epoch 13, minibatch 300/300, validation error 19.400000 %
     epoch 13, minibatch 300/300, test error of best model 8.200000 %
epoch 14, minibatch 300/300, validation error 18.600000 %
     epoch 14, minibatch 300/300, test error of best model 8.200000 %
epoch 15, minibatch 300/300, validation error 18.600000 %
epoch 16, minibatch 300/300, validation error 18.200000 %
     epoch 16, minibatch 300/300, test error of best model 7.600000 %
epoch 17, minibatch 300/300, validation error 18.000000 %
     epoch 17, minibatch 300/300, test error of best model 7.400000 %
epoch 18, minibatch 300/300, validation error 17.800000 %
     epoch 18, minibatch 300/300, test error of best model 7.600000 %
epoch 19, minibatch 300/300, validation error 17.600000 %
     epoch 19, minibatch 300/300, test error of best model 7.600000 %
epoch 20, minibatch 300/300, validation error 18.200000 %
epoch 21, minibatch 300/300, validation error 18.000000 %
epoch 22, minibatch 300/300, validation error 18.000000 %
epoch 23, minibatch 300/300, validation error 17.800000 %
epoch 24, minibatch 300/300, validation error 17.800000 %
epoch 25, minibatch 300/300, validation error 17.800000 %
epoch 26, minibatch 300/300, validation error 17.600000 %
     epoch 26, minibatch 300/300, test error of best model 7.200000 %
epoch 27, minibatch 300/300, validation error 17.600000 %
epoch 28, minibatch 300/300, validation error 17.400000 %
     epoch 28, minibatch 300/300, test error of best model 7.000000 %
epoch 29, minibatch 300/300, validation error 17.400000 %
epoch 30, minibatch 300/300, validation error 17.400000 %
epoch 31, minibatch 300/300, validation error 17.600000 %
epoch 32, minibatch 300/300, validation error 17.400000 %
epoch 33, minibatch 300/300, validation error 17.400000 %
epoch 34, minibatch 300/300, validation error 17.400000 %
epoch 35, minibatch 300/300, validation error 17.400000 %
epoch 36, minibatch 300/300, validation error 17.400000 %
epoch 37, minibatch 300/300, validation error 17.200000 %
     epoch 37, minibatch 300/300, test error of best model 6.400000 %
epoch 38, minibatch 300/300, validation error 17.200000 %
epoch 39, minibatch 300/300, validation error 17.200000 %
epoch 40, minibatch 300/300, validation error 17.000000 %
     epoch 40, minibatch 300/300, test error of best model 6.400000 %
epoch 41, minibatch 300/300, validation error 16.400000 %
     epoch 41, minibatch 300/300, test error of best model 6.400000 %
epoch 42, minibatch 300/300, validation error 16.000000 %
     epoch 42, minibatch 300/300, test error of best model 6.600000 %
epoch 43, minibatch 300/300, validation error 16.000000 %
epoch 44, minibatch 300/300, validation error 16.000000 %
epoch 45, minibatch 300/300, validation error 16.200000 %
epoch 46, minibatch 300/300, validation error 16.200000 %
epoch 47, minibatch 300/300, validation error 16.200000 %
epoch 48, minibatch 300/300, validation error 16.200000 %
epoch 49, minibatch 300/300, validation error 16.200000 %
epoch 50, minibatch 300/300, validation error 16.000000 %
epoch 51, minibatch 300/300, validation error 16.000000 %
epoch 52, minibatch 300/300, validation error 16.000000 %
epoch 53, minibatch 300/300, validation error 16.000000 %
epoch 54, minibatch 300/300, validation error 16.000000 %
epoch 55, minibatch 300/300, validation error 16.000000 %
epoch 56, minibatch 300/300, validation error 16.000000 %
epoch 57, minibatch 300/300, validation error 16.000000 %
epoch 58, minibatch 300/300, validation error 16.000000 %
epoch 59, minibatch 300/300, validation error 16.000000 %
epoch 60, minibatch 300/300, validation error 16.000000 %
epoch 61, minibatch 300/300, validation error 16.000000 %
epoch 62, minibatch 300/300, validation error 16.000000 %
epoch 63, minibatch 300/300, validation error 16.000000 %
epoch 64, minibatch 300/300, validation error 16.000000 %
epoch 65, minibatch 300/300, validation error 16.000000 %
epoch 66, minibatch 300/300, validation error 16.000000 %
epoch 67, minibatch 300/300, validation error 16.000000 %
epoch 68, minibatch 300/300, validation error 16.000000 %
epoch 69, minibatch 300/300, validation error 16.000000 %
epoch 70, minibatch 300/300, validation error 16.000000 %
epoch 71, minibatch 300/300, validation error 16.000000 %
epoch 72, minibatch 300/300, validation error 16.000000 %
epoch 73, minibatch 300/300, validation error 16.000000 %
epoch 74, minibatch 300/300, validation error 16.000000 %
epoch 75, minibatch 300/300, validation error 16.000000 %
epoch 76, minibatch 300/300, validation error 16.000000 %
epoch 77, minibatch 300/300, validation error 16.000000 %
epoch 78, minibatch 300/300, validation error 16.000000 %
epoch 79, minibatch 300/300, validation error 16.000000 %
epoch 80, minibatch 300/300, validation error 16.000000 %
epoch 81, minibatch 300/300, validation error 16.000000 %
epoch 82, minibatch 300/300, validation error 16.000000 %
epoch 83, minibatch 300/300, validation error 16.000000 %
Optimization complete with best validation score of 16.000000 %, obtained at iteration 12600, with test performance 6.600000 %
The fine tuning code for file dbn_loop.pyc ran for 2.06m


==========Sample: (4000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.245303211
Pre-training layer 0, epoch 0, representative training free energy -553.547643921
Pre-training layer 0, epoch 0, validation free energy -548.082338806
Pre-training layer 0, epoch 1, cost -111.936958237
Pre-training layer 0, epoch 2, cost -103.781883411
Pre-training layer 0, epoch 3, cost -98.9319867897
Pre-training layer 0, epoch 4, cost -95.9352135849
Pre-training layer 0, epoch 5, cost -93.5567134476
Pre-training layer 0, epoch 5, representative training free energy -491.687207764
Pre-training layer 0, epoch 5, validation free energy -484.215710022
Pre-training layer 0, epoch 6, cost -91.6416120911
Pre-training layer 0, epoch 7, cost -90.1694780922
Pre-training layer 0, epoch 8, cost -88.914184227
Pre-training layer 0, epoch 9, cost -87.7249870682
Pre-training layer 0, epoch 10, cost -86.8937274933
Pre-training layer 0, epoch 10, representative training free energy -471.508191589
Pre-training layer 0, epoch 10, validation free energy -463.468705383
Pre-training layer 0, epoch 11, cost -86.0262181568
Pre-training layer 0, epoch 12, cost -85.3757754326
Pre-training layer 0, epoch 13, cost -84.7080568695
Pre-training layer 0, epoch 14, cost -84.1591549587
Pre-training layer 0, epoch 15, cost -83.5198534107
Pre-training layer 0, epoch 15, representative training free energy -457.603302917
Pre-training layer 0, epoch 15, validation free energy -449.199005554
Pre-training layer 0, epoch 16, cost -83.2029224205
Pre-training layer 0, epoch 17, cost -82.7734130192
Pre-training layer 0, epoch 18, cost -82.3197127914
Pre-training layer 0, epoch 19, cost -81.7963541698
Pre-training layer 0, epoch 20, cost -81.671908617
Pre-training layer 0, epoch 20, representative training free energy -449.491631531
Pre-training layer 0, epoch 20, validation free energy -441.078627441
Pre-training layer 0, epoch 21, cost -81.2257067394
Pre-training layer 0, epoch 22, cost -81.0509024048
Pre-training layer 0, epoch 23, cost -80.64677351
Pre-training layer 0, epoch 24, cost -80.3999046707
Pre-training layer 0, epoch 25, cost -80.2240379333
Pre-training layer 0, epoch 25, representative training free energy -448.360986389
Pre-training layer 0, epoch 25, validation free energy -439.356420593
Pre-training layer 0, epoch 26, cost -79.7280386066
Pre-training layer 0, epoch 27, cost -79.572035656
Pre-training layer 0, epoch 28, cost -79.3583773327
Pre-training layer 0, epoch 29, cost -79.217560482
Pre-training layer 0, epoch 30, cost -79.0549517727
Pre-training layer 0, epoch 30, representative training free energy -442.118798828
Pre-training layer 0, epoch 30, validation free energy -432.629201355
Pre-training layer 0, epoch 31, cost -78.8068203163
Pre-training layer 0, epoch 32, cost -78.4753110218
Pre-training layer 0, epoch 33, cost -78.3703891277
Pre-training layer 0, epoch 34, cost -78.2885613155
Pre-training layer 0, epoch 35, cost -78.0199507999
Pre-training layer 0, epoch 35, representative training free energy -441.449473572
Pre-training layer 0, epoch 35, validation free energy -432.403561096
Pre-training layer 0, epoch 36, cost -77.9103401661
Pre-training layer 0, epoch 37, cost -77.7727608013
Pre-training layer 0, epoch 38, cost -77.7580422688
Pre-training layer 0, epoch 39, cost -77.5035292625
Pre-training layer 0, epoch 40, cost -77.3660762501
Pre-training layer 0, epoch 40, representative training free energy -437.366474243
Pre-training layer 0, epoch 40, validation free energy -427.655160278
Pre-training layer 0, epoch 41, cost -77.1030720806
Pre-training layer 0, epoch 42, cost -77.1652423477
Pre-training layer 0, epoch 43, cost -76.9048941708
Pre-training layer 0, epoch 44, cost -76.9711410618
Pre-training layer 0, epoch 45, cost -76.8227758408
Pre-training layer 0, epoch 45, representative training free energy -433.446642822
Pre-training layer 0, epoch 45, validation free energy -423.741233154
Pre-training layer 0, epoch 46, cost -76.6499364281
Pre-training layer 0, epoch 47, cost -76.5143423176
Pre-training layer 0, epoch 48, cost -76.4250616837
Pre-training layer 0, epoch 49, cost -76.3611040783
Pre-training layer 0, epoch 50, cost -76.2525884724
Pre-training layer 0, epoch 50, representative training free energy -431.810009766
Pre-training layer 0, epoch 50, validation free energy -422.249272156
Pre-training layer 0, epoch 51, cost -76.1211904812
Pre-training layer 0, epoch 52, cost -75.9226904869
Pre-training layer 0, epoch 53, cost -75.8590139389
Pre-training layer 0, epoch 54, cost -75.7545306206
Pre-training layer 0, epoch 55, cost -75.6379383373
Pre-training layer 0, epoch 55, representative training free energy -429.455359863
Pre-training layer 0, epoch 55, validation free energy -419.52095166
Pre-training layer 0, epoch 56, cost -75.5918042278
Pre-training layer 0, epoch 57, cost -75.5186527348
Pre-training layer 0, epoch 58, cost -75.3700891876
Pre-training layer 0, epoch 59, cost -75.3512198162
Pre-training layer 0, epoch 60, cost -75.26471632
Pre-training layer 0, epoch 60, representative training free energy -430.61663501
Pre-training layer 0, epoch 60, validation free energy -420.525454407
Pre-training layer 0, epoch 61, cost -75.2796452713
Pre-training layer 0, epoch 62, cost -75.0388714981
Pre-training layer 0, epoch 63, cost -74.8946367931
Pre-training layer 0, epoch 64, cost -74.9680291843
Pre-training layer 0, epoch 65, cost -74.8223265743
Pre-training layer 0, epoch 65, representative training free energy -428.707505737
Pre-training layer 0, epoch 65, validation free energy -418.53576355
Pre-training layer 0, epoch 66, cost -74.8245690727
Pre-training layer 0, epoch 67, cost -74.7323395443
Pre-training layer 0, epoch 68, cost -74.6854324436
Pre-training layer 0, epoch 69, cost -74.6779356194
Pre-training layer 0, epoch 70, cost -74.539115572
Pre-training layer 0, epoch 70, representative training free energy -427.348223328
Pre-training layer 0, epoch 70, validation free energy -416.909463318
Pre-training layer 0, epoch 71, cost -74.4894499016
Pre-training layer 0, epoch 72, cost -74.4423218346
Pre-training layer 0, epoch 73, cost -74.4714432621
Pre-training layer 0, epoch 74, cost -74.1939623928
Pre-training layer 0, epoch 75, cost -74.2752657795
Pre-training layer 0, epoch 75, representative training free energy -425.75396936
Pre-training layer 0, epoch 75, validation free energy -414.953754578
Pre-training layer 0, epoch 76, cost -74.1291946316
Pre-training layer 0, epoch 77, cost -74.1351856804
Pre-training layer 0, epoch 78, cost -73.9613282013
Pre-training layer 0, epoch 79, cost -73.9840494061
Pre-training layer 0, epoch 80, cost -73.9684615135
Pre-training layer 0, epoch 80, representative training free energy -423.125941467
Pre-training layer 0, epoch 80, validation free energy -412.547494812
Pre-training layer 0, epoch 81, cost -73.8011463356
Pre-training layer 0, epoch 82, cost -73.7246814823
Pre-training layer 0, epoch 83, cost -73.7791598892
Pre-training layer 0, epoch 84, cost -73.6697955132
Pre-training layer 0, epoch 85, cost -73.616786747
Pre-training layer 0, epoch 85, representative training free energy -424.159960144
Pre-training layer 0, epoch 85, validation free energy -413.858310791
Pre-training layer 0, epoch 86, cost -73.5816526031
Pre-training layer 0, epoch 87, cost -73.6076389599
Pre-training layer 0, epoch 88, cost -73.5349641705
Pre-training layer 0, epoch 89, cost -73.4343158913
Pre-training layer 0, epoch 90, cost -73.3226402378
Pre-training layer 0, epoch 90, representative training free energy -422.399070923
Pre-training layer 0, epoch 90, validation free energy -411.463358704
Pre-training layer 0, epoch 91, cost -73.3914718056
Pre-training layer 0, epoch 92, cost -73.2450183964
Pre-training layer 0, epoch 93, cost -73.2735969925
Pre-training layer 0, epoch 94, cost -73.2906450176
Pre-training layer 0, epoch 95, cost -73.1450081921
Pre-training layer 0, epoch 95, representative training free energy -421.488014282
Pre-training layer 0, epoch 95, validation free energy -410.351454712
Pre-training layer 0, epoch 96, cost -73.1549806499
Pre-training layer 0, epoch 97, cost -73.0908984661
Pre-training layer 0, epoch 98, cost -73.0097494221
Pre-training layer 0, epoch 99, cost -72.9374592018
Pre-training layer 1, epoch 0, cost -324.265521927
Pre-training layer 1, epoch 0, representative training free energy -56751.1199258
Pre-training layer 1, epoch 0, validation free energy -56222.6187266
Pre-training layer 1, epoch 1, cost -278.56931488
Pre-training layer 1, epoch 2, cost -264.615692978
Pre-training layer 1, epoch 3, cost -256.308946877
Pre-training layer 1, epoch 4, cost -250.754215927
Pre-training layer 1, epoch 5, cost -246.589659271
Pre-training layer 1, epoch 5, representative training free energy -76177.8992305
Pre-training layer 1, epoch 5, validation free energy -75478.6859453
Pre-training layer 1, epoch 6, cost -243.542947769
Pre-training layer 1, epoch 7, cost -240.885975266
Pre-training layer 1, epoch 8, cost -238.865065269
Pre-training layer 1, epoch 9, cost -237.013699951
Pre-training layer 1, epoch 10, cost -235.419888115
Pre-training layer 1, epoch 10, representative training free energy -82038.6216445
Pre-training layer 1, epoch 10, validation free energy -81298.4398125
Pre-training layer 1, epoch 11, cost -234.302748833
Pre-training layer 1, epoch 12, cost -233.10001194
Pre-training layer 1, epoch 13, cost -232.164601479
Pre-training layer 1, epoch 14, cost -231.350934143
Pre-training layer 1, epoch 15, cost -230.3609058
Pre-training layer 1, epoch 15, representative training free energy -85511.5919766
Pre-training layer 1, epoch 15, validation free energy -84730.5815352
Pre-training layer 1, epoch 16, cost -229.723515511
Pre-training layer 1, epoch 17, cost -228.9740839
Pre-training layer 1, epoch 18, cost -228.30326561
Pre-training layer 1, epoch 19, cost -227.826669312
Pre-training layer 1, epoch 20, cost -227.270427704
Pre-training layer 1, epoch 20, representative training free energy -88029.0194375
Pre-training layer 1, epoch 20, validation free energy -87226.9294219
Pre-training layer 1, epoch 21, cost -226.670660133
Pre-training layer 1, epoch 22, cost -226.253758278
Pre-training layer 1, epoch 23, cost -225.865402832
Pre-training layer 1, epoch 24, cost -225.588602638
Pre-training layer 1, epoch 25, cost -225.156672096
Pre-training layer 1, epoch 25, representative training free energy -89970.2906016
Pre-training layer 1, epoch 25, validation free energy -89145.2778711
Pre-training layer 1, epoch 26, cost -224.846035767
Pre-training layer 1, epoch 27, cost -224.473975334
Pre-training layer 1, epoch 28, cost -224.139834709
Pre-training layer 1, epoch 29, cost -223.848402443
Pre-training layer 1, epoch 30, cost -223.499139099
Pre-training layer 1, epoch 30, representative training free energy -91525.5587891
Pre-training layer 1, epoch 30, validation free energy -90684.1511406
Pre-training layer 1, epoch 31, cost -223.235406342
Pre-training layer 1, epoch 32, cost -223.057156487
Pre-training layer 1, epoch 33, cost -222.702188072
Pre-training layer 1, epoch 34, cost -222.637892342
Pre-training layer 1, epoch 35, cost -222.270071983
Pre-training layer 1, epoch 35, representative training free energy -92914.8434023
Pre-training layer 1, epoch 35, validation free energy -92070.9017695
Pre-training layer 1, epoch 36, cost -222.152690887
Pre-training layer 1, epoch 37, cost -221.854784393
Pre-training layer 1, epoch 38, cost -221.741892128
Pre-training layer 1, epoch 39, cost -221.452695732
Pre-training layer 1, epoch 40, cost -221.295730476
Pre-training layer 1, epoch 40, representative training free energy -94026.4732109
Pre-training layer 1, epoch 40, validation free energy -93165.7296328
Pre-training layer 1, epoch 41, cost -221.101072159
Pre-training layer 1, epoch 42, cost -220.943822784
Pre-training layer 1, epoch 43, cost -220.790180931
Pre-training layer 1, epoch 44, cost -220.683530922
Pre-training layer 1, epoch 45, cost -220.35806736
Pre-training layer 1, epoch 45, representative training free energy -95109.2738594
Pre-training layer 1, epoch 45, validation free energy -94238.4935352
Pre-training layer 1, epoch 46, cost -220.317545815
Pre-training layer 1, epoch 47, cost -220.125238876
Pre-training layer 1, epoch 48, cost -220.042581215
Pre-training layer 1, epoch 49, cost -219.834184227
Pre-training layer 1, epoch 50, cost -219.704905052
Pre-training layer 1, epoch 50, representative training free energy -96053.369
Pre-training layer 1, epoch 50, validation free energy -95176.1987109
Pre-training layer 1, epoch 51, cost -219.661323814
Pre-training layer 1, epoch 52, cost -219.400550537
Pre-training layer 1, epoch 53, cost -219.381871834
Pre-training layer 1, epoch 54, cost -219.184884491
Pre-training layer 1, epoch 55, cost -219.147396698
Pre-training layer 1, epoch 55, representative training free energy -96929.1334375
Pre-training layer 1, epoch 55, validation free energy -96044.6738711
Pre-training layer 1, epoch 56, cost -219.125525322
Pre-training layer 1, epoch 57, cost -218.815885086
Pre-training layer 1, epoch 58, cost -218.85847435
Pre-training layer 1, epoch 59, cost -218.756307106
Pre-training layer 1, epoch 60, cost -218.633279114
Pre-training layer 1, epoch 60, representative training free energy -97754.1063203
Pre-training layer 1, epoch 60, validation free energy -96865.6442266
Pre-training layer 1, epoch 61, cost -218.451547394
Pre-training layer 1, epoch 62, cost -218.354303131
Pre-training layer 1, epoch 63, cost -218.281342354
Pre-training layer 1, epoch 64, cost -218.133603249
Pre-training layer 1, epoch 65, cost -218.187758446
Pre-training layer 1, epoch 65, representative training free energy -98469.4299453
Pre-training layer 1, epoch 65, validation free energy -97577.1541563
Pre-training layer 1, epoch 66, cost -218.057030411
Pre-training layer 1, epoch 67, cost -217.901793022
Pre-training layer 1, epoch 68, cost -217.878101845
Pre-training layer 1, epoch 69, cost -217.782012291
Pre-training layer 1, epoch 70, cost -217.628052826
Pre-training layer 1, epoch 70, representative training free energy -99214.6491641
Pre-training layer 1, epoch 70, validation free energy -98317.7643555
Pre-training layer 1, epoch 71, cost -217.608588028
Pre-training layer 1, epoch 72, cost -217.554016037
Pre-training layer 1, epoch 73, cost -217.467398338
Pre-training layer 1, epoch 74, cost -217.372529259
Pre-training layer 1, epoch 75, cost -217.317279739
Pre-training layer 1, epoch 75, representative training free energy -99914.6520078
Pre-training layer 1, epoch 75, validation free energy -99007.7884219
Pre-training layer 1, epoch 76, cost -217.268993454
Pre-training layer 1, epoch 77, cost -217.105850372
Pre-training layer 1, epoch 78, cost -217.109960365
Pre-training layer 1, epoch 79, cost -217.071802063
Pre-training layer 1, epoch 80, cost -216.951324005
Pre-training layer 1, epoch 80, representative training free energy -100530.085117
Pre-training layer 1, epoch 80, validation free energy -99616.7973203
Pre-training layer 1, epoch 81, cost -216.933615456
Pre-training layer 1, epoch 82, cost -216.920203667
Pre-training layer 1, epoch 83, cost -216.851131325
Pre-training layer 1, epoch 84, cost -216.697758789
Pre-training layer 1, epoch 85, cost -216.570950813
Pre-training layer 1, epoch 85, representative training free energy -101097.701398
Pre-training layer 1, epoch 85, validation free energy -100177.186234
Pre-training layer 1, epoch 86, cost -216.68389904
Pre-training layer 1, epoch 87, cost -216.549326134
Pre-training layer 1, epoch 88, cost -216.487577095
Pre-training layer 1, epoch 89, cost -216.444060287
Pre-training layer 1, epoch 90, cost -216.390033302
Pre-training layer 1, epoch 90, representative training free energy -101673.623531
Pre-training layer 1, epoch 90, validation free energy -100749.176562
Pre-training layer 1, epoch 91, cost -216.237882996
Pre-training layer 1, epoch 92, cost -216.257937012
Pre-training layer 1, epoch 93, cost -216.247481003
Pre-training layer 1, epoch 94, cost -216.118499413
Pre-training layer 1, epoch 95, cost -216.189690399
Pre-training layer 1, epoch 95, representative training free energy -102276.391945
Pre-training layer 1, epoch 95, validation free energy -101347.111063
Pre-training layer 1, epoch 96, cost -216.129980774
Pre-training layer 1, epoch 97, cost -216.110663795
Pre-training layer 1, epoch 98, cost -216.025069847
Pre-training layer 1, epoch 99, cost -215.971590347
Pre-training layer 2, epoch 0, cost -120.299346466
Pre-training layer 2, epoch 0, representative training free energy 3446.91756482
Pre-training layer 2, epoch 0, validation free energy 3425.5888501
Pre-training layer 2, epoch 1, cost -89.8309992218
Pre-training layer 2, epoch 2, cost -83.0636240673
Pre-training layer 2, epoch 3, cost -79.4348648548
Pre-training layer 2, epoch 4, cost -76.9192379856
Pre-training layer 2, epoch 5, cost -75.0986813736
Pre-training layer 2, epoch 5, representative training free energy 5633.30330225
Pre-training layer 2, epoch 5, validation free energy 5601.68845898
Pre-training layer 2, epoch 6, cost -73.6583739185
Pre-training layer 2, epoch 7, cost -72.48047925
Pre-training layer 2, epoch 8, cost -71.6224814701
Pre-training layer 2, epoch 9, cost -70.8295859909
Pre-training layer 2, epoch 10, cost -69.9613162041
Pre-training layer 2, epoch 10, representative training free energy 6824.57513428
Pre-training layer 2, epoch 10, validation free energy 6771.17203711
Pre-training layer 2, epoch 11, cost -69.4559007359
Pre-training layer 2, epoch 12, cost -68.997032671
Pre-training layer 2, epoch 13, cost -68.4677288342
Pre-training layer 2, epoch 14, cost -68.0475412369
Pre-training layer 2, epoch 15, cost -67.6690945339
Pre-training layer 2, epoch 15, representative training free energy 7625.97595996
Pre-training layer 2, epoch 15, validation free energy 7558.42644727
Pre-training layer 2, epoch 16, cost -67.3101829147
Pre-training layer 2, epoch 17, cost -67.0394964314
Pre-training layer 2, epoch 18, cost -66.7735569096
Pre-training layer 2, epoch 19, cost -66.3663694096
Pre-training layer 2, epoch 20, cost -66.2924785614
Pre-training layer 2, epoch 20, representative training free energy 8257.70478027
Pre-training layer 2, epoch 20, validation free energy 8183.81095898
Pre-training layer 2, epoch 21, cost -66.0245088005
Pre-training layer 2, epoch 22, cost -65.8723806667
Pre-training layer 2, epoch 23, cost -65.6186556244
Pre-training layer 2, epoch 24, cost -65.5069974518
Pre-training layer 2, epoch 25, cost -65.2598875237
Pre-training layer 2, epoch 25, representative training free energy 8828.691896
Pre-training layer 2, epoch 25, validation free energy 8746.80573633
Pre-training layer 2, epoch 26, cost -65.142287941
Pre-training layer 2, epoch 27, cost -65.0050518799
Pre-training layer 2, epoch 28, cost -64.7774304199
Pre-training layer 2, epoch 29, cost -64.6818285465
Pre-training layer 2, epoch 30, cost -64.635212841
Pre-training layer 2, epoch 30, representative training free energy 9283.92291309
Pre-training layer 2, epoch 30, validation free energy 9198.07055273
Pre-training layer 2, epoch 31, cost -64.4955918026
Pre-training layer 2, epoch 32, cost -64.3670345783
Pre-training layer 2, epoch 33, cost -64.2759448814
Pre-training layer 2, epoch 34, cost -64.2145562172
Pre-training layer 2, epoch 35, cost -64.0264064789
Pre-training layer 2, epoch 35, representative training free energy 9739.09923486
Pre-training layer 2, epoch 35, validation free energy 9646.44782471
Pre-training layer 2, epoch 36, cost -63.9239408207
Pre-training layer 2, epoch 37, cost -63.8874024677
Pre-training layer 2, epoch 38, cost -63.8012937927
Pre-training layer 2, epoch 39, cost -63.702353344
Pre-training layer 2, epoch 40, cost -63.6074379444
Pre-training layer 2, epoch 40, representative training free energy 10163.1243076
Pre-training layer 2, epoch 40, validation free energy 10067.3502153
Pre-training layer 2, epoch 41, cost -63.6310732174
Pre-training layer 2, epoch 42, cost -63.4527462387
Pre-training layer 2, epoch 43, cost -63.4456450462
Pre-training layer 2, epoch 44, cost -63.3320037556
Pre-training layer 2, epoch 45, cost -63.2818305492
Pre-training layer 2, epoch 45, representative training free energy 10502.4877954
Pre-training layer 2, epoch 45, validation free energy 10405.0756968
Pre-training layer 2, epoch 46, cost -63.2369177055
Pre-training layer 2, epoch 47, cost -63.0757916832
Pre-training layer 2, epoch 48, cost -63.1069420147
Pre-training layer 2, epoch 49, cost -63.0178807163
Pre-training layer 2, epoch 50, cost -63.030894928
Pre-training layer 2, epoch 50, representative training free energy 10841.5868813
Pre-training layer 2, epoch 50, validation free energy 10739.4311274
Pre-training layer 2, epoch 51, cost -62.9569373131
Pre-training layer 2, epoch 52, cost -62.9263161087
Pre-training layer 2, epoch 53, cost -62.7861547565
Pre-training layer 2, epoch 54, cost -62.8873640823
Pre-training layer 2, epoch 55, cost -62.7459043598
Pre-training layer 2, epoch 55, representative training free energy 11191.7341196
Pre-training layer 2, epoch 55, validation free energy 11088.1504575
Pre-training layer 2, epoch 56, cost -62.698124094
Pre-training layer 2, epoch 57, cost -62.6570166111
Pre-training layer 2, epoch 58, cost -62.5885183048
Pre-training layer 2, epoch 59, cost -62.5868421268
Pre-training layer 2, epoch 60, cost -62.4235499001
Pre-training layer 2, epoch 60, representative training free energy 11510.3458633
Pre-training layer 2, epoch 60, validation free energy 11403.1228535
Pre-training layer 2, epoch 61, cost -62.5050656414
Pre-training layer 2, epoch 62, cost -62.4375239182
Pre-training layer 2, epoch 63, cost -62.3491462135
Pre-training layer 2, epoch 64, cost -62.4429463387
Pre-training layer 2, epoch 65, cost -62.3513889885
Pre-training layer 2, epoch 65, representative training free energy 11818.8933711
Pre-training layer 2, epoch 65, validation free energy 11709.2029038
Pre-training layer 2, epoch 66, cost -62.2993161964
Pre-training layer 2, epoch 67, cost -62.3343349552
Pre-training layer 2, epoch 68, cost -62.2781290913
Pre-training layer 2, epoch 69, cost -62.1714511108
Pre-training layer 2, epoch 70, cost -62.1704090595
Pre-training layer 2, epoch 70, representative training free energy 12124.7489629
Pre-training layer 2, epoch 70, validation free energy 12009.3498184
Pre-training layer 2, epoch 71, cost -62.1869911957
Pre-training layer 2, epoch 72, cost -62.106785965
Pre-training layer 2, epoch 73, cost -62.1157701302
Pre-training layer 2, epoch 74, cost -62.0569648075
Pre-training layer 2, epoch 75, cost -62.0790349674
Pre-training layer 2, epoch 75, representative training free energy 12392.8375664
Pre-training layer 2, epoch 75, validation free energy 12278.6356758
Pre-training layer 2, epoch 76, cost -62.0182066727
Pre-training layer 2, epoch 77, cost -61.9897860241
Pre-training layer 2, epoch 78, cost -61.8938922977
Pre-training layer 2, epoch 79, cost -61.8927135754
Pre-training layer 2, epoch 80, cost -61.8711086082
Pre-training layer 2, epoch 80, representative training free energy 12701.4165566
Pre-training layer 2, epoch 80, validation free energy 12585.2877598
Pre-training layer 2, epoch 81, cost -61.8593667316
Pre-training layer 2, epoch 82, cost -61.825663662
Pre-training layer 2, epoch 83, cost -61.8010522079
Pre-training layer 2, epoch 84, cost -61.7654427624
Pre-training layer 2, epoch 85, cost -61.7532339191
Pre-training layer 2, epoch 85, representative training free energy 12939.7411445
Pre-training layer 2, epoch 85, validation free energy 12819.1933838
Pre-training layer 2, epoch 86, cost -61.7554929256
Pre-training layer 2, epoch 87, cost -61.6938028526
Pre-training layer 2, epoch 88, cost -61.739395895
Pre-training layer 2, epoch 89, cost -61.5976823044
Pre-training layer 2, epoch 90, cost -61.5737457466
Pre-training layer 2, epoch 90, representative training free energy 13207.5217412
Pre-training layer 2, epoch 90, validation free energy 13086.5389092
Pre-training layer 2, epoch 91, cost -61.6830305099
Pre-training layer 2, epoch 92, cost -61.5898664474
Pre-training layer 2, epoch 93, cost -61.6119504833
Pre-training layer 2, epoch 94, cost -61.506134119
Pre-training layer 2, epoch 95, cost -61.5357310867
Pre-training layer 2, epoch 95, representative training free energy 13486.2731211
Pre-training layer 2, epoch 95, validation free energy 13362.5845098
Pre-training layer 2, epoch 96, cost -61.4461748219
Pre-training layer 2, epoch 97, cost -61.505414362
Pre-training layer 2, epoch 98, cost -61.4286014843
Pre-training layer 2, epoch 99, cost -61.454074564
The pretraining code for file dbn_loop.pyc ran for 10.43m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 35.200000 %
     epoch 1, minibatch 400/400, test error of best model 29.200000 %
epoch 2, minibatch 400/400, validation error 25.800000 %
     epoch 2, minibatch 400/400, test error of best model 17.800000 %
epoch 3, minibatch 400/400, validation error 22.800000 %
     epoch 3, minibatch 400/400, test error of best model 14.000000 %
epoch 4, minibatch 400/400, validation error 20.800000 %
     epoch 4, minibatch 400/400, test error of best model 11.800000 %
epoch 5, minibatch 400/400, validation error 20.200000 %
     epoch 5, minibatch 400/400, test error of best model 10.200000 %
epoch 6, minibatch 400/400, validation error 20.000000 %
     epoch 6, minibatch 400/400, test error of best model 8.800000 %
epoch 7, minibatch 400/400, validation error 19.400000 %
     epoch 7, minibatch 400/400, test error of best model 8.200000 %
epoch 8, minibatch 400/400, validation error 18.000000 %
     epoch 8, minibatch 400/400, test error of best model 7.400000 %
epoch 9, minibatch 400/400, validation error 17.600000 %
     epoch 9, minibatch 400/400, test error of best model 6.400000 %
epoch 10, minibatch 400/400, validation error 17.400000 %
     epoch 10, minibatch 400/400, test error of best model 6.200000 %
epoch 11, minibatch 400/400, validation error 16.600000 %
     epoch 11, minibatch 400/400, test error of best model 5.800000 %
epoch 12, minibatch 400/400, validation error 16.400000 %
     epoch 12, minibatch 400/400, test error of best model 5.400000 %
epoch 13, minibatch 400/400, validation error 16.400000 %
epoch 14, minibatch 400/400, validation error 16.400000 %
epoch 15, minibatch 400/400, validation error 16.400000 %
epoch 16, minibatch 400/400, validation error 16.600000 %
epoch 17, minibatch 400/400, validation error 16.000000 %
     epoch 17, minibatch 400/400, test error of best model 5.400000 %
epoch 18, minibatch 400/400, validation error 16.000000 %
epoch 19, minibatch 400/400, validation error 16.000000 %
epoch 20, minibatch 400/400, validation error 16.000000 %
epoch 21, minibatch 400/400, validation error 15.800000 %
     epoch 21, minibatch 400/400, test error of best model 5.800000 %
epoch 22, minibatch 400/400, validation error 16.000000 %
epoch 23, minibatch 400/400, validation error 16.200000 %
epoch 24, minibatch 400/400, validation error 16.200000 %
epoch 25, minibatch 400/400, validation error 16.200000 %
epoch 26, minibatch 400/400, validation error 16.000000 %
epoch 27, minibatch 400/400, validation error 16.000000 %
epoch 28, minibatch 400/400, validation error 16.000000 %
epoch 29, minibatch 400/400, validation error 16.000000 %
epoch 30, minibatch 400/400, validation error 16.000000 %
epoch 31, minibatch 400/400, validation error 16.000000 %
epoch 32, minibatch 400/400, validation error 16.000000 %
epoch 33, minibatch 400/400, validation error 16.000000 %
epoch 34, minibatch 400/400, validation error 15.800000 %
epoch 35, minibatch 400/400, validation error 15.600000 %
     epoch 35, minibatch 400/400, test error of best model 5.000000 %
epoch 36, minibatch 400/400, validation error 15.600000 %
epoch 37, minibatch 400/400, validation error 15.600000 %
epoch 38, minibatch 400/400, validation error 15.600000 %
epoch 39, minibatch 400/400, validation error 15.800000 %
epoch 40, minibatch 400/400, validation error 15.800000 %
epoch 41, minibatch 400/400, validation error 15.800000 %
epoch 42, minibatch 400/400, validation error 15.800000 %
epoch 43, minibatch 400/400, validation error 15.800000 %
epoch 44, minibatch 400/400, validation error 15.800000 %
epoch 45, minibatch 400/400, validation error 15.800000 %
epoch 46, minibatch 400/400, validation error 15.800000 %
epoch 47, minibatch 400/400, validation error 15.800000 %
epoch 48, minibatch 400/400, validation error 15.800000 %
epoch 49, minibatch 400/400, validation error 15.800000 %
epoch 50, minibatch 400/400, validation error 15.800000 %
epoch 51, minibatch 400/400, validation error 15.800000 %
epoch 52, minibatch 400/400, validation error 15.800000 %
epoch 53, minibatch 400/400, validation error 15.600000 %
epoch 54, minibatch 400/400, validation error 15.600000 %
epoch 55, minibatch 400/400, validation error 15.600000 %
epoch 56, minibatch 400/400, validation error 15.600000 %
epoch 57, minibatch 400/400, validation error 15.600000 %
epoch 58, minibatch 400/400, validation error 15.600000 %
epoch 59, minibatch 400/400, validation error 15.600000 %
epoch 60, minibatch 400/400, validation error 15.600000 %
epoch 61, minibatch 400/400, validation error 15.600000 %
epoch 62, minibatch 400/400, validation error 15.600000 %
epoch 63, minibatch 400/400, validation error 15.600000 %
epoch 64, minibatch 400/400, validation error 15.600000 %
epoch 65, minibatch 400/400, validation error 15.600000 %
epoch 66, minibatch 400/400, validation error 15.600000 %
epoch 67, minibatch 400/400, validation error 15.600000 %
epoch 68, minibatch 400/400, validation error 15.600000 %
epoch 69, minibatch 400/400, validation error 15.600000 %
Optimization complete with best validation score of 15.600000 %, obtained at iteration 14000, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 2.25m


==========Sample: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.384759064
Pre-training layer 0, epoch 0, representative training free energy -549.352846069
Pre-training layer 0, epoch 0, validation free energy -543.372058838
Pre-training layer 0, epoch 1, cost -108.867028625
Pre-training layer 0, epoch 2, cost -101.028232391
Pre-training layer 0, epoch 3, cost -96.3299085846
Pre-training layer 0, epoch 4, cost -93.5502241669
Pre-training layer 0, epoch 5, cost -91.3719202118
Pre-training layer 0, epoch 5, representative training free energy -490.984771118
Pre-training layer 0, epoch 5, validation free energy -484.713006897
Pre-training layer 0, epoch 6, cost -89.5265795898
Pre-training layer 0, epoch 7, cost -88.1901740875
Pre-training layer 0, epoch 8, cost -87.0497238007
Pre-training layer 0, epoch 9, cost -86.121129921
Pre-training layer 0, epoch 10, cost -85.3098848114
Pre-training layer 0, epoch 10, representative training free energy -468.260051453
Pre-training layer 0, epoch 10, validation free energy -460.877717224
Pre-training layer 0, epoch 11, cost -84.6369958878
Pre-training layer 0, epoch 12, cost -83.9191071701
Pre-training layer 0, epoch 13, cost -83.4706323624
Pre-training layer 0, epoch 14, cost -82.7621224213
Pre-training layer 0, epoch 15, cost -82.2274298019
Pre-training layer 0, epoch 15, representative training free energy -458.530021362
Pre-training layer 0, epoch 15, validation free energy -450.236773071
Pre-training layer 0, epoch 16, cost -81.8833610687
Pre-training layer 0, epoch 17, cost -81.5687981796
Pre-training layer 0, epoch 18, cost -81.1274666595
Pre-training layer 0, epoch 19, cost -80.7629105606
Pre-training layer 0, epoch 20, cost -80.525729599
Pre-training layer 0, epoch 20, representative training free energy -449.689151062
Pre-training layer 0, epoch 20, validation free energy -442.027287903
Pre-training layer 0, epoch 21, cost -80.3076815338
Pre-training layer 0, epoch 22, cost -79.9965773239
Pre-training layer 0, epoch 23, cost -79.6898501663
Pre-training layer 0, epoch 24, cost -79.5058966827
Pre-training layer 0, epoch 25, cost -79.2823164673
Pre-training layer 0, epoch 25, representative training free energy -445.254829041
Pre-training layer 0, epoch 25, validation free energy -437.006161316
Pre-training layer 0, epoch 26, cost -78.9639901276
Pre-training layer 0, epoch 27, cost -78.6361146774
Pre-training layer 0, epoch 28, cost -78.6213589554
Pre-training layer 0, epoch 29, cost -78.3225587769
Pre-training layer 0, epoch 30, cost -78.2686463928
Pre-training layer 0, epoch 30, representative training free energy -439.228027222
Pre-training layer 0, epoch 30, validation free energy -430.866822876
Pre-training layer 0, epoch 31, cost -77.9720136719
Pre-training layer 0, epoch 32, cost -77.8367059021
Pre-training layer 0, epoch 33, cost -77.7565340805
Pre-training layer 0, epoch 34, cost -77.5888823776
Pre-training layer 0, epoch 35, cost -77.3403474731
Pre-training layer 0, epoch 35, representative training free energy -437.323361755
Pre-training layer 0, epoch 35, validation free energy -428.928509277
Pre-training layer 0, epoch 36, cost -77.2142154541
Pre-training layer 0, epoch 37, cost -77.097946312
Pre-training layer 0, epoch 38, cost -76.943101593
Pre-training layer 0, epoch 39, cost -76.7443980942
Pre-training layer 0, epoch 40, cost -76.7171971512
Pre-training layer 0, epoch 40, representative training free energy -437.175249512
Pre-training layer 0, epoch 40, validation free energy -428.232187561
Pre-training layer 0, epoch 41, cost -76.5157814636
Pre-training layer 0, epoch 42, cost -76.5161321259
Pre-training layer 0, epoch 43, cost -76.3634001236
Pre-training layer 0, epoch 44, cost -76.3111472397
Pre-training layer 0, epoch 45, cost -76.2247425003
Pre-training layer 0, epoch 45, representative training free energy -434.162528137
Pre-training layer 0, epoch 45, validation free energy -425.770988037
Pre-training layer 0, epoch 46, cost -76.1305983582
Pre-training layer 0, epoch 47, cost -75.8984583817
Pre-training layer 0, epoch 48, cost -75.7729552917
Pre-training layer 0, epoch 49, cost -75.7739325638
Pre-training layer 0, epoch 50, cost -75.6456232452
Pre-training layer 0, epoch 50, representative training free energy -434.563490845
Pre-training layer 0, epoch 50, validation free energy -425.456185791
Pre-training layer 0, epoch 51, cost -75.5420007553
Pre-training layer 0, epoch 52, cost -75.3705417709
Pre-training layer 0, epoch 53, cost -75.3667167358
Pre-training layer 0, epoch 54, cost -75.3306618195
Pre-training layer 0, epoch 55, cost -75.097693306
Pre-training layer 0, epoch 55, representative training free energy -430.529460571
Pre-training layer 0, epoch 55, validation free energy -421.31724646
Pre-training layer 0, epoch 56, cost -74.9623253479
Pre-training layer 0, epoch 57, cost -74.9843515701
Pre-training layer 0, epoch 58, cost -74.9890383453
Pre-training layer 0, epoch 59, cost -74.9178440018
Pre-training layer 0, epoch 60, cost -74.917459465
Pre-training layer 0, epoch 60, representative training free energy -431.563677612
Pre-training layer 0, epoch 60, validation free energy -422.324397888
Pre-training layer 0, epoch 61, cost -74.6648784256
Pre-training layer 0, epoch 62, cost -74.6964180756
Pre-training layer 0, epoch 63, cost -74.7008078384
Pre-training layer 0, epoch 64, cost -74.363308609
Pre-training layer 0, epoch 65, cost -74.4287178574
Pre-training layer 0, epoch 65, representative training free energy -426.397078125
Pre-training layer 0, epoch 65, validation free energy -417.109407715
Pre-training layer 0, epoch 66, cost -74.3995409012
Pre-training layer 0, epoch 67, cost -74.3610673523
Pre-training layer 0, epoch 68, cost -74.2130035477
Pre-training layer 0, epoch 69, cost -74.1580877457
Pre-training layer 0, epoch 70, cost -74.0830669174
Pre-training layer 0, epoch 70, representative training free energy -428.871989502
Pre-training layer 0, epoch 70, validation free energy -419.412235107
Pre-training layer 0, epoch 71, cost -74.0467393265
Pre-training layer 0, epoch 72, cost -74.0000976791
Pre-training layer 0, epoch 73, cost -73.9890182343
Pre-training layer 0, epoch 74, cost -73.914303688
Pre-training layer 0, epoch 75, cost -73.8095301895
Pre-training layer 0, epoch 75, representative training free energy -426.522743286
Pre-training layer 0, epoch 75, validation free energy -416.694935364
Pre-training layer 0, epoch 76, cost -73.8522415695
Pre-training layer 0, epoch 77, cost -73.650033989
Pre-training layer 0, epoch 78, cost -73.6241406708
Pre-training layer 0, epoch 79, cost -73.6013946533
Pre-training layer 0, epoch 80, cost -73.5621489944
Pre-training layer 0, epoch 80, representative training free energy -425.823054138
Pre-training layer 0, epoch 80, validation free energy -416.222641541
Pre-training layer 0, epoch 81, cost -73.5925237198
Pre-training layer 0, epoch 82, cost -73.5112277069
Pre-training layer 0, epoch 83, cost -73.3768640137
Pre-training layer 0, epoch 84, cost -73.3552926254
Pre-training layer 0, epoch 85, cost -73.2815517807
Pre-training layer 0, epoch 85, representative training free energy -425.831839111
Pre-training layer 0, epoch 85, validation free energy -415.542987488
Pre-training layer 0, epoch 86, cost -73.2008469772
Pre-training layer 0, epoch 87, cost -73.2301466751
Pre-training layer 0, epoch 88, cost -73.060263237
Pre-training layer 0, epoch 89, cost -73.0975097656
Pre-training layer 0, epoch 90, cost -73.0888319168
Pre-training layer 0, epoch 90, representative training free energy -426.841109253
Pre-training layer 0, epoch 90, validation free energy -416.391263184
Pre-training layer 0, epoch 91, cost -73.0093718872
Pre-training layer 0, epoch 92, cost -72.9801801071
Pre-training layer 0, epoch 93, cost -73.0506359787
Pre-training layer 0, epoch 94, cost -72.8683628159
Pre-training layer 0, epoch 95, cost -72.830330307
Pre-training layer 0, epoch 95, representative training free energy -424.778010803
Pre-training layer 0, epoch 95, validation free energy -414.439806458
Pre-training layer 0, epoch 96, cost -72.7760973434
Pre-training layer 0, epoch 97, cost -72.7131784134
Pre-training layer 0, epoch 98, cost -72.787318924
Pre-training layer 0, epoch 99, cost -72.7227916794
Pre-training layer 1, epoch 0, cost -312.035261505
Pre-training layer 1, epoch 0, representative training free energy -60869.7051406
Pre-training layer 1, epoch 0, validation free energy -60324.7012813
Pre-training layer 1, epoch 1, cost -268.204187866
Pre-training layer 1, epoch 2, cost -254.780776886
Pre-training layer 1, epoch 3, cost -246.908299347
Pre-training layer 1, epoch 4, cost -241.765048981
Pre-training layer 1, epoch 5, cost -237.86021283
Pre-training layer 1, epoch 5, representative training free energy -81015.4439219
Pre-training layer 1, epoch 5, validation free energy -80287.7315234
Pre-training layer 1, epoch 6, cost -235.096270844
Pre-training layer 1, epoch 7, cost -232.677098816
Pre-training layer 1, epoch 8, cost -230.761570251
Pre-training layer 1, epoch 9, cost -229.176137665
Pre-training layer 1, epoch 10, cost -227.85666864
Pre-training layer 1, epoch 10, representative training free energy -86936.267207
Pre-training layer 1, epoch 10, validation free energy -86159.9460742
Pre-training layer 1, epoch 11, cost -226.600902466
Pre-training layer 1, epoch 12, cost -225.537421875
Pre-training layer 1, epoch 13, cost -224.623603668
Pre-training layer 1, epoch 14, cost -223.837411987
Pre-training layer 1, epoch 15, cost -223.076299927
Pre-training layer 1, epoch 15, representative training free energy -90743.0721875
Pre-training layer 1, epoch 15, validation free energy -89935.5888047
Pre-training layer 1, epoch 16, cost -222.43815564
Pre-training layer 1, epoch 17, cost -221.882270355
Pre-training layer 1, epoch 18, cost -221.283059998
Pre-training layer 1, epoch 19, cost -220.763346832
Pre-training layer 1, epoch 20, cost -220.262272186
Pre-training layer 1, epoch 20, representative training free energy -93377.5284336
Pre-training layer 1, epoch 20, validation free energy -92547.4428359
Pre-training layer 1, epoch 21, cost -219.85461145
Pre-training layer 1, epoch 22, cost -219.450485352
Pre-training layer 1, epoch 23, cost -219.122785156
Pre-training layer 1, epoch 24, cost -218.64482132
Pre-training layer 1, epoch 25, cost -218.358551575
Pre-training layer 1, epoch 25, representative training free energy -95475.0653516
Pre-training layer 1, epoch 25, validation free energy -94619.663043
Pre-training layer 1, epoch 26, cost -217.968055756
Pre-training layer 1, epoch 27, cost -217.68653476
Pre-training layer 1, epoch 28, cost -217.391095551
Pre-training layer 1, epoch 29, cost -217.161865875
Pre-training layer 1, epoch 30, cost -216.816957275
Pre-training layer 1, epoch 30, representative training free energy -97206.2831563
Pre-training layer 1, epoch 30, validation free energy -96336.9095195
Pre-training layer 1, epoch 31, cost -216.690969269
Pre-training layer 1, epoch 32, cost -216.431454468
Pre-training layer 1, epoch 33, cost -216.155933929
Pre-training layer 1, epoch 34, cost -215.988065765
Pre-training layer 1, epoch 35, cost -215.716981934
Pre-training layer 1, epoch 35, representative training free energy -98666.3769375
Pre-training layer 1, epoch 35, validation free energy -97778.6868203
Pre-training layer 1, epoch 36, cost -215.539682281
Pre-training layer 1, epoch 37, cost -215.365366913
Pre-training layer 1, epoch 38, cost -215.087167358
Pre-training layer 1, epoch 39, cost -214.959671692
Pre-training layer 1, epoch 40, cost -214.76420639
Pre-training layer 1, epoch 40, representative training free energy -99909.7265625
Pre-training layer 1, epoch 40, validation free energy -99012.2814062
Pre-training layer 1, epoch 41, cost -214.653648102
Pre-training layer 1, epoch 42, cost -214.394190643
Pre-training layer 1, epoch 43, cost -214.368140198
Pre-training layer 1, epoch 44, cost -214.1669133
Pre-training layer 1, epoch 45, cost -213.932068085
Pre-training layer 1, epoch 45, representative training free energy -101154.934555
Pre-training layer 1, epoch 45, validation free energy -100251.838687
Pre-training layer 1, epoch 46, cost -213.75913266
Pre-training layer 1, epoch 47, cost -213.756312103
Pre-training layer 1, epoch 48, cost -213.592922791
Pre-training layer 1, epoch 49, cost -213.440251923
Pre-training layer 1, epoch 50, cost -213.363607452
Pre-training layer 1, epoch 50, representative training free energy -102246.875148
Pre-training layer 1, epoch 50, validation free energy -101334.325313
Pre-training layer 1, epoch 51, cost -213.17493985
Pre-training layer 1, epoch 52, cost -213.037555115
Pre-training layer 1, epoch 53, cost -213.031695221
Pre-training layer 1, epoch 54, cost -212.872697723
Pre-training layer 1, epoch 55, cost -212.812416687
Pre-training layer 1, epoch 55, representative training free energy -103243.45593
Pre-training layer 1, epoch 55, validation free energy -102317.376211
Pre-training layer 1, epoch 56, cost -212.714684998
Pre-training layer 1, epoch 57, cost -212.507743744
Pre-training layer 1, epoch 58, cost -212.333999359
Pre-training layer 1, epoch 59, cost -212.296007233
Pre-training layer 1, epoch 60, cost -212.191263702
Pre-training layer 1, epoch 60, representative training free energy -104133.366914
Pre-training layer 1, epoch 60, validation free energy -103197.972836
Pre-training layer 1, epoch 61, cost -212.134372559
Pre-training layer 1, epoch 62, cost -212.081491486
Pre-training layer 1, epoch 63, cost -211.945198792
Pre-training layer 1, epoch 64, cost -211.779253479
Pre-training layer 1, epoch 65, cost -211.76221051
Pre-training layer 1, epoch 65, representative training free energy -105032.570094
Pre-training layer 1, epoch 65, validation free energy -104088.780734
Pre-training layer 1, epoch 66, cost -211.680615204
Pre-training layer 1, epoch 67, cost -211.573926575
Pre-training layer 1, epoch 68, cost -211.472099701
Pre-training layer 1, epoch 69, cost -211.452101624
Pre-training layer 1, epoch 70, cost -211.371167847
Pre-training layer 1, epoch 70, representative training free energy -105789.229594
Pre-training layer 1, epoch 70, validation free energy -104838.498328
Pre-training layer 1, epoch 71, cost -211.275909973
Pre-training layer 1, epoch 72, cost -211.194756104
Pre-training layer 1, epoch 73, cost -211.1348237
Pre-training layer 1, epoch 74, cost -211.011525848
Pre-training layer 1, epoch 75, cost -211.040320313
Pre-training layer 1, epoch 75, representative training free energy -106508.543398
Pre-training layer 1, epoch 75, validation free energy -105549.800805
Pre-training layer 1, epoch 76, cost -210.907535492
Pre-training layer 1, epoch 77, cost -210.854850128
Pre-training layer 1, epoch 78, cost -210.83108551
Pre-training layer 1, epoch 79, cost -210.70838504
Pre-training layer 1, epoch 80, cost -210.631223724
Pre-training layer 1, epoch 80, representative training free energy -107218.069953
Pre-training layer 1, epoch 80, validation free energy -106247.107687
Pre-training layer 1, epoch 81, cost -210.520165344
Pre-training layer 1, epoch 82, cost -210.503605743
Pre-training layer 1, epoch 83, cost -210.425960938
Pre-training layer 1, epoch 84, cost -210.343345795
Pre-training layer 1, epoch 85, cost -210.332455994
Pre-training layer 1, epoch 85, representative training free energy -107926.34275
Pre-training layer 1, epoch 85, validation free energy -106948.770312
Pre-training layer 1, epoch 86, cost -210.279405426
Pre-training layer 1, epoch 87, cost -210.313370331
Pre-training layer 1, epoch 88, cost -210.194386658
Pre-training layer 1, epoch 89, cost -210.11344989
Pre-training layer 1, epoch 90, cost -210.127092651
Pre-training layer 1, epoch 90, representative training free energy -108620.761773
Pre-training layer 1, epoch 90, validation free energy -107637.201867
Pre-training layer 1, epoch 91, cost -209.991662415
Pre-training layer 1, epoch 92, cost -209.977833405
Pre-training layer 1, epoch 93, cost -209.77277713
Pre-training layer 1, epoch 94, cost -209.823853149
Pre-training layer 1, epoch 95, cost -209.809406158
Pre-training layer 1, epoch 95, representative training free energy -109209.510406
Pre-training layer 1, epoch 95, validation free energy -108217.452359
Pre-training layer 1, epoch 96, cost -209.783911041
Pre-training layer 1, epoch 97, cost -209.692464325
Pre-training layer 1, epoch 98, cost -209.650833252
Pre-training layer 1, epoch 99, cost -209.678823608
Pre-training layer 2, epoch 0, cost -113.2164505
Pre-training layer 2, epoch 0, representative training free energy 3980.06482251
Pre-training layer 2, epoch 0, validation free energy 3945.86558337
Pre-training layer 2, epoch 1, cost -85.1935619049
Pre-training layer 2, epoch 2, cost -79.1273575745
Pre-training layer 2, epoch 3, cost -75.6812404404
Pre-training layer 2, epoch 4, cost -73.3855046387
Pre-training layer 2, epoch 5, cost -71.6006615448
Pre-training layer 2, epoch 5, representative training free energy 6741.61973242
Pre-training layer 2, epoch 5, validation free energy 6677.04135205
Pre-training layer 2, epoch 6, cost -70.3959025726
Pre-training layer 2, epoch 7, cost -69.3974986572
Pre-training layer 2, epoch 8, cost -68.4881238632
Pre-training layer 2, epoch 9, cost -67.6686482162
Pre-training layer 2, epoch 10, cost -67.0463694687
Pre-training layer 2, epoch 10, representative training free energy 8100.71351318
Pre-training layer 2, epoch 10, validation free energy 8025.94399561
Pre-training layer 2, epoch 11, cost -66.6339769211
Pre-training layer 2, epoch 12, cost -66.1636949921
Pre-training layer 2, epoch 13, cost -65.6174428635
Pre-training layer 2, epoch 14, cost -65.2954292374
Pre-training layer 2, epoch 15, cost -65.0364989929
Pre-training layer 2, epoch 15, representative training free energy 9076.35636914
Pre-training layer 2, epoch 15, validation free energy 8994.19348975
Pre-training layer 2, epoch 16, cost -64.6694737854
Pre-training layer 2, epoch 17, cost -64.3440048065
Pre-training layer 2, epoch 18, cost -64.054504425
Pre-training layer 2, epoch 19, cost -63.9122665405
Pre-training layer 2, epoch 20, cost -63.6823650055
Pre-training layer 2, epoch 20, representative training free energy 9792.09980713
Pre-training layer 2, epoch 20, validation free energy 9703.50724902
Pre-training layer 2, epoch 21, cost -63.4859719009
Pre-training layer 2, epoch 22, cost -63.2679897232
Pre-training layer 2, epoch 23, cost -63.1612895126
Pre-training layer 2, epoch 24, cost -62.9760089645
Pre-training layer 2, epoch 25, cost -62.85969133
Pre-training layer 2, epoch 25, representative training free energy 10419.2968965
Pre-training layer 2, epoch 25, validation free energy 10324.6633569
Pre-training layer 2, epoch 26, cost -62.7477439041
Pre-training layer 2, epoch 27, cost -62.5395158005
Pre-training layer 2, epoch 28, cost -62.4714938126
Pre-training layer 2, epoch 29, cost -62.3245837936
Pre-training layer 2, epoch 30, cost -62.2586868744
Pre-training layer 2, epoch 30, representative training free energy 10936.4928413
Pre-training layer 2, epoch 30, validation free energy 10836.6028877
Pre-training layer 2, epoch 31, cost -62.1214868088
Pre-training layer 2, epoch 32, cost -61.9840677185
Pre-training layer 2, epoch 33, cost -61.9340247421
Pre-training layer 2, epoch 34, cost -61.78275737
Pre-training layer 2, epoch 35, cost -61.7462742233
Pre-training layer 2, epoch 35, representative training free energy 11431.2413887
Pre-training layer 2, epoch 35, validation free energy 11327.6286831
Pre-training layer 2, epoch 36, cost -61.6969922867
Pre-training layer 2, epoch 37, cost -61.6203888092
Pre-training layer 2, epoch 38, cost -61.5224802322
Pre-training layer 2, epoch 39, cost -61.3982623596
Pre-training layer 2, epoch 40, cost -61.4825130081
Pre-training layer 2, epoch 40, representative training free energy 11877.2834902
Pre-training layer 2, epoch 40, validation free energy 11770.1029917
Pre-training layer 2, epoch 41, cost -61.2203017883
Pre-training layer 2, epoch 42, cost -61.2452921448
Pre-training layer 2, epoch 43, cost -61.1982844391
Pre-training layer 2, epoch 44, cost -61.1054049988
Pre-training layer 2, epoch 45, cost -61.1630581741
Pre-training layer 2, epoch 45, representative training free energy 12288.4569688
Pre-training layer 2, epoch 45, validation free energy 12176.8364561
Pre-training layer 2, epoch 46, cost -61.0659243393
Pre-training layer 2, epoch 47, cost -60.9357732086
Pre-training layer 2, epoch 48, cost -60.9093500366
Pre-training layer 2, epoch 49, cost -60.7789566879
Pre-training layer 2, epoch 50, cost -60.7620836945
Pre-training layer 2, epoch 50, representative training free energy 12701.9010303
Pre-training layer 2, epoch 50, validation free energy 12587.0861826
Pre-training layer 2, epoch 51, cost -60.8162568436
Pre-training layer 2, epoch 52, cost -60.6943012772
Pre-training layer 2, epoch 53, cost -60.6424041519
Pre-training layer 2, epoch 54, cost -60.6042409821
Pre-training layer 2, epoch 55, cost -60.5550183182
Pre-training layer 2, epoch 55, representative training free energy 13045.7583789
Pre-training layer 2, epoch 55, validation free energy 12928.310874
Pre-training layer 2, epoch 56, cost -60.5032040176
Pre-training layer 2, epoch 57, cost -60.4945920868
Pre-training layer 2, epoch 58, cost -60.4425901642
Pre-training layer 2, epoch 59, cost -60.4119694824
Pre-training layer 2, epoch 60, cost -60.3285452957
Pre-training layer 2, epoch 60, representative training free energy 13409.0555605
Pre-training layer 2, epoch 60, validation free energy 13287.6540576
Pre-training layer 2, epoch 61, cost -60.3311184692
Pre-training layer 2, epoch 62, cost -60.326890625
Pre-training layer 2, epoch 63, cost -60.2122474899
Pre-training layer 2, epoch 64, cost -60.2412802505
Pre-training layer 2, epoch 65, cost -60.1888759155
Pre-training layer 2, epoch 65, representative training free energy 13753.9010508
Pre-training layer 2, epoch 65, validation free energy 13630.0151865
Pre-training layer 2, epoch 66, cost -60.2213018036
Pre-training layer 2, epoch 67, cost -60.109473587
Pre-training layer 2, epoch 68, cost -60.0941569901
Pre-training layer 2, epoch 69, cost -60.0663488312
Pre-training layer 2, epoch 70, cost -60.0373093262
Pre-training layer 2, epoch 70, representative training free energy 14070.398959
Pre-training layer 2, epoch 70, validation free energy 13944.2917256
Pre-training layer 2, epoch 71, cost -60.0605413513
Pre-training layer 2, epoch 72, cost -59.9628218536
Pre-training layer 2, epoch 73, cost -59.8793709488
Pre-training layer 2, epoch 74, cost -59.9189706345
Pre-training layer 2, epoch 75, cost -59.8963362579
Pre-training layer 2, epoch 75, representative training free energy 14383.2167822
Pre-training layer 2, epoch 75, validation free energy 14253.9320225
Pre-training layer 2, epoch 76, cost -59.863946106
Pre-training layer 2, epoch 77, cost -59.8271527176
Pre-training layer 2, epoch 78, cost -59.7933001404
Pre-training layer 2, epoch 79, cost -59.7457410202
Pre-training layer 2, epoch 80, cost -59.8123814011
Pre-training layer 2, epoch 80, representative training free energy 14688.9330459
Pre-training layer 2, epoch 80, validation free energy 14557.6426074
Pre-training layer 2, epoch 81, cost -59.7409160461
Pre-training layer 2, epoch 82, cost -59.6126258087
Pre-training layer 2, epoch 83, cost -59.6540465317
Pre-training layer 2, epoch 84, cost -59.6236473541
Pre-training layer 2, epoch 85, cost -59.6516296844
Pre-training layer 2, epoch 85, representative training free energy 15010.0348535
Pre-training layer 2, epoch 85, validation free energy 14875.6356064
Pre-training layer 2, epoch 86, cost -59.6618205872
Pre-training layer 2, epoch 87, cost -59.5826812286
Pre-training layer 2, epoch 88, cost -59.5914106445
Pre-training layer 2, epoch 89, cost -59.5937915344
Pre-training layer 2, epoch 90, cost -59.5493034439
Pre-training layer 2, epoch 90, representative training free energy 15255.6895469
Pre-training layer 2, epoch 90, validation free energy 15118.7950645
Pre-training layer 2, epoch 91, cost -59.4783943253
Pre-training layer 2, epoch 92, cost -59.533547287
Pre-training layer 2, epoch 93, cost -59.4906356201
Pre-training layer 2, epoch 94, cost -59.4038378372
Pre-training layer 2, epoch 95, cost -59.4658470001
Pre-training layer 2, epoch 95, representative training free energy 15579.1093154
Pre-training layer 2, epoch 95, validation free energy 15440.0669551
Pre-training layer 2, epoch 96, cost -59.4013172226
Pre-training layer 2, epoch 97, cost -59.380077858
Pre-training layer 2, epoch 98, cost -59.3091275787
Pre-training layer 2, epoch 99, cost -59.3233773422
The pretraining code for file dbn_loop.pyc ran for 13.44m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 33.000000 %
     epoch 1, minibatch 500/500, test error of best model 28.000000 %
epoch 2, minibatch 500/500, validation error 24.200000 %
     epoch 2, minibatch 500/500, test error of best model 17.600000 %
epoch 3, minibatch 500/500, validation error 22.600000 %
     epoch 3, minibatch 500/500, test error of best model 14.600000 %
epoch 4, minibatch 500/500, validation error 20.800000 %
     epoch 4, minibatch 500/500, test error of best model 13.000000 %
epoch 5, minibatch 500/500, validation error 20.400000 %
     epoch 5, minibatch 500/500, test error of best model 12.400000 %
epoch 6, minibatch 500/500, validation error 20.200000 %
     epoch 6, minibatch 500/500, test error of best model 11.400000 %
epoch 7, minibatch 500/500, validation error 19.400000 %
     epoch 7, minibatch 500/500, test error of best model 10.600000 %
epoch 8, minibatch 500/500, validation error 19.000000 %
     epoch 8, minibatch 500/500, test error of best model 9.400000 %
epoch 9, minibatch 500/500, validation error 18.600000 %
     epoch 9, minibatch 500/500, test error of best model 8.000000 %
epoch 10, minibatch 500/500, validation error 17.800000 %
     epoch 10, minibatch 500/500, test error of best model 7.200000 %
epoch 11, minibatch 500/500, validation error 17.800000 %
     epoch 11, minibatch 500/500, test error of best model 6.600000 %
epoch 12, minibatch 500/500, validation error 17.600000 %
     epoch 12, minibatch 500/500, test error of best model 5.800000 %
epoch 13, minibatch 500/500, validation error 17.400000 %
     epoch 13, minibatch 500/500, test error of best model 5.200000 %
epoch 14, minibatch 500/500, validation error 17.000000 %
     epoch 14, minibatch 500/500, test error of best model 5.200000 %
epoch 15, minibatch 500/500, validation error 16.400000 %
     epoch 15, minibatch 500/500, test error of best model 5.200000 %
epoch 16, minibatch 500/500, validation error 16.400000 %
epoch 17, minibatch 500/500, validation error 16.400000 %
epoch 18, minibatch 500/500, validation error 16.400000 %
epoch 19, minibatch 500/500, validation error 16.400000 %
epoch 20, minibatch 500/500, validation error 16.400000 %
epoch 21, minibatch 500/500, validation error 16.400000 %
epoch 22, minibatch 500/500, validation error 16.600000 %
epoch 23, minibatch 500/500, validation error 16.200000 %
     epoch 23, minibatch 500/500, test error of best model 4.600000 %
epoch 24, minibatch 500/500, validation error 16.000000 %
     epoch 24, minibatch 500/500, test error of best model 4.600000 %
epoch 25, minibatch 500/500, validation error 16.000000 %
epoch 26, minibatch 500/500, validation error 16.000000 %
epoch 27, minibatch 500/500, validation error 15.800000 %
     epoch 27, minibatch 500/500, test error of best model 4.800000 %
epoch 28, minibatch 500/500, validation error 15.600000 %
     epoch 28, minibatch 500/500, test error of best model 4.800000 %
epoch 29, minibatch 500/500, validation error 15.400000 %
     epoch 29, minibatch 500/500, test error of best model 4.800000 %
epoch 30, minibatch 500/500, validation error 15.200000 %
     epoch 30, minibatch 500/500, test error of best model 4.800000 %
epoch 31, minibatch 500/500, validation error 15.200000 %
epoch 32, minibatch 500/500, validation error 15.000000 %
     epoch 32, minibatch 500/500, test error of best model 4.800000 %
epoch 33, minibatch 500/500, validation error 15.000000 %
epoch 34, minibatch 500/500, validation error 15.000000 %
epoch 35, minibatch 500/500, validation error 14.800000 %
     epoch 35, minibatch 500/500, test error of best model 4.400000 %
epoch 36, minibatch 500/500, validation error 14.800000 %
epoch 37, minibatch 500/500, validation error 14.800000 %
epoch 38, minibatch 500/500, validation error 15.000000 %
epoch 39, minibatch 500/500, validation error 15.000000 %
epoch 40, minibatch 500/500, validation error 15.000000 %
epoch 41, minibatch 500/500, validation error 15.000000 %
epoch 42, minibatch 500/500, validation error 15.000000 %
epoch 43, minibatch 500/500, validation error 15.000000 %
epoch 44, minibatch 500/500, validation error 15.000000 %
epoch 45, minibatch 500/500, validation error 15.200000 %
epoch 46, minibatch 500/500, validation error 15.200000 %
epoch 47, minibatch 500/500, validation error 15.200000 %
epoch 48, minibatch 500/500, validation error 15.000000 %
epoch 49, minibatch 500/500, validation error 14.800000 %
     epoch 49, minibatch 500/500, test error of best model 4.600000 %
epoch 50, minibatch 500/500, validation error 14.600000 %
     epoch 50, minibatch 500/500, test error of best model 4.600000 %
epoch 51, minibatch 500/500, validation error 14.600000 %
epoch 52, minibatch 500/500, validation error 14.600000 %
epoch 53, minibatch 500/500, validation error 14.600000 %
epoch 54, minibatch 500/500, validation error 14.600000 %
epoch 55, minibatch 500/500, validation error 14.600000 %
epoch 56, minibatch 500/500, validation error 14.600000 %
epoch 57, minibatch 500/500, validation error 14.600000 %
epoch 58, minibatch 500/500, validation error 14.600000 %
epoch 59, minibatch 500/500, validation error 14.600000 %
epoch 60, minibatch 500/500, validation error 14.600000 %
epoch 61, minibatch 500/500, validation error 14.600000 %
epoch 62, minibatch 500/500, validation error 14.600000 %
epoch 63, minibatch 500/500, validation error 14.600000 %
epoch 64, minibatch 500/500, validation error 14.600000 %
epoch 65, minibatch 500/500, validation error 14.600000 %
epoch 66, minibatch 500/500, validation error 14.600000 %
epoch 67, minibatch 500/500, validation error 14.600000 %
epoch 68, minibatch 500/500, validation error 14.600000 %
epoch 69, minibatch 500/500, validation error 14.600000 %
epoch 70, minibatch 500/500, validation error 14.600000 %
epoch 71, minibatch 500/500, validation error 14.600000 %
epoch 72, minibatch 500/500, validation error 14.600000 %
epoch 73, minibatch 500/500, validation error 14.600000 %
epoch 74, minibatch 500/500, validation error 14.600000 %
epoch 75, minibatch 500/500, validation error 14.600000 %
epoch 76, minibatch 500/500, validation error 14.600000 %
epoch 77, minibatch 500/500, validation error 14.600000 %
epoch 78, minibatch 500/500, validation error 14.600000 %
epoch 79, minibatch 500/500, validation error 14.600000 %
epoch 80, minibatch 500/500, validation error 14.600000 %
epoch 81, minibatch 500/500, validation error 14.600000 %
epoch 82, minibatch 500/500, validation error 14.600000 %
epoch 83, minibatch 500/500, validation error 14.600000 %
epoch 84, minibatch 500/500, validation error 14.600000 %
epoch 85, minibatch 500/500, validation error 14.600000 %
epoch 86, minibatch 500/500, validation error 14.600000 %
epoch 87, minibatch 500/500, validation error 14.600000 %
epoch 88, minibatch 500/500, validation error 14.600000 %
epoch 89, minibatch 500/500, validation error 14.600000 %
epoch 90, minibatch 500/500, validation error 14.600000 %
epoch 91, minibatch 500/500, validation error 14.600000 %
epoch 92, minibatch 500/500, validation error 14.600000 %
epoch 93, minibatch 500/500, validation error 14.600000 %
epoch 94, minibatch 500/500, validation error 14.600000 %
epoch 95, minibatch 500/500, validation error 14.600000 %
epoch 96, minibatch 500/500, validation error 14.600000 %
epoch 97, minibatch 500/500, validation error 14.600000 %
epoch 98, minibatch 500/500, validation error 14.600000 %
epoch 99, minibatch 500/500, validation error 14.600000 %
Optimization complete with best validation score of 14.600000 %, obtained at iteration 25000, with test performance 4.600000 %
The fine tuning code for file dbn_loop.pyc ran for 3.94m
_______RUN: 3

==========Sample: (1000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.291581421
Pre-training layer 0, epoch 0, representative training free energy -597.722097656
Pre-training layer 0, epoch 0, validation free energy -592.542801147
Pre-training layer 0, epoch 1, cost -136.26484375
Pre-training layer 0, epoch 2, cost -125.244169235
Pre-training layer 0, epoch 3, cost -118.036446762
Pre-training layer 0, epoch 4, cost -113.519928741
Pre-training layer 0, epoch 5, cost -109.73345787
Pre-training layer 0, epoch 5, representative training free energy -550.57469574
Pre-training layer 0, epoch 5, validation free energy -538.446851807
Pre-training layer 0, epoch 6, cost -107.147205429
Pre-training layer 0, epoch 7, cost -104.437467422
Pre-training layer 0, epoch 8, cost -102.827260208
Pre-training layer 0, epoch 9, cost -100.721310883
Pre-training layer 0, epoch 10, cost -99.2954784393
Pre-training layer 0, epoch 10, representative training free energy -528.835841675
Pre-training layer 0, epoch 10, validation free energy -515.413350647
Pre-training layer 0, epoch 11, cost -98.0430264282
Pre-training layer 0, epoch 12, cost -96.5579216766
Pre-training layer 0, epoch 13, cost -95.3806038666
Pre-training layer 0, epoch 14, cost -94.4139290619
Pre-training layer 0, epoch 15, cost -93.6772154236
Pre-training layer 0, epoch 15, representative training free energy -521.883769226
Pre-training layer 0, epoch 15, validation free energy -507.481095032
Pre-training layer 0, epoch 16, cost -92.8635403442
Pre-training layer 0, epoch 17, cost -92.1471430206
Pre-training layer 0, epoch 18, cost -91.14315979
Pre-training layer 0, epoch 19, cost -90.1642979431
Pre-training layer 0, epoch 20, cost -90.0269277191
Pre-training layer 0, epoch 20, representative training free energy -510.677542053
Pre-training layer 0, epoch 20, validation free energy -495.130558899
Pre-training layer 0, epoch 21, cost -89.327401123
Pre-training layer 0, epoch 22, cost -88.8561817169
Pre-training layer 0, epoch 23, cost -88.1341452789
Pre-training layer 0, epoch 24, cost -87.7563883972
Pre-training layer 0, epoch 25, cost -87.3565100861
Pre-training layer 0, epoch 25, representative training free energy -503.704328003
Pre-training layer 0, epoch 25, validation free energy -487.688676208
Pre-training layer 0, epoch 26, cost -86.7197967529
Pre-training layer 0, epoch 27, cost -86.3755389404
Pre-training layer 0, epoch 28, cost -85.7955110168
Pre-training layer 0, epoch 29, cost -85.7289674377
Pre-training layer 0, epoch 30, cost -85.1694971466
Pre-training layer 0, epoch 30, representative training free energy -502.237348145
Pre-training layer 0, epoch 30, validation free energy -485.200520081
Pre-training layer 0, epoch 31, cost -84.9262634277
Pre-training layer 0, epoch 32, cost -84.6950042725
Pre-training layer 0, epoch 33, cost -84.0690821075
Pre-training layer 0, epoch 34, cost -83.9015377808
Pre-training layer 0, epoch 35, cost -83.3590641785
Pre-training layer 0, epoch 35, representative training free energy -494.300395813
Pre-training layer 0, epoch 35, validation free energy -477.019926392
Pre-training layer 0, epoch 36, cost -83.0181938934
Pre-training layer 0, epoch 37, cost -82.933690033
Pre-training layer 0, epoch 38, cost -82.4609626007
Pre-training layer 0, epoch 39, cost -82.3890596771
Pre-training layer 0, epoch 40, cost -82.2677882385
Pre-training layer 0, epoch 40, representative training free energy -488.380121399
Pre-training layer 0, epoch 40, validation free energy -470.911464417
Pre-training layer 0, epoch 41, cost -81.7746437073
Pre-training layer 0, epoch 42, cost -81.9225741577
Pre-training layer 0, epoch 43, cost -81.567827301
Pre-training layer 0, epoch 44, cost -81.1440568542
Pre-training layer 0, epoch 45, cost -81.1152015686
Pre-training layer 0, epoch 45, representative training free energy -485.979963257
Pre-training layer 0, epoch 45, validation free energy -467.902291443
Pre-training layer 0, epoch 46, cost -80.8251648712
Pre-training layer 0, epoch 47, cost -80.6938456345
Pre-training layer 0, epoch 48, cost -80.20991539
Pre-training layer 0, epoch 49, cost -79.8652741623
Pre-training layer 0, epoch 50, cost -80.1431702042
Pre-training layer 0, epoch 50, representative training free energy -481.524218811
Pre-training layer 0, epoch 50, validation free energy -462.607797058
Pre-training layer 0, epoch 51, cost -79.7381133652
Pre-training layer 0, epoch 52, cost -79.6789757919
Pre-training layer 0, epoch 53, cost -79.3379313278
Pre-training layer 0, epoch 54, cost -79.0914322662
Pre-training layer 0, epoch 55, cost -79.1019897461
Pre-training layer 0, epoch 55, representative training free energy -481.783579407
Pre-training layer 0, epoch 55, validation free energy -462.74863678
Pre-training layer 0, epoch 56, cost -78.756685257
Pre-training layer 0, epoch 57, cost -78.6938639069
Pre-training layer 0, epoch 58, cost -78.4692815781
Pre-training layer 0, epoch 59, cost -78.5582284546
Pre-training layer 0, epoch 60, cost -78.5196956635
Pre-training layer 0, epoch 60, representative training free energy -479.432644775
Pre-training layer 0, epoch 60, validation free energy -459.973079834
Pre-training layer 0, epoch 61, cost -78.0391756058
Pre-training layer 0, epoch 62, cost -78.1399066162
Pre-training layer 0, epoch 63, cost -78.0639173126
Pre-training layer 0, epoch 64, cost -77.7863054276
Pre-training layer 0, epoch 65, cost -77.4718377304
Pre-training layer 0, epoch 65, representative training free energy -479.232291382
Pre-training layer 0, epoch 65, validation free energy -459.345876587
Pre-training layer 0, epoch 66, cost -77.1401027679
Pre-training layer 0, epoch 67, cost -77.1406630707
Pre-training layer 0, epoch 68, cost -77.4375562286
Pre-training layer 0, epoch 69, cost -77.1488792419
Pre-training layer 0, epoch 70, cost -77.1789409256
Pre-training layer 0, epoch 70, representative training free energy -477.89949176
Pre-training layer 0, epoch 70, validation free energy -457.70501886
Pre-training layer 0, epoch 71, cost -77.1380825043
Pre-training layer 0, epoch 72, cost -76.6473837662
Pre-training layer 0, epoch 73, cost -76.6097200012
Pre-training layer 0, epoch 74, cost -76.629922905
Pre-training layer 0, epoch 75, cost -76.4397632599
Pre-training layer 0, epoch 75, representative training free energy -474.477426636
Pre-training layer 0, epoch 75, validation free energy -453.980700684
Pre-training layer 0, epoch 76, cost -76.226572113
Pre-training layer 0, epoch 77, cost -76.2181409454
Pre-training layer 0, epoch 78, cost -76.3526864243
Pre-training layer 0, epoch 79, cost -76.0017159653
Pre-training layer 0, epoch 80, cost -75.772341423
Pre-training layer 0, epoch 80, representative training free energy -472.097985535
Pre-training layer 0, epoch 80, validation free energy -451.538975098
Pre-training layer 0, epoch 81, cost -75.8764129257
Pre-training layer 0, epoch 82, cost -75.5735549545
Pre-training layer 0, epoch 83, cost -75.4650820541
Pre-training layer 0, epoch 84, cost -75.4077810287
Pre-training layer 0, epoch 85, cost -75.4877755356
Pre-training layer 0, epoch 85, representative training free energy -469.872247498
Pre-training layer 0, epoch 85, validation free energy -448.692916931
Pre-training layer 0, epoch 86, cost -75.343090744
Pre-training layer 0, epoch 87, cost -75.1459650421
Pre-training layer 0, epoch 88, cost -75.1613885498
Pre-training layer 0, epoch 89, cost -75.0668210602
Pre-training layer 0, epoch 90, cost -74.8830973053
Pre-training layer 0, epoch 90, representative training free energy -473.363730225
Pre-training layer 0, epoch 90, validation free energy -452.396926392
Pre-training layer 0, epoch 91, cost -74.9487140656
Pre-training layer 0, epoch 92, cost -74.7331707764
Pre-training layer 0, epoch 93, cost -74.8588639832
Pre-training layer 0, epoch 94, cost -74.7615189362
Pre-training layer 0, epoch 95, cost -74.4020584869
Pre-training layer 0, epoch 95, representative training free energy -471.739033264
Pre-training layer 0, epoch 95, validation free energy -450.296351135
Pre-training layer 0, epoch 96, cost -74.5014362335
Pre-training layer 0, epoch 97, cost -74.2389093781
Pre-training layer 0, epoch 98, cost -74.013998642
Pre-training layer 0, epoch 99, cost -74.0353861618
Pre-training layer 1, epoch 0, cost -431.765223999
Pre-training layer 1, epoch 0, representative training free energy -32276.5442598
Pre-training layer 1, epoch 0, validation free energy -31957.3331445
Pre-training layer 1, epoch 1, cost -370.711619873
Pre-training layer 1, epoch 2, cost -351.220275269
Pre-training layer 1, epoch 3, cost -339.502866211
Pre-training layer 1, epoch 4, cost -331.121862183
Pre-training layer 1, epoch 5, cost -324.943829956
Pre-training layer 1, epoch 5, representative training free energy -46036.0382871
Pre-training layer 1, epoch 5, validation free energy -45657.89725
Pre-training layer 1, epoch 6, cost -319.953254395
Pre-training layer 1, epoch 7, cost -315.730461121
Pre-training layer 1, epoch 8, cost -312.137929993
Pre-training layer 1, epoch 9, cost -309.235039368
Pre-training layer 1, epoch 10, cost -306.51021698
Pre-training layer 1, epoch 10, representative training free energy -50426.9498789
Pre-training layer 1, epoch 10, validation free energy -50036.5894414
Pre-training layer 1, epoch 11, cost -304.190019226
Pre-training layer 1, epoch 12, cost -302.310886841
Pre-training layer 1, epoch 13, cost -300.543803711
Pre-training layer 1, epoch 14, cost -298.676484985
Pre-training layer 1, epoch 15, cost -297.006591339
Pre-training layer 1, epoch 15, representative training free energy -52884.3301094
Pre-training layer 1, epoch 15, validation free energy -52499.6428574
Pre-training layer 1, epoch 16, cost -295.486314087
Pre-training layer 1, epoch 17, cost -294.337227478
Pre-training layer 1, epoch 18, cost -292.971757813
Pre-training layer 1, epoch 19, cost -292.04427887
Pre-training layer 1, epoch 20, cost -291.125795288
Pre-training layer 1, epoch 20, representative training free energy -54703.0691094
Pre-training layer 1, epoch 20, validation free energy -54318.2609941
Pre-training layer 1, epoch 21, cost -289.990569458
Pre-training layer 1, epoch 22, cost -289.35729187
Pre-training layer 1, epoch 23, cost -288.259124756
Pre-training layer 1, epoch 24, cost -287.45536438
Pre-training layer 1, epoch 25, cost -287.018671265
Pre-training layer 1, epoch 25, representative training free energy -55980.6069805
Pre-training layer 1, epoch 25, validation free energy -55589.8913906
Pre-training layer 1, epoch 26, cost -286.088570709
Pre-training layer 1, epoch 27, cost -285.449320984
Pre-training layer 1, epoch 28, cost -284.625370636
Pre-training layer 1, epoch 29, cost -284.102847748
Pre-training layer 1, epoch 30, cost -283.460942078
Pre-training layer 1, epoch 30, representative training free energy -56970.4541289
Pre-training layer 1, epoch 30, validation free energy -56574.4987891
Pre-training layer 1, epoch 31, cost -282.937464142
Pre-training layer 1, epoch 32, cost -282.576380157
Pre-training layer 1, epoch 33, cost -282.264219513
Pre-training layer 1, epoch 34, cost -281.542003632
Pre-training layer 1, epoch 35, cost -281.096345825
Pre-training layer 1, epoch 35, representative training free energy -57922.3019727
Pre-training layer 1, epoch 35, validation free energy -57523.1376797
Pre-training layer 1, epoch 36, cost -280.722697449
Pre-training layer 1, epoch 37, cost -279.998054657
Pre-training layer 1, epoch 38, cost -279.912106628
Pre-training layer 1, epoch 39, cost -279.408733978
Pre-training layer 1, epoch 40, cost -279.085930786
Pre-training layer 1, epoch 40, representative training free energy -58751.0319922
Pre-training layer 1, epoch 40, validation free energy -58341.6185039
Pre-training layer 1, epoch 41, cost -278.914585419
Pre-training layer 1, epoch 42, cost -278.164702606
Pre-training layer 1, epoch 43, cost -278.110507202
Pre-training layer 1, epoch 44, cost -277.710056458
Pre-training layer 1, epoch 45, cost -277.179673309
Pre-training layer 1, epoch 45, representative training free energy -59382.6982461
Pre-training layer 1, epoch 45, validation free energy -58971.9774023
Pre-training layer 1, epoch 46, cost -277.131440277
Pre-training layer 1, epoch 47, cost -276.734124451
Pre-training layer 1, epoch 48, cost -276.412035065
Pre-training layer 1, epoch 49, cost -276.303396301
Pre-training layer 1, epoch 50, cost -276.006487122
Pre-training layer 1, epoch 50, representative training free energy -60046.3110039
Pre-training layer 1, epoch 50, validation free energy -59637.3255234
Pre-training layer 1, epoch 51, cost -275.661660004
Pre-training layer 1, epoch 52, cost -275.352743378
Pre-training layer 1, epoch 53, cost -275.284857483
Pre-training layer 1, epoch 54, cost -275.041945648
Pre-training layer 1, epoch 55, cost -274.940792236
Pre-training layer 1, epoch 55, representative training free energy -60542.6766523
Pre-training layer 1, epoch 55, validation free energy -60123.8017188
Pre-training layer 1, epoch 56, cost -274.626357117
Pre-training layer 1, epoch 57, cost -274.329756775
Pre-training layer 1, epoch 58, cost -273.983038788
Pre-training layer 1, epoch 59, cost -273.768603668
Pre-training layer 1, epoch 60, cost -273.842499084
Pre-training layer 1, epoch 60, representative training free energy -61028.4001992
Pre-training layer 1, epoch 60, validation free energy -60607.3810156
Pre-training layer 1, epoch 61, cost -273.562320557
Pre-training layer 1, epoch 62, cost -273.343149567
Pre-training layer 1, epoch 63, cost -273.060049744
Pre-training layer 1, epoch 64, cost -273.04289032
Pre-training layer 1, epoch 65, cost -272.824004822
Pre-training layer 1, epoch 65, representative training free energy -61546.2284102
Pre-training layer 1, epoch 65, validation free energy -61127.2887734
Pre-training layer 1, epoch 66, cost -272.691711884
Pre-training layer 1, epoch 67, cost -272.832155151
Pre-training layer 1, epoch 68, cost -272.34365921
Pre-training layer 1, epoch 69, cost -272.208233643
Pre-training layer 1, epoch 70, cost -271.947303772
Pre-training layer 1, epoch 70, representative training free energy -61995.4599141
Pre-training layer 1, epoch 70, validation free energy -61571.9799883
Pre-training layer 1, epoch 71, cost -271.911865845
Pre-training layer 1, epoch 72, cost -271.758820343
Pre-training layer 1, epoch 73, cost -271.500083618
Pre-training layer 1, epoch 74, cost -271.384250336
Pre-training layer 1, epoch 75, cost -271.221429596
Pre-training layer 1, epoch 75, representative training free energy -62353.5209023
Pre-training layer 1, epoch 75, validation free energy -61929.7877227
Pre-training layer 1, epoch 76, cost -271.196995392
Pre-training layer 1, epoch 77, cost -271.041847229
Pre-training layer 1, epoch 78, cost -270.973374939
Pre-training layer 1, epoch 79, cost -270.674519958
Pre-training layer 1, epoch 80, cost -270.674977875
Pre-training layer 1, epoch 80, representative training free energy -62744.5236406
Pre-training layer 1, epoch 80, validation free energy -62320.9939961
Pre-training layer 1, epoch 81, cost -270.396974792
Pre-training layer 1, epoch 82, cost -270.485342255
Pre-training layer 1, epoch 83, cost -270.278092804
Pre-training layer 1, epoch 84, cost -270.276184845
Pre-training layer 1, epoch 85, cost -270.002508698
Pre-training layer 1, epoch 85, representative training free energy -63131.2619258
Pre-training layer 1, epoch 85, validation free energy -62700.06125
Pre-training layer 1, epoch 86, cost -270.078276215
Pre-training layer 1, epoch 87, cost -269.853343201
Pre-training layer 1, epoch 88, cost -269.88350296
Pre-training layer 1, epoch 89, cost -269.612745361
Pre-training layer 1, epoch 90, cost -269.534915619
Pre-training layer 1, epoch 90, representative training free energy -63389.8677773
Pre-training layer 1, epoch 90, validation free energy -62959.1556758
Pre-training layer 1, epoch 91, cost -269.441914063
Pre-training layer 1, epoch 92, cost -269.541353455
Pre-training layer 1, epoch 93, cost -269.221508789
Pre-training layer 1, epoch 94, cost -269.175086212
Pre-training layer 1, epoch 95, cost -268.943424683
Pre-training layer 1, epoch 95, representative training free energy -63719.4912031
Pre-training layer 1, epoch 95, validation free energy -63287.7089336
Pre-training layer 1, epoch 96, cost -269.186331635
Pre-training layer 1, epoch 97, cost -269.105440521
Pre-training layer 1, epoch 98, cost -268.916049652
Pre-training layer 1, epoch 99, cost -268.80010025
Pre-training layer 2, epoch 0, cost -160.038699646
Pre-training layer 2, epoch 0, representative training free energy 1781.75850793
Pre-training layer 2, epoch 0, validation free energy 1802.15308496
Pre-training layer 2, epoch 1, cost -106.303401413
Pre-training layer 2, epoch 2, cost -96.0905871582
Pre-training layer 2, epoch 3, cost -90.7919216919
Pre-training layer 2, epoch 4, cost -86.8982846832
Pre-training layer 2, epoch 5, cost -83.8557092285
Pre-training layer 2, epoch 5, representative training free energy 2626.9049165
Pre-training layer 2, epoch 5, validation free energy 2622.41515771
Pre-training layer 2, epoch 6, cost -81.8064949799
Pre-training layer 2, epoch 7, cost -80.0215839386
Pre-training layer 2, epoch 8, cost -78.857191658
Pre-training layer 2, epoch 9, cost -77.4985111237
Pre-training layer 2, epoch 10, cost -76.4046096802
Pre-training layer 2, epoch 10, representative training free energy 3006.74990845
Pre-training layer 2, epoch 10, validation free energy 2992.60435889
Pre-training layer 2, epoch 11, cost -75.2665247345
Pre-training layer 2, epoch 12, cost -74.5799047089
Pre-training layer 2, epoch 13, cost -73.8137526321
Pre-training layer 2, epoch 14, cost -73.1924713898
Pre-training layer 2, epoch 15, cost -72.3544216156
Pre-training layer 2, epoch 15, representative training free energy 3287.22898938
Pre-training layer 2, epoch 15, validation free energy 3266.6642074
Pre-training layer 2, epoch 16, cost -72.0710882187
Pre-training layer 2, epoch 17, cost -71.4162844086
Pre-training layer 2, epoch 18, cost -70.9395724869
Pre-training layer 2, epoch 19, cost -70.3677417755
Pre-training layer 2, epoch 20, cost -70.0284040833
Pre-training layer 2, epoch 20, representative training free energy 3518.32299951
Pre-training layer 2, epoch 20, validation free energy 3491.97806592
Pre-training layer 2, epoch 21, cost -69.8146524429
Pre-training layer 2, epoch 22, cost -69.3249727249
Pre-training layer 2, epoch 23, cost -69.1291693878
Pre-training layer 2, epoch 24, cost -68.6367421341
Pre-training layer 2, epoch 25, cost -68.2828294373
Pre-training layer 2, epoch 25, representative training free energy 3727.59473462
Pre-training layer 2, epoch 25, validation free energy 3696.55406299
Pre-training layer 2, epoch 26, cost -68.0389702988
Pre-training layer 2, epoch 27, cost -67.6893045425
Pre-training layer 2, epoch 28, cost -67.5901779175
Pre-training layer 2, epoch 29, cost -67.4104003525
Pre-training layer 2, epoch 30, cost -66.9948012924
Pre-training layer 2, epoch 30, representative training free energy 3913.87258984
Pre-training layer 2, epoch 30, validation free energy 3880.14100537
Pre-training layer 2, epoch 31, cost -67.0260383224
Pre-training layer 2, epoch 32, cost -66.8459757996
Pre-training layer 2, epoch 33, cost -66.7620695114
Pre-training layer 2, epoch 34, cost -66.3275722885
Pre-training layer 2, epoch 35, cost -66.1167106628
Pre-training layer 2, epoch 35, representative training free energy 4082.60883789
Pre-training layer 2, epoch 35, validation free energy 4046.65071973
Pre-training layer 2, epoch 36, cost -65.7101948929
Pre-training layer 2, epoch 37, cost -65.8031547928
Pre-training layer 2, epoch 38, cost -65.4435631943
Pre-training layer 2, epoch 39, cost -65.4921943283
Pre-training layer 2, epoch 40, cost -65.2445318604
Pre-training layer 2, epoch 40, representative training free energy 4227.48369116
Pre-training layer 2, epoch 40, validation free energy 4191.62238623
Pre-training layer 2, epoch 41, cost -65.3665185928
Pre-training layer 2, epoch 42, cost -65.0436909103
Pre-training layer 2, epoch 43, cost -64.9219353485
Pre-training layer 2, epoch 44, cost -64.6767208099
Pre-training layer 2, epoch 45, cost -64.6847491837
Pre-training layer 2, epoch 45, representative training free energy 4371.1003396
Pre-training layer 2, epoch 45, validation free energy 4333.29431128
Pre-training layer 2, epoch 46, cost -64.5891052628
Pre-training layer 2, epoch 47, cost -64.523391304
Pre-training layer 2, epoch 48, cost -64.2353908539
Pre-training layer 2, epoch 49, cost -64.3421052933
Pre-training layer 2, epoch 50, cost -64.0613500595
Pre-training layer 2, epoch 50, representative training free energy 4508.70123901
Pre-training layer 2, epoch 50, validation free energy 4469.31025562
Pre-training layer 2, epoch 51, cost -63.9681025696
Pre-training layer 2, epoch 52, cost -63.9416745758
Pre-training layer 2, epoch 53, cost -63.7669326782
Pre-training layer 2, epoch 54, cost -63.6908194733
Pre-training layer 2, epoch 55, cost -63.6865241241
Pre-training layer 2, epoch 55, representative training free energy 4626.33679565
Pre-training layer 2, epoch 55, validation free energy 4586.57031665
Pre-training layer 2, epoch 56, cost -63.3508003616
Pre-training layer 2, epoch 57, cost -63.5706903076
Pre-training layer 2, epoch 58, cost -63.4303784561
Pre-training layer 2, epoch 59, cost -63.322401886
Pre-training layer 2, epoch 60, cost -63.3411113358
Pre-training layer 2, epoch 60, representative training free energy 4752.68637231
Pre-training layer 2, epoch 60, validation free energy 4711.89167041
Pre-training layer 2, epoch 61, cost -63.0946611786
Pre-training layer 2, epoch 62, cost -62.9744220734
Pre-training layer 2, epoch 63, cost -62.9204847336
Pre-training layer 2, epoch 64, cost -62.9863358688
Pre-training layer 2, epoch 65, cost -62.9351966095
Pre-training layer 2, epoch 65, representative training free energy 4865.38874658
Pre-training layer 2, epoch 65, validation free energy 4822.58578882
Pre-training layer 2, epoch 66, cost -62.8456547928
Pre-training layer 2, epoch 67, cost -62.675247612
Pre-training layer 2, epoch 68, cost -62.6715036774
Pre-training layer 2, epoch 69, cost -62.5976380539
Pre-training layer 2, epoch 70, cost -62.4687355042
Pre-training layer 2, epoch 70, representative training free energy 4978.21746362
Pre-training layer 2, epoch 70, validation free energy 4934.14518506
Pre-training layer 2, epoch 71, cost -62.3988408661
Pre-training layer 2, epoch 72, cost -62.4525217438
Pre-training layer 2, epoch 73, cost -62.2292097855
Pre-training layer 2, epoch 74, cost -62.3408477783
Pre-training layer 2, epoch 75, cost -62.1725673294
Pre-training layer 2, epoch 75, representative training free energy 5088.10304517
Pre-training layer 2, epoch 75, validation free energy 5042.57620801
Pre-training layer 2, epoch 76, cost -62.312942543
Pre-training layer 2, epoch 77, cost -62.043356514
Pre-training layer 2, epoch 78, cost -62.0324430847
Pre-training layer 2, epoch 79, cost -62.1367524719
Pre-training layer 2, epoch 80, cost -62.0169331741
Pre-training layer 2, epoch 80, representative training free energy 5185.32222388
Pre-training layer 2, epoch 80, validation free energy 5138.6901145
Pre-training layer 2, epoch 81, cost -61.9052474213
Pre-training layer 2, epoch 82, cost -61.8747513962
Pre-training layer 2, epoch 83, cost -61.7599525452
Pre-training layer 2, epoch 84, cost -61.6770321274
Pre-training layer 2, epoch 85, cost -61.756258812
Pre-training layer 2, epoch 85, representative training free energy 5289.32192163
Pre-training layer 2, epoch 85, validation free energy 5240.52928491
Pre-training layer 2, epoch 86, cost -61.6951535416
Pre-training layer 2, epoch 87, cost -61.6309439087
Pre-training layer 2, epoch 88, cost -61.5580458069
Pre-training layer 2, epoch 89, cost -61.6294232178
Pre-training layer 2, epoch 90, cost -61.5608076477
Pre-training layer 2, epoch 90, representative training free energy 5390.10315967
Pre-training layer 2, epoch 90, validation free energy 5340.08630005
Pre-training layer 2, epoch 91, cost -61.4242923355
Pre-training layer 2, epoch 92, cost -61.3647303772
Pre-training layer 2, epoch 93, cost -61.4843559647
Pre-training layer 2, epoch 94, cost -61.3553710175
Pre-training layer 2, epoch 95, cost -61.300710907
Pre-training layer 2, epoch 95, representative training free energy 5493.51313208
Pre-training layer 2, epoch 95, validation free energy 5442.61183081
Pre-training layer 2, epoch 96, cost -61.1879444122
Pre-training layer 2, epoch 97, cost -61.2760951233
Pre-training layer 2, epoch 98, cost -61.2880249023
Pre-training layer 2, epoch 99, cost -61.196355896
The pretraining code for file dbn_loop.pyc ran for 2.71m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 32.200000 %
     epoch 1, minibatch 100/100, test error of best model 28.200000 %
epoch 2, minibatch 100/100, validation error 30.000000 %
     epoch 2, minibatch 100/100, test error of best model 21.800000 %
epoch 3, minibatch 100/100, validation error 26.200000 %
     epoch 3, minibatch 100/100, test error of best model 17.200000 %
epoch 4, minibatch 100/100, validation error 24.800000 %
     epoch 4, minibatch 100/100, test error of best model 17.000000 %
epoch 5, minibatch 100/100, validation error 24.600000 %
     epoch 5, minibatch 100/100, test error of best model 16.200000 %
epoch 6, minibatch 100/100, validation error 23.800000 %
     epoch 6, minibatch 100/100, test error of best model 16.000000 %
epoch 7, minibatch 100/100, validation error 23.000000 %
     epoch 7, minibatch 100/100, test error of best model 15.600000 %
epoch 8, minibatch 100/100, validation error 22.800000 %
     epoch 8, minibatch 100/100, test error of best model 15.000000 %
epoch 9, minibatch 100/100, validation error 22.800000 %
     epoch 9, minibatch 100/100, test error of best model 15.000000 %
epoch 10, minibatch 100/100, validation error 22.600000 %
     epoch 10, minibatch 100/100, test error of best model 14.200000 %
epoch 11, minibatch 100/100, validation error 22.000000 %
     epoch 11, minibatch 100/100, test error of best model 14.400000 %
epoch 12, minibatch 100/100, validation error 21.800000 %
     epoch 12, minibatch 100/100, test error of best model 13.000000 %
epoch 13, minibatch 100/100, validation error 21.800000 %
     epoch 13, minibatch 100/100, test error of best model 12.800000 %
epoch 14, minibatch 100/100, validation error 21.400000 %
     epoch 14, minibatch 100/100, test error of best model 12.400000 %
epoch 15, minibatch 100/100, validation error 21.200000 %
     epoch 15, minibatch 100/100, test error of best model 12.200000 %
epoch 16, minibatch 100/100, validation error 21.600000 %
epoch 17, minibatch 100/100, validation error 21.200000 %
epoch 18, minibatch 100/100, validation error 21.200000 %
epoch 19, minibatch 100/100, validation error 21.400000 %
epoch 20, minibatch 100/100, validation error 21.400000 %
epoch 21, minibatch 100/100, validation error 21.400000 %
epoch 22, minibatch 100/100, validation error 21.800000 %
epoch 23, minibatch 100/100, validation error 21.400000 %
epoch 24, minibatch 100/100, validation error 21.200000 %
epoch 25, minibatch 100/100, validation error 21.400000 %
epoch 26, minibatch 100/100, validation error 20.800000 %
     epoch 26, minibatch 100/100, test error of best model 12.000000 %
epoch 27, minibatch 100/100, validation error 20.800000 %
epoch 28, minibatch 100/100, validation error 21.000000 %
epoch 29, minibatch 100/100, validation error 21.000000 %
epoch 30, minibatch 100/100, validation error 21.000000 %
epoch 31, minibatch 100/100, validation error 21.000000 %
epoch 32, minibatch 100/100, validation error 21.000000 %
epoch 33, minibatch 100/100, validation error 20.800000 %
epoch 34, minibatch 100/100, validation error 20.800000 %
epoch 35, minibatch 100/100, validation error 20.800000 %
epoch 36, minibatch 100/100, validation error 20.800000 %
epoch 37, minibatch 100/100, validation error 20.600000 %
     epoch 37, minibatch 100/100, test error of best model 11.600000 %
epoch 38, minibatch 100/100, validation error 20.600000 %
epoch 39, minibatch 100/100, validation error 20.800000 %
epoch 40, minibatch 100/100, validation error 20.600000 %
epoch 41, minibatch 100/100, validation error 20.600000 %
epoch 42, minibatch 100/100, validation error 20.600000 %
epoch 43, minibatch 100/100, validation error 20.600000 %
epoch 44, minibatch 100/100, validation error 20.600000 %
epoch 45, minibatch 100/100, validation error 20.600000 %
epoch 46, minibatch 100/100, validation error 20.400000 %
     epoch 46, minibatch 100/100, test error of best model 12.000000 %
epoch 47, minibatch 100/100, validation error 20.400000 %
epoch 48, minibatch 100/100, validation error 20.400000 %
epoch 49, minibatch 100/100, validation error 20.400000 %
epoch 50, minibatch 100/100, validation error 20.400000 %
epoch 51, minibatch 100/100, validation error 20.600000 %
epoch 52, minibatch 100/100, validation error 20.600000 %
epoch 53, minibatch 100/100, validation error 20.600000 %
epoch 54, minibatch 100/100, validation error 20.400000 %
epoch 55, minibatch 100/100, validation error 20.400000 %
epoch 56, minibatch 100/100, validation error 20.400000 %
epoch 57, minibatch 100/100, validation error 20.600000 %
epoch 58, minibatch 100/100, validation error 20.600000 %
epoch 59, minibatch 100/100, validation error 20.600000 %
epoch 60, minibatch 100/100, validation error 20.600000 %
epoch 61, minibatch 100/100, validation error 20.600000 %
epoch 62, minibatch 100/100, validation error 20.600000 %
epoch 63, minibatch 100/100, validation error 20.600000 %
epoch 64, minibatch 100/100, validation error 20.600000 %
epoch 65, minibatch 100/100, validation error 20.600000 %
epoch 66, minibatch 100/100, validation error 20.600000 %
epoch 67, minibatch 100/100, validation error 20.600000 %
epoch 68, minibatch 100/100, validation error 20.600000 %
epoch 69, minibatch 100/100, validation error 20.600000 %
epoch 70, minibatch 100/100, validation error 20.600000 %
epoch 71, minibatch 100/100, validation error 20.600000 %
epoch 72, minibatch 100/100, validation error 20.600000 %
epoch 73, minibatch 100/100, validation error 20.600000 %
epoch 74, minibatch 100/100, validation error 20.600000 %
epoch 75, minibatch 100/100, validation error 20.600000 %
epoch 76, minibatch 100/100, validation error 20.600000 %
epoch 77, minibatch 100/100, validation error 20.600000 %
epoch 78, minibatch 100/100, validation error 20.600000 %
epoch 79, minibatch 100/100, validation error 20.600000 %
epoch 80, minibatch 100/100, validation error 20.600000 %
epoch 81, minibatch 100/100, validation error 20.600000 %
epoch 82, minibatch 100/100, validation error 20.600000 %
epoch 83, minibatch 100/100, validation error 20.600000 %
epoch 84, minibatch 100/100, validation error 20.600000 %
epoch 85, minibatch 100/100, validation error 20.600000 %
epoch 86, minibatch 100/100, validation error 20.600000 %
epoch 87, minibatch 100/100, validation error 20.600000 %
epoch 88, minibatch 100/100, validation error 20.600000 %
epoch 89, minibatch 100/100, validation error 20.600000 %
epoch 90, minibatch 100/100, validation error 20.600000 %
epoch 91, minibatch 100/100, validation error 20.600000 %
Optimization complete with best validation score of 20.400000 %, obtained at iteration 4600, with test performance 12.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.86m


==========Sample: (2000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.336954956
Pre-training layer 0, epoch 0, representative training free energy -578.282981628
Pre-training layer 0, epoch 0, validation free energy -574.697521118
Pre-training layer 0, epoch 1, cost -123.543867302
Pre-training layer 0, epoch 2, cost -113.799529457
Pre-training layer 0, epoch 3, cost -108.272362862
Pre-training layer 0, epoch 4, cost -104.151528969
Pre-training layer 0, epoch 5, cost -101.133476448
Pre-training layer 0, epoch 5, representative training free energy -526.188985596
Pre-training layer 0, epoch 5, validation free energy -517.123373779
Pre-training layer 0, epoch 6, cost -98.7828425217
Pre-training layer 0, epoch 7, cost -96.9010401154
Pre-training layer 0, epoch 8, cost -95.2492289734
Pre-training layer 0, epoch 9, cost -93.858327713
Pre-training layer 0, epoch 10, cost -92.7119062424
Pre-training layer 0, epoch 10, representative training free energy -505.660468994
Pre-training layer 0, epoch 10, validation free energy -495.78481134
Pre-training layer 0, epoch 11, cost -91.469809494
Pre-training layer 0, epoch 12, cost -90.5840135193
Pre-training layer 0, epoch 13, cost -89.8114838791
Pre-training layer 0, epoch 14, cost -89.1372539902
Pre-training layer 0, epoch 15, cost -88.1513925934
Pre-training layer 0, epoch 15, representative training free energy -495.30457373
Pre-training layer 0, epoch 15, validation free energy -484.347351501
Pre-training layer 0, epoch 16, cost -87.628896637
Pre-training layer 0, epoch 17, cost -86.9974402237
Pre-training layer 0, epoch 18, cost -86.3312755966
Pre-training layer 0, epoch 19, cost -85.8854508591
Pre-training layer 0, epoch 20, cost -85.4055056
Pre-training layer 0, epoch 20, representative training free energy -491.156467712
Pre-training layer 0, epoch 20, validation free energy -479.946565186
Pre-training layer 0, epoch 21, cost -85.0419249725
Pre-training layer 0, epoch 22, cost -84.5516726685
Pre-training layer 0, epoch 23, cost -84.1655954742
Pre-training layer 0, epoch 24, cost -83.761211319
Pre-training layer 0, epoch 25, cost -83.6486862183
Pre-training layer 0, epoch 25, representative training free energy -477.833984558
Pre-training layer 0, epoch 25, validation free energy -466.082743286
Pre-training layer 0, epoch 26, cost -83.0481268501
Pre-training layer 0, epoch 27, cost -82.5482497787
Pre-training layer 0, epoch 28, cost -82.6905228043
Pre-training layer 0, epoch 29, cost -82.1138596153
Pre-training layer 0, epoch 30, cost -82.0257105637
Pre-training layer 0, epoch 30, representative training free energy -473.582353088
Pre-training layer 0, epoch 30, validation free energy -461.173010925
Pre-training layer 0, epoch 31, cost -81.6927826309
Pre-training layer 0, epoch 32, cost -81.5558296204
Pre-training layer 0, epoch 33, cost -81.0054249001
Pre-training layer 0, epoch 34, cost -80.723409996
Pre-training layer 0, epoch 35, cost -80.7946785736
Pre-training layer 0, epoch 35, representative training free energy -473.535362122
Pre-training layer 0, epoch 35, validation free energy -461.454580688
Pre-training layer 0, epoch 36, cost -80.4271132088
Pre-training layer 0, epoch 37, cost -80.2765445709
Pre-training layer 0, epoch 38, cost -80.0120882225
Pre-training layer 0, epoch 39, cost -79.9341019821
Pre-training layer 0, epoch 40, cost -79.6380430412
Pre-training layer 0, epoch 40, representative training free energy -469.196010376
Pre-training layer 0, epoch 40, validation free energy -456.505812012
Pre-training layer 0, epoch 41, cost -79.3898703003
Pre-training layer 0, epoch 42, cost -79.3036030769
Pre-training layer 0, epoch 43, cost -79.1141829681
Pre-training layer 0, epoch 44, cost -78.8772644997
Pre-training layer 0, epoch 45, cost -78.736988678
Pre-training layer 0, epoch 45, representative training free energy -464.951873047
Pre-training layer 0, epoch 45, validation free energy -452.067394409
Pre-training layer 0, epoch 46, cost -78.4221337509
Pre-training layer 0, epoch 47, cost -78.4176757812
Pre-training layer 0, epoch 48, cost -78.1186880493
Pre-training layer 0, epoch 49, cost -78.1011594772
Pre-training layer 0, epoch 50, cost -77.9762896347
Pre-training layer 0, epoch 50, representative training free energy -463.362020203
Pre-training layer 0, epoch 50, validation free energy -450.401797119
Pre-training layer 0, epoch 51, cost -77.8230611038
Pre-training layer 0, epoch 52, cost -77.6590099335
Pre-training layer 0, epoch 53, cost -77.5835413933
Pre-training layer 0, epoch 54, cost -77.3274290466
Pre-training layer 0, epoch 55, cost -77.3810293007
Pre-training layer 0, epoch 55, representative training free energy -464.813628357
Pre-training layer 0, epoch 55, validation free energy -451.483955444
Pre-training layer 0, epoch 56, cost -77.1565671349
Pre-training layer 0, epoch 57, cost -77.0262820244
Pre-training layer 0, epoch 58, cost -76.8717986679
Pre-training layer 0, epoch 59, cost -76.8711521339
Pre-training layer 0, epoch 60, cost -76.8039776039
Pre-training layer 0, epoch 60, representative training free energy -458.100959473
Pre-training layer 0, epoch 60, validation free energy -444.209142395
Pre-training layer 0, epoch 61, cost -76.5580158806
Pre-training layer 0, epoch 62, cost -76.3724677277
Pre-training layer 0, epoch 63, cost -76.5797755814
Pre-training layer 0, epoch 64, cost -76.3774978256
Pre-training layer 0, epoch 65, cost -76.2029150009
Pre-training layer 0, epoch 65, representative training free energy -460.056872437
Pre-training layer 0, epoch 65, validation free energy -446.583099243
Pre-training layer 0, epoch 66, cost -76.2115705299
Pre-training layer 0, epoch 67, cost -76.0229728889
Pre-training layer 0, epoch 68, cost -75.9225705719
Pre-training layer 0, epoch 69, cost -75.7862282181
Pre-training layer 0, epoch 70, cost -75.5620284653
Pre-training layer 0, epoch 70, representative training free energy -457.100954895
Pre-training layer 0, epoch 70, validation free energy -442.660450317
Pre-training layer 0, epoch 71, cost -75.6768888283
Pre-training layer 0, epoch 72, cost -75.5294596481
Pre-training layer 0, epoch 73, cost -75.3402495766
Pre-training layer 0, epoch 74, cost -75.1777369118
Pre-training layer 0, epoch 75, cost -75.2664289474
Pre-training layer 0, epoch 75, representative training free energy -457.965367798
Pre-training layer 0, epoch 75, validation free energy -443.747748779
Pre-training layer 0, epoch 76, cost -75.2927912903
Pre-training layer 0, epoch 77, cost -75.1507514191
Pre-training layer 0, epoch 78, cost -75.3119954109
Pre-training layer 0, epoch 79, cost -74.9563431549
Pre-training layer 0, epoch 80, cost -74.9363931084
Pre-training layer 0, epoch 80, representative training free energy -455.799885498
Pre-training layer 0, epoch 80, validation free energy -440.842060974
Pre-training layer 0, epoch 81, cost -74.8372004128
Pre-training layer 0, epoch 82, cost -74.8516501999
Pre-training layer 0, epoch 83, cost -74.603235302
Pre-training layer 0, epoch 84, cost -74.7288381386
Pre-training layer 0, epoch 85, cost -74.4970952797
Pre-training layer 0, epoch 85, representative training free energy -457.583921387
Pre-training layer 0, epoch 85, validation free energy -442.448784607
Pre-training layer 0, epoch 86, cost -74.4551774788
Pre-training layer 0, epoch 87, cost -74.2581824493
Pre-training layer 0, epoch 88, cost -74.310956459
Pre-training layer 0, epoch 89, cost -74.3184988403
Pre-training layer 0, epoch 90, cost -74.1536553574
Pre-training layer 0, epoch 90, representative training free energy -454.90008075
Pre-training layer 0, epoch 90, validation free energy -440.071854431
Pre-training layer 0, epoch 91, cost -74.1868361282
Pre-training layer 0, epoch 92, cost -73.9299552727
Pre-training layer 0, epoch 93, cost -73.908307476
Pre-training layer 0, epoch 94, cost -73.9485251236
Pre-training layer 0, epoch 95, cost -73.8857618904
Pre-training layer 0, epoch 95, representative training free energy -453.694314331
Pre-training layer 0, epoch 95, validation free energy -438.96903894
Pre-training layer 0, epoch 96, cost -73.8920389938
Pre-training layer 0, epoch 97, cost -73.8121562958
Pre-training layer 0, epoch 98, cost -73.7119130325
Pre-training layer 0, epoch 99, cost -73.6658777618
Pre-training layer 1, epoch 0, cost -375.022212677
Pre-training layer 1, epoch 0, representative training free energy -42052.2135254
Pre-training layer 1, epoch 0, validation free energy -41764.253291
Pre-training layer 1, epoch 1, cost -322.884153214
Pre-training layer 1, epoch 2, cost -306.583391418
Pre-training layer 1, epoch 3, cost -296.935515366
Pre-training layer 1, epoch 4, cost -289.968893967
Pre-training layer 1, epoch 5, cost -284.774022141
Pre-training layer 1, epoch 5, representative training free energy -57821.5045
Pre-training layer 1, epoch 5, validation free energy -57406.8343516
Pre-training layer 1, epoch 6, cost -280.48057579
Pre-training layer 1, epoch 7, cost -277.088683472
Pre-training layer 1, epoch 8, cost -274.530585327
Pre-training layer 1, epoch 9, cost -271.967731857
Pre-training layer 1, epoch 10, cost -269.859705963
Pre-training layer 1, epoch 10, representative training free energy -62433.7836484
Pre-training layer 1, epoch 10, validation free energy -61994.4352578
Pre-training layer 1, epoch 11, cost -267.992172241
Pre-training layer 1, epoch 12, cost -266.371326218
Pre-training layer 1, epoch 13, cost -264.913841782
Pre-training layer 1, epoch 14, cost -263.745129776
Pre-training layer 1, epoch 15, cost -262.541940918
Pre-training layer 1, epoch 15, representative training free energy -65206.2299609
Pre-training layer 1, epoch 15, validation free energy -64756.438625
Pre-training layer 1, epoch 16, cost -261.295144348
Pre-training layer 1, epoch 17, cost -260.354141083
Pre-training layer 1, epoch 18, cost -259.38094574
Pre-training layer 1, epoch 19, cost -258.796884155
Pre-training layer 1, epoch 20, cost -257.960433197
Pre-training layer 1, epoch 20, representative training free energy -67282.4930547
Pre-training layer 1, epoch 20, validation free energy -66820.6219727
Pre-training layer 1, epoch 21, cost -257.213083496
Pre-training layer 1, epoch 22, cost -256.531019211
Pre-training layer 1, epoch 23, cost -255.868165207
Pre-training layer 1, epoch 24, cost -255.17197998
Pre-training layer 1, epoch 25, cost -254.879212189
Pre-training layer 1, epoch 25, representative training free energy -68762.3556758
Pre-training layer 1, epoch 25, validation free energy -68290.2844492
Pre-training layer 1, epoch 26, cost -254.259188461
Pre-training layer 1, epoch 27, cost -253.811993179
Pre-training layer 1, epoch 28, cost -253.28025238
Pre-training layer 1, epoch 29, cost -253.022228775
Pre-training layer 1, epoch 30, cost -252.54679184
Pre-training layer 1, epoch 30, representative training free energy -69978.8545195
Pre-training layer 1, epoch 30, validation free energy -69508.5952539
Pre-training layer 1, epoch 31, cost -252.153386765
Pre-training layer 1, epoch 32, cost -251.786289902
Pre-training layer 1, epoch 33, cost -251.407751846
Pre-training layer 1, epoch 34, cost -251.208650055
Pre-training layer 1, epoch 35, cost -250.793214035
Pre-training layer 1, epoch 35, representative training free energy -70961.0025273
Pre-training layer 1, epoch 35, validation free energy -70481.7181055
Pre-training layer 1, epoch 36, cost -250.649440765
Pre-training layer 1, epoch 37, cost -250.245452271
Pre-training layer 1, epoch 38, cost -249.924867325
Pre-training layer 1, epoch 39, cost -249.735731506
Pre-training layer 1, epoch 40, cost -249.382384262
Pre-training layer 1, epoch 40, representative training free energy -71902.1272578
Pre-training layer 1, epoch 40, validation free energy -71418.6849727
Pre-training layer 1, epoch 41, cost -249.246200409
Pre-training layer 1, epoch 42, cost -248.924880676
Pre-training layer 1, epoch 43, cost -248.783235855
Pre-training layer 1, epoch 44, cost -248.47675087
Pre-training layer 1, epoch 45, cost -248.219362106
Pre-training layer 1, epoch 45, representative training free energy -72627.3046992
Pre-training layer 1, epoch 45, validation free energy -72132.7703125
Pre-training layer 1, epoch 46, cost -247.952116013
Pre-training layer 1, epoch 47, cost -247.933877335
Pre-training layer 1, epoch 48, cost -247.652047195
Pre-training layer 1, epoch 49, cost -247.573347473
Pre-training layer 1, epoch 50, cost -247.447137451
Pre-training layer 1, epoch 50, representative training free energy -73371.0545078
Pre-training layer 1, epoch 50, validation free energy -72867.5428164
Pre-training layer 1, epoch 51, cost -247.15479538
Pre-training layer 1, epoch 52, cost -247.034341202
Pre-training layer 1, epoch 53, cost -246.794165497
Pre-training layer 1, epoch 54, cost -246.595834961
Pre-training layer 1, epoch 55, cost -246.539159088
Pre-training layer 1, epoch 55, representative training free energy -73994.7738203
Pre-training layer 1, epoch 55, validation free energy -73488.4647344
Pre-training layer 1, epoch 56, cost -246.45778183
Pre-training layer 1, epoch 57, cost -246.162564392
Pre-training layer 1, epoch 58, cost -246.152153931
Pre-training layer 1, epoch 59, cost -245.952201233
Pre-training layer 1, epoch 60, cost -245.844576263
Pre-training layer 1, epoch 60, representative training free energy -74657.3729766
Pre-training layer 1, epoch 60, validation free energy -74141.9921094
Pre-training layer 1, epoch 61, cost -245.729786987
Pre-training layer 1, epoch 62, cost -245.543553314
Pre-training layer 1, epoch 63, cost -245.321625824
Pre-training layer 1, epoch 64, cost -245.317779694
Pre-training layer 1, epoch 65, cost -245.239653931
Pre-training layer 1, epoch 65, representative training free energy -75190.4553281
Pre-training layer 1, epoch 65, validation free energy -74673.1501719
Pre-training layer 1, epoch 66, cost -245.187491684
Pre-training layer 1, epoch 67, cost -244.926025467
Pre-training layer 1, epoch 68, cost -244.792720718
Pre-training layer 1, epoch 69, cost -244.754545593
Pre-training layer 1, epoch 70, cost -244.664356079
Pre-training layer 1, epoch 70, representative training free energy -75619.4478711
Pre-training layer 1, epoch 70, validation free energy -75105.0324297
Pre-training layer 1, epoch 71, cost -244.53923233
Pre-training layer 1, epoch 72, cost -244.438215637
Pre-training layer 1, epoch 73, cost -244.249939194
Pre-training layer 1, epoch 74, cost -244.206173019
Pre-training layer 1, epoch 75, cost -244.186529617
Pre-training layer 1, epoch 75, representative training free energy -76110.8465195
Pre-training layer 1, epoch 75, validation free energy -75594.9660703
Pre-training layer 1, epoch 76, cost -243.955572357
Pre-training layer 1, epoch 77, cost -243.841069336
Pre-training layer 1, epoch 78, cost -243.92297554
Pre-training layer 1, epoch 79, cost -243.830986099
Pre-training layer 1, epoch 80, cost -243.693518906
Pre-training layer 1, epoch 80, representative training free energy -76573.5211172
Pre-training layer 1, epoch 80, validation free energy -76054.7504531
Pre-training layer 1, epoch 81, cost -243.638312378
Pre-training layer 1, epoch 82, cost -243.486850281
Pre-training layer 1, epoch 83, cost -243.523519135
Pre-training layer 1, epoch 84, cost -243.40966011
Pre-training layer 1, epoch 85, cost -243.342490692
Pre-training layer 1, epoch 85, representative training free energy -76921.7264687
Pre-training layer 1, epoch 85, validation free energy -76398.4912539
Pre-training layer 1, epoch 86, cost -243.297083817
Pre-training layer 1, epoch 87, cost -243.221675415
Pre-training layer 1, epoch 88, cost -243.093983383
Pre-training layer 1, epoch 89, cost -243.065607529
Pre-training layer 1, epoch 90, cost -242.912959518
Pre-training layer 1, epoch 90, representative training free energy -77294.2641406
Pre-training layer 1, epoch 90, validation free energy -76768.0167227
Pre-training layer 1, epoch 91, cost -242.906444168
Pre-training layer 1, epoch 92, cost -242.830647507
Pre-training layer 1, epoch 93, cost -242.713905106
Pre-training layer 1, epoch 94, cost -242.542212524
Pre-training layer 1, epoch 95, cost -242.59941391
Pre-training layer 1, epoch 95, representative training free energy -77686.0629922
Pre-training layer 1, epoch 95, validation free energy -77157.6550859
Pre-training layer 1, epoch 96, cost -242.471829681
Pre-training layer 1, epoch 97, cost -242.395597458
Pre-training layer 1, epoch 98, cost -242.342629166
Pre-training layer 1, epoch 99, cost -242.214608765
Pre-training layer 2, epoch 0, cost -137.395883255
Pre-training layer 2, epoch 0, representative training free energy 2433.92005945
Pre-training layer 2, epoch 0, validation free energy 2428.16016321
Pre-training layer 2, epoch 1, cost -97.9486485672
Pre-training layer 2, epoch 2, cost -89.7765303802
Pre-training layer 2, epoch 3, cost -85.6257107544
Pre-training layer 2, epoch 4, cost -82.4662507057
Pre-training layer 2, epoch 5, cost -80.122362442
Pre-training layer 2, epoch 5, representative training free energy 3614.18035608
Pre-training layer 2, epoch 5, validation free energy 3583.11492932
Pre-training layer 2, epoch 6, cost -78.2807308769
Pre-training layer 2, epoch 7, cost -77.0205155373
Pre-training layer 2, epoch 8, cost -75.7372754097
Pre-training layer 2, epoch 9, cost -74.8477389336
Pre-training layer 2, epoch 10, cost -73.7777421188
Pre-training layer 2, epoch 10, representative training free energy 4237.50243054
Pre-training layer 2, epoch 10, validation free energy 4201.93261572
Pre-training layer 2, epoch 11, cost -73.151656723
Pre-training layer 2, epoch 12, cost -72.3676551247
Pre-training layer 2, epoch 13, cost -71.92103508
Pre-training layer 2, epoch 14, cost -71.2919633102
Pre-training layer 2, epoch 15, cost -70.8886982918
Pre-training layer 2, epoch 15, representative training free energy 4740.01686108
Pre-training layer 2, epoch 15, validation free energy 4696.61043213
Pre-training layer 2, epoch 16, cost -70.449266243
Pre-training layer 2, epoch 17, cost -70.0994170189
Pre-training layer 2, epoch 18, cost -69.6731687355
Pre-training layer 2, epoch 19, cost -69.2982569504
Pre-training layer 2, epoch 20, cost -68.8865106201
Pre-training layer 2, epoch 20, representative training free energy 5125.42546753
Pre-training layer 2, epoch 20, validation free energy 5077.89586377
Pre-training layer 2, epoch 21, cost -68.7077048302
Pre-training layer 2, epoch 22, cost -68.4305363655
Pre-training layer 2, epoch 23, cost -68.0962277031
Pre-training layer 2, epoch 24, cost -67.8300754738
Pre-training layer 2, epoch 25, cost -67.7372389412
Pre-training layer 2, epoch 25, representative training free energy 5463.51896313
Pre-training layer 2, epoch 25, validation free energy 5417.80438745
Pre-training layer 2, epoch 26, cost -67.4688207245
Pre-training layer 2, epoch 27, cost -67.2838555717
Pre-training layer 2, epoch 28, cost -67.1024780655
Pre-training layer 2, epoch 29, cost -66.9290783882
Pre-training layer 2, epoch 30, cost -66.7062683678
Pre-training layer 2, epoch 30, representative training free energy 5772.45590747
Pre-training layer 2, epoch 30, validation free energy 5723.92346826
Pre-training layer 2, epoch 31, cost -66.5811170387
Pre-training layer 2, epoch 32, cost -66.4429050827
Pre-training layer 2, epoch 33, cost -66.2369229889
Pre-training layer 2, epoch 34, cost -66.1293044662
Pre-training layer 2, epoch 35, cost -65.9745573807
Pre-training layer 2, epoch 35, representative training free energy 6033.87847974
Pre-training layer 2, epoch 35, validation free energy 5980.20309839
Pre-training layer 2, epoch 36, cost -65.901221714
Pre-training layer 2, epoch 37, cost -65.6947041512
Pre-training layer 2, epoch 38, cost -65.6714986801
Pre-training layer 2, epoch 39, cost -65.4655108833
Pre-training layer 2, epoch 40, cost -65.4904780197
Pre-training layer 2, epoch 40, representative training free energy 6270.03850391
Pre-training layer 2, epoch 40, validation free energy 6212.9378313
Pre-training layer 2, epoch 41, cost -65.3822600937
Pre-training layer 2, epoch 42, cost -65.1285012817
Pre-training layer 2, epoch 43, cost -65.1958817291
Pre-training layer 2, epoch 44, cost -65.1124954796
Pre-training layer 2, epoch 45, cost -64.898765316
Pre-training layer 2, epoch 45, representative training free energy 6494.38830908
Pre-training layer 2, epoch 45, validation free energy 6436.82419946
Pre-training layer 2, epoch 46, cost -64.8135125351
Pre-training layer 2, epoch 47, cost -64.649481144
Pre-training layer 2, epoch 48, cost -64.6925888634
Pre-training layer 2, epoch 49, cost -64.5189645386
Pre-training layer 2, epoch 50, cost -64.5261240005
Pre-training layer 2, epoch 50, representative training free energy 6710.97968994
Pre-training layer 2, epoch 50, validation free energy 6652.8521084
Pre-training layer 2, epoch 51, cost -64.4764263725
Pre-training layer 2, epoch 52, cost -64.2707616806
Pre-training layer 2, epoch 53, cost -64.4422342873
Pre-training layer 2, epoch 54, cost -64.2473547935
Pre-training layer 2, epoch 55, cost -64.1419146729
Pre-training layer 2, epoch 55, representative training free energy 6898.22466846
Pre-training layer 2, epoch 55, validation free energy 6839.58456055
Pre-training layer 2, epoch 56, cost -64.0479546356
Pre-training layer 2, epoch 57, cost -64.0977780914
Pre-training layer 2, epoch 58, cost -64.0625120354
Pre-training layer 2, epoch 59, cost -64.1020687103
Pre-training layer 2, epoch 60, cost -63.8419318581
Pre-training layer 2, epoch 60, representative training free energy 7094.96021533
Pre-training layer 2, epoch 60, validation free energy 7033.67670508
Pre-training layer 2, epoch 61, cost -63.8243526649
Pre-training layer 2, epoch 62, cost -63.8671903038
Pre-training layer 2, epoch 63, cost -63.7821481705
Pre-training layer 2, epoch 64, cost -63.6356661224
Pre-training layer 2, epoch 65, cost -63.6952357864
Pre-training layer 2, epoch 65, representative training free energy 7269.16421338
Pre-training layer 2, epoch 65, validation free energy 7205.86270605
Pre-training layer 2, epoch 66, cost -63.6166184425
Pre-training layer 2, epoch 67, cost -63.4192671585
Pre-training layer 2, epoch 68, cost -63.5760020638
Pre-training layer 2, epoch 69, cost -63.4993816757
Pre-training layer 2, epoch 70, cost -63.4177050781
Pre-training layer 2, epoch 70, representative training free energy 7457.91548682
Pre-training layer 2, epoch 70, validation free energy 7392.08651172
Pre-training layer 2, epoch 71, cost -63.3204991531
Pre-training layer 2, epoch 72, cost -63.4887737846
Pre-training layer 2, epoch 73, cost -63.3009595871
Pre-training layer 2, epoch 74, cost -63.2238020706
Pre-training layer 2, epoch 75, cost -63.1357465363
Pre-training layer 2, epoch 75, representative training free energy 7617.46688623
Pre-training layer 2, epoch 75, validation free energy 7548.89863623
Pre-training layer 2, epoch 76, cost -63.2900123787
Pre-training layer 2, epoch 77, cost -63.1619817352
Pre-training layer 2, epoch 78, cost -62.9690619087
Pre-training layer 2, epoch 79, cost -63.1070205307
Pre-training layer 2, epoch 80, cost -62.9062536049
Pre-training layer 2, epoch 80, representative training free energy 7778.85730322
Pre-training layer 2, epoch 80, validation free energy 7710.31888281
Pre-training layer 2, epoch 81, cost -63.0020026207
Pre-training layer 2, epoch 82, cost -63.0258015633
Pre-training layer 2, epoch 83, cost -62.9058395386
Pre-training layer 2, epoch 84, cost -62.8408452225
Pre-training layer 2, epoch 85, cost -62.9135823822
Pre-training layer 2, epoch 85, representative training free energy 7952.73553027
Pre-training layer 2, epoch 85, validation free energy 7883.4984165
Pre-training layer 2, epoch 86, cost -62.6848576546
Pre-training layer 2, epoch 87, cost -62.7717765045
Pre-training layer 2, epoch 88, cost -62.7495794106
Pre-training layer 2, epoch 89, cost -62.7820829391
Pre-training layer 2, epoch 90, cost -62.5759651375
Pre-training layer 2, epoch 90, representative training free energy 8107.92097803
Pre-training layer 2, epoch 90, validation free energy 8036.0994458
Pre-training layer 2, epoch 91, cost -62.8461994171
Pre-training layer 2, epoch 92, cost -62.6548510742
Pre-training layer 2, epoch 93, cost -62.4521696854
Pre-training layer 2, epoch 94, cost -62.5442772102
Pre-training layer 2, epoch 95, cost -62.5020184708
Pre-training layer 2, epoch 95, representative training free energy 8264.71934814
Pre-training layer 2, epoch 95, validation free energy 8192.21678809
Pre-training layer 2, epoch 96, cost -62.6082014656
Pre-training layer 2, epoch 97, cost -62.5251255035
Pre-training layer 2, epoch 98, cost -62.5602633476
Pre-training layer 2, epoch 99, cost -62.4158803177
The pretraining code for file dbn_loop.pyc ran for 5.47m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 36.600000 %
     epoch 1, minibatch 200/200, test error of best model 31.000000 %
epoch 2, minibatch 200/200, validation error 28.400000 %
     epoch 2, minibatch 200/200, test error of best model 20.200000 %
epoch 3, minibatch 200/200, validation error 24.800000 %
     epoch 3, minibatch 200/200, test error of best model 15.000000 %
epoch 4, minibatch 200/200, validation error 23.200000 %
     epoch 4, minibatch 200/200, test error of best model 12.800000 %
epoch 5, minibatch 200/200, validation error 22.200000 %
     epoch 5, minibatch 200/200, test error of best model 11.200000 %
epoch 6, minibatch 200/200, validation error 22.000000 %
     epoch 6, minibatch 200/200, test error of best model 10.800000 %
epoch 7, minibatch 200/200, validation error 21.400000 %
     epoch 7, minibatch 200/200, test error of best model 9.200000 %
epoch 8, minibatch 200/200, validation error 21.000000 %
     epoch 8, minibatch 200/200, test error of best model 8.400000 %
epoch 9, minibatch 200/200, validation error 21.000000 %
epoch 10, minibatch 200/200, validation error 20.600000 %
     epoch 10, minibatch 200/200, test error of best model 7.200000 %
epoch 11, minibatch 200/200, validation error 20.400000 %
     epoch 11, minibatch 200/200, test error of best model 7.200000 %
epoch 12, minibatch 200/200, validation error 19.800000 %
     epoch 12, minibatch 200/200, test error of best model 7.400000 %
epoch 13, minibatch 200/200, validation error 19.800000 %
epoch 14, minibatch 200/200, validation error 19.600000 %
     epoch 14, minibatch 200/200, test error of best model 7.000000 %
epoch 15, minibatch 200/200, validation error 19.400000 %
     epoch 15, minibatch 200/200, test error of best model 7.000000 %
epoch 16, minibatch 200/200, validation error 19.000000 %
     epoch 16, minibatch 200/200, test error of best model 6.800000 %
epoch 17, minibatch 200/200, validation error 18.800000 %
     epoch 17, minibatch 200/200, test error of best model 7.000000 %
epoch 18, minibatch 200/200, validation error 18.400000 %
     epoch 18, minibatch 200/200, test error of best model 6.800000 %
epoch 19, minibatch 200/200, validation error 18.000000 %
     epoch 19, minibatch 200/200, test error of best model 6.800000 %
epoch 20, minibatch 200/200, validation error 18.000000 %
epoch 21, minibatch 200/200, validation error 18.000000 %
epoch 22, minibatch 200/200, validation error 18.000000 %
epoch 23, minibatch 200/200, validation error 17.800000 %
     epoch 23, minibatch 200/200, test error of best model 7.000000 %
epoch 24, minibatch 200/200, validation error 17.800000 %
epoch 25, minibatch 200/200, validation error 17.400000 %
     epoch 25, minibatch 200/200, test error of best model 7.000000 %
epoch 26, minibatch 200/200, validation error 17.400000 %
epoch 27, minibatch 200/200, validation error 17.400000 %
epoch 28, minibatch 200/200, validation error 17.400000 %
epoch 29, minibatch 200/200, validation error 17.400000 %
epoch 30, minibatch 200/200, validation error 17.400000 %
epoch 31, minibatch 200/200, validation error 17.600000 %
epoch 32, minibatch 200/200, validation error 17.600000 %
epoch 33, minibatch 200/200, validation error 17.600000 %
epoch 34, minibatch 200/200, validation error 17.800000 %
epoch 35, minibatch 200/200, validation error 17.600000 %
epoch 36, minibatch 200/200, validation error 17.600000 %
epoch 37, minibatch 200/200, validation error 17.600000 %
epoch 38, minibatch 200/200, validation error 17.400000 %
epoch 39, minibatch 200/200, validation error 17.400000 %
epoch 40, minibatch 200/200, validation error 17.400000 %
epoch 41, minibatch 200/200, validation error 17.400000 %
epoch 42, minibatch 200/200, validation error 17.400000 %
epoch 43, minibatch 200/200, validation error 17.400000 %
epoch 44, minibatch 200/200, validation error 17.400000 %
epoch 45, minibatch 200/200, validation error 17.400000 %
epoch 46, minibatch 200/200, validation error 17.400000 %
epoch 47, minibatch 200/200, validation error 17.400000 %
epoch 48, minibatch 200/200, validation error 17.400000 %
epoch 49, minibatch 200/200, validation error 17.400000 %
Optimization complete with best validation score of 17.400000 %, obtained at iteration 5000, with test performance 7.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.91m


==========Sample: (3000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.669826965
Pre-training layer 0, epoch 0, representative training free energy -561.73026062
Pre-training layer 0, epoch 0, validation free energy -555.695695862
Pre-training layer 0, epoch 1, cost -116.681008682
Pre-training layer 0, epoch 2, cost -107.964261398
Pre-training layer 0, epoch 3, cost -102.765764338
Pre-training layer 0, epoch 4, cost -99.3679770915
Pre-training layer 0, epoch 5, cost -96.5885173035
Pre-training layer 0, epoch 5, representative training free energy -503.079150696
Pre-training layer 0, epoch 5, validation free energy -494.5739422
Pre-training layer 0, epoch 6, cost -94.3915096283
Pre-training layer 0, epoch 7, cost -92.8858460999
Pre-training layer 0, epoch 8, cost -91.4795745087
Pre-training layer 0, epoch 9, cost -90.0351306407
Pre-training layer 0, epoch 10, cost -89.1374084981
Pre-training layer 0, epoch 10, representative training free energy -481.872503662
Pre-training layer 0, epoch 10, validation free energy -472.844045593
Pre-training layer 0, epoch 11, cost -88.2828884379
Pre-training layer 0, epoch 12, cost -87.3743314362
Pre-training layer 0, epoch 13, cost -86.7751872253
Pre-training layer 0, epoch 14, cost -86.0254452896
Pre-training layer 0, epoch 15, cost -85.3869072851
Pre-training layer 0, epoch 15, representative training free energy -467.860665894
Pre-training layer 0, epoch 15, validation free energy -458.258939148
Pre-training layer 0, epoch 16, cost -84.9752108129
Pre-training layer 0, epoch 17, cost -84.3630564626
Pre-training layer 0, epoch 18, cost -83.9538366572
Pre-training layer 0, epoch 19, cost -83.5559021378
Pre-training layer 0, epoch 20, cost -83.1983916219
Pre-training layer 0, epoch 20, representative training free energy -458.953323425
Pre-training layer 0, epoch 20, validation free energy -449.682394043
Pre-training layer 0, epoch 21, cost -82.5582100805
Pre-training layer 0, epoch 22, cost -82.2979735565
Pre-training layer 0, epoch 23, cost -81.8841218821
Pre-training layer 0, epoch 24, cost -81.6337088394
Pre-training layer 0, epoch 25, cost -81.4044639842
Pre-training layer 0, epoch 25, representative training free energy -451.746439392
Pre-training layer 0, epoch 25, validation free energy -441.967436157
Pre-training layer 0, epoch 26, cost -81.1165568415
Pre-training layer 0, epoch 27, cost -80.7626239649
Pre-training layer 0, epoch 28, cost -80.5200288391
Pre-training layer 0, epoch 29, cost -80.300491333
Pre-training layer 0, epoch 30, cost -80.0385791143
Pre-training layer 0, epoch 30, representative training free energy -449.941193481
Pre-training layer 0, epoch 30, validation free energy -440.473830444
Pre-training layer 0, epoch 31, cost -79.7875730006
Pre-training layer 0, epoch 32, cost -79.495314916
Pre-training layer 0, epoch 33, cost -79.3468704478
Pre-training layer 0, epoch 34, cost -79.4057585271
Pre-training layer 0, epoch 35, cost -79.055476532
Pre-training layer 0, epoch 35, representative training free energy -445.932300598
Pre-training layer 0, epoch 35, validation free energy -435.256122742
Pre-training layer 0, epoch 36, cost -78.9325091934
Pre-training layer 0, epoch 37, cost -78.7596021652
Pre-training layer 0, epoch 38, cost -78.4766352208
Pre-training layer 0, epoch 39, cost -78.4392927424
Pre-training layer 0, epoch 40, cost -78.12122612
Pre-training layer 0, epoch 40, representative training free energy -444.47362384
Pre-training layer 0, epoch 40, validation free energy -433.945663025
Pre-training layer 0, epoch 41, cost -78.0825413259
Pre-training layer 0, epoch 42, cost -77.888258845
Pre-training layer 0, epoch 43, cost -77.7689743042
Pre-training layer 0, epoch 44, cost -77.6749091721
Pre-training layer 0, epoch 45, cost -77.5729756419
Pre-training layer 0, epoch 45, representative training free energy -445.647243469
Pre-training layer 0, epoch 45, validation free energy -434.906408569
Pre-training layer 0, epoch 46, cost -77.2619973628
Pre-training layer 0, epoch 47, cost -77.4342807261
Pre-training layer 0, epoch 48, cost -77.2435909144
Pre-training layer 0, epoch 49, cost -77.0673376973
Pre-training layer 0, epoch 50, cost -76.7990891902
Pre-training layer 0, epoch 50, representative training free energy -443.082411499
Pre-training layer 0, epoch 50, validation free energy -431.683347961
Pre-training layer 0, epoch 51, cost -76.6752044551
Pre-training layer 0, epoch 52, cost -76.6632687632
Pre-training layer 0, epoch 53, cost -76.4496433258
Pre-training layer 0, epoch 54, cost -76.3901381938
Pre-training layer 0, epoch 55, cost -76.3997921499
Pre-training layer 0, epoch 55, representative training free energy -437.56686261
Pre-training layer 0, epoch 55, validation free energy -426.503888
Pre-training layer 0, epoch 56, cost -76.1542165502
Pre-training layer 0, epoch 57, cost -76.1520266724
Pre-training layer 0, epoch 58, cost -76.0499612427
Pre-training layer 0, epoch 59, cost -75.9427843984
Pre-training layer 0, epoch 60, cost -75.9639369075
Pre-training layer 0, epoch 60, representative training free energy -437.401352783
Pre-training layer 0, epoch 60, validation free energy -426.459115356
Pre-training layer 0, epoch 61, cost -75.7619699732
Pre-training layer 0, epoch 62, cost -75.6504939016
Pre-training layer 0, epoch 63, cost -75.59811011
Pre-training layer 0, epoch 64, cost -75.5472485733
Pre-training layer 0, epoch 65, cost -75.3601400375
Pre-training layer 0, epoch 65, representative training free energy -437.815037109
Pre-training layer 0, epoch 65, validation free energy -426.100883301
Pre-training layer 0, epoch 66, cost -75.325777626
Pre-training layer 0, epoch 67, cost -75.356419576
Pre-training layer 0, epoch 68, cost -75.2860263189
Pre-training layer 0, epoch 69, cost -75.1458467102
Pre-training layer 0, epoch 70, cost -75.1638514582
Pre-training layer 0, epoch 70, representative training free energy -436.383338257
Pre-training layer 0, epoch 70, validation free energy -424.696602478
Pre-training layer 0, epoch 71, cost -74.9656785202
Pre-training layer 0, epoch 72, cost -74.8712172699
Pre-training layer 0, epoch 73, cost -74.764414889
Pre-training layer 0, epoch 74, cost -74.6929766083
Pre-training layer 0, epoch 75, cost -74.7604077021
Pre-training layer 0, epoch 75, representative training free energy -437.137141663
Pre-training layer 0, epoch 75, validation free energy -425.759668213
Pre-training layer 0, epoch 76, cost -74.6628576787
Pre-training layer 0, epoch 77, cost -74.547346344
Pre-training layer 0, epoch 78, cost -74.4316762797
Pre-training layer 0, epoch 79, cost -74.4690128581
Pre-training layer 0, epoch 80, cost -74.5250771713
Pre-training layer 0, epoch 80, representative training free energy -434.307572388
Pre-training layer 0, epoch 80, validation free energy -422.356329102
Pre-training layer 0, epoch 81, cost -74.2132348251
Pre-training layer 0, epoch 82, cost -74.1635514069
Pre-training layer 0, epoch 83, cost -74.1619714737
Pre-training layer 0, epoch 84, cost -74.1576915614
Pre-training layer 0, epoch 85, cost -74.0052436701
Pre-training layer 0, epoch 85, representative training free energy -432.366921326
Pre-training layer 0, epoch 85, validation free energy -420.617089783
Pre-training layer 0, epoch 86, cost -73.90049558
Pre-training layer 0, epoch 87, cost -74.0818731054
Pre-training layer 0, epoch 88, cost -73.9563995361
Pre-training layer 0, epoch 89, cost -73.837052892
Pre-training layer 0, epoch 90, cost -73.7354284541
Pre-training layer 0, epoch 90, representative training free energy -433.163773987
Pre-training layer 0, epoch 90, validation free energy -420.282200562
Pre-training layer 0, epoch 91, cost -73.6520268122
Pre-training layer 0, epoch 92, cost -73.5767809423
Pre-training layer 0, epoch 93, cost -73.6265698115
Pre-training layer 0, epoch 94, cost -73.4935772196
Pre-training layer 0, epoch 95, cost -73.5094620387
Pre-training layer 0, epoch 95, representative training free energy -431.095124573
Pre-training layer 0, epoch 95, validation free energy -418.790304504
Pre-training layer 0, epoch 96, cost -73.4217651749
Pre-training layer 0, epoch 97, cost -73.4619183985
Pre-training layer 0, epoch 98, cost -73.3670269521
Pre-training layer 0, epoch 99, cost -73.382374026
Pre-training layer 1, epoch 0, cost -345.410067749
Pre-training layer 1, epoch 0, representative training free energy -50374.7074883
Pre-training layer 1, epoch 0, validation free energy -49945.6885469
Pre-training layer 1, epoch 1, cost -296.531964467
Pre-training layer 1, epoch 2, cost -281.378563894
Pre-training layer 1, epoch 3, cost -272.373988342
Pre-training layer 1, epoch 4, cost -266.22859436
Pre-training layer 1, epoch 5, cost -261.740757192
Pre-training layer 1, epoch 5, representative training free energy -68332.1352773
Pre-training layer 1, epoch 5, validation free energy -67766.6635234
Pre-training layer 1, epoch 6, cost -258.097136688
Pre-training layer 1, epoch 7, cost -255.011889598
Pre-training layer 1, epoch 8, cost -252.772922007
Pre-training layer 1, epoch 9, cost -250.721910451
Pre-training layer 1, epoch 10, cost -249.037106069
Pre-training layer 1, epoch 10, representative training free energy -73747.3455937
Pre-training layer 1, epoch 10, validation free energy -73124.7218516
Pre-training layer 1, epoch 11, cost -247.640833028
Pre-training layer 1, epoch 12, cost -246.161248118
Pre-training layer 1, epoch 13, cost -245.039101054
Pre-training layer 1, epoch 14, cost -244.022169291
Pre-training layer 1, epoch 15, cost -242.992729543
Pre-training layer 1, epoch 15, representative training free energy -77059.3259492
Pre-training layer 1, epoch 15, validation free energy -76417.3259766
Pre-training layer 1, epoch 16, cost -242.116236369
Pre-training layer 1, epoch 17, cost -241.449956614
Pre-training layer 1, epoch 18, cost -240.578452098
Pre-training layer 1, epoch 19, cost -239.963042908
Pre-training layer 1, epoch 20, cost -239.246557922
Pre-training layer 1, epoch 20, representative training free energy -79320.3776172
Pre-training layer 1, epoch 20, validation free energy -78658.8642305
Pre-training layer 1, epoch 21, cost -238.680981089
Pre-training layer 1, epoch 22, cost -238.184534861
Pre-training layer 1, epoch 23, cost -237.817765961
Pre-training layer 1, epoch 24, cost -237.286951294
Pre-training layer 1, epoch 25, cost -236.815777944
Pre-training layer 1, epoch 25, representative training free energy -81024.0118555
Pre-training layer 1, epoch 25, validation free energy -80344.2861523
Pre-training layer 1, epoch 26, cost -236.386675415
Pre-training layer 1, epoch 27, cost -236.064957021
Pre-training layer 1, epoch 28, cost -235.671163279
Pre-training layer 1, epoch 29, cost -235.515428467
Pre-training layer 1, epoch 30, cost -234.959927012
Pre-training layer 1, epoch 30, representative training free energy -82312.9334961
Pre-training layer 1, epoch 30, validation free energy -81618.8164062
Pre-training layer 1, epoch 31, cost -234.777094777
Pre-training layer 1, epoch 32, cost -234.382369792
Pre-training layer 1, epoch 33, cost -234.161180216
Pre-training layer 1, epoch 34, cost -233.9101769
Pre-training layer 1, epoch 35, cost -233.579898071
Pre-training layer 1, epoch 35, representative training free energy -83577.1689844
Pre-training layer 1, epoch 35, validation free energy -82887.669082
Pre-training layer 1, epoch 36, cost -233.357184855
Pre-training layer 1, epoch 37, cost -233.200957286
Pre-training layer 1, epoch 38, cost -232.951536916
Pre-training layer 1, epoch 39, cost -232.771913961
Pre-training layer 1, epoch 40, cost -232.460852966
Pre-training layer 1, epoch 40, representative training free energy -84701.2846445
Pre-training layer 1, epoch 40, validation free energy -84002.5484687
Pre-training layer 1, epoch 41, cost -232.303248291
Pre-training layer 1, epoch 42, cost -232.265511475
Pre-training layer 1, epoch 43, cost -231.814937388
Pre-training layer 1, epoch 44, cost -231.754699758
Pre-training layer 1, epoch 45, cost -231.520847219
Pre-training layer 1, epoch 45, representative training free energy -85620.0875547
Pre-training layer 1, epoch 45, validation free energy -84904.9425156
Pre-training layer 1, epoch 46, cost -231.380709127
Pre-training layer 1, epoch 47, cost -231.27622762
Pre-training layer 1, epoch 48, cost -231.073604329
Pre-training layer 1, epoch 49, cost -230.89427063
Pre-training layer 1, epoch 50, cost -230.787145793
Pre-training layer 1, epoch 50, representative training free energy -86424.3043867
Pre-training layer 1, epoch 50, validation free energy -85705.0569258
Pre-training layer 1, epoch 51, cost -230.635585683
Pre-training layer 1, epoch 52, cost -230.473463491
Pre-training layer 1, epoch 53, cost -230.460951843
Pre-training layer 1, epoch 54, cost -230.187246857
Pre-training layer 1, epoch 55, cost -230.074190725
Pre-training layer 1, epoch 55, representative training free energy -87163.8258672
Pre-training layer 1, epoch 55, validation free energy -86442.7670117
Pre-training layer 1, epoch 56, cost -230.029423879
Pre-training layer 1, epoch 57, cost -229.876525574
Pre-training layer 1, epoch 58, cost -229.792386678
Pre-training layer 1, epoch 59, cost -229.722219137
Pre-training layer 1, epoch 60, cost -229.459095917
Pre-training layer 1, epoch 60, representative training free energy -87820.436793
Pre-training layer 1, epoch 60, validation free energy -87095.8599844
Pre-training layer 1, epoch 61, cost -229.416372172
Pre-training layer 1, epoch 62, cost -229.366194509
Pre-training layer 1, epoch 63, cost -229.098353984
Pre-training layer 1, epoch 64, cost -229.077253621
Pre-training layer 1, epoch 65, cost -228.957807109
Pre-training layer 1, epoch 65, representative training free energy -88423.5473281
Pre-training layer 1, epoch 65, validation free energy -87688.988082
Pre-training layer 1, epoch 66, cost -228.935614573
Pre-training layer 1, epoch 67, cost -228.809185282
Pre-training layer 1, epoch 68, cost -228.534324748
Pre-training layer 1, epoch 69, cost -228.52884374
Pre-training layer 1, epoch 70, cost -228.496792959
Pre-training layer 1, epoch 70, representative training free energy -88993.5403906
Pre-training layer 1, epoch 70, validation free energy -88254.0858984
Pre-training layer 1, epoch 71, cost -228.340730642
Pre-training layer 1, epoch 72, cost -228.332618103
Pre-training layer 1, epoch 73, cost -228.221270854
Pre-training layer 1, epoch 74, cost -228.249526011
Pre-training layer 1, epoch 75, cost -228.07384613
Pre-training layer 1, epoch 75, representative training free energy -89517.7454922
Pre-training layer 1, epoch 75, validation free energy -88777.6549492
Pre-training layer 1, epoch 76, cost -227.913234507
Pre-training layer 1, epoch 77, cost -227.874059245
Pre-training layer 1, epoch 78, cost -227.820255992
Pre-training layer 1, epoch 79, cost -227.860707855
Pre-training layer 1, epoch 80, cost -227.648313955
Pre-training layer 1, epoch 80, representative training free energy -90102.5219258
Pre-training layer 1, epoch 80, validation free energy -89360.4679961
Pre-training layer 1, epoch 81, cost -227.65310318
Pre-training layer 1, epoch 82, cost -227.560111796
Pre-training layer 1, epoch 83, cost -227.461670532
Pre-training layer 1, epoch 84, cost -227.462348582
Pre-training layer 1, epoch 85, cost -227.33263738
Pre-training layer 1, epoch 85, representative training free energy -90514.4386484
Pre-training layer 1, epoch 85, validation free energy -89755.7901836
Pre-training layer 1, epoch 86, cost -227.287249858
Pre-training layer 1, epoch 87, cost -227.339662069
Pre-training layer 1, epoch 88, cost -227.111677399
Pre-training layer 1, epoch 89, cost -227.072432353
Pre-training layer 1, epoch 90, cost -227.094396413
Pre-training layer 1, epoch 90, representative training free energy -90946.2900664
Pre-training layer 1, epoch 90, validation free energy -90197.7107305
Pre-training layer 1, epoch 91, cost -227.043197072
Pre-training layer 1, epoch 92, cost -226.911352641
Pre-training layer 1, epoch 93, cost -226.795381165
Pre-training layer 1, epoch 94, cost -226.812286123
Pre-training layer 1, epoch 95, cost -226.623180542
Pre-training layer 1, epoch 95, representative training free energy -91453.2296953
Pre-training layer 1, epoch 95, validation free energy -90697.1984648
Pre-training layer 1, epoch 96, cost -226.699334157
Pre-training layer 1, epoch 97, cost -226.698275299
Pre-training layer 1, epoch 98, cost -226.635284373
Pre-training layer 1, epoch 99, cost -226.531136831
Pre-training layer 2, epoch 0, cost -127.596412023
Pre-training layer 2, epoch 0, representative training free energy 3019.09046619
Pre-training layer 2, epoch 0, validation free energy 2993.58533545
Pre-training layer 2, epoch 1, cost -93.7739588674
Pre-training layer 2, epoch 2, cost -86.4250425339
Pre-training layer 2, epoch 3, cost -82.430183932
Pre-training layer 2, epoch 4, cost -79.6469139862
Pre-training layer 2, epoch 5, cost -77.5182185109
Pre-training layer 2, epoch 5, representative training free energy 4648.61755908
Pre-training layer 2, epoch 5, validation free energy 4608.54146558
Pre-training layer 2, epoch 6, cost -76.1456510417
Pre-training layer 2, epoch 7, cost -74.6658241399
Pre-training layer 2, epoch 8, cost -73.6682255173
Pre-training layer 2, epoch 9, cost -72.7273453267
Pre-training layer 2, epoch 10, cost -72.0101887639
Pre-training layer 2, epoch 10, representative training free energy 5561.28892822
Pre-training layer 2, epoch 10, validation free energy 5515.59795264
Pre-training layer 2, epoch 11, cost -71.2814263407
Pre-training layer 2, epoch 12, cost -70.8926033274
Pre-training layer 2, epoch 13, cost -70.332280515
Pre-training layer 2, epoch 14, cost -69.8267026774
Pre-training layer 2, epoch 15, cost -69.4305699158
Pre-training layer 2, epoch 15, representative training free energy 6211.69972192
Pre-training layer 2, epoch 15, validation free energy 6160.5429248
Pre-training layer 2, epoch 16, cost -68.9922355016
Pre-training layer 2, epoch 17, cost -68.6109534963
Pre-training layer 2, epoch 18, cost -68.2811046219
Pre-training layer 2, epoch 19, cost -67.9935931015
Pre-training layer 2, epoch 20, cost -67.6335215759
Pre-training layer 2, epoch 20, representative training free energy 6739.57297607
Pre-training layer 2, epoch 20, validation free energy 6682.62163428
Pre-training layer 2, epoch 21, cost -67.549847908
Pre-training layer 2, epoch 22, cost -67.1353038534
Pre-training layer 2, epoch 23, cost -67.0860024897
Pre-training layer 2, epoch 24, cost -66.824640007
Pre-training layer 2, epoch 25, cost -66.5417238108
Pre-training layer 2, epoch 25, representative training free energy 7197.1581167
Pre-training layer 2, epoch 25, validation free energy 7134.14670996
Pre-training layer 2, epoch 26, cost -66.4091687902
Pre-training layer 2, epoch 27, cost -66.2602729416
Pre-training layer 2, epoch 28, cost -66.004822375
Pre-training layer 2, epoch 29, cost -65.9337401072
Pre-training layer 2, epoch 30, cost -65.8404894129
Pre-training layer 2, epoch 30, representative training free energy 7602.63242676
Pre-training layer 2, epoch 30, validation free energy 7535.06503418
Pre-training layer 2, epoch 31, cost -65.5831009165
Pre-training layer 2, epoch 32, cost -65.4346319326
Pre-training layer 2, epoch 33, cost -65.3107858022
Pre-training layer 2, epoch 34, cost -65.1819330215
Pre-training layer 2, epoch 35, cost -65.1611839167
Pre-training layer 2, epoch 35, representative training free energy 7960.894146
Pre-training layer 2, epoch 35, validation free energy 7890.31571924
Pre-training layer 2, epoch 36, cost -65.1785474014
Pre-training layer 2, epoch 37, cost -64.9483746974
Pre-training layer 2, epoch 38, cost -64.8533217494
Pre-training layer 2, epoch 39, cost -64.8374359385
Pre-training layer 2, epoch 40, cost -64.7284793981
Pre-training layer 2, epoch 40, representative training free energy 8289.31637061
Pre-training layer 2, epoch 40, validation free energy 8215.50998926
Pre-training layer 2, epoch 41, cost -64.5756564331
Pre-training layer 2, epoch 42, cost -64.6324128723
Pre-training layer 2, epoch 43, cost -64.3976198196
Pre-training layer 2, epoch 44, cost -64.3891722616
Pre-training layer 2, epoch 45, cost -64.2514648056
Pre-training layer 2, epoch 45, representative training free energy 8583.29272607
Pre-training layer 2, epoch 45, validation free energy 8506.61595557
Pre-training layer 2, epoch 46, cost -64.0836480586
Pre-training layer 2, epoch 47, cost -64.1958864085
Pre-training layer 2, epoch 48, cost -64.036989212
Pre-training layer 2, epoch 49, cost -63.9516793569
Pre-training layer 2, epoch 50, cost -63.9021861521
Pre-training layer 2, epoch 50, representative training free energy 8880.83564453
Pre-training layer 2, epoch 50, validation free energy 8801.19463867
Pre-training layer 2, epoch 51, cost -63.9631241608
Pre-training layer 2, epoch 52, cost -63.7020825322
Pre-training layer 2, epoch 53, cost -63.7722503026
Pre-training layer 2, epoch 54, cost -63.6948295848
Pre-training layer 2, epoch 55, cost -63.780586586
Pre-training layer 2, epoch 55, representative training free energy 9147.94725244
Pre-training layer 2, epoch 55, validation free energy 9066.00120654
Pre-training layer 2, epoch 56, cost -63.6691451772
Pre-training layer 2, epoch 57, cost -63.5655676524
Pre-training layer 2, epoch 58, cost -63.5364885839
Pre-training layer 2, epoch 59, cost -63.298857104
Pre-training layer 2, epoch 60, cost -63.4221398544
Pre-training layer 2, epoch 60, representative training free energy 9424.46203223
Pre-training layer 2, epoch 60, validation free energy 9339.62970703
Pre-training layer 2, epoch 61, cost -63.2746743647
Pre-training layer 2, epoch 62, cost -63.3647104518
Pre-training layer 2, epoch 63, cost -63.3102191289
Pre-training layer 2, epoch 64, cost -63.2641885122
Pre-training layer 2, epoch 65, cost -63.230898145
Pre-training layer 2, epoch 65, representative training free energy 9657.13612842
Pre-training layer 2, epoch 65, validation free energy 9569.5713833
Pre-training layer 2, epoch 66, cost -63.2084019979
Pre-training layer 2, epoch 67, cost -63.0943331019
Pre-training layer 2, epoch 68, cost -63.1034942373
Pre-training layer 2, epoch 69, cost -63.08823747
Pre-training layer 2, epoch 70, cost -62.8856172689
Pre-training layer 2, epoch 70, representative training free energy 9897.40430566
Pre-training layer 2, epoch 70, validation free energy 9807.73513232
Pre-training layer 2, epoch 71, cost -62.9884743881
Pre-training layer 2, epoch 72, cost -62.916257871
Pre-training layer 2, epoch 73, cost -62.8589055252
Pre-training layer 2, epoch 74, cost -62.8666319529
Pre-training layer 2, epoch 75, cost -62.8151818848
Pre-training layer 2, epoch 75, representative training free energy 10125.5517773
Pre-training layer 2, epoch 75, validation free energy 10033.4432744
Pre-training layer 2, epoch 76, cost -62.7961190287
Pre-training layer 2, epoch 77, cost -62.7466934967
Pre-training layer 2, epoch 78, cost -62.7474562327
Pre-training layer 2, epoch 79, cost -62.6523273468
Pre-training layer 2, epoch 80, cost -62.7492384338
Pre-training layer 2, epoch 80, representative training free energy 10347.0702109
Pre-training layer 2, epoch 80, validation free energy 10252.3411021
Pre-training layer 2, epoch 81, cost -62.6532937876
Pre-training layer 2, epoch 82, cost -62.6266170629
Pre-training layer 2, epoch 83, cost -62.7094528453
Pre-training layer 2, epoch 84, cost -62.5111666616
Pre-training layer 2, epoch 85, cost -62.464738032
Pre-training layer 2, epoch 85, representative training free energy 10564.3481113
Pre-training layer 2, epoch 85, validation free energy 10468.3130625
Pre-training layer 2, epoch 86, cost -62.5661522802
Pre-training layer 2, epoch 87, cost -62.5288856125
Pre-training layer 2, epoch 88, cost -62.4414773305
Pre-training layer 2, epoch 89, cost -62.4299967066
Pre-training layer 2, epoch 90, cost -62.3904826355
Pre-training layer 2, epoch 90, representative training free energy 10773.0789443
Pre-training layer 2, epoch 90, validation free energy 10674.3722002
Pre-training layer 2, epoch 91, cost -62.3934680176
Pre-training layer 2, epoch 92, cost -62.2837156932
Pre-training layer 2, epoch 93, cost -62.3760963694
Pre-training layer 2, epoch 94, cost -62.2355267588
Pre-training layer 2, epoch 95, cost -62.2474940364
Pre-training layer 2, epoch 95, representative training free energy 10991.1441758
Pre-training layer 2, epoch 95, validation free energy 10890.3652695
Pre-training layer 2, epoch 96, cost -62.2676032893
Pre-training layer 2, epoch 97, cost -62.2109328588
Pre-training layer 2, epoch 98, cost -62.3077889379
Pre-training layer 2, epoch 99, cost -62.1709712346
The pretraining code for file dbn_loop.pyc ran for 7.87m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 33.200000 %
     epoch 1, minibatch 300/300, test error of best model 31.800000 %
epoch 2, minibatch 300/300, validation error 28.400000 %
     epoch 2, minibatch 300/300, test error of best model 22.600000 %
epoch 3, minibatch 300/300, validation error 26.000000 %
     epoch 3, minibatch 300/300, test error of best model 18.600000 %
epoch 4, minibatch 300/300, validation error 24.400000 %
     epoch 4, minibatch 300/300, test error of best model 15.200000 %
epoch 5, minibatch 300/300, validation error 23.800000 %
     epoch 5, minibatch 300/300, test error of best model 12.800000 %
epoch 6, minibatch 300/300, validation error 22.800000 %
     epoch 6, minibatch 300/300, test error of best model 12.600000 %
epoch 7, minibatch 300/300, validation error 21.200000 %
     epoch 7, minibatch 300/300, test error of best model 12.000000 %
epoch 8, minibatch 300/300, validation error 20.000000 %
     epoch 8, minibatch 300/300, test error of best model 10.600000 %
epoch 9, minibatch 300/300, validation error 20.000000 %
epoch 10, minibatch 300/300, validation error 19.200000 %
     epoch 10, minibatch 300/300, test error of best model 10.000000 %
epoch 11, minibatch 300/300, validation error 18.600000 %
     epoch 11, minibatch 300/300, test error of best model 10.000000 %
epoch 12, minibatch 300/300, validation error 18.000000 %
     epoch 12, minibatch 300/300, test error of best model 9.400000 %
epoch 13, minibatch 300/300, validation error 17.800000 %
     epoch 13, minibatch 300/300, test error of best model 8.400000 %
epoch 14, minibatch 300/300, validation error 18.000000 %
epoch 15, minibatch 300/300, validation error 17.800000 %
     epoch 15, minibatch 300/300, test error of best model 7.400000 %
epoch 16, minibatch 300/300, validation error 17.600000 %
     epoch 16, minibatch 300/300, test error of best model 7.400000 %
epoch 17, minibatch 300/300, validation error 17.600000 %
epoch 18, minibatch 300/300, validation error 17.600000 %
epoch 19, minibatch 300/300, validation error 17.400000 %
     epoch 19, minibatch 300/300, test error of best model 7.400000 %
epoch 20, minibatch 300/300, validation error 17.400000 %
epoch 21, minibatch 300/300, validation error 17.400000 %
epoch 22, minibatch 300/300, validation error 17.600000 %
epoch 23, minibatch 300/300, validation error 17.400000 %
epoch 24, minibatch 300/300, validation error 17.400000 %
epoch 25, minibatch 300/300, validation error 17.400000 %
epoch 26, minibatch 300/300, validation error 17.200000 %
     epoch 26, minibatch 300/300, test error of best model 7.400000 %
epoch 27, minibatch 300/300, validation error 17.200000 %
epoch 28, minibatch 300/300, validation error 17.000000 %
     epoch 28, minibatch 300/300, test error of best model 7.600000 %
epoch 29, minibatch 300/300, validation error 16.600000 %
     epoch 29, minibatch 300/300, test error of best model 7.400000 %
epoch 30, minibatch 300/300, validation error 16.600000 %
epoch 31, minibatch 300/300, validation error 16.600000 %
epoch 32, minibatch 300/300, validation error 16.600000 %
epoch 33, minibatch 300/300, validation error 16.600000 %
epoch 34, minibatch 300/300, validation error 16.600000 %
epoch 35, minibatch 300/300, validation error 16.600000 %
epoch 36, minibatch 300/300, validation error 16.400000 %
     epoch 36, minibatch 300/300, test error of best model 6.800000 %
epoch 37, minibatch 300/300, validation error 16.400000 %
epoch 38, minibatch 300/300, validation error 16.400000 %
epoch 39, minibatch 300/300, validation error 16.400000 %
epoch 40, minibatch 300/300, validation error 16.200000 %
     epoch 40, minibatch 300/300, test error of best model 6.200000 %
epoch 41, minibatch 300/300, validation error 16.400000 %
epoch 42, minibatch 300/300, validation error 16.000000 %
     epoch 42, minibatch 300/300, test error of best model 6.200000 %
epoch 43, minibatch 300/300, validation error 16.000000 %
epoch 44, minibatch 300/300, validation error 16.000000 %
epoch 45, minibatch 300/300, validation error 16.000000 %
epoch 46, minibatch 300/300, validation error 16.000000 %
epoch 47, minibatch 300/300, validation error 16.200000 %
epoch 48, minibatch 300/300, validation error 16.200000 %
epoch 49, minibatch 300/300, validation error 16.200000 %
epoch 50, minibatch 300/300, validation error 16.200000 %
epoch 51, minibatch 300/300, validation error 16.000000 %
epoch 52, minibatch 300/300, validation error 16.000000 %
epoch 53, minibatch 300/300, validation error 16.000000 %
epoch 54, minibatch 300/300, validation error 16.000000 %
epoch 55, minibatch 300/300, validation error 16.000000 %
epoch 56, minibatch 300/300, validation error 16.000000 %
epoch 57, minibatch 300/300, validation error 16.000000 %
epoch 58, minibatch 300/300, validation error 16.000000 %
epoch 59, minibatch 300/300, validation error 16.000000 %
epoch 60, minibatch 300/300, validation error 16.000000 %
epoch 61, minibatch 300/300, validation error 16.000000 %
epoch 62, minibatch 300/300, validation error 16.000000 %
epoch 63, minibatch 300/300, validation error 16.000000 %
epoch 64, minibatch 300/300, validation error 16.000000 %
epoch 65, minibatch 300/300, validation error 16.000000 %
epoch 66, minibatch 300/300, validation error 16.200000 %
epoch 67, minibatch 300/300, validation error 16.200000 %
epoch 68, minibatch 300/300, validation error 16.200000 %
epoch 69, minibatch 300/300, validation error 16.200000 %
epoch 70, minibatch 300/300, validation error 16.200000 %
epoch 71, minibatch 300/300, validation error 16.200000 %
epoch 72, minibatch 300/300, validation error 16.200000 %
epoch 73, minibatch 300/300, validation error 16.200000 %
epoch 74, minibatch 300/300, validation error 16.200000 %
epoch 75, minibatch 300/300, validation error 16.200000 %
epoch 76, minibatch 300/300, validation error 16.200000 %
epoch 77, minibatch 300/300, validation error 16.200000 %
epoch 78, minibatch 300/300, validation error 16.200000 %
epoch 79, minibatch 300/300, validation error 16.200000 %
epoch 80, minibatch 300/300, validation error 16.200000 %
epoch 81, minibatch 300/300, validation error 16.200000 %
epoch 82, minibatch 300/300, validation error 16.400000 %
epoch 83, minibatch 300/300, validation error 16.400000 %
Optimization complete with best validation score of 16.000000 %, obtained at iteration 12600, with test performance 6.200000 %
The fine tuning code for file dbn_loop.pyc ran for 2.06m


==========Sample: (4000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.345186977
Pre-training layer 0, epoch 0, representative training free energy -553.000607117
Pre-training layer 0, epoch 0, validation free energy -547.041478027
Pre-training layer 0, epoch 1, cost -112.01057724
Pre-training layer 0, epoch 2, cost -103.647974968
Pre-training layer 0, epoch 3, cost -99.039215374
Pre-training layer 0, epoch 4, cost -95.8358143616
Pre-training layer 0, epoch 5, cost -93.3523364449
Pre-training layer 0, epoch 5, representative training free energy -495.624749817
Pre-training layer 0, epoch 5, validation free energy -488.214857544
Pre-training layer 0, epoch 6, cost -91.6261320114
Pre-training layer 0, epoch 7, cost -90.0908473015
Pre-training layer 0, epoch 8, cost -88.9474841976
Pre-training layer 0, epoch 9, cost -87.7014866257
Pre-training layer 0, epoch 10, cost -86.9524047947
Pre-training layer 0, epoch 10, representative training free energy -469.960322327
Pre-training layer 0, epoch 10, validation free energy -461.414029968
Pre-training layer 0, epoch 11, cost -86.2245289803
Pre-training layer 0, epoch 12, cost -85.2568978786
Pre-training layer 0, epoch 13, cost -84.7038534927
Pre-training layer 0, epoch 14, cost -84.1158663845
Pre-training layer 0, epoch 15, cost -83.5811991692
Pre-training layer 0, epoch 15, representative training free energy -460.198903931
Pre-training layer 0, epoch 15, validation free energy -452.537521057
Pre-training layer 0, epoch 16, cost -83.1224609852
Pre-training layer 0, epoch 17, cost -82.8347504807
Pre-training layer 0, epoch 18, cost -82.3627752686
Pre-training layer 0, epoch 19, cost -81.8914618778
Pre-training layer 0, epoch 20, cost -81.598126812
Pre-training layer 0, epoch 20, representative training free energy -451.03687738
Pre-training layer 0, epoch 20, validation free energy -442.753164673
Pre-training layer 0, epoch 21, cost -81.1937236595
Pre-training layer 0, epoch 22, cost -80.9053215885
Pre-training layer 0, epoch 23, cost -80.6789649391
Pre-training layer 0, epoch 24, cost -80.342010994
Pre-training layer 0, epoch 25, cost -80.1700232506
Pre-training layer 0, epoch 25, representative training free energy -447.021101196
Pre-training layer 0, epoch 25, validation free energy -437.851693359
Pre-training layer 0, epoch 26, cost -79.7726275444
Pre-training layer 0, epoch 27, cost -79.5868334579
Pre-training layer 0, epoch 28, cost -79.3892072678
Pre-training layer 0, epoch 29, cost -79.0646808147
Pre-training layer 0, epoch 30, cost -78.8669683743
Pre-training layer 0, epoch 30, representative training free energy -443.277260559
Pre-training layer 0, epoch 30, validation free energy -434.281159119
Pre-training layer 0, epoch 31, cost -78.8495412731
Pre-training layer 0, epoch 32, cost -78.6657469082
Pre-training layer 0, epoch 33, cost -78.4295419121
Pre-training layer 0, epoch 34, cost -78.2663180542
Pre-training layer 0, epoch 35, cost -78.1467540359
Pre-training layer 0, epoch 35, representative training free energy -437.185617981
Pre-training layer 0, epoch 35, validation free energy -427.59419165
Pre-training layer 0, epoch 36, cost -78.0039891338
Pre-training layer 0, epoch 37, cost -77.7364791775
Pre-training layer 0, epoch 38, cost -77.5805396271
Pre-training layer 0, epoch 39, cost -77.5407675648
Pre-training layer 0, epoch 40, cost -77.2518549347
Pre-training layer 0, epoch 40, representative training free energy -435.375646484
Pre-training layer 0, epoch 40, validation free energy -425.927122559
Pre-training layer 0, epoch 41, cost -77.1834359455
Pre-training layer 0, epoch 42, cost -77.1247773647
Pre-training layer 0, epoch 43, cost -76.8597186184
Pre-training layer 0, epoch 44, cost -76.8991595745
Pre-training layer 0, epoch 45, cost -76.7338679123
Pre-training layer 0, epoch 45, representative training free energy -436.035456482
Pre-training layer 0, epoch 45, validation free energy -426.198395508
Pre-training layer 0, epoch 46, cost -76.6773953152
Pre-training layer 0, epoch 47, cost -76.4501666355
Pre-training layer 0, epoch 48, cost -76.351987381
Pre-training layer 0, epoch 49, cost -76.295061264
Pre-training layer 0, epoch 50, cost -76.1770095444
Pre-training layer 0, epoch 50, representative training free energy -432.787485657
Pre-training layer 0, epoch 50, validation free energy -422.536172363
Pre-training layer 0, epoch 51, cost -76.1053534412
Pre-training layer 0, epoch 52, cost -75.8986346149
Pre-training layer 0, epoch 53, cost -75.8478776073
Pre-training layer 0, epoch 54, cost -75.7271271515
Pre-training layer 0, epoch 55, cost -75.5615410423
Pre-training layer 0, epoch 55, representative training free energy -431.079255554
Pre-training layer 0, epoch 55, validation free energy -420.810947205
Pre-training layer 0, epoch 56, cost -75.5816819954
Pre-training layer 0, epoch 57, cost -75.5188726139
Pre-training layer 0, epoch 58, cost -75.4162368298
Pre-training layer 0, epoch 59, cost -75.3025070667
Pre-training layer 0, epoch 60, cost -75.2501467037
Pre-training layer 0, epoch 60, representative training free energy -429.457144226
Pre-training layer 0, epoch 60, validation free energy -419.428656555
Pre-training layer 0, epoch 61, cost -75.1603657627
Pre-training layer 0, epoch 62, cost -75.1057577705
Pre-training layer 0, epoch 63, cost -75.0638209343
Pre-training layer 0, epoch 64, cost -74.9013274193
Pre-training layer 0, epoch 65, cost -74.8742114639
Pre-training layer 0, epoch 65, representative training free energy -429.516463013
Pre-training layer 0, epoch 65, validation free energy -418.960932556
Pre-training layer 0, epoch 66, cost -74.8008190632
Pre-training layer 0, epoch 67, cost -74.582308588
Pre-training layer 0, epoch 68, cost -74.5827535152
Pre-training layer 0, epoch 69, cost -74.6639101887
Pre-training layer 0, epoch 70, cost -74.4742894745
Pre-training layer 0, epoch 70, representative training free energy -427.778054932
Pre-training layer 0, epoch 70, validation free energy -417.480347351
Pre-training layer 0, epoch 71, cost -74.3879075623
Pre-training layer 0, epoch 72, cost -74.3890312386
Pre-training layer 0, epoch 73, cost -74.3323134708
Pre-training layer 0, epoch 74, cost -74.1888741302
Pre-training layer 0, epoch 75, cost -74.0995762539
Pre-training layer 0, epoch 75, representative training free energy -425.35409906
Pre-training layer 0, epoch 75, validation free energy -414.666196594
Pre-training layer 0, epoch 76, cost -74.1362731838
Pre-training layer 0, epoch 77, cost -74.1846796703
Pre-training layer 0, epoch 78, cost -74.0485819912
Pre-training layer 0, epoch 79, cost -73.9808426189
Pre-training layer 0, epoch 80, cost -73.9828390598
Pre-training layer 0, epoch 80, representative training free energy -425.883913818
Pre-training layer 0, epoch 80, validation free energy -415.128338501
Pre-training layer 0, epoch 81, cost -73.8785955143
Pre-training layer 0, epoch 82, cost -73.7386807156
Pre-training layer 0, epoch 83, cost -73.6473538113
Pre-training layer 0, epoch 84, cost -73.6567208576
Pre-training layer 0, epoch 85, cost -73.6908313656
Pre-training layer 0, epoch 85, representative training free energy -424.960583801
Pre-training layer 0, epoch 85, validation free energy -413.90238147
Pre-training layer 0, epoch 86, cost -73.6351799202
Pre-training layer 0, epoch 87, cost -73.5565023232
Pre-training layer 0, epoch 88, cost -73.3056216049
Pre-training layer 0, epoch 89, cost -73.4217305374
Pre-training layer 0, epoch 90, cost -73.3478692532
Pre-training layer 0, epoch 90, representative training free energy -421.403079529
Pre-training layer 0, epoch 90, validation free energy -410.264542908
Pre-training layer 0, epoch 91, cost -73.3820985508
Pre-training layer 0, epoch 92, cost -73.3059917164
Pre-training layer 0, epoch 93, cost -73.2434111786
Pre-training layer 0, epoch 94, cost -73.2622557068
Pre-training layer 0, epoch 95, cost -73.190451622
Pre-training layer 0, epoch 95, representative training free energy -423.830947632
Pre-training layer 0, epoch 95, validation free energy -412.654754395
Pre-training layer 0, epoch 96, cost -73.2416765881
Pre-training layer 0, epoch 97, cost -72.9697124672
Pre-training layer 0, epoch 98, cost -73.0336616421
Pre-training layer 0, epoch 99, cost -73.0411406994
Pre-training layer 1, epoch 0, cost -324.009760857
Pre-training layer 1, epoch 0, representative training free energy -56729.2392969
Pre-training layer 1, epoch 0, validation free energy -56248.6852891
Pre-training layer 1, epoch 1, cost -278.516576576
Pre-training layer 1, epoch 2, cost -264.546680908
Pre-training layer 1, epoch 3, cost -256.275443611
Pre-training layer 1, epoch 4, cost -250.683737221
Pre-training layer 1, epoch 5, cost -246.51549572
Pre-training layer 1, epoch 5, representative training free energy -76041.6216367
Pre-training layer 1, epoch 5, validation free energy -75407.3037578
Pre-training layer 1, epoch 6, cost -243.50261097
Pre-training layer 1, epoch 7, cost -240.809342766
Pre-training layer 1, epoch 8, cost -238.699195175
Pre-training layer 1, epoch 9, cost -236.910867004
Pre-training layer 1, epoch 10, cost -235.453507347
Pre-training layer 1, epoch 10, representative training free energy -81682.2491484
Pre-training layer 1, epoch 10, validation free energy -81008.4991797
Pre-training layer 1, epoch 11, cost -234.15724514
Pre-training layer 1, epoch 12, cost -232.997911491
Pre-training layer 1, epoch 13, cost -232.047486877
Pre-training layer 1, epoch 14, cost -231.023376045
Pre-training layer 1, epoch 15, cost -230.329934158
Pre-training layer 1, epoch 15, representative training free energy -85233.5574102
Pre-training layer 1, epoch 15, validation free energy -84528.4991445
Pre-training layer 1, epoch 16, cost -229.646835403
Pre-training layer 1, epoch 17, cost -228.954016495
Pre-training layer 1, epoch 18, cost -228.250938263
Pre-training layer 1, epoch 19, cost -227.823672485
Pre-training layer 1, epoch 20, cost -227.216531029
Pre-training layer 1, epoch 20, representative training free energy -87738.7482852
Pre-training layer 1, epoch 20, validation free energy -87009.5940586
Pre-training layer 1, epoch 21, cost -226.654630394
Pre-training layer 1, epoch 22, cost -226.208862648
Pre-training layer 1, epoch 23, cost -225.844299583
Pre-training layer 1, epoch 24, cost -225.394078369
Pre-training layer 1, epoch 25, cost -225.076819878
Pre-training layer 1, epoch 25, representative training free energy -89657.4042812
Pre-training layer 1, epoch 25, validation free energy -88916.4622578
Pre-training layer 1, epoch 26, cost -224.667538147
Pre-training layer 1, epoch 27, cost -224.282735634
Pre-training layer 1, epoch 28, cost -224.107155762
Pre-training layer 1, epoch 29, cost -223.835665398
Pre-training layer 1, epoch 30, cost -223.470765724
Pre-training layer 1, epoch 30, representative training free energy -91223.760125
Pre-training layer 1, epoch 30, validation free energy -90469.8363164
Pre-training layer 1, epoch 31, cost -223.217915306
Pre-training layer 1, epoch 32, cost -222.892645187
Pre-training layer 1, epoch 33, cost -222.647399902
Pre-training layer 1, epoch 34, cost -222.494439049
Pre-training layer 1, epoch 35, cost -222.265172997
Pre-training layer 1, epoch 35, representative training free energy -92496.3538867
Pre-training layer 1, epoch 35, validation free energy -91727.7771289
Pre-training layer 1, epoch 36, cost -222.06485714
Pre-training layer 1, epoch 37, cost -221.925681381
Pre-training layer 1, epoch 38, cost -221.630756989
Pre-training layer 1, epoch 39, cost -221.403754921
Pre-training layer 1, epoch 40, cost -221.179506798
Pre-training layer 1, epoch 40, representative training free energy -93655.151375
Pre-training layer 1, epoch 40, validation free energy -92883.8006719
Pre-training layer 1, epoch 41, cost -221.102812653
Pre-training layer 1, epoch 42, cost -220.833673019
Pre-training layer 1, epoch 43, cost -220.609640694
Pre-training layer 1, epoch 44, cost -220.461135826
Pre-training layer 1, epoch 45, cost -220.378456764
Pre-training layer 1, epoch 45, representative training free energy -94797.5667891
Pre-training layer 1, epoch 45, validation free energy -94023.3940508
Pre-training layer 1, epoch 46, cost -220.180729828
Pre-training layer 1, epoch 47, cost -220.046473198
Pre-training layer 1, epoch 48, cost -219.854067993
Pre-training layer 1, epoch 49, cost -219.765180359
Pre-training layer 1, epoch 50, cost -219.591855545
Pre-training layer 1, epoch 50, representative training free energy -95678.0951758
Pre-training layer 1, epoch 50, validation free energy -94888.5585391
Pre-training layer 1, epoch 51, cost -219.456322098
Pre-training layer 1, epoch 52, cost -219.307456131
Pre-training layer 1, epoch 53, cost -219.138015785
Pre-training layer 1, epoch 54, cost -219.07229847
Pre-training layer 1, epoch 55, cost -218.992371635
Pre-training layer 1, epoch 55, representative training free energy -96570.2472813
Pre-training layer 1, epoch 55, validation free energy -95779.2782539
Pre-training layer 1, epoch 56, cost -218.869429169
Pre-training layer 1, epoch 57, cost -218.775897865
Pre-training layer 1, epoch 58, cost -218.598799629
Pre-training layer 1, epoch 59, cost -218.604880486
Pre-training layer 1, epoch 60, cost -218.493141212
Pre-training layer 1, epoch 60, representative training free energy -97360.7094688
Pre-training layer 1, epoch 60, validation free energy -96563.7909805
Pre-training layer 1, epoch 61, cost -218.337907372
Pre-training layer 1, epoch 62, cost -218.227953873
Pre-training layer 1, epoch 63, cost -218.125599213
Pre-training layer 1, epoch 64, cost -218.110079079
Pre-training layer 1, epoch 65, cost -218.051594467
Pre-training layer 1, epoch 65, representative training free energy -98005.6349844
Pre-training layer 1, epoch 65, validation free energy -97200.7476172
Pre-training layer 1, epoch 66, cost -217.926627731
Pre-training layer 1, epoch 67, cost -217.741318512
Pre-training layer 1, epoch 68, cost -217.782208672
Pre-training layer 1, epoch 69, cost -217.595522346
Pre-training layer 1, epoch 70, cost -217.72840992
Pre-training layer 1, epoch 70, representative training free energy -98766.5264609
Pre-training layer 1, epoch 70, validation free energy -97948.1653281
Pre-training layer 1, epoch 71, cost -217.496260223
Pre-training layer 1, epoch 72, cost -217.376153908
Pre-training layer 1, epoch 73, cost -217.332113991
Pre-training layer 1, epoch 74, cost -217.276132545
Pre-training layer 1, epoch 75, cost -217.156593094
Pre-training layer 1, epoch 75, representative training free energy -99383.9057344
Pre-training layer 1, epoch 75, validation free energy -98564.4272734
Pre-training layer 1, epoch 76, cost -217.125079155
Pre-training layer 1, epoch 77, cost -216.976074333
Pre-training layer 1, epoch 78, cost -216.953059044
Pre-training layer 1, epoch 79, cost -216.868700218
Pre-training layer 1, epoch 80, cost -216.847626076
Pre-training layer 1, epoch 80, representative training free energy -100008.220953
Pre-training layer 1, epoch 80, validation free energy -99179.5219609
Pre-training layer 1, epoch 81, cost -216.835447845
Pre-training layer 1, epoch 82, cost -216.699823418
Pre-training layer 1, epoch 83, cost -216.613503685
Pre-training layer 1, epoch 84, cost -216.563062706
Pre-training layer 1, epoch 85, cost -216.527036781
Pre-training layer 1, epoch 85, representative training free energy -100675.92082
Pre-training layer 1, epoch 85, validation free energy -99847.1147656
Pre-training layer 1, epoch 86, cost -216.537630463
Pre-training layer 1, epoch 87, cost -216.455002441
Pre-training layer 1, epoch 88, cost -216.330039749
Pre-training layer 1, epoch 89, cost -216.351464233
Pre-training layer 1, epoch 90, cost -216.278856239
Pre-training layer 1, epoch 90, representative training free energy -101221.279383
Pre-training layer 1, epoch 90, validation free energy -100385.527188
Pre-training layer 1, epoch 91, cost -216.228361168
Pre-training layer 1, epoch 92, cost -216.165015335
Pre-training layer 1, epoch 93, cost -216.112120972
Pre-training layer 1, epoch 94, cost -216.040739899
Pre-training layer 1, epoch 95, cost -215.959893723
Pre-training layer 1, epoch 95, representative training free energy -101732.562844
Pre-training layer 1, epoch 95, validation free energy -100890.605008
Pre-training layer 1, epoch 96, cost -215.925606842
Pre-training layer 1, epoch 97, cost -215.931948814
Pre-training layer 1, epoch 98, cost -215.844655457
Pre-training layer 1, epoch 99, cost -215.876020241
Pre-training layer 2, epoch 0, cost -119.669236603
Pre-training layer 2, epoch 0, representative training free energy 3729.20505396
Pre-training layer 2, epoch 0, validation free energy 3722.52794775
Pre-training layer 2, epoch 1, cost -89.478051281
Pre-training layer 2, epoch 2, cost -82.8743301201
Pre-training layer 2, epoch 3, cost -79.0225935268
Pre-training layer 2, epoch 4, cost -76.6083555508
Pre-training layer 2, epoch 5, cost -74.9168207741
Pre-training layer 2, epoch 5, representative training free energy 5862.11035107
Pre-training layer 2, epoch 5, validation free energy 5824.10350952
Pre-training layer 2, epoch 6, cost -73.4002041435
Pre-training layer 2, epoch 7, cost -72.2781223679
Pre-training layer 2, epoch 8, cost -71.2138987732
Pre-training layer 2, epoch 9, cost -70.53128335
Pre-training layer 2, epoch 10, cost -69.8521201515
Pre-training layer 2, epoch 10, representative training free energy 7019.00491113
Pre-training layer 2, epoch 10, validation free energy 6961.1452666
Pre-training layer 2, epoch 11, cost -69.267665472
Pre-training layer 2, epoch 12, cost -68.6131075191
Pre-training layer 2, epoch 13, cost -68.1820907021
Pre-training layer 2, epoch 14, cost -67.8128041649
Pre-training layer 2, epoch 15, cost -67.4981393623
Pre-training layer 2, epoch 15, representative training free energy 7877.44517383
Pre-training layer 2, epoch 15, validation free energy 7808.79977783
Pre-training layer 2, epoch 16, cost -67.2077680206
Pre-training layer 2, epoch 17, cost -66.7879413795
Pre-training layer 2, epoch 18, cost -66.5652755928
Pre-training layer 2, epoch 19, cost -66.2915238857
Pre-training layer 2, epoch 20, cost -65.9799363613
Pre-training layer 2, epoch 20, representative training free energy 8611.6224585
Pre-training layer 2, epoch 20, validation free energy 8537.32433154
Pre-training layer 2, epoch 21, cost -65.7867924976
Pre-training layer 2, epoch 22, cost -65.60852705
Pre-training layer 2, epoch 23, cost -65.3934288502
Pre-training layer 2, epoch 24, cost -65.2895491409
Pre-training layer 2, epoch 25, cost -65.1029805279
Pre-training layer 2, epoch 25, representative training free energy 9182.68062939
Pre-training layer 2, epoch 25, validation free energy 9102.85061035
Pre-training layer 2, epoch 26, cost -64.9229708385
Pre-training layer 2, epoch 27, cost -64.6966580009
Pre-training layer 2, epoch 28, cost -64.6884514332
Pre-training layer 2, epoch 29, cost -64.4611398697
Pre-training layer 2, epoch 30, cost -64.4219325161
Pre-training layer 2, epoch 30, representative training free energy 9688.23674902
Pre-training layer 2, epoch 30, validation free energy 9603.44546631
Pre-training layer 2, epoch 31, cost -64.2831691837
Pre-training layer 2, epoch 32, cost -64.2042676067
Pre-training layer 2, epoch 33, cost -63.9919813061
Pre-training layer 2, epoch 34, cost -63.9341276836
Pre-training layer 2, epoch 35, cost -63.8394830608
Pre-training layer 2, epoch 35, representative training free energy 10168.3829399
Pre-training layer 2, epoch 35, validation free energy 10079.6719653
Pre-training layer 2, epoch 36, cost -63.6353931713
Pre-training layer 2, epoch 37, cost -63.7287786293
Pre-training layer 2, epoch 38, cost -63.6042314148
Pre-training layer 2, epoch 39, cost -63.5081162834
Pre-training layer 2, epoch 40, cost -63.4711856651
Pre-training layer 2, epoch 40, representative training free energy 10612.3651963
Pre-training layer 2, epoch 40, validation free energy 10517.6719307
Pre-training layer 2, epoch 41, cost -63.2946359539
Pre-training layer 2, epoch 42, cost -63.3110994816
Pre-training layer 2, epoch 43, cost -63.2190789509
Pre-training layer 2, epoch 44, cost -63.1546642971
Pre-training layer 2, epoch 45, cost -63.0768171215
Pre-training layer 2, epoch 45, representative training free energy 10964.514667
Pre-training layer 2, epoch 45, validation free energy 10866.1194209
Pre-training layer 2, epoch 46, cost -62.9923882389
Pre-training layer 2, epoch 47, cost -62.9712626743
Pre-training layer 2, epoch 48, cost -62.8549456406
Pre-training layer 2, epoch 49, cost -62.7313080788
Pre-training layer 2, epoch 50, cost -62.794867382
Pre-training layer 2, epoch 50, representative training free energy 11337.2384512
Pre-training layer 2, epoch 50, validation free energy 11233.6298965
Pre-training layer 2, epoch 51, cost -62.7282152939
Pre-training layer 2, epoch 52, cost -62.6948295307
Pre-training layer 2, epoch 53, cost -62.6092640305
Pre-training layer 2, epoch 54, cost -62.4740934467
Pre-training layer 2, epoch 55, cost -62.5695891094
Pre-training layer 2, epoch 55, representative training free energy 11708.4368682
Pre-training layer 2, epoch 55, validation free energy 11602.4241294
Pre-training layer 2, epoch 56, cost -62.506941309
Pre-training layer 2, epoch 57, cost -62.4332932472
Pre-training layer 2, epoch 58, cost -62.369658165
Pre-training layer 2, epoch 59, cost -62.3760128689
Pre-training layer 2, epoch 60, cost -62.3259669113
Pre-training layer 2, epoch 60, representative training free energy 12000.1140508
Pre-training layer 2, epoch 60, validation free energy 11890.794249
Pre-training layer 2, epoch 61, cost -62.2526859856
Pre-training layer 2, epoch 62, cost -62.196462307
Pre-training layer 2, epoch 63, cost -62.2877596283
Pre-training layer 2, epoch 64, cost -62.2020902538
Pre-training layer 2, epoch 65, cost -62.0861818981
Pre-training layer 2, epoch 65, representative training free energy 12314.0453711
Pre-training layer 2, epoch 65, validation free energy 12200.3318867
Pre-training layer 2, epoch 66, cost -61.9947190475
Pre-training layer 2, epoch 67, cost -62.0145314407
Pre-training layer 2, epoch 68, cost -62.0122263908
Pre-training layer 2, epoch 69, cost -61.9567318535
Pre-training layer 2, epoch 70, cost -61.9160549068
Pre-training layer 2, epoch 70, representative training free energy 12621.1616689
Pre-training layer 2, epoch 70, validation free energy 12504.9722295
Pre-training layer 2, epoch 71, cost -61.9387804222
Pre-training layer 2, epoch 72, cost -61.9310513401
Pre-training layer 2, epoch 73, cost -61.757328558
Pre-training layer 2, epoch 74, cost -61.8941684437
Pre-training layer 2, epoch 75, cost -61.811339159
Pre-training layer 2, epoch 75, representative training free energy 12913.4643057
Pre-training layer 2, epoch 75, validation free energy 12794.095499
Pre-training layer 2, epoch 76, cost -61.771539278
Pre-training layer 2, epoch 77, cost -61.7388049126
Pre-training layer 2, epoch 78, cost -61.6750237179
Pre-training layer 2, epoch 79, cost -61.6934840965
Pre-training layer 2, epoch 80, cost -61.6429719639
Pre-training layer 2, epoch 80, representative training free energy 13209.5023125
Pre-training layer 2, epoch 80, validation free energy 13085.9407051
Pre-training layer 2, epoch 81, cost -61.6230786133
Pre-training layer 2, epoch 82, cost -61.647892065
Pre-training layer 2, epoch 83, cost -61.544749794
Pre-training layer 2, epoch 84, cost -61.584356823
Pre-training layer 2, epoch 85, cost -61.4992469311
Pre-training layer 2, epoch 85, representative training free energy 13475.8378574
Pre-training layer 2, epoch 85, validation free energy 13349.4047432
Pre-training layer 2, epoch 86, cost -61.4847901249
Pre-training layer 2, epoch 87, cost -61.4300128841
Pre-training layer 2, epoch 88, cost -61.4505227089
Pre-training layer 2, epoch 89, cost -61.3930506992
Pre-training layer 2, epoch 90, cost -61.3939015484
Pre-training layer 2, epoch 90, representative training free energy 13736.9716182
Pre-training layer 2, epoch 90, validation free energy 13607.6248857
Pre-training layer 2, epoch 91, cost -61.4082558346
Pre-training layer 2, epoch 92, cost -61.3166852856
Pre-training layer 2, epoch 93, cost -61.3514732456
Pre-training layer 2, epoch 94, cost -61.4005988789
Pre-training layer 2, epoch 95, cost -61.2942385674
Pre-training layer 2, epoch 95, representative training free energy 13976.9185254
Pre-training layer 2, epoch 95, validation free energy 13844.9618545
Pre-training layer 2, epoch 96, cost -61.2408898544
Pre-training layer 2, epoch 97, cost -61.3456101894
Pre-training layer 2, epoch 98, cost -61.2142590904
Pre-training layer 2, epoch 99, cost -61.3390838146
The pretraining code for file dbn_loop.pyc ran for 10.39m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 36.200000 %
     epoch 1, minibatch 400/400, test error of best model 30.600000 %
epoch 2, minibatch 400/400, validation error 25.800000 %
     epoch 2, minibatch 400/400, test error of best model 18.400000 %
epoch 3, minibatch 400/400, validation error 22.000000 %
     epoch 3, minibatch 400/400, test error of best model 13.600000 %
epoch 4, minibatch 400/400, validation error 20.800000 %
     epoch 4, minibatch 400/400, test error of best model 11.800000 %
epoch 5, minibatch 400/400, validation error 20.000000 %
     epoch 5, minibatch 400/400, test error of best model 10.400000 %
epoch 6, minibatch 400/400, validation error 18.600000 %
     epoch 6, minibatch 400/400, test error of best model 9.600000 %
epoch 7, minibatch 400/400, validation error 18.600000 %
epoch 8, minibatch 400/400, validation error 18.000000 %
     epoch 8, minibatch 400/400, test error of best model 7.400000 %
epoch 9, minibatch 400/400, validation error 17.800000 %
     epoch 9, minibatch 400/400, test error of best model 6.800000 %
epoch 10, minibatch 400/400, validation error 17.800000 %
epoch 11, minibatch 400/400, validation error 17.600000 %
     epoch 11, minibatch 400/400, test error of best model 6.600000 %
epoch 12, minibatch 400/400, validation error 17.400000 %
     epoch 12, minibatch 400/400, test error of best model 6.000000 %
epoch 13, minibatch 400/400, validation error 17.000000 %
     epoch 13, minibatch 400/400, test error of best model 6.200000 %
epoch 14, minibatch 400/400, validation error 17.000000 %
epoch 15, minibatch 400/400, validation error 16.800000 %
     epoch 15, minibatch 400/400, test error of best model 6.400000 %
epoch 16, minibatch 400/400, validation error 16.800000 %
epoch 17, minibatch 400/400, validation error 16.600000 %
     epoch 17, minibatch 400/400, test error of best model 6.400000 %
epoch 18, minibatch 400/400, validation error 16.400000 %
     epoch 18, minibatch 400/400, test error of best model 6.600000 %
epoch 19, minibatch 400/400, validation error 16.400000 %
epoch 20, minibatch 400/400, validation error 16.400000 %
epoch 21, minibatch 400/400, validation error 16.400000 %
epoch 22, minibatch 400/400, validation error 16.400000 %
epoch 23, minibatch 400/400, validation error 16.400000 %
epoch 24, minibatch 400/400, validation error 16.400000 %
epoch 25, minibatch 400/400, validation error 16.600000 %
epoch 26, minibatch 400/400, validation error 16.400000 %
epoch 27, minibatch 400/400, validation error 16.400000 %
epoch 28, minibatch 400/400, validation error 16.400000 %
epoch 29, minibatch 400/400, validation error 16.400000 %
epoch 30, minibatch 400/400, validation error 16.400000 %
epoch 31, minibatch 400/400, validation error 16.200000 %
     epoch 31, minibatch 400/400, test error of best model 6.400000 %
epoch 32, minibatch 400/400, validation error 16.200000 %
epoch 33, minibatch 400/400, validation error 16.200000 %
epoch 34, minibatch 400/400, validation error 16.200000 %
epoch 35, minibatch 400/400, validation error 16.200000 %
epoch 36, minibatch 400/400, validation error 16.000000 %
     epoch 36, minibatch 400/400, test error of best model 6.200000 %
epoch 37, minibatch 400/400, validation error 15.800000 %
     epoch 37, minibatch 400/400, test error of best model 6.200000 %
epoch 38, minibatch 400/400, validation error 15.800000 %
epoch 39, minibatch 400/400, validation error 15.800000 %
epoch 40, minibatch 400/400, validation error 16.000000 %
epoch 41, minibatch 400/400, validation error 16.000000 %
epoch 42, minibatch 400/400, validation error 16.000000 %
epoch 43, minibatch 400/400, validation error 16.000000 %
epoch 44, minibatch 400/400, validation error 16.000000 %
epoch 45, minibatch 400/400, validation error 16.000000 %
epoch 46, minibatch 400/400, validation error 15.800000 %
epoch 47, minibatch 400/400, validation error 15.800000 %
epoch 48, minibatch 400/400, validation error 15.800000 %
epoch 49, minibatch 400/400, validation error 15.800000 %
epoch 50, minibatch 400/400, validation error 15.800000 %
epoch 51, minibatch 400/400, validation error 15.800000 %
epoch 52, minibatch 400/400, validation error 15.800000 %
epoch 53, minibatch 400/400, validation error 15.800000 %
epoch 54, minibatch 400/400, validation error 15.800000 %
epoch 55, minibatch 400/400, validation error 15.800000 %
epoch 56, minibatch 400/400, validation error 15.800000 %
epoch 57, minibatch 400/400, validation error 15.600000 %
     epoch 57, minibatch 400/400, test error of best model 5.800000 %
epoch 58, minibatch 400/400, validation error 15.800000 %
epoch 59, minibatch 400/400, validation error 15.800000 %
epoch 60, minibatch 400/400, validation error 15.800000 %
epoch 61, minibatch 400/400, validation error 15.800000 %
epoch 62, minibatch 400/400, validation error 15.800000 %
epoch 63, minibatch 400/400, validation error 15.800000 %
epoch 64, minibatch 400/400, validation error 15.800000 %
epoch 65, minibatch 400/400, validation error 15.800000 %
epoch 66, minibatch 400/400, validation error 15.800000 %
epoch 67, minibatch 400/400, validation error 15.800000 %
epoch 68, minibatch 400/400, validation error 15.800000 %
epoch 69, minibatch 400/400, validation error 15.800000 %
epoch 70, minibatch 400/400, validation error 15.800000 %
epoch 71, minibatch 400/400, validation error 15.800000 %
epoch 72, minibatch 400/400, validation error 15.800000 %
epoch 73, minibatch 400/400, validation error 15.800000 %
epoch 74, minibatch 400/400, validation error 15.800000 %
epoch 75, minibatch 400/400, validation error 15.800000 %
epoch 76, minibatch 400/400, validation error 15.800000 %
epoch 77, minibatch 400/400, validation error 15.800000 %
epoch 78, minibatch 400/400, validation error 15.800000 %
epoch 79, minibatch 400/400, validation error 15.800000 %
epoch 80, minibatch 400/400, validation error 15.800000 %
epoch 81, minibatch 400/400, validation error 15.800000 %
epoch 82, minibatch 400/400, validation error 15.800000 %
epoch 83, minibatch 400/400, validation error 15.800000 %
epoch 84, minibatch 400/400, validation error 15.800000 %
epoch 85, minibatch 400/400, validation error 15.800000 %
epoch 86, minibatch 400/400, validation error 15.800000 %
epoch 87, minibatch 400/400, validation error 15.800000 %
epoch 88, minibatch 400/400, validation error 15.800000 %
epoch 89, minibatch 400/400, validation error 15.800000 %
epoch 90, minibatch 400/400, validation error 15.800000 %
epoch 91, minibatch 400/400, validation error 15.800000 %
epoch 92, minibatch 400/400, validation error 15.800000 %
epoch 93, minibatch 400/400, validation error 15.800000 %
epoch 94, minibatch 400/400, validation error 15.800000 %
epoch 95, minibatch 400/400, validation error 15.800000 %
epoch 96, minibatch 400/400, validation error 15.800000 %
epoch 97, minibatch 400/400, validation error 15.800000 %
epoch 98, minibatch 400/400, validation error 15.800000 %
epoch 99, minibatch 400/400, validation error 15.800000 %
epoch 100, minibatch 400/400, validation error 15.800000 %
epoch 101, minibatch 400/400, validation error 15.800000 %
epoch 102, minibatch 400/400, validation error 15.800000 %
epoch 103, minibatch 400/400, validation error 15.800000 %
epoch 104, minibatch 400/400, validation error 15.600000 %
epoch 105, minibatch 400/400, validation error 15.600000 %
epoch 106, minibatch 400/400, validation error 15.600000 %
epoch 107, minibatch 400/400, validation error 15.600000 %
epoch 108, minibatch 400/400, validation error 15.600000 %
epoch 109, minibatch 400/400, validation error 15.600000 %
epoch 110, minibatch 400/400, validation error 15.600000 %
epoch 111, minibatch 400/400, validation error 15.600000 %
epoch 112, minibatch 400/400, validation error 15.600000 %
epoch 113, minibatch 400/400, validation error 15.600000 %
Optimization complete with best validation score of 15.600000 %, obtained at iteration 22800, with test performance 5.800000 %
The fine tuning code for file dbn_loop.pyc ran for 3.67m


==========Sample: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.625813538
Pre-training layer 0, epoch 0, representative training free energy -548.843051086
Pre-training layer 0, epoch 0, validation free energy -542.605664917
Pre-training layer 0, epoch 1, cost -108.898039078
Pre-training layer 0, epoch 2, cost -101.045064499
Pre-training layer 0, epoch 3, cost -96.4472005157
Pre-training layer 0, epoch 4, cost -93.4588444977
Pre-training layer 0, epoch 5, cost -91.2783262024
Pre-training layer 0, epoch 5, representative training free energy -489.927676025
Pre-training layer 0, epoch 5, validation free energy -483.094991089
Pre-training layer 0, epoch 6, cost -89.6720726776
Pre-training layer 0, epoch 7, cost -88.2156785736
Pre-training layer 0, epoch 8, cost -87.1654131241
Pre-training layer 0, epoch 9, cost -86.1680823059
Pre-training layer 0, epoch 10, cost -85.3714910278
Pre-training layer 0, epoch 10, representative training free energy -468.429861389
Pre-training layer 0, epoch 10, validation free energy -461.183222412
Pre-training layer 0, epoch 11, cost -84.6765776443
Pre-training layer 0, epoch 12, cost -83.9344066086
Pre-training layer 0, epoch 13, cost -83.3185382309
Pre-training layer 0, epoch 14, cost -82.839119606
Pre-training layer 0, epoch 15, cost -82.3413721771
Pre-training layer 0, epoch 15, representative training free energy -459.225549927
Pre-training layer 0, epoch 15, validation free energy -451.307687683
Pre-training layer 0, epoch 16, cost -81.9359560623
Pre-training layer 0, epoch 17, cost -81.4902383041
Pre-training layer 0, epoch 18, cost -81.3075380173
Pre-training layer 0, epoch 19, cost -80.9196020355
Pre-training layer 0, epoch 20, cost -80.4547416
Pre-training layer 0, epoch 20, representative training free energy -450.539670288
Pre-training layer 0, epoch 20, validation free energy -442.211097229
Pre-training layer 0, epoch 21, cost -80.2459789581
Pre-training layer 0, epoch 22, cost -79.9400113449
Pre-training layer 0, epoch 23, cost -79.6237255325
Pre-training layer 0, epoch 24, cost -79.4378205719
Pre-training layer 0, epoch 25, cost -79.1988572311
Pre-training layer 0, epoch 25, representative training free energy -444.845895813
Pre-training layer 0, epoch 25, validation free energy -436.51503894
Pre-training layer 0, epoch 26, cost -79.1066505737
Pre-training layer 0, epoch 27, cost -78.769527977
Pre-training layer 0, epoch 28, cost -78.5722580032
Pre-training layer 0, epoch 29, cost -78.3245917282
Pre-training layer 0, epoch 30, cost -78.2706018524
Pre-training layer 0, epoch 30, representative training free energy -443.441954102
Pre-training layer 0, epoch 30, validation free energy -434.778524658
Pre-training layer 0, epoch 31, cost -78.0775727768
Pre-training layer 0, epoch 32, cost -77.8036864853
Pre-training layer 0, epoch 33, cost -77.5837741623
Pre-training layer 0, epoch 34, cost -77.4887454987
Pre-training layer 0, epoch 35, cost -77.384282547
Pre-training layer 0, epoch 35, representative training free energy -436.841673889
Pre-training layer 0, epoch 35, validation free energy -428.194383972
Pre-training layer 0, epoch 36, cost -77.2674585571
Pre-training layer 0, epoch 37, cost -77.1817561493
Pre-training layer 0, epoch 38, cost -76.8991706696
Pre-training layer 0, epoch 39, cost -76.9385833206
Pre-training layer 0, epoch 40, cost -76.6093009949
Pre-training layer 0, epoch 40, representative training free energy -438.74129126
Pre-training layer 0, epoch 40, validation free energy -430.04316626
Pre-training layer 0, epoch 41, cost -76.6554262772
Pre-training layer 0, epoch 42, cost -76.4937008362
Pre-training layer 0, epoch 43, cost -76.3818457031
Pre-training layer 0, epoch 44, cost -76.251154747
Pre-training layer 0, epoch 45, cost -76.0967545319
Pre-training layer 0, epoch 45, representative training free energy -436.044038879
Pre-training layer 0, epoch 45, validation free energy -426.332847839
Pre-training layer 0, epoch 46, cost -76.0754325333
Pre-training layer 0, epoch 47, cost -75.9207229538
Pre-training layer 0, epoch 48, cost -75.8943604736
Pre-training layer 0, epoch 49, cost -75.7945676804
Pre-training layer 0, epoch 50, cost -75.6001441879
Pre-training layer 0, epoch 50, representative training free energy -434.372611572
Pre-training layer 0, epoch 50, validation free energy -425.340884644
Pre-training layer 0, epoch 51, cost -75.4864072189
Pre-training layer 0, epoch 52, cost -75.3811278076
Pre-training layer 0, epoch 53, cost -75.3490566559
Pre-training layer 0, epoch 54, cost -75.2703840408
Pre-training layer 0, epoch 55, cost -75.2064579163
Pre-training layer 0, epoch 55, representative training free energy -431.610371948
Pre-training layer 0, epoch 55, validation free energy -422.427418274
Pre-training layer 0, epoch 56, cost -75.0966761017
Pre-training layer 0, epoch 57, cost -75.162346283
Pre-training layer 0, epoch 58, cost -74.9355556412
Pre-training layer 0, epoch 59, cost -74.8908044739
Pre-training layer 0, epoch 60, cost -74.8443342438
Pre-training layer 0, epoch 60, representative training free energy -430.828220276
Pre-training layer 0, epoch 60, validation free energy -421.343879944
Pre-training layer 0, epoch 61, cost -74.6225900955
Pre-training layer 0, epoch 62, cost -74.4968561783
Pre-training layer 0, epoch 63, cost -74.6464341049
Pre-training layer 0, epoch 64, cost -74.5402534637
Pre-training layer 0, epoch 65, cost -74.5219577637
Pre-training layer 0, epoch 65, representative training free energy -429.127537903
Pre-training layer 0, epoch 65, validation free energy -419.916872131
Pre-training layer 0, epoch 66, cost -74.3872280579
Pre-training layer 0, epoch 67, cost -74.2921078339
Pre-training layer 0, epoch 68, cost -74.2455026932
Pre-training layer 0, epoch 69, cost -74.2062945099
Pre-training layer 0, epoch 70, cost -74.1855931168
Pre-training layer 0, epoch 70, representative training free energy -426.856943542
Pre-training layer 0, epoch 70, validation free energy -417.261146729
Pre-training layer 0, epoch 71, cost -74.0979528503
Pre-training layer 0, epoch 72, cost -73.9813553009
Pre-training layer 0, epoch 73, cost -74.0123462219
Pre-training layer 0, epoch 74, cost -73.8385305939
Pre-training layer 0, epoch 75, cost -73.8112427139
Pre-training layer 0, epoch 75, representative training free energy -426.344661377
Pre-training layer 0, epoch 75, validation free energy -416.208196045
Pre-training layer 0, epoch 76, cost -73.8118961334
Pre-training layer 0, epoch 77, cost -73.6400451355
Pre-training layer 0, epoch 78, cost -73.6126511307
Pre-training layer 0, epoch 79, cost -73.5686435623
Pre-training layer 0, epoch 80, cost -73.6128084793
Pre-training layer 0, epoch 80, representative training free energy -426.028943726
Pre-training layer 0, epoch 80, validation free energy -416.064441467
Pre-training layer 0, epoch 81, cost -73.5595619583
Pre-training layer 0, epoch 82, cost -73.4348274918
Pre-training layer 0, epoch 83, cost -73.4414433594
Pre-training layer 0, epoch 84, cost -73.3236654739
Pre-training layer 0, epoch 85, cost -73.3461150589
Pre-training layer 0, epoch 85, representative training free energy -427.449877502
Pre-training layer 0, epoch 85, validation free energy -417.463393616
Pre-training layer 0, epoch 86, cost -73.2414154892
Pre-training layer 0, epoch 87, cost -73.1261147385
Pre-training layer 0, epoch 88, cost -73.1995399857
Pre-training layer 0, epoch 89, cost -72.9909179611
Pre-training layer 0, epoch 90, cost -73.1079574127
Pre-training layer 0, epoch 90, representative training free energy -425.169699097
Pre-training layer 0, epoch 90, validation free energy -415.077841492
Pre-training layer 0, epoch 91, cost -73.0053513641
Pre-training layer 0, epoch 92, cost -73.0057461395
Pre-training layer 0, epoch 93, cost -72.924294426
Pre-training layer 0, epoch 94, cost -72.9001634598
Pre-training layer 0, epoch 95, cost -72.8816054611
Pre-training layer 0, epoch 95, representative training free energy -421.091570251
Pre-training layer 0, epoch 95, validation free energy -411.062541809
Pre-training layer 0, epoch 96, cost -72.790757637
Pre-training layer 0, epoch 97, cost -72.6408294373
Pre-training layer 0, epoch 98, cost -72.73615065
Pre-training layer 0, epoch 99, cost -72.7013567352
Pre-training layer 1, epoch 0, cost -311.553604889
Pre-training layer 1, epoch 0, representative training free energy -60838.5290742
Pre-training layer 1, epoch 0, validation free energy -60290.3673516
Pre-training layer 1, epoch 1, cost -267.250258545
Pre-training layer 1, epoch 2, cost -253.867634033
Pre-training layer 1, epoch 3, cost -246.18218573
Pre-training layer 1, epoch 4, cost -240.906755707
Pre-training layer 1, epoch 5, cost -237.218797943
Pre-training layer 1, epoch 5, representative training free energy -80870.7174727
Pre-training layer 1, epoch 5, validation free energy -80129.1683711
Pre-training layer 1, epoch 6, cost -234.255479187
Pre-training layer 1, epoch 7, cost -232.00462326
Pre-training layer 1, epoch 8, cost -230.004008118
Pre-training layer 1, epoch 9, cost -228.516676392
Pre-training layer 1, epoch 10, cost -226.989092285
Pre-training layer 1, epoch 10, representative training free energy -87047.0283984
Pre-training layer 1, epoch 10, validation free energy -86239.5525938
Pre-training layer 1, epoch 11, cost -225.817215179
Pre-training layer 1, epoch 12, cost -224.734951569
Pre-training layer 1, epoch 13, cost -223.798935547
Pre-training layer 1, epoch 14, cost -223.111126556
Pre-training layer 1, epoch 15, cost -222.323206421
Pre-training layer 1, epoch 15, representative training free energy -90750.9822539
Pre-training layer 1, epoch 15, validation free energy -89909.7824023
Pre-training layer 1, epoch 16, cost -221.715716705
Pre-training layer 1, epoch 17, cost -221.07734024
Pre-training layer 1, epoch 18, cost -220.424523682
Pre-training layer 1, epoch 19, cost -220.026369568
Pre-training layer 1, epoch 20, cost -219.532792328
Pre-training layer 1, epoch 20, representative training free energy -93403.1014492
Pre-training layer 1, epoch 20, validation free energy -92533.9242305
Pre-training layer 1, epoch 21, cost -219.003378143
Pre-training layer 1, epoch 22, cost -218.708909149
Pre-training layer 1, epoch 23, cost -218.366966309
Pre-training layer 1, epoch 24, cost -217.897947327
Pre-training layer 1, epoch 25, cost -217.581307953
Pre-training layer 1, epoch 25, representative training free energy -95431.7894844
Pre-training layer 1, epoch 25, validation free energy -94541.4453555
Pre-training layer 1, epoch 26, cost -217.343590149
Pre-training layer 1, epoch 27, cost -216.944321289
Pre-training layer 1, epoch 28, cost -216.747872467
Pre-training layer 1, epoch 29, cost -216.392612823
Pre-training layer 1, epoch 30, cost -216.22906076
Pre-training layer 1, epoch 30, representative training free energy -97293.2291172
Pre-training layer 1, epoch 30, validation free energy -96392.4903867
Pre-training layer 1, epoch 31, cost -215.972209167
Pre-training layer 1, epoch 32, cost -215.737365753
Pre-training layer 1, epoch 33, cost -215.483694946
Pre-training layer 1, epoch 34, cost -215.29901474
Pre-training layer 1, epoch 35, cost -215.061833588
Pre-training layer 1, epoch 35, representative training free energy -98785.5117031
Pre-training layer 1, epoch 35, validation free energy -97869.5097266
Pre-training layer 1, epoch 36, cost -214.80197998
Pre-training layer 1, epoch 37, cost -214.638892181
Pre-training layer 1, epoch 38, cost -214.392433105
Pre-training layer 1, epoch 39, cost -214.26750174
Pre-training layer 1, epoch 40, cost -214.030689972
Pre-training layer 1, epoch 40, representative training free energy -100011.774344
Pre-training layer 1, epoch 40, validation free energy -99081.3359766
Pre-training layer 1, epoch 41, cost -213.973210632
Pre-training layer 1, epoch 42, cost -213.773495178
Pre-training layer 1, epoch 43, cost -213.569534973
Pre-training layer 1, epoch 44, cost -213.50967807
Pre-training layer 1, epoch 45, cost -213.298213074
Pre-training layer 1, epoch 45, representative training free energy -101163.369539
Pre-training layer 1, epoch 45, validation free energy -100229.516023
Pre-training layer 1, epoch 46, cost -213.111337646
Pre-training layer 1, epoch 47, cost -213.02834964
Pre-training layer 1, epoch 48, cost -212.887717926
Pre-training layer 1, epoch 49, cost -212.699850494
Pre-training layer 1, epoch 50, cost -212.699859924
Pre-training layer 1, epoch 50, representative training free energy -102259.771758
Pre-training layer 1, epoch 50, validation free energy -101306.895328
Pre-training layer 1, epoch 51, cost -212.485066071
Pre-training layer 1, epoch 52, cost -212.33731955
Pre-training layer 1, epoch 53, cost -212.280956024
Pre-training layer 1, epoch 54, cost -212.075633728
Pre-training layer 1, epoch 55, cost -212.139773224
Pre-training layer 1, epoch 55, representative training free energy -103171.152102
Pre-training layer 1, epoch 55, validation free energy -102218.895141
Pre-training layer 1, epoch 56, cost -211.978568146
Pre-training layer 1, epoch 57, cost -211.911928345
Pre-training layer 1, epoch 58, cost -211.749625671
Pre-training layer 1, epoch 59, cost -211.624719238
Pre-training layer 1, epoch 60, cost -211.477987793
Pre-training layer 1, epoch 60, representative training free energy -104097.67557
Pre-training layer 1, epoch 60, validation free energy -103136.998133
Pre-training layer 1, epoch 61, cost -211.505113556
Pre-training layer 1, epoch 62, cost -211.406883087
Pre-training layer 1, epoch 63, cost -211.215383057
Pre-training layer 1, epoch 64, cost -211.239694763
Pre-training layer 1, epoch 65, cost -211.176242706
Pre-training layer 1, epoch 65, representative training free energy -104990.436039
Pre-training layer 1, epoch 65, validation free energy -104018.100187
Pre-training layer 1, epoch 66, cost -210.981695343
Pre-training layer 1, epoch 67, cost -210.923161804
Pre-training layer 1, epoch 68, cost -210.898732269
Pre-training layer 1, epoch 69, cost -210.870496674
Pre-training layer 1, epoch 70, cost -210.700183136
Pre-training layer 1, epoch 70, representative training free energy -105793.428687
Pre-training layer 1, epoch 70, validation free energy -104811.753375
Pre-training layer 1, epoch 71, cost -210.735061554
Pre-training layer 1, epoch 72, cost -210.579323212
Pre-training layer 1, epoch 73, cost -210.570102386
Pre-training layer 1, epoch 74, cost -210.414243408
Pre-training layer 1, epoch 75, cost -210.427880524
Pre-training layer 1, epoch 75, representative training free energy -106497.756437
Pre-training layer 1, epoch 75, validation free energy -105509.949148
Pre-training layer 1, epoch 76, cost -210.35419931
Pre-training layer 1, epoch 77, cost -210.162716034
Pre-training layer 1, epoch 78, cost -210.183774445
Pre-training layer 1, epoch 79, cost -210.107826294
Pre-training layer 1, epoch 80, cost -210.082495422
Pre-training layer 1, epoch 80, representative training free energy -107174.183688
Pre-training layer 1, epoch 80, validation free energy -106177.484867
Pre-training layer 1, epoch 81, cost -209.998144836
Pre-training layer 1, epoch 82, cost -210.046026184
Pre-training layer 1, epoch 83, cost -209.888988159
Pre-training layer 1, epoch 84, cost -209.85672757
Pre-training layer 1, epoch 85, cost -209.878808105
Pre-training layer 1, epoch 85, representative training free energy -107788.526977
Pre-training layer 1, epoch 85, validation free energy -106790.041391
Pre-training layer 1, epoch 86, cost -209.760824982
Pre-training layer 1, epoch 87, cost -209.642420624
Pre-training layer 1, epoch 88, cost -209.626504333
Pre-training layer 1, epoch 89, cost -209.601227081
Pre-training layer 1, epoch 90, cost -209.546394257
Pre-training layer 1, epoch 90, representative training free energy -108528.666234
Pre-training layer 1, epoch 90, validation free energy -107520.598133
Pre-training layer 1, epoch 91, cost -209.464383209
Pre-training layer 1, epoch 92, cost -209.43451886
Pre-training layer 1, epoch 93, cost -209.281808228
Pre-training layer 1, epoch 94, cost -209.319457794
Pre-training layer 1, epoch 95, cost -209.263156281
Pre-training layer 1, epoch 95, representative training free energy -109093.781469
Pre-training layer 1, epoch 95, validation free energy -108077.073813
Pre-training layer 1, epoch 96, cost -209.131937347
Pre-training layer 1, epoch 97, cost -209.185411377
Pre-training layer 1, epoch 98, cost -209.12249411
Pre-training layer 1, epoch 99, cost -209.090244659
Pre-training layer 2, epoch 0, cost -113.48783107
Pre-training layer 2, epoch 0, representative training free energy 3686.57635583
Pre-training layer 2, epoch 0, validation free energy 3663.03906238
Pre-training layer 2, epoch 1, cost -85.6041007614
Pre-training layer 2, epoch 2, cost -79.309824791
Pre-training layer 2, epoch 3, cost -75.708902092
Pre-training layer 2, epoch 4, cost -73.5758791122
Pre-training layer 2, epoch 5, cost -71.8249435501
Pre-training layer 2, epoch 5, representative training free energy 6260.26099414
Pre-training layer 2, epoch 5, validation free energy 6203.45722485
Pre-training layer 2, epoch 6, cost -70.5107416687
Pre-training layer 2, epoch 7, cost -69.5029148941
Pre-training layer 2, epoch 8, cost -68.5949821243
Pre-training layer 2, epoch 9, cost -67.9527889175
Pre-training layer 2, epoch 10, cost -67.1981486359
Pre-training layer 2, epoch 10, representative training free energy 7603.45265186
Pre-training layer 2, epoch 10, validation free energy 7530.71286816
Pre-training layer 2, epoch 11, cost -66.7118771362
Pre-training layer 2, epoch 12, cost -66.2245278091
Pre-training layer 2, epoch 13, cost -65.7808546143
Pre-training layer 2, epoch 14, cost -65.4334568176
Pre-training layer 2, epoch 15, cost -65.140304306
Pre-training layer 2, epoch 15, representative training free energy 8583.54739355
Pre-training layer 2, epoch 15, validation free energy 8499.43991943
Pre-training layer 2, epoch 16, cost -64.8469562607
Pre-training layer 2, epoch 17, cost -64.6333783875
Pre-training layer 2, epoch 18, cost -64.2921403885
Pre-training layer 2, epoch 19, cost -64.0502865982
Pre-training layer 2, epoch 20, cost -63.8972656403
Pre-training layer 2, epoch 20, representative training free energy 9359.97706836
Pre-training layer 2, epoch 20, validation free energy 9267.56496875
Pre-training layer 2, epoch 21, cost -63.6566191711
Pre-training layer 2, epoch 22, cost -63.4540082397
Pre-training layer 2, epoch 23, cost -63.2381599121
Pre-training layer 2, epoch 24, cost -63.1439043427
Pre-training layer 2, epoch 25, cost -63.035167511
Pre-training layer 2, epoch 25, representative training free energy 10043.3549883
Pre-training layer 2, epoch 25, validation free energy 9945.41587305
Pre-training layer 2, epoch 26, cost -62.848190155
Pre-training layer 2, epoch 27, cost -62.782186142
Pre-training layer 2, epoch 28, cost -62.6252013245
Pre-training layer 2, epoch 29, cost -62.4398925323
Pre-training layer 2, epoch 30, cost -62.3802148056
Pre-training layer 2, epoch 30, representative training free energy 10620.4855073
Pre-training layer 2, epoch 30, validation free energy 10518.5650146
Pre-training layer 2, epoch 31, cost -62.2970683289
Pre-training layer 2, epoch 32, cost -62.2292254333
Pre-training layer 2, epoch 33, cost -62.0531349564
Pre-training layer 2, epoch 34, cost -61.9438558502
Pre-training layer 2, epoch 35, cost -61.8714156113
Pre-training layer 2, epoch 35, representative training free energy 11150.9291318
Pre-training layer 2, epoch 35, validation free energy 11042.744374
Pre-training layer 2, epoch 36, cost -61.8010687561
Pre-training layer 2, epoch 37, cost -61.6517523117
Pre-training layer 2, epoch 38, cost -61.6485527802
Pre-training layer 2, epoch 39, cost -61.525569191
Pre-training layer 2, epoch 40, cost -61.554305275
Pre-training layer 2, epoch 40, representative training free energy 11623.0751396
Pre-training layer 2, epoch 40, validation free energy 11511.2849463
Pre-training layer 2, epoch 41, cost -61.4487543411
Pre-training layer 2, epoch 42, cost -61.3374336243
Pre-training layer 2, epoch 43, cost -61.2541962204
Pre-training layer 2, epoch 44, cost -61.2362933884
Pre-training layer 2, epoch 45, cost -61.2006996765
Pre-training layer 2, epoch 45, representative training free energy 12084.9928135
Pre-training layer 2, epoch 45, validation free energy 11969.0885742
Pre-training layer 2, epoch 46, cost -61.0736856842
Pre-training layer 2, epoch 47, cost -61.0237047806
Pre-training layer 2, epoch 48, cost -60.9700082703
Pre-training layer 2, epoch 49, cost -60.9617402267
Pre-training layer 2, epoch 50, cost -60.8763014832
Pre-training layer 2, epoch 50, representative training free energy 12540.3048389
Pre-training layer 2, epoch 50, validation free energy 12419.7529668
Pre-training layer 2, epoch 51, cost -60.823524292
Pre-training layer 2, epoch 52, cost -60.8011468277
Pre-training layer 2, epoch 53, cost -60.763709938
Pre-training layer 2, epoch 54, cost -60.7797937241
Pre-training layer 2, epoch 55, cost -60.6921186676
Pre-training layer 2, epoch 55, representative training free energy 12912.7097422
Pre-training layer 2, epoch 55, validation free energy 12787.6566582
Pre-training layer 2, epoch 56, cost -60.5489599609
Pre-training layer 2, epoch 57, cost -60.5787563629
Pre-training layer 2, epoch 58, cost -60.524850975
Pre-training layer 2, epoch 59, cost -60.4876356888
Pre-training layer 2, epoch 60, cost -60.4602635193
Pre-training layer 2, epoch 60, representative training free energy 13313.1846709
Pre-training layer 2, epoch 60, validation free energy 13186.3741846
Pre-training layer 2, epoch 61, cost -60.4727681656
Pre-training layer 2, epoch 62, cost -60.3830755386
Pre-training layer 2, epoch 63, cost -60.2783423615
Pre-training layer 2, epoch 64, cost -60.3620394287
Pre-training layer 2, epoch 65, cost -60.300017807
Pre-training layer 2, epoch 65, representative training free energy 13659.1559736
Pre-training layer 2, epoch 65, validation free energy 13529.2961611
Pre-training layer 2, epoch 66, cost -60.2667670517
Pre-training layer 2, epoch 67, cost -60.2343845978
Pre-training layer 2, epoch 68, cost -60.1969333267
Pre-training layer 2, epoch 69, cost -60.1811706467
Pre-training layer 2, epoch 70, cost -60.1939848404
Pre-training layer 2, epoch 70, representative training free energy 14058.7615225
Pre-training layer 2, epoch 70, validation free energy 13924.8932432
Pre-training layer 2, epoch 71, cost -60.0381792145
Pre-training layer 2, epoch 72, cost -60.0163640594
Pre-training layer 2, epoch 73, cost -60.1136353073
Pre-training layer 2, epoch 74, cost -60.0030419464
Pre-training layer 2, epoch 75, cost -59.9866164246
Pre-training layer 2, epoch 75, representative training free energy 14395.8110742
Pre-training layer 2, epoch 75, validation free energy 14258.310373
Pre-training layer 2, epoch 76, cost -60.0017011948
Pre-training layer 2, epoch 77, cost -59.9143074112
Pre-training layer 2, epoch 78, cost -59.9400352707
Pre-training layer 2, epoch 79, cost -59.9257828217
Pre-training layer 2, epoch 80, cost -59.8718931122
Pre-training layer 2, epoch 80, representative training free energy 14753.8424414
Pre-training layer 2, epoch 80, validation free energy 14611.5738799
Pre-training layer 2, epoch 81, cost -59.7517134094
Pre-training layer 2, epoch 82, cost -59.8067495956
Pre-training layer 2, epoch 83, cost -59.8063086166
Pre-training layer 2, epoch 84, cost -59.741785202
Pre-training layer 2, epoch 85, cost -59.7575477448
Pre-training layer 2, epoch 85, representative training free energy 15068.8107021
Pre-training layer 2, epoch 85, validation free energy 14924.4908936
Pre-training layer 2, epoch 86, cost -59.7336873245
Pre-training layer 2, epoch 87, cost -59.6556937408
Pre-training layer 2, epoch 88, cost -59.6835251999
Pre-training layer 2, epoch 89, cost -59.6685946045
Pre-training layer 2, epoch 90, cost -59.6667330704
Pre-training layer 2, epoch 90, representative training free energy 15409.975623
Pre-training layer 2, epoch 90, validation free energy 15260.6577695
Pre-training layer 2, epoch 91, cost -59.575209816
Pre-training layer 2, epoch 92, cost -59.6283517151
Pre-training layer 2, epoch 93, cost -59.5334464035
Pre-training layer 2, epoch 94, cost -59.5334459305
Pre-training layer 2, epoch 95, cost -59.5386019897
Pre-training layer 2, epoch 95, representative training free energy 15695.1047754
Pre-training layer 2, epoch 95, validation free energy 15543.3014434
Pre-training layer 2, epoch 96, cost -59.5247972488
Pre-training layer 2, epoch 97, cost -59.5040520096
Pre-training layer 2, epoch 98, cost -59.4589278946
Pre-training layer 2, epoch 99, cost -59.4403296051
The pretraining code for file dbn_loop.pyc ran for 13.06m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 33.600000 %
     epoch 1, minibatch 500/500, test error of best model 29.000000 %
epoch 2, minibatch 500/500, validation error 26.200000 %
     epoch 2, minibatch 500/500, test error of best model 16.800000 %
epoch 3, minibatch 500/500, validation error 23.000000 %
     epoch 3, minibatch 500/500, test error of best model 14.400000 %
epoch 4, minibatch 500/500, validation error 21.400000 %
     epoch 4, minibatch 500/500, test error of best model 12.200000 %
epoch 5, minibatch 500/500, validation error 20.400000 %
     epoch 5, minibatch 500/500, test error of best model 10.800000 %
epoch 6, minibatch 500/500, validation error 19.800000 %
     epoch 6, minibatch 500/500, test error of best model 10.000000 %
epoch 7, minibatch 500/500, validation error 19.400000 %
     epoch 7, minibatch 500/500, test error of best model 8.600000 %
epoch 8, minibatch 500/500, validation error 18.600000 %
     epoch 8, minibatch 500/500, test error of best model 7.600000 %
epoch 9, minibatch 500/500, validation error 18.200000 %
     epoch 9, minibatch 500/500, test error of best model 7.200000 %
epoch 10, minibatch 500/500, validation error 17.400000 %
     epoch 10, minibatch 500/500, test error of best model 6.800000 %
epoch 11, minibatch 500/500, validation error 17.200000 %
     epoch 11, minibatch 500/500, test error of best model 6.800000 %
epoch 12, minibatch 500/500, validation error 17.200000 %
epoch 13, minibatch 500/500, validation error 17.400000 %
epoch 14, minibatch 500/500, validation error 17.200000 %
epoch 15, minibatch 500/500, validation error 17.200000 %
epoch 16, minibatch 500/500, validation error 17.200000 %
epoch 17, minibatch 500/500, validation error 17.200000 %
epoch 18, minibatch 500/500, validation error 17.200000 %
epoch 19, minibatch 500/500, validation error 17.000000 %
     epoch 19, minibatch 500/500, test error of best model 5.000000 %
epoch 20, minibatch 500/500, validation error 17.000000 %
epoch 21, minibatch 500/500, validation error 17.000000 %
epoch 22, minibatch 500/500, validation error 16.800000 %
     epoch 22, minibatch 500/500, test error of best model 5.000000 %
epoch 23, minibatch 500/500, validation error 16.600000 %
     epoch 23, minibatch 500/500, test error of best model 4.800000 %
epoch 24, minibatch 500/500, validation error 16.400000 %
     epoch 24, minibatch 500/500, test error of best model 4.800000 %
epoch 25, minibatch 500/500, validation error 16.200000 %
     epoch 25, minibatch 500/500, test error of best model 5.000000 %
epoch 26, minibatch 500/500, validation error 16.000000 %
     epoch 26, minibatch 500/500, test error of best model 5.000000 %
epoch 27, minibatch 500/500, validation error 16.000000 %
epoch 28, minibatch 500/500, validation error 16.000000 %
epoch 29, minibatch 500/500, validation error 16.000000 %
epoch 30, minibatch 500/500, validation error 16.200000 %
epoch 31, minibatch 500/500, validation error 16.200000 %
epoch 32, minibatch 500/500, validation error 16.200000 %
epoch 33, minibatch 500/500, validation error 16.200000 %
epoch 34, minibatch 500/500, validation error 16.000000 %
epoch 35, minibatch 500/500, validation error 15.600000 %
     epoch 35, minibatch 500/500, test error of best model 5.200000 %
epoch 36, minibatch 500/500, validation error 15.600000 %
epoch 37, minibatch 500/500, validation error 15.600000 %
epoch 38, minibatch 500/500, validation error 15.600000 %
epoch 39, minibatch 500/500, validation error 15.600000 %
epoch 40, minibatch 500/500, validation error 15.200000 %
     epoch 40, minibatch 500/500, test error of best model 5.600000 %
epoch 41, minibatch 500/500, validation error 15.200000 %
epoch 42, minibatch 500/500, validation error 15.000000 %
     epoch 42, minibatch 500/500, test error of best model 5.600000 %
epoch 43, minibatch 500/500, validation error 15.000000 %
epoch 44, minibatch 500/500, validation error 15.000000 %
epoch 45, minibatch 500/500, validation error 15.000000 %
epoch 46, minibatch 500/500, validation error 15.000000 %
epoch 47, minibatch 500/500, validation error 15.000000 %
epoch 48, minibatch 500/500, validation error 15.000000 %
epoch 49, minibatch 500/500, validation error 15.000000 %
epoch 50, minibatch 500/500, validation error 15.000000 %
epoch 51, minibatch 500/500, validation error 15.000000 %
epoch 52, minibatch 500/500, validation error 15.000000 %
epoch 53, minibatch 500/500, validation error 15.000000 %
epoch 54, minibatch 500/500, validation error 15.000000 %
epoch 55, minibatch 500/500, validation error 15.000000 %
epoch 56, minibatch 500/500, validation error 15.000000 %
epoch 57, minibatch 500/500, validation error 15.000000 %
epoch 58, minibatch 500/500, validation error 15.000000 %
epoch 59, minibatch 500/500, validation error 15.000000 %
epoch 60, minibatch 500/500, validation error 15.000000 %
epoch 61, minibatch 500/500, validation error 15.000000 %
epoch 62, minibatch 500/500, validation error 15.000000 %
epoch 63, minibatch 500/500, validation error 15.000000 %
epoch 64, minibatch 500/500, validation error 15.000000 %
epoch 65, minibatch 500/500, validation error 15.000000 %
epoch 66, minibatch 500/500, validation error 15.000000 %
epoch 67, minibatch 500/500, validation error 15.000000 %
epoch 68, minibatch 500/500, validation error 15.000000 %
epoch 69, minibatch 500/500, validation error 15.000000 %
epoch 70, minibatch 500/500, validation error 15.000000 %
epoch 71, minibatch 500/500, validation error 15.000000 %
epoch 72, minibatch 500/500, validation error 15.000000 %
epoch 73, minibatch 500/500, validation error 15.000000 %
epoch 74, minibatch 500/500, validation error 15.000000 %
epoch 75, minibatch 500/500, validation error 15.000000 %
epoch 76, minibatch 500/500, validation error 15.000000 %
epoch 77, minibatch 500/500, validation error 15.000000 %
epoch 78, minibatch 500/500, validation error 15.000000 %
epoch 79, minibatch 500/500, validation error 15.000000 %
epoch 80, minibatch 500/500, validation error 15.000000 %
epoch 81, minibatch 500/500, validation error 15.000000 %
epoch 82, minibatch 500/500, validation error 15.000000 %
epoch 83, minibatch 500/500, validation error 15.000000 %
Optimization complete with best validation score of 15.000000 %, obtained at iteration 21000, with test performance 5.600000 %
The fine tuning code for file dbn_loop.pyc ran for 3.36m
_______RUN: 4

==========Sample: (1000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -183.673255615
Pre-training layer 0, epoch 0, representative training free energy -598.023296265
Pre-training layer 0, epoch 0, validation free energy -591.933406799
Pre-training layer 0, epoch 1, cost -136.706883087
Pre-training layer 0, epoch 2, cost -125.110822449
Pre-training layer 0, epoch 3, cost -117.799289932
Pre-training layer 0, epoch 4, cost -113.564666214
Pre-training layer 0, epoch 5, cost -109.636671448
Pre-training layer 0, epoch 5, representative training free energy -549.956099365
Pre-training layer 0, epoch 5, validation free energy -538.005548462
Pre-training layer 0, epoch 6, cost -107.039904556
Pre-training layer 0, epoch 7, cost -104.573673172
Pre-training layer 0, epoch 8, cost -102.822633209
Pre-training layer 0, epoch 9, cost -100.823878403
Pre-training layer 0, epoch 10, cost -99.4802866364
Pre-training layer 0, epoch 10, representative training free energy -526.052182556
Pre-training layer 0, epoch 10, validation free energy -512.646813171
Pre-training layer 0, epoch 11, cost -98.1956990051
Pre-training layer 0, epoch 12, cost -96.4640310669
Pre-training layer 0, epoch 13, cost -95.7835160828
Pre-training layer 0, epoch 14, cost -94.9362595367
Pre-training layer 0, epoch 15, cost -93.6852823639
Pre-training layer 0, epoch 15, representative training free energy -517.920068481
Pre-training layer 0, epoch 15, validation free energy -502.92964563
Pre-training layer 0, epoch 16, cost -92.8482177734
Pre-training layer 0, epoch 17, cost -92.0402902985
Pre-training layer 0, epoch 18, cost -91.1225336456
Pre-training layer 0, epoch 19, cost -90.4866597748
Pre-training layer 0, epoch 20, cost -90.3973944092
Pre-training layer 0, epoch 20, representative training free energy -509.478362488
Pre-training layer 0, epoch 20, validation free energy -493.853463867
Pre-training layer 0, epoch 21, cost -89.4619664001
Pre-training layer 0, epoch 22, cost -88.7011344147
Pre-training layer 0, epoch 23, cost -88.2965665436
Pre-training layer 0, epoch 24, cost -88.0151940918
Pre-training layer 0, epoch 25, cost -87.4001046753
Pre-training layer 0, epoch 25, representative training free energy -502.866762573
Pre-training layer 0, epoch 25, validation free energy -486.25867865
Pre-training layer 0, epoch 26, cost -86.8549226379
Pre-training layer 0, epoch 27, cost -86.4516082764
Pre-training layer 0, epoch 28, cost -85.9527516174
Pre-training layer 0, epoch 29, cost -85.3867652893
Pre-training layer 0, epoch 30, cost -85.297609024
Pre-training layer 0, epoch 30, representative training free energy -497.732237427
Pre-training layer 0, epoch 30, validation free energy -480.779407898
Pre-training layer 0, epoch 31, cost -84.8415299988
Pre-training layer 0, epoch 32, cost -84.4800630951
Pre-training layer 0, epoch 33, cost -84.3526252747
Pre-training layer 0, epoch 34, cost -83.9719260406
Pre-training layer 0, epoch 35, cost -83.299699707
Pre-training layer 0, epoch 35, representative training free energy -491.036120361
Pre-training layer 0, epoch 35, validation free energy -473.935721069
Pre-training layer 0, epoch 36, cost -83.0932449722
Pre-training layer 0, epoch 37, cost -82.9142468262
Pre-training layer 0, epoch 38, cost -83.1405117416
Pre-training layer 0, epoch 39, cost -82.4717085648
Pre-training layer 0, epoch 40, cost -82.2168556976
Pre-training layer 0, epoch 40, representative training free energy -486.191768921
Pre-training layer 0, epoch 40, validation free energy -468.73903418
Pre-training layer 0, epoch 41, cost -81.9621271515
Pre-training layer 0, epoch 42, cost -81.6326260757
Pre-training layer 0, epoch 43, cost -81.4465807343
Pre-training layer 0, epoch 44, cost -81.1924461365
Pre-training layer 0, epoch 45, cost -81.0208992004
Pre-training layer 0, epoch 45, representative training free energy -487.176356812
Pre-training layer 0, epoch 45, validation free energy -468.759279907
Pre-training layer 0, epoch 46, cost -80.7614641571
Pre-training layer 0, epoch 47, cost -80.6710385132
Pre-training layer 0, epoch 48, cost -80.2911487961
Pre-training layer 0, epoch 49, cost -80.1198722839
Pre-training layer 0, epoch 50, cost -79.9990859604
Pre-training layer 0, epoch 50, representative training free energy -483.897121826
Pre-training layer 0, epoch 50, validation free energy -465.262555725
Pre-training layer 0, epoch 51, cost -79.6656822586
Pre-training layer 0, epoch 52, cost -79.5896588135
Pre-training layer 0, epoch 53, cost -79.6099618149
Pre-training layer 0, epoch 54, cost -79.1711542511
Pre-training layer 0, epoch 55, cost -79.0891830826
Pre-training layer 0, epoch 55, representative training free energy -478.860476074
Pre-training layer 0, epoch 55, validation free energy -459.28290564
Pre-training layer 0, epoch 56, cost -79.1115936279
Pre-training layer 0, epoch 57, cost -78.8460062408
Pre-training layer 0, epoch 58, cost -78.6115414047
Pre-training layer 0, epoch 59, cost -78.4855844116
Pre-training layer 0, epoch 60, cost -78.172608757
Pre-training layer 0, epoch 60, representative training free energy -478.849640076
Pre-training layer 0, epoch 60, validation free energy -459.851978271
Pre-training layer 0, epoch 61, cost -78.4205207443
Pre-training layer 0, epoch 62, cost -78.1298600388
Pre-training layer 0, epoch 63, cost -77.8022877502
Pre-training layer 0, epoch 64, cost -77.6787791824
Pre-training layer 0, epoch 65, cost -77.2717269135
Pre-training layer 0, epoch 65, representative training free energy -480.564406128
Pre-training layer 0, epoch 65, validation free energy -460.347495422
Pre-training layer 0, epoch 66, cost -77.4554251862
Pre-training layer 0, epoch 67, cost -77.4798855972
Pre-training layer 0, epoch 68, cost -77.1625535202
Pre-training layer 0, epoch 69, cost -77.0121031189
Pre-training layer 0, epoch 70, cost -77.1542414093
Pre-training layer 0, epoch 70, representative training free energy -476.489329224
Pre-training layer 0, epoch 70, validation free energy -456.590439026
Pre-training layer 0, epoch 71, cost -76.8330160904
Pre-training layer 0, epoch 72, cost -76.7519507217
Pre-training layer 0, epoch 73, cost -76.6554824066
Pre-training layer 0, epoch 74, cost -76.4733201218
Pre-training layer 0, epoch 75, cost -76.3225880051
Pre-training layer 0, epoch 75, representative training free energy -474.644306702
Pre-training layer 0, epoch 75, validation free energy -454.14281781
Pre-training layer 0, epoch 76, cost -76.2369586563
Pre-training layer 0, epoch 77, cost -76.1848223114
Pre-training layer 0, epoch 78, cost -76.034875412
Pre-training layer 0, epoch 79, cost -76.0402674866
Pre-training layer 0, epoch 80, cost -75.6728396606
Pre-training layer 0, epoch 80, representative training free energy -475.868281799
Pre-training layer 0, epoch 80, validation free energy -454.534320801
Pre-training layer 0, epoch 81, cost -75.6061990356
Pre-training layer 0, epoch 82, cost -75.7949188232
Pre-training layer 0, epoch 83, cost -75.6364213943
Pre-training layer 0, epoch 84, cost -75.6044459534
Pre-training layer 0, epoch 85, cost -75.4639574814
Pre-training layer 0, epoch 85, representative training free energy -475.230116638
Pre-training layer 0, epoch 85, validation free energy -454.066761902
Pre-training layer 0, epoch 86, cost -75.1308137894
Pre-training layer 0, epoch 87, cost -75.2284274292
Pre-training layer 0, epoch 88, cost -75.2005979156
Pre-training layer 0, epoch 89, cost -75.1313754654
Pre-training layer 0, epoch 90, cost -74.7997383118
Pre-training layer 0, epoch 90, representative training free energy -468.817308105
Pre-training layer 0, epoch 90, validation free energy -448.225297729
Pre-training layer 0, epoch 91, cost -74.657045517
Pre-training layer 0, epoch 92, cost -74.7541786575
Pre-training layer 0, epoch 93, cost -74.5615824509
Pre-training layer 0, epoch 94, cost -74.7695370102
Pre-training layer 0, epoch 95, cost -74.7545948029
Pre-training layer 0, epoch 95, representative training free energy -467.807817139
Pre-training layer 0, epoch 95, validation free energy -446.318013245
Pre-training layer 0, epoch 96, cost -74.4126096344
Pre-training layer 0, epoch 97, cost -74.1764720535
Pre-training layer 0, epoch 98, cost -74.1953820038
Pre-training layer 0, epoch 99, cost -74.2288004684
Pre-training layer 1, epoch 0, cost -430.800872498
Pre-training layer 1, epoch 0, representative training free energy -32320.2028223
Pre-training layer 1, epoch 0, validation free energy -32005.3452578
Pre-training layer 1, epoch 1, cost -369.841581421
Pre-training layer 1, epoch 2, cost -350.125258484
Pre-training layer 1, epoch 3, cost -338.430950317
Pre-training layer 1, epoch 4, cost -329.929002686
Pre-training layer 1, epoch 5, cost -323.84787323
Pre-training layer 1, epoch 5, representative training free energy -46167.5571934
Pre-training layer 1, epoch 5, validation free energy -45811.1878574
Pre-training layer 1, epoch 6, cost -318.743359375
Pre-training layer 1, epoch 7, cost -314.863503113
Pre-training layer 1, epoch 8, cost -311.311308594
Pre-training layer 1, epoch 9, cost -308.326892395
Pre-training layer 1, epoch 10, cost -305.514638672
Pre-training layer 1, epoch 10, representative training free energy -50631.066418
Pre-training layer 1, epoch 10, validation free energy -50264.4782891
Pre-training layer 1, epoch 11, cost -303.276704407
Pre-training layer 1, epoch 12, cost -301.301705322
Pre-training layer 1, epoch 13, cost -299.482850647
Pre-training layer 1, epoch 14, cost -297.906254425
Pre-training layer 1, epoch 15, cost -296.326488953
Pre-training layer 1, epoch 15, representative training free energy -53133.6264961
Pre-training layer 1, epoch 15, validation free energy -52757.0117168
Pre-training layer 1, epoch 16, cost -294.72093399
Pre-training layer 1, epoch 17, cost -293.585030365
Pre-training layer 1, epoch 18, cost -292.159112854
Pre-training layer 1, epoch 19, cost -291.329838257
Pre-training layer 1, epoch 20, cost -290.445341339
Pre-training layer 1, epoch 20, representative training free energy -54901.2264883
Pre-training layer 1, epoch 20, validation free energy -54522.7685859
Pre-training layer 1, epoch 21, cost -289.309707794
Pre-training layer 1, epoch 22, cost -288.38382782
Pre-training layer 1, epoch 23, cost -287.544888458
Pre-training layer 1, epoch 24, cost -286.72847168
Pre-training layer 1, epoch 25, cost -286.181513672
Pre-training layer 1, epoch 25, representative training free energy -56182.9936367
Pre-training layer 1, epoch 25, validation free energy -55802.4037539
Pre-training layer 1, epoch 26, cost -285.423962402
Pre-training layer 1, epoch 27, cost -284.758296967
Pre-training layer 1, epoch 28, cost -284.15721283
Pre-training layer 1, epoch 29, cost -283.579636536
Pre-training layer 1, epoch 30, cost -282.655209198
Pre-training layer 1, epoch 30, representative training free energy -57280.0443711
Pre-training layer 1, epoch 30, validation free energy -56895.6947461
Pre-training layer 1, epoch 31, cost -282.417600098
Pre-training layer 1, epoch 32, cost -281.736534729
Pre-training layer 1, epoch 33, cost -281.363343964
Pre-training layer 1, epoch 34, cost -280.971520691
Pre-training layer 1, epoch 35, cost -280.311450195
Pre-training layer 1, epoch 35, representative training free energy -58105.2789453
Pre-training layer 1, epoch 35, validation free energy -57722.3740156
Pre-training layer 1, epoch 36, cost -280.02457489
Pre-training layer 1, epoch 37, cost -279.55479538
Pre-training layer 1, epoch 38, cost -279.015075226
Pre-training layer 1, epoch 39, cost -278.805474243
Pre-training layer 1, epoch 40, cost -278.391506042
Pre-training layer 1, epoch 40, representative training free energy -58973.7154648
Pre-training layer 1, epoch 40, validation free energy -58593.7088711
Pre-training layer 1, epoch 41, cost -278.109172363
Pre-training layer 1, epoch 42, cost -277.569082031
Pre-training layer 1, epoch 43, cost -277.433385925
Pre-training layer 1, epoch 44, cost -277.290248108
Pre-training layer 1, epoch 45, cost -276.654002991
Pre-training layer 1, epoch 45, representative training free energy -59639.9743633
Pre-training layer 1, epoch 45, validation free energy -59249.1775234
Pre-training layer 1, epoch 46, cost -276.4478862
Pre-training layer 1, epoch 47, cost -276.039514771
Pre-training layer 1, epoch 48, cost -275.835185699
Pre-training layer 1, epoch 49, cost -275.533228149
Pre-training layer 1, epoch 50, cost -275.494456787
Pre-training layer 1, epoch 50, representative training free energy -60221.232957
Pre-training layer 1, epoch 50, validation free energy -59834.592125
Pre-training layer 1, epoch 51, cost -274.969829559
Pre-training layer 1, epoch 52, cost -274.87804306
Pre-training layer 1, epoch 53, cost -274.563900146
Pre-training layer 1, epoch 54, cost -274.332867126
Pre-training layer 1, epoch 55, cost -273.925213776
Pre-training layer 1, epoch 55, representative training free energy -60839.2337109
Pre-training layer 1, epoch 55, validation free energy -60445.7352227
Pre-training layer 1, epoch 56, cost -274.04073822
Pre-training layer 1, epoch 57, cost -273.799139404
Pre-training layer 1, epoch 58, cost -273.482947388
Pre-training layer 1, epoch 59, cost -273.107507019
Pre-training layer 1, epoch 60, cost -273.158903198
Pre-training layer 1, epoch 60, representative training free energy -61188.4138516
Pre-training layer 1, epoch 60, validation free energy -60799.7669883
Pre-training layer 1, epoch 61, cost -272.779937134
Pre-training layer 1, epoch 62, cost -272.592778473
Pre-training layer 1, epoch 63, cost -272.660166168
Pre-training layer 1, epoch 64, cost -272.473058929
Pre-training layer 1, epoch 65, cost -272.168022156
Pre-training layer 1, epoch 65, representative training free energy -61711.8337148
Pre-training layer 1, epoch 65, validation free energy -61322.0227266
Pre-training layer 1, epoch 66, cost -272.036700745
Pre-training layer 1, epoch 67, cost -271.818917847
Pre-training layer 1, epoch 68, cost -271.620991211
Pre-training layer 1, epoch 69, cost -271.450061798
Pre-training layer 1, epoch 70, cost -271.278107452
Pre-training layer 1, epoch 70, representative training free energy -62113.2122969
Pre-training layer 1, epoch 70, validation free energy -61716.7567539
Pre-training layer 1, epoch 71, cost -271.379141235
Pre-training layer 1, epoch 72, cost -270.967202911
Pre-training layer 1, epoch 73, cost -270.899758911
Pre-training layer 1, epoch 74, cost -270.684472046
Pre-training layer 1, epoch 75, cost -270.468306427
Pre-training layer 1, epoch 75, representative training free energy -62511.9819297
Pre-training layer 1, epoch 75, validation free energy -62121.1668437
Pre-training layer 1, epoch 76, cost -270.611604309
Pre-training layer 1, epoch 77, cost -270.451921387
Pre-training layer 1, epoch 78, cost -270.216166687
Pre-training layer 1, epoch 79, cost -270.086083527
Pre-training layer 1, epoch 80, cost -270.204186401
Pre-training layer 1, epoch 80, representative training free energy -62911.3717813
Pre-training layer 1, epoch 80, validation free energy -62516.0998984
Pre-training layer 1, epoch 81, cost -269.847186279
Pre-training layer 1, epoch 82, cost -269.871479797
Pre-training layer 1, epoch 83, cost -269.763739471
Pre-training layer 1, epoch 84, cost -269.415664215
Pre-training layer 1, epoch 85, cost -269.354919281
Pre-training layer 1, epoch 85, representative training free energy -63302.5211367
Pre-training layer 1, epoch 85, validation free energy -62902.6695703
Pre-training layer 1, epoch 86, cost -269.208108521
Pre-training layer 1, epoch 87, cost -269.201488647
Pre-training layer 1, epoch 88, cost -269.074052734
Pre-training layer 1, epoch 89, cost -268.986331787
Pre-training layer 1, epoch 90, cost -268.915951843
Pre-training layer 1, epoch 90, representative training free energy -63644.9255117
Pre-training layer 1, epoch 90, validation free energy -63243.0721484
Pre-training layer 1, epoch 91, cost -268.861752625
Pre-training layer 1, epoch 92, cost -268.745725098
Pre-training layer 1, epoch 93, cost -268.68458374
Pre-training layer 1, epoch 94, cost -268.545201569
Pre-training layer 1, epoch 95, cost -268.343280792
Pre-training layer 1, epoch 95, representative training free energy -63886.1177969
Pre-training layer 1, epoch 95, validation free energy -63488.5378828
Pre-training layer 1, epoch 96, cost -268.360041962
Pre-training layer 1, epoch 97, cost -268.117703094
Pre-training layer 1, epoch 98, cost -268.148489075
Pre-training layer 1, epoch 99, cost -268.019516449
Pre-training layer 2, epoch 0, cost -161.964591446
Pre-training layer 2, epoch 0, representative training free energy 1710.55742761
Pre-training layer 2, epoch 0, validation free energy 1720.31574396
Pre-training layer 2, epoch 1, cost -108.04015358
Pre-training layer 2, epoch 2, cost -97.5903688049
Pre-training layer 2, epoch 3, cost -92.270238266
Pre-training layer 2, epoch 4, cost -88.2811078644
Pre-training layer 2, epoch 5, cost -85.7048665619
Pre-training layer 2, epoch 5, representative training free energy 2579.75475757
Pre-training layer 2, epoch 5, validation free energy 2575.62646497
Pre-training layer 2, epoch 6, cost -83.2608804321
Pre-training layer 2, epoch 7, cost -81.8839784241
Pre-training layer 2, epoch 8, cost -80.327395401
Pre-training layer 2, epoch 9, cost -78.9968222809
Pre-training layer 2, epoch 10, cost -77.7939491653
Pre-training layer 2, epoch 10, representative training free energy 3016.36184143
Pre-training layer 2, epoch 10, validation free energy 3001.0035658
Pre-training layer 2, epoch 11, cost -76.7863043213
Pre-training layer 2, epoch 12, cost -76.1718403625
Pre-training layer 2, epoch 13, cost -75.3236404037
Pre-training layer 2, epoch 14, cost -74.4325281143
Pre-training layer 2, epoch 15, cost -74.1037068939
Pre-training layer 2, epoch 15, representative training free energy 3275.1436106
Pre-training layer 2, epoch 15, validation free energy 3258.95894983
Pre-training layer 2, epoch 16, cost -73.3536015701
Pre-training layer 2, epoch 17, cost -73.0475125504
Pre-training layer 2, epoch 18, cost -72.5230816269
Pre-training layer 2, epoch 19, cost -72.0601491547
Pre-training layer 2, epoch 20, cost -71.6972415924
Pre-training layer 2, epoch 20, representative training free energy 3509.4187688
Pre-training layer 2, epoch 20, validation free energy 3489.18235352
Pre-training layer 2, epoch 21, cost -71.3708882141
Pre-training layer 2, epoch 22, cost -70.9793393707
Pre-training layer 2, epoch 23, cost -70.6579758072
Pre-training layer 2, epoch 24, cost -70.3678630447
Pre-training layer 2, epoch 25, cost -69.9963788223
Pre-training layer 2, epoch 25, representative training free energy 3741.89283765
Pre-training layer 2, epoch 25, validation free energy 3720.36340259
Pre-training layer 2, epoch 26, cost -69.6645541763
Pre-training layer 2, epoch 27, cost -69.3079843903
Pre-training layer 2, epoch 28, cost -69.2520476913
Pre-training layer 2, epoch 29, cost -68.8594662857
Pre-training layer 2, epoch 30, cost -68.7389367676
Pre-training layer 2, epoch 30, representative training free energy 3945.33183008
Pre-training layer 2, epoch 30, validation free energy 3921.56639624
Pre-training layer 2, epoch 31, cost -68.6456412888
Pre-training layer 2, epoch 32, cost -68.2783945847
Pre-training layer 2, epoch 33, cost -67.9363097382
Pre-training layer 2, epoch 34, cost -67.9779532242
Pre-training layer 2, epoch 35, cost -67.7395407486
Pre-training layer 2, epoch 35, representative training free energy 4073.81785767
Pre-training layer 2, epoch 35, validation free energy 4049.76837109
Pre-training layer 2, epoch 36, cost -67.513824501
Pre-training layer 2, epoch 37, cost -67.3723002625
Pre-training layer 2, epoch 38, cost -67.2111049271
Pre-training layer 2, epoch 39, cost -67.1809768295
Pre-training layer 2, epoch 40, cost -66.8872275543
Pre-training layer 2, epoch 40, representative training free energy 4273.15889771
Pre-training layer 2, epoch 40, validation free energy 4247.22079346
Pre-training layer 2, epoch 41, cost -66.655212822
Pre-training layer 2, epoch 42, cost -66.7144611359
Pre-training layer 2, epoch 43, cost -66.4083530426
Pre-training layer 2, epoch 44, cost -66.3136193466
Pre-training layer 2, epoch 45, cost -66.2827668762
Pre-training layer 2, epoch 45, representative training free energy 4391.24825806
Pre-training layer 2, epoch 45, validation free energy 4364.46823364
Pre-training layer 2, epoch 46, cost -66.1500434875
Pre-training layer 2, epoch 47, cost -65.9722085571
Pre-training layer 2, epoch 48, cost -65.8029285049
Pre-training layer 2, epoch 49, cost -65.7630623627
Pre-training layer 2, epoch 50, cost -65.6683987045
Pre-training layer 2, epoch 50, representative training free energy 4537.22405933
Pre-training layer 2, epoch 50, validation free energy 4509.01404858
Pre-training layer 2, epoch 51, cost -65.7009351349
Pre-training layer 2, epoch 52, cost -65.444825592
Pre-training layer 2, epoch 53, cost -65.4672445297
Pre-training layer 2, epoch 54, cost -65.1307186508
Pre-training layer 2, epoch 55, cost -64.9947784424
Pre-training layer 2, epoch 55, representative training free energy 4667.30272656
Pre-training layer 2, epoch 55, validation free energy 4637.54948779
Pre-training layer 2, epoch 56, cost -64.987453537
Pre-training layer 2, epoch 57, cost -64.8977344894
Pre-training layer 2, epoch 58, cost -64.8380822754
Pre-training layer 2, epoch 59, cost -64.6476222229
Pre-training layer 2, epoch 60, cost -64.5928943634
Pre-training layer 2, epoch 60, representative training free energy 4801.08463159
Pre-training layer 2, epoch 60, validation free energy 4768.78594165
Pre-training layer 2, epoch 61, cost -64.6668667221
Pre-training layer 2, epoch 62, cost -64.529825058
Pre-training layer 2, epoch 63, cost -64.6117324448
Pre-training layer 2, epoch 64, cost -64.4035954666
Pre-training layer 2, epoch 65, cost -64.3227765656
Pre-training layer 2, epoch 65, representative training free energy 4920.23263818
Pre-training layer 2, epoch 65, validation free energy 4887.15210327
Pre-training layer 2, epoch 66, cost -64.2309780502
Pre-training layer 2, epoch 67, cost -64.3352801132
Pre-training layer 2, epoch 68, cost -64.2371821976
Pre-training layer 2, epoch 69, cost -64.0866060257
Pre-training layer 2, epoch 70, cost -64.1195975113
Pre-training layer 2, epoch 70, representative training free energy 5004.56642187
Pre-training layer 2, epoch 70, validation free energy 4970.16232715
Pre-training layer 2, epoch 71, cost -64.102158432
Pre-training layer 2, epoch 72, cost -64.0270845795
Pre-training layer 2, epoch 73, cost -63.8747544479
Pre-training layer 2, epoch 74, cost -64.0360460281
Pre-training layer 2, epoch 75, cost -63.7697898483
Pre-training layer 2, epoch 75, representative training free energy 5110.26108911
Pre-training layer 2, epoch 75, validation free energy 5076.77681104
Pre-training layer 2, epoch 76, cost -63.5537525558
Pre-training layer 2, epoch 77, cost -63.5376760864
Pre-training layer 2, epoch 78, cost -63.7770980453
Pre-training layer 2, epoch 79, cost -63.3923624039
Pre-training layer 2, epoch 80, cost -63.4737119293
Pre-training layer 2, epoch 80, representative training free energy 5224.19470557
Pre-training layer 2, epoch 80, validation free energy 5187.39139771
Pre-training layer 2, epoch 81, cost -63.5097430038
Pre-training layer 2, epoch 82, cost -63.2702973938
Pre-training layer 2, epoch 83, cost -63.5129706573
Pre-training layer 2, epoch 84, cost -63.2869084549
Pre-training layer 2, epoch 85, cost -63.2563607407
Pre-training layer 2, epoch 85, representative training free energy 5324.65402832
Pre-training layer 2, epoch 85, validation free energy 5286.7799729
Pre-training layer 2, epoch 86, cost -63.0938978577
Pre-training layer 2, epoch 87, cost -63.1013733292
Pre-training layer 2, epoch 88, cost -63.2612252808
Pre-training layer 2, epoch 89, cost -63.2212170029
Pre-training layer 2, epoch 90, cost -63.1826615524
Pre-training layer 2, epoch 90, representative training free energy 5450.92798364
Pre-training layer 2, epoch 90, validation free energy 5408.70194116
Pre-training layer 2, epoch 91, cost -63.1389665222
Pre-training layer 2, epoch 92, cost -62.9724261093
Pre-training layer 2, epoch 93, cost -63.0200631332
Pre-training layer 2, epoch 94, cost -62.8646604156
Pre-training layer 2, epoch 95, cost -62.8152536011
Pre-training layer 2, epoch 95, representative training free energy 5518.54042578
Pre-training layer 2, epoch 95, validation free energy 5478.79340649
Pre-training layer 2, epoch 96, cost -62.9079102325
Pre-training layer 2, epoch 97, cost -62.8513450623
Pre-training layer 2, epoch 98, cost -62.8483102798
Pre-training layer 2, epoch 99, cost -62.6548502731
The pretraining code for file dbn_loop.pyc ran for 2.72m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 32.800000 %
     epoch 1, minibatch 100/100, test error of best model 29.800000 %
epoch 2, minibatch 100/100, validation error 29.200000 %
     epoch 2, minibatch 100/100, test error of best model 22.400000 %
epoch 3, minibatch 100/100, validation error 25.600000 %
     epoch 3, minibatch 100/100, test error of best model 17.800000 %
epoch 4, minibatch 100/100, validation error 25.000000 %
     epoch 4, minibatch 100/100, test error of best model 16.000000 %
epoch 5, minibatch 100/100, validation error 25.000000 %
epoch 6, minibatch 100/100, validation error 24.600000 %
     epoch 6, minibatch 100/100, test error of best model 14.600000 %
epoch 7, minibatch 100/100, validation error 24.000000 %
     epoch 7, minibatch 100/100, test error of best model 14.800000 %
epoch 8, minibatch 100/100, validation error 23.600000 %
     epoch 8, minibatch 100/100, test error of best model 14.400000 %
epoch 9, minibatch 100/100, validation error 23.000000 %
     epoch 9, minibatch 100/100, test error of best model 14.200000 %
epoch 10, minibatch 100/100, validation error 23.000000 %
epoch 11, minibatch 100/100, validation error 22.400000 %
     epoch 11, minibatch 100/100, test error of best model 13.000000 %
epoch 12, minibatch 100/100, validation error 22.400000 %
epoch 13, minibatch 100/100, validation error 21.800000 %
     epoch 13, minibatch 100/100, test error of best model 12.800000 %
epoch 14, minibatch 100/100, validation error 21.800000 %
epoch 15, minibatch 100/100, validation error 21.200000 %
     epoch 15, minibatch 100/100, test error of best model 12.200000 %
epoch 16, minibatch 100/100, validation error 21.400000 %
epoch 17, minibatch 100/100, validation error 21.400000 %
epoch 18, minibatch 100/100, validation error 21.400000 %
epoch 19, minibatch 100/100, validation error 21.000000 %
     epoch 19, minibatch 100/100, test error of best model 12.000000 %
epoch 20, minibatch 100/100, validation error 21.000000 %
epoch 21, minibatch 100/100, validation error 21.800000 %
epoch 22, minibatch 100/100, validation error 22.000000 %
epoch 23, minibatch 100/100, validation error 22.000000 %
epoch 24, minibatch 100/100, validation error 21.800000 %
epoch 25, minibatch 100/100, validation error 21.800000 %
epoch 26, minibatch 100/100, validation error 22.000000 %
epoch 27, minibatch 100/100, validation error 22.000000 %
epoch 28, minibatch 100/100, validation error 22.000000 %
epoch 29, minibatch 100/100, validation error 22.000000 %
epoch 30, minibatch 100/100, validation error 22.000000 %
epoch 31, minibatch 100/100, validation error 22.000000 %
epoch 32, minibatch 100/100, validation error 21.600000 %
epoch 33, minibatch 100/100, validation error 21.600000 %
epoch 34, minibatch 100/100, validation error 21.600000 %
epoch 35, minibatch 100/100, validation error 21.400000 %
epoch 36, minibatch 100/100, validation error 21.600000 %
epoch 37, minibatch 100/100, validation error 21.200000 %
Optimization complete with best validation score of 21.000000 %, obtained at iteration 1900, with test performance 12.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.36m


==========Sample: (2000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.101043701
Pre-training layer 0, epoch 0, representative training free energy -584.212460022
Pre-training layer 0, epoch 0, validation free energy -580.392250427
Pre-training layer 0, epoch 1, cost -123.441531525
Pre-training layer 0, epoch 2, cost -113.972777977
Pre-training layer 0, epoch 3, cost -108.408311653
Pre-training layer 0, epoch 4, cost -104.334442902
Pre-training layer 0, epoch 5, cost -101.226516647
Pre-training layer 0, epoch 5, representative training free energy -524.554275024
Pre-training layer 0, epoch 5, validation free energy -515.547550659
Pre-training layer 0, epoch 6, cost -98.747245369
Pre-training layer 0, epoch 7, cost -96.9671440887
Pre-training layer 0, epoch 8, cost -95.1420923233
Pre-training layer 0, epoch 9, cost -93.8726375961
Pre-training layer 0, epoch 10, cost -92.5330809402
Pre-training layer 0, epoch 10, representative training free energy -506.079035706
Pre-training layer 0, epoch 10, validation free energy -495.762055237
Pre-training layer 0, epoch 11, cost -91.5834221268
Pre-training layer 0, epoch 12, cost -90.7158878326
Pre-training layer 0, epoch 13, cost -89.9132122803
Pre-training layer 0, epoch 14, cost -88.9452489853
Pre-training layer 0, epoch 15, cost -87.9667782211
Pre-training layer 0, epoch 15, representative training free energy -494.145523743
Pre-training layer 0, epoch 15, validation free energy -483.597723633
Pre-training layer 0, epoch 16, cost -87.3426694489
Pre-training layer 0, epoch 17, cost -87.1426379776
Pre-training layer 0, epoch 18, cost -86.2524420929
Pre-training layer 0, epoch 19, cost -85.8959526443
Pre-training layer 0, epoch 20, cost -85.5006309891
Pre-training layer 0, epoch 20, representative training free energy -486.908273926
Pre-training layer 0, epoch 20, validation free energy -475.793045166
Pre-training layer 0, epoch 21, cost -85.0795848846
Pre-training layer 0, epoch 22, cost -84.4740633011
Pre-training layer 0, epoch 23, cost -84.1433718109
Pre-training layer 0, epoch 24, cost -83.8076434326
Pre-training layer 0, epoch 25, cost -83.4985802841
Pre-training layer 0, epoch 25, representative training free energy -477.920716797
Pre-training layer 0, epoch 25, validation free energy -466.302110535
Pre-training layer 0, epoch 26, cost -83.0339653397
Pre-training layer 0, epoch 27, cost -82.7843153381
Pre-training layer 0, epoch 28, cost -82.520216465
Pre-training layer 0, epoch 29, cost -82.309807663
Pre-training layer 0, epoch 30, cost -81.9127184677
Pre-training layer 0, epoch 30, representative training free energy -474.188381714
Pre-training layer 0, epoch 30, validation free energy -462.512090027
Pre-training layer 0, epoch 31, cost -81.5484051514
Pre-training layer 0, epoch 32, cost -81.1957055092
Pre-training layer 0, epoch 33, cost -81.1949054527
Pre-training layer 0, epoch 34, cost -80.9477841568
Pre-training layer 0, epoch 35, cost -80.6046438599
Pre-training layer 0, epoch 35, representative training free energy -472.865964844
Pre-training layer 0, epoch 35, validation free energy -460.033293579
Pre-training layer 0, epoch 36, cost -80.565812645
Pre-training layer 0, epoch 37, cost -80.1562417984
Pre-training layer 0, epoch 38, cost -79.9785956955
Pre-training layer 0, epoch 39, cost -79.9247844696
Pre-training layer 0, epoch 40, cost -79.6171636581
Pre-training layer 0, epoch 40, representative training free energy -465.102801392
Pre-training layer 0, epoch 40, validation free energy -452.518879883
Pre-training layer 0, epoch 41, cost -79.3635408974
Pre-training layer 0, epoch 42, cost -79.1950579453
Pre-training layer 0, epoch 43, cost -79.1922367859
Pre-training layer 0, epoch 44, cost -78.9955385017
Pre-training layer 0, epoch 45, cost -78.7203476524
Pre-training layer 0, epoch 45, representative training free energy -464.641847046
Pre-training layer 0, epoch 45, validation free energy -451.542970215
Pre-training layer 0, epoch 46, cost -78.5103396416
Pre-training layer 0, epoch 47, cost -78.3252350235
Pre-training layer 0, epoch 48, cost -78.3617505455
Pre-training layer 0, epoch 49, cost -78.1320252609
Pre-training layer 0, epoch 50, cost -78.0187761879
Pre-training layer 0, epoch 50, representative training free energy -461.906129211
Pre-training layer 0, epoch 50, validation free energy -448.580399048
Pre-training layer 0, epoch 51, cost -77.7172549629
Pre-training layer 0, epoch 52, cost -77.7346166992
Pre-training layer 0, epoch 53, cost -77.6446228218
Pre-training layer 0, epoch 54, cost -77.4559827614
Pre-training layer 0, epoch 55, cost -77.317959919
Pre-training layer 0, epoch 55, representative training free energy -460.145901367
Pre-training layer 0, epoch 55, validation free energy -446.827227905
Pre-training layer 0, epoch 56, cost -77.1499088287
Pre-training layer 0, epoch 57, cost -77.2509469414
Pre-training layer 0, epoch 58, cost -76.8712552452
Pre-training layer 0, epoch 59, cost -77.0074390411
Pre-training layer 0, epoch 60, cost -76.7649757957
Pre-training layer 0, epoch 60, representative training free energy -458.651771301
Pre-training layer 0, epoch 60, validation free energy -445.008731812
Pre-training layer 0, epoch 61, cost -76.6709434128
Pre-training layer 0, epoch 62, cost -76.4026420593
Pre-training layer 0, epoch 63, cost -76.3130666733
Pre-training layer 0, epoch 64, cost -76.282454567
Pre-training layer 0, epoch 65, cost -76.2282917023
Pre-training layer 0, epoch 65, representative training free energy -459.266756958
Pre-training layer 0, epoch 65, validation free energy -445.11188269
Pre-training layer 0, epoch 66, cost -76.1937730789
Pre-training layer 0, epoch 67, cost -76.2077490997
Pre-training layer 0, epoch 68, cost -75.8730825424
Pre-training layer 0, epoch 69, cost -75.811585083
Pre-training layer 0, epoch 70, cost -75.8042718697
Pre-training layer 0, epoch 70, representative training free energy -457.503487793
Pre-training layer 0, epoch 70, validation free energy -443.384846619
Pre-training layer 0, epoch 71, cost -75.7178701401
Pre-training layer 0, epoch 72, cost -75.4997174072
Pre-training layer 0, epoch 73, cost -75.4731589508
Pre-training layer 0, epoch 74, cost -75.2930496025
Pre-training layer 0, epoch 75, cost -75.3304573631
Pre-training layer 0, epoch 75, representative training free energy -456.552565796
Pre-training layer 0, epoch 75, validation free energy -441.637583801
Pre-training layer 0, epoch 76, cost -75.3258646011
Pre-training layer 0, epoch 77, cost -75.1610555077
Pre-training layer 0, epoch 78, cost -75.0337004662
Pre-training layer 0, epoch 79, cost -74.9803301811
Pre-training layer 0, epoch 80, cost -74.8875115395
Pre-training layer 0, epoch 80, representative training free energy -453.224107727
Pre-training layer 0, epoch 80, validation free energy -438.383676086
Pre-training layer 0, epoch 81, cost -74.9054839325
Pre-training layer 0, epoch 82, cost -74.8711031151
Pre-training layer 0, epoch 83, cost -74.7224154663
Pre-training layer 0, epoch 84, cost -74.6727129173
Pre-training layer 0, epoch 85, cost -74.4372361374
Pre-training layer 0, epoch 85, representative training free energy -453.128450867
Pre-training layer 0, epoch 85, validation free energy -438.043503479
Pre-training layer 0, epoch 86, cost -74.4897954941
Pre-training layer 0, epoch 87, cost -74.3856222534
Pre-training layer 0, epoch 88, cost -74.2855952835
Pre-training layer 0, epoch 89, cost -74.303724041
Pre-training layer 0, epoch 90, cost -74.2981646347
Pre-training layer 0, epoch 90, representative training free energy -455.080159973
Pre-training layer 0, epoch 90, validation free energy -440.050669373
Pre-training layer 0, epoch 91, cost -74.1101953506
Pre-training layer 0, epoch 92, cost -73.957776413
Pre-training layer 0, epoch 93, cost -74.0470461082
Pre-training layer 0, epoch 94, cost -73.980130806
Pre-training layer 0, epoch 95, cost -73.8643221474
Pre-training layer 0, epoch 95, representative training free energy -450.353157043
Pre-training layer 0, epoch 95, validation free energy -435.342202271
Pre-training layer 0, epoch 96, cost -73.8305327606
Pre-training layer 0, epoch 97, cost -73.7964706802
Pre-training layer 0, epoch 98, cost -73.653767662
Pre-training layer 0, epoch 99, cost -73.680036087
Pre-training layer 1, epoch 0, cost -375.023692017
Pre-training layer 1, epoch 0, representative training free energy -42006.457832
Pre-training layer 1, epoch 0, validation free energy -41705.6089316
Pre-training layer 1, epoch 1, cost -322.509722672
Pre-training layer 1, epoch 2, cost -306.361642838
Pre-training layer 1, epoch 3, cost -296.59693161
Pre-training layer 1, epoch 4, cost -289.53644577
Pre-training layer 1, epoch 5, cost -284.289981079
Pre-training layer 1, epoch 5, representative training free energy -57617.7836992
Pre-training layer 1, epoch 5, validation free energy -57185.2819102
Pre-training layer 1, epoch 6, cost -280.151664276
Pre-training layer 1, epoch 7, cost -277.086316147
Pre-training layer 1, epoch 8, cost -273.9505056
Pre-training layer 1, epoch 9, cost -271.46421196
Pre-training layer 1, epoch 10, cost -269.48891777
Pre-training layer 1, epoch 10, representative training free energy -62288.3249375
Pre-training layer 1, epoch 10, validation free energy -61819.047625
Pre-training layer 1, epoch 11, cost -267.646322403
Pre-training layer 1, epoch 12, cost -266.11970871
Pre-training layer 1, epoch 13, cost -264.787072449
Pre-training layer 1, epoch 14, cost -263.397195282
Pre-training layer 1, epoch 15, cost -262.046179047
Pre-training layer 1, epoch 15, representative training free energy -65110.2350117
Pre-training layer 1, epoch 15, validation free energy -64629.8608359
Pre-training layer 1, epoch 16, cost -261.041976547
Pre-training layer 1, epoch 17, cost -259.949734268
Pre-training layer 1, epoch 18, cost -259.118014832
Pre-training layer 1, epoch 19, cost -258.198413467
Pre-training layer 1, epoch 20, cost -257.550626068
Pre-training layer 1, epoch 20, representative training free energy -66908.3923438
Pre-training layer 1, epoch 20, validation free energy -66414.3207031
Pre-training layer 1, epoch 21, cost -256.81397316
Pre-training layer 1, epoch 22, cost -256.137074814
Pre-training layer 1, epoch 23, cost -255.437852097
Pre-training layer 1, epoch 24, cost -255.036802216
Pre-training layer 1, epoch 25, cost -254.378912125
Pre-training layer 1, epoch 25, representative training free energy -68562.0859805
Pre-training layer 1, epoch 25, validation free energy -68054.9911016
Pre-training layer 1, epoch 26, cost -254.104362488
Pre-training layer 1, epoch 27, cost -253.436483154
Pre-training layer 1, epoch 28, cost -253.101903534
Pre-training layer 1, epoch 29, cost -252.683825989
Pre-training layer 1, epoch 30, cost -252.274515915
Pre-training layer 1, epoch 30, representative training free energy -69785.9834609
Pre-training layer 1, epoch 30, validation free energy -69263.9876211
Pre-training layer 1, epoch 31, cost -251.816153183
Pre-training layer 1, epoch 32, cost -251.301859436
Pre-training layer 1, epoch 33, cost -251.101976318
Pre-training layer 1, epoch 34, cost -250.73020874
Pre-training layer 1, epoch 35, cost -250.393100052
Pre-training layer 1, epoch 35, representative training free energy -70748.4872539
Pre-training layer 1, epoch 35, validation free energy -70221.8619609
Pre-training layer 1, epoch 36, cost -250.238025665
Pre-training layer 1, epoch 37, cost -249.9392173
Pre-training layer 1, epoch 38, cost -249.486008835
Pre-training layer 1, epoch 39, cost -249.363838425
Pre-training layer 1, epoch 40, cost -249.080892258
Pre-training layer 1, epoch 40, representative training free energy -71670.4285469
Pre-training layer 1, epoch 40, validation free energy -71136.2662813
Pre-training layer 1, epoch 41, cost -248.78950119
Pre-training layer 1, epoch 42, cost -248.63595665
Pre-training layer 1, epoch 43, cost -248.387743835
Pre-training layer 1, epoch 44, cost -248.261098785
Pre-training layer 1, epoch 45, cost -247.938990555
Pre-training layer 1, epoch 45, representative training free energy -72400.7869648
Pre-training layer 1, epoch 45, validation free energy -71854.3708906
Pre-training layer 1, epoch 46, cost -247.793676147
Pre-training layer 1, epoch 47, cost -247.537459793
Pre-training layer 1, epoch 48, cost -247.349538574
Pre-training layer 1, epoch 49, cost -247.05818222
Pre-training layer 1, epoch 50, cost -247.029030609
Pre-training layer 1, epoch 50, representative training free energy -73105.1069414
Pre-training layer 1, epoch 50, validation free energy -72555.1587187
Pre-training layer 1, epoch 51, cost -246.865222931
Pre-training layer 1, epoch 52, cost -246.709033051
Pre-training layer 1, epoch 53, cost -246.497162704
Pre-training layer 1, epoch 54, cost -246.338363953
Pre-training layer 1, epoch 55, cost -246.070955582
Pre-training layer 1, epoch 55, representative training free energy -73744.7922344
Pre-training layer 1, epoch 55, validation free energy -73190.2773672
Pre-training layer 1, epoch 56, cost -246.042349319
Pre-training layer 1, epoch 57, cost -245.842757797
Pre-training layer 1, epoch 58, cost -245.813415909
Pre-training layer 1, epoch 59, cost -245.637093658
Pre-training layer 1, epoch 60, cost -245.601371307
Pre-training layer 1, epoch 60, representative training free energy -74252.6185977
Pre-training layer 1, epoch 60, validation free energy -73699.985957
Pre-training layer 1, epoch 61, cost -245.440615005
Pre-training layer 1, epoch 62, cost -245.3274086
Pre-training layer 1, epoch 63, cost -245.123721619
Pre-training layer 1, epoch 64, cost -245.005455246
Pre-training layer 1, epoch 65, cost -244.95204628
Pre-training layer 1, epoch 65, representative training free energy -74821.5885117
Pre-training layer 1, epoch 65, validation free energy -74264.2060469
Pre-training layer 1, epoch 66, cost -244.823430939
Pre-training layer 1, epoch 67, cost -244.670009842
Pre-training layer 1, epoch 68, cost -244.618243103
Pre-training layer 1, epoch 69, cost -244.416920395
Pre-training layer 1, epoch 70, cost -244.186192322
Pre-training layer 1, epoch 70, representative training free energy -75358.8514141
Pre-training layer 1, epoch 70, validation free energy -74790.5521289
Pre-training layer 1, epoch 71, cost -244.230736084
Pre-training layer 1, epoch 72, cost -244.170526505
Pre-training layer 1, epoch 73, cost -244.166939774
Pre-training layer 1, epoch 74, cost -244.065598221
Pre-training layer 1, epoch 75, cost -243.846285553
Pre-training layer 1, epoch 75, representative training free energy -75706.1491445
Pre-training layer 1, epoch 75, validation free energy -75135.8634531
Pre-training layer 1, epoch 76, cost -243.728831711
Pre-training layer 1, epoch 77, cost -243.49755661
Pre-training layer 1, epoch 78, cost -243.590798492
Pre-training layer 1, epoch 79, cost -243.565583878
Pre-training layer 1, epoch 80, cost -243.50590271
Pre-training layer 1, epoch 80, representative training free energy -76105.8118711
Pre-training layer 1, epoch 80, validation free energy -75535.3483086
Pre-training layer 1, epoch 81, cost -243.451643677
Pre-training layer 1, epoch 82, cost -243.259883347
Pre-training layer 1, epoch 83, cost -243.19599968
Pre-training layer 1, epoch 84, cost -243.057951126
Pre-training layer 1, epoch 85, cost -243.18086174
Pre-training layer 1, epoch 85, representative training free energy -76648.0428203
Pre-training layer 1, epoch 85, validation free energy -76076.7215
Pre-training layer 1, epoch 86, cost -243.00085968
Pre-training layer 1, epoch 87, cost -242.866752014
Pre-training layer 1, epoch 88, cost -242.914746552
Pre-training layer 1, epoch 89, cost -242.742056503
Pre-training layer 1, epoch 90, cost -242.590993347
Pre-training layer 1, epoch 90, representative training free energy -77023.6212734
Pre-training layer 1, epoch 90, validation free energy -76446.2679844
Pre-training layer 1, epoch 91, cost -242.55806282
Pre-training layer 1, epoch 92, cost -242.510297546
Pre-training layer 1, epoch 93, cost -242.433762589
Pre-training layer 1, epoch 94, cost -242.389144974
Pre-training layer 1, epoch 95, cost -242.319732513
Pre-training layer 1, epoch 95, representative training free energy -77348.5581914
Pre-training layer 1, epoch 95, validation free energy -76767.5279492
Pre-training layer 1, epoch 96, cost -242.252276154
Pre-training layer 1, epoch 97, cost -242.160053482
Pre-training layer 1, epoch 98, cost -242.080254211
Pre-training layer 1, epoch 99, cost -242.294184113
Pre-training layer 2, epoch 0, cost -136.773689842
Pre-training layer 2, epoch 0, representative training free energy 2204.10716382
Pre-training layer 2, epoch 0, validation free energy 2197.17869409
Pre-training layer 2, epoch 1, cost -97.6489308548
Pre-training layer 2, epoch 2, cost -89.7290314484
Pre-training layer 2, epoch 3, cost -85.0381620026
Pre-training layer 2, epoch 4, cost -81.9538532829
Pre-training layer 2, epoch 5, cost -79.7067521286
Pre-training layer 2, epoch 5, representative training free energy 3686.49086267
Pre-training layer 2, epoch 5, validation free energy 3675.51932202
Pre-training layer 2, epoch 6, cost -77.86069067
Pre-training layer 2, epoch 7, cost -76.3668702126
Pre-training layer 2, epoch 8, cost -75.1252180481
Pre-training layer 2, epoch 9, cost -74.3427119637
Pre-training layer 2, epoch 10, cost -73.444882164
Pre-training layer 2, epoch 10, representative training free energy 4347.43641638
Pre-training layer 2, epoch 10, validation free energy 4333.27707397
Pre-training layer 2, epoch 11, cost -72.6698503494
Pre-training layer 2, epoch 12, cost -71.9969517708
Pre-training layer 2, epoch 13, cost -71.3442720604
Pre-training layer 2, epoch 14, cost -70.8520423889
Pre-training layer 2, epoch 15, cost -70.3968760109
Pre-training layer 2, epoch 15, representative training free energy 4883.77805859
Pre-training layer 2, epoch 15, validation free energy 4862.66701831
Pre-training layer 2, epoch 16, cost -70.0164616013
Pre-training layer 2, epoch 17, cost -69.5072948456
Pre-training layer 2, epoch 18, cost -69.1729633904
Pre-training layer 2, epoch 19, cost -68.9480249405
Pre-training layer 2, epoch 20, cost -68.3305568695
Pre-training layer 2, epoch 20, representative training free energy 5332.4930647
Pre-training layer 2, epoch 20, validation free energy 5308.12740356
Pre-training layer 2, epoch 21, cost -68.278252182
Pre-training layer 2, epoch 22, cost -67.9950595856
Pre-training layer 2, epoch 23, cost -67.6965646744
Pre-training layer 2, epoch 24, cost -67.4486326408
Pre-training layer 2, epoch 25, cost -67.341602993
Pre-training layer 2, epoch 25, representative training free energy 5704.31519336
Pre-training layer 2, epoch 25, validation free energy 5671.67304565
Pre-training layer 2, epoch 26, cost -66.8993188667
Pre-training layer 2, epoch 27, cost -66.8466749954
Pre-training layer 2, epoch 28, cost -66.4596231079
Pre-training layer 2, epoch 29, cost -66.4230496597
Pre-training layer 2, epoch 30, cost -66.3592453766
Pre-training layer 2, epoch 30, representative training free energy 6027.89126221
Pre-training layer 2, epoch 30, validation free energy 5992.97388281
Pre-training layer 2, epoch 31, cost -66.0693578148
Pre-training layer 2, epoch 32, cost -66.1330412292
Pre-training layer 2, epoch 33, cost -65.7217266273
Pre-training layer 2, epoch 34, cost -65.7830380058
Pre-training layer 2, epoch 35, cost -65.5224369621
Pre-training layer 2, epoch 35, representative training free energy 6329.14005859
Pre-training layer 2, epoch 35, validation free energy 6285.42027539
Pre-training layer 2, epoch 36, cost -65.3577532005
Pre-training layer 2, epoch 37, cost -65.2413573456
Pre-training layer 2, epoch 38, cost -65.1442053413
Pre-training layer 2, epoch 39, cost -64.9595561409
Pre-training layer 2, epoch 40, cost -64.8296848869
Pre-training layer 2, epoch 40, representative training free energy 6567.18968164
Pre-training layer 2, epoch 40, validation free energy 6521.21662842
Pre-training layer 2, epoch 41, cost -64.8907745552
Pre-training layer 2, epoch 42, cost -64.7313302422
Pre-training layer 2, epoch 43, cost -64.4808221054
Pre-training layer 2, epoch 44, cost -64.6485378647
Pre-training layer 2, epoch 45, cost -64.4733199883
Pre-training layer 2, epoch 45, representative training free energy 6839.02047949
Pre-training layer 2, epoch 45, validation free energy 6787.59548437
Pre-training layer 2, epoch 46, cost -64.432906208
Pre-training layer 2, epoch 47, cost -64.4583255768
Pre-training layer 2, epoch 48, cost -64.2224170685
Pre-training layer 2, epoch 49, cost -64.1197300911
Pre-training layer 2, epoch 50, cost -64.0783182907
Pre-training layer 2, epoch 50, representative training free energy 7029.91656494
Pre-training layer 2, epoch 50, validation free energy 6978.57991504
Pre-training layer 2, epoch 51, cost -63.8802647591
Pre-training layer 2, epoch 52, cost -63.8383369255
Pre-training layer 2, epoch 53, cost -63.7891102219
Pre-training layer 2, epoch 54, cost -63.7751550102
Pre-training layer 2, epoch 55, cost -63.8389445496
Pre-training layer 2, epoch 55, representative training free energy 7253.43257031
Pre-training layer 2, epoch 55, validation free energy 7194.67492236
Pre-training layer 2, epoch 56, cost -63.6604675102
Pre-training layer 2, epoch 57, cost -63.593477211
Pre-training layer 2, epoch 58, cost -63.4237630844
Pre-training layer 2, epoch 59, cost -63.4514360046
Pre-training layer 2, epoch 60, cost -63.3789463043
Pre-training layer 2, epoch 60, representative training free energy 7452.20489307
Pre-training layer 2, epoch 60, validation free energy 7390.71875049
Pre-training layer 2, epoch 61, cost -63.45194664
Pre-training layer 2, epoch 62, cost -63.1806488419
Pre-training layer 2, epoch 63, cost -63.0996842003
Pre-training layer 2, epoch 64, cost -63.1464039421
Pre-training layer 2, epoch 65, cost -63.1860464478
Pre-training layer 2, epoch 65, representative training free energy 7617.49508936
Pre-training layer 2, epoch 65, validation free energy 7555.75365137
Pre-training layer 2, epoch 66, cost -63.1827716255
Pre-training layer 2, epoch 67, cost -63.0244458771
Pre-training layer 2, epoch 68, cost -62.8967077065
Pre-training layer 2, epoch 69, cost -63.0836668015
Pre-training layer 2, epoch 70, cost -62.8981286812
Pre-training layer 2, epoch 70, representative training free energy 7820.85987598
Pre-training layer 2, epoch 70, validation free energy 7754.73814502
Pre-training layer 2, epoch 71, cost -62.8032609177
Pre-training layer 2, epoch 72, cost -62.8211545181
Pre-training layer 2, epoch 73, cost -62.8958507919
Pre-training layer 2, epoch 74, cost -62.8220102119
Pre-training layer 2, epoch 75, cost -62.6995949173
Pre-training layer 2, epoch 75, representative training free energy 7979.9806416
Pre-training layer 2, epoch 75, validation free energy 7911.85000635
Pre-training layer 2, epoch 76, cost -62.6379230118
Pre-training layer 2, epoch 77, cost -62.7760532951
Pre-training layer 2, epoch 78, cost -62.5437090111
Pre-training layer 2, epoch 79, cost -62.677791729
Pre-training layer 2, epoch 80, cost -62.6363266563
Pre-training layer 2, epoch 80, representative training free energy 8128.9807666
Pre-training layer 2, epoch 80, validation free energy 8057.61016895
Pre-training layer 2, epoch 81, cost -62.4769650078
Pre-training layer 2, epoch 82, cost -62.5364855766
Pre-training layer 2, epoch 83, cost -62.4453957939
Pre-training layer 2, epoch 84, cost -62.5422642708
Pre-training layer 2, epoch 85, cost -62.4437867355
Pre-training layer 2, epoch 85, representative training free energy 8271.33391162
Pre-training layer 2, epoch 85, validation free energy 8199.40174707
Pre-training layer 2, epoch 86, cost -62.5112387466
Pre-training layer 2, epoch 87, cost -62.3612271881
Pre-training layer 2, epoch 88, cost -62.3288894463
Pre-training layer 2, epoch 89, cost -62.2818539047
Pre-training layer 2, epoch 90, cost -62.2287372398
Pre-training layer 2, epoch 90, representative training free energy 8401.60604248
Pre-training layer 2, epoch 90, validation free energy 8327.73540918
Pre-training layer 2, epoch 91, cost -62.2250679398
Pre-training layer 2, epoch 92, cost -62.1627189827
Pre-training layer 2, epoch 93, cost -62.1938660622
Pre-training layer 2, epoch 94, cost -62.0536473465
Pre-training layer 2, epoch 95, cost -62.0024739456
Pre-training layer 2, epoch 95, representative training free energy 8547.21723096
Pre-training layer 2, epoch 95, validation free energy 8471.68538623
Pre-training layer 2, epoch 96, cost -62.1033425331
Pre-training layer 2, epoch 97, cost -62.0297625351
Pre-training layer 2, epoch 98, cost -61.9379666328
Pre-training layer 2, epoch 99, cost -61.9210625458
The pretraining code for file dbn_loop.pyc ran for 5.30m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 34.200000 %
     epoch 1, minibatch 200/200, test error of best model 28.000000 %
epoch 2, minibatch 200/200, validation error 26.800000 %
     epoch 2, minibatch 200/200, test error of best model 17.600000 %
epoch 3, minibatch 200/200, validation error 24.200000 %
     epoch 3, minibatch 200/200, test error of best model 13.800000 %
epoch 4, minibatch 200/200, validation error 22.800000 %
     epoch 4, minibatch 200/200, test error of best model 11.600000 %
epoch 5, minibatch 200/200, validation error 21.800000 %
     epoch 5, minibatch 200/200, test error of best model 10.400000 %
epoch 6, minibatch 200/200, validation error 21.200000 %
     epoch 6, minibatch 200/200, test error of best model 9.600000 %
epoch 7, minibatch 200/200, validation error 20.600000 %
     epoch 7, minibatch 200/200, test error of best model 8.800000 %
epoch 8, minibatch 200/200, validation error 19.800000 %
     epoch 8, minibatch 200/200, test error of best model 8.400000 %
epoch 9, minibatch 200/200, validation error 19.600000 %
     epoch 9, minibatch 200/200, test error of best model 7.800000 %
epoch 10, minibatch 200/200, validation error 19.200000 %
     epoch 10, minibatch 200/200, test error of best model 7.400000 %
epoch 11, minibatch 200/200, validation error 19.200000 %
     epoch 11, minibatch 200/200, test error of best model 7.400000 %
epoch 12, minibatch 200/200, validation error 18.800000 %
     epoch 12, minibatch 200/200, test error of best model 6.600000 %
epoch 13, minibatch 200/200, validation error 18.800000 %
epoch 14, minibatch 200/200, validation error 18.200000 %
     epoch 14, minibatch 200/200, test error of best model 7.000000 %
epoch 15, minibatch 200/200, validation error 18.200000 %
epoch 16, minibatch 200/200, validation error 18.200000 %
epoch 17, minibatch 200/200, validation error 17.800000 %
     epoch 17, minibatch 200/200, test error of best model 6.800000 %
epoch 18, minibatch 200/200, validation error 17.800000 %
epoch 19, minibatch 200/200, validation error 17.400000 %
     epoch 19, minibatch 200/200, test error of best model 6.600000 %
epoch 20, minibatch 200/200, validation error 17.200000 %
     epoch 20, minibatch 200/200, test error of best model 7.000000 %
epoch 21, minibatch 200/200, validation error 17.000000 %
     epoch 21, minibatch 200/200, test error of best model 7.000000 %
epoch 22, minibatch 200/200, validation error 17.000000 %
epoch 23, minibatch 200/200, validation error 16.800000 %
     epoch 23, minibatch 200/200, test error of best model 7.000000 %
epoch 24, minibatch 200/200, validation error 16.800000 %
epoch 25, minibatch 200/200, validation error 16.800000 %
epoch 26, minibatch 200/200, validation error 16.800000 %
epoch 27, minibatch 200/200, validation error 16.800000 %
epoch 28, minibatch 200/200, validation error 16.600000 %
     epoch 28, minibatch 200/200, test error of best model 7.000000 %
epoch 29, minibatch 200/200, validation error 16.600000 %
epoch 30, minibatch 200/200, validation error 16.600000 %
epoch 31, minibatch 200/200, validation error 16.600000 %
epoch 32, minibatch 200/200, validation error 16.800000 %
epoch 33, minibatch 200/200, validation error 16.800000 %
epoch 34, minibatch 200/200, validation error 16.800000 %
epoch 35, minibatch 200/200, validation error 16.800000 %
epoch 36, minibatch 200/200, validation error 16.800000 %
epoch 37, minibatch 200/200, validation error 16.800000 %
epoch 38, minibatch 200/200, validation error 16.600000 %
epoch 39, minibatch 200/200, validation error 16.600000 %
epoch 40, minibatch 200/200, validation error 16.600000 %
epoch 41, minibatch 200/200, validation error 16.600000 %
epoch 42, minibatch 200/200, validation error 16.600000 %
epoch 43, minibatch 200/200, validation error 16.800000 %
epoch 44, minibatch 200/200, validation error 16.800000 %
epoch 45, minibatch 200/200, validation error 16.800000 %
epoch 46, minibatch 200/200, validation error 16.800000 %
epoch 47, minibatch 200/200, validation error 16.800000 %
epoch 48, minibatch 200/200, validation error 16.800000 %
epoch 49, minibatch 200/200, validation error 16.800000 %
epoch 50, minibatch 200/200, validation error 16.800000 %
epoch 51, minibatch 200/200, validation error 16.800000 %
epoch 52, minibatch 200/200, validation error 16.800000 %
epoch 53, minibatch 200/200, validation error 16.800000 %
epoch 54, minibatch 200/200, validation error 16.800000 %
epoch 55, minibatch 200/200, validation error 16.800000 %
Optimization complete with best validation score of 16.600000 %, obtained at iteration 5600, with test performance 7.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.96m


==========Sample: (3000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.810492732
Pre-training layer 0, epoch 0, representative training free energy -559.787312622
Pre-training layer 0, epoch 0, validation free energy -554.607770264
Pre-training layer 0, epoch 1, cost -117.09725769
Pre-training layer 0, epoch 2, cost -107.915596873
Pre-training layer 0, epoch 3, cost -102.822746302
Pre-training layer 0, epoch 4, cost -99.4330871836
Pre-training layer 0, epoch 5, cost -96.6281959534
Pre-training layer 0, epoch 5, representative training free energy -503.443329163
Pre-training layer 0, epoch 5, validation free energy -495.016928223
Pre-training layer 0, epoch 6, cost -94.6054632314
Pre-training layer 0, epoch 7, cost -92.849352239
Pre-training layer 0, epoch 8, cost -91.4648770142
Pre-training layer 0, epoch 9, cost -90.0549478404
Pre-training layer 0, epoch 10, cost -89.0250887426
Pre-training layer 0, epoch 10, representative training free energy -482.10286499
Pre-training layer 0, epoch 10, validation free energy -473.07121051
Pre-training layer 0, epoch 11, cost -88.2576447805
Pre-training layer 0, epoch 12, cost -87.4437377167
Pre-training layer 0, epoch 13, cost -86.7187529246
Pre-training layer 0, epoch 14, cost -86.1083944321
Pre-training layer 0, epoch 15, cost -85.3933533478
Pre-training layer 0, epoch 15, representative training free energy -469.019395691
Pre-training layer 0, epoch 15, validation free energy -459.531631226
Pre-training layer 0, epoch 16, cost -84.7932434845
Pre-training layer 0, epoch 17, cost -84.4047780736
Pre-training layer 0, epoch 18, cost -84.0692912165
Pre-training layer 0, epoch 19, cost -83.4589611435
Pre-training layer 0, epoch 20, cost -83.0756295522
Pre-training layer 0, epoch 20, representative training free energy -459.09646283
Pre-training layer 0, epoch 20, validation free energy -449.811521118
Pre-training layer 0, epoch 21, cost -82.7485121791
Pre-training layer 0, epoch 22, cost -82.3629963048
Pre-training layer 0, epoch 23, cost -81.9495458476
Pre-training layer 0, epoch 24, cost -81.6774519602
Pre-training layer 0, epoch 25, cost -81.3049278386
Pre-training layer 0, epoch 25, representative training free energy -453.212185669
Pre-training layer 0, epoch 25, validation free energy -442.973215271
Pre-training layer 0, epoch 26, cost -80.9765492757
Pre-training layer 0, epoch 27, cost -80.8385208384
Pre-training layer 0, epoch 28, cost -80.6442083995
Pre-training layer 0, epoch 29, cost -80.471770134
Pre-training layer 0, epoch 30, cost -80.0793235397
Pre-training layer 0, epoch 30, representative training free energy -449.152442261
Pre-training layer 0, epoch 30, validation free energy -439.182337585
Pre-training layer 0, epoch 31, cost -79.8663361231
Pre-training layer 0, epoch 32, cost -79.703576355
Pre-training layer 0, epoch 33, cost -79.5292730077
Pre-training layer 0, epoch 34, cost -79.3471946843
Pre-training layer 0, epoch 35, cost -79.1402175013
Pre-training layer 0, epoch 35, representative training free energy -448.824461365
Pre-training layer 0, epoch 35, validation free energy -438.254125732
Pre-training layer 0, epoch 36, cost -78.7631387202
Pre-training layer 0, epoch 37, cost -78.7031068293
Pre-training layer 0, epoch 38, cost -78.5775042597
Pre-training layer 0, epoch 39, cost -78.3602864075
Pre-training layer 0, epoch 40, cost -78.2318420156
Pre-training layer 0, epoch 40, representative training free energy -444.961103577
Pre-training layer 0, epoch 40, validation free energy -433.93023175
Pre-training layer 0, epoch 41, cost -78.1055952581
Pre-training layer 0, epoch 42, cost -77.9223591995
Pre-training layer 0, epoch 43, cost -77.8442618052
Pre-training layer 0, epoch 44, cost -77.7014819082
Pre-training layer 0, epoch 45, cost -77.5280287425
Pre-training layer 0, epoch 45, representative training free energy -442.239840149
Pre-training layer 0, epoch 45, validation free energy -431.29227948
Pre-training layer 0, epoch 46, cost -77.3335552979
Pre-training layer 0, epoch 47, cost -77.3176447805
Pre-training layer 0, epoch 48, cost -77.0281217194
Pre-training layer 0, epoch 49, cost -76.9584169006
Pre-training layer 0, epoch 50, cost -76.88663311
Pre-training layer 0, epoch 50, representative training free energy -443.42951123
Pre-training layer 0, epoch 50, validation free energy -432.481301697
Pre-training layer 0, epoch 51, cost -76.7458614477
Pre-training layer 0, epoch 52, cost -76.6865538534
Pre-training layer 0, epoch 53, cost -76.5606842041
Pre-training layer 0, epoch 54, cost -76.4263485082
Pre-training layer 0, epoch 55, cost -76.3852592595
Pre-training layer 0, epoch 55, representative training free energy -439.590587463
Pre-training layer 0, epoch 55, validation free energy -427.937679138
Pre-training layer 0, epoch 56, cost -76.2553397497
Pre-training layer 0, epoch 57, cost -76.2296934001
Pre-training layer 0, epoch 58, cost -75.9898251343
Pre-training layer 0, epoch 59, cost -75.9913778687
Pre-training layer 0, epoch 60, cost -75.8869050217
Pre-training layer 0, epoch 60, representative training free energy -438.910410828
Pre-training layer 0, epoch 60, validation free energy -427.470767029
Pre-training layer 0, epoch 61, cost -75.8651696142
Pre-training layer 0, epoch 62, cost -75.7564248912
Pre-training layer 0, epoch 63, cost -75.6310795975
Pre-training layer 0, epoch 64, cost -75.5329000473
Pre-training layer 0, epoch 65, cost -75.3597261047
Pre-training layer 0, epoch 65, representative training free energy -435.527645447
Pre-training layer 0, epoch 65, validation free energy -424.180115723
Pre-training layer 0, epoch 66, cost -75.2688066864
Pre-training layer 0, epoch 67, cost -75.1950965627
Pre-training layer 0, epoch 68, cost -75.0893192037
Pre-training layer 0, epoch 69, cost -75.1478149033
Pre-training layer 0, epoch 70, cost -75.0880360158
Pre-training layer 0, epoch 70, representative training free energy -438.481432739
Pre-training layer 0, epoch 70, validation free energy -426.577100525
Pre-training layer 0, epoch 71, cost -75.0012796402
Pre-training layer 0, epoch 72, cost -74.8700441106
Pre-training layer 0, epoch 73, cost -74.8456287766
Pre-training layer 0, epoch 74, cost -74.7433280436
Pre-training layer 0, epoch 75, cost -74.6578728994
Pre-training layer 0, epoch 75, representative training free energy -438.361055603
Pre-training layer 0, epoch 75, validation free energy -426.702787415
Pre-training layer 0, epoch 76, cost -74.6630394109
Pre-training layer 0, epoch 77, cost -74.4845199966
Pre-training layer 0, epoch 78, cost -74.4656823858
Pre-training layer 0, epoch 79, cost -74.4226018397
Pre-training layer 0, epoch 80, cost -74.1774948374
Pre-training layer 0, epoch 80, representative training free energy -437.602931091
Pre-training layer 0, epoch 80, validation free energy -425.003200439
Pre-training layer 0, epoch 81, cost -74.2914860662
Pre-training layer 0, epoch 82, cost -74.2272927602
Pre-training layer 0, epoch 83, cost -74.052134552
Pre-training layer 0, epoch 84, cost -74.0553127162
Pre-training layer 0, epoch 85, cost -74.0325868479
Pre-training layer 0, epoch 85, representative training free energy -434.067419556
Pre-training layer 0, epoch 85, validation free energy -421.822912415
Pre-training layer 0, epoch 86, cost -73.8747045517
Pre-training layer 0, epoch 87, cost -74.1149469248
Pre-training layer 0, epoch 88, cost -73.8355378723
Pre-training layer 0, epoch 89, cost -73.8852427546
Pre-training layer 0, epoch 90, cost -73.8148947016
Pre-training layer 0, epoch 90, representative training free energy -430.891802368
Pre-training layer 0, epoch 90, validation free energy -418.954169617
Pre-training layer 0, epoch 91, cost -73.7094129181
Pre-training layer 0, epoch 92, cost -73.6128470484
Pre-training layer 0, epoch 93, cost -73.661451327
Pre-training layer 0, epoch 94, cost -73.5379051208
Pre-training layer 0, epoch 95, cost -73.5746649933
Pre-training layer 0, epoch 95, representative training free energy -432.360138916
Pre-training layer 0, epoch 95, validation free energy -419.766297424
Pre-training layer 0, epoch 96, cost -73.5976966604
Pre-training layer 0, epoch 97, cost -73.3562132136
Pre-training layer 0, epoch 98, cost -73.313224678
Pre-training layer 0, epoch 99, cost -73.2908643723
Pre-training layer 1, epoch 0, cost -345.152623647
Pre-training layer 1, epoch 0, representative training free energy -50301.4246992
Pre-training layer 1, epoch 0, validation free energy -49856.3887617
Pre-training layer 1, epoch 1, cost -296.435297801
Pre-training layer 1, epoch 2, cost -281.482967173
Pre-training layer 1, epoch 3, cost -272.421532491
Pre-training layer 1, epoch 4, cost -266.32574351
Pre-training layer 1, epoch 5, cost -261.648951874
Pre-training layer 1, epoch 5, representative training free energy -68268.9564922
Pre-training layer 1, epoch 5, validation free energy -67686.8276133
Pre-training layer 1, epoch 6, cost -258.090652364
Pre-training layer 1, epoch 7, cost -255.001214193
Pre-training layer 1, epoch 8, cost -252.632417348
Pre-training layer 1, epoch 9, cost -250.551679077
Pre-training layer 1, epoch 10, cost -248.832183177
Pre-training layer 1, epoch 10, representative training free energy -73570.7872695
Pre-training layer 1, epoch 10, validation free energy -72950.4516797
Pre-training layer 1, epoch 11, cost -247.310565847
Pre-training layer 1, epoch 12, cost -246.021257884
Pre-training layer 1, epoch 13, cost -244.875463765
Pre-training layer 1, epoch 14, cost -243.712321777
Pre-training layer 1, epoch 15, cost -242.654546967
Pre-training layer 1, epoch 15, representative training free energy -76847.2878672
Pre-training layer 1, epoch 15, validation free energy -76195.7083906
Pre-training layer 1, epoch 16, cost -241.913936717
Pre-training layer 1, epoch 17, cost -241.010861308
Pre-training layer 1, epoch 18, cost -240.357443644
Pre-training layer 1, epoch 19, cost -239.858157298
Pre-training layer 1, epoch 20, cost -239.116647034
Pre-training layer 1, epoch 20, representative training free energy -79140.3170273
Pre-training layer 1, epoch 20, validation free energy -78471.4011211
Pre-training layer 1, epoch 21, cost -238.478360799
Pre-training layer 1, epoch 22, cost -237.947871806
Pre-training layer 1, epoch 23, cost -237.483261414
Pre-training layer 1, epoch 24, cost -237.193406321
Pre-training layer 1, epoch 25, cost -236.682680155
Pre-training layer 1, epoch 25, representative training free energy -80976.440457
Pre-training layer 1, epoch 25, validation free energy -80285.5396953
Pre-training layer 1, epoch 26, cost -236.356898295
Pre-training layer 1, epoch 27, cost -235.872996267
Pre-training layer 1, epoch 28, cost -235.513921254
Pre-training layer 1, epoch 29, cost -235.221126251
Pre-training layer 1, epoch 30, cost -234.814764659
Pre-training layer 1, epoch 30, representative training free energy -82356.1045703
Pre-training layer 1, epoch 30, validation free energy -81666.4787461
Pre-training layer 1, epoch 31, cost -234.540811717
Pre-training layer 1, epoch 32, cost -234.338184509
Pre-training layer 1, epoch 33, cost -233.976455739
Pre-training layer 1, epoch 34, cost -233.700678253
Pre-training layer 1, epoch 35, cost -233.530927073
Pre-training layer 1, epoch 35, representative training free energy -83651.800625
Pre-training layer 1, epoch 35, validation free energy -82948.9591055
Pre-training layer 1, epoch 36, cost -233.250088654
Pre-training layer 1, epoch 37, cost -233.11278595
Pre-training layer 1, epoch 38, cost -232.840912781
Pre-training layer 1, epoch 39, cost -232.547678426
Pre-training layer 1, epoch 40, cost -232.39436971
Pre-training layer 1, epoch 40, representative training free energy -84643.2943555
Pre-training layer 1, epoch 40, validation free energy -83930.4654219
Pre-training layer 1, epoch 41, cost -232.269439087
Pre-training layer 1, epoch 42, cost -231.962734172
Pre-training layer 1, epoch 43, cost -231.698865967
Pre-training layer 1, epoch 44, cost -231.50727829
Pre-training layer 1, epoch 45, cost -231.522902323
Pre-training layer 1, epoch 45, representative training free energy -85667.1501016
Pre-training layer 1, epoch 45, validation free energy -84947.6167305
Pre-training layer 1, epoch 46, cost -231.29659083
Pre-training layer 1, epoch 47, cost -231.022621613
Pre-training layer 1, epoch 48, cost -230.969891917
Pre-training layer 1, epoch 49, cost -230.760651499
Pre-training layer 1, epoch 50, cost -230.7181014
Pre-training layer 1, epoch 50, representative training free energy -86521.6084766
Pre-training layer 1, epoch 50, validation free energy -85795.0461992
Pre-training layer 1, epoch 51, cost -230.437454224
Pre-training layer 1, epoch 52, cost -230.358149974
Pre-training layer 1, epoch 53, cost -230.259277395
Pre-training layer 1, epoch 54, cost -230.214388631
Pre-training layer 1, epoch 55, cost -229.968659414
Pre-training layer 1, epoch 55, representative training free energy -87255.8216992
Pre-training layer 1, epoch 55, validation free energy -86529.3365117
Pre-training layer 1, epoch 56, cost -229.741694794
Pre-training layer 1, epoch 57, cost -229.75891866
Pre-training layer 1, epoch 58, cost -229.66030131
Pre-training layer 1, epoch 59, cost -229.401044108
Pre-training layer 1, epoch 60, cost -229.333704071
Pre-training layer 1, epoch 60, representative training free energy -87955.9153906
Pre-training layer 1, epoch 60, validation free energy -87228.8298242
Pre-training layer 1, epoch 61, cost -229.219717153
Pre-training layer 1, epoch 62, cost -229.158741506
Pre-training layer 1, epoch 63, cost -228.869780121
Pre-training layer 1, epoch 64, cost -228.965428111
Pre-training layer 1, epoch 65, cost -228.903689372
Pre-training layer 1, epoch 65, representative training free energy -88630.538625
Pre-training layer 1, epoch 65, validation free energy -87898.669582
Pre-training layer 1, epoch 66, cost -228.720336558
Pre-training layer 1, epoch 67, cost -228.669588165
Pre-training layer 1, epoch 68, cost -228.545657094
Pre-training layer 1, epoch 69, cost -228.526581268
Pre-training layer 1, epoch 70, cost -228.358250326
Pre-training layer 1, epoch 70, representative training free energy -89304.0916953
Pre-training layer 1, epoch 70, validation free energy -88563.5779141
Pre-training layer 1, epoch 71, cost -228.242813721
Pre-training layer 1, epoch 72, cost -228.317529958
Pre-training layer 1, epoch 73, cost -228.075801086
Pre-training layer 1, epoch 74, cost -228.007297109
Pre-training layer 1, epoch 75, cost -227.917060242
Pre-training layer 1, epoch 75, representative training free energy -89817.1118477
Pre-training layer 1, epoch 75, validation free energy -89067.2371172
Pre-training layer 1, epoch 76, cost -227.922844035
Pre-training layer 1, epoch 77, cost -227.729080607
Pre-training layer 1, epoch 78, cost -227.811141866
Pre-training layer 1, epoch 79, cost -227.522997487
Pre-training layer 1, epoch 80, cost -227.578658142
Pre-training layer 1, epoch 80, representative training free energy -90312.7954883
Pre-training layer 1, epoch 80, validation free energy -89559.2188203
Pre-training layer 1, epoch 81, cost -227.511717224
Pre-training layer 1, epoch 82, cost -227.419965922
Pre-training layer 1, epoch 83, cost -227.407208455
Pre-training layer 1, epoch 84, cost -227.297890269
Pre-training layer 1, epoch 85, cost -227.267179159
Pre-training layer 1, epoch 85, representative training free energy -90904.1644219
Pre-training layer 1, epoch 85, validation free energy -90146.2993945
Pre-training layer 1, epoch 86, cost -227.118245443
Pre-training layer 1, epoch 87, cost -227.074792735
Pre-training layer 1, epoch 88, cost -226.96284083
Pre-training layer 1, epoch 89, cost -226.844220174
Pre-training layer 1, epoch 90, cost -226.923862966
Pre-training layer 1, epoch 90, representative training free energy -91471.401543
Pre-training layer 1, epoch 90, validation free energy -90703.9266328
Pre-training layer 1, epoch 91, cost -226.853368988
Pre-training layer 1, epoch 92, cost -226.762001648
Pre-training layer 1, epoch 93, cost -226.668088481
Pre-training layer 1, epoch 94, cost -226.57378835
Pre-training layer 1, epoch 95, cost -226.536340942
Pre-training layer 1, epoch 95, representative training free energy -91892.6980508
Pre-training layer 1, epoch 95, validation free energy -91125.4286953
Pre-training layer 1, epoch 96, cost -226.506930949
Pre-training layer 1, epoch 97, cost -226.480228526
Pre-training layer 1, epoch 98, cost -226.458731181
Pre-training layer 1, epoch 99, cost -226.458126526
Pre-training layer 2, epoch 0, cost -128.588926799
Pre-training layer 2, epoch 0, representative training free energy 3197.57565186
Pre-training layer 2, epoch 0, validation free energy 3166.08307983
Pre-training layer 2, epoch 1, cost -94.294318428
Pre-training layer 2, epoch 2, cost -87.0831086477
Pre-training layer 2, epoch 3, cost -82.9047006734
Pre-training layer 2, epoch 4, cost -80.0507231267
Pre-training layer 2, epoch 5, cost -77.9562636058
Pre-training layer 2, epoch 5, representative training free energy 5095.64718555
Pre-training layer 2, epoch 5, validation free energy 5056.1684668
Pre-training layer 2, epoch 6, cost -76.4846314748
Pre-training layer 2, epoch 7, cost -75.1771260834
Pre-training layer 2, epoch 8, cost -74.0329271062
Pre-training layer 2, epoch 9, cost -73.1713663356
Pre-training layer 2, epoch 10, cost -72.3275099564
Pre-training layer 2, epoch 10, representative training free energy 6118.07197705
Pre-training layer 2, epoch 10, validation free energy 6068.05495166
Pre-training layer 2, epoch 11, cost -71.7697132238
Pre-training layer 2, epoch 12, cost -71.1247957102
Pre-training layer 2, epoch 13, cost -70.588282191
Pre-training layer 2, epoch 14, cost -70.1076793416
Pre-training layer 2, epoch 15, cost -69.5954295095
Pre-training layer 2, epoch 15, representative training free energy 6852.0702583
Pre-training layer 2, epoch 15, validation free energy 6791.64050586
Pre-training layer 2, epoch 16, cost -69.3165046183
Pre-training layer 2, epoch 17, cost -68.91238753
Pre-training layer 2, epoch 18, cost -68.7777834702
Pre-training layer 2, epoch 19, cost -68.3438503011
Pre-training layer 2, epoch 20, cost -68.0541280492
Pre-training layer 2, epoch 20, representative training free energy 7378.21841602
Pre-training layer 2, epoch 20, validation free energy 7311.64689453
Pre-training layer 2, epoch 21, cost -67.7958365122
Pre-training layer 2, epoch 22, cost -67.5801587168
Pre-training layer 2, epoch 23, cost -67.3567922338
Pre-training layer 2, epoch 24, cost -67.1541633987
Pre-training layer 2, epoch 25, cost -66.9743211365
Pre-training layer 2, epoch 25, representative training free energy 7868.7726084
Pre-training layer 2, epoch 25, validation free energy 7797.48824805
Pre-training layer 2, epoch 26, cost -66.8114725876
Pre-training layer 2, epoch 27, cost -66.4936213684
Pre-training layer 2, epoch 28, cost -66.4840998077
Pre-training layer 2, epoch 29, cost -66.2886912028
Pre-training layer 2, epoch 30, cost -66.1716760381
Pre-training layer 2, epoch 30, representative training free energy 8288.78583984
Pre-training layer 2, epoch 30, validation free energy 8213.24384277
Pre-training layer 2, epoch 31, cost -66.0033704376
Pre-training layer 2, epoch 32, cost -65.9098627981
Pre-training layer 2, epoch 33, cost -65.8603369649
Pre-training layer 2, epoch 34, cost -65.7217097727
Pre-training layer 2, epoch 35, cost -65.5433569463
Pre-training layer 2, epoch 35, representative training free energy 8655.54207617
Pre-training layer 2, epoch 35, validation free energy 8576.14697021
Pre-training layer 2, epoch 36, cost -65.3970510101
Pre-training layer 2, epoch 37, cost -65.3641173172
Pre-training layer 2, epoch 38, cost -65.2908582179
Pre-training layer 2, epoch 39, cost -65.197202975
Pre-training layer 2, epoch 40, cost -65.1586642075
Pre-training layer 2, epoch 40, representative training free energy 8974.62208105
Pre-training layer 2, epoch 40, validation free energy 8892.06927734
Pre-training layer 2, epoch 41, cost -64.8976595179
Pre-training layer 2, epoch 42, cost -64.9663125483
Pre-training layer 2, epoch 43, cost -64.790865682
Pre-training layer 2, epoch 44, cost -64.7587675985
Pre-training layer 2, epoch 45, cost -64.6620864614
Pre-training layer 2, epoch 45, representative training free energy 9295.35921631
Pre-training layer 2, epoch 45, validation free energy 9209.84977197
Pre-training layer 2, epoch 46, cost -64.7183750025
Pre-training layer 2, epoch 47, cost -64.4353544617
Pre-training layer 2, epoch 48, cost -64.409280014
Pre-training layer 2, epoch 49, cost -64.3717036947
Pre-training layer 2, epoch 50, cost -64.3704052353
Pre-training layer 2, epoch 50, representative training free energy 9595.20913916
Pre-training layer 2, epoch 50, validation free energy 9506.39644141
Pre-training layer 2, epoch 51, cost -64.1923372269
Pre-training layer 2, epoch 52, cost -64.2218112564
Pre-training layer 2, epoch 53, cost -64.1726843007
Pre-training layer 2, epoch 54, cost -64.1092747879
Pre-training layer 2, epoch 55, cost -63.9552885691
Pre-training layer 2, epoch 55, representative training free energy 9867.86681494
Pre-training layer 2, epoch 55, validation free energy 9776.36925537
Pre-training layer 2, epoch 56, cost -63.9663201396
Pre-training layer 2, epoch 57, cost -64.016313769
Pre-training layer 2, epoch 58, cost -63.8331610235
Pre-training layer 2, epoch 59, cost -63.8017312749
Pre-training layer 2, epoch 60, cost -63.8001929474
Pre-training layer 2, epoch 60, representative training free energy 10127.7095708
Pre-training layer 2, epoch 60, validation free energy 10033.6269634
Pre-training layer 2, epoch 61, cost -63.7953364309
Pre-training layer 2, epoch 62, cost -63.6711533864
Pre-training layer 2, epoch 63, cost -63.5667118963
Pre-training layer 2, epoch 64, cost -63.6288415273
Pre-training layer 2, epoch 65, cost -63.5805619176
Pre-training layer 2, epoch 65, representative training free energy 10378.5565117
Pre-training layer 2, epoch 65, validation free energy 10281.772293
Pre-training layer 2, epoch 66, cost -63.5360265732
Pre-training layer 2, epoch 67, cost -63.4696376928
Pre-training layer 2, epoch 68, cost -63.4897256724
Pre-training layer 2, epoch 69, cost -63.3852296321
Pre-training layer 2, epoch 70, cost -63.3935883077
Pre-training layer 2, epoch 70, representative training free energy 10625.8589062
Pre-training layer 2, epoch 70, validation free energy 10526.7252759
Pre-training layer 2, epoch 71, cost -63.2550171916
Pre-training layer 2, epoch 72, cost -63.2618467077
Pre-training layer 2, epoch 73, cost -63.3099802399
Pre-training layer 2, epoch 74, cost -63.2602943293
Pre-training layer 2, epoch 75, cost -63.2815117264
Pre-training layer 2, epoch 75, representative training free energy 10834.1494653
Pre-training layer 2, epoch 75, validation free energy 10732.5079556
Pre-training layer 2, epoch 76, cost -63.1425134659
Pre-training layer 2, epoch 77, cost -63.0969024022
Pre-training layer 2, epoch 78, cost -63.0834938176
Pre-training layer 2, epoch 79, cost -63.0784188461
Pre-training layer 2, epoch 80, cost -63.1146192678
Pre-training layer 2, epoch 80, representative training free energy 11066.8581582
Pre-training layer 2, epoch 80, validation free energy 10962.8484604
Pre-training layer 2, epoch 81, cost -63.002701683
Pre-training layer 2, epoch 82, cost -62.9949033356
Pre-training layer 2, epoch 83, cost -63.0720926793
Pre-training layer 2, epoch 84, cost -62.9330947876
Pre-training layer 2, epoch 85, cost -62.9868950144
Pre-training layer 2, epoch 85, representative training free energy 11258.2454517
Pre-training layer 2, epoch 85, validation free energy 11152.3383271
Pre-training layer 2, epoch 86, cost -62.9094655991
Pre-training layer 2, epoch 87, cost -62.8450870387
Pre-training layer 2, epoch 88, cost -62.9945174662
Pre-training layer 2, epoch 89, cost -62.8624073919
Pre-training layer 2, epoch 90, cost -62.8198794937
Pre-training layer 2, epoch 90, representative training free energy 11492.5428594
Pre-training layer 2, epoch 90, validation free energy 11383.9684653
Pre-training layer 2, epoch 91, cost -62.8489236069
Pre-training layer 2, epoch 92, cost -62.747711614
Pre-training layer 2, epoch 93, cost -62.7316751226
Pre-training layer 2, epoch 94, cost -62.7217916743
Pre-training layer 2, epoch 95, cost -62.5978779348
Pre-training layer 2, epoch 95, representative training free energy 11697.1994854
Pre-training layer 2, epoch 95, validation free energy 11585.5249526
Pre-training layer 2, epoch 96, cost -62.740780042
Pre-training layer 2, epoch 97, cost -62.6223235067
Pre-training layer 2, epoch 98, cost -62.6075449498
Pre-training layer 2, epoch 99, cost -62.6319361369
The pretraining code for file dbn_loop.pyc ran for 7.85m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 32.400000 %
     epoch 1, minibatch 300/300, test error of best model 29.000000 %
epoch 2, minibatch 300/300, validation error 27.800000 %
     epoch 2, minibatch 300/300, test error of best model 19.200000 %
epoch 3, minibatch 300/300, validation error 25.200000 %
     epoch 3, minibatch 300/300, test error of best model 15.600000 %
epoch 4, minibatch 300/300, validation error 23.600000 %
     epoch 4, minibatch 300/300, test error of best model 13.800000 %
epoch 5, minibatch 300/300, validation error 22.000000 %
     epoch 5, minibatch 300/300, test error of best model 11.200000 %
epoch 6, minibatch 300/300, validation error 20.800000 %
     epoch 6, minibatch 300/300, test error of best model 10.800000 %
epoch 7, minibatch 300/300, validation error 20.200000 %
     epoch 7, minibatch 300/300, test error of best model 9.600000 %
epoch 8, minibatch 300/300, validation error 19.200000 %
     epoch 8, minibatch 300/300, test error of best model 9.000000 %
epoch 9, minibatch 300/300, validation error 18.600000 %
     epoch 9, minibatch 300/300, test error of best model 8.600000 %
epoch 10, minibatch 300/300, validation error 18.400000 %
     epoch 10, minibatch 300/300, test error of best model 8.000000 %
epoch 11, minibatch 300/300, validation error 18.000000 %
     epoch 11, minibatch 300/300, test error of best model 7.400000 %
epoch 12, minibatch 300/300, validation error 17.600000 %
     epoch 12, minibatch 300/300, test error of best model 7.600000 %
epoch 13, minibatch 300/300, validation error 17.400000 %
     epoch 13, minibatch 300/300, test error of best model 7.400000 %
epoch 14, minibatch 300/300, validation error 17.400000 %
epoch 15, minibatch 300/300, validation error 17.600000 %
epoch 16, minibatch 300/300, validation error 17.200000 %
     epoch 16, minibatch 300/300, test error of best model 6.600000 %
epoch 17, minibatch 300/300, validation error 17.000000 %
     epoch 17, minibatch 300/300, test error of best model 6.600000 %
epoch 18, minibatch 300/300, validation error 17.200000 %
epoch 19, minibatch 300/300, validation error 17.200000 %
epoch 20, minibatch 300/300, validation error 17.400000 %
epoch 21, minibatch 300/300, validation error 17.600000 %
epoch 22, minibatch 300/300, validation error 17.600000 %
epoch 23, minibatch 300/300, validation error 17.200000 %
epoch 24, minibatch 300/300, validation error 17.400000 %
epoch 25, minibatch 300/300, validation error 17.400000 %
epoch 26, minibatch 300/300, validation error 17.400000 %
epoch 27, minibatch 300/300, validation error 17.400000 %
epoch 28, minibatch 300/300, validation error 17.400000 %
epoch 29, minibatch 300/300, validation error 17.200000 %
epoch 30, minibatch 300/300, validation error 17.200000 %
epoch 31, minibatch 300/300, validation error 17.000000 %
epoch 32, minibatch 300/300, validation error 16.800000 %
     epoch 32, minibatch 300/300, test error of best model 6.400000 %
epoch 33, minibatch 300/300, validation error 16.400000 %
     epoch 33, minibatch 300/300, test error of best model 6.200000 %
epoch 34, minibatch 300/300, validation error 16.000000 %
     epoch 34, minibatch 300/300, test error of best model 6.400000 %
epoch 35, minibatch 300/300, validation error 16.000000 %
epoch 36, minibatch 300/300, validation error 16.000000 %
epoch 37, minibatch 300/300, validation error 16.000000 %
epoch 38, minibatch 300/300, validation error 16.000000 %
epoch 39, minibatch 300/300, validation error 16.000000 %
epoch 40, minibatch 300/300, validation error 16.000000 %
epoch 41, minibatch 300/300, validation error 16.000000 %
epoch 42, minibatch 300/300, validation error 16.000000 %
epoch 43, minibatch 300/300, validation error 16.000000 %
epoch 44, minibatch 300/300, validation error 15.800000 %
     epoch 44, minibatch 300/300, test error of best model 6.200000 %
epoch 45, minibatch 300/300, validation error 15.800000 %
epoch 46, minibatch 300/300, validation error 15.800000 %
epoch 47, minibatch 300/300, validation error 15.800000 %
epoch 48, minibatch 300/300, validation error 15.800000 %
epoch 49, minibatch 300/300, validation error 15.800000 %
epoch 50, minibatch 300/300, validation error 15.800000 %
epoch 51, minibatch 300/300, validation error 15.800000 %
epoch 52, minibatch 300/300, validation error 15.800000 %
epoch 53, minibatch 300/300, validation error 15.600000 %
     epoch 53, minibatch 300/300, test error of best model 6.600000 %
epoch 54, minibatch 300/300, validation error 15.600000 %
epoch 55, minibatch 300/300, validation error 15.600000 %
epoch 56, minibatch 300/300, validation error 15.600000 %
epoch 57, minibatch 300/300, validation error 15.600000 %
epoch 58, minibatch 300/300, validation error 15.600000 %
epoch 59, minibatch 300/300, validation error 15.600000 %
epoch 60, minibatch 300/300, validation error 15.600000 %
epoch 61, minibatch 300/300, validation error 15.600000 %
epoch 62, minibatch 300/300, validation error 15.600000 %
epoch 63, minibatch 300/300, validation error 15.600000 %
epoch 64, minibatch 300/300, validation error 15.800000 %
epoch 65, minibatch 300/300, validation error 15.800000 %
epoch 66, minibatch 300/300, validation error 15.800000 %
epoch 67, minibatch 300/300, validation error 15.800000 %
epoch 68, minibatch 300/300, validation error 16.000000 %
epoch 69, minibatch 300/300, validation error 16.000000 %
epoch 70, minibatch 300/300, validation error 16.000000 %
epoch 71, minibatch 300/300, validation error 16.000000 %
epoch 72, minibatch 300/300, validation error 16.000000 %
epoch 73, minibatch 300/300, validation error 16.000000 %
epoch 74, minibatch 300/300, validation error 16.000000 %
epoch 75, minibatch 300/300, validation error 16.000000 %
epoch 76, minibatch 300/300, validation error 16.000000 %
epoch 77, minibatch 300/300, validation error 16.000000 %
epoch 78, minibatch 300/300, validation error 16.000000 %
epoch 79, minibatch 300/300, validation error 16.000000 %
epoch 80, minibatch 300/300, validation error 16.000000 %
epoch 81, minibatch 300/300, validation error 16.000000 %
epoch 82, minibatch 300/300, validation error 16.000000 %
epoch 83, minibatch 300/300, validation error 16.000000 %
epoch 84, minibatch 300/300, validation error 16.000000 %
epoch 85, minibatch 300/300, validation error 16.000000 %
epoch 86, minibatch 300/300, validation error 16.000000 %
epoch 87, minibatch 300/300, validation error 16.000000 %
epoch 88, minibatch 300/300, validation error 16.000000 %
epoch 89, minibatch 300/300, validation error 16.000000 %
epoch 90, minibatch 300/300, validation error 16.000000 %
epoch 91, minibatch 300/300, validation error 16.000000 %
epoch 92, minibatch 300/300, validation error 16.000000 %
epoch 93, minibatch 300/300, validation error 16.000000 %
epoch 94, minibatch 300/300, validation error 16.000000 %
epoch 95, minibatch 300/300, validation error 16.000000 %
epoch 96, minibatch 300/300, validation error 16.000000 %
epoch 97, minibatch 300/300, validation error 16.000000 %
epoch 98, minibatch 300/300, validation error 16.000000 %
epoch 99, minibatch 300/300, validation error 16.000000 %
epoch 100, minibatch 300/300, validation error 16.000000 %
epoch 101, minibatch 300/300, validation error 16.000000 %
epoch 102, minibatch 300/300, validation error 16.200000 %
epoch 103, minibatch 300/300, validation error 16.200000 %
epoch 104, minibatch 300/300, validation error 16.200000 %
epoch 105, minibatch 300/300, validation error 16.200000 %
Optimization complete with best validation score of 15.600000 %, obtained at iteration 15900, with test performance 6.600000 %
The fine tuning code for file dbn_loop.pyc ran for 2.58m


==========Sample: (4000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.458182774
Pre-training layer 0, epoch 0, representative training free energy -549.888542236
Pre-training layer 0, epoch 0, validation free energy -544.274489868
Pre-training layer 0, epoch 1, cost -112.071692734
Pre-training layer 0, epoch 2, cost -103.710752983
Pre-training layer 0, epoch 3, cost -98.9046493721
Pre-training layer 0, epoch 4, cost -95.8460074234
Pre-training layer 0, epoch 5, cost -93.473795681
Pre-training layer 0, epoch 5, representative training free energy -493.146370605
Pre-training layer 0, epoch 5, validation free energy -486.09114325
Pre-training layer 0, epoch 6, cost -91.5714120293
Pre-training layer 0, epoch 7, cost -90.0145980263
Pre-training layer 0, epoch 8, cost -88.9005750847
Pre-training layer 0, epoch 9, cost -87.8616975689
Pre-training layer 0, epoch 10, cost -86.8576616955
Pre-training layer 0, epoch 10, representative training free energy -474.385921143
Pre-training layer 0, epoch 10, validation free energy -467.090236206
Pre-training layer 0, epoch 11, cost -86.0186938667
Pre-training layer 0, epoch 12, cost -85.2904186344
Pre-training layer 0, epoch 13, cost -84.7468353271
Pre-training layer 0, epoch 14, cost -84.1587457561
Pre-training layer 0, epoch 15, cost -83.7050967979
Pre-training layer 0, epoch 15, representative training free energy -456.596410889
Pre-training layer 0, epoch 15, validation free energy -448.767911438
Pre-training layer 0, epoch 16, cost -83.0872931862
Pre-training layer 0, epoch 17, cost -82.6264794159
Pre-training layer 0, epoch 18, cost -82.3870010567
Pre-training layer 0, epoch 19, cost -82.0029484177
Pre-training layer 0, epoch 20, cost -81.54470397
Pre-training layer 0, epoch 20, representative training free energy -450.791654907
Pre-training layer 0, epoch 20, validation free energy -441.828606689
Pre-training layer 0, epoch 21, cost -81.3705442524
Pre-training layer 0, epoch 22, cost -80.9303096867
Pre-training layer 0, epoch 23, cost -80.6185477161
Pre-training layer 0, epoch 24, cost -80.3582923794
Pre-training layer 0, epoch 25, cost -80.0234557152
Pre-training layer 0, epoch 25, representative training free energy -445.16593573
Pre-training layer 0, epoch 25, validation free energy -436.55052948
Pre-training layer 0, epoch 26, cost -79.8583756828
Pre-training layer 0, epoch 27, cost -79.6364155388
Pre-training layer 0, epoch 28, cost -79.3338346386
Pre-training layer 0, epoch 29, cost -79.1635887909
Pre-training layer 0, epoch 30, cost -78.9596389103
Pre-training layer 0, epoch 30, representative training free energy -443.263590515
Pre-training layer 0, epoch 30, validation free energy -434.567735657
Pre-training layer 0, epoch 31, cost -78.7791536522
Pre-training layer 0, epoch 32, cost -78.5836519814
Pre-training layer 0, epoch 33, cost -78.4057003307
Pre-training layer 0, epoch 34, cost -78.2370921135
Pre-training layer 0, epoch 35, cost -78.2047853851
Pre-training layer 0, epoch 35, representative training free energy -439.063460266
Pre-training layer 0, epoch 35, validation free energy -429.776863831
Pre-training layer 0, epoch 36, cost -77.9301137543
Pre-training layer 0, epoch 37, cost -77.7310530853
Pre-training layer 0, epoch 38, cost -77.7317598248
Pre-training layer 0, epoch 39, cost -77.4741701889
Pre-training layer 0, epoch 40, cost -77.3666187572
Pre-training layer 0, epoch 40, representative training free energy -435.54481311
Pre-training layer 0, epoch 40, validation free energy -426.087998413
Pre-training layer 0, epoch 41, cost -77.1010303974
Pre-training layer 0, epoch 42, cost -77.0274572945
Pre-training layer 0, epoch 43, cost -76.9285659885
Pre-training layer 0, epoch 44, cost -76.847395525
Pre-training layer 0, epoch 45, cost -76.8345483875
Pre-training layer 0, epoch 45, representative training free energy -434.614479187
Pre-training layer 0, epoch 45, validation free energy -424.544088684
Pre-training layer 0, epoch 46, cost -76.535951519
Pre-training layer 0, epoch 47, cost -76.5198886204
Pre-training layer 0, epoch 48, cost -76.4371088219
Pre-training layer 0, epoch 49, cost -76.1483637333
Pre-training layer 0, epoch 50, cost -76.1511028671
Pre-training layer 0, epoch 50, representative training free energy -433.367505737
Pre-training layer 0, epoch 50, validation free energy -423.826724609
Pre-training layer 0, epoch 51, cost -76.046831398
Pre-training layer 0, epoch 52, cost -76.0295587921
Pre-training layer 0, epoch 53, cost -75.841639204
Pre-training layer 0, epoch 54, cost -75.7350800896
Pre-training layer 0, epoch 55, cost -75.7244863033
Pre-training layer 0, epoch 55, representative training free energy -431.964115051
Pre-training layer 0, epoch 55, validation free energy -422.11895166
Pre-training layer 0, epoch 56, cost -75.5164912891
Pre-training layer 0, epoch 57, cost -75.422411871
Pre-training layer 0, epoch 58, cost -75.3718226433
Pre-training layer 0, epoch 59, cost -75.3569465637
Pre-training layer 0, epoch 60, cost -75.188630228
Pre-training layer 0, epoch 60, representative training free energy -429.664167603
Pre-training layer 0, epoch 60, validation free energy -419.923989014
Pre-training layer 0, epoch 61, cost -75.107821722
Pre-training layer 0, epoch 62, cost -75.0129413128
Pre-training layer 0, epoch 63, cost -75.0709183025
Pre-training layer 0, epoch 64, cost -74.9779464245
Pre-training layer 0, epoch 65, cost -74.7984602165
Pre-training layer 0, epoch 65, representative training free energy -430.127725281
Pre-training layer 0, epoch 65, validation free energy -419.993112305
Pre-training layer 0, epoch 66, cost -74.7538072777
Pre-training layer 0, epoch 67, cost -74.783663435
Pre-training layer 0, epoch 68, cost -74.6442903233
Pre-training layer 0, epoch 69, cost -74.633227644
Pre-training layer 0, epoch 70, cost -74.5840453529
Pre-training layer 0, epoch 70, representative training free energy -427.269902344
Pre-training layer 0, epoch 70, validation free energy -417.191618164
Pre-training layer 0, epoch 71, cost -74.4095521927
Pre-training layer 0, epoch 72, cost -74.4186545753
Pre-training layer 0, epoch 73, cost -74.3737714195
Pre-training layer 0, epoch 74, cost -74.3114217949
Pre-training layer 0, epoch 75, cost -74.161912241
Pre-training layer 0, epoch 75, representative training free energy -427.835735474
Pre-training layer 0, epoch 75, validation free energy -417.489815491
Pre-training layer 0, epoch 76, cost -74.1225019741
Pre-training layer 0, epoch 77, cost -74.132167244
Pre-training layer 0, epoch 78, cost -74.0049880981
Pre-training layer 0, epoch 79, cost -73.9834496403
Pre-training layer 0, epoch 80, cost -73.8309840488
Pre-training layer 0, epoch 80, representative training free energy -427.262347717
Pre-training layer 0, epoch 80, validation free energy -416.739877502
Pre-training layer 0, epoch 81, cost -73.8117298985
Pre-training layer 0, epoch 82, cost -73.8677873421
Pre-training layer 0, epoch 83, cost -73.7251638889
Pre-training layer 0, epoch 84, cost -73.5848556614
Pre-training layer 0, epoch 85, cost -73.6119020939
Pre-training layer 0, epoch 85, representative training free energy -423.332135376
Pre-training layer 0, epoch 85, validation free energy -412.93039447
Pre-training layer 0, epoch 86, cost -73.4560523891
Pre-training layer 0, epoch 87, cost -73.4142076206
Pre-training layer 0, epoch 88, cost -73.4390181828
Pre-training layer 0, epoch 89, cost -73.4056342793
Pre-training layer 0, epoch 90, cost -73.3584328175
Pre-training layer 0, epoch 90, representative training free energy -421.432197327
Pre-training layer 0, epoch 90, validation free energy -410.485871399
Pre-training layer 0, epoch 91, cost -73.34565938
Pre-training layer 0, epoch 92, cost -73.289133749
Pre-training layer 0, epoch 93, cost -73.2403678799
Pre-training layer 0, epoch 94, cost -73.2498834991
Pre-training layer 0, epoch 95, cost -73.1198816395
Pre-training layer 0, epoch 95, representative training free energy -423.137220581
Pre-training layer 0, epoch 95, validation free energy -412.080937195
Pre-training layer 0, epoch 96, cost -73.0474885273
Pre-training layer 0, epoch 97, cost -73.0761966896
Pre-training layer 0, epoch 98, cost -73.0321985054
Pre-training layer 0, epoch 99, cost -72.9281609917
Pre-training layer 1, epoch 0, cost -324.022660713
Pre-training layer 1, epoch 0, representative training free energy -56823.5085547
Pre-training layer 1, epoch 0, validation free energy -56299.4911367
Pre-training layer 1, epoch 1, cost -278.317570953
Pre-training layer 1, epoch 2, cost -264.316949463
Pre-training layer 1, epoch 3, cost -256.177421341
Pre-training layer 1, epoch 4, cost -250.537228889
Pre-training layer 1, epoch 5, cost -246.42664135
Pre-training layer 1, epoch 5, representative training free energy -75982.3455
Pre-training layer 1, epoch 5, validation free energy -75300.1636445
Pre-training layer 1, epoch 6, cost -243.312569504
Pre-training layer 1, epoch 7, cost -240.878863792
Pre-training layer 1, epoch 8, cost -238.668092499
Pre-training layer 1, epoch 9, cost -236.862109222
Pre-training layer 1, epoch 10, cost -235.321628265
Pre-training layer 1, epoch 10, representative training free energy -81908.5189375
Pre-training layer 1, epoch 10, validation free energy -81171.6809727
Pre-training layer 1, epoch 11, cost -233.968756104
Pre-training layer 1, epoch 12, cost -232.902738647
Pre-training layer 1, epoch 13, cost -231.754532471
Pre-training layer 1, epoch 14, cost -230.956995697
Pre-training layer 1, epoch 15, cost -230.181950569
Pre-training layer 1, epoch 15, representative training free energy -85334.5206797
Pre-training layer 1, epoch 15, validation free energy -84568.1925742
Pre-training layer 1, epoch 16, cost -229.376907692
Pre-training layer 1, epoch 17, cost -228.774470711
Pre-training layer 1, epoch 18, cost -228.038234596
Pre-training layer 1, epoch 19, cost -227.384006195
Pre-training layer 1, epoch 20, cost -226.935582466
Pre-training layer 1, epoch 20, representative training free energy -87817.6638047
Pre-training layer 1, epoch 20, validation free energy -87021.5728555
Pre-training layer 1, epoch 21, cost -226.500825119
Pre-training layer 1, epoch 22, cost -226.159039307
Pre-training layer 1, epoch 23, cost -225.57921299
Pre-training layer 1, epoch 24, cost -225.173539658
Pre-training layer 1, epoch 25, cost -224.8486343
Pre-training layer 1, epoch 25, representative training free energy -89746.5059844
Pre-training layer 1, epoch 25, validation free energy -88944.4130664
Pre-training layer 1, epoch 26, cost -224.518246498
Pre-training layer 1, epoch 27, cost -224.102277908
Pre-training layer 1, epoch 28, cost -223.793004341
Pre-training layer 1, epoch 29, cost -223.485022392
Pre-training layer 1, epoch 30, cost -223.219608307
Pre-training layer 1, epoch 30, representative training free energy -91266.9122305
Pre-training layer 1, epoch 30, validation free energy -90446.0140586
Pre-training layer 1, epoch 31, cost -223.087011528
Pre-training layer 1, epoch 32, cost -222.715430717
Pre-training layer 1, epoch 33, cost -222.468473701
Pre-training layer 1, epoch 34, cost -222.196004982
Pre-training layer 1, epoch 35, cost -222.053274727
Pre-training layer 1, epoch 35, representative training free energy -92669.0843633
Pre-training layer 1, epoch 35, validation free energy -91838.2832656
Pre-training layer 1, epoch 36, cost -221.747160683
Pre-training layer 1, epoch 37, cost -221.526805382
Pre-training layer 1, epoch 38, cost -221.464410095
Pre-training layer 1, epoch 39, cost -221.261939735
Pre-training layer 1, epoch 40, cost -220.995786514
Pre-training layer 1, epoch 40, representative training free energy -93915.2068984
Pre-training layer 1, epoch 40, validation free energy -93073.6933555
Pre-training layer 1, epoch 41, cost -220.907810898
Pre-training layer 1, epoch 42, cost -220.64797657
Pre-training layer 1, epoch 43, cost -220.555220795
Pre-training layer 1, epoch 44, cost -220.322742043
Pre-training layer 1, epoch 45, cost -220.183911362
Pre-training layer 1, epoch 45, representative training free energy -95025.1933437
Pre-training layer 1, epoch 45, validation free energy -94173.6818242
Pre-training layer 1, epoch 46, cost -220.06262867
Pre-training layer 1, epoch 47, cost -219.94068718
Pre-training layer 1, epoch 48, cost -219.825083008
Pre-training layer 1, epoch 49, cost -219.66554493
Pre-training layer 1, epoch 50, cost -219.509430313
Pre-training layer 1, epoch 50, representative training free energy -96129.0382148
Pre-training layer 1, epoch 50, validation free energy -95268.2462188
Pre-training layer 1, epoch 51, cost -219.398702469
Pre-training layer 1, epoch 52, cost -219.193633385
Pre-training layer 1, epoch 53, cost -219.13009243
Pre-training layer 1, epoch 54, cost -219.160577698
Pre-training layer 1, epoch 55, cost -218.954273224
Pre-training layer 1, epoch 55, representative training free energy -96919.4666719
Pre-training layer 1, epoch 55, validation free energy -96047.3958633
Pre-training layer 1, epoch 56, cost -218.775445175
Pre-training layer 1, epoch 57, cost -218.700834885
Pre-training layer 1, epoch 58, cost -218.704726181
Pre-training layer 1, epoch 59, cost -218.485996323
Pre-training layer 1, epoch 60, cost -218.386962013
Pre-training layer 1, epoch 60, representative training free energy -97782.4129141
Pre-training layer 1, epoch 60, validation free energy -96903.3413086
Pre-training layer 1, epoch 61, cost -218.287884789
Pre-training layer 1, epoch 62, cost -218.218717766
Pre-training layer 1, epoch 63, cost -218.062286034
Pre-training layer 1, epoch 64, cost -217.940821381
Pre-training layer 1, epoch 65, cost -217.833642807
Pre-training layer 1, epoch 65, representative training free energy -98433.6682578
Pre-training layer 1, epoch 65, validation free energy -97545.0982031
Pre-training layer 1, epoch 66, cost -217.821870155
Pre-training layer 1, epoch 67, cost -217.683126144
Pre-training layer 1, epoch 68, cost -217.710532837
Pre-training layer 1, epoch 69, cost -217.559506569
Pre-training layer 1, epoch 70, cost -217.41319973
Pre-training layer 1, epoch 70, representative training free energy -99159.5472344
Pre-training layer 1, epoch 70, validation free energy -98263.0429219
Pre-training layer 1, epoch 71, cost -217.386887512
Pre-training layer 1, epoch 72, cost -217.291099052
Pre-training layer 1, epoch 73, cost -217.190816803
Pre-training layer 1, epoch 74, cost -217.147806778
Pre-training layer 1, epoch 75, cost -217.050217857
Pre-training layer 1, epoch 75, representative training free energy -99837.5657266
Pre-training layer 1, epoch 75, validation free energy -98936.8963828
Pre-training layer 1, epoch 76, cost -216.97735569
Pre-training layer 1, epoch 77, cost -216.930670204
Pre-training layer 1, epoch 78, cost -216.845422516
Pre-training layer 1, epoch 79, cost -216.656798286
Pre-training layer 1, epoch 80, cost -216.6883181
Pre-training layer 1, epoch 80, representative training free energy -100480.040242
Pre-training layer 1, epoch 80, validation free energy -99575.7194375
Pre-training layer 1, epoch 81, cost -216.669928017
Pre-training layer 1, epoch 82, cost -216.515349579
Pre-training layer 1, epoch 83, cost -216.456729736
Pre-training layer 1, epoch 84, cost -216.48898262
Pre-training layer 1, epoch 85, cost -216.343397903
Pre-training layer 1, epoch 85, representative training free energy -101051.433617
Pre-training layer 1, epoch 85, validation free energy -100133.757117
Pre-training layer 1, epoch 86, cost -216.278526459
Pre-training layer 1, epoch 87, cost -216.24295002
Pre-training layer 1, epoch 88, cost -216.297356567
Pre-training layer 1, epoch 89, cost -216.149901009
Pre-training layer 1, epoch 90, cost -216.110597305
Pre-training layer 1, epoch 90, representative training free energy -101629.946938
Pre-training layer 1, epoch 90, validation free energy -100712.347891
Pre-training layer 1, epoch 91, cost -216.083450737
Pre-training layer 1, epoch 92, cost -216.021941948
Pre-training layer 1, epoch 93, cost -215.909467659
Pre-training layer 1, epoch 94, cost -215.931284218
Pre-training layer 1, epoch 95, cost -215.831111526
Pre-training layer 1, epoch 95, representative training free energy -102180.514555
Pre-training layer 1, epoch 95, validation free energy -101251.723766
Pre-training layer 1, epoch 96, cost -215.753727531
Pre-training layer 1, epoch 97, cost -215.727884941
Pre-training layer 1, epoch 98, cost -215.605910797
Pre-training layer 1, epoch 99, cost -215.7029422
Pre-training layer 2, epoch 0, cost -120.318943062
Pre-training layer 2, epoch 0, representative training free energy 3532.50612183
Pre-training layer 2, epoch 0, validation free energy 3511.45149561
Pre-training layer 2, epoch 1, cost -89.825394659
Pre-training layer 2, epoch 2, cost -83.1750128841
Pre-training layer 2, epoch 3, cost -79.4135554123
Pre-training layer 2, epoch 4, cost -76.9006067562
Pre-training layer 2, epoch 5, cost -75.16852108
Pre-training layer 2, epoch 5, representative training free energy 5916.29157227
Pre-training layer 2, epoch 5, validation free energy 5864.86283398
Pre-training layer 2, epoch 6, cost -73.7444948101
Pre-training layer 2, epoch 7, cost -72.6802459145
Pre-training layer 2, epoch 8, cost -71.6954463291
Pre-training layer 2, epoch 9, cost -70.862722311
Pre-training layer 2, epoch 10, cost -70.162293663
Pre-training layer 2, epoch 10, representative training free energy 7069.37698828
Pre-training layer 2, epoch 10, validation free energy 7006.68609033
Pre-training layer 2, epoch 11, cost -69.5839495945
Pre-training layer 2, epoch 12, cost -69.0633234501
Pre-training layer 2, epoch 13, cost -68.6267753029
Pre-training layer 2, epoch 14, cost -68.2462561035
Pre-training layer 2, epoch 15, cost -67.8651858902
Pre-training layer 2, epoch 15, representative training free energy 7905.26169141
Pre-training layer 2, epoch 15, validation free energy 7832.68785352
Pre-training layer 2, epoch 16, cost -67.3976774693
Pre-training layer 2, epoch 17, cost -67.2306801701
Pre-training layer 2, epoch 18, cost -66.869009943
Pre-training layer 2, epoch 19, cost -66.7080071735
Pre-training layer 2, epoch 20, cost -66.3855949402
Pre-training layer 2, epoch 20, representative training free energy 8593.79763428
Pre-training layer 2, epoch 20, validation free energy 8513.58626611
Pre-training layer 2, epoch 21, cost -66.1911393929
Pre-training layer 2, epoch 22, cost -65.88564641
Pre-training layer 2, epoch 23, cost -65.8806972885
Pre-training layer 2, epoch 24, cost -65.6344992256
Pre-training layer 2, epoch 25, cost -65.4310838032
Pre-training layer 2, epoch 25, representative training free energy 9145.56868115
Pre-training layer 2, epoch 25, validation free energy 9059.84156201
Pre-training layer 2, epoch 26, cost -65.2814126778
Pre-training layer 2, epoch 27, cost -65.1295038223
Pre-training layer 2, epoch 28, cost -65.0615326786
Pre-training layer 2, epoch 29, cost -64.8461180973
Pre-training layer 2, epoch 30, cost -64.7515502167
Pre-training layer 2, epoch 30, representative training free energy 9643.62166309
Pre-training layer 2, epoch 30, validation free energy 9551.02750732
Pre-training layer 2, epoch 31, cost -64.6470950794
Pre-training layer 2, epoch 32, cost -64.5361710453
Pre-training layer 2, epoch 33, cost -64.3891765022
Pre-training layer 2, epoch 34, cost -64.255222702
Pre-training layer 2, epoch 35, cost -64.2975004768
Pre-training layer 2, epoch 35, representative training free energy 10076.9716533
Pre-training layer 2, epoch 35, validation free energy 9979.02490381
Pre-training layer 2, epoch 36, cost -64.1644864941
Pre-training layer 2, epoch 37, cost -64.0231777382
Pre-training layer 2, epoch 38, cost -64.0415038013
Pre-training layer 2, epoch 39, cost -63.9880757046
Pre-training layer 2, epoch 40, cost -63.8369343281
Pre-training layer 2, epoch 40, representative training free energy 10521.4931948
Pre-training layer 2, epoch 40, validation free energy 10420.6975527
Pre-training layer 2, epoch 41, cost -63.7026305676
Pre-training layer 2, epoch 42, cost -63.6109228611
Pre-training layer 2, epoch 43, cost -63.5995713043
Pre-training layer 2, epoch 44, cost -63.5862718391
Pre-training layer 2, epoch 45, cost -63.4710989857
Pre-training layer 2, epoch 45, representative training free energy 10855.1809194
Pre-training layer 2, epoch 45, validation free energy 10750.7201094
Pre-training layer 2, epoch 46, cost -63.4975677681
Pre-training layer 2, epoch 47, cost -63.3551296329
Pre-training layer 2, epoch 48, cost -63.4086828041
Pre-training layer 2, epoch 49, cost -63.156070261
Pre-training layer 2, epoch 50, cost -63.1660423183
Pre-training layer 2, epoch 50, representative training free energy 11219.9575449
Pre-training layer 2, epoch 50, validation free energy 11112.4937041
Pre-training layer 2, epoch 51, cost -63.13743083
Pre-training layer 2, epoch 52, cost -63.053440237
Pre-training layer 2, epoch 53, cost -62.982407093
Pre-training layer 2, epoch 54, cost -62.9795353603
Pre-training layer 2, epoch 55, cost -62.9852403259
Pre-training layer 2, epoch 55, representative training free energy 11515.9709746
Pre-training layer 2, epoch 55, validation free energy 11403.5201196
Pre-training layer 2, epoch 56, cost -62.8800552273
Pre-training layer 2, epoch 57, cost -62.8629465485
Pre-training layer 2, epoch 58, cost -62.7604370213
Pre-training layer 2, epoch 59, cost -62.7637203598
Pre-training layer 2, epoch 60, cost -62.7619121075
Pre-training layer 2, epoch 60, representative training free energy 11856.0505605
Pre-training layer 2, epoch 60, validation free energy 11740.3287686
Pre-training layer 2, epoch 61, cost -62.6895094299
Pre-training layer 2, epoch 62, cost -62.6027290535
Pre-training layer 2, epoch 63, cost -62.602995739
Pre-training layer 2, epoch 64, cost -62.5332565212
Pre-training layer 2, epoch 65, cost -62.5761263466
Pre-training layer 2, epoch 65, representative training free energy 12155.4722393
Pre-training layer 2, epoch 65, validation free energy 12034.327292
Pre-training layer 2, epoch 66, cost -62.496241293
Pre-training layer 2, epoch 67, cost -62.4508431911
Pre-training layer 2, epoch 68, cost -62.4211842728
Pre-training layer 2, epoch 69, cost -62.4033820248
Pre-training layer 2, epoch 70, cost -62.2920859909
Pre-training layer 2, epoch 70, representative training free energy 12442.9121211
Pre-training layer 2, epoch 70, validation free energy 12320.0127285
Pre-training layer 2, epoch 71, cost -62.2840540886
Pre-training layer 2, epoch 72, cost -62.3598661327
Pre-training layer 2, epoch 73, cost -62.2680132771
Pre-training layer 2, epoch 74, cost -62.2253836155
Pre-training layer 2, epoch 75, cost -62.1402352524
Pre-training layer 2, epoch 75, representative training free energy 12712.4350176
Pre-training layer 2, epoch 75, validation free energy 12585.3135332
Pre-training layer 2, epoch 76, cost -62.251959219
Pre-training layer 2, epoch 77, cost -62.0672277641
Pre-training layer 2, epoch 78, cost -62.1565188408
Pre-training layer 2, epoch 79, cost -62.0454721546
Pre-training layer 2, epoch 80, cost -62.1276321602
Pre-training layer 2, epoch 80, representative training free energy 13003.688502
Pre-training layer 2, epoch 80, validation free energy 12872.0174658
Pre-training layer 2, epoch 81, cost -62.0015393543
Pre-training layer 2, epoch 82, cost -61.9509716797
Pre-training layer 2, epoch 83, cost -61.9266508198
Pre-training layer 2, epoch 84, cost -61.9477414131
Pre-training layer 2, epoch 85, cost -61.9378156567
Pre-training layer 2, epoch 85, representative training free energy 13287.4024316
Pre-training layer 2, epoch 85, validation free energy 13152.8148926
Pre-training layer 2, epoch 86, cost -61.9133555031
Pre-training layer 2, epoch 87, cost -61.8724895573
Pre-training layer 2, epoch 88, cost -61.9248514652
Pre-training layer 2, epoch 89, cost -61.8695395374
Pre-training layer 2, epoch 90, cost -61.8672779655
Pre-training layer 2, epoch 90, representative training free energy 13524.7375225
Pre-training layer 2, epoch 90, validation free energy 13386.4234082
Pre-training layer 2, epoch 91, cost -61.7676044178
Pre-training layer 2, epoch 92, cost -61.7617388248
Pre-training layer 2, epoch 93, cost -61.7041217422
Pre-training layer 2, epoch 94, cost -61.7569262218
Pre-training layer 2, epoch 95, cost -61.7704301929
Pre-training layer 2, epoch 95, representative training free energy 13767.2822461
Pre-training layer 2, epoch 95, validation free energy 13625.6654092
Pre-training layer 2, epoch 96, cost -61.797332058
Pre-training layer 2, epoch 97, cost -61.618030653
Pre-training layer 2, epoch 98, cost -61.7144773579
Pre-training layer 2, epoch 99, cost -61.6471892929
The pretraining code for file dbn_loop.pyc ran for 10.40m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 34.400000 %
     epoch 1, minibatch 400/400, test error of best model 28.000000 %
epoch 2, minibatch 400/400, validation error 25.200000 %
     epoch 2, minibatch 400/400, test error of best model 16.800000 %
epoch 3, minibatch 400/400, validation error 23.400000 %
     epoch 3, minibatch 400/400, test error of best model 14.000000 %
epoch 4, minibatch 400/400, validation error 20.600000 %
     epoch 4, minibatch 400/400, test error of best model 11.800000 %
epoch 5, minibatch 400/400, validation error 19.600000 %
     epoch 5, minibatch 400/400, test error of best model 10.800000 %
epoch 6, minibatch 400/400, validation error 18.600000 %
     epoch 6, minibatch 400/400, test error of best model 9.600000 %
epoch 7, minibatch 400/400, validation error 18.600000 %
epoch 8, minibatch 400/400, validation error 18.400000 %
     epoch 8, minibatch 400/400, test error of best model 8.000000 %
epoch 9, minibatch 400/400, validation error 17.800000 %
     epoch 9, minibatch 400/400, test error of best model 6.600000 %
epoch 10, minibatch 400/400, validation error 18.000000 %
epoch 11, minibatch 400/400, validation error 17.600000 %
     epoch 11, minibatch 400/400, test error of best model 6.400000 %
epoch 12, minibatch 400/400, validation error 17.400000 %
     epoch 12, minibatch 400/400, test error of best model 6.400000 %
epoch 13, minibatch 400/400, validation error 16.800000 %
     epoch 13, minibatch 400/400, test error of best model 6.000000 %
epoch 14, minibatch 400/400, validation error 16.800000 %
epoch 15, minibatch 400/400, validation error 16.600000 %
     epoch 15, minibatch 400/400, test error of best model 5.200000 %
epoch 16, minibatch 400/400, validation error 16.400000 %
     epoch 16, minibatch 400/400, test error of best model 5.600000 %
epoch 17, minibatch 400/400, validation error 16.600000 %
epoch 18, minibatch 400/400, validation error 16.800000 %
epoch 19, minibatch 400/400, validation error 16.600000 %
epoch 20, minibatch 400/400, validation error 16.600000 %
epoch 21, minibatch 400/400, validation error 16.600000 %
epoch 22, minibatch 400/400, validation error 16.400000 %
epoch 23, minibatch 400/400, validation error 16.400000 %
epoch 24, minibatch 400/400, validation error 16.400000 %
epoch 25, minibatch 400/400, validation error 16.400000 %
epoch 26, minibatch 400/400, validation error 16.400000 %
epoch 27, minibatch 400/400, validation error 16.400000 %
epoch 28, minibatch 400/400, validation error 16.400000 %
epoch 29, minibatch 400/400, validation error 16.400000 %
epoch 30, minibatch 400/400, validation error 16.400000 %
epoch 31, minibatch 400/400, validation error 16.400000 %
Optimization complete with best validation score of 16.400000 %, obtained at iteration 6400, with test performance 5.600000 %
The fine tuning code for file dbn_loop.pyc ran for 1.03m


==========Sample: (5000, 500, 500) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.505357132
Pre-training layer 0, epoch 0, representative training free energy -547.899055054
Pre-training layer 0, epoch 0, validation free energy -542.280119934
Pre-training layer 0, epoch 1, cost -108.810859894
Pre-training layer 0, epoch 2, cost -101.07255278
Pre-training layer 0, epoch 3, cost -96.4871845703
Pre-training layer 0, epoch 4, cost -93.4868676453
Pre-training layer 0, epoch 5, cost -91.2772743225
Pre-training layer 0, epoch 5, representative training free energy -489.686984436
Pre-training layer 0, epoch 5, validation free energy -482.529143311
Pre-training layer 0, epoch 6, cost -89.6435813293
Pre-training layer 0, epoch 7, cost -88.1360266724
Pre-training layer 0, epoch 8, cost -87.1662319565
Pre-training layer 0, epoch 9, cost -86.3265677643
Pre-training layer 0, epoch 10, cost -85.4292940979
Pre-training layer 0, epoch 10, representative training free energy -469.231455566
Pre-training layer 0, epoch 10, validation free energy -461.524528687
Pre-training layer 0, epoch 11, cost -84.6566740799
Pre-training layer 0, epoch 12, cost -83.9650076523
Pre-training layer 0, epoch 13, cost -83.3460390778
Pre-training layer 0, epoch 14, cost -82.7427132492
Pre-training layer 0, epoch 15, cost -82.4388078232
Pre-training layer 0, epoch 15, representative training free energy -457.405777832
Pre-training layer 0, epoch 15, validation free energy -449.639453003
Pre-training layer 0, epoch 16, cost -81.9527154999
Pre-training layer 0, epoch 17, cost -81.5517773132
Pre-training layer 0, epoch 18, cost -81.1525013885
Pre-training layer 0, epoch 19, cost -80.7443446732
Pre-training layer 0, epoch 20, cost -80.6051745911
Pre-training layer 0, epoch 20, representative training free energy -450.227429077
Pre-training layer 0, epoch 20, validation free energy -441.555407776
Pre-training layer 0, epoch 21, cost -80.2346908798
Pre-training layer 0, epoch 22, cost -80.028406456
Pre-training layer 0, epoch 23, cost -79.7744639511
Pre-training layer 0, epoch 24, cost -79.5334019775
Pre-training layer 0, epoch 25, cost -79.3341105499
Pre-training layer 0, epoch 25, representative training free energy -447.962597534
Pre-training layer 0, epoch 25, validation free energy -439.537497375
Pre-training layer 0, epoch 26, cost -78.9509986725
Pre-training layer 0, epoch 27, cost -78.7630719376
Pre-training layer 0, epoch 28, cost -78.6282627945
Pre-training layer 0, epoch 29, cost -78.3685946045
Pre-training layer 0, epoch 30, cost -78.1580126724
Pre-training layer 0, epoch 30, representative training free energy -443.637694641
Pre-training layer 0, epoch 30, validation free energy -435.224641479
Pre-training layer 0, epoch 31, cost -78.0439005737
Pre-training layer 0, epoch 32, cost -77.8045584793
Pre-training layer 0, epoch 33, cost -77.6091938934
Pre-training layer 0, epoch 34, cost -77.5106422882
Pre-training layer 0, epoch 35, cost -77.4437651672
Pre-training layer 0, epoch 35, representative training free energy -442.719316833
Pre-training layer 0, epoch 35, validation free energy -434.28482135
Pre-training layer 0, epoch 36, cost -77.2141686554
Pre-training layer 0, epoch 37, cost -77.0617790451
Pre-training layer 0, epoch 38, cost -77.0953502808
Pre-training layer 0, epoch 39, cost -76.8188869781
Pre-training layer 0, epoch 40, cost -76.7377891693
Pre-training layer 0, epoch 40, representative training free energy -437.160972229
Pre-training layer 0, epoch 40, validation free energy -428.488866516
Pre-training layer 0, epoch 41, cost -76.6872680206
Pre-training layer 0, epoch 42, cost -76.4530949707
Pre-training layer 0, epoch 43, cost -76.3496050491
Pre-training layer 0, epoch 44, cost -76.3332641525
Pre-training layer 0, epoch 45, cost -76.0373998566
Pre-training layer 0, epoch 45, representative training free energy -438.469502808
Pre-training layer 0, epoch 45, validation free energy -429.615151917
Pre-training layer 0, epoch 46, cost -76.0430473175
Pre-training layer 0, epoch 47, cost -75.9487381592
Pre-training layer 0, epoch 48, cost -75.8982023926
Pre-training layer 0, epoch 49, cost -75.7207489853
Pre-training layer 0, epoch 50, cost -75.7262273483
Pre-training layer 0, epoch 50, representative training free energy -432.968804138
Pre-training layer 0, epoch 50, validation free energy -423.892403198
Pre-training layer 0, epoch 51, cost -75.6523540955
Pre-training layer 0, epoch 52, cost -75.5402010956
Pre-training layer 0, epoch 53, cost -75.3394150467
Pre-training layer 0, epoch 54, cost -75.2431578445
Pre-training layer 0, epoch 55, cost -75.229905014
Pre-training layer 0, epoch 55, representative training free energy -430.862408203
Pre-training layer 0, epoch 55, validation free energy -421.827967224
Pre-training layer 0, epoch 56, cost -75.1226951523
Pre-training layer 0, epoch 57, cost -75.0669220657
Pre-training layer 0, epoch 58, cost -75.0281414566
Pre-training layer 0, epoch 59, cost -74.9175245972
Pre-training layer 0, epoch 60, cost -74.803969574
Pre-training layer 0, epoch 60, representative training free energy -430.878325928
Pre-training layer 0, epoch 60, validation free energy -421.057737366
Pre-training layer 0, epoch 61, cost -74.7336509247
Pre-training layer 0, epoch 62, cost -74.5740825958
Pre-training layer 0, epoch 63, cost -74.6225132751
Pre-training layer 0, epoch 64, cost -74.6072393875
Pre-training layer 0, epoch 65, cost -74.4963302536
Pre-training layer 0, epoch 65, representative training free energy -428.268054871
Pre-training layer 0, epoch 65, validation free energy -418.767514893
Pre-training layer 0, epoch 66, cost -74.457721756
Pre-training layer 0, epoch 67, cost -74.2470745316
Pre-training layer 0, epoch 68, cost -74.2665906143
Pre-training layer 0, epoch 69, cost -74.1494400482
Pre-training layer 0, epoch 70, cost -74.1623370743
Pre-training layer 0, epoch 70, representative training free energy -428.41179425
Pre-training layer 0, epoch 70, validation free energy -418.551489929
Pre-training layer 0, epoch 71, cost -74.187913559
Pre-training layer 0, epoch 72, cost -74.050095192
Pre-training layer 0, epoch 73, cost -73.8901799698
Pre-training layer 0, epoch 74, cost -73.9518929443
Pre-training layer 0, epoch 75, cost -73.808440567
Pre-training layer 0, epoch 75, representative training free energy -429.869400513
Pre-training layer 0, epoch 75, validation free energy -420.065988342
Pre-training layer 0, epoch 76, cost -73.8654723053
Pre-training layer 0, epoch 77, cost -73.8135840836
Pre-training layer 0, epoch 78, cost -73.6031307449
Pre-training layer 0, epoch 79, cost -73.5605696869
Pre-training layer 0, epoch 80, cost -73.5264856873
Pre-training layer 0, epoch 80, representative training free energy -425.259843567
Pre-training layer 0, epoch 80, validation free energy -415.54067395
Pre-training layer 0, epoch 81, cost -73.495675148
Pre-training layer 0, epoch 82, cost -73.3690732651
Pre-training layer 0, epoch 83, cost -73.4406841888
Pre-training layer 0, epoch 84, cost -73.3469186478
Pre-training layer 0, epoch 85, cost -73.4143141937
Pre-training layer 0, epoch 85, representative training free energy -421.929531616
Pre-training layer 0, epoch 85, validation free energy -411.761986023
Pre-training layer 0, epoch 86, cost -73.3524684372
Pre-training layer 0, epoch 87, cost -73.3172333603
Pre-training layer 0, epoch 88, cost -73.1162008972
Pre-training layer 0, epoch 89, cost -73.1679169846
Pre-training layer 0, epoch 90, cost -73.1508668594
Pre-training layer 0, epoch 90, representative training free energy -424.235290771
Pre-training layer 0, epoch 90, validation free energy -413.768222961
Pre-training layer 0, epoch 91, cost -72.9967513351
Pre-training layer 0, epoch 92, cost -72.9712503052
Pre-training layer 0, epoch 93, cost -72.9896147995
Pre-training layer 0, epoch 94, cost -72.9028488922
Pre-training layer 0, epoch 95, cost -72.9028019485
Pre-training layer 0, epoch 95, representative training free energy -422.836956787
Pre-training layer 0, epoch 95, validation free energy -412.712449829
Pre-training layer 0, epoch 96, cost -72.9237847061
Pre-training layer 0, epoch 97, cost -72.8171394043
Pre-training layer 0, epoch 98, cost -72.7318527145
Pre-training layer 0, epoch 99, cost -72.7353047333
Pre-training layer 1, epoch 0, cost -312.46010199
Pre-training layer 1, epoch 0, representative training free energy -61095.3325586
Pre-training layer 1, epoch 0, validation free energy -60551.2023438
Pre-training layer 1, epoch 1, cost -268.486680542
Pre-training layer 1, epoch 2, cost -255.06454657
Pre-training layer 1, epoch 3, cost -247.469518219
Pre-training layer 1, epoch 4, cost -242.192086517
Pre-training layer 1, epoch 5, cost -238.463946289
Pre-training layer 1, epoch 5, representative training free energy -80933.1879297
Pre-training layer 1, epoch 5, validation free energy -80241.4489805
Pre-training layer 1, epoch 6, cost -235.493212982
Pre-training layer 1, epoch 7, cost -233.122605042
Pre-training layer 1, epoch 8, cost -231.182183899
Pre-training layer 1, epoch 9, cost -229.606637909
Pre-training layer 1, epoch 10, cost -228.230637695
Pre-training layer 1, epoch 10, representative training free energy -86923.1255273
Pre-training layer 1, epoch 10, validation free energy -86183.8584453
Pre-training layer 1, epoch 11, cost -227.07970932
Pre-training layer 1, epoch 12, cost -226.071822113
Pre-training layer 1, epoch 13, cost -225.087468109
Pre-training layer 1, epoch 14, cost -224.249794037
Pre-training layer 1, epoch 15, cost -223.602435181
Pre-training layer 1, epoch 15, representative training free energy -90522.9441875
Pre-training layer 1, epoch 15, validation free energy -89737.6385078
Pre-training layer 1, epoch 16, cost -222.964672729
Pre-training layer 1, epoch 17, cost -222.240009552
Pre-training layer 1, epoch 18, cost -221.805098511
Pre-training layer 1, epoch 19, cost -221.185760712
Pre-training layer 1, epoch 20, cost -220.773575195
Pre-training layer 1, epoch 20, representative training free energy -93174.2636406
Pre-training layer 1, epoch 20, validation free energy -92371.2965195
Pre-training layer 1, epoch 21, cost -220.311942993
Pre-training layer 1, epoch 22, cost -219.819248901
Pre-training layer 1, epoch 23, cost -219.558414948
Pre-training layer 1, epoch 24, cost -219.206676208
Pre-training layer 1, epoch 25, cost -218.793555542
Pre-training layer 1, epoch 25, representative training free energy -95139.6806016
Pre-training layer 1, epoch 25, validation free energy -94306.7226211
Pre-training layer 1, epoch 26, cost -218.488929108
Pre-training layer 1, epoch 27, cost -218.219231262
Pre-training layer 1, epoch 28, cost -217.866912476
Pre-training layer 1, epoch 29, cost -217.67457605
Pre-training layer 1, epoch 30, cost -217.292372986
Pre-training layer 1, epoch 30, representative training free energy -96900.8399609
Pre-training layer 1, epoch 30, validation free energy -96050.4793164
Pre-training layer 1, epoch 31, cost -217.068573944
Pre-training layer 1, epoch 32, cost -216.878820374
Pre-training layer 1, epoch 33, cost -216.601550629
Pre-training layer 1, epoch 34, cost -216.409526367
Pre-training layer 1, epoch 35, cost -216.348069122
Pre-training layer 1, epoch 35, representative training free energy -98554.2622031
Pre-training layer 1, epoch 35, validation free energy -97690.0862617
Pre-training layer 1, epoch 36, cost -216.030472504
Pre-training layer 1, epoch 37, cost -215.886499115
Pre-training layer 1, epoch 38, cost -215.73297702
Pre-training layer 1, epoch 39, cost -215.461147705
Pre-training layer 1, epoch 40, cost -215.39628421
Pre-training layer 1, epoch 40, representative training free energy -99684.3637734
Pre-training layer 1, epoch 40, validation free energy -98802.3240859
Pre-training layer 1, epoch 41, cost -215.111675659
Pre-training layer 1, epoch 42, cost -215.006794891
Pre-training layer 1, epoch 43, cost -214.821753754
Pre-training layer 1, epoch 44, cost -214.642565125
Pre-training layer 1, epoch 45, cost -214.488540161
Pre-training layer 1, epoch 45, representative training free energy -100957.49925
Pre-training layer 1, epoch 45, validation free energy -100071.901211
Pre-training layer 1, epoch 46, cost -214.402187805
Pre-training layer 1, epoch 47, cost -214.20356601
Pre-training layer 1, epoch 48, cost -214.162885742
Pre-training layer 1, epoch 49, cost -213.901522034
Pre-training layer 1, epoch 50, cost -213.816999146
Pre-training layer 1, epoch 50, representative training free energy -102034.512508
Pre-training layer 1, epoch 50, validation free energy -101142.916344
Pre-training layer 1, epoch 51, cost -213.818126038
Pre-training layer 1, epoch 52, cost -213.620022705
Pre-training layer 1, epoch 53, cost -213.591419739
Pre-training layer 1, epoch 54, cost -213.500794464
Pre-training layer 1, epoch 55, cost -213.376799988
Pre-training layer 1, epoch 55, representative training free energy -102977.247305
Pre-training layer 1, epoch 55, validation free energy -102066.350133
Pre-training layer 1, epoch 56, cost -213.175322998
Pre-training layer 1, epoch 57, cost -213.218995361
Pre-training layer 1, epoch 58, cost -213.043593231
Pre-training layer 1, epoch 59, cost -212.987949982
Pre-training layer 1, epoch 60, cost -212.813701508
Pre-training layer 1, epoch 60, representative training free energy -103903.248211
Pre-training layer 1, epoch 60, validation free energy -102989.759406
Pre-training layer 1, epoch 61, cost -212.739976074
Pre-training layer 1, epoch 62, cost -212.690096252
Pre-training layer 1, epoch 63, cost -212.609953156
Pre-training layer 1, epoch 64, cost -212.444936493
Pre-training layer 1, epoch 65, cost -212.49705896
Pre-training layer 1, epoch 65, representative training free energy -104665.019406
Pre-training layer 1, epoch 65, validation free energy -103740.351406
Pre-training layer 1, epoch 66, cost -212.338829651
Pre-training layer 1, epoch 67, cost -212.233182312
Pre-training layer 1, epoch 68, cost -212.116878021
Pre-training layer 1, epoch 69, cost -212.177058929
Pre-training layer 1, epoch 70, cost -212.082950531
Pre-training layer 1, epoch 70, representative training free energy -105424.930141
Pre-training layer 1, epoch 70, validation free energy -104498.769945
Pre-training layer 1, epoch 71, cost -211.994410339
Pre-training layer 1, epoch 72, cost -211.890155762
Pre-training layer 1, epoch 73, cost -211.741181732
Pre-training layer 1, epoch 74, cost -211.76817807
Pre-training layer 1, epoch 75, cost -211.543596893
Pre-training layer 1, epoch 75, representative training free energy -106171.620094
Pre-training layer 1, epoch 75, validation free energy -105231.232031
Pre-training layer 1, epoch 76, cost -211.608697784
Pre-training layer 1, epoch 77, cost -211.578384155
Pre-training layer 1, epoch 78, cost -211.400508362
Pre-training layer 1, epoch 79, cost -211.373169128
Pre-training layer 1, epoch 80, cost -211.351785461
Pre-training layer 1, epoch 80, representative training free energy -106812.759578
Pre-training layer 1, epoch 80, validation free energy -105862.968703
Pre-training layer 1, epoch 81, cost -211.239562378
Pre-training layer 1, epoch 82, cost -211.213818817
Pre-training layer 1, epoch 83, cost -211.177944855
Pre-training layer 1, epoch 84, cost -211.19147641
Pre-training layer 1, epoch 85, cost -211.035005585
Pre-training layer 1, epoch 85, representative training free energy -107479.710023
Pre-training layer 1, epoch 85, validation free energy -106530.385547
Pre-training layer 1, epoch 86, cost -211.015057617
Pre-training layer 1, epoch 87, cost -211.113545776
Pre-training layer 1, epoch 88, cost -210.8640289
Pre-training layer 1, epoch 89, cost -210.814087616
Pre-training layer 1, epoch 90, cost -210.839369904
Pre-training layer 1, epoch 90, representative training free energy -108034.186219
Pre-training layer 1, epoch 90, validation free energy -107084.410984
Pre-training layer 1, epoch 91, cost -210.795732941
Pre-training layer 1, epoch 92, cost -210.821770996
Pre-training layer 1, epoch 93, cost -210.61657428
Pre-training layer 1, epoch 94, cost -210.642726868
Pre-training layer 1, epoch 95, cost -210.637317535
Pre-training layer 1, epoch 95, representative training free energy -108643.348102
Pre-training layer 1, epoch 95, validation free energy -107686.574445
Pre-training layer 1, epoch 96, cost -210.550269653
Pre-training layer 1, epoch 97, cost -210.406204987
Pre-training layer 1, epoch 98, cost -210.477920044
Pre-training layer 1, epoch 99, cost -210.432233948
Pre-training layer 2, epoch 0, cost -114.757169983
Pre-training layer 2, epoch 0, representative training free energy 3909.29144153
Pre-training layer 2, epoch 0, validation free energy 3893.46015637
Pre-training layer 2, epoch 1, cost -86.5303828964
Pre-training layer 2, epoch 2, cost -80.3142432175
Pre-training layer 2, epoch 3, cost -76.8090969849
Pre-training layer 2, epoch 4, cost -74.5770137863
Pre-training layer 2, epoch 5, cost -72.8063562622
Pre-training layer 2, epoch 5, representative training free energy 6334.34218604
Pre-training layer 2, epoch 5, validation free energy 6283.76365894
Pre-training layer 2, epoch 6, cost -71.5206636963
Pre-training layer 2, epoch 7, cost -70.4428516541
Pre-training layer 2, epoch 8, cost -69.5552371368
Pre-training layer 2, epoch 9, cost -68.7791530762
Pre-training layer 2, epoch 10, cost -68.161188942
Pre-training layer 2, epoch 10, representative training free energy 7612.55205811
Pre-training layer 2, epoch 10, validation free energy 7545.53109277
Pre-training layer 2, epoch 11, cost -67.6155564651
Pre-training layer 2, epoch 12, cost -67.1779587402
Pre-training layer 2, epoch 13, cost -66.742071312
Pre-training layer 2, epoch 14, cost -66.3810921783
Pre-training layer 2, epoch 15, cost -66.0811672821
Pre-training layer 2, epoch 15, representative training free energy 8531.3386001
Pre-training layer 2, epoch 15, validation free energy 8451.76569385
Pre-training layer 2, epoch 16, cost -65.6714849472
Pre-training layer 2, epoch 17, cost -65.3908021088
Pre-training layer 2, epoch 18, cost -65.1165767212
Pre-training layer 2, epoch 19, cost -64.9185753784
Pre-training layer 2, epoch 20, cost -64.7414256897
Pre-training layer 2, epoch 20, representative training free energy 9259.84115137
Pre-training layer 2, epoch 20, validation free energy 9174.25456982
Pre-training layer 2, epoch 21, cost -64.5870366058
Pre-training layer 2, epoch 22, cost -64.4077461853
Pre-training layer 2, epoch 23, cost -64.1652432098
Pre-training layer 2, epoch 24, cost -63.9767569885
Pre-training layer 2, epoch 25, cost -63.9247554245
Pre-training layer 2, epoch 25, representative training free energy 9838.21375342
Pre-training layer 2, epoch 25, validation free energy 9747.55438086
Pre-training layer 2, epoch 26, cost -63.7453992844
Pre-training layer 2, epoch 27, cost -63.6314958801
Pre-training layer 2, epoch 28, cost -63.5244232178
Pre-training layer 2, epoch 29, cost -63.3073946304
Pre-training layer 2, epoch 30, cost -63.2715046768
Pre-training layer 2, epoch 30, representative training free energy 10404.5827173
Pre-training layer 2, epoch 30, validation free energy 10312.6962676
Pre-training layer 2, epoch 31, cost -63.1242101288
Pre-training layer 2, epoch 32, cost -62.9965171661
Pre-training layer 2, epoch 33, cost -62.9444855728
Pre-training layer 2, epoch 34, cost -62.8222374573
Pre-training layer 2, epoch 35, cost -62.765027359
Pre-training layer 2, epoch 35, representative training free energy 10881.8857866
Pre-training layer 2, epoch 35, validation free energy 10787.0578408
Pre-training layer 2, epoch 36, cost -62.7231536865
Pre-training layer 2, epoch 37, cost -62.6572098007
Pre-training layer 2, epoch 38, cost -62.6049698563
Pre-training layer 2, epoch 39, cost -62.4045658875
Pre-training layer 2, epoch 40, cost -62.3615715179
Pre-training layer 2, epoch 40, representative training free energy 11318.0792813
Pre-training layer 2, epoch 40, validation free energy 11224.3610562
Pre-training layer 2, epoch 41, cost -62.3887167282
Pre-training layer 2, epoch 42, cost -62.2518849411
Pre-training layer 2, epoch 43, cost -62.192447052
Pre-training layer 2, epoch 44, cost -62.1536815643
Pre-training layer 2, epoch 45, cost -62.0774584885
Pre-training layer 2, epoch 45, representative training free energy 11753.8676113
Pre-training layer 2, epoch 45, validation free energy 11652.3797109
Pre-training layer 2, epoch 46, cost -61.9728126144
Pre-training layer 2, epoch 47, cost -62.0248666153
Pre-training layer 2, epoch 48, cost -61.8840240326
Pre-training layer 2, epoch 49, cost -61.8232226028
Pre-training layer 2, epoch 50, cost -61.7639974442
Pre-training layer 2, epoch 50, representative training free energy 12120.4399678
Pre-training layer 2, epoch 50, validation free energy 12027.3673457
Pre-training layer 2, epoch 51, cost -61.7837902451
Pre-training layer 2, epoch 52, cost -61.7033561859
Pre-training layer 2, epoch 53, cost -61.691786972
Pre-training layer 2, epoch 54, cost -61.5777611923
Pre-training layer 2, epoch 55, cost -61.5691010513
Pre-training layer 2, epoch 55, representative training free energy 12535.7598154
Pre-training layer 2, epoch 55, validation free energy 12436.9975288
Pre-training layer 2, epoch 56, cost -61.5684203796
Pre-training layer 2, epoch 57, cost -61.5049142227
Pre-training layer 2, epoch 58, cost -61.4604762573
Pre-training layer 2, epoch 59, cost -61.4625602875
Pre-training layer 2, epoch 60, cost -61.413686409
Pre-training layer 2, epoch 60, representative training free energy 12841.5890498
Pre-training layer 2, epoch 60, validation free energy 12748.1793643
Pre-training layer 2, epoch 61, cost -61.383638504
Pre-training layer 2, epoch 62, cost -61.2717588043
Pre-training layer 2, epoch 63, cost -61.2714020081
Pre-training layer 2, epoch 64, cost -61.2976657181
Pre-training layer 2, epoch 65, cost -61.1915123444
Pre-training layer 2, epoch 65, representative training free energy 13152.8330635
Pre-training layer 2, epoch 65, validation free energy 13061.3608379
Pre-training layer 2, epoch 66, cost -61.2168582382
Pre-training layer 2, epoch 67, cost -61.1886010971
Pre-training layer 2, epoch 68, cost -61.1019901428
Pre-training layer 2, epoch 69, cost -61.0533516769
Pre-training layer 2, epoch 70, cost -61.048029129
Pre-training layer 2, epoch 70, representative training free energy 13522.0689717
Pre-training layer 2, epoch 70, validation free energy 13421.1226289
Pre-training layer 2, epoch 71, cost -61.0431506195
Pre-training layer 2, epoch 72, cost -61.0192764587
Pre-training layer 2, epoch 73, cost -60.9725762863
Pre-training layer 2, epoch 74, cost -60.9193825302
Pre-training layer 2, epoch 75, cost -60.896738472
Pre-training layer 2, epoch 75, representative training free energy 13844.2957734
Pre-training layer 2, epoch 75, validation free energy 13738.5364033
Pre-training layer 2, epoch 76, cost -60.9466536789
Pre-training layer 2, epoch 77, cost -60.7972158661
Pre-training layer 2, epoch 78, cost -60.759691185
Pre-training layer 2, epoch 79, cost -60.7973944244
Pre-training layer 2, epoch 80, cost -60.7705031433
Pre-training layer 2, epoch 80, representative training free energy 14242.1915898
Pre-training layer 2, epoch 80, validation free energy 14133.145583
Pre-training layer 2, epoch 81, cost -60.7586884232
Pre-training layer 2, epoch 82, cost -60.7164606476
Pre-training layer 2, epoch 83, cost -60.7339077225
Pre-training layer 2, epoch 84, cost -60.7498817596
Pre-training layer 2, epoch 85, cost -60.7190773849
Pre-training layer 2, epoch 85, representative training free energy 14486.2177803
Pre-training layer 2, epoch 85, validation free energy 14377.7768164
Pre-training layer 2, epoch 86, cost -60.6667789307
Pre-training layer 2, epoch 87, cost -60.6530743561
Pre-training layer 2, epoch 88, cost -60.5259853287
Pre-training layer 2, epoch 89, cost -60.5382939606
Pre-training layer 2, epoch 90, cost -60.4842220078
Pre-training layer 2, epoch 90, representative training free energy 14820.5315615
Pre-training layer 2, epoch 90, validation free energy 14708.4366006
Pre-training layer 2, epoch 91, cost -60.5800407715
Pre-training layer 2, epoch 92, cost -60.5944709702
Pre-training layer 2, epoch 93, cost -60.4869377518
Pre-training layer 2, epoch 94, cost -60.4004449234
Pre-training layer 2, epoch 95, cost -60.4799536819
Pre-training layer 2, epoch 95, representative training free energy 15120.8074131
Pre-training layer 2, epoch 95, validation free energy 15000.6018613
Pre-training layer 2, epoch 96, cost -60.4275396194
Pre-training layer 2, epoch 97, cost -60.4644567642
Pre-training layer 2, epoch 98, cost -60.4035159302
Pre-training layer 2, epoch 99, cost -60.3872411652
The pretraining code for file dbn_loop.pyc ran for 13.44m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 33.600000 %
     epoch 1, minibatch 500/500, test error of best model 29.000000 %
epoch 2, minibatch 500/500, validation error 25.200000 %
     epoch 2, minibatch 500/500, test error of best model 18.200000 %
epoch 3, minibatch 500/500, validation error 22.800000 %
     epoch 3, minibatch 500/500, test error of best model 15.000000 %
epoch 4, minibatch 500/500, validation error 21.400000 %
     epoch 4, minibatch 500/500, test error of best model 13.200000 %
epoch 5, minibatch 500/500, validation error 20.400000 %
     epoch 5, minibatch 500/500, test error of best model 12.200000 %
epoch 6, minibatch 500/500, validation error 20.000000 %
     epoch 6, minibatch 500/500, test error of best model 11.000000 %
epoch 7, minibatch 500/500, validation error 18.600000 %
     epoch 7, minibatch 500/500, test error of best model 10.000000 %
epoch 8, minibatch 500/500, validation error 18.800000 %
epoch 9, minibatch 500/500, validation error 18.600000 %
epoch 10, minibatch 500/500, validation error 18.200000 %
     epoch 10, minibatch 500/500, test error of best model 6.800000 %
epoch 11, minibatch 500/500, validation error 17.600000 %
     epoch 11, minibatch 500/500, test error of best model 6.400000 %
epoch 12, minibatch 500/500, validation error 17.200000 %
     epoch 12, minibatch 500/500, test error of best model 6.000000 %
epoch 13, minibatch 500/500, validation error 17.200000 %
epoch 14, minibatch 500/500, validation error 17.800000 %
epoch 15, minibatch 500/500, validation error 17.600000 %
epoch 16, minibatch 500/500, validation error 17.600000 %
epoch 17, minibatch 500/500, validation error 17.600000 %
epoch 18, minibatch 500/500, validation error 17.200000 %
epoch 19, minibatch 500/500, validation error 17.000000 %
     epoch 19, minibatch 500/500, test error of best model 5.200000 %
epoch 20, minibatch 500/500, validation error 17.000000 %
epoch 21, minibatch 500/500, validation error 17.000000 %
epoch 22, minibatch 500/500, validation error 16.800000 %
     epoch 22, minibatch 500/500, test error of best model 4.600000 %
epoch 23, minibatch 500/500, validation error 16.600000 %
     epoch 23, minibatch 500/500, test error of best model 4.600000 %
epoch 24, minibatch 500/500, validation error 16.400000 %
     epoch 24, minibatch 500/500, test error of best model 4.600000 %
epoch 25, minibatch 500/500, validation error 16.200000 %
     epoch 25, minibatch 500/500, test error of best model 4.600000 %
epoch 26, minibatch 500/500, validation error 16.000000 %
     epoch 26, minibatch 500/500, test error of best model 4.600000 %
epoch 27, minibatch 500/500, validation error 16.200000 %
epoch 28, minibatch 500/500, validation error 16.200000 %
epoch 29, minibatch 500/500, validation error 16.000000 %
epoch 30, minibatch 500/500, validation error 15.800000 %
     epoch 30, minibatch 500/500, test error of best model 5.200000 %
epoch 31, minibatch 500/500, validation error 15.800000 %
epoch 32, minibatch 500/500, validation error 15.800000 %
epoch 33, minibatch 500/500, validation error 15.600000 %
     epoch 33, minibatch 500/500, test error of best model 5.200000 %
epoch 34, minibatch 500/500, validation error 15.600000 %
epoch 35, minibatch 500/500, validation error 15.600000 %
epoch 36, minibatch 500/500, validation error 15.600000 %
epoch 37, minibatch 500/500, validation error 15.600000 %
epoch 38, minibatch 500/500, validation error 15.600000 %
epoch 39, minibatch 500/500, validation error 15.600000 %
epoch 40, minibatch 500/500, validation error 15.600000 %
epoch 41, minibatch 500/500, validation error 15.600000 %
epoch 42, minibatch 500/500, validation error 15.400000 %
     epoch 42, minibatch 500/500, test error of best model 5.200000 %
epoch 43, minibatch 500/500, validation error 15.400000 %
epoch 44, minibatch 500/500, validation error 15.400000 %
epoch 45, minibatch 500/500, validation error 15.600000 %
epoch 46, minibatch 500/500, validation error 15.600000 %
epoch 47, minibatch 500/500, validation error 15.600000 %
epoch 48, minibatch 500/500, validation error 15.400000 %
epoch 49, minibatch 500/500, validation error 15.400000 %
epoch 50, minibatch 500/500, validation error 15.400000 %
epoch 51, minibatch 500/500, validation error 15.400000 %
epoch 52, minibatch 500/500, validation error 15.400000 %
epoch 53, minibatch 500/500, validation error 15.200000 %
     epoch 53, minibatch 500/500, test error of best model 5.000000 %
epoch 54, minibatch 500/500, validation error 15.200000 %
epoch 55, minibatch 500/500, validation error 15.200000 %
epoch 56, minibatch 500/500, validation error 15.200000 %
epoch 57, minibatch 500/500, validation error 15.200000 %
epoch 58, minibatch 500/500, validation error 15.200000 %
epoch 59, minibatch 500/500, validation error 15.200000 %
epoch 60, minibatch 500/500, validation error 15.200000 %
epoch 61, minibatch 500/500, validation error 15.200000 %
epoch 62, minibatch 500/500, validation error 15.000000 %
     epoch 62, minibatch 500/500, test error of best model 5.000000 %
epoch 63, minibatch 500/500, validation error 15.000000 %
epoch 64, minibatch 500/500, validation error 14.800000 %
     epoch 64, minibatch 500/500, test error of best model 5.000000 %
epoch 65, minibatch 500/500, validation error 14.800000 %
epoch 66, minibatch 500/500, validation error 14.800000 %
epoch 67, minibatch 500/500, validation error 14.600000 %
     epoch 67, minibatch 500/500, test error of best model 4.800000 %
epoch 68, minibatch 500/500, validation error 14.600000 %
epoch 69, minibatch 500/500, validation error 14.600000 %
epoch 70, minibatch 500/500, validation error 14.600000 %
epoch 71, minibatch 500/500, validation error 14.600000 %
epoch 72, minibatch 500/500, validation error 14.600000 %
epoch 73, minibatch 500/500, validation error 14.600000 %
epoch 74, minibatch 500/500, validation error 14.600000 %
epoch 75, minibatch 500/500, validation error 14.600000 %
epoch 76, minibatch 500/500, validation error 14.600000 %
epoch 77, minibatch 500/500, validation error 14.600000 %
epoch 78, minibatch 500/500, validation error 14.600000 %
epoch 79, minibatch 500/500, validation error 14.600000 %
epoch 80, minibatch 500/500, validation error 14.600000 %
epoch 81, minibatch 500/500, validation error 14.600000 %
epoch 82, minibatch 500/500, validation error 14.600000 %
epoch 83, minibatch 500/500, validation error 14.600000 %
epoch 84, minibatch 500/500, validation error 14.600000 %
epoch 85, minibatch 500/500, validation error 14.600000 %
epoch 86, minibatch 500/500, validation error 14.600000 %
epoch 87, minibatch 500/500, validation error 14.600000 %
epoch 88, minibatch 500/500, validation error 14.600000 %
epoch 89, minibatch 500/500, validation error 14.600000 %
epoch 90, minibatch 500/500, validation error 14.600000 %
epoch 91, minibatch 500/500, validation error 14.600000 %
epoch 92, minibatch 500/500, validation error 14.600000 %
epoch 93, minibatch 500/500, validation error 14.600000 %
epoch 94, minibatch 500/500, validation error 14.600000 %
epoch 95, minibatch 500/500, validation error 14.600000 %
epoch 96, minibatch 500/500, validation error 14.600000 %
epoch 97, minibatch 500/500, validation error 14.600000 %
epoch 98, minibatch 500/500, validation error 14.600000 %
epoch 99, minibatch 500/500, validation error 14.600000 %
epoch 100, minibatch 500/500, validation error 14.600000 %
epoch 101, minibatch 500/500, validation error 14.600000 %
epoch 102, minibatch 500/500, validation error 14.600000 %
epoch 103, minibatch 500/500, validation error 14.600000 %
epoch 104, minibatch 500/500, validation error 14.600000 %
epoch 105, minibatch 500/500, validation error 14.600000 %
epoch 106, minibatch 500/500, validation error 14.600000 %
epoch 107, minibatch 500/500, validation error 14.600000 %
epoch 108, minibatch 500/500, validation error 14.600000 %
epoch 109, minibatch 500/500, validation error 14.600000 %
epoch 110, minibatch 500/500, validation error 14.600000 %
epoch 111, minibatch 500/500, validation error 14.600000 %
epoch 112, minibatch 500/500, validation error 14.600000 %
epoch 113, minibatch 500/500, validation error 14.600000 %
epoch 114, minibatch 500/500, validation error 14.600000 %
epoch 115, minibatch 500/500, validation error 14.600000 %
epoch 116, minibatch 500/500, validation error 14.600000 %
epoch 117, minibatch 500/500, validation error 14.600000 %
epoch 118, minibatch 500/500, validation error 14.600000 %
epoch 119, minibatch 500/500, validation error 14.600000 %
epoch 120, minibatch 500/500, validation error 14.600000 %
epoch 121, minibatch 500/500, validation error 14.600000 %
epoch 122, minibatch 500/500, validation error 14.600000 %
epoch 123, minibatch 500/500, validation error 14.600000 %
epoch 124, minibatch 500/500, validation error 14.600000 %
epoch 125, minibatch 500/500, validation error 14.600000 %
epoch 126, minibatch 500/500, validation error 14.600000 %
epoch 127, minibatch 500/500, validation error 14.600000 %
epoch 128, minibatch 500/500, validation error 14.600000 %
epoch 129, minibatch 500/500, validation error 14.600000 %
epoch 130, minibatch 500/500, validation error 14.600000 %
epoch 131, minibatch 500/500, validation error 14.600000 %
epoch 132, minibatch 500/500, validation error 14.600000 %
epoch 133, minibatch 500/500, validation error 14.600000 %
Optimization complete with best validation score of 14.600000 %, obtained at iteration 33500, with test performance 4.800000 %
The fine tuning code for file dbn_loop.pyc ran for 5.37m
