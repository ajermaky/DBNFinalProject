_______RUN: 0

==========Sample (1000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.218124084
Pre-training layer 0, epoch 0, representative training free energy -593.468557037
Pre-training layer 0, epoch 0, validation free energy -588.592342896
Pre-training layer 0, epoch 1, cost -136.675900345
Pre-training layer 0, epoch 2, cost -124.956710663
Pre-training layer 0, epoch 3, cost -117.997781448
Pre-training layer 0, epoch 4, cost -113.159752579
Pre-training layer 0, epoch 5, cost -109.772146149
Pre-training layer 0, epoch 5, representative training free energy -548.361674988
Pre-training layer 0, epoch 5, validation free energy -537.88614444
Pre-training layer 0, epoch 6, cost -106.931742096
Pre-training layer 0, epoch 7, cost -104.599809265
Pre-training layer 0, epoch 8, cost -102.622999496
Pre-training layer 0, epoch 9, cost -101.049227829
Pre-training layer 0, epoch 10, cost -99.469927597
Pre-training layer 0, epoch 10, representative training free energy -526.431735474
Pre-training layer 0, epoch 10, validation free energy -515.052551453
Pre-training layer 0, epoch 11, cost -97.8914917755
Pre-training layer 0, epoch 12, cost -96.7218845367
Pre-training layer 0, epoch 13, cost -95.5989925385
Pre-training layer 0, epoch 14, cost -95.0811508942
Pre-training layer 0, epoch 15, cost -93.4891192627
Pre-training layer 0, epoch 15, representative training free energy -520.635310974
Pre-training layer 0, epoch 15, validation free energy -508.411416046
Pre-training layer 0, epoch 16, cost -93.1361800385
Pre-training layer 0, epoch 17, cost -92.1148833466
Pre-training layer 0, epoch 18, cost -91.6181641388
Pre-training layer 0, epoch 19, cost -90.6551438141
Pre-training layer 0, epoch 20, cost -90.2037808228
Pre-training layer 0, epoch 20, representative training free energy -507.605641602
Pre-training layer 0, epoch 20, validation free energy -493.440624817
Pre-training layer 0, epoch 21, cost -89.5721536255
Pre-training layer 0, epoch 22, cost -88.8344181824
Pre-training layer 0, epoch 23, cost -88.17811203
Pre-training layer 0, epoch 24, cost -87.9031378937
Pre-training layer 0, epoch 25, cost -87.1653946686
Pre-training layer 0, epoch 25, representative training free energy -500.022827789
Pre-training layer 0, epoch 25, validation free energy -486.059540497
Pre-training layer 0, epoch 26, cost -87.0515636444
Pre-training layer 0, epoch 27, cost -86.5507550049
Pre-training layer 0, epoch 28, cost -85.795322113
Pre-training layer 0, epoch 29, cost -85.5675466919
Pre-training layer 0, epoch 30, cost -84.9981214142
Pre-training layer 0, epoch 30, representative training free energy -494.036899597
Pre-training layer 0, epoch 30, validation free energy -480.516124695
Pre-training layer 0, epoch 31, cost -84.7830758667
Pre-training layer 0, epoch 32, cost -84.5317661285
Pre-training layer 0, epoch 33, cost -84.112838974
Pre-training layer 0, epoch 34, cost -84.0638768005
Pre-training layer 0, epoch 35, cost -83.6763449097
Pre-training layer 0, epoch 35, representative training free energy -495.459137115
Pre-training layer 0, epoch 35, validation free energy -479.947224854
Pre-training layer 0, epoch 36, cost -83.1180718994
Pre-training layer 0, epoch 37, cost -82.9857808685
Pre-training layer 0, epoch 38, cost -82.6984687042
Pre-training layer 0, epoch 39, cost -82.2078121185
Pre-training layer 0, epoch 40, cost -82.2188458252
Pre-training layer 0, epoch 40, representative training free energy -489.347201202
Pre-training layer 0, epoch 40, validation free energy -473.403856262
Pre-training layer 0, epoch 41, cost -81.881847229
Pre-training layer 0, epoch 42, cost -81.7326958466
Pre-training layer 0, epoch 43, cost -81.4873511505
Pre-training layer 0, epoch 44, cost -81.4846608734
Pre-training layer 0, epoch 45, cost -81.1323615265
Pre-training layer 0, epoch 45, representative training free energy -482.356399078
Pre-training layer 0, epoch 45, validation free energy -466.132669617
Pre-training layer 0, epoch 46, cost -80.8660975647
Pre-training layer 0, epoch 47, cost -80.6169890976
Pre-training layer 0, epoch 48, cost -80.0406201172
Pre-training layer 0, epoch 49, cost -80.1746400833
Pre-training layer 0, epoch 50, cost -79.8660174561
Pre-training layer 0, epoch 50, representative training free energy -482.831374054
Pre-training layer 0, epoch 50, validation free energy -466.564537598
Pre-training layer 0, epoch 51, cost -79.9461500549
Pre-training layer 0, epoch 52, cost -79.5426470947
Pre-training layer 0, epoch 53, cost -79.5407617188
Pre-training layer 0, epoch 54, cost -79.1973912048
Pre-training layer 0, epoch 55, cost -79.0117845154
Pre-training layer 0, epoch 55, representative training free energy -478.715860565
Pre-training layer 0, epoch 55, validation free energy -462.542717133
Pre-training layer 0, epoch 56, cost -79.0950326538
Pre-training layer 0, epoch 57, cost -78.6949575806
Pre-training layer 0, epoch 58, cost -78.5634674072
Pre-training layer 0, epoch 59, cost -78.2916517639
Pre-training layer 0, epoch 60, cost -78.58569664
Pre-training layer 0, epoch 60, representative training free energy -478.51173761
Pre-training layer 0, epoch 60, validation free energy -461.329617981
Pre-training layer 0, epoch 61, cost -78.1066495895
Pre-training layer 0, epoch 62, cost -77.8885409546
Pre-training layer 0, epoch 63, cost -77.7624171066
Pre-training layer 0, epoch 64, cost -77.7851274109
Pre-training layer 0, epoch 65, cost -77.4571492386
Pre-training layer 0, epoch 65, representative training free energy -475.979448181
Pre-training layer 0, epoch 65, validation free energy -458.520125854
Pre-training layer 0, epoch 66, cost -77.5945024872
Pre-training layer 0, epoch 67, cost -77.5143413544
Pre-training layer 0, epoch 68, cost -77.1595263672
Pre-training layer 0, epoch 69, cost -77.0630009842
Pre-training layer 0, epoch 70, cost -76.9130552673
Pre-training layer 0, epoch 70, representative training free energy -473.969397064
Pre-training layer 0, epoch 70, validation free energy -456.364139008
Pre-training layer 0, epoch 71, cost -76.7828514862
Pre-training layer 0, epoch 72, cost -76.5361631775
Pre-training layer 0, epoch 73, cost -76.3693040466
Pre-training layer 0, epoch 74, cost -76.6736648941
Pre-training layer 0, epoch 75, cost -76.472687912
Pre-training layer 0, epoch 75, representative training free energy -470.831135101
Pre-training layer 0, epoch 75, validation free energy -452.067931335
Pre-training layer 0, epoch 76, cost -76.3146155548
Pre-training layer 0, epoch 77, cost -76.2081221771
Pre-training layer 0, epoch 78, cost -75.8891159439
Pre-training layer 0, epoch 79, cost -76.0993405914
Pre-training layer 0, epoch 80, cost -75.8299872971
Pre-training layer 0, epoch 80, representative training free energy -474.261655609
Pre-training layer 0, epoch 80, validation free energy -456.505994324
Pre-training layer 0, epoch 81, cost -75.7261027527
Pre-training layer 0, epoch 82, cost -75.5615834045
Pre-training layer 0, epoch 83, cost -75.5949871826
Pre-training layer 0, epoch 84, cost -75.4756053543
Pre-training layer 0, epoch 85, cost -75.3962720871
Pre-training layer 0, epoch 85, representative training free energy -470.925361267
Pre-training layer 0, epoch 85, validation free energy -451.808744476
Pre-training layer 0, epoch 86, cost -75.2922460175
Pre-training layer 0, epoch 87, cost -75.241040802
Pre-training layer 0, epoch 88, cost -75.0182676315
Pre-training layer 0, epoch 89, cost -74.7944035339
Pre-training layer 0, epoch 90, cost -74.8493157959
Pre-training layer 0, epoch 90, representative training free energy -472.116688324
Pre-training layer 0, epoch 90, validation free energy -453.262308624
Pre-training layer 0, epoch 91, cost -75.0107175064
Pre-training layer 0, epoch 92, cost -74.6417882538
Pre-training layer 0, epoch 93, cost -74.6309910202
Pre-training layer 0, epoch 94, cost -74.4928975677
Pre-training layer 0, epoch 95, cost -74.4815754318
Pre-training layer 0, epoch 95, representative training free energy -468.78237796
Pre-training layer 0, epoch 95, validation free energy -449.696633423
Pre-training layer 0, epoch 96, cost -74.3606161118
Pre-training layer 0, epoch 97, cost -74.3331801987
Pre-training layer 0, epoch 98, cost -74.1426358032
Pre-training layer 0, epoch 99, cost -74.2651616669
Pre-training layer 1, epoch 0, cost -431.118535156
Pre-training layer 1, epoch 0, representative training free energy -33077.9524502
Pre-training layer 1, epoch 0, validation free energy -32492.1621309
Pre-training layer 1, epoch 1, cost -370.582911987
Pre-training layer 1, epoch 2, cost -350.99069397
Pre-training layer 1, epoch 3, cost -339.215198669
Pre-training layer 1, epoch 4, cost -330.998265991
Pre-training layer 1, epoch 5, cost -324.577357788
Pre-training layer 1, epoch 5, representative training free energy -47411.4860635
Pre-training layer 1, epoch 5, validation free energy -46659.6549746
Pre-training layer 1, epoch 6, cost -319.830666504
Pre-training layer 1, epoch 7, cost -315.510359802
Pre-training layer 1, epoch 8, cost -312.123547974
Pre-training layer 1, epoch 9, cost -309.148342896
Pre-training layer 1, epoch 10, cost -306.463129272
Pre-training layer 1, epoch 10, representative training free energy -51765.0625273
Pre-training layer 1, epoch 10, validation free energy -50979.2916855
Pre-training layer 1, epoch 11, cost -303.995631409
Pre-training layer 1, epoch 12, cost -301.952713318
Pre-training layer 1, epoch 13, cost -300.00562561
Pre-training layer 1, epoch 14, cost -298.4121698
Pre-training layer 1, epoch 15, cost -296.884239655
Pre-training layer 1, epoch 15, representative training free energy -54268.4392998
Pre-training layer 1, epoch 15, validation free energy -53469.1668281
Pre-training layer 1, epoch 16, cost -295.494557495
Pre-training layer 1, epoch 17, cost -294.042567444
Pre-training layer 1, epoch 18, cost -292.949273682
Pre-training layer 1, epoch 19, cost -291.964954224
Pre-training layer 1, epoch 20, cost -290.902524414
Pre-training layer 1, epoch 20, representative training free energy -56001.2533818
Pre-training layer 1, epoch 20, validation free energy -55190.6260039
Pre-training layer 1, epoch 21, cost -289.977102509
Pre-training layer 1, epoch 22, cost -289.023289642
Pre-training layer 1, epoch 23, cost -288.125257263
Pre-training layer 1, epoch 24, cost -287.273808289
Pre-training layer 1, epoch 25, cost -286.641781616
Pre-training layer 1, epoch 25, representative training free energy -57404.3561387
Pre-training layer 1, epoch 25, validation free energy -56577.1956758
Pre-training layer 1, epoch 26, cost -286.138461761
Pre-training layer 1, epoch 27, cost -285.419981842
Pre-training layer 1, epoch 28, cost -284.77206604
Pre-training layer 1, epoch 29, cost -284.042029114
Pre-training layer 1, epoch 30, cost -283.630459442
Pre-training layer 1, epoch 30, representative training free energy -58384.2322734
Pre-training layer 1, epoch 30, validation free energy -57546.5855527
Pre-training layer 1, epoch 31, cost -282.838477478
Pre-training layer 1, epoch 32, cost -282.387175903
Pre-training layer 1, epoch 33, cost -281.865931091
Pre-training layer 1, epoch 34, cost -281.496031647
Pre-training layer 1, epoch 35, cost -281.117988129
Pre-training layer 1, epoch 35, representative training free energy -59363.1177617
Pre-training layer 1, epoch 35, validation free energy -58524.241584
Pre-training layer 1, epoch 36, cost -280.771216431
Pre-training layer 1, epoch 37, cost -280.181935425
Pre-training layer 1, epoch 38, cost -279.873214569
Pre-training layer 1, epoch 39, cost -279.506730499
Pre-training layer 1, epoch 40, cost -278.937357941
Pre-training layer 1, epoch 40, representative training free energy -60068.5286328
Pre-training layer 1, epoch 40, validation free energy -59231.9828047
Pre-training layer 1, epoch 41, cost -278.924670258
Pre-training layer 1, epoch 42, cost -278.443108063
Pre-training layer 1, epoch 43, cost -278.073588257
Pre-training layer 1, epoch 44, cost -277.812205505
Pre-training layer 1, epoch 45, cost -277.554138794
Pre-training layer 1, epoch 45, representative training free energy -60731.1927012
Pre-training layer 1, epoch 45, validation free energy -59885.9348633
Pre-training layer 1, epoch 46, cost -277.036130371
Pre-training layer 1, epoch 47, cost -276.967348022
Pre-training layer 1, epoch 48, cost -276.426965942
Pre-training layer 1, epoch 49, cost -276.249936676
Pre-training layer 1, epoch 50, cost -275.955043182
Pre-training layer 1, epoch 50, representative training free energy -61402.2241875
Pre-training layer 1, epoch 50, validation free energy -60548.5228047
Pre-training layer 1, epoch 51, cost -275.653874664
Pre-training layer 1, epoch 52, cost -275.535747833
Pre-training layer 1, epoch 53, cost -275.192252045
Pre-training layer 1, epoch 54, cost -275.112266846
Pre-training layer 1, epoch 55, cost -274.718983917
Pre-training layer 1, epoch 55, representative training free energy -62028.4396387
Pre-training layer 1, epoch 55, validation free energy -61177.0088516
Pre-training layer 1, epoch 56, cost -274.558987427
Pre-training layer 1, epoch 57, cost -274.309154053
Pre-training layer 1, epoch 58, cost -273.972475128
Pre-training layer 1, epoch 59, cost -273.808870087
Pre-training layer 1, epoch 60, cost -273.894705811
Pre-training layer 1, epoch 60, representative training free energy -62467.7792363
Pre-training layer 1, epoch 60, validation free energy -61600.6232578
Pre-training layer 1, epoch 61, cost -273.582852173
Pre-training layer 1, epoch 62, cost -273.341221008
Pre-training layer 1, epoch 63, cost -273.176467743
Pre-training layer 1, epoch 64, cost -273.069810791
Pre-training layer 1, epoch 65, cost -272.714744873
Pre-training layer 1, epoch 65, representative training free energy -62970.8429062
Pre-training layer 1, epoch 65, validation free energy -62100.4917051
Pre-training layer 1, epoch 66, cost -272.498018188
Pre-training layer 1, epoch 67, cost -272.474543457
Pre-training layer 1, epoch 68, cost -272.289323273
Pre-training layer 1, epoch 69, cost -272.20127182
Pre-training layer 1, epoch 70, cost -271.957322693
Pre-training layer 1, epoch 70, representative training free energy -63309.1264082
Pre-training layer 1, epoch 70, validation free energy -62439.9317539
Pre-training layer 1, epoch 71, cost -271.880610504
Pre-training layer 1, epoch 72, cost -271.515138245
Pre-training layer 1, epoch 73, cost -271.549167023
Pre-training layer 1, epoch 74, cost -271.405834045
Pre-training layer 1, epoch 75, cost -271.286707611
Pre-training layer 1, epoch 75, representative training free energy -63718.9604531
Pre-training layer 1, epoch 75, validation free energy -62848.1099609
Pre-training layer 1, epoch 76, cost -271.260893555
Pre-training layer 1, epoch 77, cost -271.016168518
Pre-training layer 1, epoch 78, cost -271.067077637
Pre-training layer 1, epoch 79, cost -270.728587952
Pre-training layer 1, epoch 80, cost -270.608813324
Pre-training layer 1, epoch 80, representative training free energy -64137.8487578
Pre-training layer 1, epoch 80, validation free energy -63266.7759551
Pre-training layer 1, epoch 81, cost -270.721182556
Pre-training layer 1, epoch 82, cost -270.558348694
Pre-training layer 1, epoch 83, cost -270.273974915
Pre-training layer 1, epoch 84, cost -270.520203247
Pre-training layer 1, epoch 85, cost -269.968629608
Pre-training layer 1, epoch 85, representative training free energy -64551.1116387
Pre-training layer 1, epoch 85, validation free energy -63682.3875332
Pre-training layer 1, epoch 86, cost -269.784295197
Pre-training layer 1, epoch 87, cost -269.848748474
Pre-training layer 1, epoch 88, cost -269.605621338
Pre-training layer 1, epoch 89, cost -269.664647064
Pre-training layer 1, epoch 90, cost -269.510668793
Pre-training layer 1, epoch 90, representative training free energy -64877.435041
Pre-training layer 1, epoch 90, validation free energy -63996.4658164
Pre-training layer 1, epoch 91, cost -269.538004608
Pre-training layer 1, epoch 92, cost -269.298248596
Pre-training layer 1, epoch 93, cost -269.263194122
Pre-training layer 1, epoch 94, cost -269.059963837
Pre-training layer 1, epoch 95, cost -268.968563843
Pre-training layer 1, epoch 95, representative training free energy -65156.3154277
Pre-training layer 1, epoch 95, validation free energy -64278.6544492
Pre-training layer 1, epoch 96, cost -268.898325958
Pre-training layer 1, epoch 97, cost -268.963047485
Pre-training layer 1, epoch 98, cost -268.751959839
Pre-training layer 1, epoch 99, cost -268.609961243
Pre-training layer 2, epoch 0, cost -162.790830994
Pre-training layer 2, epoch 0, representative training free energy 1745.58044315
Pre-training layer 2, epoch 0, validation free energy 1748.17430658
Pre-training layer 2, epoch 1, cost -108.656116486
Pre-training layer 2, epoch 2, cost -98.3251023865
Pre-training layer 2, epoch 3, cost -92.8329035187
Pre-training layer 2, epoch 4, cost -89.0685654449
Pre-training layer 2, epoch 5, cost -86.0479417419
Pre-training layer 2, epoch 5, representative training free energy 2697.29656555
Pre-training layer 2, epoch 5, validation free energy 2671.33485223
Pre-training layer 2, epoch 6, cost -84.0620030212
Pre-training layer 2, epoch 7, cost -82.1896033478
Pre-training layer 2, epoch 8, cost -80.6313831711
Pre-training layer 2, epoch 9, cost -79.4784435272
Pre-training layer 2, epoch 10, cost -78.0642776489
Pre-training layer 2, epoch 10, representative training free energy 3080.32605029
Pre-training layer 2, epoch 10, validation free energy 3044.93129694
Pre-training layer 2, epoch 11, cost -77.2659111404
Pre-training layer 2, epoch 12, cost -76.362506752
Pre-training layer 2, epoch 13, cost -75.7152581787
Pre-training layer 2, epoch 14, cost -74.8021467209
Pre-training layer 2, epoch 15, cost -74.5147789001
Pre-training layer 2, epoch 15, representative training free energy 3395.84379199
Pre-training layer 2, epoch 15, validation free energy 3348.3537572
Pre-training layer 2, epoch 16, cost -73.9871514511
Pre-training layer 2, epoch 17, cost -73.309858284
Pre-training layer 2, epoch 18, cost -72.7302745056
Pre-training layer 2, epoch 19, cost -72.2131642532
Pre-training layer 2, epoch 20, cost -71.8529929733
Pre-training layer 2, epoch 20, representative training free energy 3615.86721594
Pre-training layer 2, epoch 20, validation free energy 3568.46478271
Pre-training layer 2, epoch 21, cost -71.4924220657
Pre-training layer 2, epoch 22, cost -71.2381929398
Pre-training layer 2, epoch 23, cost -70.7257492065
Pre-training layer 2, epoch 24, cost -70.5505783081
Pre-training layer 2, epoch 25, cost -70.2636198425
Pre-training layer 2, epoch 25, representative training free energy 3863.65506482
Pre-training layer 2, epoch 25, validation free energy 3805.36867468
Pre-training layer 2, epoch 26, cost -69.9492118073
Pre-training layer 2, epoch 27, cost -69.6547432327
Pre-training layer 2, epoch 28, cost -69.4920236588
Pre-training layer 2, epoch 29, cost -69.0255609894
Pre-training layer 2, epoch 30, cost -69.0926487732
Pre-training layer 2, epoch 30, representative training free energy 4047.65805286
Pre-training layer 2, epoch 30, validation free energy 3987.727771
Pre-training layer 2, epoch 31, cost -68.7435553741
Pre-training layer 2, epoch 32, cost -68.401516571
Pre-training layer 2, epoch 33, cost -68.1950909424
Pre-training layer 2, epoch 34, cost -68.1123609924
Pre-training layer 2, epoch 35, cost -67.9066501999
Pre-training layer 2, epoch 35, representative training free energy 4246.93903162
Pre-training layer 2, epoch 35, validation free energy 4179.65982825
Pre-training layer 2, epoch 36, cost -67.9032914352
Pre-training layer 2, epoch 37, cost -67.6311408615
Pre-training layer 2, epoch 38, cost -67.390411911
Pre-training layer 2, epoch 39, cost -67.2463520813
Pre-training layer 2, epoch 40, cost -67.0914167786
Pre-training layer 2, epoch 40, representative training free energy 4411.70612244
Pre-training layer 2, epoch 40, validation free energy 4339.00314514
Pre-training layer 2, epoch 41, cost -67.0203242874
Pre-training layer 2, epoch 42, cost -66.8660214996
Pre-training layer 2, epoch 43, cost -66.5787656021
Pre-training layer 2, epoch 44, cost -66.664723587
Pre-training layer 2, epoch 45, cost -66.3154482651
Pre-training layer 2, epoch 45, representative training free energy 4562.53455786
Pre-training layer 2, epoch 45, validation free energy 4486.5604696
Pre-training layer 2, epoch 46, cost -66.2503749847
Pre-training layer 2, epoch 47, cost -65.9907652283
Pre-training layer 2, epoch 48, cost -66.2691893387
Pre-training layer 2, epoch 49, cost -66.0223412323
Pre-training layer 2, epoch 50, cost -65.9841160583
Pre-training layer 2, epoch 50, representative training free energy 4699.71079199
Pre-training layer 2, epoch 50, validation free energy 4621.33738818
Pre-training layer 2, epoch 51, cost -65.723612442
Pre-training layer 2, epoch 52, cost -65.6781492996
Pre-training layer 2, epoch 53, cost -65.3389988708
Pre-training layer 2, epoch 54, cost -65.3399637222
Pre-training layer 2, epoch 55, cost -65.3131508255
Pre-training layer 2, epoch 55, representative training free energy 4823.22833826
Pre-training layer 2, epoch 55, validation free energy 4741.92401318
Pre-training layer 2, epoch 56, cost -65.2649663544
Pre-training layer 2, epoch 57, cost -65.352401123
Pre-training layer 2, epoch 58, cost -65.0916099167
Pre-training layer 2, epoch 59, cost -65.0013880539
Pre-training layer 2, epoch 60, cost -64.9506835175
Pre-training layer 2, epoch 60, representative training free energy 4941.45315491
Pre-training layer 2, epoch 60, validation free energy 4857.8279812
Pre-training layer 2, epoch 61, cost -64.7288889313
Pre-training layer 2, epoch 62, cost -64.8517893219
Pre-training layer 2, epoch 63, cost -64.7128734207
Pre-training layer 2, epoch 64, cost -64.8093079758
Pre-training layer 2, epoch 65, cost -64.4962067032
Pre-training layer 2, epoch 65, representative training free energy 5069.78809106
Pre-training layer 2, epoch 65, validation free energy 4981.65875012
Pre-training layer 2, epoch 66, cost -64.5508552551
Pre-training layer 2, epoch 67, cost -64.5288460922
Pre-training layer 2, epoch 68, cost -64.3251319504
Pre-training layer 2, epoch 69, cost -64.3521480179
Pre-training layer 2, epoch 70, cost -64.2756035995
Pre-training layer 2, epoch 70, representative training free energy 5192.66962122
Pre-training layer 2, epoch 70, validation free energy 5102.8754458
Pre-training layer 2, epoch 71, cost -64.2418965912
Pre-training layer 2, epoch 72, cost -64.1013276672
Pre-training layer 2, epoch 73, cost -63.9819231033
Pre-training layer 2, epoch 74, cost -64.0056270599
Pre-training layer 2, epoch 75, cost -64.0463453293
Pre-training layer 2, epoch 75, representative training free energy 5282.60807959
Pre-training layer 2, epoch 75, validation free energy 5186.83872693
Pre-training layer 2, epoch 76, cost -63.8974499893
Pre-training layer 2, epoch 77, cost -63.8940399933
Pre-training layer 2, epoch 78, cost -63.7951406097
Pre-training layer 2, epoch 79, cost -63.5922277451
Pre-training layer 2, epoch 80, cost -63.88974823
Pre-training layer 2, epoch 80, representative training free energy 5394.88109656
Pre-training layer 2, epoch 80, validation free energy 5299.14501221
Pre-training layer 2, epoch 81, cost -63.584970932
Pre-training layer 2, epoch 82, cost -63.5755953217
Pre-training layer 2, epoch 83, cost -63.6180078506
Pre-training layer 2, epoch 84, cost -63.4095062256
Pre-training layer 2, epoch 85, cost -63.3712372208
Pre-training layer 2, epoch 85, representative training free energy 5483.73145313
Pre-training layer 2, epoch 85, validation free energy 5383.98317932
Pre-training layer 2, epoch 86, cost -63.3684021378
Pre-training layer 2, epoch 87, cost -63.4859049225
Pre-training layer 2, epoch 88, cost -63.2741813278
Pre-training layer 2, epoch 89, cost -63.2133861923
Pre-training layer 2, epoch 90, cost -63.2609533691
Pre-training layer 2, epoch 90, representative training free energy 5582.63750781
Pre-training layer 2, epoch 90, validation free energy 5481.13961987
Pre-training layer 2, epoch 91, cost -63.4082532883
Pre-training layer 2, epoch 92, cost -63.2339634705
Pre-training layer 2, epoch 93, cost -63.131571846
Pre-training layer 2, epoch 94, cost -63.3054795074
Pre-training layer 2, epoch 95, cost -63.1023304367
Pre-training layer 2, epoch 95, representative training free energy 5685.24393103
Pre-training layer 2, epoch 95, validation free energy 5581.09167261
Pre-training layer 2, epoch 96, cost -63.1624297333
Pre-training layer 2, epoch 97, cost -63.021750946
Pre-training layer 2, epoch 98, cost -62.8512496948
Pre-training layer 2, epoch 99, cost -63.0170826721
The pretraining code for file dbn_loop.pyc ran for 2.79m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 37.900000 %
     epoch 1, minibatch 100/100, test error of best model 28.700000 %
epoch 2, minibatch 100/100, validation error 32.800000 %
     epoch 2, minibatch 100/100, test error of best model 21.100000 %
epoch 3, minibatch 100/100, validation error 30.000000 %
     epoch 3, minibatch 100/100, test error of best model 16.800000 %
epoch 4, minibatch 100/100, validation error 29.100000 %
     epoch 4, minibatch 100/100, test error of best model 15.800000 %
epoch 5, minibatch 100/100, validation error 28.200000 %
     epoch 5, minibatch 100/100, test error of best model 15.300000 %
epoch 6, minibatch 100/100, validation error 27.700000 %
     epoch 6, minibatch 100/100, test error of best model 14.500000 %
epoch 7, minibatch 100/100, validation error 27.300000 %
     epoch 7, minibatch 100/100, test error of best model 14.100000 %
epoch 8, minibatch 100/100, validation error 27.000000 %
     epoch 8, minibatch 100/100, test error of best model 13.500000 %
epoch 9, minibatch 100/100, validation error 26.400000 %
     epoch 9, minibatch 100/100, test error of best model 12.900000 %
epoch 10, minibatch 100/100, validation error 26.000000 %
     epoch 10, minibatch 100/100, test error of best model 12.900000 %
epoch 11, minibatch 100/100, validation error 25.800000 %
     epoch 11, minibatch 100/100, test error of best model 12.300000 %
epoch 12, minibatch 100/100, validation error 25.400000 %
     epoch 12, minibatch 100/100, test error of best model 12.200000 %
epoch 13, minibatch 100/100, validation error 25.300000 %
     epoch 13, minibatch 100/100, test error of best model 12.000000 %
epoch 14, minibatch 100/100, validation error 25.200000 %
     epoch 14, minibatch 100/100, test error of best model 11.900000 %
epoch 15, minibatch 100/100, validation error 25.200000 %
epoch 16, minibatch 100/100, validation error 25.100000 %
     epoch 16, minibatch 100/100, test error of best model 12.200000 %
epoch 17, minibatch 100/100, validation error 25.000000 %
     epoch 17, minibatch 100/100, test error of best model 12.300000 %
epoch 18, minibatch 100/100, validation error 24.800000 %
     epoch 18, minibatch 100/100, test error of best model 12.100000 %
epoch 19, minibatch 100/100, validation error 25.100000 %
epoch 20, minibatch 100/100, validation error 25.100000 %
epoch 21, minibatch 100/100, validation error 25.100000 %
epoch 22, minibatch 100/100, validation error 25.200000 %
epoch 23, minibatch 100/100, validation error 25.300000 %
epoch 24, minibatch 100/100, validation error 25.300000 %
epoch 25, minibatch 100/100, validation error 25.100000 %
epoch 26, minibatch 100/100, validation error 25.200000 %
epoch 27, minibatch 100/100, validation error 25.100000 %
epoch 28, minibatch 100/100, validation error 25.100000 %
epoch 29, minibatch 100/100, validation error 25.200000 %
epoch 30, minibatch 100/100, validation error 25.200000 %
epoch 31, minibatch 100/100, validation error 25.200000 %
epoch 32, minibatch 100/100, validation error 25.100000 %
epoch 33, minibatch 100/100, validation error 25.100000 %
epoch 34, minibatch 100/100, validation error 25.100000 %
epoch 35, minibatch 100/100, validation error 25.100000 %
Optimization complete with best validation score of 24.800000 %, obtained at iteration 1800, with test performance 12.100000 %
The fine tuning code for file dbn_loop.pyc ran for 0.45m


==========Sample: (2000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.51543232
Pre-training layer 0, epoch 0, representative training free energy -580.808199738
Pre-training layer 0, epoch 0, validation free energy -578.679724579
Pre-training layer 0, epoch 1, cost -123.699727402
Pre-training layer 0, epoch 2, cost -113.957404366
Pre-training layer 0, epoch 3, cost -108.09763134
Pre-training layer 0, epoch 4, cost -104.201934929
Pre-training layer 0, epoch 5, cost -101.249933434
Pre-training layer 0, epoch 5, representative training free energy -526.193291107
Pre-training layer 0, epoch 5, validation free energy -519.720403961
Pre-training layer 0, epoch 6, cost -98.9859571838
Pre-training layer 0, epoch 7, cost -96.7254470444
Pre-training layer 0, epoch 8, cost -95.2706474304
Pre-training layer 0, epoch 9, cost -93.8618342209
Pre-training layer 0, epoch 10, cost -92.4758456421
Pre-training layer 0, epoch 10, representative training free energy -506.673824097
Pre-training layer 0, epoch 10, validation free energy -498.769209747
Pre-training layer 0, epoch 11, cost -91.6074048233
Pre-training layer 0, epoch 12, cost -90.4494445038
Pre-training layer 0, epoch 13, cost -89.6685334396
Pre-training layer 0, epoch 14, cost -88.908269043
Pre-training layer 0, epoch 15, cost -88.1316692352
Pre-training layer 0, epoch 15, representative training free energy -492.70476358
Pre-training layer 0, epoch 15, validation free energy -484.845979309
Pre-training layer 0, epoch 16, cost -87.6402698898
Pre-training layer 0, epoch 17, cost -86.8847944641
Pre-training layer 0, epoch 18, cost -86.4052373505
Pre-training layer 0, epoch 19, cost -85.9416078568
Pre-training layer 0, epoch 20, cost -85.5040763092
Pre-training layer 0, epoch 20, representative training free energy -482.993518433
Pre-training layer 0, epoch 20, validation free energy -473.992195251
Pre-training layer 0, epoch 21, cost -84.9279112434
Pre-training layer 0, epoch 22, cost -84.3861745071
Pre-training layer 0, epoch 23, cost -84.1222415543
Pre-training layer 0, epoch 24, cost -83.7354332733
Pre-training layer 0, epoch 25, cost -83.5029380417
Pre-training layer 0, epoch 25, representative training free energy -474.427221405
Pre-training layer 0, epoch 25, validation free energy -463.908550629
Pre-training layer 0, epoch 26, cost -83.1238751984
Pre-training layer 0, epoch 27, cost -82.9254894638
Pre-training layer 0, epoch 28, cost -82.5002323723
Pre-training layer 0, epoch 29, cost -82.1591659927
Pre-training layer 0, epoch 30, cost -81.8513413811
Pre-training layer 0, epoch 30, representative training free energy -473.707363525
Pre-training layer 0, epoch 30, validation free energy -462.79847876
Pre-training layer 0, epoch 31, cost -81.5997174454
Pre-training layer 0, epoch 32, cost -81.448215847
Pre-training layer 0, epoch 33, cost -80.9429197121
Pre-training layer 0, epoch 34, cost -80.9771946335
Pre-training layer 0, epoch 35, cost -80.6791697121
Pre-training layer 0, epoch 35, representative training free energy -469.753217804
Pre-training layer 0, epoch 35, validation free energy -458.717452423
Pre-training layer 0, epoch 36, cost -80.4872491455
Pre-training layer 0, epoch 37, cost -80.2392937469
Pre-training layer 0, epoch 38, cost -80.0395394325
Pre-training layer 0, epoch 39, cost -79.7899339294
Pre-training layer 0, epoch 40, cost -79.4853024864
Pre-training layer 0, epoch 40, representative training free energy -467.441682709
Pre-training layer 0, epoch 40, validation free energy -457.803110046
Pre-training layer 0, epoch 41, cost -79.3412187576
Pre-training layer 0, epoch 42, cost -79.433661232
Pre-training layer 0, epoch 43, cost -79.0110403442
Pre-training layer 0, epoch 44, cost -78.8615313911
Pre-training layer 0, epoch 45, cost -78.7998157692
Pre-training layer 0, epoch 45, representative training free energy -464.674532745
Pre-training layer 0, epoch 45, validation free energy -453.333175629
Pre-training layer 0, epoch 46, cost -78.4397900772
Pre-training layer 0, epoch 47, cost -78.3727976799
Pre-training layer 0, epoch 48, cost -78.2702985191
Pre-training layer 0, epoch 49, cost -78.1227080345
Pre-training layer 0, epoch 50, cost -78.0286509895
Pre-training layer 0, epoch 50, representative training free energy -463.764428619
Pre-training layer 0, epoch 50, validation free energy -451.674924622
Pre-training layer 0, epoch 51, cost -77.8831585121
Pre-training layer 0, epoch 52, cost -77.7215187836
Pre-training layer 0, epoch 53, cost -77.6401576996
Pre-training layer 0, epoch 54, cost -77.600002861
Pre-training layer 0, epoch 55, cost -77.4900711823
Pre-training layer 0, epoch 55, representative training free energy -461.049990753
Pre-training layer 0, epoch 55, validation free energy -449.964199493
Pre-training layer 0, epoch 56, cost -77.3148517036
Pre-training layer 0, epoch 57, cost -77.0747187042
Pre-training layer 0, epoch 58, cost -77.0501084328
Pre-training layer 0, epoch 59, cost -76.8437573624
Pre-training layer 0, epoch 60, cost -76.7039279175
Pre-training layer 0, epoch 60, representative training free energy -459.978633209
Pre-training layer 0, epoch 60, validation free energy -448.284821381
Pre-training layer 0, epoch 61, cost -76.6484518433
Pre-training layer 0, epoch 62, cost -76.4243807411
Pre-training layer 0, epoch 63, cost -76.2939599419
Pre-training layer 0, epoch 64, cost -76.2626840591
Pre-training layer 0, epoch 65, cost -76.0766469193
Pre-training layer 0, epoch 65, representative training free energy -457.946925659
Pre-training layer 0, epoch 65, validation free energy -445.691340149
Pre-training layer 0, epoch 66, cost -76.2179563141
Pre-training layer 0, epoch 67, cost -76.0730222321
Pre-training layer 0, epoch 68, cost -76.0069319725
Pre-training layer 0, epoch 69, cost -75.8738560486
Pre-training layer 0, epoch 70, cost -75.6970747948
Pre-training layer 0, epoch 70, representative training free energy -462.273574463
Pre-training layer 0, epoch 70, validation free energy -449.347722412
Pre-training layer 0, epoch 71, cost -75.7469511032
Pre-training layer 0, epoch 72, cost -75.5378974152
Pre-training layer 0, epoch 73, cost -75.4501147079
Pre-training layer 0, epoch 74, cost -75.4046714401
Pre-training layer 0, epoch 75, cost -75.2943277359
Pre-training layer 0, epoch 75, representative training free energy -455.903578156
Pre-training layer 0, epoch 75, validation free energy -443.325049133
Pre-training layer 0, epoch 76, cost -75.1955586815
Pre-training layer 0, epoch 77, cost -75.2247109604
Pre-training layer 0, epoch 78, cost -75.0334795952
Pre-training layer 0, epoch 79, cost -75.0656338501
Pre-training layer 0, epoch 80, cost -74.8508841515
Pre-training layer 0, epoch 80, representative training free energy -455.664221558
Pre-training layer 0, epoch 80, validation free energy -442.339336884
Pre-training layer 0, epoch 81, cost -74.7689570618
Pre-training layer 0, epoch 82, cost -74.8177437401
Pre-training layer 0, epoch 83, cost -74.6034464073
Pre-training layer 0, epoch 84, cost -74.527082119
Pre-training layer 0, epoch 85, cost -74.4709627914
Pre-training layer 0, epoch 85, representative training free energy -455.048469818
Pre-training layer 0, epoch 85, validation free energy -441.238115631
Pre-training layer 0, epoch 86, cost -74.5502585411
Pre-training layer 0, epoch 87, cost -74.4361126328
Pre-training layer 0, epoch 88, cost -74.1842198753
Pre-training layer 0, epoch 89, cost -74.3267393303
Pre-training layer 0, epoch 90, cost -74.1343786621
Pre-training layer 0, epoch 90, representative training free energy -456.468614777
Pre-training layer 0, epoch 90, validation free energy -442.552766144
Pre-training layer 0, epoch 91, cost -74.2347172928
Pre-training layer 0, epoch 92, cost -73.9468741989
Pre-training layer 0, epoch 93, cost -73.9641058159
Pre-training layer 0, epoch 94, cost -73.8929751778
Pre-training layer 0, epoch 95, cost -73.8155773735
Pre-training layer 0, epoch 95, representative training free energy -452.751390076
Pre-training layer 0, epoch 95, validation free energy -439.083512268
Pre-training layer 0, epoch 96, cost -73.9171385574
Pre-training layer 0, epoch 97, cost -73.6850620079
Pre-training layer 0, epoch 98, cost -73.5982536888
Pre-training layer 0, epoch 99, cost -73.6752375031
Pre-training layer 1, epoch 0, cost -375.42579689
Pre-training layer 1, epoch 0, representative training free energy -42426.6709795
Pre-training layer 1, epoch 0, validation free energy -42141.6235635
Pre-training layer 1, epoch 1, cost -323.173388138
Pre-training layer 1, epoch 2, cost -306.956618195
Pre-training layer 1, epoch 3, cost -297.180711441
Pre-training layer 1, epoch 4, cost -290.101884384
Pre-training layer 1, epoch 5, cost -284.818061981
Pre-training layer 1, epoch 5, representative training free energy -58134.9579277
Pre-training layer 1, epoch 5, validation free energy -57700.5794805
Pre-training layer 1, epoch 6, cost -280.901310501
Pre-training layer 1, epoch 7, cost -277.583907471
Pre-training layer 1, epoch 8, cost -274.571936874
Pre-training layer 1, epoch 9, cost -272.439848022
Pre-training layer 1, epoch 10, cost -270.031020966
Pre-training layer 1, epoch 10, representative training free energy -62703.2387324
Pre-training layer 1, epoch 10, validation free energy -62248.4433359
Pre-training layer 1, epoch 11, cost -268.358670425
Pre-training layer 1, epoch 12, cost -266.777253876
Pre-training layer 1, epoch 13, cost -265.188138199
Pre-training layer 1, epoch 14, cost -263.806794128
Pre-training layer 1, epoch 15, cost -262.749775085
Pre-training layer 1, epoch 15, representative training free energy -65479.444293
Pre-training layer 1, epoch 15, validation free energy -65006.860834
Pre-training layer 1, epoch 16, cost -261.823516083
Pre-training layer 1, epoch 17, cost -260.673646774
Pre-training layer 1, epoch 18, cost -259.866534576
Pre-training layer 1, epoch 19, cost -258.916049118
Pre-training layer 1, epoch 20, cost -258.023243637
Pre-training layer 1, epoch 20, representative training free energy -67490.6553867
Pre-training layer 1, epoch 20, validation free energy -67008.3109785
Pre-training layer 1, epoch 21, cost -257.518892975
Pre-training layer 1, epoch 22, cost -256.84354866
Pre-training layer 1, epoch 23, cost -256.270914078
Pre-training layer 1, epoch 24, cost -255.697699127
Pre-training layer 1, epoch 25, cost -255.014247208
Pre-training layer 1, epoch 25, representative training free energy -68975.3143809
Pre-training layer 1, epoch 25, validation free energy -68491.4552012
Pre-training layer 1, epoch 26, cost -254.582343369
Pre-training layer 1, epoch 27, cost -253.964509964
Pre-training layer 1, epoch 28, cost -253.621984482
Pre-training layer 1, epoch 29, cost -253.345597763
Pre-training layer 1, epoch 30, cost -252.995505829
Pre-training layer 1, epoch 30, representative training free energy -70171.7613848
Pre-training layer 1, epoch 30, validation free energy -69677.0525176
Pre-training layer 1, epoch 31, cost -252.460185165
Pre-training layer 1, epoch 32, cost -251.977976532
Pre-training layer 1, epoch 33, cost -251.713884964
Pre-training layer 1, epoch 34, cost -251.462737579
Pre-training layer 1, epoch 35, cost -251.142689743
Pre-training layer 1, epoch 35, representative training free energy -71212.3643984
Pre-training layer 1, epoch 35, validation free energy -70728.614623
Pre-training layer 1, epoch 36, cost -250.833274307
Pre-training layer 1, epoch 37, cost -250.489278336
Pre-training layer 1, epoch 38, cost -250.279804687
Pre-training layer 1, epoch 39, cost -249.931484756
Pre-training layer 1, epoch 40, cost -249.633512878
Pre-training layer 1, epoch 40, representative training free energy -72064.3125508
Pre-training layer 1, epoch 40, validation free energy -71558.4435547
Pre-training layer 1, epoch 41, cost -249.439008255
Pre-training layer 1, epoch 42, cost -249.284283981
Pre-training layer 1, epoch 43, cost -249.083646393
Pre-training layer 1, epoch 44, cost -248.74775322
Pre-training layer 1, epoch 45, cost -248.729927979
Pre-training layer 1, epoch 45, representative training free energy -72814.8848223
Pre-training layer 1, epoch 45, validation free energy -72299.3341953
Pre-training layer 1, epoch 46, cost -248.412511215
Pre-training layer 1, epoch 47, cost -248.259572372
Pre-training layer 1, epoch 48, cost -248.028610153
Pre-training layer 1, epoch 49, cost -247.919470291
Pre-training layer 1, epoch 50, cost -247.617544861
Pre-training layer 1, epoch 50, representative training free energy -73481.7779414
Pre-training layer 1, epoch 50, validation free energy -72962.0920234
Pre-training layer 1, epoch 51, cost -247.456609039
Pre-training layer 1, epoch 52, cost -247.401927567
Pre-training layer 1, epoch 53, cost -247.097941132
Pre-training layer 1, epoch 54, cost -247.019762955
Pre-training layer 1, epoch 55, cost -246.764089966
Pre-training layer 1, epoch 55, representative training free energy -74132.8428242
Pre-training layer 1, epoch 55, validation free energy -73610.4986562
Pre-training layer 1, epoch 56, cost -246.661486511
Pre-training layer 1, epoch 57, cost -246.546470871
Pre-training layer 1, epoch 58, cost -246.41590744
Pre-training layer 1, epoch 59, cost -246.314989548
Pre-training layer 1, epoch 60, cost -246.167484665
Pre-training layer 1, epoch 60, representative training free energy -74755.8749453
Pre-training layer 1, epoch 60, validation free energy -74224.2469434
Pre-training layer 1, epoch 61, cost -246.005736465
Pre-training layer 1, epoch 62, cost -245.789316177
Pre-training layer 1, epoch 63, cost -245.902742615
Pre-training layer 1, epoch 64, cost -245.701104202
Pre-training layer 1, epoch 65, cost -245.478895035
Pre-training layer 1, epoch 65, representative training free energy -75278.08625
Pre-training layer 1, epoch 65, validation free energy -74751.6237012
Pre-training layer 1, epoch 66, cost -245.604475021
Pre-training layer 1, epoch 67, cost -245.319804688
Pre-training layer 1, epoch 68, cost -245.331810913
Pre-training layer 1, epoch 69, cost -245.117538071
Pre-training layer 1, epoch 70, cost -244.877114258
Pre-training layer 1, epoch 70, representative training free energy -75704.239248
Pre-training layer 1, epoch 70, validation free energy -75170.571084
Pre-training layer 1, epoch 71, cost -244.916360474
Pre-training layer 1, epoch 72, cost -244.747684402
Pre-training layer 1, epoch 73, cost -244.789584503
Pre-training layer 1, epoch 74, cost -244.53376091
Pre-training layer 1, epoch 75, cost -244.483915863
Pre-training layer 1, epoch 75, representative training free energy -76277.9476602
Pre-training layer 1, epoch 75, validation free energy -75744.6046758
Pre-training layer 1, epoch 76, cost -244.42394249
Pre-training layer 1, epoch 77, cost -244.417837524
Pre-training layer 1, epoch 78, cost -244.182692108
Pre-training layer 1, epoch 79, cost -244.143051376
Pre-training layer 1, epoch 80, cost -244.120571747
Pre-training layer 1, epoch 80, representative training free energy -76645.7384395
Pre-training layer 1, epoch 80, validation free energy -76099.8665918
Pre-training layer 1, epoch 81, cost -243.917475433
Pre-training layer 1, epoch 82, cost -243.918421707
Pre-training layer 1, epoch 83, cost -243.776339951
Pre-training layer 1, epoch 84, cost -243.728717728
Pre-training layer 1, epoch 85, cost -243.646276703
Pre-training layer 1, epoch 85, representative training free energy -77099.4947969
Pre-training layer 1, epoch 85, validation free energy -76549.773002
Pre-training layer 1, epoch 86, cost -243.598284683
Pre-training layer 1, epoch 87, cost -243.556332092
Pre-training layer 1, epoch 88, cost -243.451177673
Pre-training layer 1, epoch 89, cost -243.334649811
Pre-training layer 1, epoch 90, cost -243.23681076
Pre-training layer 1, epoch 90, representative training free energy -77510.3475723
Pre-training layer 1, epoch 90, validation free energy -76957.5130293
Pre-training layer 1, epoch 91, cost -243.292545929
Pre-training layer 1, epoch 92, cost -243.126837769
Pre-training layer 1, epoch 93, cost -243.021682587
Pre-training layer 1, epoch 94, cost -242.992939224
Pre-training layer 1, epoch 95, cost -242.93179184
Pre-training layer 1, epoch 95, representative training free energy -77791.0677207
Pre-training layer 1, epoch 95, validation free energy -77240.8281191
Pre-training layer 1, epoch 96, cost -242.8182341
Pre-training layer 1, epoch 97, cost -242.831150131
Pre-training layer 1, epoch 98, cost -242.747453384
Pre-training layer 1, epoch 99, cost -242.801160583
Pre-training layer 2, epoch 0, cost -136.51597702
Pre-training layer 2, epoch 0, representative training free energy 1983.17795874
Pre-training layer 2, epoch 0, validation free energy 2001.81804132
Pre-training layer 2, epoch 1, cost -97.0700588226
Pre-training layer 2, epoch 2, cost -89.1998531342
Pre-training layer 2, epoch 3, cost -84.8439962578
Pre-training layer 2, epoch 4, cost -82.0072567558
Pre-training layer 2, epoch 5, cost -79.611417942
Pre-training layer 2, epoch 5, representative training free energy 3411.10411938
Pre-training layer 2, epoch 5, validation free energy 3400.13609222
Pre-training layer 2, epoch 6, cost -77.6038146973
Pre-training layer 2, epoch 7, cost -76.5063368416
Pre-training layer 2, epoch 8, cost -75.0768881607
Pre-training layer 2, epoch 9, cost -74.1167566872
Pre-training layer 2, epoch 10, cost -73.4632186317
Pre-training layer 2, epoch 10, representative training free energy 4166.21564874
Pre-training layer 2, epoch 10, validation free energy 4156.08046436
Pre-training layer 2, epoch 11, cost -72.4176032448
Pre-training layer 2, epoch 12, cost -71.6662921524
Pre-training layer 2, epoch 13, cost -71.2386317444
Pre-training layer 2, epoch 14, cost -70.7866618729
Pre-training layer 2, epoch 15, cost -70.1405499077
Pre-training layer 2, epoch 15, representative training free energy 4688.58169714
Pre-training layer 2, epoch 15, validation free energy 4661.72891315
Pre-training layer 2, epoch 16, cost -69.7814915276
Pre-training layer 2, epoch 17, cost -69.3031926155
Pre-training layer 2, epoch 18, cost -68.9978151894
Pre-training layer 2, epoch 19, cost -68.7244657898
Pre-training layer 2, epoch 20, cost -68.3277964211
Pre-training layer 2, epoch 20, representative training free energy 5164.7647019
Pre-training layer 2, epoch 20, validation free energy 5140.9979834
Pre-training layer 2, epoch 21, cost -68.1011322594
Pre-training layer 2, epoch 22, cost -67.6984647179
Pre-training layer 2, epoch 23, cost -67.5363069534
Pre-training layer 2, epoch 24, cost -67.2335762024
Pre-training layer 2, epoch 25, cost -66.9989967728
Pre-training layer 2, epoch 25, representative training free energy 5547.63881921
Pre-training layer 2, epoch 25, validation free energy 5518.57424622
Pre-training layer 2, epoch 26, cost -66.7248863411
Pre-training layer 2, epoch 27, cost -66.592097683
Pre-training layer 2, epoch 28, cost -66.4050807381
Pre-training layer 2, epoch 29, cost -66.2260685349
Pre-training layer 2, epoch 30, cost -66.1097977066
Pre-training layer 2, epoch 30, representative training free energy 5809.48869299
Pre-training layer 2, epoch 30, validation free energy 5783.21396606
Pre-training layer 2, epoch 31, cost -65.7562168884
Pre-training layer 2, epoch 32, cost -65.7302480125
Pre-training layer 2, epoch 33, cost -65.4816337013
Pre-training layer 2, epoch 34, cost -65.4160817528
Pre-training layer 2, epoch 35, cost -65.3303595734
Pre-training layer 2, epoch 35, representative training free energy 6081.16205298
Pre-training layer 2, epoch 35, validation free energy 6051.41065015
Pre-training layer 2, epoch 36, cost -65.1097394753
Pre-training layer 2, epoch 37, cost -65.1000338173
Pre-training layer 2, epoch 38, cost -64.8894771004
Pre-training layer 2, epoch 39, cost -64.9252783012
Pre-training layer 2, epoch 40, cost -64.6629410744
Pre-training layer 2, epoch 40, representative training free energy 6354.0394762
Pre-training layer 2, epoch 40, validation free energy 6320.67909119
Pre-training layer 2, epoch 41, cost -64.7260143089
Pre-training layer 2, epoch 42, cost -64.5819571495
Pre-training layer 2, epoch 43, cost -64.3798841476
Pre-training layer 2, epoch 44, cost -64.3529986191
Pre-training layer 2, epoch 45, cost -64.2225651932
Pre-training layer 2, epoch 45, representative training free energy 6604.25470679
Pre-training layer 2, epoch 45, validation free energy 6560.74380347
Pre-training layer 2, epoch 46, cost -64.0791173363
Pre-training layer 2, epoch 47, cost -64.165901947
Pre-training layer 2, epoch 48, cost -64.0132412529
Pre-training layer 2, epoch 49, cost -63.7181898499
Pre-training layer 2, epoch 50, cost -63.7586290741
Pre-training layer 2, epoch 50, representative training free energy 6822.54481909
Pre-training layer 2, epoch 50, validation free energy 6777.55735486
Pre-training layer 2, epoch 51, cost -63.7392000389
Pre-training layer 2, epoch 52, cost -63.7634692383
Pre-training layer 2, epoch 53, cost -63.5332127953
Pre-training layer 2, epoch 54, cost -63.6115280342
Pre-training layer 2, epoch 55, cost -63.5751723862
Pre-training layer 2, epoch 55, representative training free energy 7027.88464063
Pre-training layer 2, epoch 55, validation free energy 6979.15434497
Pre-training layer 2, epoch 56, cost -63.4568580437
Pre-training layer 2, epoch 57, cost -63.2823845291
Pre-training layer 2, epoch 58, cost -63.3481447983
Pre-training layer 2, epoch 59, cost -63.3079215622
Pre-training layer 2, epoch 60, cost -63.2405272675
Pre-training layer 2, epoch 60, representative training free energy 7226.05208081
Pre-training layer 2, epoch 60, validation free energy 7172.93903271
Pre-training layer 2, epoch 61, cost -63.1558446884
Pre-training layer 2, epoch 62, cost -62.9935786819
Pre-training layer 2, epoch 63, cost -63.114445858
Pre-training layer 2, epoch 64, cost -62.9677969551
Pre-training layer 2, epoch 65, cost -62.9407674408
Pre-training layer 2, epoch 65, representative training free energy 7427.38565454
Pre-training layer 2, epoch 65, validation free energy 7372.44876685
Pre-training layer 2, epoch 66, cost -62.8357370567
Pre-training layer 2, epoch 67, cost -62.8991992569
Pre-training layer 2, epoch 68, cost -62.7931169319
Pre-training layer 2, epoch 69, cost -62.6745482254
Pre-training layer 2, epoch 70, cost -62.5929797173
Pre-training layer 2, epoch 70, representative training free energy 7607.82156689
Pre-training layer 2, epoch 70, validation free energy 7551.64987231
Pre-training layer 2, epoch 71, cost -62.7262975693
Pre-training layer 2, epoch 72, cost -62.5994385719
Pre-training layer 2, epoch 73, cost -62.6014578819
Pre-training layer 2, epoch 74, cost -62.5214912415
Pre-training layer 2, epoch 75, cost -62.6272288895
Pre-training layer 2, epoch 75, representative training free energy 7773.08904175
Pre-training layer 2, epoch 75, validation free energy 7716.67985425
Pre-training layer 2, epoch 76, cost -62.4876043701
Pre-training layer 2, epoch 77, cost -62.4528125
Pre-training layer 2, epoch 78, cost -62.4208791924
Pre-training layer 2, epoch 79, cost -62.2931923866
Pre-training layer 2, epoch 80, cost -62.3907281113
Pre-training layer 2, epoch 80, representative training free energy 7936.54260938
Pre-training layer 2, epoch 80, validation free energy 7878.61018213
Pre-training layer 2, epoch 81, cost -62.25150877
Pre-training layer 2, epoch 82, cost -62.3096977997
Pre-training layer 2, epoch 83, cost -62.2793394279
Pre-training layer 2, epoch 84, cost -62.1813243294
Pre-training layer 2, epoch 85, cost -62.1452776909
Pre-training layer 2, epoch 85, representative training free energy 8098.29040625
Pre-training layer 2, epoch 85, validation free energy 8038.14371802
Pre-training layer 2, epoch 86, cost -62.1558776665
Pre-training layer 2, epoch 87, cost -62.0699129295
Pre-training layer 2, epoch 88, cost -62.094597168
Pre-training layer 2, epoch 89, cost -62.0782382584
Pre-training layer 2, epoch 90, cost -61.9798666191
Pre-training layer 2, epoch 90, representative training free energy 8235.28569141
Pre-training layer 2, epoch 90, validation free energy 8174.7514436
Pre-training layer 2, epoch 91, cost -61.9183349609
Pre-training layer 2, epoch 92, cost -61.9233531761
Pre-training layer 2, epoch 93, cost -61.8584832191
Pre-training layer 2, epoch 94, cost -61.985840683
Pre-training layer 2, epoch 95, cost -61.9263936806
Pre-training layer 2, epoch 95, representative training free energy 8383.64430273
Pre-training layer 2, epoch 95, validation free energy 8319.77876709
Pre-training layer 2, epoch 96, cost -61.8082716751
Pre-training layer 2, epoch 97, cost -61.8490314293
Pre-training layer 2, epoch 98, cost -61.7377336502
Pre-training layer 2, epoch 99, cost -61.7856612968
The pretraining code for file dbn_loop.pyc ran for 5.39m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 36.000000 %
     epoch 1, minibatch 200/200, test error of best model 31.100000 %
epoch 2, minibatch 200/200, validation error 26.300000 %
     epoch 2, minibatch 200/200, test error of best model 20.800000 %
epoch 3, minibatch 200/200, validation error 23.000000 %
     epoch 3, minibatch 200/200, test error of best model 15.600000 %
epoch 4, minibatch 200/200, validation error 21.300000 %
     epoch 4, minibatch 200/200, test error of best model 13.200000 %
epoch 5, minibatch 200/200, validation error 20.500000 %
     epoch 5, minibatch 200/200, test error of best model 12.200000 %
epoch 6, minibatch 200/200, validation error 19.800000 %
     epoch 6, minibatch 200/200, test error of best model 11.000000 %
epoch 7, minibatch 200/200, validation error 19.400000 %
     epoch 7, minibatch 200/200, test error of best model 10.300000 %
epoch 8, minibatch 200/200, validation error 19.200000 %
     epoch 8, minibatch 200/200, test error of best model 9.900000 %
epoch 9, minibatch 200/200, validation error 18.800000 %
     epoch 9, minibatch 200/200, test error of best model 9.500000 %
epoch 10, minibatch 200/200, validation error 18.600000 %
     epoch 10, minibatch 200/200, test error of best model 9.200000 %
epoch 11, minibatch 200/200, validation error 18.300000 %
     epoch 11, minibatch 200/200, test error of best model 9.000000 %
epoch 12, minibatch 200/200, validation error 18.200000 %
     epoch 12, minibatch 200/200, test error of best model 8.700000 %
epoch 13, minibatch 200/200, validation error 17.600000 %
     epoch 13, minibatch 200/200, test error of best model 8.700000 %
epoch 14, minibatch 200/200, validation error 17.600000 %
epoch 15, minibatch 200/200, validation error 17.400000 %
     epoch 15, minibatch 200/200, test error of best model 7.900000 %
epoch 16, minibatch 200/200, validation error 17.300000 %
     epoch 16, minibatch 200/200, test error of best model 7.900000 %
epoch 17, minibatch 200/200, validation error 17.300000 %
epoch 18, minibatch 200/200, validation error 17.000000 %
     epoch 18, minibatch 200/200, test error of best model 7.500000 %
epoch 19, minibatch 200/200, validation error 16.700000 %
     epoch 19, minibatch 200/200, test error of best model 7.500000 %
epoch 20, minibatch 200/200, validation error 16.700000 %
epoch 21, minibatch 200/200, validation error 16.700000 %
epoch 22, minibatch 200/200, validation error 16.700000 %
epoch 23, minibatch 200/200, validation error 16.700000 %
epoch 24, minibatch 200/200, validation error 16.600000 %
     epoch 24, minibatch 200/200, test error of best model 7.700000 %
epoch 25, minibatch 200/200, validation error 16.500000 %
     epoch 25, minibatch 200/200, test error of best model 7.700000 %
epoch 26, minibatch 200/200, validation error 16.500000 %
epoch 27, minibatch 200/200, validation error 16.500000 %
epoch 28, minibatch 200/200, validation error 16.500000 %
epoch 29, minibatch 200/200, validation error 16.400000 %
     epoch 29, minibatch 200/200, test error of best model 7.500000 %
epoch 30, minibatch 200/200, validation error 16.500000 %
epoch 31, minibatch 200/200, validation error 16.600000 %
epoch 32, minibatch 200/200, validation error 16.600000 %
epoch 33, minibatch 200/200, validation error 16.700000 %
epoch 34, minibatch 200/200, validation error 16.800000 %
epoch 35, minibatch 200/200, validation error 16.700000 %
epoch 36, minibatch 200/200, validation error 16.700000 %
epoch 37, minibatch 200/200, validation error 16.700000 %
epoch 38, minibatch 200/200, validation error 16.700000 %
epoch 39, minibatch 200/200, validation error 16.600000 %
epoch 40, minibatch 200/200, validation error 16.600000 %
epoch 41, minibatch 200/200, validation error 16.600000 %
epoch 42, minibatch 200/200, validation error 16.500000 %
epoch 43, minibatch 200/200, validation error 16.500000 %
epoch 44, minibatch 200/200, validation error 16.400000 %
epoch 45, minibatch 200/200, validation error 16.400000 %
epoch 46, minibatch 200/200, validation error 16.500000 %
epoch 47, minibatch 200/200, validation error 16.500000 %
epoch 48, minibatch 200/200, validation error 16.500000 %
epoch 49, minibatch 200/200, validation error 16.400000 %
epoch 50, minibatch 200/200, validation error 16.400000 %
epoch 51, minibatch 200/200, validation error 16.300000 %
     epoch 51, minibatch 200/200, test error of best model 7.700000 %
epoch 52, minibatch 200/200, validation error 16.300000 %
epoch 53, minibatch 200/200, validation error 16.300000 %
epoch 54, minibatch 200/200, validation error 16.300000 %
epoch 55, minibatch 200/200, validation error 16.300000 %
epoch 56, minibatch 200/200, validation error 16.300000 %
epoch 57, minibatch 200/200, validation error 16.300000 %
epoch 58, minibatch 200/200, validation error 16.300000 %
epoch 59, minibatch 200/200, validation error 16.300000 %
epoch 60, minibatch 200/200, validation error 16.300000 %
epoch 61, minibatch 200/200, validation error 16.200000 %
     epoch 61, minibatch 200/200, test error of best model 7.700000 %
epoch 62, minibatch 200/200, validation error 16.200000 %
epoch 63, minibatch 200/200, validation error 16.200000 %
epoch 64, minibatch 200/200, validation error 16.200000 %
epoch 65, minibatch 200/200, validation error 16.200000 %
epoch 66, minibatch 200/200, validation error 16.100000 %
     epoch 66, minibatch 200/200, test error of best model 7.600000 %
epoch 67, minibatch 200/200, validation error 16.100000 %
epoch 68, minibatch 200/200, validation error 16.100000 %
epoch 69, minibatch 200/200, validation error 16.100000 %
epoch 70, minibatch 200/200, validation error 16.100000 %
epoch 71, minibatch 200/200, validation error 16.100000 %
epoch 72, minibatch 200/200, validation error 16.100000 %
epoch 73, minibatch 200/200, validation error 16.100000 %
epoch 74, minibatch 200/200, validation error 16.100000 %
epoch 75, minibatch 200/200, validation error 16.100000 %
epoch 76, minibatch 200/200, validation error 16.100000 %
epoch 77, minibatch 200/200, validation error 16.100000 %
epoch 78, minibatch 200/200, validation error 16.100000 %
epoch 79, minibatch 200/200, validation error 16.100000 %
epoch 80, minibatch 200/200, validation error 16.100000 %
epoch 81, minibatch 200/200, validation error 16.100000 %
epoch 82, minibatch 200/200, validation error 16.100000 %
epoch 83, minibatch 200/200, validation error 16.100000 %
epoch 84, minibatch 200/200, validation error 16.100000 %
epoch 85, minibatch 200/200, validation error 16.000000 %
     epoch 85, minibatch 200/200, test error of best model 7.400000 %
epoch 86, minibatch 200/200, validation error 16.000000 %
epoch 87, minibatch 200/200, validation error 16.000000 %
epoch 88, minibatch 200/200, validation error 15.900000 %
     epoch 88, minibatch 200/200, test error of best model 7.400000 %
epoch 89, minibatch 200/200, validation error 15.900000 %
epoch 90, minibatch 200/200, validation error 15.900000 %
epoch 91, minibatch 200/200, validation error 15.900000 %
epoch 92, minibatch 200/200, validation error 15.900000 %
epoch 93, minibatch 200/200, validation error 15.900000 %
epoch 94, minibatch 200/200, validation error 15.900000 %
epoch 95, minibatch 200/200, validation error 15.900000 %
epoch 96, minibatch 200/200, validation error 15.900000 %
epoch 97, minibatch 200/200, validation error 15.900000 %
epoch 98, minibatch 200/200, validation error 15.900000 %
epoch 99, minibatch 200/200, validation error 15.900000 %
epoch 100, minibatch 200/200, validation error 15.900000 %
epoch 101, minibatch 200/200, validation error 15.900000 %
epoch 102, minibatch 200/200, validation error 15.900000 %
epoch 103, minibatch 200/200, validation error 15.900000 %
epoch 104, minibatch 200/200, validation error 15.900000 %
epoch 105, minibatch 200/200, validation error 15.900000 %
epoch 106, minibatch 200/200, validation error 15.900000 %
epoch 107, minibatch 200/200, validation error 15.900000 %
epoch 108, minibatch 200/200, validation error 15.900000 %
epoch 109, minibatch 200/200, validation error 15.900000 %
epoch 110, minibatch 200/200, validation error 15.900000 %
epoch 111, minibatch 200/200, validation error 15.900000 %
epoch 112, minibatch 200/200, validation error 15.900000 %
epoch 113, minibatch 200/200, validation error 15.900000 %
epoch 114, minibatch 200/200, validation error 15.900000 %
epoch 115, minibatch 200/200, validation error 15.900000 %
epoch 116, minibatch 200/200, validation error 15.900000 %
epoch 117, minibatch 200/200, validation error 15.900000 %
epoch 118, minibatch 200/200, validation error 15.900000 %
epoch 119, minibatch 200/200, validation error 15.900000 %
epoch 120, minibatch 200/200, validation error 15.900000 %
epoch 121, minibatch 200/200, validation error 15.900000 %
epoch 122, minibatch 200/200, validation error 15.900000 %
epoch 123, minibatch 200/200, validation error 15.900000 %
epoch 124, minibatch 200/200, validation error 15.900000 %
epoch 125, minibatch 200/200, validation error 15.900000 %
epoch 126, minibatch 200/200, validation error 15.900000 %
epoch 127, minibatch 200/200, validation error 15.800000 %
     epoch 127, minibatch 200/200, test error of best model 7.600000 %
epoch 128, minibatch 200/200, validation error 15.800000 %
epoch 129, minibatch 200/200, validation error 15.800000 %
epoch 130, minibatch 200/200, validation error 15.800000 %
epoch 131, minibatch 200/200, validation error 15.800000 %
epoch 132, minibatch 200/200, validation error 15.800000 %
epoch 133, minibatch 200/200, validation error 15.800000 %
epoch 134, minibatch 200/200, validation error 15.800000 %
epoch 135, minibatch 200/200, validation error 15.800000 %
epoch 136, minibatch 200/200, validation error 15.800000 %
epoch 137, minibatch 200/200, validation error 15.800000 %
epoch 138, minibatch 200/200, validation error 15.800000 %
epoch 139, minibatch 200/200, validation error 15.900000 %
epoch 140, minibatch 200/200, validation error 15.900000 %
epoch 141, minibatch 200/200, validation error 15.900000 %
epoch 142, minibatch 200/200, validation error 15.900000 %
epoch 143, minibatch 200/200, validation error 15.900000 %
epoch 144, minibatch 200/200, validation error 15.900000 %
epoch 145, minibatch 200/200, validation error 15.900000 %
epoch 146, minibatch 200/200, validation error 15.900000 %
epoch 147, minibatch 200/200, validation error 15.900000 %
epoch 148, minibatch 200/200, validation error 15.900000 %
epoch 149, minibatch 200/200, validation error 15.900000 %
epoch 150, minibatch 200/200, validation error 15.900000 %
epoch 151, minibatch 200/200, validation error 15.900000 %
epoch 152, minibatch 200/200, validation error 15.900000 %
epoch 153, minibatch 200/200, validation error 15.900000 %
epoch 154, minibatch 200/200, validation error 15.900000 %
epoch 155, minibatch 200/200, validation error 15.900000 %
epoch 156, minibatch 200/200, validation error 15.900000 %
epoch 157, minibatch 200/200, validation error 15.900000 %
epoch 158, minibatch 200/200, validation error 15.900000 %
epoch 159, minibatch 200/200, validation error 15.900000 %
epoch 160, minibatch 200/200, validation error 15.900000 %
epoch 161, minibatch 200/200, validation error 15.900000 %
epoch 162, minibatch 200/200, validation error 15.900000 %
epoch 163, minibatch 200/200, validation error 15.900000 %
epoch 164, minibatch 200/200, validation error 15.900000 %
epoch 165, minibatch 200/200, validation error 15.900000 %
epoch 166, minibatch 200/200, validation error 15.900000 %
epoch 167, minibatch 200/200, validation error 15.900000 %
epoch 168, minibatch 200/200, validation error 15.900000 %
epoch 169, minibatch 200/200, validation error 15.900000 %
epoch 170, minibatch 200/200, validation error 15.900000 %
epoch 171, minibatch 200/200, validation error 15.900000 %
epoch 172, minibatch 200/200, validation error 15.900000 %
epoch 173, minibatch 200/200, validation error 15.900000 %
epoch 174, minibatch 200/200, validation error 15.900000 %
epoch 175, minibatch 200/200, validation error 15.900000 %
epoch 176, minibatch 200/200, validation error 15.900000 %
epoch 177, minibatch 200/200, validation error 15.900000 %
epoch 178, minibatch 200/200, validation error 15.900000 %
epoch 179, minibatch 200/200, validation error 15.900000 %
epoch 180, minibatch 200/200, validation error 15.900000 %
epoch 181, minibatch 200/200, validation error 15.900000 %
epoch 182, minibatch 200/200, validation error 15.900000 %
epoch 183, minibatch 200/200, validation error 15.900000 %
epoch 184, minibatch 200/200, validation error 15.900000 %
epoch 185, minibatch 200/200, validation error 15.900000 %
epoch 186, minibatch 200/200, validation error 15.900000 %
epoch 187, minibatch 200/200, validation error 15.900000 %
epoch 188, minibatch 200/200, validation error 15.900000 %
epoch 189, minibatch 200/200, validation error 15.900000 %
epoch 190, minibatch 200/200, validation error 15.900000 %
epoch 191, minibatch 200/200, validation error 15.900000 %
epoch 192, minibatch 200/200, validation error 15.900000 %
epoch 193, minibatch 200/200, validation error 15.900000 %
epoch 194, minibatch 200/200, validation error 15.900000 %
epoch 195, minibatch 200/200, validation error 15.900000 %
epoch 196, minibatch 200/200, validation error 15.900000 %
epoch 197, minibatch 200/200, validation error 15.900000 %
epoch 198, minibatch 200/200, validation error 15.900000 %
epoch 199, minibatch 200/200, validation error 15.900000 %
epoch 200, minibatch 200/200, validation error 15.900000 %
epoch 201, minibatch 200/200, validation error 15.900000 %
epoch 202, minibatch 200/200, validation error 15.900000 %
epoch 203, minibatch 200/200, validation error 15.900000 %
epoch 204, minibatch 200/200, validation error 15.900000 %
epoch 205, minibatch 200/200, validation error 15.900000 %
epoch 206, minibatch 200/200, validation error 15.900000 %
epoch 207, minibatch 200/200, validation error 15.900000 %
epoch 208, minibatch 200/200, validation error 15.900000 %
epoch 209, minibatch 200/200, validation error 15.900000 %
epoch 210, minibatch 200/200, validation error 15.900000 %
epoch 211, minibatch 200/200, validation error 15.900000 %
epoch 212, minibatch 200/200, validation error 15.900000 %
epoch 213, minibatch 200/200, validation error 15.900000 %
epoch 214, minibatch 200/200, validation error 15.900000 %
epoch 215, minibatch 200/200, validation error 15.900000 %
epoch 216, minibatch 200/200, validation error 15.900000 %
epoch 217, minibatch 200/200, validation error 15.900000 %
epoch 218, minibatch 200/200, validation error 15.900000 %
epoch 219, minibatch 200/200, validation error 15.900000 %
epoch 220, minibatch 200/200, validation error 15.900000 %
epoch 221, minibatch 200/200, validation error 15.900000 %
epoch 222, minibatch 200/200, validation error 15.900000 %
epoch 223, minibatch 200/200, validation error 16.000000 %
epoch 224, minibatch 200/200, validation error 16.000000 %
epoch 225, minibatch 200/200, validation error 16.000000 %
epoch 226, minibatch 200/200, validation error 16.000000 %
epoch 227, minibatch 200/200, validation error 16.000000 %
epoch 228, minibatch 200/200, validation error 16.000000 %
epoch 229, minibatch 200/200, validation error 16.000000 %
epoch 230, minibatch 200/200, validation error 16.000000 %
epoch 231, minibatch 200/200, validation error 16.000000 %
epoch 232, minibatch 200/200, validation error 16.000000 %
epoch 233, minibatch 200/200, validation error 16.000000 %
epoch 234, minibatch 200/200, validation error 16.000000 %
epoch 235, minibatch 200/200, validation error 16.000000 %
epoch 236, minibatch 200/200, validation error 16.000000 %
epoch 237, minibatch 200/200, validation error 16.000000 %
epoch 238, minibatch 200/200, validation error 16.000000 %
epoch 239, minibatch 200/200, validation error 16.000000 %
epoch 240, minibatch 200/200, validation error 16.000000 %
epoch 241, minibatch 200/200, validation error 16.000000 %
epoch 242, minibatch 200/200, validation error 16.000000 %
epoch 243, minibatch 200/200, validation error 16.000000 %
epoch 244, minibatch 200/200, validation error 16.000000 %
epoch 245, minibatch 200/200, validation error 16.000000 %
epoch 246, minibatch 200/200, validation error 16.000000 %
epoch 247, minibatch 200/200, validation error 16.000000 %
epoch 248, minibatch 200/200, validation error 16.000000 %
epoch 249, minibatch 200/200, validation error 16.000000 %
epoch 250, minibatch 200/200, validation error 16.000000 %
epoch 251, minibatch 200/200, validation error 16.000000 %
epoch 252, minibatch 200/200, validation error 16.000000 %
epoch 253, minibatch 200/200, validation error 16.000000 %
Optimization complete with best validation score of 15.800000 %, obtained at iteration 25400, with test performance 7.600000 %
The fine tuning code for file dbn_loop.pyc ran for 4.77m


==========Sample: (3000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.785203145
Pre-training layer 0, epoch 0, representative training free energy -563.245432648
Pre-training layer 0, epoch 0, validation free energy -558.611295685
Pre-training layer 0, epoch 1, cost -116.846800435
Pre-training layer 0, epoch 2, cost -107.980625203
Pre-training layer 0, epoch 3, cost -102.710417379
Pre-training layer 0, epoch 4, cost -99.1181002299
Pre-training layer 0, epoch 5, cost -96.4746275584
Pre-training layer 0, epoch 5, representative training free energy -499.888703766
Pre-training layer 0, epoch 5, validation free energy -493.218159851
Pre-training layer 0, epoch 6, cost -94.4186649323
Pre-training layer 0, epoch 7, cost -92.8927626292
Pre-training layer 0, epoch 8, cost -91.3750645192
Pre-training layer 0, epoch 9, cost -90.1351165517
Pre-training layer 0, epoch 10, cost -88.9419152323
Pre-training layer 0, epoch 10, representative training free energy -478.015095795
Pre-training layer 0, epoch 10, validation free energy -470.912361755
Pre-training layer 0, epoch 11, cost -88.1129338582
Pre-training layer 0, epoch 12, cost -87.3160711924
Pre-training layer 0, epoch 13, cost -86.713467013
Pre-training layer 0, epoch 14, cost -86.0793382517
Pre-training layer 0, epoch 15, cost -85.4766983414
Pre-training layer 0, epoch 15, representative training free energy -463.939853729
Pre-training layer 0, epoch 15, validation free energy -456.105883148
Pre-training layer 0, epoch 16, cost -85.0304383341
Pre-training layer 0, epoch 17, cost -84.2182017136
Pre-training layer 0, epoch 18, cost -83.9295778783
Pre-training layer 0, epoch 19, cost -83.4790885671
Pre-training layer 0, epoch 20, cost -82.9641724141
Pre-training layer 0, epoch 20, representative training free energy -456.426803406
Pre-training layer 0, epoch 20, validation free energy -448.591475372
Pre-training layer 0, epoch 21, cost -82.718908933
Pre-training layer 0, epoch 22, cost -82.3330143102
Pre-training layer 0, epoch 23, cost -82.1023910777
Pre-training layer 0, epoch 24, cost -81.6498976644
Pre-training layer 0, epoch 25, cost -81.4478915278
Pre-training layer 0, epoch 25, representative training free energy -451.430678833
Pre-training layer 0, epoch 25, validation free energy -443.181138184
Pre-training layer 0, epoch 26, cost -81.2527642695
Pre-training layer 0, epoch 27, cost -80.9845991643
Pre-training layer 0, epoch 28, cost -80.7401071421
Pre-training layer 0, epoch 29, cost -80.3642188136
Pre-training layer 0, epoch 30, cost -79.9634459559
Pre-training layer 0, epoch 30, representative training free energy -449.653502472
Pre-training layer 0, epoch 30, validation free energy -440.710302032
Pre-training layer 0, epoch 31, cost -79.7102204132
Pre-training layer 0, epoch 32, cost -79.7035142136
Pre-training layer 0, epoch 33, cost -79.3325734075
Pre-training layer 0, epoch 34, cost -79.3061083094
Pre-training layer 0, epoch 35, cost -79.0986973572
Pre-training layer 0, epoch 35, representative training free energy -446.478035858
Pre-training layer 0, epoch 35, validation free energy -436.91115686
Pre-training layer 0, epoch 36, cost -79.0399650447
Pre-training layer 0, epoch 37, cost -78.8531894684
Pre-training layer 0, epoch 38, cost -78.3283503723
Pre-training layer 0, epoch 39, cost -78.3522586314
Pre-training layer 0, epoch 40, cost -78.2524801509
Pre-training layer 0, epoch 40, representative training free energy -443.553169434
Pre-training layer 0, epoch 40, validation free energy -433.738202118
Pre-training layer 0, epoch 41, cost -78.0806649144
Pre-training layer 0, epoch 42, cost -77.871817627
Pre-training layer 0, epoch 43, cost -77.7510144806
Pre-training layer 0, epoch 44, cost -77.7173237991
Pre-training layer 0, epoch 45, cost -77.5984479523
Pre-training layer 0, epoch 45, representative training free energy -441.663532745
Pre-training layer 0, epoch 45, validation free energy -431.474681549
Pre-training layer 0, epoch 46, cost -77.4434195582
Pre-training layer 0, epoch 47, cost -77.236818161
Pre-training layer 0, epoch 48, cost -77.0369245021
Pre-training layer 0, epoch 49, cost -77.0670741272
Pre-training layer 0, epoch 50, cost -76.9162197495
Pre-training layer 0, epoch 50, representative training free energy -437.609676971
Pre-training layer 0, epoch 50, validation free energy -428.43433606
Pre-training layer 0, epoch 51, cost -76.8258124797
Pre-training layer 0, epoch 52, cost -76.6717008718
Pre-training layer 0, epoch 53, cost -76.6399037933
Pre-training layer 0, epoch 54, cost -76.4655358505
Pre-training layer 0, epoch 55, cost -76.3000115204
Pre-training layer 0, epoch 55, representative training free energy -434.596860931
Pre-training layer 0, epoch 55, validation free energy -424.901872223
Pre-training layer 0, epoch 56, cost -76.252851855
Pre-training layer 0, epoch 57, cost -76.0878379949
Pre-training layer 0, epoch 58, cost -75.8942706299
Pre-training layer 0, epoch 59, cost -75.9902043533
Pre-training layer 0, epoch 60, cost -75.9132992935
Pre-training layer 0, epoch 60, representative training free energy -435.287146973
Pre-training layer 0, epoch 60, validation free energy -425.48311673
Pre-training layer 0, epoch 61, cost -75.7862732697
Pre-training layer 0, epoch 62, cost -75.5578207143
Pre-training layer 0, epoch 63, cost -75.5465436172
Pre-training layer 0, epoch 64, cost -75.4619987742
Pre-training layer 0, epoch 65, cost -75.2402842204
Pre-training layer 0, epoch 65, representative training free energy -435.272741974
Pre-training layer 0, epoch 65, validation free energy -424.45721048
Pre-training layer 0, epoch 66, cost -75.2786330541
Pre-training layer 0, epoch 67, cost -75.253262291
Pre-training layer 0, epoch 68, cost -75.169236908
Pre-training layer 0, epoch 69, cost -75.0809286499
Pre-training layer 0, epoch 70, cost -75.1100869751
Pre-training layer 0, epoch 70, representative training free energy -434.112764893
Pre-training layer 0, epoch 70, validation free energy -424.557503357
Pre-training layer 0, epoch 71, cost -75.0021904246
Pre-training layer 0, epoch 72, cost -74.8520817693
Pre-training layer 0, epoch 73, cost -74.7313734309
Pre-training layer 0, epoch 74, cost -74.7349699402
Pre-training layer 0, epoch 75, cost -74.671638209
Pre-training layer 0, epoch 75, representative training free energy -433.75511911
Pre-training layer 0, epoch 75, validation free energy -423.498106812
Pre-training layer 0, epoch 76, cost -74.5917124557
Pre-training layer 0, epoch 77, cost -74.4475143687
Pre-training layer 0, epoch 78, cost -74.4754356384
Pre-training layer 0, epoch 79, cost -74.3785267003
Pre-training layer 0, epoch 80, cost -74.3309990946
Pre-training layer 0, epoch 80, representative training free energy -433.169452087
Pre-training layer 0, epoch 80, validation free energy -422.28291153
Pre-training layer 0, epoch 81, cost -74.1657494609
Pre-training layer 0, epoch 82, cost -74.2685836665
Pre-training layer 0, epoch 83, cost -74.0396241633
Pre-training layer 0, epoch 84, cost -74.0095399221
Pre-training layer 0, epoch 85, cost -74.0341605123
Pre-training layer 0, epoch 85, representative training free energy -432.345239777
Pre-training layer 0, epoch 85, validation free energy -421.317268311
Pre-training layer 0, epoch 86, cost -73.9575549952
Pre-training layer 0, epoch 87, cost -73.9220134862
Pre-training layer 0, epoch 88, cost -73.8963581975
Pre-training layer 0, epoch 89, cost -73.7810667165
Pre-training layer 0, epoch 90, cost -73.767325503
Pre-training layer 0, epoch 90, representative training free energy -430.178592712
Pre-training layer 0, epoch 90, validation free energy -419.849086029
Pre-training layer 0, epoch 91, cost -73.605390447
Pre-training layer 0, epoch 92, cost -73.603841629
Pre-training layer 0, epoch 93, cost -73.5379107157
Pre-training layer 0, epoch 94, cost -73.4973780696
Pre-training layer 0, epoch 95, cost -73.4088192876
Pre-training layer 0, epoch 95, representative training free energy -428.656334106
Pre-training layer 0, epoch 95, validation free energy -416.850386383
Pre-training layer 0, epoch 96, cost -73.4190814336
Pre-training layer 0, epoch 97, cost -73.4640922419
Pre-training layer 0, epoch 98, cost -73.2720554606
Pre-training layer 0, epoch 99, cost -73.2190053304
Pre-training layer 1, epoch 0, cost -344.402830353
Pre-training layer 1, epoch 0, representative training free energy -51435.7317998
Pre-training layer 1, epoch 0, validation free energy -50973.3476895
Pre-training layer 1, epoch 1, cost -295.70195109
Pre-training layer 1, epoch 2, cost -280.867336375
Pre-training layer 1, epoch 3, cost -271.939972941
Pre-training layer 1, epoch 4, cost -265.866561381
Pre-training layer 1, epoch 5, cost -261.070738118
Pre-training layer 1, epoch 5, representative training free energy -69645.0532773
Pre-training layer 1, epoch 5, validation free energy -69039.3222363
Pre-training layer 1, epoch 6, cost -257.45710673
Pre-training layer 1, epoch 7, cost -254.723679555
Pre-training layer 1, epoch 8, cost -252.307782796
Pre-training layer 1, epoch 9, cost -250.285483551
Pre-training layer 1, epoch 10, cost -248.444272461
Pre-training layer 1, epoch 10, representative training free energy -75179.8865488
Pre-training layer 1, epoch 10, validation free energy -74513.6283496
Pre-training layer 1, epoch 11, cost -247.020744781
Pre-training layer 1, epoch 12, cost -245.73018102
Pre-training layer 1, epoch 13, cost -244.491303558
Pre-training layer 1, epoch 14, cost -243.484714661
Pre-training layer 1, epoch 15, cost -242.487357839
Pre-training layer 1, epoch 15, representative training free energy -78570.2621445
Pre-training layer 1, epoch 15, validation free energy -77873.1936055
Pre-training layer 1, epoch 16, cost -241.707305705
Pre-training layer 1, epoch 17, cost -240.846681213
Pre-training layer 1, epoch 18, cost -240.118141581
Pre-training layer 1, epoch 19, cost -239.356154022
Pre-training layer 1, epoch 20, cost -238.831661072
Pre-training layer 1, epoch 20, representative training free energy -80875.8169453
Pre-training layer 1, epoch 20, validation free energy -80146.7250879
Pre-training layer 1, epoch 21, cost -238.293907928
Pre-training layer 1, epoch 22, cost -237.730038198
Pre-training layer 1, epoch 23, cost -237.243859762
Pre-training layer 1, epoch 24, cost -236.83621343
Pre-training layer 1, epoch 25, cost -236.416055756
Pre-training layer 1, epoch 25, representative training free energy -82595.5211328
Pre-training layer 1, epoch 25, validation free energy -81846.1466152
Pre-training layer 1, epoch 26, cost -235.94369283
Pre-training layer 1, epoch 27, cost -235.502951202
Pre-training layer 1, epoch 28, cost -235.253689779
Pre-training layer 1, epoch 29, cost -234.878569997
Pre-training layer 1, epoch 30, cost -234.533506215
Pre-training layer 1, epoch 30, representative training free energy -84035.0827109
Pre-training layer 1, epoch 30, validation free energy -83276.9029727
Pre-training layer 1, epoch 31, cost -234.185427094
Pre-training layer 1, epoch 32, cost -233.938183187
Pre-training layer 1, epoch 33, cost -233.692955678
Pre-training layer 1, epoch 34, cost -233.450966797
Pre-training layer 1, epoch 35, cost -233.097256419
Pre-training layer 1, epoch 35, representative training free energy -85352.9466504
Pre-training layer 1, epoch 35, validation free energy -84586.6312715
Pre-training layer 1, epoch 36, cost -232.903132019
Pre-training layer 1, epoch 37, cost -232.681170247
Pre-training layer 1, epoch 38, cost -232.601194356
Pre-training layer 1, epoch 39, cost -232.283273977
Pre-training layer 1, epoch 40, cost -232.11520874
Pre-training layer 1, epoch 40, representative training free energy -86307.4373633
Pre-training layer 1, epoch 40, validation free energy -85537.7030078
Pre-training layer 1, epoch 41, cost -231.811213938
Pre-training layer 1, epoch 42, cost -231.703491872
Pre-training layer 1, epoch 43, cost -231.335996195
Pre-training layer 1, epoch 44, cost -231.298102468
Pre-training layer 1, epoch 45, cost -230.965010325
Pre-training layer 1, epoch 45, representative training free energy -87282.1374336
Pre-training layer 1, epoch 45, validation free energy -86509.7876602
Pre-training layer 1, epoch 46, cost -230.879568583
Pre-training layer 1, epoch 47, cost -230.834300079
Pre-training layer 1, epoch 48, cost -230.579533132
Pre-training layer 1, epoch 49, cost -230.4821197
Pre-training layer 1, epoch 50, cost -230.330654704
Pre-training layer 1, epoch 50, representative training free energy -88148.5972129
Pre-training layer 1, epoch 50, validation free energy -87365.6611406
Pre-training layer 1, epoch 51, cost -230.214985097
Pre-training layer 1, epoch 52, cost -229.995999146
Pre-training layer 1, epoch 53, cost -229.844374797
Pre-training layer 1, epoch 54, cost -229.735884196
Pre-training layer 1, epoch 55, cost -229.563019206
Pre-training layer 1, epoch 55, representative training free energy -88932.5508555
Pre-training layer 1, epoch 55, validation free energy -88123.4719277
Pre-training layer 1, epoch 56, cost -229.524033356
Pre-training layer 1, epoch 57, cost -229.434309692
Pre-training layer 1, epoch 58, cost -229.210685883
Pre-training layer 1, epoch 59, cost -229.124561462
Pre-training layer 1, epoch 60, cost -229.111832326
Pre-training layer 1, epoch 60, representative training free energy -89591.0615703
Pre-training layer 1, epoch 60, validation free energy -88785.0573516
Pre-training layer 1, epoch 61, cost -228.902929128
Pre-training layer 1, epoch 62, cost -228.863476512
Pre-training layer 1, epoch 63, cost -228.746822255
Pre-training layer 1, epoch 64, cost -228.624746602
Pre-training layer 1, epoch 65, cost -228.511558787
Pre-training layer 1, epoch 65, representative training free energy -90348.2136035
Pre-training layer 1, epoch 65, validation free energy -89540.7026113
Pre-training layer 1, epoch 66, cost -228.396256002
Pre-training layer 1, epoch 67, cost -228.244832967
Pre-training layer 1, epoch 68, cost -228.107883759
Pre-training layer 1, epoch 69, cost -228.062163137
Pre-training layer 1, epoch 70, cost -227.987841441
Pre-training layer 1, epoch 70, representative training free energy -90792.85025
Pre-training layer 1, epoch 70, validation free energy -89981.5509707
Pre-training layer 1, epoch 71, cost -227.9571875
Pre-training layer 1, epoch 72, cost -227.825566864
Pre-training layer 1, epoch 73, cost -227.75632253
Pre-training layer 1, epoch 74, cost -227.563327179
Pre-training layer 1, epoch 75, cost -227.638773193
Pre-training layer 1, epoch 75, representative training free energy -91361.775373
Pre-training layer 1, epoch 75, validation free energy -90545.3893574
Pre-training layer 1, epoch 76, cost -227.47131012
Pre-training layer 1, epoch 77, cost -227.330475922
Pre-training layer 1, epoch 78, cost -227.320999247
Pre-training layer 1, epoch 79, cost -227.324454244
Pre-training layer 1, epoch 80, cost -227.184978129
Pre-training layer 1, epoch 80, representative training free energy -91852.2616875
Pre-training layer 1, epoch 80, validation free energy -91027.3835117
Pre-training layer 1, epoch 81, cost -227.068207347
Pre-training layer 1, epoch 82, cost -227.116045125
Pre-training layer 1, epoch 83, cost -226.986293894
Pre-training layer 1, epoch 84, cost -227.018023682
Pre-training layer 1, epoch 85, cost -226.98338857
Pre-training layer 1, epoch 85, representative training free energy -92361.410623
Pre-training layer 1, epoch 85, validation free energy -91532.391375
Pre-training layer 1, epoch 86, cost -226.802435913
Pre-training layer 1, epoch 87, cost -226.76873113
Pre-training layer 1, epoch 88, cost -226.558365682
Pre-training layer 1, epoch 89, cost -226.588063761
Pre-training layer 1, epoch 90, cost -226.508406474
Pre-training layer 1, epoch 90, representative training free energy -92829.5141211
Pre-training layer 1, epoch 90, validation free energy -91992.844793
Pre-training layer 1, epoch 91, cost -226.465688934
Pre-training layer 1, epoch 92, cost -226.435729421
Pre-training layer 1, epoch 93, cost -226.432540894
Pre-training layer 1, epoch 94, cost -226.254324697
Pre-training layer 1, epoch 95, cost -226.288469645
Pre-training layer 1, epoch 95, representative training free energy -93291.3424473
Pre-training layer 1, epoch 95, validation free energy -92448.7762891
Pre-training layer 1, epoch 96, cost -226.045672048
Pre-training layer 1, epoch 97, cost -226.276078644
Pre-training layer 1, epoch 98, cost -226.074969788
Pre-training layer 1, epoch 99, cost -225.966630656
Pre-training layer 2, epoch 0, cost -128.025143534
Pre-training layer 2, epoch 0, representative training free energy 3062.85488025
Pre-training layer 2, epoch 0, validation free energy 3023.74945245
Pre-training layer 2, epoch 1, cost -94.1716320546
Pre-training layer 2, epoch 2, cost -87.0672930145
Pre-training layer 2, epoch 3, cost -82.8355429331
Pre-training layer 2, epoch 4, cost -80.0684576416
Pre-training layer 2, epoch 5, cost -78.0004287593
Pre-training layer 2, epoch 5, representative training free energy 4857.55508984
Pre-training layer 2, epoch 5, validation free energy 4801.23721167
Pre-training layer 2, epoch 6, cost -76.3563632838
Pre-training layer 2, epoch 7, cost -75.1701539612
Pre-training layer 2, epoch 8, cost -74.0621993256
Pre-training layer 2, epoch 9, cost -73.1583404414
Pre-training layer 2, epoch 10, cost -72.4738771311
Pre-training layer 2, epoch 10, representative training free energy 5760.97225378
Pre-training layer 2, epoch 10, validation free energy 5699.90346033
Pre-training layer 2, epoch 11, cost -71.8730477015
Pre-training layer 2, epoch 12, cost -71.2412809753
Pre-training layer 2, epoch 13, cost -70.6118602753
Pre-training layer 2, epoch 14, cost -70.1758298492
Pre-training layer 2, epoch 15, cost -69.812951444
Pre-training layer 2, epoch 15, representative training free energy 6441.77622705
Pre-training layer 2, epoch 15, validation free energy 6381.92758716
Pre-training layer 2, epoch 16, cost -69.5005631002
Pre-training layer 2, epoch 17, cost -69.028641154
Pre-training layer 2, epoch 18, cost -68.7445257568
Pre-training layer 2, epoch 19, cost -68.3789235179
Pre-training layer 2, epoch 20, cost -68.0534756597
Pre-training layer 2, epoch 20, representative training free energy 7024.42723364
Pre-training layer 2, epoch 20, validation free energy 6963.71805347
Pre-training layer 2, epoch 21, cost -67.9382555135
Pre-training layer 2, epoch 22, cost -67.6466942342
Pre-training layer 2, epoch 23, cost -67.4505871073
Pre-training layer 2, epoch 24, cost -67.0868365987
Pre-training layer 2, epoch 25, cost -67.0857939657
Pre-training layer 2, epoch 25, representative training free energy 7446.58992578
Pre-training layer 2, epoch 25, validation free energy 7381.30988721
Pre-training layer 2, epoch 26, cost -66.7965244293
Pre-training layer 2, epoch 27, cost -66.7590971756
Pre-training layer 2, epoch 28, cost -66.5866471354
Pre-training layer 2, epoch 29, cost -66.4047815196
Pre-training layer 2, epoch 30, cost -66.1792844009
Pre-training layer 2, epoch 30, representative training free energy 7823.61705298
Pre-training layer 2, epoch 30, validation free energy 7754.11475732
Pre-training layer 2, epoch 31, cost -66.1006145986
Pre-training layer 2, epoch 32, cost -65.8875690587
Pre-training layer 2, epoch 33, cost -65.6610431035
Pre-training layer 2, epoch 34, cost -65.6874886068
Pre-training layer 2, epoch 35, cost -65.6228330612
Pre-training layer 2, epoch 35, representative training free energy 8198.01827393
Pre-training layer 2, epoch 35, validation free energy 8123.86792993
Pre-training layer 2, epoch 36, cost -65.5592862447
Pre-training layer 2, epoch 37, cost -65.4254914856
Pre-training layer 2, epoch 38, cost -65.3185796865
Pre-training layer 2, epoch 39, cost -65.2085248184
Pre-training layer 2, epoch 40, cost -65.0589738337
Pre-training layer 2, epoch 40, representative training free energy 8478.70802954
Pre-training layer 2, epoch 40, validation free energy 8401.43291455
Pre-training layer 2, epoch 41, cost -65.0540273412
Pre-training layer 2, epoch 42, cost -64.8455156199
Pre-training layer 2, epoch 43, cost -64.9094847997
Pre-training layer 2, epoch 44, cost -64.7918611145
Pre-training layer 2, epoch 45, cost -64.6157136154
Pre-training layer 2, epoch 45, representative training free energy 8752.44984277
Pre-training layer 2, epoch 45, validation free energy 8672.27115991
Pre-training layer 2, epoch 46, cost -64.5904641851
Pre-training layer 2, epoch 47, cost -64.578552831
Pre-training layer 2, epoch 48, cost -64.5412489827
Pre-training layer 2, epoch 49, cost -64.3230812963
Pre-training layer 2, epoch 50, cost -64.4318733978
Pre-training layer 2, epoch 50, representative training free energy 9011.09296484
Pre-training layer 2, epoch 50, validation free energy 8927.13379858
Pre-training layer 2, epoch 51, cost -64.4380297216
Pre-training layer 2, epoch 52, cost -64.3457112376
Pre-training layer 2, epoch 53, cost -64.2499182256
Pre-training layer 2, epoch 54, cost -64.1702779897
Pre-training layer 2, epoch 55, cost -64.1603739039
Pre-training layer 2, epoch 55, representative training free energy 9266.99262134
Pre-training layer 2, epoch 55, validation free energy 9179.75302466
Pre-training layer 2, epoch 56, cost -64.1739649455
Pre-training layer 2, epoch 57, cost -64.0872670237
Pre-training layer 2, epoch 58, cost -63.9479696147
Pre-training layer 2, epoch 59, cost -63.9122932434
Pre-training layer 2, epoch 60, cost -63.8084128062
Pre-training layer 2, epoch 60, representative training free energy 9489.39896875
Pre-training layer 2, epoch 60, validation free energy 9398.75974634
Pre-training layer 2, epoch 61, cost -63.7133122889
Pre-training layer 2, epoch 62, cost -63.7370252991
Pre-training layer 2, epoch 63, cost -63.7542360687
Pre-training layer 2, epoch 64, cost -63.6080209351
Pre-training layer 2, epoch 65, cost -63.6037047195
Pre-training layer 2, epoch 65, representative training free energy 9688.17114966
Pre-training layer 2, epoch 65, validation free energy 9595.26749878
Pre-training layer 2, epoch 66, cost -63.5988316854
Pre-training layer 2, epoch 67, cost -63.5042946498
Pre-training layer 2, epoch 68, cost -63.5752536519
Pre-training layer 2, epoch 69, cost -63.5516393407
Pre-training layer 2, epoch 70, cost -63.4969173559
Pre-training layer 2, epoch 70, representative training free energy 9917.06680396
Pre-training layer 2, epoch 70, validation free energy 9821.4088562
Pre-training layer 2, epoch 71, cost -63.3807043076
Pre-training layer 2, epoch 72, cost -63.4463587316
Pre-training layer 2, epoch 73, cost -63.3501554998
Pre-training layer 2, epoch 74, cost -63.3436041768
Pre-training layer 2, epoch 75, cost -63.2288770803
Pre-training layer 2, epoch 75, representative training free energy 10120.3565625
Pre-training layer 2, epoch 75, validation free energy 10022.3147231
Pre-training layer 2, epoch 76, cost -63.2636478933
Pre-training layer 2, epoch 77, cost -63.1534173584
Pre-training layer 2, epoch 78, cost -63.1150774384
Pre-training layer 2, epoch 79, cost -63.1045177333
Pre-training layer 2, epoch 80, cost -63.0788558706
Pre-training layer 2, epoch 80, representative training free energy 10358.2393452
Pre-training layer 2, epoch 80, validation free energy 10258.6566658
Pre-training layer 2, epoch 81, cost -63.1153238678
Pre-training layer 2, epoch 82, cost -63.0339370219
Pre-training layer 2, epoch 83, cost -63.0207047272
Pre-training layer 2, epoch 84, cost -63.0097523499
Pre-training layer 2, epoch 85, cost -62.9060464096
Pre-training layer 2, epoch 85, representative training free energy 10538.2774524
Pre-training layer 2, epoch 85, validation free energy 10435.7290825
Pre-training layer 2, epoch 86, cost -63.0203211212
Pre-training layer 2, epoch 87, cost -62.879334348
Pre-training layer 2, epoch 88, cost -62.8779291789
Pre-training layer 2, epoch 89, cost -62.8619490814
Pre-training layer 2, epoch 90, cost -62.7336050415
Pre-training layer 2, epoch 90, representative training free energy 10735.7691782
Pre-training layer 2, epoch 90, validation free energy 10630.8720798
Pre-training layer 2, epoch 91, cost -62.7848343404
Pre-training layer 2, epoch 92, cost -62.6738433329
Pre-training layer 2, epoch 93, cost -62.8004990005
Pre-training layer 2, epoch 94, cost -62.7845019658
Pre-training layer 2, epoch 95, cost -62.7611338552
Pre-training layer 2, epoch 95, representative training free energy 10924.4007063
Pre-training layer 2, epoch 95, validation free energy 10817.3093442
Pre-training layer 2, epoch 96, cost -62.6913214493
Pre-training layer 2, epoch 97, cost -62.5518913396
Pre-training layer 2, epoch 98, cost -62.7117400106
Pre-training layer 2, epoch 99, cost -62.5214116033
The pretraining code for file dbn_loop.pyc ran for 7.92m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 35.100000 %
     epoch 1, minibatch 300/300, test error of best model 30.500000 %
epoch 2, minibatch 300/300, validation error 28.100000 %
     epoch 2, minibatch 300/300, test error of best model 21.500000 %
epoch 3, minibatch 300/300, validation error 25.200000 %
     epoch 3, minibatch 300/300, test error of best model 17.600000 %
epoch 4, minibatch 300/300, validation error 24.000000 %
     epoch 4, minibatch 300/300, test error of best model 15.700000 %
epoch 5, minibatch 300/300, validation error 23.100000 %
     epoch 5, minibatch 300/300, test error of best model 13.700000 %
epoch 6, minibatch 300/300, validation error 22.800000 %
     epoch 6, minibatch 300/300, test error of best model 13.100000 %
epoch 7, minibatch 300/300, validation error 22.100000 %
     epoch 7, minibatch 300/300, test error of best model 12.200000 %
epoch 8, minibatch 300/300, validation error 21.500000 %
     epoch 8, minibatch 300/300, test error of best model 11.100000 %
epoch 9, minibatch 300/300, validation error 20.800000 %
     epoch 9, minibatch 300/300, test error of best model 10.500000 %
epoch 10, minibatch 300/300, validation error 19.900000 %
     epoch 10, minibatch 300/300, test error of best model 9.900000 %
epoch 11, minibatch 300/300, validation error 19.400000 %
     epoch 11, minibatch 300/300, test error of best model 9.700000 %
epoch 12, minibatch 300/300, validation error 18.800000 %
     epoch 12, minibatch 300/300, test error of best model 9.300000 %
epoch 13, minibatch 300/300, validation error 18.400000 %
     epoch 13, minibatch 300/300, test error of best model 9.200000 %
epoch 14, minibatch 300/300, validation error 18.100000 %
     epoch 14, minibatch 300/300, test error of best model 9.000000 %
epoch 15, minibatch 300/300, validation error 17.900000 %
     epoch 15, minibatch 300/300, test error of best model 9.100000 %
epoch 16, minibatch 300/300, validation error 17.800000 %
     epoch 16, minibatch 300/300, test error of best model 9.000000 %
epoch 17, minibatch 300/300, validation error 17.700000 %
     epoch 17, minibatch 300/300, test error of best model 8.800000 %
epoch 18, minibatch 300/300, validation error 17.100000 %
     epoch 18, minibatch 300/300, test error of best model 8.700000 %
epoch 19, minibatch 300/300, validation error 16.900000 %
     epoch 19, minibatch 300/300, test error of best model 8.600000 %
epoch 20, minibatch 300/300, validation error 16.800000 %
     epoch 20, minibatch 300/300, test error of best model 8.500000 %
epoch 21, minibatch 300/300, validation error 16.800000 %
epoch 22, minibatch 300/300, validation error 16.800000 %
epoch 23, minibatch 300/300, validation error 16.900000 %
epoch 24, minibatch 300/300, validation error 16.900000 %
epoch 25, minibatch 300/300, validation error 17.000000 %
epoch 26, minibatch 300/300, validation error 17.000000 %
epoch 27, minibatch 300/300, validation error 16.600000 %
     epoch 27, minibatch 300/300, test error of best model 8.300000 %
epoch 28, minibatch 300/300, validation error 16.500000 %
     epoch 28, minibatch 300/300, test error of best model 8.000000 %
epoch 29, minibatch 300/300, validation error 16.500000 %
epoch 30, minibatch 300/300, validation error 16.500000 %
epoch 31, minibatch 300/300, validation error 16.400000 %
     epoch 31, minibatch 300/300, test error of best model 7.700000 %
epoch 32, minibatch 300/300, validation error 16.000000 %
     epoch 32, minibatch 300/300, test error of best model 7.600000 %
epoch 33, minibatch 300/300, validation error 16.000000 %
epoch 34, minibatch 300/300, validation error 16.000000 %
epoch 35, minibatch 300/300, validation error 15.900000 %
     epoch 35, minibatch 300/300, test error of best model 7.300000 %
epoch 36, minibatch 300/300, validation error 15.900000 %
epoch 37, minibatch 300/300, validation error 15.900000 %
epoch 38, minibatch 300/300, validation error 15.800000 %
     epoch 38, minibatch 300/300, test error of best model 7.200000 %
epoch 39, minibatch 300/300, validation error 15.800000 %
epoch 40, minibatch 300/300, validation error 15.700000 %
     epoch 40, minibatch 300/300, test error of best model 7.200000 %
epoch 41, minibatch 300/300, validation error 15.600000 %
     epoch 41, minibatch 300/300, test error of best model 7.300000 %
epoch 42, minibatch 300/300, validation error 15.600000 %
epoch 43, minibatch 300/300, validation error 15.500000 %
     epoch 43, minibatch 300/300, test error of best model 7.300000 %
epoch 44, minibatch 300/300, validation error 15.500000 %
epoch 45, minibatch 300/300, validation error 15.100000 %
     epoch 45, minibatch 300/300, test error of best model 7.300000 %
epoch 46, minibatch 300/300, validation error 15.000000 %
     epoch 46, minibatch 300/300, test error of best model 7.300000 %
epoch 47, minibatch 300/300, validation error 14.900000 %
     epoch 47, minibatch 300/300, test error of best model 7.200000 %
epoch 48, minibatch 300/300, validation error 14.800000 %
     epoch 48, minibatch 300/300, test error of best model 7.300000 %
epoch 49, minibatch 300/300, validation error 14.900000 %
epoch 50, minibatch 300/300, validation error 14.900000 %
epoch 51, minibatch 300/300, validation error 14.800000 %
epoch 52, minibatch 300/300, validation error 14.800000 %
epoch 53, minibatch 300/300, validation error 14.700000 %
     epoch 53, minibatch 300/300, test error of best model 7.300000 %
epoch 54, minibatch 300/300, validation error 14.600000 %
     epoch 54, minibatch 300/300, test error of best model 7.300000 %
epoch 55, minibatch 300/300, validation error 14.600000 %
epoch 56, minibatch 300/300, validation error 14.800000 %
epoch 57, minibatch 300/300, validation error 14.800000 %
epoch 58, minibatch 300/300, validation error 14.900000 %
epoch 59, minibatch 300/300, validation error 15.000000 %
epoch 60, minibatch 300/300, validation error 15.000000 %
epoch 61, minibatch 300/300, validation error 14.900000 %
epoch 62, minibatch 300/300, validation error 14.900000 %
epoch 63, minibatch 300/300, validation error 14.900000 %
epoch 64, minibatch 300/300, validation error 14.900000 %
epoch 65, minibatch 300/300, validation error 14.800000 %
epoch 66, minibatch 300/300, validation error 14.700000 %
epoch 67, minibatch 300/300, validation error 14.700000 %
epoch 68, minibatch 300/300, validation error 14.800000 %
epoch 69, minibatch 300/300, validation error 14.800000 %
epoch 70, minibatch 300/300, validation error 14.800000 %
epoch 71, minibatch 300/300, validation error 14.800000 %
epoch 72, minibatch 300/300, validation error 14.800000 %
epoch 73, minibatch 300/300, validation error 14.800000 %
epoch 74, minibatch 300/300, validation error 14.800000 %
epoch 75, minibatch 300/300, validation error 14.800000 %
epoch 76, minibatch 300/300, validation error 14.800000 %
epoch 77, minibatch 300/300, validation error 14.700000 %
epoch 78, minibatch 300/300, validation error 14.700000 %
epoch 79, minibatch 300/300, validation error 14.700000 %
epoch 80, minibatch 300/300, validation error 14.600000 %
epoch 81, minibatch 300/300, validation error 14.600000 %
epoch 82, minibatch 300/300, validation error 14.600000 %
epoch 83, minibatch 300/300, validation error 14.600000 %
epoch 84, minibatch 300/300, validation error 14.600000 %
epoch 85, minibatch 300/300, validation error 14.600000 %
epoch 86, minibatch 300/300, validation error 14.600000 %
epoch 87, minibatch 300/300, validation error 14.600000 %
epoch 88, minibatch 300/300, validation error 14.600000 %
epoch 89, minibatch 300/300, validation error 14.600000 %
epoch 90, minibatch 300/300, validation error 14.600000 %
epoch 91, minibatch 300/300, validation error 14.600000 %
epoch 92, minibatch 300/300, validation error 14.600000 %
epoch 93, minibatch 300/300, validation error 14.600000 %
epoch 94, minibatch 300/300, validation error 14.600000 %
epoch 95, minibatch 300/300, validation error 14.600000 %
epoch 96, minibatch 300/300, validation error 14.600000 %
epoch 97, minibatch 300/300, validation error 14.600000 %
epoch 98, minibatch 300/300, validation error 14.600000 %
epoch 99, minibatch 300/300, validation error 14.600000 %
epoch 100, minibatch 300/300, validation error 14.600000 %
epoch 101, minibatch 300/300, validation error 14.600000 %
epoch 102, minibatch 300/300, validation error 14.600000 %
epoch 103, minibatch 300/300, validation error 14.600000 %
epoch 104, minibatch 300/300, validation error 14.600000 %
epoch 105, minibatch 300/300, validation error 14.600000 %
epoch 106, minibatch 300/300, validation error 14.600000 %
epoch 107, minibatch 300/300, validation error 14.600000 %
Optimization complete with best validation score of 14.600000 %, obtained at iteration 16200, with test performance 7.300000 %
The fine tuning code for file dbn_loop.pyc ran for 2.89m


==========Sample: (4000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.457797699
Pre-training layer 0, epoch 0, representative training free energy -549.6441586
Pre-training layer 0, epoch 0, validation free energy -546.071930145
Pre-training layer 0, epoch 1, cost -112.092789421
Pre-training layer 0, epoch 2, cost -103.945626202
Pre-training layer 0, epoch 3, cost -99.0589840126
Pre-training layer 0, epoch 4, cost -95.7446123314
Pre-training layer 0, epoch 5, cost -93.5661452293
Pre-training layer 0, epoch 5, representative training free energy -491.304646667
Pre-training layer 0, epoch 5, validation free energy -486.164168243
Pre-training layer 0, epoch 6, cost -91.5169786835
Pre-training layer 0, epoch 7, cost -90.3046715546
Pre-training layer 0, epoch 8, cost -88.9551900291
Pre-training layer 0, epoch 9, cost -87.7776492596
Pre-training layer 0, epoch 10, cost -86.9361529255
Pre-training layer 0, epoch 10, representative training free energy -467.390393555
Pre-training layer 0, epoch 10, validation free energy -461.710325226
Pre-training layer 0, epoch 11, cost -86.0732044125
Pre-training layer 0, epoch 12, cost -85.447207737
Pre-training layer 0, epoch 13, cost -84.7622799015
Pre-training layer 0, epoch 14, cost -84.1918902111
Pre-training layer 0, epoch 15, cost -83.6295226574
Pre-training layer 0, epoch 15, representative training free energy -457.703802521
Pre-training layer 0, epoch 15, validation free energy -450.848316437
Pre-training layer 0, epoch 16, cost -83.2362421227
Pre-training layer 0, epoch 17, cost -82.6006911755
Pre-training layer 0, epoch 18, cost -82.2992394066
Pre-training layer 0, epoch 19, cost -81.7860074234
Pre-training layer 0, epoch 20, cost -81.5610522079
Pre-training layer 0, epoch 20, representative training free energy -449.344971832
Pre-training layer 0, epoch 20, validation free energy -443.613177063
Pre-training layer 0, epoch 21, cost -81.2623693275
Pre-training layer 0, epoch 22, cost -80.9054313469
Pre-training layer 0, epoch 23, cost -80.5045886612
Pre-training layer 0, epoch 24, cost -80.43110322
Pre-training layer 0, epoch 25, cost -80.1117776585
Pre-training layer 0, epoch 25, representative training free energy -444.978456879
Pre-training layer 0, epoch 25, validation free energy -438.426929382
Pre-training layer 0, epoch 26, cost -79.8229955578
Pre-training layer 0, epoch 27, cost -79.7121643257
Pre-training layer 0, epoch 28, cost -79.3541746426
Pre-training layer 0, epoch 29, cost -79.1794266319
Pre-training layer 0, epoch 30, cost -78.8858404541
Pre-training layer 0, epoch 30, representative training free energy -438.306878906
Pre-training layer 0, epoch 30, validation free energy -431.514192963
Pre-training layer 0, epoch 31, cost -78.8261468506
Pre-training layer 0, epoch 32, cost -78.6553995037
Pre-training layer 0, epoch 33, cost -78.4721036339
Pre-training layer 0, epoch 34, cost -78.2437774754
Pre-training layer 0, epoch 35, cost -78.1324150753
Pre-training layer 0, epoch 35, representative training free energy -434.165736633
Pre-training layer 0, epoch 35, validation free energy -427.661463531
Pre-training layer 0, epoch 36, cost -77.9039797688
Pre-training layer 0, epoch 37, cost -77.8229796314
Pre-training layer 0, epoch 38, cost -77.648553524
Pre-training layer 0, epoch 39, cost -77.519770155
Pre-training layer 0, epoch 40, cost -77.4379335976
Pre-training layer 0, epoch 40, representative training free energy -434.31223877
Pre-training layer 0, epoch 40, validation free energy -427.044052246
Pre-training layer 0, epoch 41, cost -77.1536657143
Pre-training layer 0, epoch 42, cost -77.147317667
Pre-training layer 0, epoch 43, cost -77.0117405224
Pre-training layer 0, epoch 44, cost -76.8217683792
Pre-training layer 0, epoch 45, cost -76.9030793858
Pre-training layer 0, epoch 45, representative training free energy -432.336023895
Pre-training layer 0, epoch 45, validation free energy -424.590349701
Pre-training layer 0, epoch 46, cost -76.6206168747
Pre-training layer 0, epoch 47, cost -76.4511979198
Pre-training layer 0, epoch 48, cost -76.2274290848
Pre-training layer 0, epoch 49, cost -76.2125986195
Pre-training layer 0, epoch 50, cost -76.1730332565
Pre-training layer 0, epoch 50, representative training free energy -429.315160614
Pre-training layer 0, epoch 50, validation free energy -421.620800232
Pre-training layer 0, epoch 51, cost -76.0922670269
Pre-training layer 0, epoch 52, cost -76.0573730755
Pre-training layer 0, epoch 53, cost -75.8453122234
Pre-training layer 0, epoch 54, cost -75.8421541119
Pre-training layer 0, epoch 55, cost -75.6559711647
Pre-training layer 0, epoch 55, representative training free energy -429.966828461
Pre-training layer 0, epoch 55, validation free energy -422.139584045
Pre-training layer 0, epoch 56, cost -75.5366828442
Pre-training layer 0, epoch 57, cost -75.4610787773
Pre-training layer 0, epoch 58, cost -75.3758495426
Pre-training layer 0, epoch 59, cost -75.4179123116
Pre-training layer 0, epoch 60, cost -75.2364622402
Pre-training layer 0, epoch 60, representative training free energy -429.56449649
Pre-training layer 0, epoch 60, validation free energy -420.77297287
Pre-training layer 0, epoch 61, cost -75.1541200542
Pre-training layer 0, epoch 62, cost -75.0634281635
Pre-training layer 0, epoch 63, cost -74.9283874989
Pre-training layer 0, epoch 64, cost -74.9840830803
Pre-training layer 0, epoch 65, cost -74.8474119473
Pre-training layer 0, epoch 65, representative training free energy -423.215597137
Pre-training layer 0, epoch 65, validation free energy -414.880241486
Pre-training layer 0, epoch 66, cost -74.7428741932
Pre-training layer 0, epoch 67, cost -74.6675504208
Pre-training layer 0, epoch 68, cost -74.7630231285
Pre-training layer 0, epoch 69, cost -74.5140172863
Pre-training layer 0, epoch 70, cost -74.6550233269
Pre-training layer 0, epoch 70, representative training free energy -424.826952942
Pre-training layer 0, epoch 70, validation free energy -416.085261932
Pre-training layer 0, epoch 71, cost -74.5087563705
Pre-training layer 0, epoch 72, cost -74.3861386299
Pre-training layer 0, epoch 73, cost -74.3882710838
Pre-training layer 0, epoch 74, cost -74.2856452847
Pre-training layer 0, epoch 75, cost -74.1273136711
Pre-training layer 0, epoch 75, representative training free energy -423.148916321
Pre-training layer 0, epoch 75, validation free energy -414.602215668
Pre-training layer 0, epoch 76, cost -74.1741943741
Pre-training layer 0, epoch 77, cost -74.0436361504
Pre-training layer 0, epoch 78, cost -73.934060812
Pre-training layer 0, epoch 79, cost -73.8779885769
Pre-training layer 0, epoch 80, cost -73.9662240219
Pre-training layer 0, epoch 80, representative training free energy -422.452038391
Pre-training layer 0, epoch 80, validation free energy -413.558668091
Pre-training layer 0, epoch 81, cost -73.8373160934
Pre-training layer 0, epoch 82, cost -73.8343560219
Pre-training layer 0, epoch 83, cost -73.7140723705
Pre-training layer 0, epoch 84, cost -73.6796293736
Pre-training layer 0, epoch 85, cost -73.6339048481
Pre-training layer 0, epoch 85, representative training free energy -422.604688049
Pre-training layer 0, epoch 85, validation free energy -413.518843231
Pre-training layer 0, epoch 86, cost -73.5675016212
Pre-training layer 0, epoch 87, cost -73.5364409065
Pre-training layer 0, epoch 88, cost -73.4478297997
Pre-training layer 0, epoch 89, cost -73.3866397667
Pre-training layer 0, epoch 90, cost -73.3108054924
Pre-training layer 0, epoch 90, representative training free energy -423.200107361
Pre-training layer 0, epoch 90, validation free energy -414.244212097
Pre-training layer 0, epoch 91, cost -73.4423589706
Pre-training layer 0, epoch 92, cost -73.3267126083
Pre-training layer 0, epoch 93, cost -73.2410081577
Pre-training layer 0, epoch 94, cost -73.1962782955
Pre-training layer 0, epoch 95, cost -73.1954843998
Pre-training layer 0, epoch 95, representative training free energy -419.257748718
Pre-training layer 0, epoch 95, validation free energy -410.230348999
Pre-training layer 0, epoch 96, cost -73.0793720913
Pre-training layer 0, epoch 97, cost -73.1081102467
Pre-training layer 0, epoch 98, cost -73.0496873665
Pre-training layer 0, epoch 99, cost -72.9163814068
Pre-training layer 1, epoch 0, cost -324.914252357
Pre-training layer 1, epoch 0, representative training free energy -57686.2084727
Pre-training layer 1, epoch 0, validation free energy -57259.7032949
Pre-training layer 1, epoch 1, cost -279.217556381
Pre-training layer 1, epoch 2, cost -265.288203278
Pre-training layer 1, epoch 3, cost -256.932744827
Pre-training layer 1, epoch 4, cost -251.244082069
Pre-training layer 1, epoch 5, cost -247.147795486
Pre-training layer 1, epoch 5, representative training free energy -77547.7684512
Pre-training layer 1, epoch 5, validation free energy -76913.1460605
Pre-training layer 1, epoch 6, cost -243.970793724
Pre-training layer 1, epoch 7, cost -241.372925415
Pre-training layer 1, epoch 8, cost -239.226460495
Pre-training layer 1, epoch 9, cost -237.478510361
Pre-training layer 1, epoch 10, cost -235.965453453
Pre-training layer 1, epoch 10, representative training free energy -83614.4124219
Pre-training layer 1, epoch 10, validation free energy -82924.1077988
Pre-training layer 1, epoch 11, cost -234.736975899
Pre-training layer 1, epoch 12, cost -233.629178696
Pre-training layer 1, epoch 13, cost -232.515671692
Pre-training layer 1, epoch 14, cost -231.692746086
Pre-training layer 1, epoch 15, cost -230.855224495
Pre-training layer 1, epoch 15, representative training free energy -87186.8800664
Pre-training layer 1, epoch 15, validation free energy -86459.5566758
Pre-training layer 1, epoch 16, cost -230.172377434
Pre-training layer 1, epoch 17, cost -229.447197266
Pre-training layer 1, epoch 18, cost -228.799396896
Pre-training layer 1, epoch 19, cost -228.139906387
Pre-training layer 1, epoch 20, cost -227.771544762
Pre-training layer 1, epoch 20, representative training free energy -89742.8738066
Pre-training layer 1, epoch 20, validation free energy -89007.0050703
Pre-training layer 1, epoch 21, cost -227.162801361
Pre-training layer 1, epoch 22, cost -226.788699226
Pre-training layer 1, epoch 23, cost -226.402190132
Pre-training layer 1, epoch 24, cost -225.97716526
Pre-training layer 1, epoch 25, cost -225.577855225
Pre-training layer 1, epoch 25, representative training free energy -91697.4400723
Pre-training layer 1, epoch 25, validation free energy -90940.8360645
Pre-training layer 1, epoch 26, cost -225.153603821
Pre-training layer 1, epoch 27, cost -224.849981003
Pre-training layer 1, epoch 28, cost -224.577871933
Pre-training layer 1, epoch 29, cost -224.265031128
Pre-training layer 1, epoch 30, cost -223.935850296
Pre-training layer 1, epoch 30, representative training free energy -93404.5414277
Pre-training layer 1, epoch 30, validation free energy -92637.1398242
Pre-training layer 1, epoch 31, cost -223.864444923
Pre-training layer 1, epoch 32, cost -223.392599258
Pre-training layer 1, epoch 33, cost -223.232064476
Pre-training layer 1, epoch 34, cost -222.979086533
Pre-training layer 1, epoch 35, cost -222.75490921
Pre-training layer 1, epoch 35, representative training free energy -94759.3982109
Pre-training layer 1, epoch 35, validation free energy -93972.1023379
Pre-training layer 1, epoch 36, cost -222.572711868
Pre-training layer 1, epoch 37, cost -222.255234909
Pre-training layer 1, epoch 38, cost -222.140421295
Pre-training layer 1, epoch 39, cost -221.973188019
Pre-training layer 1, epoch 40, cost -221.652622414
Pre-training layer 1, epoch 40, representative training free energy -95915.4018516
Pre-training layer 1, epoch 40, validation free energy -95116.0052148
Pre-training layer 1, epoch 41, cost -221.611756096
Pre-training layer 1, epoch 42, cost -221.337089233
Pre-training layer 1, epoch 43, cost -221.216605377
Pre-training layer 1, epoch 44, cost -221.032675056
Pre-training layer 1, epoch 45, cost -220.886604652
Pre-training layer 1, epoch 45, representative training free energy -97060.8849844
Pre-training layer 1, epoch 45, validation free energy -96248.7137031
Pre-training layer 1, epoch 46, cost -220.841425247
Pre-training layer 1, epoch 47, cost -220.612948227
Pre-training layer 1, epoch 48, cost -220.438962669
Pre-training layer 1, epoch 49, cost -220.273157463
Pre-training layer 1, epoch 50, cost -220.171856232
Pre-training layer 1, epoch 50, representative training free energy -97933.6793887
Pre-training layer 1, epoch 50, validation free energy -97110.4955645
Pre-training layer 1, epoch 51, cost -219.971205673
Pre-training layer 1, epoch 52, cost -219.808374252
Pre-training layer 1, epoch 53, cost -219.817708549
Pre-training layer 1, epoch 54, cost -219.681665192
Pre-training layer 1, epoch 55, cost -219.605216484
Pre-training layer 1, epoch 55, representative training free energy -98890.9130039
Pre-training layer 1, epoch 55, validation free energy -98040.5269375
Pre-training layer 1, epoch 56, cost -219.432518196
Pre-training layer 1, epoch 57, cost -219.263171768
Pre-training layer 1, epoch 58, cost -219.255946541
Pre-training layer 1, epoch 59, cost -219.149705048
Pre-training layer 1, epoch 60, cost -218.934320641
Pre-training layer 1, epoch 60, representative training free energy -99794.0221582
Pre-training layer 1, epoch 60, validation free energy -98958.1199883
Pre-training layer 1, epoch 61, cost -218.963409538
Pre-training layer 1, epoch 62, cost -218.812983704
Pre-training layer 1, epoch 63, cost -218.638380699
Pre-training layer 1, epoch 64, cost -218.678421173
Pre-training layer 1, epoch 65, cost -218.633316879
Pre-training layer 1, epoch 65, representative training free energy -100587.043213
Pre-training layer 1, epoch 65, validation free energy -99723.8784219
Pre-training layer 1, epoch 66, cost -218.31991066
Pre-training layer 1, epoch 67, cost -218.37140255
Pre-training layer 1, epoch 68, cost -218.268117828
Pre-training layer 1, epoch 69, cost -218.189482346
Pre-training layer 1, epoch 70, cost -218.134908485
Pre-training layer 1, epoch 70, representative training free energy -101164.344342
Pre-training layer 1, epoch 70, validation free energy -100295.27157
Pre-training layer 1, epoch 71, cost -218.013225632
Pre-training layer 1, epoch 72, cost -217.932504768
Pre-training layer 1, epoch 73, cost -217.811883125
Pre-training layer 1, epoch 74, cost -217.764621811
Pre-training layer 1, epoch 75, cost -217.695714951
Pre-training layer 1, epoch 75, representative training free energy -101888.39475
Pre-training layer 1, epoch 75, validation free energy -101005.824859
Pre-training layer 1, epoch 76, cost -217.728688431
Pre-training layer 1, epoch 77, cost -217.615871925
Pre-training layer 1, epoch 78, cost -217.516355782
Pre-training layer 1, epoch 79, cost -217.440179749
Pre-training layer 1, epoch 80, cost -217.43139534
Pre-training layer 1, epoch 80, representative training free energy -102467.181572
Pre-training layer 1, epoch 80, validation free energy -101580.641531
Pre-training layer 1, epoch 81, cost -217.287418022
Pre-training layer 1, epoch 82, cost -217.316698914
Pre-training layer 1, epoch 83, cost -217.191882286
Pre-training layer 1, epoch 84, cost -217.132857285
Pre-training layer 1, epoch 85, cost -217.115974083
Pre-training layer 1, epoch 85, representative training free energy -103114.852693
Pre-training layer 1, epoch 85, validation free energy -102220.651176
Pre-training layer 1, epoch 86, cost -216.967440453
Pre-training layer 1, epoch 87, cost -216.874030724
Pre-training layer 1, epoch 88, cost -216.878985062
Pre-training layer 1, epoch 89, cost -216.792558098
Pre-training layer 1, epoch 90, cost -216.807488518
Pre-training layer 1, epoch 90, representative training free energy -103661.144234
Pre-training layer 1, epoch 90, validation free energy -102758.897953
Pre-training layer 1, epoch 91, cost -216.659550438
Pre-training layer 1, epoch 92, cost -216.664740028
Pre-training layer 1, epoch 93, cost -216.514755974
Pre-training layer 1, epoch 94, cost -216.566760368
Pre-training layer 1, epoch 95, cost -216.48582901
Pre-training layer 1, epoch 95, representative training free energy -104224.008111
Pre-training layer 1, epoch 95, validation free energy -103318.94357
Pre-training layer 1, epoch 96, cost -216.487527351
Pre-training layer 1, epoch 97, cost -216.341487656
Pre-training layer 1, epoch 98, cost -216.340373039
Pre-training layer 1, epoch 99, cost -216.281475945
Pre-training layer 2, epoch 0, cost -117.646934834
Pre-training layer 2, epoch 0, representative training free energy 3710.46164734
Pre-training layer 2, epoch 0, validation free energy 3639.72616046
Pre-training layer 2, epoch 1, cost -87.7536681557
Pre-training layer 2, epoch 2, cost -81.3285870361
Pre-training layer 2, epoch 3, cost -77.5915758038
Pre-training layer 2, epoch 4, cost -75.1692262554
Pre-training layer 2, epoch 5, cost -73.250653553
Pre-training layer 2, epoch 5, representative training free energy 5847.27541675
Pre-training layer 2, epoch 5, validation free energy 5763.86929126
Pre-training layer 2, epoch 6, cost -71.8864185429
Pre-training layer 2, epoch 7, cost -70.6869739151
Pre-training layer 2, epoch 8, cost -69.8290402794
Pre-training layer 2, epoch 9, cost -69.0001189041
Pre-training layer 2, epoch 10, cost -68.4129101753
Pre-training layer 2, epoch 10, representative training free energy 7010.4775426
Pre-training layer 2, epoch 10, validation free energy 6944.67606738
Pre-training layer 2, epoch 11, cost -67.7858350372
Pre-training layer 2, epoch 12, cost -67.3361195755
Pre-training layer 2, epoch 13, cost -66.7431390858
Pre-training layer 2, epoch 14, cost -66.4148284531
Pre-training layer 2, epoch 15, cost -66.0140835094
Pre-training layer 2, epoch 15, representative training free energy 7857.4876604
Pre-training layer 2, epoch 15, validation free energy 7790.62287793
Pre-training layer 2, epoch 16, cost -65.7495423126
Pre-training layer 2, epoch 17, cost -65.4063644028
Pre-training layer 2, epoch 18, cost -65.125959549
Pre-training layer 2, epoch 19, cost -64.8253711605
Pre-training layer 2, epoch 20, cost -64.5994740009
Pre-training layer 2, epoch 20, representative training free energy 8537.45822656
Pre-training layer 2, epoch 20, validation free energy 8465.67755151
Pre-training layer 2, epoch 21, cost -64.3633229733
Pre-training layer 2, epoch 22, cost -64.2031573868
Pre-training layer 2, epoch 23, cost -64.0430727386
Pre-training layer 2, epoch 24, cost -63.8107781601
Pre-training layer 2, epoch 25, cost -63.6658732414
Pre-training layer 2, epoch 25, representative training free energy 9087.93721802
Pre-training layer 2, epoch 25, validation free energy 9014.78105737
Pre-training layer 2, epoch 26, cost -63.5379844189
Pre-training layer 2, epoch 27, cost -63.2898994064
Pre-training layer 2, epoch 28, cost -63.2216297531
Pre-training layer 2, epoch 29, cost -63.1045525265
Pre-training layer 2, epoch 30, cost -63.0009678555
Pre-training layer 2, epoch 30, representative training free energy 9643.12157666
Pre-training layer 2, epoch 30, validation free energy 9567.44222827
Pre-training layer 2, epoch 31, cost -62.820304985
Pre-training layer 2, epoch 32, cost -62.8089380836
Pre-training layer 2, epoch 33, cost -62.6292088795
Pre-training layer 2, epoch 34, cost -62.5845932388
Pre-training layer 2, epoch 35, cost -62.4463966274
Pre-training layer 2, epoch 35, representative training free energy 10094.9615237
Pre-training layer 2, epoch 35, validation free energy 10015.202196
Pre-training layer 2, epoch 36, cost -62.3454433441
Pre-training layer 2, epoch 37, cost -62.2396940231
Pre-training layer 2, epoch 38, cost -62.143092947
Pre-training layer 2, epoch 39, cost -62.0275098801
Pre-training layer 2, epoch 40, cost -61.9945649719
Pre-training layer 2, epoch 40, representative training free energy 10499.3262554
Pre-training layer 2, epoch 40, validation free energy 10417.0348892
Pre-training layer 2, epoch 41, cost -62.0248126888
Pre-training layer 2, epoch 42, cost -61.9037656021
Pre-training layer 2, epoch 43, cost -61.8720834637
Pre-training layer 2, epoch 44, cost -61.6969700241
Pre-training layer 2, epoch 45, cost -61.6633673954
Pre-training layer 2, epoch 45, representative training free energy 10928.7295618
Pre-training layer 2, epoch 45, validation free energy 10841.661395
Pre-training layer 2, epoch 46, cost -61.6694103813
Pre-training layer 2, epoch 47, cost -61.5902180576
Pre-training layer 2, epoch 48, cost -61.468672905
Pre-training layer 2, epoch 49, cost -61.3599177074
Pre-training layer 2, epoch 50, cost -61.4608936405
Pre-training layer 2, epoch 50, representative training free energy 11272.9746855
Pre-training layer 2, epoch 50, validation free energy 11183.4634919
Pre-training layer 2, epoch 51, cost -61.3297265816
Pre-training layer 2, epoch 52, cost -61.2271241665
Pre-training layer 2, epoch 53, cost -61.1995130157
Pre-training layer 2, epoch 54, cost -61.1276497459
Pre-training layer 2, epoch 55, cost -61.2247520256
Pre-training layer 2, epoch 55, representative training free energy 11651.6329883
Pre-training layer 2, epoch 55, validation free energy 11557.6859722
Pre-training layer 2, epoch 56, cost -61.0912275887
Pre-training layer 2, epoch 57, cost -61.0506016636
Pre-training layer 2, epoch 58, cost -61.0101838112
Pre-training layer 2, epoch 59, cost -61.00820858
Pre-training layer 2, epoch 60, cost -60.9523276615
Pre-training layer 2, epoch 60, representative training free energy 11982.4386023
Pre-training layer 2, epoch 60, validation free energy 11887.3018247
Pre-training layer 2, epoch 61, cost -60.9462479973
Pre-training layer 2, epoch 62, cost -60.8189522457
Pre-training layer 2, epoch 63, cost -60.7706809902
Pre-training layer 2, epoch 64, cost -60.7814150524
Pre-training layer 2, epoch 65, cost -60.6963832474
Pre-training layer 2, epoch 65, representative training free energy 12291.7300498
Pre-training layer 2, epoch 65, validation free energy 12193.33102
Pre-training layer 2, epoch 66, cost -60.739049511
Pre-training layer 2, epoch 67, cost -60.6113916206
Pre-training layer 2, epoch 68, cost -60.6138337231
Pre-training layer 2, epoch 69, cost -60.5568574715
Pre-training layer 2, epoch 70, cost -60.5714765263
Pre-training layer 2, epoch 70, representative training free energy 12592.2836445
Pre-training layer 2, epoch 70, validation free energy 12490.6889961
Pre-training layer 2, epoch 71, cost -60.4385009861
Pre-training layer 2, epoch 72, cost -60.4906969357
Pre-training layer 2, epoch 73, cost -60.525897913
Pre-training layer 2, epoch 74, cost -60.412074337
Pre-training layer 2, epoch 75, cost -60.3948637772
Pre-training layer 2, epoch 75, representative training free energy 12887.6708784
Pre-training layer 2, epoch 75, validation free energy 12785.1855396
Pre-training layer 2, epoch 76, cost -60.2679273129
Pre-training layer 2, epoch 77, cost -60.2958878422
Pre-training layer 2, epoch 78, cost -60.2711940956
Pre-training layer 2, epoch 79, cost -60.2577521324
Pre-training layer 2, epoch 80, cost -60.2303991985
Pre-training layer 2, epoch 80, representative training free energy 13173.0659331
Pre-training layer 2, epoch 80, validation free energy 13068.7590059
Pre-training layer 2, epoch 81, cost -60.1654135132
Pre-training layer 2, epoch 82, cost -60.2154922104
Pre-training layer 2, epoch 83, cost -60.1791856194
Pre-training layer 2, epoch 84, cost -60.1760140038
Pre-training layer 2, epoch 85, cost -60.1327059746
Pre-training layer 2, epoch 85, representative training free energy 13436.228376
Pre-training layer 2, epoch 85, validation free energy 13329.2275459
Pre-training layer 2, epoch 86, cost -60.0409552956
Pre-training layer 2, epoch 87, cost -60.074057045
Pre-training layer 2, epoch 88, cost -60.0738635826
Pre-training layer 2, epoch 89, cost -60.0902911377
Pre-training layer 2, epoch 90, cost -60.0384052563
Pre-training layer 2, epoch 90, representative training free energy 13683.9398857
Pre-training layer 2, epoch 90, validation free energy 13576.9597119
Pre-training layer 2, epoch 91, cost -59.9947057629
Pre-training layer 2, epoch 92, cost -59.95059659
Pre-training layer 2, epoch 93, cost -59.9160642529
Pre-training layer 2, epoch 94, cost -59.8515239334
Pre-training layer 2, epoch 95, cost -59.9434345341
Pre-training layer 2, epoch 95, representative training free energy 13959.3178081
Pre-training layer 2, epoch 95, validation free energy 13849.8002529
Pre-training layer 2, epoch 96, cost -59.8892119026
Pre-training layer 2, epoch 97, cost -59.8655837631
Pre-training layer 2, epoch 98, cost -59.8199521923
Pre-training layer 2, epoch 99, cost -59.8703814697
The pretraining code for file dbn_loop.pyc ran for 10.65m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 38.000000 %
     epoch 1, minibatch 400/400, test error of best model 32.500000 %
epoch 2, minibatch 400/400, validation error 25.500000 %
     epoch 2, minibatch 400/400, test error of best model 18.600000 %
epoch 3, minibatch 400/400, validation error 22.900000 %
     epoch 3, minibatch 400/400, test error of best model 14.800000 %
epoch 4, minibatch 400/400, validation error 21.600000 %
     epoch 4, minibatch 400/400, test error of best model 12.200000 %
epoch 5, minibatch 400/400, validation error 20.200000 %
     epoch 5, minibatch 400/400, test error of best model 10.700000 %
epoch 6, minibatch 400/400, validation error 19.000000 %
     epoch 6, minibatch 400/400, test error of best model 9.700000 %
epoch 7, minibatch 400/400, validation error 18.500000 %
     epoch 7, minibatch 400/400, test error of best model 9.000000 %
epoch 8, minibatch 400/400, validation error 18.000000 %
     epoch 8, minibatch 400/400, test error of best model 8.300000 %
epoch 9, minibatch 400/400, validation error 17.600000 %
     epoch 9, minibatch 400/400, test error of best model 7.900000 %
epoch 10, minibatch 400/400, validation error 17.200000 %
     epoch 10, minibatch 400/400, test error of best model 7.300000 %
epoch 11, minibatch 400/400, validation error 16.800000 %
     epoch 11, minibatch 400/400, test error of best model 7.100000 %
epoch 12, minibatch 400/400, validation error 16.400000 %
     epoch 12, minibatch 400/400, test error of best model 6.900000 %
epoch 13, minibatch 400/400, validation error 16.200000 %
     epoch 13, minibatch 400/400, test error of best model 7.100000 %
epoch 14, minibatch 400/400, validation error 16.200000 %
epoch 15, minibatch 400/400, validation error 16.100000 %
     epoch 15, minibatch 400/400, test error of best model 7.000000 %
epoch 16, minibatch 400/400, validation error 16.100000 %
epoch 17, minibatch 400/400, validation error 15.900000 %
     epoch 17, minibatch 400/400, test error of best model 7.000000 %
epoch 18, minibatch 400/400, validation error 15.700000 %
     epoch 18, minibatch 400/400, test error of best model 7.000000 %
epoch 19, minibatch 400/400, validation error 15.600000 %
     epoch 19, minibatch 400/400, test error of best model 6.800000 %
epoch 20, minibatch 400/400, validation error 15.600000 %
epoch 21, minibatch 400/400, validation error 15.500000 %
     epoch 21, minibatch 400/400, test error of best model 6.700000 %
epoch 22, minibatch 400/400, validation error 15.400000 %
     epoch 22, minibatch 400/400, test error of best model 6.500000 %
epoch 23, minibatch 400/400, validation error 15.200000 %
     epoch 23, minibatch 400/400, test error of best model 6.400000 %
epoch 24, minibatch 400/400, validation error 15.200000 %
epoch 25, minibatch 400/400, validation error 15.300000 %
epoch 26, minibatch 400/400, validation error 15.400000 %
epoch 27, minibatch 400/400, validation error 15.400000 %
epoch 28, minibatch 400/400, validation error 15.300000 %
epoch 29, minibatch 400/400, validation error 15.300000 %
epoch 30, minibatch 400/400, validation error 15.400000 %
epoch 31, minibatch 400/400, validation error 15.400000 %
epoch 32, minibatch 400/400, validation error 15.400000 %
epoch 33, minibatch 400/400, validation error 15.300000 %
epoch 34, minibatch 400/400, validation error 15.300000 %
epoch 35, minibatch 400/400, validation error 15.300000 %
epoch 36, minibatch 400/400, validation error 15.300000 %
epoch 37, minibatch 400/400, validation error 15.300000 %
epoch 38, minibatch 400/400, validation error 15.300000 %
epoch 39, minibatch 400/400, validation error 15.300000 %
epoch 40, minibatch 400/400, validation error 15.300000 %
epoch 41, minibatch 400/400, validation error 15.300000 %
epoch 42, minibatch 400/400, validation error 15.200000 %
epoch 43, minibatch 400/400, validation error 15.200000 %
epoch 44, minibatch 400/400, validation error 15.200000 %
epoch 45, minibatch 400/400, validation error 15.200000 %
Optimization complete with best validation score of 15.200000 %, obtained at iteration 9200, with test performance 6.400000 %
The fine tuning code for file dbn_loop.pyc ran for 1.65m


==========Sample: (5000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.442772263
Pre-training layer 0, epoch 0, representative training free energy -545.327110107
Pre-training layer 0, epoch 0, validation free energy -541.566759949
Pre-training layer 0, epoch 1, cost -108.729869537
Pre-training layer 0, epoch 2, cost -100.924046143
Pre-training layer 0, epoch 3, cost -96.4057875061
Pre-training layer 0, epoch 4, cost -93.4523356171
Pre-training layer 0, epoch 5, cost -91.390066803
Pre-training layer 0, epoch 5, representative training free energy -487.787284607
Pre-training layer 0, epoch 5, validation free energy -482.821799805
Pre-training layer 0, epoch 6, cost -89.6341344757
Pre-training layer 0, epoch 7, cost -88.2781000824
Pre-training layer 0, epoch 8, cost -86.9549994125
Pre-training layer 0, epoch 9, cost -86.1325884171
Pre-training layer 0, epoch 10, cost -85.4039988861
Pre-training layer 0, epoch 10, representative training free energy -466.752694733
Pre-training layer 0, epoch 10, validation free energy -460.793564758
Pre-training layer 0, epoch 11, cost -84.5389663239
Pre-training layer 0, epoch 12, cost -84.0004775543
Pre-training layer 0, epoch 13, cost -83.3644643021
Pre-training layer 0, epoch 14, cost -82.7542327652
Pre-training layer 0, epoch 15, cost -82.3343040085
Pre-training layer 0, epoch 15, representative training free energy -453.366467194
Pre-training layer 0, epoch 15, validation free energy -447.579606171
Pre-training layer 0, epoch 16, cost -81.9845004807
Pre-training layer 0, epoch 17, cost -81.5383291245
Pre-training layer 0, epoch 18, cost -81.2029936295
Pre-training layer 0, epoch 19, cost -80.9461180496
Pre-training layer 0, epoch 20, cost -80.5599864426
Pre-training layer 0, epoch 20, representative training free energy -448.95170108
Pre-training layer 0, epoch 20, validation free energy -442.366514587
Pre-training layer 0, epoch 21, cost -80.2282244186
Pre-training layer 0, epoch 22, cost -80.0640762482
Pre-training layer 0, epoch 23, cost -79.7391996689
Pre-training layer 0, epoch 24, cost -79.4891736298
Pre-training layer 0, epoch 25, cost -79.1658519211
Pre-training layer 0, epoch 25, representative training free energy -442.616892487
Pre-training layer 0, epoch 25, validation free energy -435.558652832
Pre-training layer 0, epoch 26, cost -79.0444469757
Pre-training layer 0, epoch 27, cost -78.6529416122
Pre-training layer 0, epoch 28, cost -78.5512433395
Pre-training layer 0, epoch 29, cost -78.313634758
Pre-training layer 0, epoch 30, cost -78.1817413101
Pre-training layer 0, epoch 30, representative training free energy -443.010748077
Pre-training layer 0, epoch 30, validation free energy -435.893434753
Pre-training layer 0, epoch 31, cost -77.9473570404
Pre-training layer 0, epoch 32, cost -77.8555969849
Pre-training layer 0, epoch 33, cost -77.6744525909
Pre-training layer 0, epoch 34, cost -77.4141999817
Pre-training layer 0, epoch 35, cost -77.4261899338
Pre-training layer 0, epoch 35, representative training free energy -439.44468573
Pre-training layer 0, epoch 35, validation free energy -431.848898987
Pre-training layer 0, epoch 36, cost -77.1914825439
Pre-training layer 0, epoch 37, cost -77.1689364624
Pre-training layer 0, epoch 38, cost -77.0070956116
Pre-training layer 0, epoch 39, cost -76.8990590668
Pre-training layer 0, epoch 40, cost -76.7680312881
Pre-training layer 0, epoch 40, representative training free energy -433.879655853
Pre-training layer 0, epoch 40, validation free energy -426.35843985
Pre-training layer 0, epoch 41, cost -76.5677926712
Pre-training layer 0, epoch 42, cost -76.480421402
Pre-training layer 0, epoch 43, cost -76.3473741608
Pre-training layer 0, epoch 44, cost -76.1753516006
Pre-training layer 0, epoch 45, cost -76.0706692581
Pre-training layer 0, epoch 45, representative training free energy -436.053249054
Pre-training layer 0, epoch 45, validation free energy -428.365293427
Pre-training layer 0, epoch 46, cost -76.0809822006
Pre-training layer 0, epoch 47, cost -75.9375301743
Pre-training layer 0, epoch 48, cost -75.8220889816
Pre-training layer 0, epoch 49, cost -75.6023552094
Pre-training layer 0, epoch 50, cost -75.7369538803
Pre-training layer 0, epoch 50, representative training free energy -431.838395477
Pre-training layer 0, epoch 50, validation free energy -424.698250702
Pre-training layer 0, epoch 51, cost -75.4457380219
Pre-training layer 0, epoch 52, cost -75.3954570618
Pre-training layer 0, epoch 53, cost -75.316379158
Pre-training layer 0, epoch 54, cost -75.3018782806
Pre-training layer 0, epoch 55, cost -75.0847634811
Pre-training layer 0, epoch 55, representative training free energy -427.389705719
Pre-training layer 0, epoch 55, validation free energy -419.773607788
Pre-training layer 0, epoch 56, cost -75.094202919
Pre-training layer 0, epoch 57, cost -74.9860913849
Pre-training layer 0, epoch 58, cost -75.0303018646
Pre-training layer 0, epoch 59, cost -74.9389903793
Pre-training layer 0, epoch 60, cost -74.799642952
Pre-training layer 0, epoch 60, representative training free energy -428.599191162
Pre-training layer 0, epoch 60, validation free energy -419.818812775
Pre-training layer 0, epoch 61, cost -74.7312170868
Pre-training layer 0, epoch 62, cost -74.5930433731
Pre-training layer 0, epoch 63, cost -74.6242334595
Pre-training layer 0, epoch 64, cost -74.5725009308
Pre-training layer 0, epoch 65, cost -74.4257126083
Pre-training layer 0, epoch 65, representative training free energy -427.782596863
Pre-training layer 0, epoch 65, validation free energy -419.963268219
Pre-training layer 0, epoch 66, cost -74.3573916473
Pre-training layer 0, epoch 67, cost -74.3010948563
Pre-training layer 0, epoch 68, cost -74.2079000549
Pre-training layer 0, epoch 69, cost -74.2351634598
Pre-training layer 0, epoch 70, cost -74.0815997467
Pre-training layer 0, epoch 70, representative training free energy -427.946190247
Pre-training layer 0, epoch 70, validation free energy -419.004233917
Pre-training layer 0, epoch 71, cost -74.1044633408
Pre-training layer 0, epoch 72, cost -74.053557518
Pre-training layer 0, epoch 73, cost -73.9534778671
Pre-training layer 0, epoch 74, cost -73.804569458
Pre-training layer 0, epoch 75, cost -73.8101380005
Pre-training layer 0, epoch 75, representative training free energy -425.150223755
Pre-training layer 0, epoch 75, validation free energy -417.010919128
Pre-training layer 0, epoch 76, cost -73.8403704224
Pre-training layer 0, epoch 77, cost -73.7702860107
Pre-training layer 0, epoch 78, cost -73.6400418091
Pre-training layer 0, epoch 79, cost -73.5816807632
Pre-training layer 0, epoch 80, cost -73.6340058517
Pre-training layer 0, epoch 80, representative training free energy -426.688151825
Pre-training layer 0, epoch 80, validation free energy -418.335596252
Pre-training layer 0, epoch 81, cost -73.5860450745
Pre-training layer 0, epoch 82, cost -73.4507603607
Pre-training layer 0, epoch 83, cost -73.374280365
Pre-training layer 0, epoch 84, cost -73.3348086624
Pre-training layer 0, epoch 85, cost -73.2529049377
Pre-training layer 0, epoch 85, representative training free energy -422.967336823
Pre-training layer 0, epoch 85, validation free energy -414.79938147
Pre-training layer 0, epoch 86, cost -73.26970681
Pre-training layer 0, epoch 87, cost -73.2372134171
Pre-training layer 0, epoch 88, cost -73.1832679672
Pre-training layer 0, epoch 89, cost -72.9702531662
Pre-training layer 0, epoch 90, cost -73.02536026
Pre-training layer 0, epoch 90, representative training free energy -421.225003265
Pre-training layer 0, epoch 90, validation free energy -413.165950409
Pre-training layer 0, epoch 91, cost -72.9692037506
Pre-training layer 0, epoch 92, cost -72.9012835464
Pre-training layer 0, epoch 93, cost -72.9663090591
Pre-training layer 0, epoch 94, cost -72.8357841721
Pre-training layer 0, epoch 95, cost -72.9192896194
Pre-training layer 0, epoch 95, representative training free energy -422.709885681
Pre-training layer 0, epoch 95, validation free energy -414.163304626
Pre-training layer 0, epoch 96, cost -72.804970871
Pre-training layer 0, epoch 97, cost -72.7660655289
Pre-training layer 0, epoch 98, cost -72.7825363312
Pre-training layer 0, epoch 99, cost -72.6580542755
Pre-training layer 1, epoch 0, cost -311.160400269
Pre-training layer 1, epoch 0, representative training free energy -61756.4759434
Pre-training layer 1, epoch 0, validation free energy -61313.3728086
Pre-training layer 1, epoch 1, cost -267.398730988
Pre-training layer 1, epoch 2, cost -254.097630371
Pre-training layer 1, epoch 3, cost -246.486655457
Pre-training layer 1, epoch 4, cost -241.135249298
Pre-training layer 1, epoch 5, cost -237.520930786
Pre-training layer 1, epoch 5, representative training free energy -82164.9401758
Pre-training layer 1, epoch 5, validation free energy -81511.7479316
Pre-training layer 1, epoch 6, cost -234.652916351
Pre-training layer 1, epoch 7, cost -232.257919281
Pre-training layer 1, epoch 8, cost -230.32188501
Pre-training layer 1, epoch 9, cost -228.678075867
Pre-training layer 1, epoch 10, cost -227.302947601
Pre-training layer 1, epoch 10, representative training free energy -88396.1952949
Pre-training layer 1, epoch 10, validation free energy -87672.4286953
Pre-training layer 1, epoch 11, cost -226.018638275
Pre-training layer 1, epoch 12, cost -225.093777161
Pre-training layer 1, epoch 13, cost -224.179584869
Pre-training layer 1, epoch 14, cost -223.302714294
Pre-training layer 1, epoch 15, cost -222.611906342
Pre-training layer 1, epoch 15, representative training free energy -92016.7040254
Pre-training layer 1, epoch 15, validation free energy -91254.4792324
Pre-training layer 1, epoch 16, cost -221.996999725
Pre-training layer 1, epoch 17, cost -221.406664917
Pre-training layer 1, epoch 18, cost -220.741898895
Pre-training layer 1, epoch 19, cost -220.252036224
Pre-training layer 1, epoch 20, cost -219.797077881
Pre-training layer 1, epoch 20, representative training free energy -94718.3650781
Pre-training layer 1, epoch 20, validation free energy -93913.2615898
Pre-training layer 1, epoch 21, cost -219.398842407
Pre-training layer 1, epoch 22, cost -218.978430817
Pre-training layer 1, epoch 23, cost -218.472862854
Pre-training layer 1, epoch 24, cost -218.237102386
Pre-training layer 1, epoch 25, cost -217.89875
Pre-training layer 1, epoch 25, representative training free energy -96772.787623
Pre-training layer 1, epoch 25, validation free energy -95949.3276758
Pre-training layer 1, epoch 26, cost -217.511959015
Pre-training layer 1, epoch 27, cost -217.307489624
Pre-training layer 1, epoch 28, cost -217.003201874
Pre-training layer 1, epoch 29, cost -216.777971222
Pre-training layer 1, epoch 30, cost -216.522902435
Pre-training layer 1, epoch 30, representative training free energy -98603.7373516
Pre-training layer 1, epoch 30, validation free energy -97770.6412012
Pre-training layer 1, epoch 31, cost -216.208491272
Pre-training layer 1, epoch 32, cost -215.951816437
Pre-training layer 1, epoch 33, cost -215.740076996
Pre-training layer 1, epoch 34, cost -215.508032257
Pre-training layer 1, epoch 35, cost -215.359318207
Pre-training layer 1, epoch 35, representative training free energy -100066.597668
Pre-training layer 1, epoch 35, validation free energy -99225.4790547
Pre-training layer 1, epoch 36, cost -215.152391724
Pre-training layer 1, epoch 37, cost -214.930151794
Pre-training layer 1, epoch 38, cost -214.709082031
Pre-training layer 1, epoch 39, cost -214.583705383
Pre-training layer 1, epoch 40, cost -214.397648102
Pre-training layer 1, epoch 40, representative training free energy -101311.379693
Pre-training layer 1, epoch 40, validation free energy -100430.54668
Pre-training layer 1, epoch 41, cost -214.271491638
Pre-training layer 1, epoch 42, cost -214.09035498
Pre-training layer 1, epoch 43, cost -213.954595459
Pre-training layer 1, epoch 44, cost -213.79687973
Pre-training layer 1, epoch 45, cost -213.609479248
Pre-training layer 1, epoch 45, representative training free energy -102458.678902
Pre-training layer 1, epoch 45, validation free energy -101574.364551
Pre-training layer 1, epoch 46, cost -213.513270966
Pre-training layer 1, epoch 47, cost -213.317871857
Pre-training layer 1, epoch 48, cost -213.142557587
Pre-training layer 1, epoch 49, cost -213.12974527
Pre-training layer 1, epoch 50, cost -212.929995972
Pre-training layer 1, epoch 50, representative training free energy -103608.588961
Pre-training layer 1, epoch 50, validation free energy -102716.568105
Pre-training layer 1, epoch 51, cost -212.839840698
Pre-training layer 1, epoch 52, cost -212.748396027
Pre-training layer 1, epoch 53, cost -212.452362091
Pre-training layer 1, epoch 54, cost -212.446585724
Pre-training layer 1, epoch 55, cost -212.326703705
Pre-training layer 1, epoch 55, representative training free energy -104654.644816
Pre-training layer 1, epoch 55, validation free energy -103757.322055
Pre-training layer 1, epoch 56, cost -212.24588858
Pre-training layer 1, epoch 57, cost -212.074445557
Pre-training layer 1, epoch 58, cost -212.007695587
Pre-training layer 1, epoch 59, cost -211.939493683
Pre-training layer 1, epoch 60, cost -211.852501099
Pre-training layer 1, epoch 60, representative training free energy -105478.059023
Pre-training layer 1, epoch 60, validation free energy -104551.391664
Pre-training layer 1, epoch 61, cost -211.734134583
Pre-training layer 1, epoch 62, cost -211.702533051
Pre-training layer 1, epoch 63, cost -211.524642731
Pre-training layer 1, epoch 64, cost -211.539325195
Pre-training layer 1, epoch 65, cost -211.446740082
Pre-training layer 1, epoch 65, representative training free energy -106238.561961
Pre-training layer 1, epoch 65, validation free energy -105326.042234
Pre-training layer 1, epoch 66, cost -211.281946198
Pre-training layer 1, epoch 67, cost -211.246365265
Pre-training layer 1, epoch 68, cost -211.139236237
Pre-training layer 1, epoch 69, cost -211.006188599
Pre-training layer 1, epoch 70, cost -211.038724609
Pre-training layer 1, epoch 70, representative training free energy -107064.130438
Pre-training layer 1, epoch 70, validation free energy -106131.759488
Pre-training layer 1, epoch 71, cost -210.951049255
Pre-training layer 1, epoch 72, cost -210.806991821
Pre-training layer 1, epoch 73, cost -210.778105927
Pre-training layer 1, epoch 74, cost -210.660798737
Pre-training layer 1, epoch 75, cost -210.638903229
Pre-training layer 1, epoch 75, representative training free energy -107726.217508
Pre-training layer 1, epoch 75, validation free energy -106791.268082
Pre-training layer 1, epoch 76, cost -210.622426117
Pre-training layer 1, epoch 77, cost -210.48240506
Pre-training layer 1, epoch 78, cost -210.460975861
Pre-training layer 1, epoch 79, cost -210.323108826
Pre-training layer 1, epoch 80, cost -210.299150024
Pre-training layer 1, epoch 80, representative training free energy -108408.208992
Pre-training layer 1, epoch 80, validation free energy -107456.455152
Pre-training layer 1, epoch 81, cost -210.215332153
Pre-training layer 1, epoch 82, cost -210.246765808
Pre-training layer 1, epoch 83, cost -210.102436951
Pre-training layer 1, epoch 84, cost -210.056576874
Pre-training layer 1, epoch 85, cost -209.957264343
Pre-training layer 1, epoch 85, representative training free energy -109139.96332
Pre-training layer 1, epoch 85, validation free energy -108182.651453
Pre-training layer 1, epoch 86, cost -209.999279327
Pre-training layer 1, epoch 87, cost -209.914230835
Pre-training layer 1, epoch 88, cost -209.824709442
Pre-training layer 1, epoch 89, cost -209.751623962
Pre-training layer 1, epoch 90, cost -209.781666199
Pre-training layer 1, epoch 90, representative training free energy -109721.5815
Pre-training layer 1, epoch 90, validation free energy -108768.065117
Pre-training layer 1, epoch 91, cost -209.757418884
Pre-training layer 1, epoch 92, cost -209.595405487
Pre-training layer 1, epoch 93, cost -209.643049225
Pre-training layer 1, epoch 94, cost -209.543198944
Pre-training layer 1, epoch 95, cost -209.543705933
Pre-training layer 1, epoch 95, representative training free energy -110340.816688
Pre-training layer 1, epoch 95, validation free energy -109379.624148
Pre-training layer 1, epoch 96, cost -209.535650421
Pre-training layer 1, epoch 97, cost -209.393869904
Pre-training layer 1, epoch 98, cost -209.454764832
Pre-training layer 1, epoch 99, cost -209.367461914
Pre-training layer 2, epoch 0, cost -113.970766098
Pre-training layer 2, epoch 0, representative training free energy 4146.48054547
Pre-training layer 2, epoch 0, validation free energy 4107.24921313
Pre-training layer 2, epoch 1, cost -85.9794924088
Pre-training layer 2, epoch 2, cost -79.7267869568
Pre-training layer 2, epoch 3, cost -76.0257110901
Pre-training layer 2, epoch 4, cost -73.8705215073
Pre-training layer 2, epoch 5, cost -72.0487219315
Pre-training layer 2, epoch 5, representative training free energy 6756.63603406
Pre-training layer 2, epoch 5, validation free energy 6687.42375439
Pre-training layer 2, epoch 6, cost -70.8378372574
Pre-training layer 2, epoch 7, cost -69.7793846741
Pre-training layer 2, epoch 8, cost -68.8047612991
Pre-training layer 2, epoch 9, cost -68.1864220505
Pre-training layer 2, epoch 10, cost -67.5307554932
Pre-training layer 2, epoch 10, representative training free energy 8085.12164795
Pre-training layer 2, epoch 10, validation free energy 8011.10958081
Pre-training layer 2, epoch 11, cost -67.0120171051
Pre-training layer 2, epoch 12, cost -66.5833042068
Pre-training layer 2, epoch 13, cost -66.1107644501
Pre-training layer 2, epoch 14, cost -65.6955164642
Pre-training layer 2, epoch 15, cost -65.4217232056
Pre-training layer 2, epoch 15, representative training free energy 9044.32522412
Pre-training layer 2, epoch 15, validation free energy 8967.48954346
Pre-training layer 2, epoch 16, cost -65.0739180145
Pre-training layer 2, epoch 17, cost -64.8216671371
Pre-training layer 2, epoch 18, cost -64.5541034775
Pre-training layer 2, epoch 19, cost -64.2581803131
Pre-training layer 2, epoch 20, cost -64.0773831635
Pre-training layer 2, epoch 20, representative training free energy 9840.43995215
Pre-training layer 2, epoch 20, validation free energy 9759.14348657
Pre-training layer 2, epoch 21, cost -63.9317033844
Pre-training layer 2, epoch 22, cost -63.6758918304
Pre-training layer 2, epoch 23, cost -63.6122533569
Pre-training layer 2, epoch 24, cost -63.4232384796
Pre-training layer 2, epoch 25, cost -63.2182445908
Pre-training layer 2, epoch 25, representative training free energy 10513.1863533
Pre-training layer 2, epoch 25, validation free energy 10425.0813008
Pre-training layer 2, epoch 26, cost -63.1230455017
Pre-training layer 2, epoch 27, cost -63.0214851913
Pre-training layer 2, epoch 28, cost -62.8989734421
Pre-training layer 2, epoch 29, cost -62.7885035629
Pre-training layer 2, epoch 30, cost -62.633785347
Pre-training layer 2, epoch 30, representative training free energy 11077.5427109
Pre-training layer 2, epoch 30, validation free energy 10986.4058989
Pre-training layer 2, epoch 31, cost -62.510459938
Pre-training layer 2, epoch 32, cost -62.4020371017
Pre-training layer 2, epoch 33, cost -62.3022406998
Pre-training layer 2, epoch 34, cost -62.2407984238
Pre-training layer 2, epoch 35, cost -62.1461891174
Pre-training layer 2, epoch 35, representative training free energy 11584.3855906
Pre-training layer 2, epoch 35, validation free energy 11486.6041738
Pre-training layer 2, epoch 36, cost -62.1077427979
Pre-training layer 2, epoch 37, cost -62.0078679199
Pre-training layer 2, epoch 38, cost -61.8987018585
Pre-training layer 2, epoch 39, cost -61.7430762024
Pre-training layer 2, epoch 40, cost -61.7327527237
Pre-training layer 2, epoch 40, representative training free energy 12073.977585
Pre-training layer 2, epoch 40, validation free energy 11971.5966011
Pre-training layer 2, epoch 41, cost -61.6609197845
Pre-training layer 2, epoch 42, cost -61.6330519714
Pre-training layer 2, epoch 43, cost -61.6182006683
Pre-training layer 2, epoch 44, cost -61.4852868576
Pre-training layer 2, epoch 45, cost -61.4984821243
Pre-training layer 2, epoch 45, representative training free energy 12523.7208169
Pre-training layer 2, epoch 45, validation free energy 12418.5065693
Pre-training layer 2, epoch 46, cost -61.3866357269
Pre-training layer 2, epoch 47, cost -61.3368127213
Pre-training layer 2, epoch 48, cost -61.2852878418
Pre-training layer 2, epoch 49, cost -61.2425643234
Pre-training layer 2, epoch 50, cost -61.1461225281
Pre-training layer 2, epoch 50, representative training free energy 12936.0176133
Pre-training layer 2, epoch 50, validation free energy 12827.7494419
Pre-training layer 2, epoch 51, cost -61.148706871
Pre-training layer 2, epoch 52, cost -61.0576223984
Pre-training layer 2, epoch 53, cost -61.07610466
Pre-training layer 2, epoch 54, cost -60.9999940338
Pre-training layer 2, epoch 55, cost -60.9690951538
Pre-training layer 2, epoch 55, representative training free energy 13330.3435894
Pre-training layer 2, epoch 55, validation free energy 13219.3295913
Pre-training layer 2, epoch 56, cost -60.8853214493
Pre-training layer 2, epoch 57, cost -60.7953129196
Pre-training layer 2, epoch 58, cost -60.852415596
Pre-training layer 2, epoch 59, cost -60.7445687256
Pre-training layer 2, epoch 60, cost -60.7694368057
Pre-training layer 2, epoch 60, representative training free energy 13712.7980786
Pre-training layer 2, epoch 60, validation free energy 13597.9457417
Pre-training layer 2, epoch 61, cost -60.6676522903
Pre-training layer 2, epoch 62, cost -60.6347914276
Pre-training layer 2, epoch 63, cost -60.6063061295
Pre-training layer 2, epoch 64, cost -60.6281158218
Pre-training layer 2, epoch 65, cost -60.5615904999
Pre-training layer 2, epoch 65, representative training free energy 14075.8209424
Pre-training layer 2, epoch 65, validation free energy 13957.543915
Pre-training layer 2, epoch 66, cost -60.5103048859
Pre-training layer 2, epoch 67, cost -60.524006279
Pre-training layer 2, epoch 68, cost -60.5082022858
Pre-training layer 2, epoch 69, cost -60.4170405502
Pre-training layer 2, epoch 70, cost -60.4236122742
Pre-training layer 2, epoch 70, representative training free energy 14436.6634365
Pre-training layer 2, epoch 70, validation free energy 14316.0740205
Pre-training layer 2, epoch 71, cost -60.3238976822
Pre-training layer 2, epoch 72, cost -60.3417363815
Pre-training layer 2, epoch 73, cost -60.2786665573
Pre-training layer 2, epoch 74, cost -60.2469061432
Pre-training layer 2, epoch 75, cost -60.3109897308
Pre-training layer 2, epoch 75, representative training free energy 14777.0659028
Pre-training layer 2, epoch 75, validation free energy 14654.0588657
Pre-training layer 2, epoch 76, cost -60.2086896515
Pre-training layer 2, epoch 77, cost -60.2412225571
Pre-training layer 2, epoch 78, cost -60.1980175476
Pre-training layer 2, epoch 79, cost -60.1486324234
Pre-training layer 2, epoch 80, cost -60.071463562
Pre-training layer 2, epoch 80, representative training free energy 15151.891333
Pre-training layer 2, epoch 80, validation free energy 15024.8604146
Pre-training layer 2, epoch 81, cost -60.1141972961
Pre-training layer 2, epoch 82, cost -60.1048497314
Pre-training layer 2, epoch 83, cost -60.0254261475
Pre-training layer 2, epoch 84, cost -60.0477090378
Pre-training layer 2, epoch 85, cost -59.9618359451
Pre-training layer 2, epoch 85, representative training free energy 15445.8300752
Pre-training layer 2, epoch 85, validation free energy 15316.1722617
Pre-training layer 2, epoch 86, cost -60.0532176514
Pre-training layer 2, epoch 87, cost -59.9122101059
Pre-training layer 2, epoch 88, cost -59.9250866089
Pre-training layer 2, epoch 89, cost -59.893169342
Pre-training layer 2, epoch 90, cost -59.9121030655
Pre-training layer 2, epoch 90, representative training free energy 15757.8060991
Pre-training layer 2, epoch 90, validation free energy 15625.4021104
Pre-training layer 2, epoch 91, cost -59.8703538666
Pre-training layer 2, epoch 92, cost -59.8497056274
Pre-training layer 2, epoch 93, cost -59.8219285965
Pre-training layer 2, epoch 94, cost -59.8065872269
Pre-training layer 2, epoch 95, cost -59.865277977
Pre-training layer 2, epoch 95, representative training free energy 16113.8970806
Pre-training layer 2, epoch 95, validation free energy 15979.0198208
Pre-training layer 2, epoch 96, cost -59.7849785995
Pre-training layer 2, epoch 97, cost -59.8246579208
Pre-training layer 2, epoch 98, cost -59.7551096039
Pre-training layer 2, epoch 99, cost -59.7786221542
The pretraining code for file dbn_loop.pyc ran for 13.62m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 31.500000 %
     epoch 1, minibatch 500/500, test error of best model 26.200000 %
epoch 2, minibatch 500/500, validation error 23.800000 %
     epoch 2, minibatch 500/500, test error of best model 16.800000 %
epoch 3, minibatch 500/500, validation error 21.300000 %
     epoch 3, minibatch 500/500, test error of best model 13.800000 %
epoch 4, minibatch 500/500, validation error 20.600000 %
     epoch 4, minibatch 500/500, test error of best model 12.000000 %
epoch 5, minibatch 500/500, validation error 19.000000 %
     epoch 5, minibatch 500/500, test error of best model 10.500000 %
epoch 6, minibatch 500/500, validation error 18.000000 %
     epoch 6, minibatch 500/500, test error of best model 9.700000 %
epoch 7, minibatch 500/500, validation error 17.000000 %
     epoch 7, minibatch 500/500, test error of best model 8.800000 %
epoch 8, minibatch 500/500, validation error 16.900000 %
     epoch 8, minibatch 500/500, test error of best model 8.300000 %
epoch 9, minibatch 500/500, validation error 16.700000 %
     epoch 9, minibatch 500/500, test error of best model 7.000000 %
epoch 10, minibatch 500/500, validation error 16.400000 %
     epoch 10, minibatch 500/500, test error of best model 6.700000 %
epoch 11, minibatch 500/500, validation error 16.100000 %
     epoch 11, minibatch 500/500, test error of best model 6.400000 %
epoch 12, minibatch 500/500, validation error 15.900000 %
     epoch 12, minibatch 500/500, test error of best model 6.100000 %
epoch 13, minibatch 500/500, validation error 15.700000 %
     epoch 13, minibatch 500/500, test error of best model 6.100000 %
epoch 14, minibatch 500/500, validation error 15.600000 %
     epoch 14, minibatch 500/500, test error of best model 5.900000 %
epoch 15, minibatch 500/500, validation error 15.700000 %
epoch 16, minibatch 500/500, validation error 15.600000 %
epoch 17, minibatch 500/500, validation error 15.700000 %
epoch 18, minibatch 500/500, validation error 15.500000 %
     epoch 18, minibatch 500/500, test error of best model 5.600000 %
epoch 19, minibatch 500/500, validation error 15.400000 %
     epoch 19, minibatch 500/500, test error of best model 5.500000 %
epoch 20, minibatch 500/500, validation error 15.400000 %
epoch 21, minibatch 500/500, validation error 15.300000 %
     epoch 21, minibatch 500/500, test error of best model 5.400000 %
epoch 22, minibatch 500/500, validation error 15.300000 %
epoch 23, minibatch 500/500, validation error 15.100000 %
     epoch 23, minibatch 500/500, test error of best model 5.400000 %
epoch 24, minibatch 500/500, validation error 15.000000 %
     epoch 24, minibatch 500/500, test error of best model 5.300000 %
epoch 25, minibatch 500/500, validation error 15.000000 %
epoch 26, minibatch 500/500, validation error 14.900000 %
     epoch 26, minibatch 500/500, test error of best model 5.300000 %
epoch 27, minibatch 500/500, validation error 14.800000 %
     epoch 27, minibatch 500/500, test error of best model 5.300000 %
epoch 28, minibatch 500/500, validation error 14.800000 %
epoch 29, minibatch 500/500, validation error 14.600000 %
     epoch 29, minibatch 500/500, test error of best model 5.500000 %
epoch 30, minibatch 500/500, validation error 14.400000 %
     epoch 30, minibatch 500/500, test error of best model 5.600000 %
epoch 31, minibatch 500/500, validation error 14.300000 %
     epoch 31, minibatch 500/500, test error of best model 5.600000 %
epoch 32, minibatch 500/500, validation error 14.300000 %
epoch 33, minibatch 500/500, validation error 14.300000 %
epoch 34, minibatch 500/500, validation error 14.400000 %
epoch 35, minibatch 500/500, validation error 14.400000 %
epoch 36, minibatch 500/500, validation error 14.400000 %
epoch 37, minibatch 500/500, validation error 14.500000 %
epoch 38, minibatch 500/500, validation error 14.600000 %
epoch 39, minibatch 500/500, validation error 14.500000 %
epoch 40, minibatch 500/500, validation error 14.400000 %
epoch 41, minibatch 500/500, validation error 14.400000 %
epoch 42, minibatch 500/500, validation error 14.300000 %
epoch 43, minibatch 500/500, validation error 14.300000 %
epoch 44, minibatch 500/500, validation error 14.200000 %
     epoch 44, minibatch 500/500, test error of best model 5.500000 %
epoch 45, minibatch 500/500, validation error 14.200000 %
epoch 46, minibatch 500/500, validation error 14.200000 %
epoch 47, minibatch 500/500, validation error 14.200000 %
epoch 48, minibatch 500/500, validation error 14.100000 %
     epoch 48, minibatch 500/500, test error of best model 5.300000 %
epoch 49, minibatch 500/500, validation error 14.100000 %
epoch 50, minibatch 500/500, validation error 14.100000 %
epoch 51, minibatch 500/500, validation error 14.100000 %
epoch 52, minibatch 500/500, validation error 14.100000 %
epoch 53, minibatch 500/500, validation error 14.100000 %
epoch 54, minibatch 500/500, validation error 14.100000 %
epoch 55, minibatch 500/500, validation error 14.100000 %
epoch 56, minibatch 500/500, validation error 14.100000 %
epoch 57, minibatch 500/500, validation error 14.100000 %
epoch 58, minibatch 500/500, validation error 14.100000 %
epoch 59, minibatch 500/500, validation error 14.100000 %
epoch 60, minibatch 500/500, validation error 14.100000 %
epoch 61, minibatch 500/500, validation error 14.100000 %
epoch 62, minibatch 500/500, validation error 14.100000 %
epoch 63, minibatch 500/500, validation error 14.100000 %
epoch 64, minibatch 500/500, validation error 14.100000 %
epoch 65, minibatch 500/500, validation error 14.100000 %
epoch 66, minibatch 500/500, validation error 14.100000 %
epoch 67, minibatch 500/500, validation error 14.100000 %
epoch 68, minibatch 500/500, validation error 14.100000 %
epoch 69, minibatch 500/500, validation error 14.100000 %
epoch 70, minibatch 500/500, validation error 14.100000 %
epoch 71, minibatch 500/500, validation error 14.100000 %
epoch 72, minibatch 500/500, validation error 14.100000 %
epoch 73, minibatch 500/500, validation error 14.100000 %
epoch 74, minibatch 500/500, validation error 14.100000 %
epoch 75, minibatch 500/500, validation error 14.100000 %
epoch 76, minibatch 500/500, validation error 14.100000 %
epoch 77, minibatch 500/500, validation error 14.100000 %
epoch 78, minibatch 500/500, validation error 14.100000 %
epoch 79, minibatch 500/500, validation error 14.100000 %
epoch 80, minibatch 500/500, validation error 14.100000 %
epoch 81, minibatch 500/500, validation error 14.100000 %
epoch 82, minibatch 500/500, validation error 14.100000 %
epoch 83, minibatch 500/500, validation error 14.100000 %
epoch 84, minibatch 500/500, validation error 14.100000 %
epoch 85, minibatch 500/500, validation error 14.100000 %
epoch 86, minibatch 500/500, validation error 14.100000 %
epoch 87, minibatch 500/500, validation error 14.200000 %
epoch 88, minibatch 500/500, validation error 14.200000 %
epoch 89, minibatch 500/500, validation error 14.200000 %
epoch 90, minibatch 500/500, validation error 14.200000 %
epoch 91, minibatch 500/500, validation error 14.200000 %
epoch 92, minibatch 500/500, validation error 14.200000 %
epoch 93, minibatch 500/500, validation error 14.200000 %
epoch 94, minibatch 500/500, validation error 14.200000 %
epoch 95, minibatch 500/500, validation error 14.200000 %
Optimization complete with best validation score of 14.100000 %, obtained at iteration 24000, with test performance 5.300000 %
The fine tuning code for file dbn_loop.pyc ran for 4.24m
_______RUN: 1

==========Sample: (1000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -183.751922913
Pre-training layer 0, epoch 0, representative training free energy -596.509592926
Pre-training layer 0, epoch 0, validation free energy -592.06188678
Pre-training layer 0, epoch 1, cost -136.290633545
Pre-training layer 0, epoch 2, cost -124.814752884
Pre-training layer 0, epoch 3, cost -117.901856766
Pre-training layer 0, epoch 4, cost -113.693741302
Pre-training layer 0, epoch 5, cost -109.625978699
Pre-training layer 0, epoch 5, representative training free energy -548.115687408
Pre-training layer 0, epoch 5, validation free energy -537.808492615
Pre-training layer 0, epoch 6, cost -107.088283691
Pre-training layer 0, epoch 7, cost -104.794793777
Pre-training layer 0, epoch 8, cost -102.665838089
Pre-training layer 0, epoch 9, cost -100.75204422
Pre-training layer 0, epoch 10, cost -99.3889173889
Pre-training layer 0, epoch 10, representative training free energy -530.543948395
Pre-training layer 0, epoch 10, validation free energy -519.20708136
Pre-training layer 0, epoch 11, cost -97.8908853912
Pre-training layer 0, epoch 12, cost -96.7924315643
Pre-training layer 0, epoch 13, cost -95.6705673981
Pre-training layer 0, epoch 14, cost -94.3788790894
Pre-training layer 0, epoch 15, cost -93.6412150574
Pre-training layer 0, epoch 15, representative training free energy -521.876488007
Pre-training layer 0, epoch 15, validation free energy -509.605499329
Pre-training layer 0, epoch 16, cost -92.5110216522
Pre-training layer 0, epoch 17, cost -92.0535511017
Pre-training layer 0, epoch 18, cost -91.2431542206
Pre-training layer 0, epoch 19, cost -90.7463758087
Pre-training layer 0, epoch 20, cost -89.7633046722
Pre-training layer 0, epoch 20, representative training free energy -508.921088348
Pre-training layer 0, epoch 20, validation free energy -495.688901733
Pre-training layer 0, epoch 21, cost -89.2731050873
Pre-training layer 0, epoch 22, cost -88.9796207428
Pre-training layer 0, epoch 23, cost -88.0779388428
Pre-training layer 0, epoch 24, cost -87.7975933838
Pre-training layer 0, epoch 25, cost -87.4019711304
Pre-training layer 0, epoch 25, representative training free energy -501.544253998
Pre-training layer 0, epoch 25, validation free energy -487.038683044
Pre-training layer 0, epoch 26, cost -86.8634293365
Pre-training layer 0, epoch 27, cost -86.3116783142
Pre-training layer 0, epoch 28, cost -85.8551394653
Pre-training layer 0, epoch 29, cost -85.4212569427
Pre-training layer 0, epoch 30, cost -85.1941582489
Pre-training layer 0, epoch 30, representative training free energy -497.17295929
Pre-training layer 0, epoch 30, validation free energy -482.917996185
Pre-training layer 0, epoch 31, cost -84.7011391449
Pre-training layer 0, epoch 32, cost -84.5278009796
Pre-training layer 0, epoch 33, cost -84.4082996368
Pre-training layer 0, epoch 34, cost -83.8887854004
Pre-training layer 0, epoch 35, cost -83.7940759277
Pre-training layer 0, epoch 35, representative training free energy -492.674843719
Pre-training layer 0, epoch 35, validation free energy -477.537733246
Pre-training layer 0, epoch 36, cost -83.6064750671
Pre-training layer 0, epoch 37, cost -83.0705044556
Pre-training layer 0, epoch 38, cost -82.7585050964
Pre-training layer 0, epoch 39, cost -82.609193573
Pre-training layer 0, epoch 40, cost -82.1857791901
Pre-training layer 0, epoch 40, representative training free energy -484.427852478
Pre-training layer 0, epoch 40, validation free energy -469.840409424
Pre-training layer 0, epoch 41, cost -81.9871148682
Pre-training layer 0, epoch 42, cost -81.7129105377
Pre-training layer 0, epoch 43, cost -81.5479818344
Pre-training layer 0, epoch 44, cost -81.2362591553
Pre-training layer 0, epoch 45, cost -81.1626926422
Pre-training layer 0, epoch 45, representative training free energy -481.130264587
Pre-training layer 0, epoch 45, validation free energy -466.483439789
Pre-training layer 0, epoch 46, cost -80.7476563263
Pre-training layer 0, epoch 47, cost -80.574217453
Pre-training layer 0, epoch 48, cost -80.0305566406
Pre-training layer 0, epoch 49, cost -80.1574415588
Pre-training layer 0, epoch 50, cost -80.0762169266
Pre-training layer 0, epoch 50, representative training free energy -481.680300659
Pre-training layer 0, epoch 50, validation free energy -465.034047058
Pre-training layer 0, epoch 51, cost -79.829957962
Pre-training layer 0, epoch 52, cost -79.76001297
Pre-training layer 0, epoch 53, cost -79.5399036026
Pre-training layer 0, epoch 54, cost -79.4195166779
Pre-training layer 0, epoch 55, cost -79.172522583
Pre-training layer 0, epoch 55, representative training free energy -475.528251434
Pre-training layer 0, epoch 55, validation free energy -458.865749359
Pre-training layer 0, epoch 56, cost -79.0163510132
Pre-training layer 0, epoch 57, cost -78.8714868927
Pre-training layer 0, epoch 58, cost -78.5441156387
Pre-training layer 0, epoch 59, cost -78.6014397812
Pre-training layer 0, epoch 60, cost -78.3775501251
Pre-training layer 0, epoch 60, representative training free energy -478.273247681
Pre-training layer 0, epoch 60, validation free energy -461.485767822
Pre-training layer 0, epoch 61, cost -78.3392489243
Pre-training layer 0, epoch 62, cost -78.270373497
Pre-training layer 0, epoch 63, cost -77.6608804321
Pre-training layer 0, epoch 64, cost -77.7059162521
Pre-training layer 0, epoch 65, cost -77.819948349
Pre-training layer 0, epoch 65, representative training free energy -473.875071075
Pre-training layer 0, epoch 65, validation free energy -456.742613892
Pre-training layer 0, epoch 66, cost -77.4194416046
Pre-training layer 0, epoch 67, cost -77.3322271729
Pre-training layer 0, epoch 68, cost -77.2274556351
Pre-training layer 0, epoch 69, cost -77.1511649323
Pre-training layer 0, epoch 70, cost -76.9846675873
Pre-training layer 0, epoch 70, representative training free energy -470.718153687
Pre-training layer 0, epoch 70, validation free energy -453.6622901
Pre-training layer 0, epoch 71, cost -77.0982396698
Pre-training layer 0, epoch 72, cost -76.6356526566
Pre-training layer 0, epoch 73, cost -76.6842707062
Pre-training layer 0, epoch 74, cost -76.4916067505
Pre-training layer 0, epoch 75, cost -76.1899244308
Pre-training layer 0, epoch 75, representative training free energy -471.898508423
Pre-training layer 0, epoch 75, validation free energy -453.408178833
Pre-training layer 0, epoch 76, cost -76.290652771
Pre-training layer 0, epoch 77, cost -76.0431134415
Pre-training layer 0, epoch 78, cost -76.1907970428
Pre-training layer 0, epoch 79, cost -76.0163715744
Pre-training layer 0, epoch 80, cost -75.9286898041
Pre-training layer 0, epoch 80, representative training free energy -468.40874472
Pre-training layer 0, epoch 80, validation free energy -450.215292267
Pre-training layer 0, epoch 81, cost -75.8155861664
Pre-training layer 0, epoch 82, cost -75.7037435532
Pre-training layer 0, epoch 83, cost -75.5544610977
Pre-training layer 0, epoch 84, cost -75.3306721497
Pre-training layer 0, epoch 85, cost -75.0757286835
Pre-training layer 0, epoch 85, representative training free energy -468.376056396
Pre-training layer 0, epoch 85, validation free energy -449.809219971
Pre-training layer 0, epoch 86, cost -75.3609388733
Pre-training layer 0, epoch 87, cost -75.2225058746
Pre-training layer 0, epoch 88, cost -75.1086768341
Pre-training layer 0, epoch 89, cost -75.0048077774
Pre-training layer 0, epoch 90, cost -74.9585581589
Pre-training layer 0, epoch 90, representative training free energy -469.548192047
Pre-training layer 0, epoch 90, validation free energy -450.508193146
Pre-training layer 0, epoch 91, cost -74.7565271759
Pre-training layer 0, epoch 92, cost -74.6363339233
Pre-training layer 0, epoch 93, cost -74.7346092987
Pre-training layer 0, epoch 94, cost -74.731699028
Pre-training layer 0, epoch 95, cost -74.4274991989
Pre-training layer 0, epoch 95, representative training free energy -465.845923431
Pre-training layer 0, epoch 95, validation free energy -446.745909973
Pre-training layer 0, epoch 96, cost -74.2420277023
Pre-training layer 0, epoch 97, cost -74.2682627487
Pre-training layer 0, epoch 98, cost -74.3467683411
Pre-training layer 0, epoch 99, cost -74.1165527725
Pre-training layer 1, epoch 0, cost -431.544432373
Pre-training layer 1, epoch 0, representative training free energy -33197.0900244
Pre-training layer 1, epoch 0, validation free energy -32616.3785
Pre-training layer 1, epoch 1, cost -370.688396301
Pre-training layer 1, epoch 2, cost -350.901558838
Pre-training layer 1, epoch 3, cost -339.362107239
Pre-training layer 1, epoch 4, cost -331.15215332
Pre-training layer 1, epoch 5, cost -324.9914505
Pre-training layer 1, epoch 5, representative training free energy -47466.5629756
Pre-training layer 1, epoch 5, validation free energy -46750.1852979
Pre-training layer 1, epoch 6, cost -319.972242432
Pre-training layer 1, epoch 7, cost -315.799458313
Pre-training layer 1, epoch 8, cost -312.23765564
Pre-training layer 1, epoch 9, cost -309.017938843
Pre-training layer 1, epoch 10, cost -306.443066406
Pre-training layer 1, epoch 10, representative training free energy -51958.9532842
Pre-training layer 1, epoch 10, validation free energy -51214.7708623
Pre-training layer 1, epoch 11, cost -304.158934326
Pre-training layer 1, epoch 12, cost -302.093358459
Pre-training layer 1, epoch 13, cost -300.332376099
Pre-training layer 1, epoch 14, cost -298.689785004
Pre-training layer 1, epoch 15, cost -296.79450531
Pre-training layer 1, epoch 15, representative training free energy -54620.0137178
Pre-training layer 1, epoch 15, validation free energy -53853.8848437
Pre-training layer 1, epoch 16, cost -295.457786255
Pre-training layer 1, epoch 17, cost -294.232201996
Pre-training layer 1, epoch 18, cost -293.072649384
Pre-training layer 1, epoch 19, cost -292.158220062
Pre-training layer 1, epoch 20, cost -291.021702423
Pre-training layer 1, epoch 20, representative training free energy -56464.1634854
Pre-training layer 1, epoch 20, validation free energy -55689.1385322
Pre-training layer 1, epoch 21, cost -290.035276184
Pre-training layer 1, epoch 22, cost -288.921452484
Pre-training layer 1, epoch 23, cost -288.303187561
Pre-training layer 1, epoch 24, cost -287.550427399
Pre-training layer 1, epoch 25, cost -286.790351257
Pre-training layer 1, epoch 25, representative training free energy -57690.3428105
Pre-training layer 1, epoch 25, validation free energy -56913.3634238
Pre-training layer 1, epoch 26, cost -286.018164215
Pre-training layer 1, epoch 27, cost -285.412358856
Pre-training layer 1, epoch 28, cost -284.603132172
Pre-training layer 1, epoch 29, cost -284.187321625
Pre-training layer 1, epoch 30, cost -283.611375732
Pre-training layer 1, epoch 30, representative training free energy -58804.3774258
Pre-training layer 1, epoch 30, validation free energy -58027.1533379
Pre-training layer 1, epoch 31, cost -283.141360779
Pre-training layer 1, epoch 32, cost -282.26490097
Pre-training layer 1, epoch 33, cost -281.977202301
Pre-training layer 1, epoch 34, cost -281.673519745
Pre-training layer 1, epoch 35, cost -281.168546295
Pre-training layer 1, epoch 35, representative training free energy -59692.7208604
Pre-training layer 1, epoch 35, validation free energy -58906.3581426
Pre-training layer 1, epoch 36, cost -280.720813293
Pre-training layer 1, epoch 37, cost -280.083345795
Pre-training layer 1, epoch 38, cost -279.807082062
Pre-training layer 1, epoch 39, cost -279.466888428
Pre-training layer 1, epoch 40, cost -279.119725494
Pre-training layer 1, epoch 40, representative training free energy -60456.8878691
Pre-training layer 1, epoch 40, validation free energy -59660.5497539
Pre-training layer 1, epoch 41, cost -278.523997803
Pre-training layer 1, epoch 42, cost -278.367470856
Pre-training layer 1, epoch 43, cost -277.965070801
Pre-training layer 1, epoch 44, cost -277.818016357
Pre-training layer 1, epoch 45, cost -277.246448975
Pre-training layer 1, epoch 45, representative training free energy -61083.6687402
Pre-training layer 1, epoch 45, validation free energy -60289.3455937
Pre-training layer 1, epoch 46, cost -277.072808685
Pre-training layer 1, epoch 47, cost -276.682314148
Pre-training layer 1, epoch 48, cost -276.47723526
Pre-training layer 1, epoch 49, cost -276.132288361
Pre-training layer 1, epoch 50, cost -275.826495056
Pre-training layer 1, epoch 50, representative training free energy -61736.4686367
Pre-training layer 1, epoch 50, validation free energy -60938.1642656
Pre-training layer 1, epoch 51, cost -275.653889618
Pre-training layer 1, epoch 52, cost -275.514342041
Pre-training layer 1, epoch 53, cost -275.325020447
Pre-training layer 1, epoch 54, cost -275.063996277
Pre-training layer 1, epoch 55, cost -274.501135712
Pre-training layer 1, epoch 55, representative training free energy -62267.8994727
Pre-training layer 1, epoch 55, validation free energy -61468.529168
Pre-training layer 1, epoch 56, cost -274.341296692
Pre-training layer 1, epoch 57, cost -274.031768188
Pre-training layer 1, epoch 58, cost -273.980011139
Pre-training layer 1, epoch 59, cost -273.807423706
Pre-training layer 1, epoch 60, cost -273.572856903
Pre-training layer 1, epoch 60, representative training free energy -62721.0917793
Pre-training layer 1, epoch 60, validation free energy -61917.0462988
Pre-training layer 1, epoch 61, cost -273.456365204
Pre-training layer 1, epoch 62, cost -273.123539124
Pre-training layer 1, epoch 63, cost -273.182182007
Pre-training layer 1, epoch 64, cost -272.827136841
Pre-training layer 1, epoch 65, cost -272.784263458
Pre-training layer 1, epoch 65, representative training free energy -63200.9532812
Pre-training layer 1, epoch 65, validation free energy -62398.264957
Pre-training layer 1, epoch 66, cost -272.573576813
Pre-training layer 1, epoch 67, cost -272.345171509
Pre-training layer 1, epoch 68, cost -272.221404114
Pre-training layer 1, epoch 69, cost -272.159550018
Pre-training layer 1, epoch 70, cost -271.944663849
Pre-training layer 1, epoch 70, representative training free energy -63710.2821113
Pre-training layer 1, epoch 70, validation free energy -62902.8809688
Pre-training layer 1, epoch 71, cost -271.812266388
Pre-training layer 1, epoch 72, cost -271.701056976
Pre-training layer 1, epoch 73, cost -271.596769409
Pre-training layer 1, epoch 74, cost -271.479693756
Pre-training layer 1, epoch 75, cost -271.114720764
Pre-training layer 1, epoch 75, representative training free energy -64083.1417441
Pre-training layer 1, epoch 75, validation free energy -63273.1931445
Pre-training layer 1, epoch 76, cost -271.223055573
Pre-training layer 1, epoch 77, cost -271.028405151
Pre-training layer 1, epoch 78, cost -270.837198334
Pre-training layer 1, epoch 79, cost -270.818579102
Pre-training layer 1, epoch 80, cost -270.685046082
Pre-training layer 1, epoch 80, representative training free energy -64448.5816816
Pre-training layer 1, epoch 80, validation free energy -63628.9789023
Pre-training layer 1, epoch 81, cost -270.441110535
Pre-training layer 1, epoch 82, cost -270.52496994
Pre-training layer 1, epoch 83, cost -270.295447998
Pre-training layer 1, epoch 84, cost -270.014300079
Pre-training layer 1, epoch 85, cost -270.046393127
Pre-training layer 1, epoch 85, representative training free energy -64891.3260098
Pre-training layer 1, epoch 85, validation free energy -64079.0505449
Pre-training layer 1, epoch 86, cost -269.957418213
Pre-training layer 1, epoch 87, cost -269.999309082
Pre-training layer 1, epoch 88, cost -269.738048706
Pre-training layer 1, epoch 89, cost -269.698105164
Pre-training layer 1, epoch 90, cost -269.463994751
Pre-training layer 1, epoch 90, representative training free energy -65208.819707
Pre-training layer 1, epoch 90, validation free energy -64385.7606172
Pre-training layer 1, epoch 91, cost -269.348303833
Pre-training layer 1, epoch 92, cost -269.233012238
Pre-training layer 1, epoch 93, cost -269.177623596
Pre-training layer 1, epoch 94, cost -269.122502136
Pre-training layer 1, epoch 95, cost -268.999290009
Pre-training layer 1, epoch 95, representative training free energy -65508.841502
Pre-training layer 1, epoch 95, validation free energy -64692.3702793
Pre-training layer 1, epoch 96, cost -269.04966156
Pre-training layer 1, epoch 97, cost -268.778635559
Pre-training layer 1, epoch 98, cost -268.788226929
Pre-training layer 1, epoch 99, cost -268.508602905
Pre-training layer 2, epoch 0, cost -162.114559479
Pre-training layer 2, epoch 0, representative training free energy 1783.82911972
Pre-training layer 2, epoch 0, validation free energy 1792.98948431
Pre-training layer 2, epoch 1, cost -107.977653275
Pre-training layer 2, epoch 2, cost -98.0691621399
Pre-training layer 2, epoch 3, cost -92.6182021332
Pre-training layer 2, epoch 4, cost -88.7306874847
Pre-training layer 2, epoch 5, cost -86.0263220978
Pre-training layer 2, epoch 5, representative training free energy 2635.09565295
Pre-training layer 2, epoch 5, validation free energy 2622.69459723
Pre-training layer 2, epoch 6, cost -83.7257170105
Pre-training layer 2, epoch 7, cost -81.8312978363
Pre-training layer 2, epoch 8, cost -80.4354985046
Pre-training layer 2, epoch 9, cost -79.2038238144
Pre-training layer 2, epoch 10, cost -78.1575177765
Pre-training layer 2, epoch 10, representative training free energy 2984.44815674
Pre-training layer 2, epoch 10, validation free energy 2964.50809979
Pre-training layer 2, epoch 11, cost -77.0096446991
Pre-training layer 2, epoch 12, cost -76.0578668594
Pre-training layer 2, epoch 13, cost -75.6444416046
Pre-training layer 2, epoch 14, cost -74.686354866
Pre-training layer 2, epoch 15, cost -74.2305413437
Pre-training layer 2, epoch 15, representative training free energy 3273.88398004
Pre-training layer 2, epoch 15, validation free energy 3246.73662097
Pre-training layer 2, epoch 16, cost -73.7443969345
Pre-training layer 2, epoch 17, cost -72.9015252304
Pre-training layer 2, epoch 18, cost -72.5366361618
Pre-training layer 2, epoch 19, cost -72.2255682373
Pre-training layer 2, epoch 20, cost -71.6526810837
Pre-training layer 2, epoch 20, representative training free energy 3506.35037036
Pre-training layer 2, epoch 20, validation free energy 3474.30516644
Pre-training layer 2, epoch 21, cost -71.2715649033
Pre-training layer 2, epoch 22, cost -70.8383805466
Pre-training layer 2, epoch 23, cost -70.5900820541
Pre-training layer 2, epoch 24, cost -70.4179328918
Pre-training layer 2, epoch 25, cost -69.9184879303
Pre-training layer 2, epoch 25, representative training free energy 3693.42341272
Pre-training layer 2, epoch 25, validation free energy 3655.48309576
Pre-training layer 2, epoch 26, cost -69.7381980133
Pre-training layer 2, epoch 27, cost -69.5339245987
Pre-training layer 2, epoch 28, cost -69.3341962814
Pre-training layer 2, epoch 29, cost -68.9330591965
Pre-training layer 2, epoch 30, cost -68.7381542587
Pre-training layer 2, epoch 30, representative training free energy 3913.43840454
Pre-training layer 2, epoch 30, validation free energy 3867.00023352
Pre-training layer 2, epoch 31, cost -68.3603212357
Pre-training layer 2, epoch 32, cost -68.278289566
Pre-training layer 2, epoch 33, cost -68.0571335602
Pre-training layer 2, epoch 34, cost -67.8430400467
Pre-training layer 2, epoch 35, cost -67.8202165985
Pre-training layer 2, epoch 35, representative training free energy 4075.35693188
Pre-training layer 2, epoch 35, validation free energy 4025.56985205
Pre-training layer 2, epoch 36, cost -67.4495328903
Pre-training layer 2, epoch 37, cost -67.0276137543
Pre-training layer 2, epoch 38, cost -67.2196229172
Pre-training layer 2, epoch 39, cost -67.0369979858
Pre-training layer 2, epoch 40, cost -67.1589965057
Pre-training layer 2, epoch 40, representative training free energy 4220.73960461
Pre-training layer 2, epoch 40, validation free energy 4167.046255
Pre-training layer 2, epoch 41, cost -66.7727766418
Pre-training layer 2, epoch 42, cost -66.6419643784
Pre-training layer 2, epoch 43, cost -66.3100469208
Pre-training layer 2, epoch 44, cost -66.3227569962
Pre-training layer 2, epoch 45, cost -66.226768837
Pre-training layer 2, epoch 45, representative training free energy 4380.65788696
Pre-training layer 2, epoch 45, validation free energy 4323.28904749
Pre-training layer 2, epoch 46, cost -65.9769324112
Pre-training layer 2, epoch 47, cost -65.7741958237
Pre-training layer 2, epoch 48, cost -66.1613326263
Pre-training layer 2, epoch 49, cost -65.7967224503
Pre-training layer 2, epoch 50, cost -65.7545869446
Pre-training layer 2, epoch 50, representative training free energy 4521.33925574
Pre-training layer 2, epoch 50, validation free energy 4461.625297
Pre-training layer 2, epoch 51, cost -65.7670454788
Pre-training layer 2, epoch 52, cost -65.5545676804
Pre-training layer 2, epoch 53, cost -65.4303817749
Pre-training layer 2, epoch 54, cost -65.2587521744
Pre-training layer 2, epoch 55, cost -65.1713683701
Pre-training layer 2, epoch 55, representative training free energy 4660.29430676
Pre-training layer 2, epoch 55, validation free energy 4595.15960144
Pre-training layer 2, epoch 56, cost -65.103477478
Pre-training layer 2, epoch 57, cost -65.1482518005
Pre-training layer 2, epoch 58, cost -64.7227078247
Pre-training layer 2, epoch 59, cost -64.8961111832
Pre-training layer 2, epoch 60, cost -64.6746282578
Pre-training layer 2, epoch 60, representative training free energy 4785.07402832
Pre-training layer 2, epoch 60, validation free energy 4718.41761353
Pre-training layer 2, epoch 61, cost -64.706855011
Pre-training layer 2, epoch 62, cost -64.5098070526
Pre-training layer 2, epoch 63, cost -64.5141617966
Pre-training layer 2, epoch 64, cost -64.4883621979
Pre-training layer 2, epoch 65, cost -64.3047132874
Pre-training layer 2, epoch 65, representative training free energy 4906.90330396
Pre-training layer 2, epoch 65, validation free energy 4836.55810437
Pre-training layer 2, epoch 66, cost -64.2707303238
Pre-training layer 2, epoch 67, cost -64.3049504852
Pre-training layer 2, epoch 68, cost -64.0327393341
Pre-training layer 2, epoch 69, cost -64.2303947067
Pre-training layer 2, epoch 70, cost -64.3422384644
Pre-training layer 2, epoch 70, representative training free energy 5038.66016992
Pre-training layer 2, epoch 70, validation free energy 4964.15240869
Pre-training layer 2, epoch 71, cost -63.9713407898
Pre-training layer 2, epoch 72, cost -63.8697557068
Pre-training layer 2, epoch 73, cost -63.8112076569
Pre-training layer 2, epoch 74, cost -63.8492867279
Pre-training layer 2, epoch 75, cost -63.8439268112
Pre-training layer 2, epoch 75, representative training free energy 5162.99015393
Pre-training layer 2, epoch 75, validation free energy 5085.50517542
Pre-training layer 2, epoch 76, cost -63.5567597961
Pre-training layer 2, epoch 77, cost -63.7354444504
Pre-training layer 2, epoch 78, cost -63.649222641
Pre-training layer 2, epoch 79, cost -63.4552875519
Pre-training layer 2, epoch 80, cost -63.5543535233
Pre-training layer 2, epoch 80, representative training free energy 5256.57742188
Pre-training layer 2, epoch 80, validation free energy 5178.02410425
Pre-training layer 2, epoch 81, cost -63.649514122
Pre-training layer 2, epoch 82, cost -63.5679122162
Pre-training layer 2, epoch 83, cost -63.3758922195
Pre-training layer 2, epoch 84, cost -63.3162034607
Pre-training layer 2, epoch 85, cost -63.2662419891
Pre-training layer 2, epoch 85, representative training free energy 5365.76247046
Pre-training layer 2, epoch 85, validation free energy 5283.42957129
Pre-training layer 2, epoch 86, cost -63.2747539902
Pre-training layer 2, epoch 87, cost -63.2222494125
Pre-training layer 2, epoch 88, cost -63.0224897003
Pre-training layer 2, epoch 89, cost -63.0931632996
Pre-training layer 2, epoch 90, cost -63.0677069092
Pre-training layer 2, epoch 90, representative training free energy 5463.28045618
Pre-training layer 2, epoch 90, validation free energy 5378.70953699
Pre-training layer 2, epoch 91, cost -62.9994506454
Pre-training layer 2, epoch 92, cost -63.0080237961
Pre-training layer 2, epoch 93, cost -63.0794827271
Pre-training layer 2, epoch 94, cost -62.883146019
Pre-training layer 2, epoch 95, cost -62.8592361069
Pre-training layer 2, epoch 95, representative training free energy 5562.3534519
Pre-training layer 2, epoch 95, validation free energy 5475.79723291
Pre-training layer 2, epoch 96, cost -62.7666666031
Pre-training layer 2, epoch 97, cost -62.8795311356
Pre-training layer 2, epoch 98, cost -62.6561443329
Pre-training layer 2, epoch 99, cost -62.8151358032
The pretraining code for file dbn_loop.pyc ran for 2.80m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 39.900000 %
     epoch 1, minibatch 100/100, test error of best model 30.100000 %
epoch 2, minibatch 100/100, validation error 34.200000 %
     epoch 2, minibatch 100/100, test error of best model 22.100000 %
epoch 3, minibatch 100/100, validation error 31.300000 %
     epoch 3, minibatch 100/100, test error of best model 17.400000 %
epoch 4, minibatch 100/100, validation error 28.800000 %
     epoch 4, minibatch 100/100, test error of best model 15.700000 %
epoch 5, minibatch 100/100, validation error 28.200000 %
     epoch 5, minibatch 100/100, test error of best model 15.200000 %
epoch 6, minibatch 100/100, validation error 27.300000 %
     epoch 6, minibatch 100/100, test error of best model 15.100000 %
epoch 7, minibatch 100/100, validation error 27.100000 %
     epoch 7, minibatch 100/100, test error of best model 14.700000 %
epoch 8, minibatch 100/100, validation error 27.000000 %
     epoch 8, minibatch 100/100, test error of best model 14.300000 %
epoch 9, minibatch 100/100, validation error 26.400000 %
     epoch 9, minibatch 100/100, test error of best model 13.800000 %
epoch 10, minibatch 100/100, validation error 25.700000 %
     epoch 10, minibatch 100/100, test error of best model 13.300000 %
epoch 11, minibatch 100/100, validation error 25.700000 %
     epoch 11, minibatch 100/100, test error of best model 12.600000 %
epoch 12, minibatch 100/100, validation error 25.300000 %
     epoch 12, minibatch 100/100, test error of best model 12.500000 %
epoch 13, minibatch 100/100, validation error 25.300000 %
epoch 14, minibatch 100/100, validation error 25.300000 %
epoch 15, minibatch 100/100, validation error 24.900000 %
     epoch 15, minibatch 100/100, test error of best model 11.600000 %
epoch 16, minibatch 100/100, validation error 24.900000 %
epoch 17, minibatch 100/100, validation error 24.800000 %
     epoch 17, minibatch 100/100, test error of best model 11.900000 %
epoch 18, minibatch 100/100, validation error 24.700000 %
     epoch 18, minibatch 100/100, test error of best model 12.000000 %
epoch 19, minibatch 100/100, validation error 24.600000 %
     epoch 19, minibatch 100/100, test error of best model 12.000000 %
epoch 20, minibatch 100/100, validation error 24.400000 %
     epoch 20, minibatch 100/100, test error of best model 12.300000 %
epoch 21, minibatch 100/100, validation error 24.300000 %
     epoch 21, minibatch 100/100, test error of best model 12.200000 %
epoch 22, minibatch 100/100, validation error 24.100000 %
     epoch 22, minibatch 100/100, test error of best model 12.200000 %
epoch 23, minibatch 100/100, validation error 24.200000 %
epoch 24, minibatch 100/100, validation error 24.100000 %
     epoch 24, minibatch 100/100, test error of best model 12.200000 %
epoch 25, minibatch 100/100, validation error 24.000000 %
     epoch 25, minibatch 100/100, test error of best model 12.200000 %
epoch 26, minibatch 100/100, validation error 23.900000 %
     epoch 26, minibatch 100/100, test error of best model 12.300000 %
epoch 27, minibatch 100/100, validation error 23.800000 %
     epoch 27, minibatch 100/100, test error of best model 12.300000 %
epoch 28, minibatch 100/100, validation error 23.900000 %
epoch 29, minibatch 100/100, validation error 23.800000 %
epoch 30, minibatch 100/100, validation error 23.900000 %
epoch 31, minibatch 100/100, validation error 23.900000 %
epoch 32, minibatch 100/100, validation error 23.900000 %
epoch 33, minibatch 100/100, validation error 23.900000 %
epoch 34, minibatch 100/100, validation error 23.900000 %
epoch 35, minibatch 100/100, validation error 23.800000 %
epoch 36, minibatch 100/100, validation error 23.800000 %
epoch 37, minibatch 100/100, validation error 23.900000 %
epoch 38, minibatch 100/100, validation error 23.900000 %
epoch 39, minibatch 100/100, validation error 23.900000 %
epoch 40, minibatch 100/100, validation error 23.900000 %
epoch 41, minibatch 100/100, validation error 23.900000 %
epoch 42, minibatch 100/100, validation error 23.900000 %
epoch 43, minibatch 100/100, validation error 23.800000 %
Optimization complete with best validation score of 23.800000 %, obtained at iteration 2700, with test performance 12.300000 %
The fine tuning code for file dbn_loop.pyc ran for 0.55m


==========Sample: (2000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -160.946262627
Pre-training layer 0, epoch 0, representative training free energy -581.185774109
Pre-training layer 0, epoch 0, validation free energy -579.902656982
Pre-training layer 0, epoch 1, cost -123.323731194
Pre-training layer 0, epoch 2, cost -113.939047127
Pre-training layer 0, epoch 3, cost -108.315788612
Pre-training layer 0, epoch 4, cost -104.280405502
Pre-training layer 0, epoch 5, cost -101.292334671
Pre-training layer 0, epoch 5, representative training free energy -522.48135498
Pre-training layer 0, epoch 5, validation free energy -514.806899078
Pre-training layer 0, epoch 6, cost -98.8292067719
Pre-training layer 0, epoch 7, cost -97.0056518936
Pre-training layer 0, epoch 8, cost -95.2975141144
Pre-training layer 0, epoch 9, cost -93.8523287964
Pre-training layer 0, epoch 10, cost -92.5926875687
Pre-training layer 0, epoch 10, representative training free energy -506.351998199
Pre-training layer 0, epoch 10, validation free energy -497.694700653
Pre-training layer 0, epoch 11, cost -91.5580620956
Pre-training layer 0, epoch 12, cost -90.6772134781
Pre-training layer 0, epoch 13, cost -89.6543244934
Pre-training layer 0, epoch 14, cost -88.9504162979
Pre-training layer 0, epoch 15, cost -88.2052567673
Pre-training layer 0, epoch 15, representative training free energy -492.913704193
Pre-training layer 0, epoch 15, validation free energy -484.003337372
Pre-training layer 0, epoch 16, cost -87.4484700012
Pre-training layer 0, epoch 17, cost -87.0087886429
Pre-training layer 0, epoch 18, cost -86.3844099808
Pre-training layer 0, epoch 19, cost -85.7715629196
Pre-training layer 0, epoch 20, cost -85.4151989365
Pre-training layer 0, epoch 20, representative training free energy -481.242720184
Pre-training layer 0, epoch 20, validation free energy -471.744458313
Pre-training layer 0, epoch 21, cost -85.0884844208
Pre-training layer 0, epoch 22, cost -84.578154068
Pre-training layer 0, epoch 23, cost -84.1685268784
Pre-training layer 0, epoch 24, cost -83.6348681831
Pre-training layer 0, epoch 25, cost -83.3338911438
Pre-training layer 0, epoch 25, representative training free energy -479.068136322
Pre-training layer 0, epoch 25, validation free energy -469.155560608
Pre-training layer 0, epoch 26, cost -83.0119686508
Pre-training layer 0, epoch 27, cost -82.6431960106
Pre-training layer 0, epoch 28, cost -82.5439958572
Pre-training layer 0, epoch 29, cost -82.016834774
Pre-training layer 0, epoch 30, cost -81.7288900948
Pre-training layer 0, epoch 30, representative training free energy -473.501572113
Pre-training layer 0, epoch 30, validation free energy -463.392451324
Pre-training layer 0, epoch 31, cost -81.6312674332
Pre-training layer 0, epoch 32, cost -81.2399097061
Pre-training layer 0, epoch 33, cost -81.277327137
Pre-training layer 0, epoch 34, cost -80.7691961288
Pre-training layer 0, epoch 35, cost -80.6336331749
Pre-training layer 0, epoch 35, representative training free energy -468.454847504
Pre-training layer 0, epoch 35, validation free energy -456.62599649
Pre-training layer 0, epoch 36, cost -80.3812479401
Pre-training layer 0, epoch 37, cost -80.4673070717
Pre-training layer 0, epoch 38, cost -79.9582217407
Pre-training layer 0, epoch 39, cost -79.7882509613
Pre-training layer 0, epoch 40, cost -79.6922569656
Pre-training layer 0, epoch 40, representative training free energy -467.435864502
Pre-training layer 0, epoch 40, validation free energy -456.334816895
Pre-training layer 0, epoch 41, cost -79.5087952805
Pre-training layer 0, epoch 42, cost -79.2463014603
Pre-training layer 0, epoch 43, cost -78.9245488167
Pre-training layer 0, epoch 44, cost -78.8399817467
Pre-training layer 0, epoch 45, cost -78.7695539856
Pre-training layer 0, epoch 45, representative training free energy -462.788341156
Pre-training layer 0, epoch 45, validation free energy -451.716746918
Pre-training layer 0, epoch 46, cost -78.4114274216
Pre-training layer 0, epoch 47, cost -78.5099956512
Pre-training layer 0, epoch 48, cost -78.1344669151
Pre-training layer 0, epoch 49, cost -78.16835783
Pre-training layer 0, epoch 50, cost -78.032285099
Pre-training layer 0, epoch 50, representative training free energy -459.25236615
Pre-training layer 0, epoch 50, validation free energy -447.458164795
Pre-training layer 0, epoch 51, cost -77.8114592743
Pre-training layer 0, epoch 52, cost -77.6935200882
Pre-training layer 0, epoch 53, cost -77.7349744987
Pre-training layer 0, epoch 54, cost -77.4489229393
Pre-training layer 0, epoch 55, cost -77.1759358025
Pre-training layer 0, epoch 55, representative training free energy -460.932661438
Pre-training layer 0, epoch 55, validation free energy -448.545504395
Pre-training layer 0, epoch 56, cost -77.1784155655
Pre-training layer 0, epoch 57, cost -77.1353674698
Pre-training layer 0, epoch 58, cost -76.8531885719
Pre-training layer 0, epoch 59, cost -76.6943950272
Pre-training layer 0, epoch 60, cost -76.6801658821
Pre-training layer 0, epoch 60, representative training free energy -458.029973755
Pre-training layer 0, epoch 60, validation free energy -445.632922058
Pre-training layer 0, epoch 61, cost -76.5907081032
Pre-training layer 0, epoch 62, cost -76.57014925
Pre-training layer 0, epoch 63, cost -76.4917756081
Pre-training layer 0, epoch 64, cost -76.2227668953
Pre-training layer 0, epoch 65, cost -76.2548750687
Pre-training layer 0, epoch 65, representative training free energy -453.386738495
Pre-training layer 0, epoch 65, validation free energy -440.681600739
Pre-training layer 0, epoch 66, cost -76.1701044846
Pre-training layer 0, epoch 67, cost -76.2274403
Pre-training layer 0, epoch 68, cost -75.9806805801
Pre-training layer 0, epoch 69, cost -75.9764383698
Pre-training layer 0, epoch 70, cost -75.7993955612
Pre-training layer 0, epoch 70, representative training free energy -456.70480545
Pre-training layer 0, epoch 70, validation free energy -443.797710541
Pre-training layer 0, epoch 71, cost -75.6092722702
Pre-training layer 0, epoch 72, cost -75.4044849968
Pre-training layer 0, epoch 73, cost -75.5110900307
Pre-training layer 0, epoch 74, cost -75.5694977951
Pre-training layer 0, epoch 75, cost -75.2884411049
Pre-training layer 0, epoch 75, representative training free energy -454.003758881
Pre-training layer 0, epoch 75, validation free energy -441.76295755
Pre-training layer 0, epoch 76, cost -75.0902844429
Pre-training layer 0, epoch 77, cost -75.1618752098
Pre-training layer 0, epoch 78, cost -74.9498986816
Pre-training layer 0, epoch 79, cost -75.0884182358
Pre-training layer 0, epoch 80, cost -74.8734901619
Pre-training layer 0, epoch 80, representative training free energy -454.192272644
Pre-training layer 0, epoch 80, validation free energy -440.744930359
Pre-training layer 0, epoch 81, cost -74.8754853821
Pre-training layer 0, epoch 82, cost -74.7018933678
Pre-training layer 0, epoch 83, cost -74.6040544319
Pre-training layer 0, epoch 84, cost -74.6923512268
Pre-training layer 0, epoch 85, cost -74.3952626038
Pre-training layer 0, epoch 85, representative training free energy -453.381778717
Pre-training layer 0, epoch 85, validation free energy -440.471638245
Pre-training layer 0, epoch 86, cost -74.4254901695
Pre-training layer 0, epoch 87, cost -74.3604862404
Pre-training layer 0, epoch 88, cost -74.3822878456
Pre-training layer 0, epoch 89, cost -74.2571837234
Pre-training layer 0, epoch 90, cost -74.2975767899
Pre-training layer 0, epoch 90, representative training free energy -450.009897339
Pre-training layer 0, epoch 90, validation free energy -436.023659607
Pre-training layer 0, epoch 91, cost -74.1531752777
Pre-training layer 0, epoch 92, cost -74.1229007721
Pre-training layer 0, epoch 93, cost -74.0995994949
Pre-training layer 0, epoch 94, cost -73.959102211
Pre-training layer 0, epoch 95, cost -73.9378076744
Pre-training layer 0, epoch 95, representative training free energy -455.938430298
Pre-training layer 0, epoch 95, validation free energy -441.782884613
Pre-training layer 0, epoch 96, cost -73.8790528679
Pre-training layer 0, epoch 97, cost -73.7157300949
Pre-training layer 0, epoch 98, cost -73.7915391541
Pre-training layer 0, epoch 99, cost -73.7595497131
Pre-training layer 1, epoch 0, cost -374.47694046
Pre-training layer 1, epoch 0, representative training free energy -42698.3290801
Pre-training layer 1, epoch 0, validation free energy -42443.5887168
Pre-training layer 1, epoch 1, cost -322.250741196
Pre-training layer 1, epoch 2, cost -306.144958496
Pre-training layer 1, epoch 3, cost -296.115030899
Pre-training layer 1, epoch 4, cost -289.005307999
Pre-training layer 1, epoch 5, cost -284.053342972
Pre-training layer 1, epoch 5, representative training free energy -58650.5067246
Pre-training layer 1, epoch 5, validation free energy -58240.1635547
Pre-training layer 1, epoch 6, cost -279.750472412
Pre-training layer 1, epoch 7, cost -276.451140594
Pre-training layer 1, epoch 8, cost -273.778923798
Pre-training layer 1, epoch 9, cost -271.244601212
Pre-training layer 1, epoch 10, cost -269.195141983
Pre-training layer 1, epoch 10, representative training free energy -63489.5779355
Pre-training layer 1, epoch 10, validation free energy -63055.9536055
Pre-training layer 1, epoch 11, cost -267.309152222
Pre-training layer 1, epoch 12, cost -265.65698143
Pre-training layer 1, epoch 13, cost -264.324039917
Pre-training layer 1, epoch 14, cost -262.944141006
Pre-training layer 1, epoch 15, cost -261.806307373
Pre-training layer 1, epoch 15, representative training free energy -66346.0661699
Pre-training layer 1, epoch 15, validation free energy -65904.4684258
Pre-training layer 1, epoch 16, cost -260.620658951
Pre-training layer 1, epoch 17, cost -259.775906601
Pre-training layer 1, epoch 18, cost -258.739560089
Pre-training layer 1, epoch 19, cost -258.184977646
Pre-training layer 1, epoch 20, cost -257.180968475
Pre-training layer 1, epoch 20, representative training free energy -68273.4393594
Pre-training layer 1, epoch 20, validation free energy -67815.4706172
Pre-training layer 1, epoch 21, cost -256.547587051
Pre-training layer 1, epoch 22, cost -255.667638321
Pre-training layer 1, epoch 23, cost -255.168105774
Pre-training layer 1, epoch 24, cost -254.674239044
Pre-training layer 1, epoch 25, cost -254.102102661
Pre-training layer 1, epoch 25, representative training free energy -69910.9941016
Pre-training layer 1, epoch 25, validation free energy -69444.1147734
Pre-training layer 1, epoch 26, cost -253.601540756
Pre-training layer 1, epoch 27, cost -253.001938705
Pre-training layer 1, epoch 28, cost -252.787816238
Pre-training layer 1, epoch 29, cost -252.335583115
Pre-training layer 1, epoch 30, cost -251.826714935
Pre-training layer 1, epoch 30, representative training free energy -71078.5886328
Pre-training layer 1, epoch 30, validation free energy -70592.4027832
Pre-training layer 1, epoch 31, cost -251.418756561
Pre-training layer 1, epoch 32, cost -251.137263718
Pre-training layer 1, epoch 33, cost -250.695365677
Pre-training layer 1, epoch 34, cost -250.537526474
Pre-training layer 1, epoch 35, cost -250.043594208
Pre-training layer 1, epoch 35, representative training free energy -72119.9347754
Pre-training layer 1, epoch 35, validation free energy -71637.1804121
Pre-training layer 1, epoch 36, cost -249.98182457
Pre-training layer 1, epoch 37, cost -249.562032089
Pre-training layer 1, epoch 38, cost -249.354482803
Pre-training layer 1, epoch 39, cost -249.015541229
Pre-training layer 1, epoch 40, cost -248.732105713
Pre-training layer 1, epoch 40, representative training free energy -72989.8553379
Pre-training layer 1, epoch 40, validation free energy -72496.243791
Pre-training layer 1, epoch 41, cost -248.376419907
Pre-training layer 1, epoch 42, cost -248.176041718
Pre-training layer 1, epoch 43, cost -248.015461655
Pre-training layer 1, epoch 44, cost -247.822947922
Pre-training layer 1, epoch 45, cost -247.652132645
Pre-training layer 1, epoch 45, representative training free energy -73748.0745078
Pre-training layer 1, epoch 45, validation free energy -73251.1684648
Pre-training layer 1, epoch 46, cost -247.306493301
Pre-training layer 1, epoch 47, cost -247.194818573
Pre-training layer 1, epoch 48, cost -247.081125031
Pre-training layer 1, epoch 49, cost -246.849405975
Pre-training layer 1, epoch 50, cost -246.719871216
Pre-training layer 1, epoch 50, representative training free energy -74561.0658008
Pre-training layer 1, epoch 50, validation free energy -74059.6492578
Pre-training layer 1, epoch 51, cost -246.590756454
Pre-training layer 1, epoch 52, cost -246.387451096
Pre-training layer 1, epoch 53, cost -246.051471558
Pre-training layer 1, epoch 54, cost -245.973993301
Pre-training layer 1, epoch 55, cost -245.833567123
Pre-training layer 1, epoch 55, representative training free energy -75097.6437617
Pre-training layer 1, epoch 55, validation free energy -74578.504168
Pre-training layer 1, epoch 56, cost -245.672377853
Pre-training layer 1, epoch 57, cost -245.587034988
Pre-training layer 1, epoch 58, cost -245.440914001
Pre-training layer 1, epoch 59, cost -245.288080978
Pre-training layer 1, epoch 60, cost -245.217591705
Pre-training layer 1, epoch 60, representative training free energy -75679.7055781
Pre-training layer 1, epoch 60, validation free energy -75171.0575586
Pre-training layer 1, epoch 61, cost -244.90291008
Pre-training layer 1, epoch 62, cost -244.844210892
Pre-training layer 1, epoch 63, cost -244.697348633
Pre-training layer 1, epoch 64, cost -244.548442001
Pre-training layer 1, epoch 65, cost -244.477207336
Pre-training layer 1, epoch 65, representative training free energy -76180.6403008
Pre-training layer 1, epoch 65, validation free energy -75656.1248613
Pre-training layer 1, epoch 66, cost -244.223956223
Pre-training layer 1, epoch 67, cost -244.393095856
Pre-training layer 1, epoch 68, cost -244.284326019
Pre-training layer 1, epoch 69, cost -243.974486923
Pre-training layer 1, epoch 70, cost -243.818927307
Pre-training layer 1, epoch 70, representative training free energy -76757.2641543
Pre-training layer 1, epoch 70, validation free energy -76247.341543
Pre-training layer 1, epoch 71, cost -243.767649002
Pre-training layer 1, epoch 72, cost -243.631795349
Pre-training layer 1, epoch 73, cost -243.689129715
Pre-training layer 1, epoch 74, cost -243.637748947
Pre-training layer 1, epoch 75, cost -243.470874634
Pre-training layer 1, epoch 75, representative training free energy -77061.7596211
Pre-training layer 1, epoch 75, validation free energy -76548.107793
Pre-training layer 1, epoch 76, cost -243.263029556
Pre-training layer 1, epoch 77, cost -243.226246262
Pre-training layer 1, epoch 78, cost -243.170979385
Pre-training layer 1, epoch 79, cost -243.036129074
Pre-training layer 1, epoch 80, cost -243.012033539
Pre-training layer 1, epoch 80, representative training free energy -77531.760291
Pre-training layer 1, epoch 80, validation free energy -77007.6037695
Pre-training layer 1, epoch 81, cost -242.849931335
Pre-training layer 1, epoch 82, cost -242.887302551
Pre-training layer 1, epoch 83, cost -242.755701904
Pre-training layer 1, epoch 84, cost -242.634114532
Pre-training layer 1, epoch 85, cost -242.712130356
Pre-training layer 1, epoch 85, representative training free energy -77861.9273477
Pre-training layer 1, epoch 85, validation free energy -77338.8470332
Pre-training layer 1, epoch 86, cost -242.547856369
Pre-training layer 1, epoch 87, cost -242.515071793
Pre-training layer 1, epoch 88, cost -242.422166672
Pre-training layer 1, epoch 89, cost -242.342896271
Pre-training layer 1, epoch 90, cost -242.316790237
Pre-training layer 1, epoch 90, representative training free energy -78331.9314473
Pre-training layer 1, epoch 90, validation free energy -77799.8986406
Pre-training layer 1, epoch 91, cost -242.077216644
Pre-training layer 1, epoch 92, cost -242.233147354
Pre-training layer 1, epoch 93, cost -241.95936142
Pre-training layer 1, epoch 94, cost -241.940769882
Pre-training layer 1, epoch 95, cost -241.840475693
Pre-training layer 1, epoch 95, representative training free energy -78639.3501855
Pre-training layer 1, epoch 95, validation free energy -78108.4189492
Pre-training layer 1, epoch 96, cost -241.78578743
Pre-training layer 1, epoch 97, cost -241.844678955
Pre-training layer 1, epoch 98, cost -241.630588913
Pre-training layer 1, epoch 99, cost -241.608278046
Pre-training layer 2, epoch 0, cost -137.3259729
Pre-training layer 2, epoch 0, representative training free energy 2501.09484485
Pre-training layer 2, epoch 0, validation free energy 2503.69584955
Pre-training layer 2, epoch 1, cost -98.1726998901
Pre-training layer 2, epoch 2, cost -90.3208117676
Pre-training layer 2, epoch 3, cost -85.7122751808
Pre-training layer 2, epoch 4, cost -82.8521356964
Pre-training layer 2, epoch 5, cost -80.4746190071
Pre-training layer 2, epoch 5, representative training free energy 3755.85824927
Pre-training layer 2, epoch 5, validation free energy 3757.17353418
Pre-training layer 2, epoch 6, cost -78.5216248703
Pre-training layer 2, epoch 7, cost -77.2929043961
Pre-training layer 2, epoch 8, cost -75.9866774368
Pre-training layer 2, epoch 9, cost -74.926906147
Pre-training layer 2, epoch 10, cost -73.9434350204
Pre-training layer 2, epoch 10, representative training free energy 4473.67127441
Pre-training layer 2, epoch 10, validation free energy 4457.02059131
Pre-training layer 2, epoch 11, cost -73.1470036316
Pre-training layer 2, epoch 12, cost -72.4950674629
Pre-training layer 2, epoch 13, cost -72.040417099
Pre-training layer 2, epoch 14, cost -71.4053384781
Pre-training layer 2, epoch 15, cost -70.8967145538
Pre-training layer 2, epoch 15, representative training free energy 5034.03674255
Pre-training layer 2, epoch 15, validation free energy 5004.97833533
Pre-training layer 2, epoch 16, cost -70.3132531738
Pre-training layer 2, epoch 17, cost -69.9521667099
Pre-training layer 2, epoch 18, cost -69.6287496948
Pre-training layer 2, epoch 19, cost -69.3506026268
Pre-training layer 2, epoch 20, cost -68.9310177994
Pre-training layer 2, epoch 20, representative training free energy 5467.41087195
Pre-training layer 2, epoch 20, validation free energy 5432.33315637
Pre-training layer 2, epoch 21, cost -68.6692799759
Pre-training layer 2, epoch 22, cost -68.2542378616
Pre-training layer 2, epoch 23, cost -68.1918052864
Pre-training layer 2, epoch 24, cost -67.8209679604
Pre-training layer 2, epoch 25, cost -67.6317830658
Pre-training layer 2, epoch 25, representative training free energy 5813.95946008
Pre-training layer 2, epoch 25, validation free energy 5772.26062329
Pre-training layer 2, epoch 26, cost -67.4133877945
Pre-training layer 2, epoch 27, cost -67.2696767807
Pre-training layer 2, epoch 28, cost -67.0376902008
Pre-training layer 2, epoch 29, cost -66.7787863159
Pre-training layer 2, epoch 30, cost -66.5811800194
Pre-training layer 2, epoch 30, representative training free energy 6132.19824841
Pre-training layer 2, epoch 30, validation free energy 6087.48744446
Pre-training layer 2, epoch 31, cost -66.4944394684
Pre-training layer 2, epoch 32, cost -66.2517878151
Pre-training layer 2, epoch 33, cost -66.1695914841
Pre-training layer 2, epoch 34, cost -66.1139472771
Pre-training layer 2, epoch 35, cost -65.9592800903
Pre-training layer 2, epoch 35, representative training free energy 6400.27255835
Pre-training layer 2, epoch 35, validation free energy 6352.19911353
Pre-training layer 2, epoch 36, cost -65.7145516396
Pre-training layer 2, epoch 37, cost -65.7280370331
Pre-training layer 2, epoch 38, cost -65.6422237396
Pre-training layer 2, epoch 39, cost -65.3958501434
Pre-training layer 2, epoch 40, cost -65.396693058
Pre-training layer 2, epoch 40, representative training free energy 6673.09919104
Pre-training layer 2, epoch 40, validation free energy 6620.80039319
Pre-training layer 2, epoch 41, cost -65.1938246155
Pre-training layer 2, epoch 42, cost -65.1818536186
Pre-training layer 2, epoch 43, cost -65.1656127357
Pre-training layer 2, epoch 44, cost -64.9516019821
Pre-training layer 2, epoch 45, cost -64.880741024
Pre-training layer 2, epoch 45, representative training free energy 6914.47219165
Pre-training layer 2, epoch 45, validation free energy 6860.68224927
Pre-training layer 2, epoch 46, cost -64.7855297661
Pre-training layer 2, epoch 47, cost -64.765104351
Pre-training layer 2, epoch 48, cost -64.6715512657
Pre-training layer 2, epoch 49, cost -64.6199017715
Pre-training layer 2, epoch 50, cost -64.5448516655
Pre-training layer 2, epoch 50, representative training free energy 7138.52344336
Pre-training layer 2, epoch 50, validation free energy 7081.71635962
Pre-training layer 2, epoch 51, cost -64.3173331833
Pre-training layer 2, epoch 52, cost -64.3308942032
Pre-training layer 2, epoch 53, cost -64.2845197487
Pre-training layer 2, epoch 54, cost -64.1741156578
Pre-training layer 2, epoch 55, cost -64.1006157303
Pre-training layer 2, epoch 55, representative training free energy 7327.96881055
Pre-training layer 2, epoch 55, validation free energy 7268.43585742
Pre-training layer 2, epoch 56, cost -64.093440609
Pre-training layer 2, epoch 57, cost -64.0510146523
Pre-training layer 2, epoch 58, cost -63.9781838417
Pre-training layer 2, epoch 59, cost -64.011457386
Pre-training layer 2, epoch 60, cost -63.800064373
Pre-training layer 2, epoch 60, representative training free energy 7524.81733423
Pre-training layer 2, epoch 60, validation free energy 7464.69220044
Pre-training layer 2, epoch 61, cost -63.8565287781
Pre-training layer 2, epoch 62, cost -63.6578617477
Pre-training layer 2, epoch 63, cost -63.6941502953
Pre-training layer 2, epoch 64, cost -63.6325675392
Pre-training layer 2, epoch 65, cost -63.6632477951
Pre-training layer 2, epoch 65, representative training free energy 7685.87762012
Pre-training layer 2, epoch 65, validation free energy 7623.03950488
Pre-training layer 2, epoch 66, cost -63.4996299553
Pre-training layer 2, epoch 67, cost -63.4977362061
Pre-training layer 2, epoch 68, cost -63.5339956856
Pre-training layer 2, epoch 69, cost -63.3370398903
Pre-training layer 2, epoch 70, cost -63.4056728935
Pre-training layer 2, epoch 70, representative training free energy 7843.92212305
Pre-training layer 2, epoch 70, validation free energy 7778.79766162
Pre-training layer 2, epoch 71, cost -63.2953746223
Pre-training layer 2, epoch 72, cost -63.1593265343
Pre-training layer 2, epoch 73, cost -63.1924488068
Pre-training layer 2, epoch 74, cost -63.1431732941
Pre-training layer 2, epoch 75, cost -63.1362674522
Pre-training layer 2, epoch 75, representative training free energy 8030.06737573
Pre-training layer 2, epoch 75, validation free energy 7963.14895703
Pre-training layer 2, epoch 76, cost -63.1295126534
Pre-training layer 2, epoch 77, cost -63.07747612
Pre-training layer 2, epoch 78, cost -63.0642336273
Pre-training layer 2, epoch 79, cost -62.9855372429
Pre-training layer 2, epoch 80, cost -62.9566913223
Pre-training layer 2, epoch 80, representative training free energy 8186.21525488
Pre-training layer 2, epoch 80, validation free energy 8118.02368774
Pre-training layer 2, epoch 81, cost -62.9462967682
Pre-training layer 2, epoch 82, cost -62.9793990517
Pre-training layer 2, epoch 83, cost -62.9135002518
Pre-training layer 2, epoch 84, cost -62.7572905731
Pre-training layer 2, epoch 85, cost -62.7867115402
Pre-training layer 2, epoch 85, representative training free energy 8359.28255518
Pre-training layer 2, epoch 85, validation free energy 8288.7477356
Pre-training layer 2, epoch 86, cost -62.6966221237
Pre-training layer 2, epoch 87, cost -62.7233272362
Pre-training layer 2, epoch 88, cost -62.7123724937
Pre-training layer 2, epoch 89, cost -62.7494325638
Pre-training layer 2, epoch 90, cost -62.6076450157
Pre-training layer 2, epoch 90, representative training free energy 8492.89276196
Pre-training layer 2, epoch 90, validation free energy 8422.25523633
Pre-training layer 2, epoch 91, cost -62.6095433235
Pre-training layer 2, epoch 92, cost -62.6247820854
Pre-training layer 2, epoch 93, cost -62.5427122688
Pre-training layer 2, epoch 94, cost -62.6123461342
Pre-training layer 2, epoch 95, cost -62.3631630135
Pre-training layer 2, epoch 95, representative training free energy 8609.21719312
Pre-training layer 2, epoch 95, validation free energy 8537.59647046
Pre-training layer 2, epoch 96, cost -62.5801844597
Pre-training layer 2, epoch 97, cost -62.5528694153
Pre-training layer 2, epoch 98, cost -62.5035654068
Pre-training layer 2, epoch 99, cost -62.4554610634
The pretraining code for file dbn_loop.pyc ran for 5.42m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 36.000000 %
     epoch 1, minibatch 200/200, test error of best model 30.100000 %
epoch 2, minibatch 200/200, validation error 25.900000 %
     epoch 2, minibatch 200/200, test error of best model 18.900000 %
epoch 3, minibatch 200/200, validation error 22.800000 %
     epoch 3, minibatch 200/200, test error of best model 15.100000 %
epoch 4, minibatch 200/200, validation error 22.000000 %
     epoch 4, minibatch 200/200, test error of best model 13.200000 %
epoch 5, minibatch 200/200, validation error 20.700000 %
     epoch 5, minibatch 200/200, test error of best model 12.000000 %
epoch 6, minibatch 200/200, validation error 19.900000 %
     epoch 6, minibatch 200/200, test error of best model 11.000000 %
epoch 7, minibatch 200/200, validation error 19.400000 %
     epoch 7, minibatch 200/200, test error of best model 10.100000 %
epoch 8, minibatch 200/200, validation error 18.600000 %
     epoch 8, minibatch 200/200, test error of best model 9.500000 %
epoch 9, minibatch 200/200, validation error 18.400000 %
     epoch 9, minibatch 200/200, test error of best model 9.300000 %
epoch 10, minibatch 200/200, validation error 18.600000 %
epoch 11, minibatch 200/200, validation error 18.300000 %
     epoch 11, minibatch 200/200, test error of best model 8.500000 %
epoch 12, minibatch 200/200, validation error 18.000000 %
     epoch 12, minibatch 200/200, test error of best model 8.300000 %
epoch 13, minibatch 200/200, validation error 17.700000 %
     epoch 13, minibatch 200/200, test error of best model 8.400000 %
epoch 14, minibatch 200/200, validation error 17.700000 %
epoch 15, minibatch 200/200, validation error 17.500000 %
     epoch 15, minibatch 200/200, test error of best model 7.800000 %
epoch 16, minibatch 200/200, validation error 17.400000 %
     epoch 16, minibatch 200/200, test error of best model 8.000000 %
epoch 17, minibatch 200/200, validation error 17.500000 %
epoch 18, minibatch 200/200, validation error 17.400000 %
epoch 19, minibatch 200/200, validation error 17.400000 %
epoch 20, minibatch 200/200, validation error 17.100000 %
     epoch 20, minibatch 200/200, test error of best model 7.800000 %
epoch 21, minibatch 200/200, validation error 17.000000 %
     epoch 21, minibatch 200/200, test error of best model 7.700000 %
epoch 22, minibatch 200/200, validation error 16.900000 %
     epoch 22, minibatch 200/200, test error of best model 7.800000 %
epoch 23, minibatch 200/200, validation error 16.800000 %
     epoch 23, minibatch 200/200, test error of best model 7.800000 %
epoch 24, minibatch 200/200, validation error 16.700000 %
     epoch 24, minibatch 200/200, test error of best model 7.800000 %
epoch 25, minibatch 200/200, validation error 16.800000 %
epoch 26, minibatch 200/200, validation error 16.900000 %
epoch 27, minibatch 200/200, validation error 16.900000 %
epoch 28, minibatch 200/200, validation error 16.800000 %
epoch 29, minibatch 200/200, validation error 16.800000 %
epoch 30, minibatch 200/200, validation error 16.700000 %
epoch 31, minibatch 200/200, validation error 16.700000 %
epoch 32, minibatch 200/200, validation error 16.700000 %
epoch 33, minibatch 200/200, validation error 16.700000 %
epoch 34, minibatch 200/200, validation error 16.800000 %
epoch 35, minibatch 200/200, validation error 16.800000 %
epoch 36, minibatch 200/200, validation error 16.800000 %
epoch 37, minibatch 200/200, validation error 16.700000 %
epoch 38, minibatch 200/200, validation error 16.700000 %
epoch 39, minibatch 200/200, validation error 16.700000 %
epoch 40, minibatch 200/200, validation error 16.700000 %
epoch 41, minibatch 200/200, validation error 16.500000 %
     epoch 41, minibatch 200/200, test error of best model 7.300000 %
epoch 42, minibatch 200/200, validation error 16.500000 %
epoch 43, minibatch 200/200, validation error 16.500000 %
epoch 44, minibatch 200/200, validation error 16.500000 %
epoch 45, minibatch 200/200, validation error 16.500000 %
epoch 46, minibatch 200/200, validation error 16.500000 %
epoch 47, minibatch 200/200, validation error 16.500000 %
epoch 48, minibatch 200/200, validation error 16.500000 %
epoch 49, minibatch 200/200, validation error 16.500000 %
epoch 50, minibatch 200/200, validation error 16.400000 %
     epoch 50, minibatch 200/200, test error of best model 7.300000 %
epoch 51, minibatch 200/200, validation error 16.400000 %
epoch 52, minibatch 200/200, validation error 16.400000 %
epoch 53, minibatch 200/200, validation error 16.400000 %
epoch 54, minibatch 200/200, validation error 16.400000 %
epoch 55, minibatch 200/200, validation error 16.400000 %
epoch 56, minibatch 200/200, validation error 16.400000 %
epoch 57, minibatch 200/200, validation error 16.400000 %
epoch 58, minibatch 200/200, validation error 16.400000 %
epoch 59, minibatch 200/200, validation error 16.400000 %
epoch 60, minibatch 200/200, validation error 16.400000 %
epoch 61, minibatch 200/200, validation error 16.400000 %
epoch 62, minibatch 200/200, validation error 16.300000 %
     epoch 62, minibatch 200/200, test error of best model 7.200000 %
epoch 63, minibatch 200/200, validation error 16.300000 %
epoch 64, minibatch 200/200, validation error 16.300000 %
epoch 65, minibatch 200/200, validation error 16.300000 %
epoch 66, minibatch 200/200, validation error 16.200000 %
     epoch 66, minibatch 200/200, test error of best model 7.200000 %
epoch 67, minibatch 200/200, validation error 16.200000 %
epoch 68, minibatch 200/200, validation error 16.200000 %
epoch 69, minibatch 200/200, validation error 16.200000 %
epoch 70, minibatch 200/200, validation error 16.200000 %
epoch 71, minibatch 200/200, validation error 16.300000 %
epoch 72, minibatch 200/200, validation error 16.300000 %
epoch 73, minibatch 200/200, validation error 16.300000 %
epoch 74, minibatch 200/200, validation error 16.300000 %
epoch 75, minibatch 200/200, validation error 16.300000 %
epoch 76, minibatch 200/200, validation error 16.300000 %
epoch 77, minibatch 200/200, validation error 16.300000 %
epoch 78, minibatch 200/200, validation error 16.300000 %
epoch 79, minibatch 200/200, validation error 16.300000 %
epoch 80, minibatch 200/200, validation error 16.300000 %
epoch 81, minibatch 200/200, validation error 16.300000 %
epoch 82, minibatch 200/200, validation error 16.300000 %
epoch 83, minibatch 200/200, validation error 16.300000 %
epoch 84, minibatch 200/200, validation error 16.300000 %
epoch 85, minibatch 200/200, validation error 16.300000 %
epoch 86, minibatch 200/200, validation error 16.300000 %
epoch 87, minibatch 200/200, validation error 16.300000 %
epoch 88, minibatch 200/200, validation error 16.300000 %
epoch 89, minibatch 200/200, validation error 16.300000 %
epoch 90, minibatch 200/200, validation error 16.300000 %
epoch 91, minibatch 200/200, validation error 16.300000 %
epoch 92, minibatch 200/200, validation error 16.300000 %
epoch 93, minibatch 200/200, validation error 16.300000 %
epoch 94, minibatch 200/200, validation error 16.300000 %
epoch 95, minibatch 200/200, validation error 16.300000 %
epoch 96, minibatch 200/200, validation error 16.300000 %
epoch 97, minibatch 200/200, validation error 16.300000 %
epoch 98, minibatch 200/200, validation error 16.300000 %
epoch 99, minibatch 200/200, validation error 16.300000 %
epoch 100, minibatch 200/200, validation error 16.300000 %
epoch 101, minibatch 200/200, validation error 16.300000 %
epoch 102, minibatch 200/200, validation error 16.300000 %
epoch 103, minibatch 200/200, validation error 16.300000 %
epoch 104, minibatch 200/200, validation error 16.300000 %
epoch 105, minibatch 200/200, validation error 16.300000 %
epoch 106, minibatch 200/200, validation error 16.300000 %
epoch 107, minibatch 200/200, validation error 16.300000 %
epoch 108, minibatch 200/200, validation error 16.300000 %
epoch 109, minibatch 200/200, validation error 16.300000 %
epoch 110, minibatch 200/200, validation error 16.400000 %
epoch 111, minibatch 200/200, validation error 16.400000 %
epoch 112, minibatch 200/200, validation error 16.400000 %
epoch 113, minibatch 200/200, validation error 16.400000 %
epoch 114, minibatch 200/200, validation error 16.400000 %
epoch 115, minibatch 200/200, validation error 16.400000 %
epoch 116, minibatch 200/200, validation error 16.400000 %
epoch 117, minibatch 200/200, validation error 16.400000 %
epoch 118, minibatch 200/200, validation error 16.400000 %
epoch 119, minibatch 200/200, validation error 16.400000 %
epoch 120, minibatch 200/200, validation error 16.400000 %
epoch 121, minibatch 200/200, validation error 16.400000 %
epoch 122, minibatch 200/200, validation error 16.400000 %
epoch 123, minibatch 200/200, validation error 16.400000 %
epoch 124, minibatch 200/200, validation error 16.400000 %
epoch 125, minibatch 200/200, validation error 16.400000 %
epoch 126, minibatch 200/200, validation error 16.400000 %
epoch 127, minibatch 200/200, validation error 16.400000 %
epoch 128, minibatch 200/200, validation error 16.400000 %
epoch 129, minibatch 200/200, validation error 16.400000 %
epoch 130, minibatch 200/200, validation error 16.400000 %
epoch 131, minibatch 200/200, validation error 16.400000 %
Optimization complete with best validation score of 16.200000 %, obtained at iteration 13200, with test performance 7.200000 %
The fine tuning code for file dbn_loop.pyc ran for 2.51m


==========Sample: (3000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.982862396
Pre-training layer 0, epoch 0, representative training free energy -555.835874023
Pre-training layer 0, epoch 0, validation free energy -552.231248993
Pre-training layer 0, epoch 1, cost -116.641307907
Pre-training layer 0, epoch 2, cost -107.909752274
Pre-training layer 0, epoch 3, cost -102.820385056
Pre-training layer 0, epoch 4, cost -99.240257314
Pre-training layer 0, epoch 5, cost -96.7514155579
Pre-training layer 0, epoch 5, representative training free energy -502.893037659
Pre-training layer 0, epoch 5, validation free energy -496.783467834
Pre-training layer 0, epoch 6, cost -94.5519707235
Pre-training layer 0, epoch 7, cost -92.7442698924
Pre-training layer 0, epoch 8, cost -91.3470317078
Pre-training layer 0, epoch 9, cost -90.1314711253
Pre-training layer 0, epoch 10, cost -89.2657495372
Pre-training layer 0, epoch 10, representative training free energy -480.327783478
Pre-training layer 0, epoch 10, validation free energy -473.156364624
Pre-training layer 0, epoch 11, cost -88.3051870219
Pre-training layer 0, epoch 12, cost -87.4339251455
Pre-training layer 0, epoch 13, cost -86.6782990774
Pre-training layer 0, epoch 14, cost -85.8828737386
Pre-training layer 0, epoch 15, cost -85.467682546
Pre-training layer 0, epoch 15, representative training free energy -465.893695953
Pre-training layer 0, epoch 15, validation free energy -457.520973328
Pre-training layer 0, epoch 16, cost -84.8752069982
Pre-training layer 0, epoch 17, cost -84.3318885549
Pre-training layer 0, epoch 18, cost -83.9676305389
Pre-training layer 0, epoch 19, cost -83.5877423477
Pre-training layer 0, epoch 20, cost -83.1934357198
Pre-training layer 0, epoch 20, representative training free energy -459.210985046
Pre-training layer 0, epoch 20, validation free energy -451.366382935
Pre-training layer 0, epoch 21, cost -82.6599345652
Pre-training layer 0, epoch 22, cost -82.2582006073
Pre-training layer 0, epoch 23, cost -81.9523526001
Pre-training layer 0, epoch 24, cost -81.6457087708
Pre-training layer 0, epoch 25, cost -81.3525397364
Pre-training layer 0, epoch 25, representative training free energy -451.86726593
Pre-training layer 0, epoch 25, validation free energy -443.327262543
Pre-training layer 0, epoch 26, cost -81.2324625142
Pre-training layer 0, epoch 27, cost -80.8191622416
Pre-training layer 0, epoch 28, cost -80.6224873479
Pre-training layer 0, epoch 29, cost -80.4386390177
Pre-training layer 0, epoch 30, cost -80.0143995794
Pre-training layer 0, epoch 30, representative training free energy -448.68708844
Pre-training layer 0, epoch 30, validation free energy -440.7081539
Pre-training layer 0, epoch 31, cost -79.8105840429
Pre-training layer 0, epoch 32, cost -79.7938287226
Pre-training layer 0, epoch 33, cost -79.3694568125
Pre-training layer 0, epoch 34, cost -79.2188877233
Pre-training layer 0, epoch 35, cost -79.0693424861
Pre-training layer 0, epoch 35, representative training free energy -446.212891113
Pre-training layer 0, epoch 35, validation free energy -437.069282593
Pre-training layer 0, epoch 36, cost -78.9448703384
Pre-training layer 0, epoch 37, cost -78.6952862549
Pre-training layer 0, epoch 38, cost -78.4758287175
Pre-training layer 0, epoch 39, cost -78.3004280345
Pre-training layer 0, epoch 40, cost -78.1372871399
Pre-training layer 0, epoch 40, representative training free energy -444.183686554
Pre-training layer 0, epoch 40, validation free energy -436.156023071
Pre-training layer 0, epoch 41, cost -77.9371762339
Pre-training layer 0, epoch 42, cost -77.9325674693
Pre-training layer 0, epoch 43, cost -77.9094824855
Pre-training layer 0, epoch 44, cost -77.546049614
Pre-training layer 0, epoch 45, cost -77.5486231995
Pre-training layer 0, epoch 45, representative training free energy -442.880838043
Pre-training layer 0, epoch 45, validation free energy -433.775190613
Pre-training layer 0, epoch 46, cost -77.3785773214
Pre-training layer 0, epoch 47, cost -77.206683286
Pre-training layer 0, epoch 48, cost -77.1381606038
Pre-training layer 0, epoch 49, cost -77.0428208415
Pre-training layer 0, epoch 50, cost -76.9513783518
Pre-training layer 0, epoch 50, representative training free energy -444.671632263
Pre-training layer 0, epoch 50, validation free energy -434.394764343
Pre-training layer 0, epoch 51, cost -76.821611379
Pre-training layer 0, epoch 52, cost -76.5444248327
Pre-training layer 0, epoch 53, cost -76.6187057241
Pre-training layer 0, epoch 54, cost -76.4466680145
Pre-training layer 0, epoch 55, cost -76.26762338
Pre-training layer 0, epoch 55, representative training free energy -440.353207123
Pre-training layer 0, epoch 55, validation free energy -431.168973511
Pre-training layer 0, epoch 56, cost -76.2141938782
Pre-training layer 0, epoch 57, cost -76.2216519165
Pre-training layer 0, epoch 58, cost -75.9308040746
Pre-training layer 0, epoch 59, cost -76.0192922084
Pre-training layer 0, epoch 60, cost -75.9255903244
Pre-training layer 0, epoch 60, representative training free energy -438.126047852
Pre-training layer 0, epoch 60, validation free energy -428.265892914
Pre-training layer 0, epoch 61, cost -75.738798968
Pre-training layer 0, epoch 62, cost -75.6748979823
Pre-training layer 0, epoch 63, cost -75.5986686961
Pre-training layer 0, epoch 64, cost -75.4170218023
Pre-training layer 0, epoch 65, cost -75.2837292989
Pre-training layer 0, epoch 65, representative training free energy -434.452037933
Pre-training layer 0, epoch 65, validation free energy -424.233258545
Pre-training layer 0, epoch 66, cost -75.2456570307
Pre-training layer 0, epoch 67, cost -75.2842067083
Pre-training layer 0, epoch 68, cost -75.2719020844
Pre-training layer 0, epoch 69, cost -75.1772368113
Pre-training layer 0, epoch 70, cost -74.9503560638
Pre-training layer 0, epoch 70, representative training free energy -431.541347809
Pre-training layer 0, epoch 70, validation free energy -420.842482452
Pre-training layer 0, epoch 71, cost -75.0075606283
Pre-training layer 0, epoch 72, cost -74.8523006566
Pre-training layer 0, epoch 73, cost -74.8276076889
Pre-training layer 0, epoch 74, cost -74.7931989797
Pre-training layer 0, epoch 75, cost -74.748759079
Pre-training layer 0, epoch 75, representative training free energy -433.042867249
Pre-training layer 0, epoch 75, validation free energy -421.862289703
Pre-training layer 0, epoch 76, cost -74.5531763331
Pre-training layer 0, epoch 77, cost -74.5943281937
Pre-training layer 0, epoch 78, cost -74.5481718953
Pre-training layer 0, epoch 79, cost -74.3910871251
Pre-training layer 0, epoch 80, cost -74.3005186208
Pre-training layer 0, epoch 80, representative training free energy -432.183457062
Pre-training layer 0, epoch 80, validation free energy -421.733667175
Pre-training layer 0, epoch 81, cost -74.3724955368
Pre-training layer 0, epoch 82, cost -74.2227695847
Pre-training layer 0, epoch 83, cost -74.2427782822
Pre-training layer 0, epoch 84, cost -74.0293629837
Pre-training layer 0, epoch 85, cost -74.0642513911
Pre-training layer 0, epoch 85, representative training free energy -428.861822693
Pre-training layer 0, epoch 85, validation free energy -417.875242432
Pre-training layer 0, epoch 86, cost -74.0257251231
Pre-training layer 0, epoch 87, cost -74.0165213267
Pre-training layer 0, epoch 88, cost -73.8043463898
Pre-training layer 0, epoch 89, cost -73.7801816559
Pre-training layer 0, epoch 90, cost -73.6875275675
Pre-training layer 0, epoch 90, representative training free energy -431.743959839
Pre-training layer 0, epoch 90, validation free energy -421.59913559
Pre-training layer 0, epoch 91, cost -73.6882935079
Pre-training layer 0, epoch 92, cost -73.7118493144
Pre-training layer 0, epoch 93, cost -73.5438739141
Pre-training layer 0, epoch 94, cost -73.4959508769
Pre-training layer 0, epoch 95, cost -73.4784743373
Pre-training layer 0, epoch 95, representative training free energy -431.720735016
Pre-training layer 0, epoch 95, validation free energy -420.712747986
Pre-training layer 0, epoch 96, cost -73.4294422531
Pre-training layer 0, epoch 97, cost -73.3881297429
Pre-training layer 0, epoch 98, cost -73.2682649994
Pre-training layer 0, epoch 99, cost -73.2619592158
Pre-training layer 1, epoch 0, cost -345.526516622
Pre-training layer 1, epoch 0, representative training free energy -51190.2035908
Pre-training layer 1, epoch 0, validation free energy -50765.2644219
Pre-training layer 1, epoch 1, cost -296.663375092
Pre-training layer 1, epoch 2, cost -281.808963013
Pre-training layer 1, epoch 3, cost -272.769021403
Pre-training layer 1, epoch 4, cost -266.868967285
Pre-training layer 1, epoch 5, cost -262.244676514
Pre-training layer 1, epoch 5, representative training free energy -69325.3306406
Pre-training layer 1, epoch 5, validation free energy -68748.807998
Pre-training layer 1, epoch 6, cost -258.608802541
Pre-training layer 1, epoch 7, cost -255.570044708
Pre-training layer 1, epoch 8, cost -253.148670959
Pre-training layer 1, epoch 9, cost -251.191392059
Pre-training layer 1, epoch 10, cost -249.406719309
Pre-training layer 1, epoch 10, representative training free energy -74838.0986426
Pre-training layer 1, epoch 10, validation free energy -74209.0762637
Pre-training layer 1, epoch 11, cost -247.996563822
Pre-training layer 1, epoch 12, cost -246.530613658
Pre-training layer 1, epoch 13, cost -245.370764211
Pre-training layer 1, epoch 14, cost -244.459310608
Pre-training layer 1, epoch 15, cost -243.355805003
Pre-training layer 1, epoch 15, representative training free energy -78078.7943379
Pre-training layer 1, epoch 15, validation free energy -77425.992209
Pre-training layer 1, epoch 16, cost -242.529647319
Pre-training layer 1, epoch 17, cost -241.728926341
Pre-training layer 1, epoch 18, cost -241.190588582
Pre-training layer 1, epoch 19, cost -240.532528636
Pre-training layer 1, epoch 20, cost -239.976720428
Pre-training layer 1, epoch 20, representative training free energy -80408.3163906
Pre-training layer 1, epoch 20, validation free energy -79735.9468672
Pre-training layer 1, epoch 21, cost -239.281598256
Pre-training layer 1, epoch 22, cost -238.810819499
Pre-training layer 1, epoch 23, cost -238.198602142
Pre-training layer 1, epoch 24, cost -237.856201426
Pre-training layer 1, epoch 25, cost -237.395175629
Pre-training layer 1, epoch 25, representative training free energy -82171.0268691
Pre-training layer 1, epoch 25, validation free energy -81490.4611152
Pre-training layer 1, epoch 26, cost -236.941145528
Pre-training layer 1, epoch 27, cost -236.595322266
Pre-training layer 1, epoch 28, cost -236.147249908
Pre-training layer 1, epoch 29, cost -235.748099314
Pre-training layer 1, epoch 30, cost -235.50414032
Pre-training layer 1, epoch 30, representative training free energy -83614.2429199
Pre-training layer 1, epoch 30, validation free energy -82909.1564883
Pre-training layer 1, epoch 31, cost -235.22622172
Pre-training layer 1, epoch 32, cost -234.881596018
Pre-training layer 1, epoch 33, cost -234.659698079
Pre-training layer 1, epoch 34, cost -234.376002146
Pre-training layer 1, epoch 35, cost -234.152716929
Pre-training layer 1, epoch 35, representative training free energy -84902.388707
Pre-training layer 1, epoch 35, validation free energy -84190.4693535
Pre-training layer 1, epoch 36, cost -233.815671895
Pre-training layer 1, epoch 37, cost -233.617562002
Pre-training layer 1, epoch 38, cost -233.506835429
Pre-training layer 1, epoch 39, cost -233.251887512
Pre-training layer 1, epoch 40, cost -233.019852905
Pre-training layer 1, epoch 40, representative training free energy -86058.9169238
Pre-training layer 1, epoch 40, validation free energy -85337.1469277
Pre-training layer 1, epoch 41, cost -232.821594289
Pre-training layer 1, epoch 42, cost -232.637975108
Pre-training layer 1, epoch 43, cost -232.525415039
Pre-training layer 1, epoch 44, cost -232.318886108
Pre-training layer 1, epoch 45, cost -232.102170563
Pre-training layer 1, epoch 45, representative training free energy -86826.7698809
Pre-training layer 1, epoch 45, validation free energy -86097.3029492
Pre-training layer 1, epoch 46, cost -231.86423818
Pre-training layer 1, epoch 47, cost -231.778236338
Pre-training layer 1, epoch 48, cost -231.594728953
Pre-training layer 1, epoch 49, cost -231.531322276
Pre-training layer 1, epoch 50, cost -231.350641988
Pre-training layer 1, epoch 50, representative training free energy -87750.3460527
Pre-training layer 1, epoch 50, validation free energy -87020.3987773
Pre-training layer 1, epoch 51, cost -231.248451487
Pre-training layer 1, epoch 52, cost -230.964290415
Pre-training layer 1, epoch 53, cost -230.996432749
Pre-training layer 1, epoch 54, cost -230.763068746
Pre-training layer 1, epoch 55, cost -230.622896271
Pre-training layer 1, epoch 55, representative training free energy -88462.8305664
Pre-training layer 1, epoch 55, validation free energy -87715.1303652
Pre-training layer 1, epoch 56, cost -230.55187856
Pre-training layer 1, epoch 57, cost -230.339520518
Pre-training layer 1, epoch 58, cost -230.297699839
Pre-training layer 1, epoch 59, cost -230.171725769
Pre-training layer 1, epoch 60, cost -230.031823069
Pre-training layer 1, epoch 60, representative training free energy -89122.3296758
Pre-training layer 1, epoch 60, validation free energy -88365.7551777
Pre-training layer 1, epoch 61, cost -230.011228383
Pre-training layer 1, epoch 62, cost -229.822607218
Pre-training layer 1, epoch 63, cost -229.817692464
Pre-training layer 1, epoch 64, cost -229.554670715
Pre-training layer 1, epoch 65, cost -229.524432882
Pre-training layer 1, epoch 65, representative training free energy -89778.3483867
Pre-training layer 1, epoch 65, validation free energy -89002.5611777
Pre-training layer 1, epoch 66, cost -229.469882711
Pre-training layer 1, epoch 67, cost -229.239741007
Pre-training layer 1, epoch 68, cost -229.215553182
Pre-training layer 1, epoch 69, cost -229.114587097
Pre-training layer 1, epoch 70, cost -229.065821482
Pre-training layer 1, epoch 70, representative training free energy -90386.2865488
Pre-training layer 1, epoch 70, validation free energy -89610.6172637
Pre-training layer 1, epoch 71, cost -228.937945658
Pre-training layer 1, epoch 72, cost -228.929680023
Pre-training layer 1, epoch 73, cost -228.675054372
Pre-training layer 1, epoch 74, cost -228.524819285
Pre-training layer 1, epoch 75, cost -228.609886729
Pre-training layer 1, epoch 75, representative training free energy -91050.2576152
Pre-training layer 1, epoch 75, validation free energy -90270.0488691
Pre-training layer 1, epoch 76, cost -228.52784083
Pre-training layer 1, epoch 77, cost -228.446796773
Pre-training layer 1, epoch 78, cost -228.416053111
Pre-training layer 1, epoch 79, cost -228.280915476
Pre-training layer 1, epoch 80, cost -228.241919657
Pre-training layer 1, epoch 80, representative training free energy -91531.6081465
Pre-training layer 1, epoch 80, validation free energy -90749.8735195
Pre-training layer 1, epoch 81, cost -228.233761444
Pre-training layer 1, epoch 82, cost -228.038862712
Pre-training layer 1, epoch 83, cost -228.0316834
Pre-training layer 1, epoch 84, cost -227.953858948
Pre-training layer 1, epoch 85, cost -227.859200948
Pre-training layer 1, epoch 85, representative training free energy -91946.1863652
Pre-training layer 1, epoch 85, validation free energy -91158.7201133
Pre-training layer 1, epoch 86, cost -227.932002614
Pre-training layer 1, epoch 87, cost -227.696583659
Pre-training layer 1, epoch 88, cost -227.698424784
Pre-training layer 1, epoch 89, cost -227.589094442
Pre-training layer 1, epoch 90, cost -227.526877594
Pre-training layer 1, epoch 90, representative training free energy -92462.5209316
Pre-training layer 1, epoch 90, validation free energy -91657.772752
Pre-training layer 1, epoch 91, cost -227.47197698
Pre-training layer 1, epoch 92, cost -227.534840597
Pre-training layer 1, epoch 93, cost -227.528964183
Pre-training layer 1, epoch 94, cost -227.20372935
Pre-training layer 1, epoch 95, cost -227.258873596
Pre-training layer 1, epoch 95, representative training free energy -92935.6015059
Pre-training layer 1, epoch 95, validation free energy -92131.1695
Pre-training layer 1, epoch 96, cost -227.196286977
Pre-training layer 1, epoch 97, cost -227.237726593
Pre-training layer 1, epoch 98, cost -227.135449524
Pre-training layer 1, epoch 99, cost -226.966308238
Pre-training layer 2, epoch 0, cost -127.979149602
Pre-training layer 2, epoch 0, representative training free energy 2833.2426687
Pre-training layer 2, epoch 0, validation free energy 2757.04107129
Pre-training layer 2, epoch 1, cost -94.2147424825
Pre-training layer 2, epoch 2, cost -87.0639028804
Pre-training layer 2, epoch 3, cost -83.1256217448
Pre-training layer 2, epoch 4, cost -80.3317470296
Pre-training layer 2, epoch 5, cost -78.283106753
Pre-training layer 2, epoch 5, representative training free energy 4715.67736328
Pre-training layer 2, epoch 5, validation free energy 4634.07557324
Pre-training layer 2, epoch 6, cost -76.6550988515
Pre-training layer 2, epoch 7, cost -75.3337321854
Pre-training layer 2, epoch 8, cost -74.2518806839
Pre-training layer 2, epoch 9, cost -73.30404555
Pre-training layer 2, epoch 10, cost -72.6486033122
Pre-training layer 2, epoch 10, representative training free energy 5716.94247961
Pre-training layer 2, epoch 10, validation free energy 5655.18387183
Pre-training layer 2, epoch 11, cost -71.9480915705
Pre-training layer 2, epoch 12, cost -71.3058698527
Pre-training layer 2, epoch 13, cost -70.8609103394
Pre-training layer 2, epoch 14, cost -70.3289491272
Pre-training layer 2, epoch 15, cost -69.8027348455
Pre-training layer 2, epoch 15, representative training free energy 6394.81122485
Pre-training layer 2, epoch 15, validation free energy 6335.1699906
Pre-training layer 2, epoch 16, cost -69.5618719482
Pre-training layer 2, epoch 17, cost -69.2679236348
Pre-training layer 2, epoch 18, cost -68.9932836533
Pre-training layer 2, epoch 19, cost -68.5450336075
Pre-training layer 2, epoch 20, cost -68.3271725591
Pre-training layer 2, epoch 20, representative training free energy 6942.31711768
Pre-training layer 2, epoch 20, validation free energy 6879.12572607
Pre-training layer 2, epoch 21, cost -68.0231005351
Pre-training layer 2, epoch 22, cost -67.8103841782
Pre-training layer 2, epoch 23, cost -67.5264923986
Pre-training layer 2, epoch 24, cost -67.3928613154
Pre-training layer 2, epoch 25, cost -67.1413568242
Pre-training layer 2, epoch 25, representative training free energy 7392.88384985
Pre-training layer 2, epoch 25, validation free energy 7322.24866943
Pre-training layer 2, epoch 26, cost -66.9949279149
Pre-training layer 2, epoch 27, cost -66.8671722412
Pre-training layer 2, epoch 28, cost -66.6729271317
Pre-training layer 2, epoch 29, cost -66.4995324961
Pre-training layer 2, epoch 30, cost -66.3141285451
Pre-training layer 2, epoch 30, representative training free energy 7822.48255249
Pre-training layer 2, epoch 30, validation free energy 7745.89621265
Pre-training layer 2, epoch 31, cost -66.2551749547
Pre-training layer 2, epoch 32, cost -66.2912272008
Pre-training layer 2, epoch 33, cost -65.8867989604
Pre-training layer 2, epoch 34, cost -65.9068035634
Pre-training layer 2, epoch 35, cost -65.6814305623
Pre-training layer 2, epoch 35, representative training free energy 8152.67343896
Pre-training layer 2, epoch 35, validation free energy 8072.3635625
Pre-training layer 2, epoch 36, cost -65.6814064789
Pre-training layer 2, epoch 37, cost -65.5826196035
Pre-training layer 2, epoch 38, cost -65.4709671148
Pre-training layer 2, epoch 39, cost -65.3853226089
Pre-training layer 2, epoch 40, cost -65.2969632721
Pre-training layer 2, epoch 40, representative training free energy 8460.4995061
Pre-training layer 2, epoch 40, validation free energy 8375.36491431
Pre-training layer 2, epoch 41, cost -65.2781190618
Pre-training layer 2, epoch 42, cost -65.1315759277
Pre-training layer 2, epoch 43, cost -65.0325312551
Pre-training layer 2, epoch 44, cost -64.9671146011
Pre-training layer 2, epoch 45, cost -64.9196439234
Pre-training layer 2, epoch 45, representative training free energy 8757.97346997
Pre-training layer 2, epoch 45, validation free energy 8670.14224487
Pre-training layer 2, epoch 46, cost -64.7648943202
Pre-training layer 2, epoch 47, cost -64.7539345678
Pre-training layer 2, epoch 48, cost -64.6666422526
Pre-training layer 2, epoch 49, cost -64.6188204066
Pre-training layer 2, epoch 50, cost -64.6172530111
Pre-training layer 2, epoch 50, representative training free energy 9038.5313418
Pre-training layer 2, epoch 50, validation free energy 8947.2966438
Pre-training layer 2, epoch 51, cost -64.5084966151
Pre-training layer 2, epoch 52, cost -64.3885617574
Pre-training layer 2, epoch 53, cost -64.4569735082
Pre-training layer 2, epoch 54, cost -64.3772101847
Pre-training layer 2, epoch 55, cost -64.357014122
Pre-training layer 2, epoch 55, representative training free energy 9286.10621338
Pre-training layer 2, epoch 55, validation free energy 9192.42727222
Pre-training layer 2, epoch 56, cost -64.2398140844
Pre-training layer 2, epoch 57, cost -64.13413517
Pre-training layer 2, epoch 58, cost -64.0828544871
Pre-training layer 2, epoch 59, cost -64.1144240697
Pre-training layer 2, epoch 60, cost -63.999594752
Pre-training layer 2, epoch 60, representative training free energy 9536.44010059
Pre-training layer 2, epoch 60, validation free energy 9437.83620874
Pre-training layer 2, epoch 61, cost -64.0361540349
Pre-training layer 2, epoch 62, cost -63.9563483175
Pre-training layer 2, epoch 63, cost -63.8932945251
Pre-training layer 2, epoch 64, cost -63.8031299337
Pre-training layer 2, epoch 65, cost -63.9030888748
Pre-training layer 2, epoch 65, representative training free energy 9760.11340063
Pre-training layer 2, epoch 65, validation free energy 9658.5156897
Pre-training layer 2, epoch 66, cost -63.8265244802
Pre-training layer 2, epoch 67, cost -63.7747186534
Pre-training layer 2, epoch 68, cost -63.7226211802
Pre-training layer 2, epoch 69, cost -63.6413235092
Pre-training layer 2, epoch 70, cost -63.6461905162
Pre-training layer 2, epoch 70, representative training free energy 9987.27985449
Pre-training layer 2, epoch 70, validation free energy 9884.02190308
Pre-training layer 2, epoch 71, cost -63.5513035202
Pre-training layer 2, epoch 72, cost -63.5935163244
Pre-training layer 2, epoch 73, cost -63.578774999
Pre-training layer 2, epoch 74, cost -63.5095436096
Pre-training layer 2, epoch 75, cost -63.4701813126
Pre-training layer 2, epoch 75, representative training free energy 10214.464561
Pre-training layer 2, epoch 75, validation free energy 10109.3289138
Pre-training layer 2, epoch 76, cost -63.433246549
Pre-training layer 2, epoch 77, cost -63.3526155853
Pre-training layer 2, epoch 78, cost -63.4443721898
Pre-training layer 2, epoch 79, cost -63.369214948
Pre-training layer 2, epoch 80, cost -63.3657432048
Pre-training layer 2, epoch 80, representative training free energy 10436.2451716
Pre-training layer 2, epoch 80, validation free energy 10329.9576619
Pre-training layer 2, epoch 81, cost -63.243874677
Pre-training layer 2, epoch 82, cost -63.2583370463
Pre-training layer 2, epoch 83, cost -63.2680874507
Pre-training layer 2, epoch 84, cost -63.2048334757
Pre-training layer 2, epoch 85, cost -63.2139784877
Pre-training layer 2, epoch 85, representative training free energy 10617.2016025
Pre-training layer 2, epoch 85, validation free energy 10508.0432085
Pre-training layer 2, epoch 86, cost -63.0729374441
Pre-training layer 2, epoch 87, cost -63.1245378113
Pre-training layer 2, epoch 88, cost -63.1127401988
Pre-training layer 2, epoch 89, cost -62.9718389511
Pre-training layer 2, epoch 90, cost -62.9413991547
Pre-training layer 2, epoch 90, representative training free energy 10846.5898804
Pre-training layer 2, epoch 90, validation free energy 10733.1407507
Pre-training layer 2, epoch 91, cost -63.0238419342
Pre-training layer 2, epoch 92, cost -63.0183389282
Pre-training layer 2, epoch 93, cost -62.9498663457
Pre-training layer 2, epoch 94, cost -62.9001055145
Pre-training layer 2, epoch 95, cost -62.9495478566
Pre-training layer 2, epoch 95, representative training free energy 11031.4915532
Pre-training layer 2, epoch 95, validation free energy 10916.2515054
Pre-training layer 2, epoch 96, cost -62.9156725057
Pre-training layer 2, epoch 97, cost -62.8551773326
Pre-training layer 2, epoch 98, cost -62.8364117686
Pre-training layer 2, epoch 99, cost -62.8208781306
The pretraining code for file dbn_loop.pyc ran for 8.17m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 35.100000 %
     epoch 1, minibatch 300/300, test error of best model 30.500000 %
epoch 2, minibatch 300/300, validation error 28.800000 %
     epoch 2, minibatch 300/300, test error of best model 21.700000 %
epoch 3, minibatch 300/300, validation error 26.200000 %
     epoch 3, minibatch 300/300, test error of best model 18.600000 %
epoch 4, minibatch 300/300, validation error 25.300000 %
     epoch 4, minibatch 300/300, test error of best model 16.600000 %
epoch 5, minibatch 300/300, validation error 24.100000 %
     epoch 5, minibatch 300/300, test error of best model 14.300000 %
epoch 6, minibatch 300/300, validation error 23.200000 %
     epoch 6, minibatch 300/300, test error of best model 12.900000 %
epoch 7, minibatch 300/300, validation error 22.500000 %
     epoch 7, minibatch 300/300, test error of best model 12.800000 %
epoch 8, minibatch 300/300, validation error 21.900000 %
     epoch 8, minibatch 300/300, test error of best model 12.400000 %
epoch 9, minibatch 300/300, validation error 21.400000 %
     epoch 9, minibatch 300/300, test error of best model 11.400000 %
epoch 10, minibatch 300/300, validation error 21.200000 %
     epoch 10, minibatch 300/300, test error of best model 10.400000 %
epoch 11, minibatch 300/300, validation error 20.500000 %
     epoch 11, minibatch 300/300, test error of best model 9.900000 %
epoch 12, minibatch 300/300, validation error 20.200000 %
     epoch 12, minibatch 300/300, test error of best model 9.800000 %
epoch 13, minibatch 300/300, validation error 19.600000 %
     epoch 13, minibatch 300/300, test error of best model 9.500000 %
epoch 14, minibatch 300/300, validation error 18.800000 %
     epoch 14, minibatch 300/300, test error of best model 9.400000 %
epoch 15, minibatch 300/300, validation error 18.400000 %
     epoch 15, minibatch 300/300, test error of best model 9.200000 %
epoch 16, minibatch 300/300, validation error 18.300000 %
     epoch 16, minibatch 300/300, test error of best model 8.900000 %
epoch 17, minibatch 300/300, validation error 18.100000 %
     epoch 17, minibatch 300/300, test error of best model 8.800000 %
epoch 18, minibatch 300/300, validation error 18.000000 %
     epoch 18, minibatch 300/300, test error of best model 8.500000 %
epoch 19, minibatch 300/300, validation error 17.700000 %
     epoch 19, minibatch 300/300, test error of best model 8.500000 %
epoch 20, minibatch 300/300, validation error 17.600000 %
     epoch 20, minibatch 300/300, test error of best model 8.500000 %
epoch 21, minibatch 300/300, validation error 17.200000 %
     epoch 21, minibatch 300/300, test error of best model 8.300000 %
epoch 22, minibatch 300/300, validation error 17.100000 %
     epoch 22, minibatch 300/300, test error of best model 8.300000 %
epoch 23, minibatch 300/300, validation error 17.000000 %
     epoch 23, minibatch 300/300, test error of best model 8.200000 %
epoch 24, minibatch 300/300, validation error 16.900000 %
     epoch 24, minibatch 300/300, test error of best model 8.400000 %
epoch 25, minibatch 300/300, validation error 16.800000 %
     epoch 25, minibatch 300/300, test error of best model 8.200000 %
epoch 26, minibatch 300/300, validation error 16.600000 %
     epoch 26, minibatch 300/300, test error of best model 8.200000 %
epoch 27, minibatch 300/300, validation error 16.400000 %
     epoch 27, minibatch 300/300, test error of best model 8.100000 %
epoch 28, minibatch 300/300, validation error 16.300000 %
     epoch 28, minibatch 300/300, test error of best model 8.100000 %
epoch 29, minibatch 300/300, validation error 16.300000 %
epoch 30, minibatch 300/300, validation error 16.400000 %
epoch 31, minibatch 300/300, validation error 16.400000 %
epoch 32, minibatch 300/300, validation error 16.300000 %
epoch 33, minibatch 300/300, validation error 16.300000 %
epoch 34, minibatch 300/300, validation error 16.200000 %
     epoch 34, minibatch 300/300, test error of best model 7.600000 %
epoch 35, minibatch 300/300, validation error 16.200000 %
epoch 36, minibatch 300/300, validation error 16.200000 %
epoch 37, minibatch 300/300, validation error 16.000000 %
     epoch 37, minibatch 300/300, test error of best model 7.800000 %
epoch 38, minibatch 300/300, validation error 16.000000 %
epoch 39, minibatch 300/300, validation error 16.000000 %
epoch 40, minibatch 300/300, validation error 16.100000 %
epoch 41, minibatch 300/300, validation error 16.000000 %
epoch 42, minibatch 300/300, validation error 15.900000 %
     epoch 42, minibatch 300/300, test error of best model 7.400000 %
epoch 43, minibatch 300/300, validation error 15.900000 %
epoch 44, minibatch 300/300, validation error 15.800000 %
     epoch 44, minibatch 300/300, test error of best model 7.100000 %
epoch 45, minibatch 300/300, validation error 15.700000 %
     epoch 45, minibatch 300/300, test error of best model 7.200000 %
epoch 46, minibatch 300/300, validation error 15.400000 %
     epoch 46, minibatch 300/300, test error of best model 7.200000 %
epoch 47, minibatch 300/300, validation error 15.300000 %
     epoch 47, minibatch 300/300, test error of best model 7.200000 %
epoch 48, minibatch 300/300, validation error 15.300000 %
epoch 49, minibatch 300/300, validation error 15.300000 %
epoch 50, minibatch 300/300, validation error 15.300000 %
epoch 51, minibatch 300/300, validation error 15.300000 %
epoch 52, minibatch 300/300, validation error 15.100000 %
     epoch 52, minibatch 300/300, test error of best model 6.900000 %
epoch 53, minibatch 300/300, validation error 15.200000 %
epoch 54, minibatch 300/300, validation error 15.200000 %
epoch 55, minibatch 300/300, validation error 15.200000 %
epoch 56, minibatch 300/300, validation error 15.200000 %
epoch 57, minibatch 300/300, validation error 15.200000 %
epoch 58, minibatch 300/300, validation error 15.200000 %
epoch 59, minibatch 300/300, validation error 15.100000 %
epoch 60, minibatch 300/300, validation error 15.100000 %
epoch 61, minibatch 300/300, validation error 15.000000 %
     epoch 61, minibatch 300/300, test error of best model 6.800000 %
epoch 62, minibatch 300/300, validation error 15.000000 %
epoch 63, minibatch 300/300, validation error 15.000000 %
epoch 64, minibatch 300/300, validation error 15.000000 %
epoch 65, minibatch 300/300, validation error 15.000000 %
epoch 66, minibatch 300/300, validation error 15.000000 %
epoch 67, minibatch 300/300, validation error 15.000000 %
epoch 68, minibatch 300/300, validation error 15.000000 %
epoch 69, minibatch 300/300, validation error 15.100000 %
epoch 70, minibatch 300/300, validation error 15.000000 %
epoch 71, minibatch 300/300, validation error 14.900000 %
     epoch 71, minibatch 300/300, test error of best model 6.700000 %
epoch 72, minibatch 300/300, validation error 14.900000 %
epoch 73, minibatch 300/300, validation error 14.800000 %
     epoch 73, minibatch 300/300, test error of best model 6.700000 %
epoch 74, minibatch 300/300, validation error 14.800000 %
epoch 75, minibatch 300/300, validation error 14.700000 %
     epoch 75, minibatch 300/300, test error of best model 6.700000 %
epoch 76, minibatch 300/300, validation error 14.700000 %
epoch 77, minibatch 300/300, validation error 14.700000 %
epoch 78, minibatch 300/300, validation error 14.700000 %
epoch 79, minibatch 300/300, validation error 14.700000 %
epoch 80, minibatch 300/300, validation error 14.700000 %
epoch 81, minibatch 300/300, validation error 14.600000 %
     epoch 81, minibatch 300/300, test error of best model 6.700000 %
epoch 82, minibatch 300/300, validation error 14.600000 %
epoch 83, minibatch 300/300, validation error 14.600000 %
epoch 84, minibatch 300/300, validation error 14.500000 %
     epoch 84, minibatch 300/300, test error of best model 6.700000 %
epoch 85, minibatch 300/300, validation error 14.500000 %
epoch 86, minibatch 300/300, validation error 14.500000 %
epoch 87, minibatch 300/300, validation error 14.500000 %
epoch 88, minibatch 300/300, validation error 14.500000 %
epoch 89, minibatch 300/300, validation error 14.500000 %
epoch 90, minibatch 300/300, validation error 14.500000 %
epoch 91, minibatch 300/300, validation error 14.500000 %
epoch 92, minibatch 300/300, validation error 14.500000 %
epoch 93, minibatch 300/300, validation error 14.500000 %
epoch 94, minibatch 300/300, validation error 14.500000 %
epoch 95, minibatch 300/300, validation error 14.500000 %
epoch 96, minibatch 300/300, validation error 14.500000 %
epoch 97, minibatch 300/300, validation error 14.500000 %
epoch 98, minibatch 300/300, validation error 14.500000 %
epoch 99, minibatch 300/300, validation error 14.500000 %
epoch 100, minibatch 300/300, validation error 14.500000 %
epoch 101, minibatch 300/300, validation error 14.500000 %
epoch 102, minibatch 300/300, validation error 14.500000 %
epoch 103, minibatch 300/300, validation error 14.500000 %
epoch 104, minibatch 300/300, validation error 14.600000 %
epoch 105, minibatch 300/300, validation error 14.600000 %
epoch 106, minibatch 300/300, validation error 14.600000 %
epoch 107, minibatch 300/300, validation error 14.600000 %
epoch 108, minibatch 300/300, validation error 14.600000 %
epoch 109, minibatch 300/300, validation error 14.600000 %
epoch 110, minibatch 300/300, validation error 14.600000 %
epoch 111, minibatch 300/300, validation error 14.600000 %
epoch 112, minibatch 300/300, validation error 14.600000 %
epoch 113, minibatch 300/300, validation error 14.600000 %
epoch 114, minibatch 300/300, validation error 14.600000 %
epoch 115, minibatch 300/300, validation error 14.600000 %
epoch 116, minibatch 300/300, validation error 14.600000 %
epoch 117, minibatch 300/300, validation error 14.600000 %
epoch 118, minibatch 300/300, validation error 14.600000 %
epoch 119, minibatch 300/300, validation error 14.600000 %
epoch 120, minibatch 300/300, validation error 14.600000 %
epoch 121, minibatch 300/300, validation error 14.600000 %
epoch 122, minibatch 300/300, validation error 14.600000 %
epoch 123, minibatch 300/300, validation error 14.600000 %
epoch 124, minibatch 300/300, validation error 14.600000 %
epoch 125, minibatch 300/300, validation error 14.600000 %
epoch 126, minibatch 300/300, validation error 14.600000 %
epoch 127, minibatch 300/300, validation error 14.600000 %
epoch 128, minibatch 300/300, validation error 14.600000 %
epoch 129, minibatch 300/300, validation error 14.600000 %
epoch 130, minibatch 300/300, validation error 14.600000 %
epoch 131, minibatch 300/300, validation error 14.600000 %
epoch 132, minibatch 300/300, validation error 14.600000 %
epoch 133, minibatch 300/300, validation error 14.600000 %
epoch 134, minibatch 300/300, validation error 14.600000 %
epoch 135, minibatch 300/300, validation error 14.600000 %
epoch 136, minibatch 300/300, validation error 14.600000 %
epoch 137, minibatch 300/300, validation error 14.600000 %
epoch 138, minibatch 300/300, validation error 14.600000 %
epoch 139, minibatch 300/300, validation error 14.500000 %
     epoch 139, minibatch 300/300, test error of best model 6.600000 %
epoch 140, minibatch 300/300, validation error 14.500000 %
epoch 141, minibatch 300/300, validation error 14.500000 %
epoch 142, minibatch 300/300, validation error 14.500000 %
epoch 143, minibatch 300/300, validation error 14.500000 %
epoch 144, minibatch 300/300, validation error 14.500000 %
epoch 145, minibatch 300/300, validation error 14.500000 %
epoch 146, minibatch 300/300, validation error 14.500000 %
epoch 147, minibatch 300/300, validation error 14.500000 %
epoch 148, minibatch 300/300, validation error 14.500000 %
epoch 149, minibatch 300/300, validation error 14.500000 %
epoch 150, minibatch 300/300, validation error 14.500000 %
epoch 151, minibatch 300/300, validation error 14.500000 %
epoch 152, minibatch 300/300, validation error 14.500000 %
epoch 153, minibatch 300/300, validation error 14.500000 %
epoch 154, minibatch 300/300, validation error 14.500000 %
epoch 155, minibatch 300/300, validation error 14.500000 %
epoch 156, minibatch 300/300, validation error 14.600000 %
epoch 157, minibatch 300/300, validation error 14.600000 %
epoch 158, minibatch 300/300, validation error 14.600000 %
epoch 159, minibatch 300/300, validation error 14.600000 %
epoch 160, minibatch 300/300, validation error 14.600000 %
epoch 161, minibatch 300/300, validation error 14.600000 %
epoch 162, minibatch 300/300, validation error 14.600000 %
epoch 163, minibatch 300/300, validation error 14.600000 %
epoch 164, minibatch 300/300, validation error 14.600000 %
epoch 165, minibatch 300/300, validation error 14.600000 %
epoch 166, minibatch 300/300, validation error 14.600000 %
epoch 167, minibatch 300/300, validation error 14.600000 %
Optimization complete with best validation score of 14.500000 %, obtained at iteration 41700, with test performance 6.600000 %
The fine tuning code for file dbn_loop.pyc ran for 4.70m


==========Sample: (4000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.327004185
Pre-training layer 0, epoch 0, representative training free energy -550.235505005
Pre-training layer 0, epoch 0, validation free energy -546.941792725
Pre-training layer 0, epoch 1, cost -111.973352261
Pre-training layer 0, epoch 2, cost -103.895940437
Pre-training layer 0, epoch 3, cost -99.0091259575
Pre-training layer 0, epoch 4, cost -95.8456354713
Pre-training layer 0, epoch 5, cost -93.5717551422
Pre-training layer 0, epoch 5, representative training free energy -494.280892303
Pre-training layer 0, epoch 5, validation free energy -488.553219421
Pre-training layer 0, epoch 6, cost -91.467017746
Pre-training layer 0, epoch 7, cost -90.2028119469
Pre-training layer 0, epoch 8, cost -88.8361999893
Pre-training layer 0, epoch 9, cost -87.787997818
Pre-training layer 0, epoch 10, cost -86.8461684704
Pre-training layer 0, epoch 10, representative training free energy -469.830067108
Pre-training layer 0, epoch 10, validation free energy -464.335639496
Pre-training layer 0, epoch 11, cost -85.9592224503
Pre-training layer 0, epoch 12, cost -85.1588906097
Pre-training layer 0, epoch 13, cost -84.8967411232
Pre-training layer 0, epoch 14, cost -84.1207481384
Pre-training layer 0, epoch 15, cost -83.6215814781
Pre-training layer 0, epoch 15, representative training free energy -455.566049408
Pre-training layer 0, epoch 15, validation free energy -450.498549042
Pre-training layer 0, epoch 16, cost -83.201386404
Pre-training layer 0, epoch 17, cost -82.6418099117
Pre-training layer 0, epoch 18, cost -82.3623139286
Pre-training layer 0, epoch 19, cost -81.8831865788
Pre-training layer 0, epoch 20, cost -81.7509439564
Pre-training layer 0, epoch 20, representative training free energy -449.415272064
Pre-training layer 0, epoch 20, validation free energy -443.503969757
Pre-training layer 0, epoch 21, cost -81.3159434414
Pre-training layer 0, epoch 22, cost -80.9102396965
Pre-training layer 0, epoch 23, cost -80.6499703598
Pre-training layer 0, epoch 24, cost -80.2063199043
Pre-training layer 0, epoch 25, cost -80.1167227554
Pre-training layer 0, epoch 25, representative training free energy -443.587000458
Pre-training layer 0, epoch 25, validation free energy -436.97957901
Pre-training layer 0, epoch 26, cost -79.8680764866
Pre-training layer 0, epoch 27, cost -79.6314634514
Pre-training layer 0, epoch 28, cost -79.4702432728
Pre-training layer 0, epoch 29, cost -79.1220200634
Pre-training layer 0, epoch 30, cost -79.0124097252
Pre-training layer 0, epoch 30, representative training free energy -440.572594055
Pre-training layer 0, epoch 30, validation free energy -433.766206543
Pre-training layer 0, epoch 31, cost -78.8397472572
Pre-training layer 0, epoch 32, cost -78.5295298195
Pre-training layer 0, epoch 33, cost -78.4459152222
Pre-training layer 0, epoch 34, cost -78.3354519272
Pre-training layer 0, epoch 35, cost -77.9867907047
Pre-training layer 0, epoch 35, representative training free energy -438.10519397
Pre-training layer 0, epoch 35, validation free energy -430.758116547
Pre-training layer 0, epoch 36, cost -77.9646988487
Pre-training layer 0, epoch 37, cost -77.7933427906
Pre-training layer 0, epoch 38, cost -77.4815750217
Pre-training layer 0, epoch 39, cost -77.4432970142
Pre-training layer 0, epoch 40, cost -77.4221179867
Pre-training layer 0, epoch 40, representative training free energy -435.478168945
Pre-training layer 0, epoch 40, validation free energy -427.657200409
Pre-training layer 0, epoch 41, cost -77.2449770355
Pre-training layer 0, epoch 42, cost -77.1272441292
Pre-training layer 0, epoch 43, cost -77.010243578
Pre-training layer 0, epoch 44, cost -76.8829618549
Pre-training layer 0, epoch 45, cost -76.7143487167
Pre-training layer 0, epoch 45, representative training free energy -434.025756744
Pre-training layer 0, epoch 45, validation free energy -425.811043823
Pre-training layer 0, epoch 46, cost -76.6137001705
Pre-training layer 0, epoch 47, cost -76.5172925568
Pre-training layer 0, epoch 48, cost -76.4436893082
Pre-training layer 0, epoch 49, cost -76.326912756
Pre-training layer 0, epoch 50, cost -76.2740352345
Pre-training layer 0, epoch 50, representative training free energy -431.277691742
Pre-training layer 0, epoch 50, validation free energy -422.816531647
Pre-training layer 0, epoch 51, cost -76.1281669235
Pre-training layer 0, epoch 52, cost -76.0122000885
Pre-training layer 0, epoch 53, cost -75.9049980927
Pre-training layer 0, epoch 54, cost -75.8734452057
Pre-training layer 0, epoch 55, cost -75.8076068211
Pre-training layer 0, epoch 55, representative training free energy -425.410405945
Pre-training layer 0, epoch 55, validation free energy -417.614424042
Pre-training layer 0, epoch 56, cost -75.5493300247
Pre-training layer 0, epoch 57, cost -75.537636404
Pre-training layer 0, epoch 58, cost -75.484385767
Pre-training layer 0, epoch 59, cost -75.4527859402
Pre-training layer 0, epoch 60, cost -75.3029833221
Pre-training layer 0, epoch 60, representative training free energy -428.469297638
Pre-training layer 0, epoch 60, validation free energy -419.592233887
Pre-training layer 0, epoch 61, cost -75.124261837
Pre-training layer 0, epoch 62, cost -75.0927089214
Pre-training layer 0, epoch 63, cost -75.1065253735
Pre-training layer 0, epoch 64, cost -74.9718122387
Pre-training layer 0, epoch 65, cost -74.9131619358
Pre-training layer 0, epoch 65, representative training free energy -425.814751831
Pre-training layer 0, epoch 65, validation free energy -417.420756104
Pre-training layer 0, epoch 66, cost -74.8825446701
Pre-training layer 0, epoch 67, cost -74.6664916897
Pre-training layer 0, epoch 68, cost -74.8004390144
Pre-training layer 0, epoch 69, cost -74.5900750828
Pre-training layer 0, epoch 70, cost -74.6426085186
Pre-training layer 0, epoch 70, representative training free energy -424.242373444
Pre-training layer 0, epoch 70, validation free energy -415.318979492
Pre-training layer 0, epoch 71, cost -74.4255370426
Pre-training layer 0, epoch 72, cost -74.3208531857
Pre-training layer 0, epoch 73, cost -74.2751692009
Pre-training layer 0, epoch 74, cost -74.4088485432
Pre-training layer 0, epoch 75, cost -74.1634809494
Pre-training layer 0, epoch 75, representative training free energy -423.589790863
Pre-training layer 0, epoch 75, validation free energy -414.597598358
Pre-training layer 0, epoch 76, cost -74.1786194515
Pre-training layer 0, epoch 77, cost -74.1075253677
Pre-training layer 0, epoch 78, cost -73.9821947384
Pre-training layer 0, epoch 79, cost -73.9874248028
Pre-training layer 0, epoch 80, cost -73.9700362396
Pre-training layer 0, epoch 80, representative training free energy -423.103441864
Pre-training layer 0, epoch 80, validation free energy -414.007537811
Pre-training layer 0, epoch 81, cost -73.8995080566
Pre-training layer 0, epoch 82, cost -73.7641240025
Pre-training layer 0, epoch 83, cost -73.7954387474
Pre-training layer 0, epoch 84, cost -73.7023152447
Pre-training layer 0, epoch 85, cost -73.5643736649
Pre-training layer 0, epoch 85, representative training free energy -421.489542603
Pre-training layer 0, epoch 85, validation free energy -412.184640015
Pre-training layer 0, epoch 86, cost -73.590846405
Pre-training layer 0, epoch 87, cost -73.4927740765
Pre-training layer 0, epoch 88, cost -73.3898728943
Pre-training layer 0, epoch 89, cost -73.4307306385
Pre-training layer 0, epoch 90, cost -73.4601374817
Pre-training layer 0, epoch 90, representative training free energy -420.801471985
Pre-training layer 0, epoch 90, validation free energy -412.403081207
Pre-training layer 0, epoch 91, cost -73.3438604927
Pre-training layer 0, epoch 92, cost -73.2535869884
Pre-training layer 0, epoch 93, cost -73.2758347988
Pre-training layer 0, epoch 94, cost -73.1278483391
Pre-training layer 0, epoch 95, cost -73.1407254124
Pre-training layer 0, epoch 95, representative training free energy -420.664812012
Pre-training layer 0, epoch 95, validation free energy -411.369494049
Pre-training layer 0, epoch 96, cost -73.076487627
Pre-training layer 0, epoch 97, cost -73.0295413876
Pre-training layer 0, epoch 98, cost -72.9986363411
Pre-training layer 0, epoch 99, cost -72.932343874
Pre-training layer 1, epoch 0, cost -323.845597115
Pre-training layer 1, epoch 0, representative training free energy -57691.9088203
Pre-training layer 1, epoch 0, validation free energy -57241.7626211
Pre-training layer 1, epoch 1, cost -278.282639999
Pre-training layer 1, epoch 2, cost -264.325741882
Pre-training layer 1, epoch 3, cost -256.016762772
Pre-training layer 1, epoch 4, cost -250.355817299
Pre-training layer 1, epoch 5, cost -246.2453965
Pre-training layer 1, epoch 5, representative training free energy -77400.2932969
Pre-training layer 1, epoch 5, validation free energy -76739.6688965
Pre-training layer 1, epoch 6, cost -243.218033905
Pre-training layer 1, epoch 7, cost -240.543584518
Pre-training layer 1, epoch 8, cost -238.581901894
Pre-training layer 1, epoch 9, cost -236.703838005
Pre-training layer 1, epoch 10, cost -235.222867813
Pre-training layer 1, epoch 10, representative training free energy -83355.4167266
Pre-training layer 1, epoch 10, validation free energy -82640.4971875
Pre-training layer 1, epoch 11, cost -233.971999893
Pre-training layer 1, epoch 12, cost -232.804546432
Pre-training layer 1, epoch 13, cost -231.742618904
Pre-training layer 1, epoch 14, cost -230.813900146
Pre-training layer 1, epoch 15, cost -229.918559074
Pre-training layer 1, epoch 15, representative training free energy -86834.6665488
Pre-training layer 1, epoch 15, validation free energy -86080.4230625
Pre-training layer 1, epoch 16, cost -229.28818718
Pre-training layer 1, epoch 17, cost -228.595268326
Pre-training layer 1, epoch 18, cost -228.100809364
Pre-training layer 1, epoch 19, cost -227.443227654
Pre-training layer 1, epoch 20, cost -226.933698006
Pre-training layer 1, epoch 20, representative training free energy -89243.3651875
Pre-training layer 1, epoch 20, validation free energy -88467.0303262
Pre-training layer 1, epoch 21, cost -226.312909775
Pre-training layer 1, epoch 22, cost -226.060041618
Pre-training layer 1, epoch 23, cost -225.54635376
Pre-training layer 1, epoch 24, cost -225.106228333
Pre-training layer 1, epoch 25, cost -224.769068527
Pre-training layer 1, epoch 25, representative training free energy -91222.2161914
Pre-training layer 1, epoch 25, validation free energy -90426.3247227
Pre-training layer 1, epoch 26, cost -224.485649452
Pre-training layer 1, epoch 27, cost -224.032010155
Pre-training layer 1, epoch 28, cost -223.755521889
Pre-training layer 1, epoch 29, cost -223.491649437
Pre-training layer 1, epoch 30, cost -223.242082062
Pre-training layer 1, epoch 30, representative training free energy -92818.746998
Pre-training layer 1, epoch 30, validation free energy -92001.7441641
Pre-training layer 1, epoch 31, cost -222.88812336
Pre-training layer 1, epoch 32, cost -222.668009033
Pre-training layer 1, epoch 33, cost -222.47276207
Pre-training layer 1, epoch 34, cost -222.104702606
Pre-training layer 1, epoch 35, cost -221.927460518
Pre-training layer 1, epoch 35, representative training free energy -94288.2562559
Pre-training layer 1, epoch 35, validation free energy -93470.8181426
Pre-training layer 1, epoch 36, cost -221.75929657
Pre-training layer 1, epoch 37, cost -221.563708267
Pre-training layer 1, epoch 38, cost -221.378549614
Pre-training layer 1, epoch 39, cost -221.137272148
Pre-training layer 1, epoch 40, cost -220.970811996
Pre-training layer 1, epoch 40, representative training free energy -95543.5048047
Pre-training layer 1, epoch 40, validation free energy -94709.9400781
Pre-training layer 1, epoch 41, cost -220.787533417
Pre-training layer 1, epoch 42, cost -220.553994026
Pre-training layer 1, epoch 43, cost -220.420860367
Pre-training layer 1, epoch 44, cost -220.231109276
Pre-training layer 1, epoch 45, cost -220.077597275
Pre-training layer 1, epoch 45, representative training free energy -96655.5880059
Pre-training layer 1, epoch 45, validation free energy -95802.0574453
Pre-training layer 1, epoch 46, cost -219.970524139
Pre-training layer 1, epoch 47, cost -219.767764778
Pre-training layer 1, epoch 48, cost -219.738541412
Pre-training layer 1, epoch 49, cost -219.537813873
Pre-training layer 1, epoch 50, cost -219.446636505
Pre-training layer 1, epoch 50, representative training free energy -97709.6094648
Pre-training layer 1, epoch 50, validation free energy -96843.4272773
Pre-training layer 1, epoch 51, cost -219.241754456
Pre-training layer 1, epoch 52, cost -219.093419495
Pre-training layer 1, epoch 53, cost -219.099383583
Pre-training layer 1, epoch 54, cost -218.888187943
Pre-training layer 1, epoch 55, cost -218.809528122
Pre-training layer 1, epoch 55, representative training free energy -98616.2751621
Pre-training layer 1, epoch 55, validation free energy -97735.7898887
Pre-training layer 1, epoch 56, cost -218.674990959
Pre-training layer 1, epoch 57, cost -218.528365898
Pre-training layer 1, epoch 58, cost -218.356621666
Pre-training layer 1, epoch 59, cost -218.419941864
Pre-training layer 1, epoch 60, cost -218.402680054
Pre-training layer 1, epoch 60, representative training free energy -99401.8983359
Pre-training layer 1, epoch 60, validation free energy -98505.9794727
Pre-training layer 1, epoch 61, cost -218.222650795
Pre-training layer 1, epoch 62, cost -218.128131714
Pre-training layer 1, epoch 63, cost -217.95602108
Pre-training layer 1, epoch 64, cost -217.804827728
Pre-training layer 1, epoch 65, cost -217.823301048
Pre-training layer 1, epoch 65, representative training free energy -100123.831639
Pre-training layer 1, epoch 65, validation free energy -99226.7038008
Pre-training layer 1, epoch 66, cost -217.706027832
Pre-training layer 1, epoch 67, cost -217.683619728
Pre-training layer 1, epoch 68, cost -217.482314835
Pre-training layer 1, epoch 69, cost -217.425431137
Pre-training layer 1, epoch 70, cost -217.352988319
Pre-training layer 1, epoch 70, representative training free energy -100797.266893
Pre-training layer 1, epoch 70, validation free energy -99885.7706191
Pre-training layer 1, epoch 71, cost -217.348642082
Pre-training layer 1, epoch 72, cost -217.233898697
Pre-training layer 1, epoch 73, cost -217.053352509
Pre-training layer 1, epoch 74, cost -217.117479248
Pre-training layer 1, epoch 75, cost -216.928894844
Pre-training layer 1, epoch 75, representative training free energy -101483.778184
Pre-training layer 1, epoch 75, validation free energy -100567.779621
Pre-training layer 1, epoch 76, cost -216.83830246
Pre-training layer 1, epoch 77, cost -216.753027
Pre-training layer 1, epoch 78, cost -216.86441906
Pre-training layer 1, epoch 79, cost -216.768849068
Pre-training layer 1, epoch 80, cost -216.583780212
Pre-training layer 1, epoch 80, representative training free energy -102161.042621
Pre-training layer 1, epoch 80, validation free energy -101227.74673
Pre-training layer 1, epoch 81, cost -216.516794434
Pre-training layer 1, epoch 82, cost -216.463359642
Pre-training layer 1, epoch 83, cost -216.453451385
Pre-training layer 1, epoch 84, cost -216.31115139
Pre-training layer 1, epoch 85, cost -216.269809341
Pre-training layer 1, epoch 85, representative training free energy -102746.699957
Pre-training layer 1, epoch 85, validation free energy -101813.661867
Pre-training layer 1, epoch 86, cost -216.278229332
Pre-training layer 1, epoch 87, cost -216.22556694
Pre-training layer 1, epoch 88, cost -216.221223526
Pre-training layer 1, epoch 89, cost -216.064904671
Pre-training layer 1, epoch 90, cost -216.016302986
Pre-training layer 1, epoch 90, representative training free energy -103329.579383
Pre-training layer 1, epoch 90, validation free energy -102387.602191
Pre-training layer 1, epoch 91, cost -216.028913803
Pre-training layer 1, epoch 92, cost -215.878826714
Pre-training layer 1, epoch 93, cost -215.877469101
Pre-training layer 1, epoch 94, cost -215.705093346
Pre-training layer 1, epoch 95, cost -215.685221367
Pre-training layer 1, epoch 95, representative training free energy -104002.452527
Pre-training layer 1, epoch 95, validation free energy -103054.515273
Pre-training layer 1, epoch 96, cost -215.806588402
Pre-training layer 1, epoch 97, cost -215.630588493
Pre-training layer 1, epoch 98, cost -215.626502228
Pre-training layer 1, epoch 99, cost -215.491124611
Pre-training layer 2, epoch 0, cost -119.179714165
Pre-training layer 2, epoch 0, representative training free energy 3676.57207764
Pre-training layer 2, epoch 0, validation free energy 3655.83747272
Pre-training layer 2, epoch 1, cost -89.2088499641
Pre-training layer 2, epoch 2, cost -82.6829922676
Pre-training layer 2, epoch 3, cost -78.9296081448
Pre-training layer 2, epoch 4, cost -76.4631215286
Pre-training layer 2, epoch 5, cost -74.8018622208
Pre-training layer 2, epoch 5, representative training free energy 5843.43502258
Pre-training layer 2, epoch 5, validation free energy 5783.49334692
Pre-training layer 2, epoch 6, cost -73.1600095749
Pre-training layer 2, epoch 7, cost -72.1991378021
Pre-training layer 2, epoch 8, cost -71.0905448818
Pre-training layer 2, epoch 9, cost -70.4034168339
Pre-training layer 2, epoch 10, cost -69.7329479504
Pre-training layer 2, epoch 10, representative training free energy 7013.80406055
Pre-training layer 2, epoch 10, validation free energy 6947.25206177
Pre-training layer 2, epoch 11, cost -69.0802270126
Pre-training layer 2, epoch 12, cost -68.5517895699
Pre-training layer 2, epoch 13, cost -68.237300787
Pre-training layer 2, epoch 14, cost -67.7987014866
Pre-training layer 2, epoch 15, cost -67.4210921669
Pre-training layer 2, epoch 15, representative training free energy 7799.53370459
Pre-training layer 2, epoch 15, validation free energy 7726.36280786
Pre-training layer 2, epoch 16, cost -66.9900902462
Pre-training layer 2, epoch 17, cost -66.6925021553
Pre-training layer 2, epoch 18, cost -66.4860943031
Pre-training layer 2, epoch 19, cost -66.2508079338
Pre-training layer 2, epoch 20, cost -65.9635847855
Pre-training layer 2, epoch 20, representative training free energy 8476.58289063
Pre-training layer 2, epoch 20, validation free energy 8395.91792822
Pre-training layer 2, epoch 21, cost -65.6789953423
Pre-training layer 2, epoch 22, cost -65.5965552807
Pre-training layer 2, epoch 23, cost -65.3733037949
Pre-training layer 2, epoch 24, cost -65.2559260654
Pre-training layer 2, epoch 25, cost -65.0187868595
Pre-training layer 2, epoch 25, representative training free energy 9084.16195898
Pre-training layer 2, epoch 25, validation free energy 8996.74211133
Pre-training layer 2, epoch 26, cost -64.8181041336
Pre-training layer 2, epoch 27, cost -64.6302382946
Pre-training layer 2, epoch 28, cost -64.5679325962
Pre-training layer 2, epoch 29, cost -64.3855724239
Pre-training layer 2, epoch 30, cost -64.3663502121
Pre-training layer 2, epoch 30, representative training free energy 9548.54271338
Pre-training layer 2, epoch 30, validation free energy 9457.0476626
Pre-training layer 2, epoch 31, cost -64.220684309
Pre-training layer 2, epoch 32, cost -64.0939853001
Pre-training layer 2, epoch 33, cost -64.0156488609
Pre-training layer 2, epoch 34, cost -63.9284863091
Pre-training layer 2, epoch 35, cost -63.7874668884
Pre-training layer 2, epoch 35, representative training free energy 10025.3696035
Pre-training layer 2, epoch 35, validation free energy 9930.76583008
Pre-training layer 2, epoch 36, cost -63.7663715935
Pre-training layer 2, epoch 37, cost -63.6223872662
Pre-training layer 2, epoch 38, cost -63.5997966862
Pre-training layer 2, epoch 39, cost -63.4158064365
Pre-training layer 2, epoch 40, cost -63.3562581158
Pre-training layer 2, epoch 40, representative training free energy 10417.7134219
Pre-training layer 2, epoch 40, validation free energy 10318.2355359
Pre-training layer 2, epoch 41, cost -63.363646698
Pre-training layer 2, epoch 42, cost -63.2368714333
Pre-training layer 2, epoch 43, cost -63.1426597595
Pre-training layer 2, epoch 44, cost -63.0657266998
Pre-training layer 2, epoch 45, cost -63.0005560303
Pre-training layer 2, epoch 45, representative training free energy 10774.4758186
Pre-training layer 2, epoch 45, validation free energy 10672.649519
Pre-training layer 2, epoch 46, cost -62.9963038731
Pre-training layer 2, epoch 47, cost -62.9254868317
Pre-training layer 2, epoch 48, cost -62.9056483746
Pre-training layer 2, epoch 49, cost -62.8213800526
Pre-training layer 2, epoch 50, cost -62.7595968246
Pre-training layer 2, epoch 50, representative training free energy 11152.846417
Pre-training layer 2, epoch 50, validation free energy 11047.3013115
Pre-training layer 2, epoch 51, cost -62.6627713013
Pre-training layer 2, epoch 52, cost -62.6188706779
Pre-training layer 2, epoch 53, cost -62.5905804443
Pre-training layer 2, epoch 54, cost -62.5377669907
Pre-training layer 2, epoch 55, cost -62.5557964516
Pre-training layer 2, epoch 55, representative training free energy 11517.6104001
Pre-training layer 2, epoch 55, validation free energy 11411.1678862
Pre-training layer 2, epoch 56, cost -62.4545117378
Pre-training layer 2, epoch 57, cost -62.4485581589
Pre-training layer 2, epoch 58, cost -62.3702142429
Pre-training layer 2, epoch 59, cost -62.309505415
Pre-training layer 2, epoch 60, cost -62.2866078281
Pre-training layer 2, epoch 60, representative training free energy 11836.9731648
Pre-training layer 2, epoch 60, validation free energy 11730.6379778
Pre-training layer 2, epoch 61, cost -62.1986033344
Pre-training layer 2, epoch 62, cost -62.2405209064
Pre-training layer 2, epoch 63, cost -62.1160072327
Pre-training layer 2, epoch 64, cost -62.2151438141
Pre-training layer 2, epoch 65, cost -62.0992575359
Pre-training layer 2, epoch 65, representative training free energy 12155.8385208
Pre-training layer 2, epoch 65, validation free energy 12049.3282061
Pre-training layer 2, epoch 66, cost -62.0310091114
Pre-training layer 2, epoch 67, cost -62.0805260754
Pre-training layer 2, epoch 68, cost -62.0440804005
Pre-training layer 2, epoch 69, cost -62.0113451004
Pre-training layer 2, epoch 70, cost -61.9475708199
Pre-training layer 2, epoch 70, representative training free energy 12437.8838989
Pre-training layer 2, epoch 70, validation free energy 12324.6251152
Pre-training layer 2, epoch 71, cost -61.8946079636
Pre-training layer 2, epoch 72, cost -61.8292543125
Pre-training layer 2, epoch 73, cost -61.8270536709
Pre-training layer 2, epoch 74, cost -61.8396854591
Pre-training layer 2, epoch 75, cost -61.7361339378
Pre-training layer 2, epoch 75, representative training free energy 12765.7887952
Pre-training layer 2, epoch 75, validation free energy 12651.1649146
Pre-training layer 2, epoch 76, cost -61.7550925446
Pre-training layer 2, epoch 77, cost -61.6951242828
Pre-training layer 2, epoch 78, cost -61.6729273224
Pre-training layer 2, epoch 79, cost -61.6252997589
Pre-training layer 2, epoch 80, cost -61.6342182064
Pre-training layer 2, epoch 80, representative training free energy 13064.5925659
Pre-training layer 2, epoch 80, validation free energy 12947.4373521
Pre-training layer 2, epoch 81, cost -61.6755232143
Pre-training layer 2, epoch 82, cost -61.5935134602
Pre-training layer 2, epoch 83, cost -61.5597995472
Pre-training layer 2, epoch 84, cost -61.5598397923
Pre-training layer 2, epoch 85, cost -61.5330711365
Pre-training layer 2, epoch 85, representative training free energy 13290.8723184
Pre-training layer 2, epoch 85, validation free energy 13172.6449526
Pre-training layer 2, epoch 86, cost -61.5390060902
Pre-training layer 2, epoch 87, cost -61.4735649586
Pre-training layer 2, epoch 88, cost -61.4920521164
Pre-training layer 2, epoch 89, cost -61.4574486828
Pre-training layer 2, epoch 90, cost -61.4075141335
Pre-training layer 2, epoch 90, representative training free energy 13584.4821113
Pre-training layer 2, epoch 90, validation free energy 13463.7594766
Pre-training layer 2, epoch 91, cost -61.4034574699
Pre-training layer 2, epoch 92, cost -61.3219129944
Pre-training layer 2, epoch 93, cost -61.2726110649
Pre-training layer 2, epoch 94, cost -61.3279726791
Pre-training layer 2, epoch 95, cost -61.3496005249
Pre-training layer 2, epoch 95, representative training free energy 13839.3542314
Pre-training layer 2, epoch 95, validation free energy 13716.3041538
Pre-training layer 2, epoch 96, cost -61.2889837742
Pre-training layer 2, epoch 97, cost -61.3331494331
Pre-training layer 2, epoch 98, cost -61.3251474476
Pre-training layer 2, epoch 99, cost -61.1954255867
The pretraining code for file dbn_loop.pyc ran for 10.56m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 35.700000 %
     epoch 1, minibatch 400/400, test error of best model 30.500000 %
epoch 2, minibatch 400/400, validation error 25.200000 %
     epoch 2, minibatch 400/400, test error of best model 17.500000 %
epoch 3, minibatch 400/400, validation error 23.000000 %
     epoch 3, minibatch 400/400, test error of best model 13.200000 %
epoch 4, minibatch 400/400, validation error 20.900000 %
     epoch 4, minibatch 400/400, test error of best model 11.700000 %
epoch 5, minibatch 400/400, validation error 19.500000 %
     epoch 5, minibatch 400/400, test error of best model 9.900000 %
epoch 6, minibatch 400/400, validation error 18.900000 %
     epoch 6, minibatch 400/400, test error of best model 9.400000 %
epoch 7, minibatch 400/400, validation error 18.400000 %
     epoch 7, minibatch 400/400, test error of best model 8.900000 %
epoch 8, minibatch 400/400, validation error 17.800000 %
     epoch 8, minibatch 400/400, test error of best model 8.500000 %
epoch 9, minibatch 400/400, validation error 17.100000 %
     epoch 9, minibatch 400/400, test error of best model 8.200000 %
epoch 10, minibatch 400/400, validation error 16.800000 %
     epoch 10, minibatch 400/400, test error of best model 7.400000 %
epoch 11, minibatch 400/400, validation error 16.500000 %
     epoch 11, minibatch 400/400, test error of best model 7.000000 %
epoch 12, minibatch 400/400, validation error 16.200000 %
     epoch 12, minibatch 400/400, test error of best model 7.000000 %
epoch 13, minibatch 400/400, validation error 15.900000 %
     epoch 13, minibatch 400/400, test error of best model 6.900000 %
epoch 14, minibatch 400/400, validation error 15.900000 %
epoch 15, minibatch 400/400, validation error 15.800000 %
     epoch 15, minibatch 400/400, test error of best model 6.600000 %
epoch 16, minibatch 400/400, validation error 15.700000 %
     epoch 16, minibatch 400/400, test error of best model 6.500000 %
epoch 17, minibatch 400/400, validation error 15.500000 %
     epoch 17, minibatch 400/400, test error of best model 6.400000 %
epoch 18, minibatch 400/400, validation error 15.500000 %
epoch 19, minibatch 400/400, validation error 15.400000 %
     epoch 19, minibatch 400/400, test error of best model 6.100000 %
epoch 20, minibatch 400/400, validation error 15.400000 %
epoch 21, minibatch 400/400, validation error 15.300000 %
     epoch 21, minibatch 400/400, test error of best model 6.000000 %
epoch 22, minibatch 400/400, validation error 15.000000 %
     epoch 22, minibatch 400/400, test error of best model 6.300000 %
epoch 23, minibatch 400/400, validation error 15.000000 %
epoch 24, minibatch 400/400, validation error 14.900000 %
     epoch 24, minibatch 400/400, test error of best model 6.200000 %
epoch 25, minibatch 400/400, validation error 15.100000 %
epoch 26, minibatch 400/400, validation error 15.100000 %
epoch 27, minibatch 400/400, validation error 15.000000 %
epoch 28, minibatch 400/400, validation error 15.000000 %
epoch 29, minibatch 400/400, validation error 14.900000 %
epoch 30, minibatch 400/400, validation error 14.900000 %
epoch 31, minibatch 400/400, validation error 14.900000 %
epoch 32, minibatch 400/400, validation error 14.900000 %
epoch 33, minibatch 400/400, validation error 14.800000 %
     epoch 33, minibatch 400/400, test error of best model 6.200000 %
epoch 34, minibatch 400/400, validation error 14.800000 %
epoch 35, minibatch 400/400, validation error 14.800000 %
epoch 36, minibatch 400/400, validation error 14.800000 %
epoch 37, minibatch 400/400, validation error 14.800000 %
epoch 38, minibatch 400/400, validation error 14.800000 %
epoch 39, minibatch 400/400, validation error 14.800000 %
epoch 40, minibatch 400/400, validation error 14.800000 %
epoch 41, minibatch 400/400, validation error 14.600000 %
     epoch 41, minibatch 400/400, test error of best model 5.900000 %
epoch 42, minibatch 400/400, validation error 14.600000 %
epoch 43, minibatch 400/400, validation error 14.600000 %
epoch 44, minibatch 400/400, validation error 14.600000 %
epoch 45, minibatch 400/400, validation error 14.500000 %
     epoch 45, minibatch 400/400, test error of best model 5.600000 %
epoch 46, minibatch 400/400, validation error 14.400000 %
     epoch 46, minibatch 400/400, test error of best model 5.600000 %
epoch 47, minibatch 400/400, validation error 14.500000 %
epoch 48, minibatch 400/400, validation error 14.500000 %
epoch 49, minibatch 400/400, validation error 14.500000 %
epoch 50, minibatch 400/400, validation error 14.600000 %
epoch 51, minibatch 400/400, validation error 14.600000 %
epoch 52, minibatch 400/400, validation error 14.600000 %
epoch 53, minibatch 400/400, validation error 14.600000 %
epoch 54, minibatch 400/400, validation error 14.600000 %
epoch 55, minibatch 400/400, validation error 14.600000 %
epoch 56, minibatch 400/400, validation error 14.600000 %
epoch 57, minibatch 400/400, validation error 14.700000 %
epoch 58, minibatch 400/400, validation error 14.700000 %
epoch 59, minibatch 400/400, validation error 14.700000 %
epoch 60, minibatch 400/400, validation error 14.700000 %
epoch 61, minibatch 400/400, validation error 14.700000 %
epoch 62, minibatch 400/400, validation error 14.700000 %
epoch 63, minibatch 400/400, validation error 14.800000 %
epoch 64, minibatch 400/400, validation error 14.800000 %
epoch 65, minibatch 400/400, validation error 14.800000 %
epoch 66, minibatch 400/400, validation error 14.800000 %
epoch 67, minibatch 400/400, validation error 14.700000 %
epoch 68, minibatch 400/400, validation error 14.700000 %
epoch 69, minibatch 400/400, validation error 14.700000 %
epoch 70, minibatch 400/400, validation error 14.700000 %
epoch 71, minibatch 400/400, validation error 14.700000 %
epoch 72, minibatch 400/400, validation error 14.700000 %
epoch 73, minibatch 400/400, validation error 14.700000 %
epoch 74, minibatch 400/400, validation error 14.700000 %
epoch 75, minibatch 400/400, validation error 14.700000 %
epoch 76, minibatch 400/400, validation error 14.700000 %
epoch 77, minibatch 400/400, validation error 14.700000 %
epoch 78, minibatch 400/400, validation error 14.700000 %
epoch 79, minibatch 400/400, validation error 14.700000 %
epoch 80, minibatch 400/400, validation error 14.700000 %
epoch 81, minibatch 400/400, validation error 14.700000 %
epoch 82, minibatch 400/400, validation error 14.700000 %
epoch 83, minibatch 400/400, validation error 14.700000 %
epoch 84, minibatch 400/400, validation error 14.700000 %
epoch 85, minibatch 400/400, validation error 14.700000 %
epoch 86, minibatch 400/400, validation error 14.700000 %
epoch 87, minibatch 400/400, validation error 14.700000 %
epoch 88, minibatch 400/400, validation error 14.700000 %
epoch 89, minibatch 400/400, validation error 14.700000 %
epoch 90, minibatch 400/400, validation error 14.700000 %
epoch 91, minibatch 400/400, validation error 14.700000 %
Optimization complete with best validation score of 14.400000 %, obtained at iteration 18400, with test performance 5.600000 %
The fine tuning code for file dbn_loop.pyc ran for 3.13m


==========Sample: (5000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.587157776
Pre-training layer 0, epoch 0, representative training free energy -547.178575287
Pre-training layer 0, epoch 0, validation free energy -542.839948547
Pre-training layer 0, epoch 1, cost -108.767885345
Pre-training layer 0, epoch 2, cost -100.982400314
Pre-training layer 0, epoch 3, cost -96.3476418762
Pre-training layer 0, epoch 4, cost -93.4896813354
Pre-training layer 0, epoch 5, cost -91.2345544434
Pre-training layer 0, epoch 5, representative training free energy -487.469539948
Pre-training layer 0, epoch 5, validation free energy -482.286292542
Pre-training layer 0, epoch 6, cost -89.6349271088
Pre-training layer 0, epoch 7, cost -88.3153222351
Pre-training layer 0, epoch 8, cost -87.0135412598
Pre-training layer 0, epoch 9, cost -86.1445406876
Pre-training layer 0, epoch 10, cost -85.2961248016
Pre-training layer 0, epoch 10, representative training free energy -467.957546783
Pre-training layer 0, epoch 10, validation free energy -462.41800354
Pre-training layer 0, epoch 11, cost -84.5597535248
Pre-training layer 0, epoch 12, cost -83.8919383011
Pre-training layer 0, epoch 13, cost -83.2760319061
Pre-training layer 0, epoch 14, cost -82.833014801
Pre-training layer 0, epoch 15, cost -82.3824735184
Pre-training layer 0, epoch 15, representative training free energy -452.528540039
Pre-training layer 0, epoch 15, validation free energy -447.135102478
Pre-training layer 0, epoch 16, cost -81.9310754776
Pre-training layer 0, epoch 17, cost -81.5595027237
Pre-training layer 0, epoch 18, cost -81.1699000778
Pre-training layer 0, epoch 19, cost -80.7976148987
Pre-training layer 0, epoch 20, cost -80.3882030182
Pre-training layer 0, epoch 20, representative training free energy -447.207298676
Pre-training layer 0, epoch 20, validation free energy -440.369764404
Pre-training layer 0, epoch 21, cost -80.3301453476
Pre-training layer 0, epoch 22, cost -80.0289974365
Pre-training layer 0, epoch 23, cost -79.6416302185
Pre-training layer 0, epoch 24, cost -79.4070727234
Pre-training layer 0, epoch 25, cost -79.0634747467
Pre-training layer 0, epoch 25, representative training free energy -442.22654483
Pre-training layer 0, epoch 25, validation free energy -435.248602173
Pre-training layer 0, epoch 26, cost -79.0382143555
Pre-training layer 0, epoch 27, cost -78.8918438416
Pre-training layer 0, epoch 28, cost -78.6047470245
Pre-training layer 0, epoch 29, cost -78.4189417343
Pre-training layer 0, epoch 30, cost -78.2168327179
Pre-training layer 0, epoch 30, representative training free energy -440.415955292
Pre-training layer 0, epoch 30, validation free energy -433.380337585
Pre-training layer 0, epoch 31, cost -78.0889089584
Pre-training layer 0, epoch 32, cost -77.9004040451
Pre-training layer 0, epoch 33, cost -77.7208786011
Pre-training layer 0, epoch 34, cost -77.5165716553
Pre-training layer 0, epoch 35, cost -77.3025205765
Pre-training layer 0, epoch 35, representative training free energy -435.629858337
Pre-training layer 0, epoch 35, validation free energy -428.662878815
Pre-training layer 0, epoch 36, cost -77.317020134
Pre-training layer 0, epoch 37, cost -77.1480770493
Pre-training layer 0, epoch 38, cost -77.0546383972
Pre-training layer 0, epoch 39, cost -76.8920436783
Pre-training layer 0, epoch 40, cost -76.7645635452
Pre-training layer 0, epoch 40, representative training free energy -433.5259823
Pre-training layer 0, epoch 40, validation free energy -426.986261169
Pre-training layer 0, epoch 41, cost -76.6398747787
Pre-training layer 0, epoch 42, cost -76.4690983734
Pre-training layer 0, epoch 43, cost -76.3341377182
Pre-training layer 0, epoch 44, cost -76.2411968079
Pre-training layer 0, epoch 45, cost -76.1758513107
Pre-training layer 0, epoch 45, representative training free energy -434.35474057
Pre-training layer 0, epoch 45, validation free energy -427.06355545
Pre-training layer 0, epoch 46, cost -76.0017966537
Pre-training layer 0, epoch 47, cost -75.8739093704
Pre-training layer 0, epoch 48, cost -75.8762796555
Pre-training layer 0, epoch 49, cost -75.735589653
Pre-training layer 0, epoch 50, cost -75.7537911835
Pre-training layer 0, epoch 50, representative training free energy -430.801118835
Pre-training layer 0, epoch 50, validation free energy -423.264711792
Pre-training layer 0, epoch 51, cost -75.5872938919
Pre-training layer 0, epoch 52, cost -75.4022606735
Pre-training layer 0, epoch 53, cost -75.3594642487
Pre-training layer 0, epoch 54, cost -75.2324222412
Pre-training layer 0, epoch 55, cost -75.1914743881
Pre-training layer 0, epoch 55, representative training free energy -428.349296875
Pre-training layer 0, epoch 55, validation free energy -420.587790222
Pre-training layer 0, epoch 56, cost -75.1290911102
Pre-training layer 0, epoch 57, cost -75.097139801
Pre-training layer 0, epoch 58, cost -74.9929854279
Pre-training layer 0, epoch 59, cost -74.9307788467
Pre-training layer 0, epoch 60, cost -74.7353063354
Pre-training layer 0, epoch 60, representative training free energy -430.753256012
Pre-training layer 0, epoch 60, validation free energy -423.380688263
Pre-training layer 0, epoch 61, cost -74.7413613205
Pre-training layer 0, epoch 62, cost -74.7129852219
Pre-training layer 0, epoch 63, cost -74.6247901001
Pre-training layer 0, epoch 64, cost -74.3900211639
Pre-training layer 0, epoch 65, cost -74.4510111771
Pre-training layer 0, epoch 65, representative training free energy -429.23431543
Pre-training layer 0, epoch 65, validation free energy -421.350646484
Pre-training layer 0, epoch 66, cost -74.4864304047
Pre-training layer 0, epoch 67, cost -74.3193854752
Pre-training layer 0, epoch 68, cost -74.2087475586
Pre-training layer 0, epoch 69, cost -74.2209919968
Pre-training layer 0, epoch 70, cost -74.1377623062
Pre-training layer 0, epoch 70, representative training free energy -424.662839264
Pre-training layer 0, epoch 70, validation free energy -416.397378021
Pre-training layer 0, epoch 71, cost -74.0829103012
Pre-training layer 0, epoch 72, cost -74.0694682159
Pre-training layer 0, epoch 73, cost -73.8580930099
Pre-training layer 0, epoch 74, cost -73.9260654984
Pre-training layer 0, epoch 75, cost -73.7656166077
Pre-training layer 0, epoch 75, representative training free energy -423.538433411
Pre-training layer 0, epoch 75, validation free energy -414.614803955
Pre-training layer 0, epoch 76, cost -73.7821998825
Pre-training layer 0, epoch 77, cost -73.7749221649
Pre-training layer 0, epoch 78, cost -73.7559262848
Pre-training layer 0, epoch 79, cost -73.5442187347
Pre-training layer 0, epoch 80, cost -73.537931694
Pre-training layer 0, epoch 80, representative training free energy -420.636864563
Pre-training layer 0, epoch 80, validation free energy -412.232146851
Pre-training layer 0, epoch 81, cost -73.5611861496
Pre-training layer 0, epoch 82, cost -73.4977558136
Pre-training layer 0, epoch 83, cost -73.4658724899
Pre-training layer 0, epoch 84, cost -73.449458992
Pre-training layer 0, epoch 85, cost -73.2285743942
Pre-training layer 0, epoch 85, representative training free energy -422.885020355
Pre-training layer 0, epoch 85, validation free energy -414.410873047
Pre-training layer 0, epoch 86, cost -73.3217219391
Pre-training layer 0, epoch 87, cost -73.2209909058
Pre-training layer 0, epoch 88, cost -73.0843064041
Pre-training layer 0, epoch 89, cost -73.0785268707
Pre-training layer 0, epoch 90, cost -73.0032876816
Pre-training layer 0, epoch 90, representative training free energy -420.472659546
Pre-training layer 0, epoch 90, validation free energy -411.901507874
Pre-training layer 0, epoch 91, cost -73.0850018463
Pre-training layer 0, epoch 92, cost -73.0163100586
Pre-training layer 0, epoch 93, cost -72.9568086166
Pre-training layer 0, epoch 94, cost -72.8268859711
Pre-training layer 0, epoch 95, cost -72.7894579391
Pre-training layer 0, epoch 95, representative training free energy -419.511327209
Pre-training layer 0, epoch 95, validation free energy -410.962316315
Pre-training layer 0, epoch 96, cost -72.7378711548
Pre-training layer 0, epoch 97, cost -72.7595097656
Pre-training layer 0, epoch 98, cost -72.7414160156
Pre-training layer 0, epoch 99, cost -72.6161292114
Pre-training layer 1, epoch 0, cost -311.771158051
Pre-training layer 1, epoch 0, representative training free energy -62072.0469453
Pre-training layer 1, epoch 0, validation free energy -61652.0528965
Pre-training layer 1, epoch 1, cost -267.90554541
Pre-training layer 1, epoch 2, cost -254.44713269
Pre-training layer 1, epoch 3, cost -246.665512848
Pre-training layer 1, epoch 4, cost -241.439297272
Pre-training layer 1, epoch 5, cost -237.683505646
Pre-training layer 1, epoch 5, representative training free energy -82494.9254102
Pre-training layer 1, epoch 5, validation free energy -81800.8685664
Pre-training layer 1, epoch 6, cost -234.823555084
Pre-training layer 1, epoch 7, cost -232.374735809
Pre-training layer 1, epoch 8, cost -230.489650055
Pre-training layer 1, epoch 9, cost -228.930007385
Pre-training layer 1, epoch 10, cost -227.583397339
Pre-training layer 1, epoch 10, representative training free energy -88588.7244336
Pre-training layer 1, epoch 10, validation free energy -87815.3752617
Pre-training layer 1, epoch 11, cost -226.421661743
Pre-training layer 1, epoch 12, cost -225.436363892
Pre-training layer 1, epoch 13, cost -224.464395447
Pre-training layer 1, epoch 14, cost -223.593347809
Pre-training layer 1, epoch 15, cost -223.019386444
Pre-training layer 1, epoch 15, representative training free energy -92406.6623301
Pre-training layer 1, epoch 15, validation free energy -91606.6122422
Pre-training layer 1, epoch 16, cost -222.273284454
Pre-training layer 1, epoch 17, cost -221.653436188
Pre-training layer 1, epoch 18, cost -221.140696045
Pre-training layer 1, epoch 19, cost -220.591994629
Pre-training layer 1, epoch 20, cost -220.201019531
Pre-training layer 1, epoch 20, representative training free energy -95030.3445781
Pre-training layer 1, epoch 20, validation free energy -94179.3427109
Pre-training layer 1, epoch 21, cost -219.67487912
Pre-training layer 1, epoch 22, cost -219.28716156
Pre-training layer 1, epoch 23, cost -218.851504852
Pre-training layer 1, epoch 24, cost -218.552569916
Pre-training layer 1, epoch 25, cost -218.227038269
Pre-training layer 1, epoch 25, representative training free energy -97186.2396973
Pre-training layer 1, epoch 25, validation free energy -96318.9606641
Pre-training layer 1, epoch 26, cost -217.893698486
Pre-training layer 1, epoch 27, cost -217.518022064
Pre-training layer 1, epoch 28, cost -217.434835083
Pre-training layer 1, epoch 29, cost -216.970195557
Pre-training layer 1, epoch 30, cost -216.717058533
Pre-training layer 1, epoch 30, representative training free energy -98900.950627
Pre-training layer 1, epoch 30, validation free energy -98011.6108008
Pre-training layer 1, epoch 31, cost -216.50098526
Pre-training layer 1, epoch 32, cost -216.323632996
Pre-training layer 1, epoch 33, cost -216.030536194
Pre-training layer 1, epoch 34, cost -215.819035522
Pre-training layer 1, epoch 35, cost -215.643546844
Pre-training layer 1, epoch 35, representative training free energy -100405.154777
Pre-training layer 1, epoch 35, validation free energy -99487.7492305
Pre-training layer 1, epoch 36, cost -215.441279724
Pre-training layer 1, epoch 37, cost -215.250407349
Pre-training layer 1, epoch 38, cost -215.006234222
Pre-training layer 1, epoch 39, cost -214.874715729
Pre-training layer 1, epoch 40, cost -214.650324768
Pre-training layer 1, epoch 40, representative training free energy -101647.456389
Pre-training layer 1, epoch 40, validation free energy -100726.597961
Pre-training layer 1, epoch 41, cost -214.600314972
Pre-training layer 1, epoch 42, cost -214.365648346
Pre-training layer 1, epoch 43, cost -214.224372498
Pre-training layer 1, epoch 44, cost -214.001262512
Pre-training layer 1, epoch 45, cost -213.983012115
Pre-training layer 1, epoch 45, representative training free energy -102788.472912
Pre-training layer 1, epoch 45, validation free energy -101844.379988
Pre-training layer 1, epoch 46, cost -213.790304932
Pre-training layer 1, epoch 47, cost -213.652578857
Pre-training layer 1, epoch 48, cost -213.535325562
Pre-training layer 1, epoch 49, cost -213.274498596
Pre-training layer 1, epoch 50, cost -213.301521729
Pre-training layer 1, epoch 50, representative training free energy -103886.559242
Pre-training layer 1, epoch 50, validation free energy -102943.66798
Pre-training layer 1, epoch 51, cost -213.146946686
Pre-training layer 1, epoch 52, cost -213.062668427
Pre-training layer 1, epoch 53, cost -212.887076141
Pre-training layer 1, epoch 54, cost -212.81123111
Pre-training layer 1, epoch 55, cost -212.617364838
Pre-training layer 1, epoch 55, representative training free energy -104871.089781
Pre-training layer 1, epoch 55, validation free energy -103914.863977
Pre-training layer 1, epoch 56, cost -212.571222992
Pre-training layer 1, epoch 57, cost -212.476158478
Pre-training layer 1, epoch 58, cost -212.3865625
Pre-training layer 1, epoch 59, cost -212.281317963
Pre-training layer 1, epoch 60, cost -212.192236389
Pre-training layer 1, epoch 60, representative training free energy -105881.217387
Pre-training layer 1, epoch 60, validation free energy -104915.654465
Pre-training layer 1, epoch 61, cost -212.066652374
Pre-training layer 1, epoch 62, cost -211.997184479
Pre-training layer 1, epoch 63, cost -211.86774295
Pre-training layer 1, epoch 64, cost -211.807307617
Pre-training layer 1, epoch 65, cost -211.756832489
Pre-training layer 1, epoch 65, representative training free energy -106694.70452
Pre-training layer 1, epoch 65, validation free energy -105712.420684
Pre-training layer 1, epoch 66, cost -211.706600098
Pre-training layer 1, epoch 67, cost -211.629317993
Pre-training layer 1, epoch 68, cost -211.473533569
Pre-training layer 1, epoch 69, cost -211.408296051
Pre-training layer 1, epoch 70, cost -211.359141266
Pre-training layer 1, epoch 70, representative training free energy -107580.843426
Pre-training layer 1, epoch 70, validation free energy -106594.01632
Pre-training layer 1, epoch 71, cost -211.299627655
Pre-training layer 1, epoch 72, cost -211.21837674
Pre-training layer 1, epoch 73, cost -211.14567804
Pre-training layer 1, epoch 74, cost -211.140399139
Pre-training layer 1, epoch 75, cost -211.075512573
Pre-training layer 1, epoch 75, representative training free energy -108159.598578
Pre-training layer 1, epoch 75, validation free energy -107163.402164
Pre-training layer 1, epoch 76, cost -210.920511963
Pre-training layer 1, epoch 77, cost -210.933965759
Pre-training layer 1, epoch 78, cost -210.841143127
Pre-training layer 1, epoch 79, cost -210.706631531
Pre-training layer 1, epoch 80, cost -210.731178894
Pre-training layer 1, epoch 80, representative training free energy -108908.240879
Pre-training layer 1, epoch 80, validation free energy -107910.165191
Pre-training layer 1, epoch 81, cost -210.673102356
Pre-training layer 1, epoch 82, cost -210.532606079
Pre-training layer 1, epoch 83, cost -210.479675293
Pre-training layer 1, epoch 84, cost -210.501942474
Pre-training layer 1, epoch 85, cost -210.404104156
Pre-training layer 1, epoch 85, representative training free energy -109623.715336
Pre-training layer 1, epoch 85, validation free energy -108614.580516
Pre-training layer 1, epoch 86, cost -210.339958557
Pre-training layer 1, epoch 87, cost -210.309637817
Pre-training layer 1, epoch 88, cost -210.273811127
Pre-training layer 1, epoch 89, cost -210.154956177
Pre-training layer 1, epoch 90, cost -210.158424561
Pre-training layer 1, epoch 90, representative training free energy -110345.045887
Pre-training layer 1, epoch 90, validation free energy -109321.865992
Pre-training layer 1, epoch 91, cost -210.11212204
Pre-training layer 1, epoch 92, cost -210.001703888
Pre-training layer 1, epoch 93, cost -209.94823114
Pre-training layer 1, epoch 94, cost -209.900858093
Pre-training layer 1, epoch 95, cost -209.917303894
Pre-training layer 1, epoch 95, representative training free energy -110933.922602
Pre-training layer 1, epoch 95, validation free energy -109895.95166
Pre-training layer 1, epoch 96, cost -209.81797348
Pre-training layer 1, epoch 97, cost -209.789463837
Pre-training layer 1, epoch 98, cost -209.746535828
Pre-training layer 1, epoch 99, cost -209.709761292
Pre-training layer 2, epoch 0, cost -112.965240112
Pre-training layer 2, epoch 0, representative training free energy 4259.85262988
Pre-training layer 2, epoch 0, validation free energy 4204.56075635
Pre-training layer 2, epoch 1, cost -85.1261911545
Pre-training layer 2, epoch 2, cost -78.9409597931
Pre-training layer 2, epoch 3, cost -75.4203259583
Pre-training layer 2, epoch 4, cost -73.2166878967
Pre-training layer 2, epoch 5, cost -71.513451622
Pre-training layer 2, epoch 5, representative training free energy 6654.65594067
Pre-training layer 2, epoch 5, validation free energy 6576.72972461
Pre-training layer 2, epoch 6, cost -70.2456652451
Pre-training layer 2, epoch 7, cost -69.2664852371
Pre-training layer 2, epoch 8, cost -68.3551595993
Pre-training layer 2, epoch 9, cost -67.6931313782
Pre-training layer 2, epoch 10, cost -67.0094958267
Pre-training layer 2, epoch 10, representative training free energy 7979.21085059
Pre-training layer 2, epoch 10, validation free energy 7905.3035835
Pre-training layer 2, epoch 11, cost -66.4838101044
Pre-training layer 2, epoch 12, cost -65.9032133026
Pre-training layer 2, epoch 13, cost -65.5449572144
Pre-training layer 2, epoch 14, cost -65.2578272171
Pre-training layer 2, epoch 15, cost -64.8341234665
Pre-training layer 2, epoch 15, representative training free energy 8866.29289941
Pre-training layer 2, epoch 15, validation free energy 8793.86446655
Pre-training layer 2, epoch 16, cost -64.5608527985
Pre-training layer 2, epoch 17, cost -64.2889001541
Pre-training layer 2, epoch 18, cost -64.0283179626
Pre-training layer 2, epoch 19, cost -63.8394593048
Pre-training layer 2, epoch 20, cost -63.6756542511
Pre-training layer 2, epoch 20, representative training free energy 9642.83702563
Pre-training layer 2, epoch 20, validation free energy 9574.65866919
Pre-training layer 2, epoch 21, cost -63.4026413498
Pre-training layer 2, epoch 22, cost -63.2241854935
Pre-training layer 2, epoch 23, cost -63.0397895508
Pre-training layer 2, epoch 24, cost -62.8777292557
Pre-training layer 2, epoch 25, cost -62.7093887253
Pre-training layer 2, epoch 25, representative training free energy 10301.1357583
Pre-training layer 2, epoch 25, validation free energy 10224.9379648
Pre-training layer 2, epoch 26, cost -62.6450707703
Pre-training layer 2, epoch 27, cost -62.4685799179
Pre-training layer 2, epoch 28, cost -62.3526666489
Pre-training layer 2, epoch 29, cost -62.2199819565
Pre-training layer 2, epoch 30, cost -62.0981515198
Pre-training layer 2, epoch 30, representative training free energy 10857.3186614
Pre-training layer 2, epoch 30, validation free energy 10780.0338005
Pre-training layer 2, epoch 31, cost -62.0018315201
Pre-training layer 2, epoch 32, cost -61.7911034088
Pre-training layer 2, epoch 33, cost -61.7677120743
Pre-training layer 2, epoch 34, cost -61.7432420578
Pre-training layer 2, epoch 35, cost -61.5433817825
Pre-training layer 2, epoch 35, representative training free energy 11391.1609485
Pre-training layer 2, epoch 35, validation free energy 11303.6352065
Pre-training layer 2, epoch 36, cost -61.4876586075
Pre-training layer 2, epoch 37, cost -61.5111547318
Pre-training layer 2, epoch 38, cost -61.5013458557
Pre-training layer 2, epoch 39, cost -61.3528302383
Pre-training layer 2, epoch 40, cost -61.2888410339
Pre-training layer 2, epoch 40, representative training free energy 11871.3455083
Pre-training layer 2, epoch 40, validation free energy 11779.5001948
Pre-training layer 2, epoch 41, cost -61.1391311188
Pre-training layer 2, epoch 42, cost -61.1099713058
Pre-training layer 2, epoch 43, cost -61.033913681
Pre-training layer 2, epoch 44, cost -60.9629731979
Pre-training layer 2, epoch 45, cost -60.9831249619
Pre-training layer 2, epoch 45, representative training free energy 12317.2295281
Pre-training layer 2, epoch 45, validation free energy 12219.5217197
Pre-training layer 2, epoch 46, cost -60.8366186371
Pre-training layer 2, epoch 47, cost -60.7977588806
Pre-training layer 2, epoch 48, cost -60.7504484329
Pre-training layer 2, epoch 49, cost -60.6730459824
Pre-training layer 2, epoch 50, cost -60.6773545761
Pre-training layer 2, epoch 50, representative training free energy 12743.7912578
Pre-training layer 2, epoch 50, validation free energy 12647.0817437
Pre-training layer 2, epoch 51, cost -60.6467585526
Pre-training layer 2, epoch 52, cost -60.4923864899
Pre-training layer 2, epoch 53, cost -60.5122240219
Pre-training layer 2, epoch 54, cost -60.4995233154
Pre-training layer 2, epoch 55, cost -60.3746419601
Pre-training layer 2, epoch 55, representative training free energy 13139.3224209
Pre-training layer 2, epoch 55, validation free energy 13036.128104
Pre-training layer 2, epoch 56, cost -60.3840686188
Pre-training layer 2, epoch 57, cost -60.4106313019
Pre-training layer 2, epoch 58, cost -60.2225384903
Pre-training layer 2, epoch 59, cost -60.2365478745
Pre-training layer 2, epoch 60, cost -60.157768692
Pre-training layer 2, epoch 60, representative training free energy 13490.8271162
Pre-training layer 2, epoch 60, validation free energy 13389.4982334
Pre-training layer 2, epoch 61, cost -60.0633391037
Pre-training layer 2, epoch 62, cost -60.1382646561
Pre-training layer 2, epoch 63, cost -60.0588531036
Pre-training layer 2, epoch 64, cost -60.0679172897
Pre-training layer 2, epoch 65, cost -60.0628232727
Pre-training layer 2, epoch 65, representative training free energy 13838.9124229
Pre-training layer 2, epoch 65, validation free energy 13728.1633931
Pre-training layer 2, epoch 66, cost -59.9961600266
Pre-training layer 2, epoch 67, cost -59.9157955399
Pre-training layer 2, epoch 68, cost -59.9365147171
Pre-training layer 2, epoch 69, cost -59.835383316
Pre-training layer 2, epoch 70, cost -59.8185398865
Pre-training layer 2, epoch 70, representative training free energy 14167.0112534
Pre-training layer 2, epoch 70, validation free energy 14056.9080903
Pre-training layer 2, epoch 71, cost -59.8808376923
Pre-training layer 2, epoch 72, cost -59.7874066086
Pre-training layer 2, epoch 73, cost -59.7742396011
Pre-training layer 2, epoch 74, cost -59.7527549744
Pre-training layer 2, epoch 75, cost -59.7085684052
Pre-training layer 2, epoch 75, representative training free energy 14461.8992354
Pre-training layer 2, epoch 75, validation free energy 14342.6429766
Pre-training layer 2, epoch 76, cost -59.7424452362
Pre-training layer 2, epoch 77, cost -59.7031353912
Pre-training layer 2, epoch 78, cost -59.7117571487
Pre-training layer 2, epoch 79, cost -59.6412747345
Pre-training layer 2, epoch 80, cost -59.6221974106
Pre-training layer 2, epoch 80, representative training free energy 14820.790252
Pre-training layer 2, epoch 80, validation free energy 14696.6977505
Pre-training layer 2, epoch 81, cost -59.578269928
Pre-training layer 2, epoch 82, cost -59.5471319733
Pre-training layer 2, epoch 83, cost -59.5174929047
Pre-training layer 2, epoch 84, cost -59.5241863022
Pre-training layer 2, epoch 85, cost -59.5055773926
Pre-training layer 2, epoch 85, representative training free energy 15120.8074629
Pre-training layer 2, epoch 85, validation free energy 14991.0851826
Pre-training layer 2, epoch 86, cost -59.3801626587
Pre-training layer 2, epoch 87, cost -59.442223793
Pre-training layer 2, epoch 88, cost -59.4643641052
Pre-training layer 2, epoch 89, cost -59.3727378693
Pre-training layer 2, epoch 90, cost -59.4011068115
Pre-training layer 2, epoch 90, representative training free energy 15440.0639258
Pre-training layer 2, epoch 90, validation free energy 15314.0547324
Pre-training layer 2, epoch 91, cost -59.2921405182
Pre-training layer 2, epoch 92, cost -59.3983907013
Pre-training layer 2, epoch 93, cost -59.3283684692
Pre-training layer 2, epoch 94, cost -59.2636390152
Pre-training layer 2, epoch 95, cost -59.3332745743
Pre-training layer 2, epoch 95, representative training free energy 15720.9313535
Pre-training layer 2, epoch 95, validation free energy 15586.7283257
Pre-training layer 2, epoch 96, cost -59.219246048
Pre-training layer 2, epoch 97, cost -59.2375720291
Pre-training layer 2, epoch 98, cost -59.1810041885
Pre-training layer 2, epoch 99, cost -59.1862610931
The pretraining code for file dbn_loop.pyc ran for 13.00m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 32.000000 %
     epoch 1, minibatch 500/500, test error of best model 26.700000 %
epoch 2, minibatch 500/500, validation error 24.400000 %
     epoch 2, minibatch 500/500, test error of best model 17.900000 %
epoch 3, minibatch 500/500, validation error 22.000000 %
     epoch 3, minibatch 500/500, test error of best model 14.400000 %
epoch 4, minibatch 500/500, validation error 20.200000 %
     epoch 4, minibatch 500/500, test error of best model 12.400000 %
epoch 5, minibatch 500/500, validation error 19.100000 %
     epoch 5, minibatch 500/500, test error of best model 11.300000 %
epoch 6, minibatch 500/500, validation error 18.100000 %
     epoch 6, minibatch 500/500, test error of best model 10.600000 %
epoch 7, minibatch 500/500, validation error 17.200000 %
     epoch 7, minibatch 500/500, test error of best model 9.600000 %
epoch 8, minibatch 500/500, validation error 16.700000 %
     epoch 8, minibatch 500/500, test error of best model 8.400000 %
epoch 9, minibatch 500/500, validation error 16.100000 %
     epoch 9, minibatch 500/500, test error of best model 7.400000 %
epoch 10, minibatch 500/500, validation error 15.800000 %
     epoch 10, minibatch 500/500, test error of best model 6.800000 %
epoch 11, minibatch 500/500, validation error 15.600000 %
     epoch 11, minibatch 500/500, test error of best model 6.600000 %
epoch 12, minibatch 500/500, validation error 15.500000 %
     epoch 12, minibatch 500/500, test error of best model 6.300000 %
epoch 13, minibatch 500/500, validation error 15.300000 %
     epoch 13, minibatch 500/500, test error of best model 6.300000 %
epoch 14, minibatch 500/500, validation error 15.400000 %
epoch 15, minibatch 500/500, validation error 15.200000 %
     epoch 15, minibatch 500/500, test error of best model 5.800000 %
epoch 16, minibatch 500/500, validation error 15.100000 %
     epoch 16, minibatch 500/500, test error of best model 5.800000 %
epoch 17, minibatch 500/500, validation error 15.000000 %
     epoch 17, minibatch 500/500, test error of best model 5.900000 %
epoch 18, minibatch 500/500, validation error 14.900000 %
     epoch 18, minibatch 500/500, test error of best model 5.900000 %
epoch 19, minibatch 500/500, validation error 14.900000 %
epoch 20, minibatch 500/500, validation error 15.000000 %
epoch 21, minibatch 500/500, validation error 14.900000 %
epoch 22, minibatch 500/500, validation error 14.900000 %
epoch 23, minibatch 500/500, validation error 14.800000 %
     epoch 23, minibatch 500/500, test error of best model 5.500000 %
epoch 24, minibatch 500/500, validation error 14.700000 %
     epoch 24, minibatch 500/500, test error of best model 5.500000 %
epoch 25, minibatch 500/500, validation error 14.600000 %
     epoch 25, minibatch 500/500, test error of best model 5.400000 %
epoch 26, minibatch 500/500, validation error 14.500000 %
     epoch 26, minibatch 500/500, test error of best model 5.500000 %
epoch 27, minibatch 500/500, validation error 14.500000 %
epoch 28, minibatch 500/500, validation error 14.300000 %
     epoch 28, minibatch 500/500, test error of best model 5.400000 %
epoch 29, minibatch 500/500, validation error 14.300000 %
epoch 30, minibatch 500/500, validation error 14.300000 %
epoch 31, minibatch 500/500, validation error 14.100000 %
     epoch 31, minibatch 500/500, test error of best model 5.500000 %
epoch 32, minibatch 500/500, validation error 14.100000 %
epoch 33, minibatch 500/500, validation error 14.100000 %
epoch 34, minibatch 500/500, validation error 14.100000 %
epoch 35, minibatch 500/500, validation error 14.000000 %
     epoch 35, minibatch 500/500, test error of best model 5.300000 %
epoch 36, minibatch 500/500, validation error 13.900000 %
     epoch 36, minibatch 500/500, test error of best model 5.300000 %
epoch 37, minibatch 500/500, validation error 13.800000 %
     epoch 37, minibatch 500/500, test error of best model 5.300000 %
epoch 38, minibatch 500/500, validation error 13.800000 %
epoch 39, minibatch 500/500, validation error 13.800000 %
epoch 40, minibatch 500/500, validation error 13.800000 %
epoch 41, minibatch 500/500, validation error 13.800000 %
epoch 42, minibatch 500/500, validation error 13.800000 %
epoch 43, minibatch 500/500, validation error 13.800000 %
epoch 44, minibatch 500/500, validation error 13.800000 %
epoch 45, minibatch 500/500, validation error 13.800000 %
epoch 46, minibatch 500/500, validation error 13.800000 %
epoch 47, minibatch 500/500, validation error 13.800000 %
epoch 48, minibatch 500/500, validation error 13.800000 %
epoch 49, minibatch 500/500, validation error 13.800000 %
epoch 50, minibatch 500/500, validation error 13.800000 %
epoch 51, minibatch 500/500, validation error 13.800000 %
epoch 52, minibatch 500/500, validation error 13.800000 %
epoch 53, minibatch 500/500, validation error 13.800000 %
epoch 54, minibatch 500/500, validation error 13.800000 %
epoch 55, minibatch 500/500, validation error 13.800000 %
epoch 56, minibatch 500/500, validation error 13.800000 %
epoch 57, minibatch 500/500, validation error 13.800000 %
epoch 58, minibatch 500/500, validation error 13.900000 %
epoch 59, minibatch 500/500, validation error 13.900000 %
epoch 60, minibatch 500/500, validation error 13.900000 %
epoch 61, minibatch 500/500, validation error 13.900000 %
epoch 62, minibatch 500/500, validation error 13.900000 %
epoch 63, minibatch 500/500, validation error 13.900000 %
epoch 64, minibatch 500/500, validation error 13.900000 %
epoch 65, minibatch 500/500, validation error 13.900000 %
epoch 66, minibatch 500/500, validation error 13.900000 %
epoch 67, minibatch 500/500, validation error 13.900000 %
epoch 68, minibatch 500/500, validation error 13.900000 %
epoch 69, minibatch 500/500, validation error 13.900000 %
epoch 70, minibatch 500/500, validation error 13.900000 %
epoch 71, minibatch 500/500, validation error 13.900000 %
epoch 72, minibatch 500/500, validation error 13.900000 %
epoch 73, minibatch 500/500, validation error 13.900000 %
Optimization complete with best validation score of 13.800000 %, obtained at iteration 18500, with test performance 5.300000 %
The fine tuning code for file dbn_loop.pyc ran for 3.07m
_______RUN: 2

==========Sample: (1000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.030425415
Pre-training layer 0, epoch 0, representative training free energy -597.296693451
Pre-training layer 0, epoch 0, validation free energy -592.020822113
Pre-training layer 0, epoch 1, cost -137.169098969
Pre-training layer 0, epoch 2, cost -124.89001976
Pre-training layer 0, epoch 3, cost -118.006643143
Pre-training layer 0, epoch 4, cost -113.359551926
Pre-training layer 0, epoch 5, cost -109.739374771
Pre-training layer 0, epoch 5, representative training free energy -547.380456482
Pre-training layer 0, epoch 5, validation free energy -536.872276245
Pre-training layer 0, epoch 6, cost -107.020764236
Pre-training layer 0, epoch 7, cost -104.842283707
Pre-training layer 0, epoch 8, cost -102.790678101
Pre-training layer 0, epoch 9, cost -100.805964584
Pre-training layer 0, epoch 10, cost -99.2260186768
Pre-training layer 0, epoch 10, representative training free energy -529.896900085
Pre-training layer 0, epoch 10, validation free energy -517.821621704
Pre-training layer 0, epoch 11, cost -98.0968911743
Pre-training layer 0, epoch 12, cost -96.6007159424
Pre-training layer 0, epoch 13, cost -95.253082962
Pre-training layer 0, epoch 14, cost -94.8511769104
Pre-training layer 0, epoch 15, cost -93.6947478485
Pre-training layer 0, epoch 15, representative training free energy -514.662068329
Pre-training layer 0, epoch 15, validation free energy -502.456504639
Pre-training layer 0, epoch 16, cost -93.0107979584
Pre-training layer 0, epoch 17, cost -91.9035405731
Pre-training layer 0, epoch 18, cost -91.461447525
Pre-training layer 0, epoch 19, cost -90.6439212799
Pre-training layer 0, epoch 20, cost -90.024017868
Pre-training layer 0, epoch 20, representative training free energy -509.324605377
Pre-training layer 0, epoch 20, validation free energy -494.712964935
Pre-training layer 0, epoch 21, cost -89.3782388306
Pre-training layer 0, epoch 22, cost -88.8458795166
Pre-training layer 0, epoch 23, cost -88.3723549652
Pre-training layer 0, epoch 24, cost -87.8430156708
Pre-training layer 0, epoch 25, cost -87.3463500977
Pre-training layer 0, epoch 25, representative training free energy -497.967238373
Pre-training layer 0, epoch 25, validation free energy -484.764447205
Pre-training layer 0, epoch 26, cost -86.80313797
Pre-training layer 0, epoch 27, cost -86.4438291931
Pre-training layer 0, epoch 28, cost -85.9064080048
Pre-training layer 0, epoch 29, cost -85.7906255341
Pre-training layer 0, epoch 30, cost -85.5271352386
Pre-training layer 0, epoch 30, representative training free energy -492.130137482
Pre-training layer 0, epoch 30, validation free energy -477.436434723
Pre-training layer 0, epoch 31, cost -84.912080307
Pre-training layer 0, epoch 32, cost -84.367755127
Pre-training layer 0, epoch 33, cost -84.3059311676
Pre-training layer 0, epoch 34, cost -83.6665538788
Pre-training layer 0, epoch 35, cost -83.1265795898
Pre-training layer 0, epoch 35, representative training free energy -491.038111816
Pre-training layer 0, epoch 35, validation free energy -476.120535828
Pre-training layer 0, epoch 36, cost -83.3569465637
Pre-training layer 0, epoch 37, cost -82.9480152893
Pre-training layer 0, epoch 38, cost -83.0057701874
Pre-training layer 0, epoch 39, cost -82.3039523697
Pre-training layer 0, epoch 40, cost -82.2697569275
Pre-training layer 0, epoch 40, representative training free energy -486.819250305
Pre-training layer 0, epoch 40, validation free energy -471.185013794
Pre-training layer 0, epoch 41, cost -81.9037810516
Pre-training layer 0, epoch 42, cost -81.9691498566
Pre-training layer 0, epoch 43, cost -81.397024231
Pre-training layer 0, epoch 44, cost -81.114308815
Pre-training layer 0, epoch 45, cost -81.0393268585
Pre-training layer 0, epoch 45, representative training free energy -484.618124939
Pre-training layer 0, epoch 45, validation free energy -469.661616394
Pre-training layer 0, epoch 46, cost -80.8035393524
Pre-training layer 0, epoch 47, cost -80.4098633575
Pre-training layer 0, epoch 48, cost -80.3893445969
Pre-training layer 0, epoch 49, cost -80.4181249237
Pre-training layer 0, epoch 50, cost -80.1102067184
Pre-training layer 0, epoch 50, representative training free energy -481.805199219
Pre-training layer 0, epoch 50, validation free energy -465.176848602
Pre-training layer 0, epoch 51, cost -79.7090335846
Pre-training layer 0, epoch 52, cost -79.572796936
Pre-training layer 0, epoch 53, cost -79.5410718536
Pre-training layer 0, epoch 54, cost -79.2290698242
Pre-training layer 0, epoch 55, cost -79.1759696198
Pre-training layer 0, epoch 55, representative training free energy -476.149883484
Pre-training layer 0, epoch 55, validation free energy -460.204903046
Pre-training layer 0, epoch 56, cost -78.9977145386
Pre-training layer 0, epoch 57, cost -78.6725991058
Pre-training layer 0, epoch 58, cost -78.754487915
Pre-training layer 0, epoch 59, cost -78.5888822937
Pre-training layer 0, epoch 60, cost -78.3901689529
Pre-training layer 0, epoch 60, representative training free energy -478.365654327
Pre-training layer 0, epoch 60, validation free energy -461.345182953
Pre-training layer 0, epoch 61, cost -78.3663345337
Pre-training layer 0, epoch 62, cost -77.9447491455
Pre-training layer 0, epoch 63, cost -77.9164710999
Pre-training layer 0, epoch 64, cost -77.7643238068
Pre-training layer 0, epoch 65, cost -77.6520253754
Pre-training layer 0, epoch 65, representative training free energy -473.174866394
Pre-training layer 0, epoch 65, validation free energy -456.469800598
Pre-training layer 0, epoch 66, cost -77.5441448975
Pre-training layer 0, epoch 67, cost -77.4064761734
Pre-training layer 0, epoch 68, cost -77.4221513367
Pre-training layer 0, epoch 69, cost -77.1984103394
Pre-training layer 0, epoch 70, cost -77.1559786606
Pre-training layer 0, epoch 70, representative training free energy -473.46153772
Pre-training layer 0, epoch 70, validation free energy -455.521079285
Pre-training layer 0, epoch 71, cost -77.0420410919
Pre-training layer 0, epoch 72, cost -76.7199726486
Pre-training layer 0, epoch 73, cost -76.7974510193
Pre-training layer 0, epoch 74, cost -76.585897789
Pre-training layer 0, epoch 75, cost -76.4083940887
Pre-training layer 0, epoch 75, representative training free energy -474.055090607
Pre-training layer 0, epoch 75, validation free energy -455.939499695
Pre-training layer 0, epoch 76, cost -76.361121788
Pre-training layer 0, epoch 77, cost -76.3799206543
Pre-training layer 0, epoch 78, cost -76.0923121262
Pre-training layer 0, epoch 79, cost -76.1467867661
Pre-training layer 0, epoch 80, cost -75.9821849442
Pre-training layer 0, epoch 80, representative training free energy -472.127837067
Pre-training layer 0, epoch 80, validation free energy -454.454256927
Pre-training layer 0, epoch 81, cost -75.7997890854
Pre-training layer 0, epoch 82, cost -75.7963254166
Pre-training layer 0, epoch 83, cost -75.4862607193
Pre-training layer 0, epoch 84, cost -75.4024986267
Pre-training layer 0, epoch 85, cost -75.4857816315
Pre-training layer 0, epoch 85, representative training free energy -466.799520935
Pre-training layer 0, epoch 85, validation free energy -448.404852264
Pre-training layer 0, epoch 86, cost -75.0497476959
Pre-training layer 0, epoch 87, cost -75.2480828476
Pre-training layer 0, epoch 88, cost -75.0512962341
Pre-training layer 0, epoch 89, cost -74.8523222351
Pre-training layer 0, epoch 90, cost -75.2065216827
Pre-training layer 0, epoch 90, representative training free energy -468.366920197
Pre-training layer 0, epoch 90, validation free energy -449.457970703
Pre-training layer 0, epoch 91, cost -74.8731189728
Pre-training layer 0, epoch 92, cost -74.7794994736
Pre-training layer 0, epoch 93, cost -74.7750173187
Pre-training layer 0, epoch 94, cost -74.6022037506
Pre-training layer 0, epoch 95, cost -74.5963792419
Pre-training layer 0, epoch 95, representative training free energy -468.119010193
Pre-training layer 0, epoch 95, validation free energy -448.605758514
Pre-training layer 0, epoch 96, cost -74.3137490082
Pre-training layer 0, epoch 97, cost -74.2613274384
Pre-training layer 0, epoch 98, cost -74.3218876648
Pre-training layer 0, epoch 99, cost -74.2287407684
Pre-training layer 1, epoch 0, cost -431.342547302
Pre-training layer 1, epoch 0, representative training free energy -32998.2208633
Pre-training layer 1, epoch 0, validation free energy -32420.4781982
Pre-training layer 1, epoch 1, cost -370.031904907
Pre-training layer 1, epoch 2, cost -350.409820862
Pre-training layer 1, epoch 3, cost -338.631407166
Pre-training layer 1, epoch 4, cost -330.377470398
Pre-training layer 1, epoch 5, cost -324.341873474
Pre-training layer 1, epoch 5, representative training free energy -47287.2731777
Pre-training layer 1, epoch 5, validation free energy -46553.8200117
Pre-training layer 1, epoch 6, cost -319.04173645
Pre-training layer 1, epoch 7, cost -314.774082947
Pre-training layer 1, epoch 8, cost -311.516243591
Pre-training layer 1, epoch 9, cost -308.523776245
Pre-training layer 1, epoch 10, cost -305.874710693
Pre-training layer 1, epoch 10, representative training free energy -51744.1799043
Pre-training layer 1, epoch 10, validation free energy -50968.2372402
Pre-training layer 1, epoch 11, cost -303.627584839
Pre-training layer 1, epoch 12, cost -301.206256866
Pre-training layer 1, epoch 13, cost -299.578342438
Pre-training layer 1, epoch 14, cost -297.759429932
Pre-training layer 1, epoch 15, cost -296.187681122
Pre-training layer 1, epoch 15, representative training free energy -54264.1834277
Pre-training layer 1, epoch 15, validation free energy -53480.4249531
Pre-training layer 1, epoch 16, cost -294.638851929
Pre-training layer 1, epoch 17, cost -293.58453598
Pre-training layer 1, epoch 18, cost -292.504317017
Pre-training layer 1, epoch 19, cost -291.316331024
Pre-training layer 1, epoch 20, cost -290.354755249
Pre-training layer 1, epoch 20, representative training free energy -56056.1304277
Pre-training layer 1, epoch 20, validation free energy -55268.5217266
Pre-training layer 1, epoch 21, cost -289.188964386
Pre-training layer 1, epoch 22, cost -288.319936218
Pre-training layer 1, epoch 23, cost -287.6234375
Pre-training layer 1, epoch 24, cost -286.7295224
Pre-training layer 1, epoch 25, cost -286.188738556
Pre-training layer 1, epoch 25, representative training free energy -57465.352501
Pre-training layer 1, epoch 25, validation free energy -56661.719
Pre-training layer 1, epoch 26, cost -285.103933411
Pre-training layer 1, epoch 27, cost -284.733453217
Pre-training layer 1, epoch 28, cost -284.00394928
Pre-training layer 1, epoch 29, cost -283.36515152
Pre-training layer 1, epoch 30, cost -282.775718994
Pre-training layer 1, epoch 30, representative training free energy -58522.4873145
Pre-training layer 1, epoch 30, validation free energy -57705.9757461
Pre-training layer 1, epoch 31, cost -282.342799225
Pre-training layer 1, epoch 32, cost -281.767504578
Pre-training layer 1, epoch 33, cost -281.178943481
Pre-training layer 1, epoch 34, cost -280.809648132
Pre-training layer 1, epoch 35, cost -280.383590393
Pre-training layer 1, epoch 35, representative training free energy -59390.1602832
Pre-training layer 1, epoch 35, validation free energy -58572.5999453
Pre-training layer 1, epoch 36, cost -279.994025269
Pre-training layer 1, epoch 37, cost -279.450984344
Pre-training layer 1, epoch 38, cost -278.936419373
Pre-training layer 1, epoch 39, cost -278.666932831
Pre-training layer 1, epoch 40, cost -278.412688293
Pre-training layer 1, epoch 40, representative training free energy -60252.1025596
Pre-training layer 1, epoch 40, validation free energy -59426.8689316
Pre-training layer 1, epoch 41, cost -278.011773529
Pre-training layer 1, epoch 42, cost -277.532605133
Pre-training layer 1, epoch 43, cost -277.279343567
Pre-training layer 1, epoch 44, cost -276.815758514
Pre-training layer 1, epoch 45, cost -276.648447723
Pre-training layer 1, epoch 45, representative training free energy -60991.187082
Pre-training layer 1, epoch 45, validation free energy -60155.072123
Pre-training layer 1, epoch 46, cost -276.24049881
Pre-training layer 1, epoch 47, cost -276.110608673
Pre-training layer 1, epoch 48, cost -275.839723358
Pre-training layer 1, epoch 49, cost -275.612295532
Pre-training layer 1, epoch 50, cost -275.153590546
Pre-training layer 1, epoch 50, representative training free energy -61527.8730625
Pre-training layer 1, epoch 50, validation free energy -60685.1543418
Pre-training layer 1, epoch 51, cost -275.094689178
Pre-training layer 1, epoch 52, cost -274.78828186
Pre-training layer 1, epoch 53, cost -274.636087189
Pre-training layer 1, epoch 54, cost -274.351242828
Pre-training layer 1, epoch 55, cost -274.138297272
Pre-training layer 1, epoch 55, representative training free energy -62153.0140508
Pre-training layer 1, epoch 55, validation free energy -61311.8959844
Pre-training layer 1, epoch 56, cost -273.752768555
Pre-training layer 1, epoch 57, cost -273.870800171
Pre-training layer 1, epoch 58, cost -273.397024231
Pre-training layer 1, epoch 59, cost -273.27007782
Pre-training layer 1, epoch 60, cost -273.120715942
Pre-training layer 1, epoch 60, representative training free energy -62686.9871934
Pre-training layer 1, epoch 60, validation free energy -61832.9548691
Pre-training layer 1, epoch 61, cost -272.882382202
Pre-training layer 1, epoch 62, cost -272.798037567
Pre-training layer 1, epoch 63, cost -272.360788422
Pre-training layer 1, epoch 64, cost -272.25056015
Pre-training layer 1, epoch 65, cost -272.27221405
Pre-training layer 1, epoch 65, representative training free energy -63230.8350449
Pre-training layer 1, epoch 65, validation free energy -62377.9125625
Pre-training layer 1, epoch 66, cost -272.164467621
Pre-training layer 1, epoch 67, cost -271.904737244
Pre-training layer 1, epoch 68, cost -271.551040802
Pre-training layer 1, epoch 69, cost -271.497740021
Pre-training layer 1, epoch 70, cost -271.269709167
Pre-training layer 1, epoch 70, representative training free energy -63692.5773086
Pre-training layer 1, epoch 70, validation free energy -62845.6926738
Pre-training layer 1, epoch 71, cost -271.220711823
Pre-training layer 1, epoch 72, cost -270.988166809
Pre-training layer 1, epoch 73, cost -270.945932312
Pre-training layer 1, epoch 74, cost -270.898077393
Pre-training layer 1, epoch 75, cost -270.804004517
Pre-training layer 1, epoch 75, representative training free energy -64035.4040898
Pre-training layer 1, epoch 75, validation free energy -63178.7335723
Pre-training layer 1, epoch 76, cost -270.513525848
Pre-training layer 1, epoch 77, cost -270.387723846
Pre-training layer 1, epoch 78, cost -270.257292175
Pre-training layer 1, epoch 79, cost -270.029152679
Pre-training layer 1, epoch 80, cost -269.973236237
Pre-training layer 1, epoch 80, representative training free energy -64417.2634531
Pre-training layer 1, epoch 80, validation free energy -63555.3701523
Pre-training layer 1, epoch 81, cost -269.915810089
Pre-training layer 1, epoch 82, cost -269.924342194
Pre-training layer 1, epoch 83, cost -269.69771637
Pre-training layer 1, epoch 84, cost -269.602133942
Pre-training layer 1, epoch 85, cost -269.324470673
Pre-training layer 1, epoch 85, representative training free energy -64803.240834
Pre-training layer 1, epoch 85, validation free energy -63933.084209
Pre-training layer 1, epoch 86, cost -269.323062897
Pre-training layer 1, epoch 87, cost -269.242024994
Pre-training layer 1, epoch 88, cost -269.21809433
Pre-training layer 1, epoch 89, cost -269.091766968
Pre-training layer 1, epoch 90, cost -268.861105042
Pre-training layer 1, epoch 90, representative training free energy -65105.0845859
Pre-training layer 1, epoch 90, validation free energy -64241.1957871
Pre-training layer 1, epoch 91, cost -268.849315948
Pre-training layer 1, epoch 92, cost -268.626381531
Pre-training layer 1, epoch 93, cost -268.529449158
Pre-training layer 1, epoch 94, cost -268.530835419
Pre-training layer 1, epoch 95, cost -268.51173996
Pre-training layer 1, epoch 95, representative training free energy -65444.1233223
Pre-training layer 1, epoch 95, validation free energy -64566.5150879
Pre-training layer 1, epoch 96, cost -268.311087189
Pre-training layer 1, epoch 97, cost -268.321589508
Pre-training layer 1, epoch 98, cost -268.049398346
Pre-training layer 1, epoch 99, cost -268.077425232
Pre-training layer 2, epoch 0, cost -162.76198143
Pre-training layer 2, epoch 0, representative training free energy 1893.25030634
Pre-training layer 2, epoch 0, validation free energy 1873.63096255
Pre-training layer 2, epoch 1, cost -108.54156517
Pre-training layer 2, epoch 2, cost -97.9824462128
Pre-training layer 2, epoch 3, cost -92.6516451263
Pre-training layer 2, epoch 4, cost -88.8296954346
Pre-training layer 2, epoch 5, cost -86.0891333008
Pre-training layer 2, epoch 5, representative training free energy 2898.26523981
Pre-training layer 2, epoch 5, validation free energy 2860.18568689
Pre-training layer 2, epoch 6, cost -84.0941914368
Pre-training layer 2, epoch 7, cost -82.0846860123
Pre-training layer 2, epoch 8, cost -80.8057009888
Pre-training layer 2, epoch 9, cost -79.3179495239
Pre-training layer 2, epoch 10, cost -78.4523109818
Pre-training layer 2, epoch 10, representative training free energy 3327.25600665
Pre-training layer 2, epoch 10, validation free energy 3279.62477069
Pre-training layer 2, epoch 11, cost -77.4217621994
Pre-training layer 2, epoch 12, cost -76.8615151215
Pre-training layer 2, epoch 13, cost -75.900746727
Pre-training layer 2, epoch 14, cost -75.0508701706
Pre-training layer 2, epoch 15, cost -74.5656108093
Pre-training layer 2, epoch 15, representative training free energy 3622.84236578
Pre-training layer 2, epoch 15, validation free energy 3567.31475244
Pre-training layer 2, epoch 16, cost -73.9946294785
Pre-training layer 2, epoch 17, cost -73.4024867249
Pre-training layer 2, epoch 18, cost -72.9474992371
Pre-training layer 2, epoch 19, cost -72.5985009766
Pre-training layer 2, epoch 20, cost -72.0335964203
Pre-training layer 2, epoch 20, representative training free energy 3883.52316113
Pre-training layer 2, epoch 20, validation free energy 3821.99840051
Pre-training layer 2, epoch 21, cost -71.6223373795
Pre-training layer 2, epoch 22, cost -71.3370469284
Pre-training layer 2, epoch 23, cost -70.8567826843
Pre-training layer 2, epoch 24, cost -70.7085489655
Pre-training layer 2, epoch 25, cost -70.1902144623
Pre-training layer 2, epoch 25, representative training free energy 4122.27263953
Pre-training layer 2, epoch 25, validation free energy 4059.42587366
Pre-training layer 2, epoch 26, cost -70.0694338608
Pre-training layer 2, epoch 27, cost -69.6870289612
Pre-training layer 2, epoch 28, cost -69.5036942673
Pre-training layer 2, epoch 29, cost -69.1086928177
Pre-training layer 2, epoch 30, cost -69.0124316025
Pre-training layer 2, epoch 30, representative training free energy 4303.75421313
Pre-training layer 2, epoch 30, validation free energy 4235.30514026
Pre-training layer 2, epoch 31, cost -68.8823202515
Pre-training layer 2, epoch 32, cost -68.5752123642
Pre-training layer 2, epoch 33, cost -68.3240123367
Pre-training layer 2, epoch 34, cost -68.2836196899
Pre-training layer 2, epoch 35, cost -67.9765988922
Pre-training layer 2, epoch 35, representative training free energy 4494.41408691
Pre-training layer 2, epoch 35, validation free energy 4423.19952319
Pre-training layer 2, epoch 36, cost -67.859632988
Pre-training layer 2, epoch 37, cost -67.5083310699
Pre-training layer 2, epoch 38, cost -67.6473496246
Pre-training layer 2, epoch 39, cost -67.5393971252
Pre-training layer 2, epoch 40, cost -67.2849110413
Pre-training layer 2, epoch 40, representative training free energy 4636.4459679
Pre-training layer 2, epoch 40, validation free energy 4560.68056897
Pre-training layer 2, epoch 41, cost -67.2260486221
Pre-training layer 2, epoch 42, cost -66.9492956543
Pre-training layer 2, epoch 43, cost -66.7923241425
Pre-training layer 2, epoch 44, cost -66.6141241455
Pre-training layer 2, epoch 45, cost -66.6235894394
Pre-training layer 2, epoch 45, representative training free energy 4779.38692468
Pre-training layer 2, epoch 45, validation free energy 4698.83916809
Pre-training layer 2, epoch 46, cost -66.6178721237
Pre-training layer 2, epoch 47, cost -66.3429572678
Pre-training layer 2, epoch 48, cost -66.1375811768
Pre-training layer 2, epoch 49, cost -66.1000124741
Pre-training layer 2, epoch 50, cost -66.0058717346
Pre-training layer 2, epoch 50, representative training free energy 4923.56868787
Pre-training layer 2, epoch 50, validation free energy 4838.19579895
Pre-training layer 2, epoch 51, cost -65.9094118118
Pre-training layer 2, epoch 52, cost -65.7397592926
Pre-training layer 2, epoch 53, cost -65.7358657837
Pre-training layer 2, epoch 54, cost -65.566578331
Pre-training layer 2, epoch 55, cost -65.3454811478
Pre-training layer 2, epoch 55, representative training free energy 5067.42169275
Pre-training layer 2, epoch 55, validation free energy 4981.13409473
Pre-training layer 2, epoch 56, cost -65.2655815887
Pre-training layer 2, epoch 57, cost -65.160567627
Pre-training layer 2, epoch 58, cost -65.1496551132
Pre-training layer 2, epoch 59, cost -65.2000150299
Pre-training layer 2, epoch 60, cost -65.0798440933
Pre-training layer 2, epoch 60, representative training free energy 5172.54966052
Pre-training layer 2, epoch 60, validation free energy 5083.42342651
Pre-training layer 2, epoch 61, cost -65.0345095825
Pre-training layer 2, epoch 62, cost -65.0636561584
Pre-training layer 2, epoch 63, cost -64.811521492
Pre-training layer 2, epoch 64, cost -64.7283682632
Pre-training layer 2, epoch 65, cost -64.810698204
Pre-training layer 2, epoch 65, representative training free energy 5308.19609009
Pre-training layer 2, epoch 65, validation free energy 5218.79831396
Pre-training layer 2, epoch 66, cost -64.5916691971
Pre-training layer 2, epoch 67, cost -64.6952418137
Pre-training layer 2, epoch 68, cost -64.7410490417
Pre-training layer 2, epoch 69, cost -64.585043335
Pre-training layer 2, epoch 70, cost -64.4132637787
Pre-training layer 2, epoch 70, representative training free energy 5406.62854199
Pre-training layer 2, epoch 70, validation free energy 5315.00654919
Pre-training layer 2, epoch 71, cost -64.2039199448
Pre-training layer 2, epoch 72, cost -64.2503975677
Pre-training layer 2, epoch 73, cost -64.1398735809
Pre-training layer 2, epoch 74, cost -64.0143050385
Pre-training layer 2, epoch 75, cost -64.0867851257
Pre-training layer 2, epoch 75, representative training free energy 5514.98919177
Pre-training layer 2, epoch 75, validation free energy 5423.56741907
Pre-training layer 2, epoch 76, cost -64.1281393433
Pre-training layer 2, epoch 77, cost -63.926523819
Pre-training layer 2, epoch 78, cost -63.7520853424
Pre-training layer 2, epoch 79, cost -63.9662481308
Pre-training layer 2, epoch 80, cost -63.8338776779
Pre-training layer 2, epoch 80, representative training free energy 5615.29881104
Pre-training layer 2, epoch 80, validation free energy 5520.55022949
Pre-training layer 2, epoch 81, cost -63.9053724289
Pre-training layer 2, epoch 82, cost -63.5757306671
Pre-training layer 2, epoch 83, cost -63.5360977554
Pre-training layer 2, epoch 84, cost -63.5264641953
Pre-training layer 2, epoch 85, cost -63.7207767868
Pre-training layer 2, epoch 85, representative training free energy 5728.10605981
Pre-training layer 2, epoch 85, validation free energy 5634.38506628
Pre-training layer 2, epoch 86, cost -63.6551318359
Pre-training layer 2, epoch 87, cost -63.6505098343
Pre-training layer 2, epoch 88, cost -63.4732196426
Pre-training layer 2, epoch 89, cost -63.3460322571
Pre-training layer 2, epoch 90, cost -63.4491218567
Pre-training layer 2, epoch 90, representative training free energy 5808.3639248
Pre-training layer 2, epoch 90, validation free energy 5710.68095911
Pre-training layer 2, epoch 91, cost -63.1744404602
Pre-training layer 2, epoch 92, cost -63.2407630157
Pre-training layer 2, epoch 93, cost -63.2241509628
Pre-training layer 2, epoch 94, cost -63.1596613693
Pre-training layer 2, epoch 95, cost -63.1066511917
Pre-training layer 2, epoch 95, representative training free energy 5917.28729028
Pre-training layer 2, epoch 95, validation free energy 5816.62185425
Pre-training layer 2, epoch 96, cost -63.1190051651
Pre-training layer 2, epoch 97, cost -63.0755305862
Pre-training layer 2, epoch 98, cost -62.9437051392
Pre-training layer 2, epoch 99, cost -63.1085103226
The pretraining code for file dbn_loop.pyc ran for 2.75m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 38.200000 %
     epoch 1, minibatch 100/100, test error of best model 27.800000 %
epoch 2, minibatch 100/100, validation error 32.800000 %
     epoch 2, minibatch 100/100, test error of best model 20.500000 %
epoch 3, minibatch 100/100, validation error 29.700000 %
     epoch 3, minibatch 100/100, test error of best model 16.800000 %
epoch 4, minibatch 100/100, validation error 28.400000 %
     epoch 4, minibatch 100/100, test error of best model 16.100000 %
epoch 5, minibatch 100/100, validation error 27.800000 %
     epoch 5, minibatch 100/100, test error of best model 15.400000 %
epoch 6, minibatch 100/100, validation error 27.500000 %
     epoch 6, minibatch 100/100, test error of best model 14.600000 %
epoch 7, minibatch 100/100, validation error 27.300000 %
     epoch 7, minibatch 100/100, test error of best model 14.500000 %
epoch 8, minibatch 100/100, validation error 26.600000 %
     epoch 8, minibatch 100/100, test error of best model 14.100000 %
epoch 9, minibatch 100/100, validation error 26.200000 %
     epoch 9, minibatch 100/100, test error of best model 14.200000 %
epoch 10, minibatch 100/100, validation error 25.600000 %
     epoch 10, minibatch 100/100, test error of best model 13.500000 %
epoch 11, minibatch 100/100, validation error 25.000000 %
     epoch 11, minibatch 100/100, test error of best model 12.700000 %
epoch 12, minibatch 100/100, validation error 24.900000 %
     epoch 12, minibatch 100/100, test error of best model 12.300000 %
epoch 13, minibatch 100/100, validation error 24.800000 %
     epoch 13, minibatch 100/100, test error of best model 12.300000 %
epoch 14, minibatch 100/100, validation error 24.600000 %
     epoch 14, minibatch 100/100, test error of best model 11.700000 %
epoch 15, minibatch 100/100, validation error 24.600000 %
epoch 16, minibatch 100/100, validation error 24.600000 %
epoch 17, minibatch 100/100, validation error 24.500000 %
     epoch 17, minibatch 100/100, test error of best model 11.600000 %
epoch 18, minibatch 100/100, validation error 24.500000 %
epoch 19, minibatch 100/100, validation error 24.500000 %
epoch 20, minibatch 100/100, validation error 24.400000 %
     epoch 20, minibatch 100/100, test error of best model 11.300000 %
epoch 21, minibatch 100/100, validation error 24.300000 %
     epoch 21, minibatch 100/100, test error of best model 11.400000 %
epoch 22, minibatch 100/100, validation error 24.400000 %
epoch 23, minibatch 100/100, validation error 24.500000 %
epoch 24, minibatch 100/100, validation error 24.400000 %
epoch 25, minibatch 100/100, validation error 24.300000 %
epoch 26, minibatch 100/100, validation error 24.200000 %
     epoch 26, minibatch 100/100, test error of best model 11.900000 %
epoch 27, minibatch 100/100, validation error 24.100000 %
     epoch 27, minibatch 100/100, test error of best model 11.900000 %
Optimization complete with best validation score of 24.100000 %, obtained at iteration 2700, with test performance 11.900000 %
The fine tuning code for file dbn_loop.pyc ran for 0.35m


==========Sample: (2000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.451893463
Pre-training layer 0, epoch 0, representative training free energy -583.172148132
Pre-training layer 0, epoch 0, validation free energy -581.756913513
Pre-training layer 0, epoch 1, cost -123.326272964
Pre-training layer 0, epoch 2, cost -113.891464119
Pre-training layer 0, epoch 3, cost -108.168201904
Pre-training layer 0, epoch 4, cost -104.026345749
Pre-training layer 0, epoch 5, cost -101.163144913
Pre-training layer 0, epoch 5, representative training free energy -525.439531738
Pre-training layer 0, epoch 5, validation free energy -518.688294373
Pre-training layer 0, epoch 6, cost -98.860993576
Pre-training layer 0, epoch 7, cost -96.9441090393
Pre-training layer 0, epoch 8, cost -94.9872275543
Pre-training layer 0, epoch 9, cost -93.8081792068
Pre-training layer 0, epoch 10, cost -92.5180105591
Pre-training layer 0, epoch 10, representative training free energy -506.231316376
Pre-training layer 0, epoch 10, validation free energy -497.207940765
Pre-training layer 0, epoch 11, cost -91.4968510818
Pre-training layer 0, epoch 12, cost -90.5242911148
Pre-training layer 0, epoch 13, cost -89.9002174759
Pre-training layer 0, epoch 14, cost -88.8805696869
Pre-training layer 0, epoch 15, cost -88.2343862534
Pre-training layer 0, epoch 15, representative training free energy -492.973148468
Pre-training layer 0, epoch 15, validation free energy -483.410191132
Pre-training layer 0, epoch 16, cost -87.538608284
Pre-training layer 0, epoch 17, cost -87.0053879929
Pre-training layer 0, epoch 18, cost -86.460608139
Pre-training layer 0, epoch 19, cost -85.906181488
Pre-training layer 0, epoch 20, cost -85.5129491806
Pre-training layer 0, epoch 20, representative training free energy -483.186640076
Pre-training layer 0, epoch 20, validation free energy -473.824252716
Pre-training layer 0, epoch 21, cost -84.9334827042
Pre-training layer 0, epoch 22, cost -84.6657675552
Pre-training layer 0, epoch 23, cost -84.1579852295
Pre-training layer 0, epoch 24, cost -83.7144937897
Pre-training layer 0, epoch 25, cost -83.2474901962
Pre-training layer 0, epoch 25, representative training free energy -480.173915924
Pre-training layer 0, epoch 25, validation free energy -469.552140564
Pre-training layer 0, epoch 26, cost -82.9778947067
Pre-training layer 0, epoch 27, cost -82.6257564163
Pre-training layer 0, epoch 28, cost -82.3915400124
Pre-training layer 0, epoch 29, cost -82.2217019653
Pre-training layer 0, epoch 30, cost -81.9099640656
Pre-training layer 0, epoch 30, representative training free energy -472.96612793
Pre-training layer 0, epoch 30, validation free energy -461.89468515
Pre-training layer 0, epoch 31, cost -81.4910887146
Pre-training layer 0, epoch 32, cost -81.2959417343
Pre-training layer 0, epoch 33, cost -81.0056880951
Pre-training layer 0, epoch 34, cost -80.9273553658
Pre-training layer 0, epoch 35, cost -80.7746520615
Pre-training layer 0, epoch 35, representative training free energy -469.35903006
Pre-training layer 0, epoch 35, validation free energy -458.80742865
Pre-training layer 0, epoch 36, cost -80.3684227562
Pre-training layer 0, epoch 37, cost -80.1353105736
Pre-training layer 0, epoch 38, cost -80.0771107483
Pre-training layer 0, epoch 39, cost -79.6236553574
Pre-training layer 0, epoch 40, cost -79.8265309143
Pre-training layer 0, epoch 40, representative training free energy -467.55195163
Pre-training layer 0, epoch 40, validation free energy -456.478298218
Pre-training layer 0, epoch 41, cost -79.4695895767
Pre-training layer 0, epoch 42, cost -79.2078593254
Pre-training layer 0, epoch 43, cost -79.1692964935
Pre-training layer 0, epoch 44, cost -79.0434834671
Pre-training layer 0, epoch 45, cost -78.7114866066
Pre-training layer 0, epoch 45, representative training free energy -463.839955109
Pre-training layer 0, epoch 45, validation free energy -452.454764557
Pre-training layer 0, epoch 46, cost -78.7518736839
Pre-training layer 0, epoch 47, cost -78.4227727699
Pre-training layer 0, epoch 48, cost -78.2749060631
Pre-training layer 0, epoch 49, cost -78.1299581909
Pre-training layer 0, epoch 50, cost -77.9377013779
Pre-training layer 0, epoch 50, representative training free energy -463.301740326
Pre-training layer 0, epoch 50, validation free energy -451.233947906
Pre-training layer 0, epoch 51, cost -77.7730405807
Pre-training layer 0, epoch 52, cost -77.7627493477
Pre-training layer 0, epoch 53, cost -77.4952626801
Pre-training layer 0, epoch 54, cost -77.4396461296
Pre-training layer 0, epoch 55, cost -77.3639591217
Pre-training layer 0, epoch 55, representative training free energy -463.300567352
Pre-training layer 0, epoch 55, validation free energy -451.519441406
Pre-training layer 0, epoch 56, cost -77.2843805504
Pre-training layer 0, epoch 57, cost -77.0496943665
Pre-training layer 0, epoch 58, cost -76.781136322
Pre-training layer 0, epoch 59, cost -76.7920776176
Pre-training layer 0, epoch 60, cost -76.7253872681
Pre-training layer 0, epoch 60, representative training free energy -460.702730652
Pre-training layer 0, epoch 60, validation free energy -448.591416504
Pre-training layer 0, epoch 61, cost -76.4843744278
Pre-training layer 0, epoch 62, cost -76.5279729462
Pre-training layer 0, epoch 63, cost -76.3787225342
Pre-training layer 0, epoch 64, cost -76.282550106
Pre-training layer 0, epoch 65, cost -76.4123928642
Pre-training layer 0, epoch 65, representative training free energy -460.120937408
Pre-training layer 0, epoch 65, validation free energy -447.536156219
Pre-training layer 0, epoch 66, cost -76.1096515274
Pre-training layer 0, epoch 67, cost -76.1733084297
Pre-training layer 0, epoch 68, cost -75.9206169128
Pre-training layer 0, epoch 69, cost -75.7998051453
Pre-training layer 0, epoch 70, cost -75.6566449165
Pre-training layer 0, epoch 70, representative training free energy -458.142340942
Pre-training layer 0, epoch 70, validation free energy -445.884846466
Pre-training layer 0, epoch 71, cost -75.7287047195
Pre-training layer 0, epoch 72, cost -75.61054739
Pre-training layer 0, epoch 73, cost -75.5559794617
Pre-training layer 0, epoch 74, cost -75.1873919296
Pre-training layer 0, epoch 75, cost -75.3659614563
Pre-training layer 0, epoch 75, representative training free energy -456.740108307
Pre-training layer 0, epoch 75, validation free energy -444.092525726
Pre-training layer 0, epoch 76, cost -75.2131634331
Pre-training layer 0, epoch 77, cost -75.090914402
Pre-training layer 0, epoch 78, cost -75.1678992844
Pre-training layer 0, epoch 79, cost -75.1298138618
Pre-training layer 0, epoch 80, cost -74.9165021896
Pre-training layer 0, epoch 80, representative training free energy -458.113066742
Pre-training layer 0, epoch 80, validation free energy -445.210195404
Pre-training layer 0, epoch 81, cost -74.6799813461
Pre-training layer 0, epoch 82, cost -74.7007239532
Pre-training layer 0, epoch 83, cost -74.7697319221
Pre-training layer 0, epoch 84, cost -74.5095855904
Pre-training layer 0, epoch 85, cost -74.4838681602
Pre-training layer 0, epoch 85, representative training free energy -455.400381989
Pre-training layer 0, epoch 85, validation free energy -442.440045624
Pre-training layer 0, epoch 86, cost -74.5272852516
Pre-training layer 0, epoch 87, cost -74.3679156303
Pre-training layer 0, epoch 88, cost -74.1632630157
Pre-training layer 0, epoch 89, cost -74.2073888779
Pre-training layer 0, epoch 90, cost -74.110400219
Pre-training layer 0, epoch 90, representative training free energy -455.332054901
Pre-training layer 0, epoch 90, validation free energy -441.271928833
Pre-training layer 0, epoch 91, cost -74.0597183228
Pre-training layer 0, epoch 92, cost -73.9447596359
Pre-training layer 0, epoch 93, cost -74.1169778824
Pre-training layer 0, epoch 94, cost -73.9291529465
Pre-training layer 0, epoch 95, cost -73.8446988106
Pre-training layer 0, epoch 95, representative training free energy -452.848123291
Pre-training layer 0, epoch 95, validation free energy -438.839787415
Pre-training layer 0, epoch 96, cost -73.7842227364
Pre-training layer 0, epoch 97, cost -73.8162345695
Pre-training layer 0, epoch 98, cost -73.6676564407
Pre-training layer 0, epoch 99, cost -73.669513092
Pre-training layer 1, epoch 0, cost -375.443489761
Pre-training layer 1, epoch 0, representative training free energy -42739.8769131
Pre-training layer 1, epoch 0, validation free energy -42465.024498
Pre-training layer 1, epoch 1, cost -323.049541702
Pre-training layer 1, epoch 2, cost -306.973935547
Pre-training layer 1, epoch 3, cost -296.825791245
Pre-training layer 1, epoch 4, cost -289.869559479
Pre-training layer 1, epoch 5, cost -284.604770279
Pre-training layer 1, epoch 5, representative training free energy -58717.0044434
Pre-training layer 1, epoch 5, validation free energy -58268.9241387
Pre-training layer 1, epoch 6, cost -280.536740341
Pre-training layer 1, epoch 7, cost -277.136710587
Pre-training layer 1, epoch 8, cost -274.398244781
Pre-training layer 1, epoch 9, cost -271.797534409
Pre-training layer 1, epoch 10, cost -269.901438293
Pre-training layer 1, epoch 10, representative training free energy -63555.5202344
Pre-training layer 1, epoch 10, validation free energy -63084.2594414
Pre-training layer 1, epoch 11, cost -268.146382751
Pre-training layer 1, epoch 12, cost -266.386110764
Pre-training layer 1, epoch 13, cost -264.887400894
Pre-training layer 1, epoch 14, cost -263.63519577
Pre-training layer 1, epoch 15, cost -262.538381577
Pre-training layer 1, epoch 15, representative training free energy -66271.9530254
Pre-training layer 1, epoch 15, validation free energy -65782.6043262
Pre-training layer 1, epoch 16, cost -261.28469574
Pre-training layer 1, epoch 17, cost -260.435261383
Pre-training layer 1, epoch 18, cost -259.343900452
Pre-training layer 1, epoch 19, cost -258.661202698
Pre-training layer 1, epoch 20, cost -257.905179901
Pre-training layer 1, epoch 20, representative training free energy -68283.3041289
Pre-training layer 1, epoch 20, validation free energy -67792.6176016
Pre-training layer 1, epoch 21, cost -257.108417892
Pre-training layer 1, epoch 22, cost -256.298492737
Pre-training layer 1, epoch 23, cost -255.717207642
Pre-training layer 1, epoch 24, cost -255.336131668
Pre-training layer 1, epoch 25, cost -254.715408249
Pre-training layer 1, epoch 25, representative training free energy -69747.2806426
Pre-training layer 1, epoch 25, validation free energy -69244.4429746
Pre-training layer 1, epoch 26, cost -254.218652191
Pre-training layer 1, epoch 27, cost -253.919103775
Pre-training layer 1, epoch 28, cost -253.371954346
Pre-training layer 1, epoch 29, cost -252.922828064
Pre-training layer 1, epoch 30, cost -252.458870544
Pre-training layer 1, epoch 30, representative training free energy -71024.368252
Pre-training layer 1, epoch 30, validation free energy -70518.0301523
Pre-training layer 1, epoch 31, cost -252.138477859
Pre-training layer 1, epoch 32, cost -251.795388031
Pre-training layer 1, epoch 33, cost -251.476684952
Pre-training layer 1, epoch 34, cost -251.090132675
Pre-training layer 1, epoch 35, cost -250.796639557
Pre-training layer 1, epoch 35, representative training free energy -72066.3520742
Pre-training layer 1, epoch 35, validation free energy -71537.3742227
Pre-training layer 1, epoch 36, cost -250.398592529
Pre-training layer 1, epoch 37, cost -250.21207489
Pre-training layer 1, epoch 38, cost -249.832430801
Pre-training layer 1, epoch 39, cost -249.718672028
Pre-training layer 1, epoch 40, cost -249.433936234
Pre-training layer 1, epoch 40, representative training free energy -72937.4120332
Pre-training layer 1, epoch 40, validation free energy -72409.0676348
Pre-training layer 1, epoch 41, cost -249.179273529
Pre-training layer 1, epoch 42, cost -248.923633881
Pre-training layer 1, epoch 43, cost -248.692108841
Pre-training layer 1, epoch 44, cost -248.596424026
Pre-training layer 1, epoch 45, cost -248.276124039
Pre-training layer 1, epoch 45, representative training free energy -73849.0193145
Pre-training layer 1, epoch 45, validation free energy -73309.2523203
Pre-training layer 1, epoch 46, cost -248.281060104
Pre-training layer 1, epoch 47, cost -247.955472794
Pre-training layer 1, epoch 48, cost -247.7568647
Pre-training layer 1, epoch 49, cost -247.503667984
Pre-training layer 1, epoch 50, cost -247.437859955
Pre-training layer 1, epoch 50, representative training free energy -74528.2462207
Pre-training layer 1, epoch 50, validation free energy -73995.9921699
Pre-training layer 1, epoch 51, cost -247.23795105
Pre-training layer 1, epoch 52, cost -247.032244415
Pre-training layer 1, epoch 53, cost -246.776856079
Pre-training layer 1, epoch 54, cost -246.654199448
Pre-training layer 1, epoch 55, cost -246.566162338
Pre-training layer 1, epoch 55, representative training free energy -75149.3592891
Pre-training layer 1, epoch 55, validation free energy -74602.3766777
Pre-training layer 1, epoch 56, cost -246.335031586
Pre-training layer 1, epoch 57, cost -246.342135925
Pre-training layer 1, epoch 58, cost -246.197997971
Pre-training layer 1, epoch 59, cost -245.962366791
Pre-training layer 1, epoch 60, cost -245.679706421
Pre-training layer 1, epoch 60, representative training free energy -75772.302373
Pre-training layer 1, epoch 60, validation free energy -75230.5268848
Pre-training layer 1, epoch 61, cost -245.56514328
Pre-training layer 1, epoch 62, cost -245.664061279
Pre-training layer 1, epoch 63, cost -245.528050461
Pre-training layer 1, epoch 64, cost -245.473512421
Pre-training layer 1, epoch 65, cost -245.246983719
Pre-training layer 1, epoch 65, representative training free energy -76389.1641074
Pre-training layer 1, epoch 65, validation free energy -75843.8596035
Pre-training layer 1, epoch 66, cost -245.002558441
Pre-training layer 1, epoch 67, cost -245.03849884
Pre-training layer 1, epoch 68, cost -244.770888901
Pre-training layer 1, epoch 69, cost -244.670210648
Pre-training layer 1, epoch 70, cost -244.756102829
Pre-training layer 1, epoch 70, representative training free energy -76831.9655156
Pre-training layer 1, epoch 70, validation free energy -76279.2424375
Pre-training layer 1, epoch 71, cost -244.494893188
Pre-training layer 1, epoch 72, cost -244.380394592
Pre-training layer 1, epoch 73, cost -244.377206573
Pre-training layer 1, epoch 74, cost -244.356958389
Pre-training layer 1, epoch 75, cost -244.156383286
Pre-training layer 1, epoch 75, representative training free energy -77265.3557891
Pre-training layer 1, epoch 75, validation free energy -76717.5637383
Pre-training layer 1, epoch 76, cost -244.069421005
Pre-training layer 1, epoch 77, cost -243.981836472
Pre-training layer 1, epoch 78, cost -243.8752314
Pre-training layer 1, epoch 79, cost -243.793039398
Pre-training layer 1, epoch 80, cost -243.850737457
Pre-training layer 1, epoch 80, representative training free energy -77691.2298223
Pre-training layer 1, epoch 80, validation free energy -77130.9520918
Pre-training layer 1, epoch 81, cost -243.749793777
Pre-training layer 1, epoch 82, cost -243.533684006
Pre-training layer 1, epoch 83, cost -243.431719894
Pre-training layer 1, epoch 84, cost -243.410029221
Pre-training layer 1, epoch 85, cost -243.473871002
Pre-training layer 1, epoch 85, representative training free energy -78136.3981602
Pre-training layer 1, epoch 85, validation free energy -77572.6373848
Pre-training layer 1, epoch 86, cost -243.352264404
Pre-training layer 1, epoch 87, cost -243.290846634
Pre-training layer 1, epoch 88, cost -242.949373093
Pre-training layer 1, epoch 89, cost -243.101397324
Pre-training layer 1, epoch 90, cost -243.010059814
Pre-training layer 1, epoch 90, representative training free energy -78523.6239336
Pre-training layer 1, epoch 90, validation free energy -77955.2629668
Pre-training layer 1, epoch 91, cost -243.032635498
Pre-training layer 1, epoch 92, cost -242.878015137
Pre-training layer 1, epoch 93, cost -242.815078812
Pre-training layer 1, epoch 94, cost -242.817604523
Pre-training layer 1, epoch 95, cost -242.638817825
Pre-training layer 1, epoch 95, representative training free energy -78885.3193672
Pre-training layer 1, epoch 95, validation free energy -78308.9792734
Pre-training layer 1, epoch 96, cost -242.651818695
Pre-training layer 1, epoch 97, cost -242.555178986
Pre-training layer 1, epoch 98, cost -242.455308609
Pre-training layer 1, epoch 99, cost -242.479753723
Pre-training layer 2, epoch 0, cost -137.131167984
Pre-training layer 2, epoch 0, representative training free energy 2506.7509205
Pre-training layer 2, epoch 0, validation free energy 2494.08249402
Pre-training layer 2, epoch 1, cost -98.0193456268
Pre-training layer 2, epoch 2, cost -89.7441448975
Pre-training layer 2, epoch 3, cost -85.3258290863
Pre-training layer 2, epoch 4, cost -82.1638191223
Pre-training layer 2, epoch 5, cost -79.8717630005
Pre-training layer 2, epoch 5, representative training free energy 3942.44988129
Pre-training layer 2, epoch 5, validation free energy 3914.49873871
Pre-training layer 2, epoch 6, cost -78.1971043205
Pre-training layer 2, epoch 7, cost -76.7903565216
Pre-training layer 2, epoch 8, cost -75.5003330612
Pre-training layer 2, epoch 9, cost -74.4801181984
Pre-training layer 2, epoch 10, cost -73.6488856316
Pre-training layer 2, epoch 10, representative training free energy 4594.38751611
Pre-training layer 2, epoch 10, validation free energy 4567.126479
Pre-training layer 2, epoch 11, cost -72.7263752556
Pre-training layer 2, epoch 12, cost -72.1647535896
Pre-training layer 2, epoch 13, cost -71.6017552376
Pre-training layer 2, epoch 14, cost -71.1391666031
Pre-training layer 2, epoch 15, cost -70.4673974228
Pre-training layer 2, epoch 15, representative training free energy 5141.58504651
Pre-training layer 2, epoch 15, validation free energy 5107.69693396
Pre-training layer 2, epoch 16, cost -70.1346941185
Pre-training layer 2, epoch 17, cost -69.7014029312
Pre-training layer 2, epoch 18, cost -69.1803355026
Pre-training layer 2, epoch 19, cost -69.0319511223
Pre-training layer 2, epoch 20, cost -68.6045573044
Pre-training layer 2, epoch 20, representative training free energy 5512.75216614
Pre-training layer 2, epoch 20, validation free energy 5476.04504956
Pre-training layer 2, epoch 21, cost -68.3866092873
Pre-training layer 2, epoch 22, cost -68.2041533852
Pre-training layer 2, epoch 23, cost -67.7451066971
Pre-training layer 2, epoch 24, cost -67.6591917229
Pre-training layer 2, epoch 25, cost -67.3295754242
Pre-training layer 2, epoch 25, representative training free energy 5845.08609424
Pre-training layer 2, epoch 25, validation free energy 5805.47036218
Pre-training layer 2, epoch 26, cost -67.256030159
Pre-training layer 2, epoch 27, cost -66.9427203178
Pre-training layer 2, epoch 28, cost -66.8734321976
Pre-training layer 2, epoch 29, cost -66.7566371918
Pre-training layer 2, epoch 30, cost -66.3512042236
Pre-training layer 2, epoch 30, representative training free energy 6169.14894006
Pre-training layer 2, epoch 30, validation free energy 6126.30786877
Pre-training layer 2, epoch 31, cost -66.2359026909
Pre-training layer 2, epoch 32, cost -66.0184707069
Pre-training layer 2, epoch 33, cost -65.9486901474
Pre-training layer 2, epoch 34, cost -65.7166763687
Pre-training layer 2, epoch 35, cost -65.5588625336
Pre-training layer 2, epoch 35, representative training free energy 6428.61331885
Pre-training layer 2, epoch 35, validation free energy 6388.20430518
Pre-training layer 2, epoch 36, cost -65.5143822289
Pre-training layer 2, epoch 37, cost -65.4660027885
Pre-training layer 2, epoch 38, cost -65.3586675453
Pre-training layer 2, epoch 39, cost -65.1084318352
Pre-training layer 2, epoch 40, cost -65.1866399765
Pre-training layer 2, epoch 40, representative training free energy 6683.49215149
Pre-training layer 2, epoch 40, validation free energy 6639.95859302
Pre-training layer 2, epoch 41, cost -64.9796516991
Pre-training layer 2, epoch 42, cost -64.8810641098
Pre-training layer 2, epoch 43, cost -64.7621305084
Pre-training layer 2, epoch 44, cost -64.7700196266
Pre-training layer 2, epoch 45, cost -64.7162836838
Pre-training layer 2, epoch 45, representative training free energy 6913.02242139
Pre-training layer 2, epoch 45, validation free energy 6866.72432788
Pre-training layer 2, epoch 46, cost -64.5062811852
Pre-training layer 2, epoch 47, cost -64.4509180069
Pre-training layer 2, epoch 48, cost -64.3785601807
Pre-training layer 2, epoch 49, cost -64.1945792198
Pre-training layer 2, epoch 50, cost -64.2110230446
Pre-training layer 2, epoch 50, representative training free energy 7088.9563728
Pre-training layer 2, epoch 50, validation free energy 7043.66143579
Pre-training layer 2, epoch 51, cost -64.0056501961
Pre-training layer 2, epoch 52, cost -64.1260195732
Pre-training layer 2, epoch 53, cost -64.1537846565
Pre-training layer 2, epoch 54, cost -63.8458257866
Pre-training layer 2, epoch 55, cost -63.7472997093
Pre-training layer 2, epoch 55, representative training free energy 7326.55905762
Pre-training layer 2, epoch 55, validation free energy 7275.44018579
Pre-training layer 2, epoch 56, cost -63.9111186028
Pre-training layer 2, epoch 57, cost -63.6425004387
Pre-training layer 2, epoch 58, cost -63.6559303093
Pre-training layer 2, epoch 59, cost -63.6354636765
Pre-training layer 2, epoch 60, cost -63.482464447
Pre-training layer 2, epoch 60, representative training free energy 7515.00347681
Pre-training layer 2, epoch 60, validation free energy 7460.74316357
Pre-training layer 2, epoch 61, cost -63.6052506256
Pre-training layer 2, epoch 62, cost -63.4625186157
Pre-training layer 2, epoch 63, cost -63.4510661888
Pre-training layer 2, epoch 64, cost -63.3211903763
Pre-training layer 2, epoch 65, cost -63.4060305595
Pre-training layer 2, epoch 65, representative training free energy 7705.85919092
Pre-training layer 2, epoch 65, validation free energy 7648.1526604
Pre-training layer 2, epoch 66, cost -63.2483091354
Pre-training layer 2, epoch 67, cost -63.3300701523
Pre-training layer 2, epoch 68, cost -63.1728824997
Pre-training layer 2, epoch 69, cost -63.0756146812
Pre-training layer 2, epoch 70, cost -63.1788270569
Pre-training layer 2, epoch 70, representative training free energy 7878.91564526
Pre-training layer 2, epoch 70, validation free energy 7819.02336621
Pre-training layer 2, epoch 71, cost -62.9226432991
Pre-training layer 2, epoch 72, cost -62.9310112
Pre-training layer 2, epoch 73, cost -62.9207877922
Pre-training layer 2, epoch 74, cost -62.8896024513
Pre-training layer 2, epoch 75, cost -62.9226947784
Pre-training layer 2, epoch 75, representative training free energy 8015.00979102
Pre-training layer 2, epoch 75, validation free energy 7955.97238599
Pre-training layer 2, epoch 76, cost -62.7738027954
Pre-training layer 2, epoch 77, cost -62.773612957
Pre-training layer 2, epoch 78, cost -62.7116100502
Pre-training layer 2, epoch 79, cost -62.6709139252
Pre-training layer 2, epoch 80, cost -62.7547198486
Pre-training layer 2, epoch 80, representative training free energy 8177.64520654
Pre-training layer 2, epoch 80, validation free energy 8117.07039966
Pre-training layer 2, epoch 81, cost -62.5476073647
Pre-training layer 2, epoch 82, cost -62.6508096123
Pre-training layer 2, epoch 83, cost -62.6242240524
Pre-training layer 2, epoch 84, cost -62.5220840645
Pre-training layer 2, epoch 85, cost -62.5705794716
Pre-training layer 2, epoch 85, representative training free energy 8340.44202905
Pre-training layer 2, epoch 85, validation free energy 8277.14645264
Pre-training layer 2, epoch 86, cost -62.4759432983
Pre-training layer 2, epoch 87, cost -62.5611561012
Pre-training layer 2, epoch 88, cost -62.3678853798
Pre-training layer 2, epoch 89, cost -62.42179245
Pre-training layer 2, epoch 90, cost -62.398908062
Pre-training layer 2, epoch 90, representative training free energy 8480.70451709
Pre-training layer 2, epoch 90, validation free energy 8412.46879614
Pre-training layer 2, epoch 91, cost -62.3697596931
Pre-training layer 2, epoch 92, cost -62.4075311089
Pre-training layer 2, epoch 93, cost -62.3281537819
Pre-training layer 2, epoch 94, cost -62.2770791054
Pre-training layer 2, epoch 95, cost -62.3114024353
Pre-training layer 2, epoch 95, representative training free energy 8639.47817383
Pre-training layer 2, epoch 95, validation free energy 8570.28480786
Pre-training layer 2, epoch 96, cost -62.2464275169
Pre-training layer 2, epoch 97, cost -62.1893049622
Pre-training layer 2, epoch 98, cost -62.1818067741
Pre-training layer 2, epoch 99, cost -62.1466327477
The pretraining code for file dbn_loop.pyc ran for 5.37m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 34.400000 %
     epoch 1, minibatch 200/200, test error of best model 29.700000 %
epoch 2, minibatch 200/200, validation error 25.300000 %
     epoch 2, minibatch 200/200, test error of best model 17.800000 %
epoch 3, minibatch 200/200, validation error 22.100000 %
     epoch 3, minibatch 200/200, test error of best model 14.200000 %
epoch 4, minibatch 200/200, validation error 20.900000 %
     epoch 4, minibatch 200/200, test error of best model 12.800000 %
epoch 5, minibatch 200/200, validation error 19.800000 %
     epoch 5, minibatch 200/200, test error of best model 11.900000 %
epoch 6, minibatch 200/200, validation error 19.300000 %
     epoch 6, minibatch 200/200, test error of best model 10.900000 %
epoch 7, minibatch 200/200, validation error 19.000000 %
     epoch 7, minibatch 200/200, test error of best model 9.900000 %
epoch 8, minibatch 200/200, validation error 18.600000 %
     epoch 8, minibatch 200/200, test error of best model 8.900000 %
epoch 9, minibatch 200/200, validation error 18.300000 %
     epoch 9, minibatch 200/200, test error of best model 8.500000 %
epoch 10, minibatch 200/200, validation error 17.700000 %
     epoch 10, minibatch 200/200, test error of best model 8.200000 %
epoch 11, minibatch 200/200, validation error 17.300000 %
     epoch 11, minibatch 200/200, test error of best model 8.100000 %
epoch 12, minibatch 200/200, validation error 17.100000 %
     epoch 12, minibatch 200/200, test error of best model 7.700000 %
epoch 13, minibatch 200/200, validation error 16.900000 %
     epoch 13, minibatch 200/200, test error of best model 7.800000 %
epoch 14, minibatch 200/200, validation error 16.800000 %
     epoch 14, minibatch 200/200, test error of best model 7.800000 %
epoch 15, minibatch 200/200, validation error 16.700000 %
     epoch 15, minibatch 200/200, test error of best model 7.800000 %
epoch 16, minibatch 200/200, validation error 16.500000 %
     epoch 16, minibatch 200/200, test error of best model 7.700000 %
epoch 17, minibatch 200/200, validation error 16.400000 %
     epoch 17, minibatch 200/200, test error of best model 7.500000 %
epoch 18, minibatch 200/200, validation error 16.400000 %
epoch 19, minibatch 200/200, validation error 16.400000 %
epoch 20, minibatch 200/200, validation error 16.400000 %
epoch 21, minibatch 200/200, validation error 16.500000 %
epoch 22, minibatch 200/200, validation error 16.400000 %
epoch 23, minibatch 200/200, validation error 16.300000 %
     epoch 23, minibatch 200/200, test error of best model 7.600000 %
epoch 24, minibatch 200/200, validation error 16.200000 %
     epoch 24, minibatch 200/200, test error of best model 7.600000 %
epoch 25, minibatch 200/200, validation error 16.100000 %
     epoch 25, minibatch 200/200, test error of best model 7.600000 %
epoch 26, minibatch 200/200, validation error 16.100000 %
epoch 27, minibatch 200/200, validation error 16.000000 %
     epoch 27, minibatch 200/200, test error of best model 7.500000 %
epoch 28, minibatch 200/200, validation error 16.100000 %
epoch 29, minibatch 200/200, validation error 16.100000 %
epoch 30, minibatch 200/200, validation error 16.100000 %
epoch 31, minibatch 200/200, validation error 16.100000 %
epoch 32, minibatch 200/200, validation error 16.100000 %
epoch 33, minibatch 200/200, validation error 16.100000 %
epoch 34, minibatch 200/200, validation error 16.100000 %
epoch 35, minibatch 200/200, validation error 16.100000 %
epoch 36, minibatch 200/200, validation error 16.100000 %
epoch 37, minibatch 200/200, validation error 16.100000 %
epoch 38, minibatch 200/200, validation error 15.900000 %
     epoch 38, minibatch 200/200, test error of best model 7.500000 %
epoch 39, minibatch 200/200, validation error 15.900000 %
epoch 40, minibatch 200/200, validation error 15.900000 %
epoch 41, minibatch 200/200, validation error 16.000000 %
epoch 42, minibatch 200/200, validation error 15.900000 %
epoch 43, minibatch 200/200, validation error 15.900000 %
epoch 44, minibatch 200/200, validation error 15.900000 %
epoch 45, minibatch 200/200, validation error 15.900000 %
epoch 46, minibatch 200/200, validation error 15.900000 %
epoch 47, minibatch 200/200, validation error 15.900000 %
epoch 48, minibatch 200/200, validation error 15.900000 %
epoch 49, minibatch 200/200, validation error 15.900000 %
epoch 50, minibatch 200/200, validation error 15.900000 %
epoch 51, minibatch 200/200, validation error 15.800000 %
     epoch 51, minibatch 200/200, test error of best model 7.300000 %
epoch 52, minibatch 200/200, validation error 15.800000 %
epoch 53, minibatch 200/200, validation error 15.800000 %
epoch 54, minibatch 200/200, validation error 15.800000 %
epoch 55, minibatch 200/200, validation error 15.800000 %
epoch 56, minibatch 200/200, validation error 15.800000 %
epoch 57, minibatch 200/200, validation error 15.800000 %
epoch 58, minibatch 200/200, validation error 15.800000 %
epoch 59, minibatch 200/200, validation error 15.900000 %
epoch 60, minibatch 200/200, validation error 16.000000 %
epoch 61, minibatch 200/200, validation error 16.000000 %
epoch 62, minibatch 200/200, validation error 16.000000 %
epoch 63, minibatch 200/200, validation error 16.000000 %
epoch 64, minibatch 200/200, validation error 16.000000 %
epoch 65, minibatch 200/200, validation error 16.000000 %
epoch 66, minibatch 200/200, validation error 16.000000 %
epoch 67, minibatch 200/200, validation error 16.000000 %
epoch 68, minibatch 200/200, validation error 16.100000 %
epoch 69, minibatch 200/200, validation error 16.100000 %
epoch 70, minibatch 200/200, validation error 16.100000 %
epoch 71, minibatch 200/200, validation error 16.100000 %
epoch 72, minibatch 200/200, validation error 16.100000 %
epoch 73, minibatch 200/200, validation error 16.100000 %
epoch 74, minibatch 200/200, validation error 16.100000 %
epoch 75, minibatch 200/200, validation error 16.100000 %
epoch 76, minibatch 200/200, validation error 16.100000 %
epoch 77, minibatch 200/200, validation error 16.200000 %
epoch 78, minibatch 200/200, validation error 16.200000 %
epoch 79, minibatch 200/200, validation error 16.200000 %
epoch 80, minibatch 200/200, validation error 16.200000 %
epoch 81, minibatch 200/200, validation error 16.200000 %
epoch 82, minibatch 200/200, validation error 16.200000 %
epoch 83, minibatch 200/200, validation error 16.200000 %
epoch 84, minibatch 200/200, validation error 16.200000 %
epoch 85, minibatch 200/200, validation error 16.200000 %
epoch 86, minibatch 200/200, validation error 16.200000 %
epoch 87, minibatch 200/200, validation error 16.200000 %
epoch 88, minibatch 200/200, validation error 16.200000 %
epoch 89, minibatch 200/200, validation error 16.200000 %
epoch 90, minibatch 200/200, validation error 16.200000 %
epoch 91, minibatch 200/200, validation error 16.200000 %
epoch 92, minibatch 200/200, validation error 16.200000 %
epoch 93, minibatch 200/200, validation error 16.200000 %
epoch 94, minibatch 200/200, validation error 16.200000 %
epoch 95, minibatch 200/200, validation error 16.200000 %
epoch 96, minibatch 200/200, validation error 16.200000 %
epoch 97, minibatch 200/200, validation error 16.200000 %
epoch 98, minibatch 200/200, validation error 16.200000 %
epoch 99, minibatch 200/200, validation error 16.200000 %
epoch 100, minibatch 200/200, validation error 16.200000 %
epoch 101, minibatch 200/200, validation error 16.200000 %
Optimization complete with best validation score of 15.800000 %, obtained at iteration 10200, with test performance 7.300000 %
The fine tuning code for file dbn_loop.pyc ran for 1.92m


==========Sample: (3000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.824014613
Pre-training layer 0, epoch 0, representative training free energy -559.266745209
Pre-training layer 0, epoch 0, validation free energy -555.281570587
Pre-training layer 0, epoch 1, cost -116.712467728
Pre-training layer 0, epoch 2, cost -107.989302597
Pre-training layer 0, epoch 3, cost -102.759476446
Pre-training layer 0, epoch 4, cost -99.3170526377
Pre-training layer 0, epoch 5, cost -96.4520076243
Pre-training layer 0, epoch 5, representative training free energy -497.517434052
Pre-training layer 0, epoch 5, validation free energy -491.294843964
Pre-training layer 0, epoch 6, cost -94.4775853729
Pre-training layer 0, epoch 7, cost -92.7277794139
Pre-training layer 0, epoch 8, cost -91.4570259094
Pre-training layer 0, epoch 9, cost -90.2347125753
Pre-training layer 0, epoch 10, cost -89.1127829488
Pre-training layer 0, epoch 10, representative training free energy -480.930834808
Pre-training layer 0, epoch 10, validation free energy -473.050672913
Pre-training layer 0, epoch 11, cost -88.3240165456
Pre-training layer 0, epoch 12, cost -87.6152063497
Pre-training layer 0, epoch 13, cost -86.746371905
Pre-training layer 0, epoch 14, cost -86.088628006
Pre-training layer 0, epoch 15, cost -85.4399938838
Pre-training layer 0, epoch 15, representative training free energy -469.342693207
Pre-training layer 0, epoch 15, validation free energy -461.643964783
Pre-training layer 0, epoch 16, cost -84.7803050995
Pre-training layer 0, epoch 17, cost -84.4626886622
Pre-training layer 0, epoch 18, cost -83.8688360596
Pre-training layer 0, epoch 19, cost -83.5984044266
Pre-training layer 0, epoch 20, cost -83.0479849752
Pre-training layer 0, epoch 20, representative training free energy -459.566204163
Pre-training layer 0, epoch 20, validation free energy -452.017692871
Pre-training layer 0, epoch 21, cost -82.82402668
Pre-training layer 0, epoch 22, cost -82.5781197993
Pre-training layer 0, epoch 23, cost -82.0571346537
Pre-training layer 0, epoch 24, cost -81.6403336716
Pre-training layer 0, epoch 25, cost -81.3476667023
Pre-training layer 0, epoch 25, representative training free energy -452.608003052
Pre-training layer 0, epoch 25, validation free energy -444.614116119
Pre-training layer 0, epoch 26, cost -81.1733199819
Pre-training layer 0, epoch 27, cost -80.9025958125
Pre-training layer 0, epoch 28, cost -80.655681661
Pre-training layer 0, epoch 29, cost -80.2950293477
Pre-training layer 0, epoch 30, cost -80.0281708018
Pre-training layer 0, epoch 30, representative training free energy -447.058893463
Pre-training layer 0, epoch 30, validation free energy -438.794726074
Pre-training layer 0, epoch 31, cost -79.848528773
Pre-training layer 0, epoch 32, cost -79.667099851
Pre-training layer 0, epoch 33, cost -79.4427817535
Pre-training layer 0, epoch 34, cost -79.2914294306
Pre-training layer 0, epoch 35, cost -79.0236221568
Pre-training layer 0, epoch 35, representative training free energy -442.853877014
Pre-training layer 0, epoch 35, validation free energy -434.741954163
Pre-training layer 0, epoch 36, cost -78.8303009796
Pre-training layer 0, epoch 37, cost -78.6825723775
Pre-training layer 0, epoch 38, cost -78.5125358454
Pre-training layer 0, epoch 39, cost -78.2231554794
Pre-training layer 0, epoch 40, cost -78.3020928701
Pre-training layer 0, epoch 40, representative training free energy -442.399255096
Pre-training layer 0, epoch 40, validation free energy -433.389608459
Pre-training layer 0, epoch 41, cost -78.2085550308
Pre-training layer 0, epoch 42, cost -78.0701497014
Pre-training layer 0, epoch 43, cost -77.8075656382
Pre-training layer 0, epoch 44, cost -77.6457134247
Pre-training layer 0, epoch 45, cost -77.6183241272
Pre-training layer 0, epoch 45, representative training free energy -442.422774475
Pre-training layer 0, epoch 45, validation free energy -433.742090393
Pre-training layer 0, epoch 46, cost -77.3300809733
Pre-training layer 0, epoch 47, cost -77.1253602473
Pre-training layer 0, epoch 48, cost -77.2156959279
Pre-training layer 0, epoch 49, cost -77.0952251434
Pre-training layer 0, epoch 50, cost -76.8325045904
Pre-training layer 0, epoch 50, representative training free energy -439.094122009
Pre-training layer 0, epoch 50, validation free energy -429.601804535
Pre-training layer 0, epoch 51, cost -76.7248252233
Pre-training layer 0, epoch 52, cost -76.6772598267
Pre-training layer 0, epoch 53, cost -76.6421230698
Pre-training layer 0, epoch 54, cost -76.3217111206
Pre-training layer 0, epoch 55, cost -76.3673936462
Pre-training layer 0, epoch 55, representative training free energy -438.516520691
Pre-training layer 0, epoch 55, validation free energy -428.110197235
Pre-training layer 0, epoch 56, cost -76.3332690938
Pre-training layer 0, epoch 57, cost -76.2205629985
Pre-training layer 0, epoch 58, cost -75.9713682048
Pre-training layer 0, epoch 59, cost -75.8259470749
Pre-training layer 0, epoch 60, cost -75.7106765493
Pre-training layer 0, epoch 60, representative training free energy -437.88886911
Pre-training layer 0, epoch 60, validation free energy -427.762376221
Pre-training layer 0, epoch 61, cost -75.7230858612
Pre-training layer 0, epoch 62, cost -75.6920308304
Pre-training layer 0, epoch 63, cost -75.5161402639
Pre-training layer 0, epoch 64, cost -75.5788323339
Pre-training layer 0, epoch 65, cost -75.3071423721
Pre-training layer 0, epoch 65, representative training free energy -434.534128693
Pre-training layer 0, epoch 65, validation free energy -424.653773987
Pre-training layer 0, epoch 66, cost -75.320436821
Pre-training layer 0, epoch 67, cost -75.24413709
Pre-training layer 0, epoch 68, cost -75.0830708059
Pre-training layer 0, epoch 69, cost -75.0772876231
Pre-training layer 0, epoch 70, cost -75.0379810842
Pre-training layer 0, epoch 70, representative training free energy -433.950723969
Pre-training layer 0, epoch 70, validation free energy -423.905689484
Pre-training layer 0, epoch 71, cost -74.9669359207
Pre-training layer 0, epoch 72, cost -74.8253237152
Pre-training layer 0, epoch 73, cost -74.8855111567
Pre-training layer 0, epoch 74, cost -74.6954007212
Pre-training layer 0, epoch 75, cost -74.5828177134
Pre-training layer 0, epoch 75, representative training free energy -434.347299622
Pre-training layer 0, epoch 75, validation free energy -423.792799652
Pre-training layer 0, epoch 76, cost -74.7212090556
Pre-training layer 0, epoch 77, cost -74.4827097956
Pre-training layer 0, epoch 78, cost -74.455823733
Pre-training layer 0, epoch 79, cost -74.4080544281
Pre-training layer 0, epoch 80, cost -74.3384667206
Pre-training layer 0, epoch 80, representative training free energy -432.299164276
Pre-training layer 0, epoch 80, validation free energy -422.036979279
Pre-training layer 0, epoch 81, cost -74.2243836339
Pre-training layer 0, epoch 82, cost -74.1739270528
Pre-training layer 0, epoch 83, cost -74.0534879176
Pre-training layer 0, epoch 84, cost -74.0143115616
Pre-training layer 0, epoch 85, cost -73.9651994578
Pre-training layer 0, epoch 85, representative training free energy -433.084472565
Pre-training layer 0, epoch 85, validation free energy -421.868211945
Pre-training layer 0, epoch 86, cost -74.0859773763
Pre-training layer 0, epoch 87, cost -73.9580056508
Pre-training layer 0, epoch 88, cost -73.9061302439
Pre-training layer 0, epoch 89, cost -73.8731307729
Pre-training layer 0, epoch 90, cost -73.7117211533
Pre-training layer 0, epoch 90, representative training free energy -432.053811737
Pre-training layer 0, epoch 90, validation free energy -421.099983063
Pre-training layer 0, epoch 91, cost -73.7303074773
Pre-training layer 0, epoch 92, cost -73.6244563421
Pre-training layer 0, epoch 93, cost -73.4976285807
Pre-training layer 0, epoch 94, cost -73.4407401021
Pre-training layer 0, epoch 95, cost -73.5402551015
Pre-training layer 0, epoch 95, representative training free energy -429.846065765
Pre-training layer 0, epoch 95, validation free energy -418.661564484
Pre-training layer 0, epoch 96, cost -73.4165212631
Pre-training layer 0, epoch 97, cost -73.3380330785
Pre-training layer 0, epoch 98, cost -73.3380888112
Pre-training layer 0, epoch 99, cost -73.3610678355
Pre-training layer 1, epoch 0, cost -345.020192312
Pre-training layer 1, epoch 0, representative training free energy -50651.4009316
Pre-training layer 1, epoch 0, validation free energy -50256.4117109
Pre-training layer 1, epoch 1, cost -296.335026296
Pre-training layer 1, epoch 2, cost -281.603400777
Pre-training layer 1, epoch 3, cost -272.614980418
Pre-training layer 1, epoch 4, cost -266.387137705
Pre-training layer 1, epoch 5, cost -261.872439677
Pre-training layer 1, epoch 5, representative training free energy -68634.7692422
Pre-training layer 1, epoch 5, validation free energy -68108.8793691
Pre-training layer 1, epoch 6, cost -258.189829051
Pre-training layer 1, epoch 7, cost -255.301743368
Pre-training layer 1, epoch 8, cost -252.784177297
Pre-training layer 1, epoch 9, cost -250.784914856
Pre-training layer 1, epoch 10, cost -248.965730184
Pre-training layer 1, epoch 10, representative training free energy -74082.0173926
Pre-training layer 1, epoch 10, validation free energy -73508.9010586
Pre-training layer 1, epoch 11, cost -247.534917653
Pre-training layer 1, epoch 12, cost -246.177658437
Pre-training layer 1, epoch 13, cost -244.937205811
Pre-training layer 1, epoch 14, cost -243.897917938
Pre-training layer 1, epoch 15, cost -242.97588623
Pre-training layer 1, epoch 15, representative training free energy -77263.4655137
Pre-training layer 1, epoch 15, validation free energy -76653.4472813
Pre-training layer 1, epoch 16, cost -242.058101145
Pre-training layer 1, epoch 17, cost -241.264231923
Pre-training layer 1, epoch 18, cost -240.558292542
Pre-training layer 1, epoch 19, cost -239.971058095
Pre-training layer 1, epoch 20, cost -239.277102305
Pre-training layer 1, epoch 20, representative training free energy -79560.8360996
Pre-training layer 1, epoch 20, validation free energy -78926.9121758
Pre-training layer 1, epoch 21, cost -238.670868479
Pre-training layer 1, epoch 22, cost -238.237538198
Pre-training layer 1, epoch 23, cost -237.700673879
Pre-training layer 1, epoch 24, cost -237.172868347
Pre-training layer 1, epoch 25, cost -236.910137329
Pre-training layer 1, epoch 25, representative training free energy -81334.9994668
Pre-training layer 1, epoch 25, validation free energy -80679.9448047
Pre-training layer 1, epoch 26, cost -236.449612935
Pre-training layer 1, epoch 27, cost -236.094264119
Pre-training layer 1, epoch 28, cost -235.645622864
Pre-training layer 1, epoch 29, cost -235.313555959
Pre-training layer 1, epoch 30, cost -235.05439799
Pre-training layer 1, epoch 30, representative training free energy -82688.374043
Pre-training layer 1, epoch 30, validation free energy -82023.8875977
Pre-training layer 1, epoch 31, cost -234.764208832
Pre-training layer 1, epoch 32, cost -234.390886434
Pre-training layer 1, epoch 33, cost -234.227298024
Pre-training layer 1, epoch 34, cost -233.880657806
Pre-training layer 1, epoch 35, cost -233.706000824
Pre-training layer 1, epoch 35, representative training free energy -84061.7960566
Pre-training layer 1, epoch 35, validation free energy -83378.1621602
Pre-training layer 1, epoch 36, cost -233.391909281
Pre-training layer 1, epoch 37, cost -233.251713613
Pre-training layer 1, epoch 38, cost -232.893071798
Pre-training layer 1, epoch 39, cost -232.779011739
Pre-training layer 1, epoch 40, cost -232.46931605
Pre-training layer 1, epoch 40, representative training free energy -85021.6952852
Pre-training layer 1, epoch 40, validation free energy -84326.4208613
Pre-training layer 1, epoch 41, cost -232.274917297
Pre-training layer 1, epoch 42, cost -232.12110316
Pre-training layer 1, epoch 43, cost -231.852624715
Pre-training layer 1, epoch 44, cost -231.704178975
Pre-training layer 1, epoch 45, cost -231.641677856
Pre-training layer 1, epoch 45, representative training free energy -85989.3308047
Pre-training layer 1, epoch 45, validation free energy -85271.2102852
Pre-training layer 1, epoch 46, cost -231.46652593
Pre-training layer 1, epoch 47, cost -231.309266917
Pre-training layer 1, epoch 48, cost -231.073212331
Pre-training layer 1, epoch 49, cost -230.973424886
Pre-training layer 1, epoch 50, cost -230.832937622
Pre-training layer 1, epoch 50, representative training free energy -86854.9426211
Pre-training layer 1, epoch 50, validation free energy -86141.6080781
Pre-training layer 1, epoch 51, cost -230.707829488
Pre-training layer 1, epoch 52, cost -230.484540456
Pre-training layer 1, epoch 53, cost -230.469749044
Pre-training layer 1, epoch 54, cost -230.185168762
Pre-training layer 1, epoch 55, cost -230.080126088
Pre-training layer 1, epoch 55, representative training free energy -87642.8143359
Pre-training layer 1, epoch 55, validation free energy -86928.836459
Pre-training layer 1, epoch 56, cost -230.081992594
Pre-training layer 1, epoch 57, cost -229.80085851
Pre-training layer 1, epoch 58, cost -229.799742737
Pre-training layer 1, epoch 59, cost -229.668625641
Pre-training layer 1, epoch 60, cost -229.618116048
Pre-training layer 1, epoch 60, representative training free energy -88285.942582
Pre-training layer 1, epoch 60, validation free energy -87552.0401934
Pre-training layer 1, epoch 61, cost -229.366086426
Pre-training layer 1, epoch 62, cost -229.302871297
Pre-training layer 1, epoch 63, cost -229.261623942
Pre-training layer 1, epoch 64, cost -229.119964345
Pre-training layer 1, epoch 65, cost -229.091915487
Pre-training layer 1, epoch 65, representative training free energy -88924.0736152
Pre-training layer 1, epoch 65, validation free energy -88181.4266543
Pre-training layer 1, epoch 66, cost -228.951544902
Pre-training layer 1, epoch 67, cost -228.783741862
Pre-training layer 1, epoch 68, cost -228.810238342
Pre-training layer 1, epoch 69, cost -228.613799744
Pre-training layer 1, epoch 70, cost -228.419066264
Pre-training layer 1, epoch 70, representative training free energy -89534.7266348
Pre-training layer 1, epoch 70, validation free energy -88788.9545879
Pre-training layer 1, epoch 71, cost -228.477045848
Pre-training layer 1, epoch 72, cost -228.344856466
Pre-training layer 1, epoch 73, cost -228.257827555
Pre-training layer 1, epoch 74, cost -228.209679108
Pre-training layer 1, epoch 75, cost -228.060483958
Pre-training layer 1, epoch 75, representative training free energy -90099.6512715
Pre-training layer 1, epoch 75, validation free energy -89339.7491035
Pre-training layer 1, epoch 76, cost -228.010067495
Pre-training layer 1, epoch 77, cost -228.032183228
Pre-training layer 1, epoch 78, cost -227.862268626
Pre-training layer 1, epoch 79, cost -227.804707387
Pre-training layer 1, epoch 80, cost -227.789709422
Pre-training layer 1, epoch 80, representative training free energy -90655.0130117
Pre-training layer 1, epoch 80, validation free energy -89906.3363301
Pre-training layer 1, epoch 81, cost -227.63277888
Pre-training layer 1, epoch 82, cost -227.665613658
Pre-training layer 1, epoch 83, cost -227.605852814
Pre-training layer 1, epoch 84, cost -227.4368809
Pre-training layer 1, epoch 85, cost -227.392526957
Pre-training layer 1, epoch 85, representative training free energy -91193.1351719
Pre-training layer 1, epoch 85, validation free energy -90431.5666035
Pre-training layer 1, epoch 86, cost -227.282658386
Pre-training layer 1, epoch 87, cost -227.367453359
Pre-training layer 1, epoch 88, cost -227.239474538
Pre-training layer 1, epoch 89, cost -227.165104218
Pre-training layer 1, epoch 90, cost -227.144575195
Pre-training layer 1, epoch 90, representative training free energy -91540.8014414
Pre-training layer 1, epoch 90, validation free energy -90772.9180254
Pre-training layer 1, epoch 91, cost -227.060070394
Pre-training layer 1, epoch 92, cost -226.90962321
Pre-training layer 1, epoch 93, cost -226.966515656
Pre-training layer 1, epoch 94, cost -226.824597778
Pre-training layer 1, epoch 95, cost -226.851882375
Pre-training layer 1, epoch 95, representative training free energy -91927.717084
Pre-training layer 1, epoch 95, validation free energy -91146.2324277
Pre-training layer 1, epoch 96, cost -226.79024236
Pre-training layer 1, epoch 97, cost -226.747221018
Pre-training layer 1, epoch 98, cost -226.786005554
Pre-training layer 1, epoch 99, cost -226.661323598
Pre-training layer 2, epoch 0, cost -129.620505397
Pre-training layer 2, epoch 0, representative training free energy 2960.34435071
Pre-training layer 2, epoch 0, validation free energy 2928.63667419
Pre-training layer 2, epoch 1, cost -95.7953531901
Pre-training layer 2, epoch 2, cost -88.5096931966
Pre-training layer 2, epoch 3, cost -84.4693497086
Pre-training layer 2, epoch 4, cost -81.5584044393
Pre-training layer 2, epoch 5, cost -79.4923716482
Pre-training layer 2, epoch 5, representative training free energy 4715.35074731
Pre-training layer 2, epoch 5, validation free energy 4677.97323621
Pre-training layer 2, epoch 6, cost -77.8667305628
Pre-training layer 2, epoch 7, cost -76.7561361949
Pre-training layer 2, epoch 8, cost -75.7239832942
Pre-training layer 2, epoch 9, cost -74.7276487478
Pre-training layer 2, epoch 10, cost -73.7511329778
Pre-training layer 2, epoch 10, representative training free energy 5601.18346375
Pre-training layer 2, epoch 10, validation free energy 5559.72629602
Pre-training layer 2, epoch 11, cost -73.325878334
Pre-training layer 2, epoch 12, cost -72.603389918
Pre-training layer 2, epoch 13, cost -72.1373600769
Pre-training layer 2, epoch 14, cost -71.5816141129
Pre-training layer 2, epoch 15, cost -71.2000408554
Pre-training layer 2, epoch 15, representative training free energy 6347.72492151
Pre-training layer 2, epoch 15, validation free energy 6294.55139697
Pre-training layer 2, epoch 16, cost -70.7189726003
Pre-training layer 2, epoch 17, cost -70.4474419403
Pre-training layer 2, epoch 18, cost -70.1238015747
Pre-training layer 2, epoch 19, cost -69.7694595464
Pre-training layer 2, epoch 20, cost -69.5129978561
Pre-training layer 2, epoch 20, representative training free energy 6953.66620728
Pre-training layer 2, epoch 20, validation free energy 6893.04975732
Pre-training layer 2, epoch 21, cost -69.3042919413
Pre-training layer 2, epoch 22, cost -69.0232427851
Pre-training layer 2, epoch 23, cost -68.7692998632
Pre-training layer 2, epoch 24, cost -68.5093832143
Pre-training layer 2, epoch 25, cost -68.3760577647
Pre-training layer 2, epoch 25, representative training free energy 7428.52532056
Pre-training layer 2, epoch 25, validation free energy 7364.7189043
Pre-training layer 2, epoch 26, cost -68.3308443832
Pre-training layer 2, epoch 27, cost -68.0537855911
Pre-training layer 2, epoch 28, cost -67.8454008865
Pre-training layer 2, epoch 29, cost -67.8122288386
Pre-training layer 2, epoch 30, cost -67.5937813059
Pre-training layer 2, epoch 30, representative training free energy 7856.66741382
Pre-training layer 2, epoch 30, validation free energy 7790.13275293
Pre-training layer 2, epoch 31, cost -67.4514495087
Pre-training layer 2, epoch 32, cost -67.4091006215
Pre-training layer 2, epoch 33, cost -67.2920761363
Pre-training layer 2, epoch 34, cost -67.0813534673
Pre-training layer 2, epoch 35, cost -66.9192855962
Pre-training layer 2, epoch 35, representative training free energy 8275.43192285
Pre-training layer 2, epoch 35, validation free energy 8203.79117896
Pre-training layer 2, epoch 36, cost -66.8436992009
Pre-training layer 2, epoch 37, cost -66.8077007802
Pre-training layer 2, epoch 38, cost -66.6746483866
Pre-training layer 2, epoch 39, cost -66.4941343053
Pre-training layer 2, epoch 40, cost -66.5283625666
Pre-training layer 2, epoch 40, representative training free energy 8621.41585547
Pre-training layer 2, epoch 40, validation free energy 8546.03569946
Pre-training layer 2, epoch 41, cost -66.3937073008
Pre-training layer 2, epoch 42, cost -66.3857854207
Pre-training layer 2, epoch 43, cost -66.2520787938
Pre-training layer 2, epoch 44, cost -66.098631223
Pre-training layer 2, epoch 45, cost -66.0885056686
Pre-training layer 2, epoch 45, representative training free energy 8913.9029502
Pre-training layer 2, epoch 45, validation free energy 8836.09047144
Pre-training layer 2, epoch 46, cost -65.9978782527
Pre-training layer 2, epoch 47, cost -65.9213380559
Pre-training layer 2, epoch 48, cost -65.9282188161
Pre-training layer 2, epoch 49, cost -65.7128767014
Pre-training layer 2, epoch 50, cost -65.8053579076
Pre-training layer 2, epoch 50, representative training free energy 9223.05132031
Pre-training layer 2, epoch 50, validation free energy 9141.19678101
Pre-training layer 2, epoch 51, cost -65.6109958776
Pre-training layer 2, epoch 52, cost -65.5367436981
Pre-training layer 2, epoch 53, cost -65.6182249705
Pre-training layer 2, epoch 54, cost -65.4902362061
Pre-training layer 2, epoch 55, cost -65.5175989532
Pre-training layer 2, epoch 55, representative training free energy 9490.83212231
Pre-training layer 2, epoch 55, validation free energy 9403.99773022
Pre-training layer 2, epoch 56, cost -65.4190907796
Pre-training layer 2, epoch 57, cost -65.3024144872
Pre-training layer 2, epoch 58, cost -65.3308473969
Pre-training layer 2, epoch 59, cost -65.268128713
Pre-training layer 2, epoch 60, cost -65.2457592392
Pre-training layer 2, epoch 60, representative training free energy 9740.99168945
Pre-training layer 2, epoch 60, validation free energy 9651.56969336
Pre-training layer 2, epoch 61, cost -65.1572715759
Pre-training layer 2, epoch 62, cost -65.0651847839
Pre-training layer 2, epoch 63, cost -65.045468483
Pre-training layer 2, epoch 64, cost -64.9382458878
Pre-training layer 2, epoch 65, cost -64.9460329564
Pre-training layer 2, epoch 65, representative training free energy 9999.45455664
Pre-training layer 2, epoch 65, validation free energy 9906.82493726
Pre-training layer 2, epoch 66, cost -64.92210097
Pre-training layer 2, epoch 67, cost -64.8566245906
Pre-training layer 2, epoch 68, cost -64.9680586243
Pre-training layer 2, epoch 69, cost -64.8240053558
Pre-training layer 2, epoch 70, cost -64.7217458089
Pre-training layer 2, epoch 70, representative training free energy 10239.1248804
Pre-training layer 2, epoch 70, validation free energy 10144.1676074
Pre-training layer 2, epoch 71, cost -64.734979833
Pre-training layer 2, epoch 72, cost -64.7947189458
Pre-training layer 2, epoch 73, cost -64.6268002828
Pre-training layer 2, epoch 74, cost -64.6991644033
Pre-training layer 2, epoch 75, cost -64.6388739014
Pre-training layer 2, epoch 75, representative training free energy 10489.9066355
Pre-training layer 2, epoch 75, validation free energy 10391.6738674
Pre-training layer 2, epoch 76, cost -64.5669761276
Pre-training layer 2, epoch 77, cost -64.6566692479
Pre-training layer 2, epoch 78, cost -64.5306386693
Pre-training layer 2, epoch 79, cost -64.4667600759
Pre-training layer 2, epoch 80, cost -64.451269811
Pre-training layer 2, epoch 80, representative training free energy 10696.2065989
Pre-training layer 2, epoch 80, validation free energy 10594.2284583
Pre-training layer 2, epoch 81, cost -64.4561271032
Pre-training layer 2, epoch 82, cost -64.3642449061
Pre-training layer 2, epoch 83, cost -64.4463525136
Pre-training layer 2, epoch 84, cost -64.2696055857
Pre-training layer 2, epoch 85, cost -64.2623439916
Pre-training layer 2, epoch 85, representative training free energy 10917.6997437
Pre-training layer 2, epoch 85, validation free energy 10813.5141216
Pre-training layer 2, epoch 86, cost -64.3383984248
Pre-training layer 2, epoch 87, cost -64.4040527344
Pre-training layer 2, epoch 88, cost -64.219854393
Pre-training layer 2, epoch 89, cost -64.1894656626
Pre-training layer 2, epoch 90, cost -64.257149442
Pre-training layer 2, epoch 90, representative training free energy 11100.6018118
Pre-training layer 2, epoch 90, validation free energy 10995.0564546
Pre-training layer 2, epoch 91, cost -64.1870665359
Pre-training layer 2, epoch 92, cost -64.1868980916
Pre-training layer 2, epoch 93, cost -64.1669727707
Pre-training layer 2, epoch 94, cost -64.1157440567
Pre-training layer 2, epoch 95, cost -64.1322687276
Pre-training layer 2, epoch 95, representative training free energy 11328.3755361
Pre-training layer 2, epoch 95, validation free energy 11219.4089226
Pre-training layer 2, epoch 96, cost -64.0391652044
Pre-training layer 2, epoch 97, cost -64.0294866562
Pre-training layer 2, epoch 98, cost -63.9868333817
Pre-training layer 2, epoch 99, cost -63.9746983337
The pretraining code for file dbn_loop.pyc ran for 7.92m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 34.900000 %
     epoch 1, minibatch 300/300, test error of best model 30.700000 %
epoch 2, minibatch 300/300, validation error 28.400000 %
     epoch 2, minibatch 300/300, test error of best model 21.500000 %
epoch 3, minibatch 300/300, validation error 25.700000 %
     epoch 3, minibatch 300/300, test error of best model 18.400000 %
epoch 4, minibatch 300/300, validation error 24.600000 %
     epoch 4, minibatch 300/300, test error of best model 15.400000 %
epoch 5, minibatch 300/300, validation error 23.600000 %
     epoch 5, minibatch 300/300, test error of best model 14.300000 %
epoch 6, minibatch 300/300, validation error 22.700000 %
     epoch 6, minibatch 300/300, test error of best model 13.100000 %
epoch 7, minibatch 300/300, validation error 21.700000 %
     epoch 7, minibatch 300/300, test error of best model 12.500000 %
epoch 8, minibatch 300/300, validation error 21.000000 %
     epoch 8, minibatch 300/300, test error of best model 11.500000 %
epoch 9, minibatch 300/300, validation error 20.500000 %
     epoch 9, minibatch 300/300, test error of best model 11.000000 %
epoch 10, minibatch 300/300, validation error 20.000000 %
     epoch 10, minibatch 300/300, test error of best model 10.600000 %
epoch 11, minibatch 300/300, validation error 19.200000 %
     epoch 11, minibatch 300/300, test error of best model 9.900000 %
epoch 12, minibatch 300/300, validation error 19.100000 %
     epoch 12, minibatch 300/300, test error of best model 9.400000 %
epoch 13, minibatch 300/300, validation error 18.900000 %
     epoch 13, minibatch 300/300, test error of best model 9.500000 %
epoch 14, minibatch 300/300, validation error 18.600000 %
     epoch 14, minibatch 300/300, test error of best model 9.300000 %
epoch 15, minibatch 300/300, validation error 18.500000 %
     epoch 15, minibatch 300/300, test error of best model 9.100000 %
epoch 16, minibatch 300/300, validation error 18.000000 %
     epoch 16, minibatch 300/300, test error of best model 9.100000 %
epoch 17, minibatch 300/300, validation error 17.900000 %
     epoch 17, minibatch 300/300, test error of best model 8.900000 %
epoch 18, minibatch 300/300, validation error 17.800000 %
     epoch 18, minibatch 300/300, test error of best model 9.100000 %
epoch 19, minibatch 300/300, validation error 17.500000 %
     epoch 19, minibatch 300/300, test error of best model 8.900000 %
epoch 20, minibatch 300/300, validation error 17.700000 %
epoch 21, minibatch 300/300, validation error 17.700000 %
epoch 22, minibatch 300/300, validation error 17.500000 %
epoch 23, minibatch 300/300, validation error 17.400000 %
     epoch 23, minibatch 300/300, test error of best model 8.500000 %
epoch 24, minibatch 300/300, validation error 17.000000 %
     epoch 24, minibatch 300/300, test error of best model 8.500000 %
epoch 25, minibatch 300/300, validation error 17.100000 %
epoch 26, minibatch 300/300, validation error 17.100000 %
epoch 27, minibatch 300/300, validation error 17.000000 %
epoch 28, minibatch 300/300, validation error 17.000000 %
epoch 29, minibatch 300/300, validation error 16.900000 %
     epoch 29, minibatch 300/300, test error of best model 8.400000 %
epoch 30, minibatch 300/300, validation error 16.800000 %
     epoch 30, minibatch 300/300, test error of best model 8.500000 %
epoch 31, minibatch 300/300, validation error 16.600000 %
     epoch 31, minibatch 300/300, test error of best model 8.400000 %
epoch 32, minibatch 300/300, validation error 16.700000 %
epoch 33, minibatch 300/300, validation error 16.500000 %
     epoch 33, minibatch 300/300, test error of best model 8.300000 %
epoch 34, minibatch 300/300, validation error 16.600000 %
epoch 35, minibatch 300/300, validation error 16.400000 %
     epoch 35, minibatch 300/300, test error of best model 8.000000 %
epoch 36, minibatch 300/300, validation error 16.400000 %
epoch 37, minibatch 300/300, validation error 16.500000 %
epoch 38, minibatch 300/300, validation error 16.400000 %
     epoch 38, minibatch 300/300, test error of best model 7.700000 %
epoch 39, minibatch 300/300, validation error 16.400000 %
epoch 40, minibatch 300/300, validation error 16.300000 %
     epoch 40, minibatch 300/300, test error of best model 7.600000 %
epoch 41, minibatch 300/300, validation error 16.200000 %
     epoch 41, minibatch 300/300, test error of best model 7.600000 %
epoch 42, minibatch 300/300, validation error 16.200000 %
epoch 43, minibatch 300/300, validation error 16.100000 %
     epoch 43, minibatch 300/300, test error of best model 7.600000 %
epoch 44, minibatch 300/300, validation error 16.100000 %
epoch 45, minibatch 300/300, validation error 16.000000 %
     epoch 45, minibatch 300/300, test error of best model 7.600000 %
epoch 46, minibatch 300/300, validation error 15.900000 %
     epoch 46, minibatch 300/300, test error of best model 7.700000 %
epoch 47, minibatch 300/300, validation error 15.900000 %
epoch 48, minibatch 300/300, validation error 15.900000 %
epoch 49, minibatch 300/300, validation error 15.900000 %
epoch 50, minibatch 300/300, validation error 15.900000 %
epoch 51, minibatch 300/300, validation error 15.800000 %
     epoch 51, minibatch 300/300, test error of best model 7.600000 %
epoch 52, minibatch 300/300, validation error 15.700000 %
     epoch 52, minibatch 300/300, test error of best model 7.600000 %
epoch 53, minibatch 300/300, validation error 15.500000 %
     epoch 53, minibatch 300/300, test error of best model 7.500000 %
epoch 54, minibatch 300/300, validation error 15.500000 %
epoch 55, minibatch 300/300, validation error 15.500000 %
epoch 56, minibatch 300/300, validation error 15.400000 %
     epoch 56, minibatch 300/300, test error of best model 7.700000 %
epoch 57, minibatch 300/300, validation error 15.300000 %
     epoch 57, minibatch 300/300, test error of best model 7.700000 %
epoch 58, minibatch 300/300, validation error 15.200000 %
     epoch 58, minibatch 300/300, test error of best model 7.700000 %
epoch 59, minibatch 300/300, validation error 15.200000 %
epoch 60, minibatch 300/300, validation error 15.200000 %
epoch 61, minibatch 300/300, validation error 15.200000 %
epoch 62, minibatch 300/300, validation error 15.100000 %
     epoch 62, minibatch 300/300, test error of best model 7.600000 %
epoch 63, minibatch 300/300, validation error 15.100000 %
epoch 64, minibatch 300/300, validation error 15.100000 %
epoch 65, minibatch 300/300, validation error 15.100000 %
epoch 66, minibatch 300/300, validation error 15.100000 %
epoch 67, minibatch 300/300, validation error 15.100000 %
epoch 68, minibatch 300/300, validation error 15.100000 %
epoch 69, minibatch 300/300, validation error 15.100000 %
epoch 70, minibatch 300/300, validation error 15.100000 %
epoch 71, minibatch 300/300, validation error 15.100000 %
epoch 72, minibatch 300/300, validation error 15.100000 %
epoch 73, minibatch 300/300, validation error 15.000000 %
     epoch 73, minibatch 300/300, test error of best model 7.400000 %
epoch 74, minibatch 300/300, validation error 15.000000 %
epoch 75, minibatch 300/300, validation error 15.000000 %
epoch 76, minibatch 300/300, validation error 15.000000 %
epoch 77, minibatch 300/300, validation error 15.000000 %
epoch 78, minibatch 300/300, validation error 15.000000 %
epoch 79, minibatch 300/300, validation error 15.000000 %
epoch 80, minibatch 300/300, validation error 15.000000 %
epoch 81, minibatch 300/300, validation error 15.000000 %
epoch 82, minibatch 300/300, validation error 15.000000 %
epoch 83, minibatch 300/300, validation error 15.000000 %
epoch 84, minibatch 300/300, validation error 15.000000 %
epoch 85, minibatch 300/300, validation error 15.000000 %
epoch 86, minibatch 300/300, validation error 15.000000 %
epoch 87, minibatch 300/300, validation error 15.100000 %
epoch 88, minibatch 300/300, validation error 15.100000 %
epoch 89, minibatch 300/300, validation error 15.100000 %
epoch 90, minibatch 300/300, validation error 15.100000 %
epoch 91, minibatch 300/300, validation error 15.100000 %
epoch 92, minibatch 300/300, validation error 15.100000 %
epoch 93, minibatch 300/300, validation error 15.100000 %
epoch 94, minibatch 300/300, validation error 15.100000 %
epoch 95, minibatch 300/300, validation error 15.100000 %
epoch 96, minibatch 300/300, validation error 15.100000 %
epoch 97, minibatch 300/300, validation error 15.100000 %
epoch 98, minibatch 300/300, validation error 15.100000 %
epoch 99, minibatch 300/300, validation error 15.100000 %
epoch 100, minibatch 300/300, validation error 15.100000 %
epoch 101, minibatch 300/300, validation error 15.100000 %
epoch 102, minibatch 300/300, validation error 15.100000 %
epoch 103, minibatch 300/300, validation error 15.100000 %
epoch 104, minibatch 300/300, validation error 15.100000 %
epoch 105, minibatch 300/300, validation error 15.100000 %
epoch 106, minibatch 300/300, validation error 15.100000 %
epoch 107, minibatch 300/300, validation error 15.100000 %
epoch 108, minibatch 300/300, validation error 15.000000 %
epoch 109, minibatch 300/300, validation error 15.000000 %
epoch 110, minibatch 300/300, validation error 15.000000 %
epoch 111, minibatch 300/300, validation error 15.000000 %
epoch 112, minibatch 300/300, validation error 15.000000 %
epoch 113, minibatch 300/300, validation error 15.000000 %
epoch 114, minibatch 300/300, validation error 15.000000 %
epoch 115, minibatch 300/300, validation error 15.000000 %
epoch 116, minibatch 300/300, validation error 15.000000 %
epoch 117, minibatch 300/300, validation error 15.000000 %
epoch 118, minibatch 300/300, validation error 15.000000 %
epoch 119, minibatch 300/300, validation error 15.000000 %
epoch 120, minibatch 300/300, validation error 14.900000 %
     epoch 120, minibatch 300/300, test error of best model 7.200000 %
epoch 121, minibatch 300/300, validation error 14.900000 %
epoch 122, minibatch 300/300, validation error 14.900000 %
epoch 123, minibatch 300/300, validation error 14.900000 %
epoch 124, minibatch 300/300, validation error 14.900000 %
epoch 125, minibatch 300/300, validation error 14.900000 %
epoch 126, minibatch 300/300, validation error 14.900000 %
epoch 127, minibatch 300/300, validation error 14.900000 %
epoch 128, minibatch 300/300, validation error 14.900000 %
epoch 129, minibatch 300/300, validation error 14.900000 %
epoch 130, minibatch 300/300, validation error 14.900000 %
epoch 131, minibatch 300/300, validation error 14.900000 %
epoch 132, minibatch 300/300, validation error 14.900000 %
epoch 133, minibatch 300/300, validation error 14.900000 %
epoch 134, minibatch 300/300, validation error 14.900000 %
epoch 135, minibatch 300/300, validation error 15.000000 %
epoch 136, minibatch 300/300, validation error 15.000000 %
epoch 137, minibatch 300/300, validation error 15.000000 %
epoch 138, minibatch 300/300, validation error 15.000000 %
epoch 139, minibatch 300/300, validation error 15.000000 %
epoch 140, minibatch 300/300, validation error 15.000000 %
epoch 141, minibatch 300/300, validation error 15.000000 %
epoch 142, minibatch 300/300, validation error 15.000000 %
epoch 143, minibatch 300/300, validation error 15.000000 %
epoch 144, minibatch 300/300, validation error 15.000000 %
epoch 145, minibatch 300/300, validation error 15.000000 %
epoch 146, minibatch 300/300, validation error 15.000000 %
epoch 147, minibatch 300/300, validation error 15.000000 %
epoch 148, minibatch 300/300, validation error 15.000000 %
epoch 149, minibatch 300/300, validation error 15.000000 %
epoch 150, minibatch 300/300, validation error 15.000000 %
epoch 151, minibatch 300/300, validation error 15.000000 %
epoch 152, minibatch 300/300, validation error 15.000000 %
epoch 153, minibatch 300/300, validation error 15.000000 %
epoch 154, minibatch 300/300, validation error 15.000000 %
epoch 155, minibatch 300/300, validation error 15.000000 %
epoch 156, minibatch 300/300, validation error 15.000000 %
epoch 157, minibatch 300/300, validation error 14.900000 %
     epoch 157, minibatch 300/300, test error of best model 7.100000 %
epoch 158, minibatch 300/300, validation error 14.900000 %
epoch 159, minibatch 300/300, validation error 14.800000 %
     epoch 159, minibatch 300/300, test error of best model 7.100000 %
epoch 160, minibatch 300/300, validation error 14.800000 %
epoch 161, minibatch 300/300, validation error 14.800000 %
epoch 162, minibatch 300/300, validation error 14.800000 %
epoch 163, minibatch 300/300, validation error 14.800000 %
epoch 164, minibatch 300/300, validation error 14.800000 %
epoch 165, minibatch 300/300, validation error 14.800000 %
epoch 166, minibatch 300/300, validation error 14.800000 %
epoch 167, minibatch 300/300, validation error 14.800000 %
epoch 168, minibatch 300/300, validation error 14.800000 %
epoch 169, minibatch 300/300, validation error 14.800000 %
epoch 170, minibatch 300/300, validation error 14.800000 %
epoch 171, minibatch 300/300, validation error 14.800000 %
epoch 172, minibatch 300/300, validation error 14.800000 %
epoch 173, minibatch 300/300, validation error 14.800000 %
epoch 174, minibatch 300/300, validation error 14.800000 %
epoch 175, minibatch 300/300, validation error 14.800000 %
epoch 176, minibatch 300/300, validation error 14.800000 %
epoch 177, minibatch 300/300, validation error 14.800000 %
epoch 178, minibatch 300/300, validation error 14.800000 %
epoch 179, minibatch 300/300, validation error 14.800000 %
epoch 180, minibatch 300/300, validation error 14.800000 %
epoch 181, minibatch 300/300, validation error 14.800000 %
epoch 182, minibatch 300/300, validation error 14.800000 %
epoch 183, minibatch 300/300, validation error 14.800000 %
epoch 184, minibatch 300/300, validation error 14.800000 %
epoch 185, minibatch 300/300, validation error 14.800000 %
epoch 186, minibatch 300/300, validation error 14.800000 %
epoch 187, minibatch 300/300, validation error 14.800000 %
epoch 188, minibatch 300/300, validation error 14.800000 %
epoch 189, minibatch 300/300, validation error 14.800000 %
epoch 190, minibatch 300/300, validation error 14.800000 %
epoch 191, minibatch 300/300, validation error 14.800000 %
epoch 192, minibatch 300/300, validation error 14.800000 %
epoch 193, minibatch 300/300, validation error 14.800000 %
epoch 194, minibatch 300/300, validation error 14.800000 %
epoch 195, minibatch 300/300, validation error 14.800000 %
epoch 196, minibatch 300/300, validation error 14.800000 %
epoch 197, minibatch 300/300, validation error 14.800000 %
epoch 198, minibatch 300/300, validation error 14.800000 %
epoch 199, minibatch 300/300, validation error 14.800000 %
epoch 200, minibatch 300/300, validation error 14.800000 %
epoch 201, minibatch 300/300, validation error 14.800000 %
epoch 202, minibatch 300/300, validation error 14.800000 %
epoch 203, minibatch 300/300, validation error 14.800000 %
epoch 204, minibatch 300/300, validation error 14.800000 %
epoch 205, minibatch 300/300, validation error 14.800000 %
epoch 206, minibatch 300/300, validation error 14.800000 %
epoch 207, minibatch 300/300, validation error 14.800000 %
epoch 208, minibatch 300/300, validation error 14.800000 %
epoch 209, minibatch 300/300, validation error 14.800000 %
epoch 210, minibatch 300/300, validation error 14.800000 %
epoch 211, minibatch 300/300, validation error 14.800000 %
epoch 212, minibatch 300/300, validation error 14.800000 %
epoch 213, minibatch 300/300, validation error 14.800000 %
epoch 214, minibatch 300/300, validation error 14.800000 %
epoch 215, minibatch 300/300, validation error 14.800000 %
epoch 216, minibatch 300/300, validation error 14.800000 %
epoch 217, minibatch 300/300, validation error 14.800000 %
epoch 218, minibatch 300/300, validation error 14.800000 %
epoch 219, minibatch 300/300, validation error 14.800000 %
epoch 220, minibatch 300/300, validation error 14.800000 %
epoch 221, minibatch 300/300, validation error 14.800000 %
epoch 222, minibatch 300/300, validation error 14.800000 %
epoch 223, minibatch 300/300, validation error 14.800000 %
epoch 224, minibatch 300/300, validation error 14.800000 %
epoch 225, minibatch 300/300, validation error 14.800000 %
epoch 226, minibatch 300/300, validation error 14.800000 %
epoch 227, minibatch 300/300, validation error 14.800000 %
epoch 228, minibatch 300/300, validation error 14.800000 %
epoch 229, minibatch 300/300, validation error 14.800000 %
epoch 230, minibatch 300/300, validation error 14.800000 %
epoch 231, minibatch 300/300, validation error 14.800000 %
epoch 232, minibatch 300/300, validation error 14.800000 %
epoch 233, minibatch 300/300, validation error 14.800000 %
epoch 234, minibatch 300/300, validation error 14.800000 %
epoch 235, minibatch 300/300, validation error 14.800000 %
epoch 236, minibatch 300/300, validation error 14.800000 %
epoch 237, minibatch 300/300, validation error 14.800000 %
epoch 238, minibatch 300/300, validation error 14.800000 %
epoch 239, minibatch 300/300, validation error 14.800000 %
epoch 240, minibatch 300/300, validation error 14.800000 %
epoch 241, minibatch 300/300, validation error 14.800000 %
epoch 242, minibatch 300/300, validation error 14.800000 %
epoch 243, minibatch 300/300, validation error 14.800000 %
epoch 244, minibatch 300/300, validation error 14.800000 %
epoch 245, minibatch 300/300, validation error 14.800000 %
epoch 246, minibatch 300/300, validation error 14.800000 %
epoch 247, minibatch 300/300, validation error 14.800000 %
epoch 248, minibatch 300/300, validation error 14.800000 %
epoch 249, minibatch 300/300, validation error 14.800000 %
epoch 250, minibatch 300/300, validation error 14.800000 %
epoch 251, minibatch 300/300, validation error 14.800000 %
epoch 252, minibatch 300/300, validation error 14.800000 %
epoch 253, minibatch 300/300, validation error 14.800000 %
epoch 254, minibatch 300/300, validation error 14.800000 %
epoch 255, minibatch 300/300, validation error 14.800000 %
epoch 256, minibatch 300/300, validation error 14.800000 %
epoch 257, minibatch 300/300, validation error 14.800000 %
epoch 258, minibatch 300/300, validation error 14.800000 %
epoch 259, minibatch 300/300, validation error 14.800000 %
epoch 260, minibatch 300/300, validation error 14.800000 %
epoch 261, minibatch 300/300, validation error 14.800000 %
epoch 262, minibatch 300/300, validation error 14.800000 %
epoch 263, minibatch 300/300, validation error 14.800000 %
epoch 264, minibatch 300/300, validation error 14.800000 %
epoch 265, minibatch 300/300, validation error 14.800000 %
epoch 266, minibatch 300/300, validation error 14.800000 %
epoch 267, minibatch 300/300, validation error 14.800000 %
epoch 268, minibatch 300/300, validation error 14.800000 %
epoch 269, minibatch 300/300, validation error 14.800000 %
epoch 270, minibatch 300/300, validation error 14.800000 %
epoch 271, minibatch 300/300, validation error 14.800000 %
epoch 272, minibatch 300/300, validation error 14.800000 %
epoch 273, minibatch 300/300, validation error 14.800000 %
epoch 274, minibatch 300/300, validation error 14.800000 %
epoch 275, minibatch 300/300, validation error 14.800000 %
epoch 276, minibatch 300/300, validation error 14.800000 %
epoch 277, minibatch 300/300, validation error 14.700000 %
     epoch 277, minibatch 300/300, test error of best model 7.100000 %
epoch 278, minibatch 300/300, validation error 14.700000 %
epoch 279, minibatch 300/300, validation error 14.700000 %
epoch 280, minibatch 300/300, validation error 14.700000 %
epoch 281, minibatch 300/300, validation error 14.700000 %
epoch 282, minibatch 300/300, validation error 14.700000 %
epoch 283, minibatch 300/300, validation error 14.700000 %
epoch 284, minibatch 300/300, validation error 14.700000 %
epoch 285, minibatch 300/300, validation error 14.700000 %
epoch 286, minibatch 300/300, validation error 14.700000 %
epoch 287, minibatch 300/300, validation error 14.700000 %
epoch 288, minibatch 300/300, validation error 14.700000 %
epoch 289, minibatch 300/300, validation error 14.700000 %
epoch 290, minibatch 300/300, validation error 14.700000 %
epoch 291, minibatch 300/300, validation error 14.700000 %
epoch 292, minibatch 300/300, validation error 14.700000 %
epoch 293, minibatch 300/300, validation error 14.700000 %
epoch 294, minibatch 300/300, validation error 14.700000 %
epoch 295, minibatch 300/300, validation error 14.700000 %
epoch 296, minibatch 300/300, validation error 14.700000 %
epoch 297, minibatch 300/300, validation error 14.700000 %
epoch 298, minibatch 300/300, validation error 14.700000 %
epoch 299, minibatch 300/300, validation error 14.700000 %
epoch 300, minibatch 300/300, validation error 14.700000 %
epoch 301, minibatch 300/300, validation error 14.700000 %
epoch 302, minibatch 300/300, validation error 14.700000 %
epoch 303, minibatch 300/300, validation error 14.700000 %
epoch 304, minibatch 300/300, validation error 14.700000 %
epoch 305, minibatch 300/300, validation error 14.700000 %
epoch 306, minibatch 300/300, validation error 14.700000 %
epoch 307, minibatch 300/300, validation error 14.700000 %
epoch 308, minibatch 300/300, validation error 14.700000 %
epoch 309, minibatch 300/300, validation error 14.700000 %
epoch 310, minibatch 300/300, validation error 14.700000 %
epoch 311, minibatch 300/300, validation error 14.700000 %
epoch 312, minibatch 300/300, validation error 14.700000 %
epoch 313, minibatch 300/300, validation error 14.700000 %
epoch 314, minibatch 300/300, validation error 14.700000 %
epoch 315, minibatch 300/300, validation error 14.700000 %
epoch 316, minibatch 300/300, validation error 14.700000 %
epoch 317, minibatch 300/300, validation error 14.700000 %
epoch 318, minibatch 300/300, validation error 14.700000 %
epoch 319, minibatch 300/300, validation error 14.700000 %
epoch 320, minibatch 300/300, validation error 14.700000 %
epoch 321, minibatch 300/300, validation error 14.700000 %
epoch 322, minibatch 300/300, validation error 14.700000 %
epoch 323, minibatch 300/300, validation error 14.700000 %
epoch 324, minibatch 300/300, validation error 14.700000 %
epoch 325, minibatch 300/300, validation error 14.700000 %
epoch 326, minibatch 300/300, validation error 14.700000 %
epoch 327, minibatch 300/300, validation error 14.700000 %
epoch 328, minibatch 300/300, validation error 14.700000 %
epoch 329, minibatch 300/300, validation error 14.700000 %
epoch 330, minibatch 300/300, validation error 14.700000 %
epoch 331, minibatch 300/300, validation error 14.700000 %
epoch 332, minibatch 300/300, validation error 14.700000 %
epoch 333, minibatch 300/300, validation error 14.700000 %
epoch 334, minibatch 300/300, validation error 14.700000 %
epoch 335, minibatch 300/300, validation error 14.700000 %
epoch 336, minibatch 300/300, validation error 14.700000 %
epoch 337, minibatch 300/300, validation error 14.700000 %
epoch 338, minibatch 300/300, validation error 14.700000 %
epoch 339, minibatch 300/300, validation error 14.700000 %
epoch 340, minibatch 300/300, validation error 14.700000 %
epoch 341, minibatch 300/300, validation error 14.700000 %
epoch 342, minibatch 300/300, validation error 14.700000 %
epoch 343, minibatch 300/300, validation error 14.700000 %
epoch 344, minibatch 300/300, validation error 14.700000 %
epoch 345, minibatch 300/300, validation error 14.700000 %
epoch 346, minibatch 300/300, validation error 14.700000 %
epoch 347, minibatch 300/300, validation error 14.700000 %
epoch 348, minibatch 300/300, validation error 14.700000 %
epoch 349, minibatch 300/300, validation error 14.700000 %
epoch 350, minibatch 300/300, validation error 14.700000 %
epoch 351, minibatch 300/300, validation error 14.700000 %
epoch 352, minibatch 300/300, validation error 14.700000 %
epoch 353, minibatch 300/300, validation error 14.700000 %
epoch 354, minibatch 300/300, validation error 14.700000 %
epoch 355, minibatch 300/300, validation error 14.700000 %
epoch 356, minibatch 300/300, validation error 14.700000 %
epoch 357, minibatch 300/300, validation error 14.700000 %
epoch 358, minibatch 300/300, validation error 14.700000 %
epoch 359, minibatch 300/300, validation error 14.700000 %
epoch 360, minibatch 300/300, validation error 14.700000 %
epoch 361, minibatch 300/300, validation error 14.700000 %
epoch 362, minibatch 300/300, validation error 14.700000 %
epoch 363, minibatch 300/300, validation error 14.700000 %
epoch 364, minibatch 300/300, validation error 14.700000 %
epoch 365, minibatch 300/300, validation error 14.700000 %
epoch 366, minibatch 300/300, validation error 14.700000 %
epoch 367, minibatch 300/300, validation error 14.700000 %
epoch 368, minibatch 300/300, validation error 14.700000 %
epoch 369, minibatch 300/300, validation error 14.700000 %
epoch 370, minibatch 300/300, validation error 14.700000 %
epoch 371, minibatch 300/300, validation error 14.700000 %
epoch 372, minibatch 300/300, validation error 14.700000 %
epoch 373, minibatch 300/300, validation error 14.700000 %
epoch 374, minibatch 300/300, validation error 14.700000 %
epoch 375, minibatch 300/300, validation error 14.700000 %
epoch 376, minibatch 300/300, validation error 14.700000 %
epoch 377, minibatch 300/300, validation error 14.700000 %
epoch 378, minibatch 300/300, validation error 14.700000 %
epoch 379, minibatch 300/300, validation error 14.700000 %
epoch 380, minibatch 300/300, validation error 14.700000 %
epoch 381, minibatch 300/300, validation error 14.700000 %
epoch 382, minibatch 300/300, validation error 14.700000 %
epoch 383, minibatch 300/300, validation error 14.700000 %
epoch 384, minibatch 300/300, validation error 14.700000 %
epoch 385, minibatch 300/300, validation error 14.700000 %
epoch 386, minibatch 300/300, validation error 14.700000 %
epoch 387, minibatch 300/300, validation error 14.700000 %
epoch 388, minibatch 300/300, validation error 14.700000 %
epoch 389, minibatch 300/300, validation error 14.700000 %
epoch 390, minibatch 300/300, validation error 14.700000 %
epoch 391, minibatch 300/300, validation error 14.700000 %
epoch 392, minibatch 300/300, validation error 14.700000 %
epoch 393, minibatch 300/300, validation error 14.700000 %
epoch 394, minibatch 300/300, validation error 14.700000 %
epoch 395, minibatch 300/300, validation error 14.700000 %
epoch 396, minibatch 300/300, validation error 14.700000 %
epoch 397, minibatch 300/300, validation error 14.700000 %
epoch 398, minibatch 300/300, validation error 14.700000 %
epoch 399, minibatch 300/300, validation error 14.700000 %
epoch 400, minibatch 300/300, validation error 14.700000 %
epoch 401, minibatch 300/300, validation error 14.700000 %
epoch 402, minibatch 300/300, validation error 14.700000 %
epoch 403, minibatch 300/300, validation error 14.700000 %
epoch 404, minibatch 300/300, validation error 14.700000 %
epoch 405, minibatch 300/300, validation error 14.700000 %
epoch 406, minibatch 300/300, validation error 14.700000 %
epoch 407, minibatch 300/300, validation error 14.700000 %
epoch 408, minibatch 300/300, validation error 14.700000 %
epoch 409, minibatch 300/300, validation error 14.700000 %
epoch 410, minibatch 300/300, validation error 14.700000 %
epoch 411, minibatch 300/300, validation error 14.700000 %
epoch 412, minibatch 300/300, validation error 14.700000 %
epoch 413, minibatch 300/300, validation error 14.700000 %
epoch 414, minibatch 300/300, validation error 14.700000 %
epoch 415, minibatch 300/300, validation error 14.700000 %
epoch 416, minibatch 300/300, validation error 14.700000 %
epoch 417, minibatch 300/300, validation error 14.700000 %
epoch 418, minibatch 300/300, validation error 14.700000 %
epoch 419, minibatch 300/300, validation error 14.700000 %
epoch 420, minibatch 300/300, validation error 14.700000 %
epoch 421, minibatch 300/300, validation error 14.700000 %
epoch 422, minibatch 300/300, validation error 14.700000 %
epoch 423, minibatch 300/300, validation error 14.700000 %
epoch 424, minibatch 300/300, validation error 14.700000 %
epoch 425, minibatch 300/300, validation error 14.700000 %
epoch 426, minibatch 300/300, validation error 14.700000 %
epoch 427, minibatch 300/300, validation error 14.700000 %
epoch 428, minibatch 300/300, validation error 14.700000 %
epoch 429, minibatch 300/300, validation error 14.700000 %
epoch 430, minibatch 300/300, validation error 14.700000 %
epoch 431, minibatch 300/300, validation error 14.700000 %
epoch 432, minibatch 300/300, validation error 14.700000 %
epoch 433, minibatch 300/300, validation error 14.700000 %
epoch 434, minibatch 300/300, validation error 14.700000 %
epoch 435, minibatch 300/300, validation error 14.700000 %
epoch 436, minibatch 300/300, validation error 14.700000 %
epoch 437, minibatch 300/300, validation error 14.700000 %
epoch 438, minibatch 300/300, validation error 14.700000 %
epoch 439, minibatch 300/300, validation error 14.700000 %
epoch 440, minibatch 300/300, validation error 14.700000 %
epoch 441, minibatch 300/300, validation error 14.700000 %
epoch 442, minibatch 300/300, validation error 14.700000 %
epoch 443, minibatch 300/300, validation error 14.700000 %
epoch 444, minibatch 300/300, validation error 14.700000 %
epoch 445, minibatch 300/300, validation error 14.700000 %
epoch 446, minibatch 300/300, validation error 14.700000 %
epoch 447, minibatch 300/300, validation error 14.700000 %
epoch 448, minibatch 300/300, validation error 14.700000 %
epoch 449, minibatch 300/300, validation error 14.700000 %
epoch 450, minibatch 300/300, validation error 14.700000 %
epoch 451, minibatch 300/300, validation error 14.700000 %
epoch 452, minibatch 300/300, validation error 14.700000 %
epoch 453, minibatch 300/300, validation error 14.700000 %
epoch 454, minibatch 300/300, validation error 14.700000 %
epoch 455, minibatch 300/300, validation error 14.700000 %
epoch 456, minibatch 300/300, validation error 14.700000 %
epoch 457, minibatch 300/300, validation error 14.700000 %
epoch 458, minibatch 300/300, validation error 14.700000 %
epoch 459, minibatch 300/300, validation error 14.700000 %
epoch 460, minibatch 300/300, validation error 14.700000 %
epoch 461, minibatch 300/300, validation error 14.700000 %
epoch 462, minibatch 300/300, validation error 14.700000 %
epoch 463, minibatch 300/300, validation error 14.700000 %
epoch 464, minibatch 300/300, validation error 14.700000 %
epoch 465, minibatch 300/300, validation error 14.700000 %
epoch 466, minibatch 300/300, validation error 14.700000 %
epoch 467, minibatch 300/300, validation error 14.700000 %
epoch 468, minibatch 300/300, validation error 14.700000 %
epoch 469, minibatch 300/300, validation error 14.700000 %
epoch 470, minibatch 300/300, validation error 14.700000 %
epoch 471, minibatch 300/300, validation error 14.700000 %
epoch 472, minibatch 300/300, validation error 14.700000 %
epoch 473, minibatch 300/300, validation error 14.700000 %
epoch 474, minibatch 300/300, validation error 14.700000 %
epoch 475, minibatch 300/300, validation error 14.700000 %
epoch 476, minibatch 300/300, validation error 14.700000 %
epoch 477, minibatch 300/300, validation error 14.700000 %
epoch 478, minibatch 300/300, validation error 14.700000 %
epoch 479, minibatch 300/300, validation error 14.700000 %
epoch 480, minibatch 300/300, validation error 14.700000 %
epoch 481, minibatch 300/300, validation error 14.700000 %
epoch 482, minibatch 300/300, validation error 14.700000 %
epoch 483, minibatch 300/300, validation error 14.700000 %
epoch 484, minibatch 300/300, validation error 14.700000 %
epoch 485, minibatch 300/300, validation error 14.700000 %
epoch 486, minibatch 300/300, validation error 14.700000 %
epoch 487, minibatch 300/300, validation error 14.700000 %
epoch 488, minibatch 300/300, validation error 14.700000 %
epoch 489, minibatch 300/300, validation error 14.700000 %
epoch 490, minibatch 300/300, validation error 14.700000 %
epoch 491, minibatch 300/300, validation error 14.700000 %
epoch 492, minibatch 300/300, validation error 14.700000 %
epoch 493, minibatch 300/300, validation error 14.700000 %
epoch 494, minibatch 300/300, validation error 14.700000 %
epoch 495, minibatch 300/300, validation error 14.700000 %
epoch 496, minibatch 300/300, validation error 14.700000 %
epoch 497, minibatch 300/300, validation error 14.700000 %
epoch 498, minibatch 300/300, validation error 14.700000 %
epoch 499, minibatch 300/300, validation error 14.700000 %
epoch 500, minibatch 300/300, validation error 14.700000 %
epoch 501, minibatch 300/300, validation error 14.700000 %
epoch 502, minibatch 300/300, validation error 14.700000 %
epoch 503, minibatch 300/300, validation error 14.700000 %
epoch 504, minibatch 300/300, validation error 14.700000 %
epoch 505, minibatch 300/300, validation error 14.700000 %
epoch 506, minibatch 300/300, validation error 14.700000 %
epoch 507, minibatch 300/300, validation error 14.700000 %
epoch 508, minibatch 300/300, validation error 14.700000 %
epoch 509, minibatch 300/300, validation error 14.700000 %
epoch 510, minibatch 300/300, validation error 14.700000 %
epoch 511, minibatch 300/300, validation error 14.700000 %
epoch 512, minibatch 300/300, validation error 14.700000 %
epoch 513, minibatch 300/300, validation error 14.700000 %
epoch 514, minibatch 300/300, validation error 14.700000 %
epoch 515, minibatch 300/300, validation error 14.700000 %
epoch 516, minibatch 300/300, validation error 14.700000 %
epoch 517, minibatch 300/300, validation error 14.700000 %
epoch 518, minibatch 300/300, validation error 14.700000 %
epoch 519, minibatch 300/300, validation error 14.700000 %
epoch 520, minibatch 300/300, validation error 14.700000 %
epoch 521, minibatch 300/300, validation error 14.700000 %
epoch 522, minibatch 300/300, validation error 14.700000 %
epoch 523, minibatch 300/300, validation error 14.700000 %
epoch 524, minibatch 300/300, validation error 14.700000 %
epoch 525, minibatch 300/300, validation error 14.700000 %
epoch 526, minibatch 300/300, validation error 14.700000 %
epoch 527, minibatch 300/300, validation error 14.700000 %
epoch 528, minibatch 300/300, validation error 14.700000 %
epoch 529, minibatch 300/300, validation error 14.700000 %
epoch 530, minibatch 300/300, validation error 14.700000 %
epoch 531, minibatch 300/300, validation error 14.700000 %
epoch 532, minibatch 300/300, validation error 14.700000 %
epoch 533, minibatch 300/300, validation error 14.700000 %
epoch 534, minibatch 300/300, validation error 14.700000 %
epoch 535, minibatch 300/300, validation error 14.700000 %
epoch 536, minibatch 300/300, validation error 14.700000 %
epoch 537, minibatch 300/300, validation error 14.700000 %
epoch 538, minibatch 300/300, validation error 14.700000 %
epoch 539, minibatch 300/300, validation error 14.700000 %
epoch 540, minibatch 300/300, validation error 14.700000 %
epoch 541, minibatch 300/300, validation error 14.700000 %
epoch 542, minibatch 300/300, validation error 14.700000 %
epoch 543, minibatch 300/300, validation error 14.700000 %
epoch 544, minibatch 300/300, validation error 14.700000 %
epoch 545, minibatch 300/300, validation error 14.700000 %
epoch 546, minibatch 300/300, validation error 14.700000 %
epoch 547, minibatch 300/300, validation error 14.700000 %
epoch 548, minibatch 300/300, validation error 14.700000 %
epoch 549, minibatch 300/300, validation error 14.700000 %
epoch 550, minibatch 300/300, validation error 14.700000 %
epoch 551, minibatch 300/300, validation error 14.700000 %
epoch 552, minibatch 300/300, validation error 14.700000 %
epoch 553, minibatch 300/300, validation error 14.700000 %
Optimization complete with best validation score of 14.700000 %, obtained at iteration 83100, with test performance 7.100000 %
The fine tuning code for file dbn_loop.pyc ran for 14.37m


==========Sample: (4000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.26092989
Pre-training layer 0, epoch 0, representative training free energy -552.570423645
Pre-training layer 0, epoch 0, validation free energy -550.060909485
Pre-training layer 0, epoch 1, cost -112.056688957
Pre-training layer 0, epoch 2, cost -103.866580524
Pre-training layer 0, epoch 3, cost -99.0120500374
Pre-training layer 0, epoch 4, cost -96.0593074799
Pre-training layer 0, epoch 5, cost -93.4812584496
Pre-training layer 0, epoch 5, representative training free energy -490.4037836
Pre-training layer 0, epoch 5, validation free energy -485.602029297
Pre-training layer 0, epoch 6, cost -91.4896326065
Pre-training layer 0, epoch 7, cost -90.0371546745
Pre-training layer 0, epoch 8, cost -88.7799058914
Pre-training layer 0, epoch 9, cost -87.6973868656
Pre-training layer 0, epoch 10, cost -86.8083940506
Pre-training layer 0, epoch 10, representative training free energy -468.890900452
Pre-training layer 0, epoch 10, validation free energy -463.873005402
Pre-training layer 0, epoch 11, cost -86.1176042461
Pre-training layer 0, epoch 12, cost -85.3375269508
Pre-training layer 0, epoch 13, cost -84.6409285831
Pre-training layer 0, epoch 14, cost -84.1255721474
Pre-training layer 0, epoch 15, cost -83.7006050873
Pre-training layer 0, epoch 15, representative training free energy -459.044177002
Pre-training layer 0, epoch 15, validation free energy -452.774601746
Pre-training layer 0, epoch 16, cost -83.2458374596
Pre-training layer 0, epoch 17, cost -82.6550108433
Pre-training layer 0, epoch 18, cost -82.2948559475
Pre-training layer 0, epoch 19, cost -82.0280888271
Pre-training layer 0, epoch 20, cost -81.6212506104
Pre-training layer 0, epoch 20, representative training free energy -449.101917847
Pre-training layer 0, epoch 20, validation free energy -443.206452728
Pre-training layer 0, epoch 21, cost -81.2407782364
Pre-training layer 0, epoch 22, cost -81.0079619598
Pre-training layer 0, epoch 23, cost -80.6235977554
Pre-training layer 0, epoch 24, cost -80.3560713959
Pre-training layer 0, epoch 25, cost -80.1944253445
Pre-training layer 0, epoch 25, representative training free energy -441.755626495
Pre-training layer 0, epoch 25, validation free energy -434.822927399
Pre-training layer 0, epoch 26, cost -79.7751135445
Pre-training layer 0, epoch 27, cost -79.6086196423
Pre-training layer 0, epoch 28, cost -79.3768634796
Pre-training layer 0, epoch 29, cost -79.2353178024
Pre-training layer 0, epoch 30, cost -79.0419429588
Pre-training layer 0, epoch 30, representative training free energy -437.954574524
Pre-training layer 0, epoch 30, validation free energy -430.775114044
Pre-training layer 0, epoch 31, cost -78.7721970749
Pre-training layer 0, epoch 32, cost -78.6787317753
Pre-training layer 0, epoch 33, cost -78.5417870045
Pre-training layer 0, epoch 34, cost -78.1884168148
Pre-training layer 0, epoch 35, cost -78.048130579
Pre-training layer 0, epoch 35, representative training free energy -439.338714966
Pre-training layer 0, epoch 35, validation free energy -432.062002838
Pre-training layer 0, epoch 36, cost -77.8786739254
Pre-training layer 0, epoch 37, cost -77.7309205914
Pre-training layer 0, epoch 38, cost -77.5896673298
Pre-training layer 0, epoch 39, cost -77.4552054024
Pre-training layer 0, epoch 40, cost -77.3753724003
Pre-training layer 0, epoch 40, representative training free energy -433.752556671
Pre-training layer 0, epoch 40, validation free energy -425.836418701
Pre-training layer 0, epoch 41, cost -77.2343921757
Pre-training layer 0, epoch 42, cost -76.950038271
Pre-training layer 0, epoch 43, cost -76.9527638149
Pre-training layer 0, epoch 44, cost -76.7577155685
Pre-training layer 0, epoch 45, cost -76.6521898556
Pre-training layer 0, epoch 45, representative training free energy -431.790875183
Pre-training layer 0, epoch 45, validation free energy -423.770478546
Pre-training layer 0, epoch 46, cost -76.6251716137
Pre-training layer 0, epoch 47, cost -76.3895720005
Pre-training layer 0, epoch 48, cost -76.4018137836
Pre-training layer 0, epoch 49, cost -76.2197076797
Pre-training layer 0, epoch 50, cost -76.1491886902
Pre-training layer 0, epoch 50, representative training free energy -430.071536224
Pre-training layer 0, epoch 50, validation free energy -421.696592041
Pre-training layer 0, epoch 51, cost -76.0390754128
Pre-training layer 0, epoch 52, cost -75.8923156166
Pre-training layer 0, epoch 53, cost -75.7475378799
Pre-training layer 0, epoch 54, cost -75.8834503078
Pre-training layer 0, epoch 55, cost -75.6797268963
Pre-training layer 0, epoch 55, representative training free energy -427.018967133
Pre-training layer 0, epoch 55, validation free energy -419.287747894
Pre-training layer 0, epoch 56, cost -75.6093545151
Pre-training layer 0, epoch 57, cost -75.5015202904
Pre-training layer 0, epoch 58, cost -75.2758549404
Pre-training layer 0, epoch 59, cost -75.3140412521
Pre-training layer 0, epoch 60, cost -75.3087074375
Pre-training layer 0, epoch 60, representative training free energy -426.01953067
Pre-training layer 0, epoch 60, validation free energy -417.444493774
Pre-training layer 0, epoch 61, cost -75.1485748482
Pre-training layer 0, epoch 62, cost -75.0915003395
Pre-training layer 0, epoch 63, cost -74.8896784401
Pre-training layer 0, epoch 64, cost -74.9453651142
Pre-training layer 0, epoch 65, cost -74.9007445621
Pre-training layer 0, epoch 65, representative training free energy -426.009718628
Pre-training layer 0, epoch 65, validation free energy -417.609598297
Pre-training layer 0, epoch 66, cost -74.8740392685
Pre-training layer 0, epoch 67, cost -74.7140251064
Pre-training layer 0, epoch 68, cost -74.7006013203
Pre-training layer 0, epoch 69, cost -74.6600147057
Pre-training layer 0, epoch 70, cost -74.4951921177
Pre-training layer 0, epoch 70, representative training free energy -426.419896362
Pre-training layer 0, epoch 70, validation free energy -417.911623108
Pre-training layer 0, epoch 71, cost -74.436310873
Pre-training layer 0, epoch 72, cost -74.3320984554
Pre-training layer 0, epoch 73, cost -74.3217952728
Pre-training layer 0, epoch 74, cost -74.2227684689
Pre-training layer 0, epoch 75, cost -74.2062630653
Pre-training layer 0, epoch 75, representative training free energy -422.577057251
Pre-training layer 0, epoch 75, validation free energy -414.142364929
Pre-training layer 0, epoch 76, cost -74.1415761948
Pre-training layer 0, epoch 77, cost -74.0680060768
Pre-training layer 0, epoch 78, cost -73.9251675987
Pre-training layer 0, epoch 79, cost -74.0307189369
Pre-training layer 0, epoch 80, cost -73.9301409912
Pre-training layer 0, epoch 80, representative training free energy -422.666406677
Pre-training layer 0, epoch 80, validation free energy -414.175636047
Pre-training layer 0, epoch 81, cost -73.9100020218
Pre-training layer 0, epoch 82, cost -73.745005722
Pre-training layer 0, epoch 83, cost -73.698268528
Pre-training layer 0, epoch 84, cost -73.6288197231
Pre-training layer 0, epoch 85, cost -73.607804575
Pre-training layer 0, epoch 85, representative training free energy -421.14388446
Pre-training layer 0, epoch 85, validation free energy -412.465549652
Pre-training layer 0, epoch 86, cost -73.7028921604
Pre-training layer 0, epoch 87, cost -73.4904984283
Pre-training layer 0, epoch 88, cost -73.5976151371
Pre-training layer 0, epoch 89, cost -73.3853114128
Pre-training layer 0, epoch 90, cost -73.3885083866
Pre-training layer 0, epoch 90, representative training free energy -422.446794952
Pre-training layer 0, epoch 90, validation free energy -413.875075806
Pre-training layer 0, epoch 91, cost -73.2329806137
Pre-training layer 0, epoch 92, cost -73.3066216564
Pre-training layer 0, epoch 93, cost -73.2987131023
Pre-training layer 0, epoch 94, cost -73.2646373367
Pre-training layer 0, epoch 95, cost -73.1117214394
Pre-training layer 0, epoch 95, representative training free energy -421.305759186
Pre-training layer 0, epoch 95, validation free energy -411.77505777
Pre-training layer 0, epoch 96, cost -73.1487880611
Pre-training layer 0, epoch 97, cost -72.9914682865
Pre-training layer 0, epoch 98, cost -73.0534333801
Pre-training layer 0, epoch 99, cost -72.94373559
Pre-training layer 1, epoch 0, cost -323.602023659
Pre-training layer 1, epoch 0, representative training free energy -57544.9823887
Pre-training layer 1, epoch 0, validation free energy -57146.7100684
Pre-training layer 1, epoch 1, cost -277.947794495
Pre-training layer 1, epoch 2, cost -263.760843277
Pre-training layer 1, epoch 3, cost -255.467683182
Pre-training layer 1, epoch 4, cost -249.966199951
Pre-training layer 1, epoch 5, cost -245.806379128
Pre-training layer 1, epoch 5, representative training free energy -77151.6572012
Pre-training layer 1, epoch 5, validation free energy -76556.4668379
Pre-training layer 1, epoch 6, cost -242.613464699
Pre-training layer 1, epoch 7, cost -240.067485619
Pre-training layer 1, epoch 8, cost -238.027384338
Pre-training layer 1, epoch 9, cost -236.243498154
Pre-training layer 1, epoch 10, cost -234.704321327
Pre-training layer 1, epoch 10, representative training free energy -83153.6674102
Pre-training layer 1, epoch 10, validation free energy -82518.642875
Pre-training layer 1, epoch 11, cost -233.247136345
Pre-training layer 1, epoch 12, cost -232.212112732
Pre-training layer 1, epoch 13, cost -231.218651581
Pre-training layer 1, epoch 14, cost -230.37579277
Pre-training layer 1, epoch 15, cost -229.490477295
Pre-training layer 1, epoch 15, representative training free energy -86639.4034687
Pre-training layer 1, epoch 15, validation free energy -85970.5728848
Pre-training layer 1, epoch 16, cost -228.738980789
Pre-training layer 1, epoch 17, cost -228.060279274
Pre-training layer 1, epoch 18, cost -227.438027229
Pre-training layer 1, epoch 19, cost -226.991131401
Pre-training layer 1, epoch 20, cost -226.471274109
Pre-training layer 1, epoch 20, representative training free energy -89062.365627
Pre-training layer 1, epoch 20, validation free energy -88368.7326211
Pre-training layer 1, epoch 21, cost -225.963771362
Pre-training layer 1, epoch 22, cost -225.57117878
Pre-training layer 1, epoch 23, cost -225.117318611
Pre-training layer 1, epoch 24, cost -224.712568588
Pre-training layer 1, epoch 25, cost -224.420117149
Pre-training layer 1, epoch 25, representative training free energy -91036.1793945
Pre-training layer 1, epoch 25, validation free energy -90330.4702852
Pre-training layer 1, epoch 26, cost -223.976026688
Pre-training layer 1, epoch 27, cost -223.691844635
Pre-training layer 1, epoch 28, cost -223.310221214
Pre-training layer 1, epoch 29, cost -222.929190941
Pre-training layer 1, epoch 30, cost -222.7707687
Pre-training layer 1, epoch 30, representative training free energy -92803.8034277
Pre-training layer 1, epoch 30, validation free energy -92073.5966836
Pre-training layer 1, epoch 31, cost -222.546692848
Pre-training layer 1, epoch 32, cost -222.329115219
Pre-training layer 1, epoch 33, cost -222.064920197
Pre-training layer 1, epoch 34, cost -221.738481331
Pre-training layer 1, epoch 35, cost -221.51600399
Pre-training layer 1, epoch 35, representative training free energy -94177.0935645
Pre-training layer 1, epoch 35, validation free energy -93430.6244902
Pre-training layer 1, epoch 36, cost -221.309193611
Pre-training layer 1, epoch 37, cost -221.132405548
Pre-training layer 1, epoch 38, cost -220.874223251
Pre-training layer 1, epoch 39, cost -220.698978806
Pre-training layer 1, epoch 40, cost -220.588261185
Pre-training layer 1, epoch 40, representative training free energy -95295.3750703
Pre-training layer 1, epoch 40, validation free energy -94530.8744805
Pre-training layer 1, epoch 41, cost -220.40793087
Pre-training layer 1, epoch 42, cost -220.155491409
Pre-training layer 1, epoch 43, cost -220.05113678
Pre-training layer 1, epoch 44, cost -220.00213398
Pre-training layer 1, epoch 45, cost -219.806859512
Pre-training layer 1, epoch 45, representative training free energy -96323.9228242
Pre-training layer 1, epoch 45, validation free energy -95551.2981641
Pre-training layer 1, epoch 46, cost -219.576792908
Pre-training layer 1, epoch 47, cost -219.490442848
Pre-training layer 1, epoch 48, cost -219.323333321
Pre-training layer 1, epoch 49, cost -219.137825813
Pre-training layer 1, epoch 50, cost -219.060673218
Pre-training layer 1, epoch 50, representative training free energy -97363.04325
Pre-training layer 1, epoch 50, validation free energy -96585.6786504
Pre-training layer 1, epoch 51, cost -218.910109329
Pre-training layer 1, epoch 52, cost -218.755571556
Pre-training layer 1, epoch 53, cost -218.600769691
Pre-training layer 1, epoch 54, cost -218.448979378
Pre-training layer 1, epoch 55, cost -218.423364182
Pre-training layer 1, epoch 55, representative training free energy -98245.0374395
Pre-training layer 1, epoch 55, validation free energy -97459.7003906
Pre-training layer 1, epoch 56, cost -218.277704277
Pre-training layer 1, epoch 57, cost -218.175952415
Pre-training layer 1, epoch 58, cost -218.051933365
Pre-training layer 1, epoch 59, cost -217.938448944
Pre-training layer 1, epoch 60, cost -217.771262894
Pre-training layer 1, epoch 60, representative training free energy -98997.4662109
Pre-training layer 1, epoch 60, validation free energy -98204.2719883
Pre-training layer 1, epoch 61, cost -217.733055687
Pre-training layer 1, epoch 62, cost -217.689040756
Pre-training layer 1, epoch 63, cost -217.584767838
Pre-training layer 1, epoch 64, cost -217.417209778
Pre-training layer 1, epoch 65, cost -217.378930283
Pre-training layer 1, epoch 65, representative training free energy -99835.9974766
Pre-training layer 1, epoch 65, validation free energy -99033.0270664
Pre-training layer 1, epoch 66, cost -217.257663689
Pre-training layer 1, epoch 67, cost -217.245351181
Pre-training layer 1, epoch 68, cost -217.177947159
Pre-training layer 1, epoch 69, cost -217.06388298
Pre-training layer 1, epoch 70, cost -216.943428764
Pre-training layer 1, epoch 70, representative training free energy -100683.983934
Pre-training layer 1, epoch 70, validation free energy -99872.3138828
Pre-training layer 1, epoch 71, cost -216.865762138
Pre-training layer 1, epoch 72, cost -216.695504227
Pre-training layer 1, epoch 73, cost -216.665192947
Pre-training layer 1, epoch 74, cost -216.557827415
Pre-training layer 1, epoch 75, cost -216.635562897
Pre-training layer 1, epoch 75, representative training free energy -101383.775697
Pre-training layer 1, epoch 75, validation free energy -100553.905098
Pre-training layer 1, epoch 76, cost -216.451536522
Pre-training layer 1, epoch 77, cost -216.329406624
Pre-training layer 1, epoch 78, cost -216.3070364
Pre-training layer 1, epoch 79, cost -216.311346283
Pre-training layer 1, epoch 80, cost -216.324552536
Pre-training layer 1, epoch 80, representative training free energy -102040.046043
Pre-training layer 1, epoch 80, validation free energy -101212.132594
Pre-training layer 1, epoch 81, cost -216.22643837
Pre-training layer 1, epoch 82, cost -216.063175049
Pre-training layer 1, epoch 83, cost -216.145569916
Pre-training layer 1, epoch 84, cost -216.030803757
Pre-training layer 1, epoch 85, cost -215.897378311
Pre-training layer 1, epoch 85, representative training free energy -102680.251004
Pre-training layer 1, epoch 85, validation free energy -101841.889352
Pre-training layer 1, epoch 86, cost -215.903947525
Pre-training layer 1, epoch 87, cost -215.649537125
Pre-training layer 1, epoch 88, cost -215.757547646
Pre-training layer 1, epoch 89, cost -215.685622559
Pre-training layer 1, epoch 90, cost -215.540499153
Pre-training layer 1, epoch 90, representative training free energy -103281.523615
Pre-training layer 1, epoch 90, validation free energy -102430.353078
Pre-training layer 1, epoch 91, cost -215.523902626
Pre-training layer 1, epoch 92, cost -215.45610611
Pre-training layer 1, epoch 93, cost -215.430524979
Pre-training layer 1, epoch 94, cost -215.375428276
Pre-training layer 1, epoch 95, cost -215.405717278
Pre-training layer 1, epoch 95, representative training free energy -103852.912043
Pre-training layer 1, epoch 95, validation free energy -102989.008441
Pre-training layer 1, epoch 96, cost -215.156808052
Pre-training layer 1, epoch 97, cost -215.087783623
Pre-training layer 1, epoch 98, cost -215.112295837
Pre-training layer 1, epoch 99, cost -215.147179527
Pre-training layer 2, epoch 0, cost -119.813201408
Pre-training layer 2, epoch 0, representative training free energy 3398.47601331
Pre-training layer 2, epoch 0, validation free energy 3358.38663556
Pre-training layer 2, epoch 1, cost -90.0383804131
Pre-training layer 2, epoch 2, cost -83.6162442207
Pre-training layer 2, epoch 3, cost -79.7876590443
Pre-training layer 2, epoch 4, cost -77.2880639267
Pre-training layer 2, epoch 5, cost -75.5365150356
Pre-training layer 2, epoch 5, representative training free energy 5578.10744067
Pre-training layer 2, epoch 5, validation free energy 5530.64471277
Pre-training layer 2, epoch 6, cost -74.0156964684
Pre-training layer 2, epoch 7, cost -72.8575420666
Pre-training layer 2, epoch 8, cost -71.9733876991
Pre-training layer 2, epoch 9, cost -71.1344961166
Pre-training layer 2, epoch 10, cost -70.4393632221
Pre-training layer 2, epoch 10, representative training free energy 6834.42908423
Pre-training layer 2, epoch 10, validation free energy 6770.64134937
Pre-training layer 2, epoch 11, cost -69.7284031487
Pre-training layer 2, epoch 12, cost -69.2796244049
Pre-training layer 2, epoch 13, cost -68.8116408634
Pre-training layer 2, epoch 14, cost -68.3160310936
Pre-training layer 2, epoch 15, cost -67.9562398911
Pre-training layer 2, epoch 15, representative training free energy 7791.26252881
Pre-training layer 2, epoch 15, validation free energy 7718.0433584
Pre-training layer 2, epoch 16, cost -67.6168772221
Pre-training layer 2, epoch 17, cost -67.4048620605
Pre-training layer 2, epoch 18, cost -67.0081614017
Pre-training layer 2, epoch 19, cost -66.763603611
Pre-training layer 2, epoch 20, cost -66.5102965641
Pre-training layer 2, epoch 20, representative training free energy 8563.16149756
Pre-training layer 2, epoch 20, validation free energy 8489.1898728
Pre-training layer 2, epoch 21, cost -66.3526156998
Pre-training layer 2, epoch 22, cost -66.0513473892
Pre-training layer 2, epoch 23, cost -65.8294872665
Pre-training layer 2, epoch 24, cost -65.7919887161
Pre-training layer 2, epoch 25, cost -65.5970780945
Pre-training layer 2, epoch 25, representative training free energy 9235.65505518
Pre-training layer 2, epoch 25, validation free energy 9156.95781665
Pre-training layer 2, epoch 26, cost -65.3740512753
Pre-training layer 2, epoch 27, cost -65.2465036106
Pre-training layer 2, epoch 28, cost -65.1719484901
Pre-training layer 2, epoch 29, cost -64.9960545826
Pre-training layer 2, epoch 30, cost -64.9187645149
Pre-training layer 2, epoch 30, representative training free energy 9812.82052905
Pre-training layer 2, epoch 30, validation free energy 9732.59002515
Pre-training layer 2, epoch 31, cost -64.7949611282
Pre-training layer 2, epoch 32, cost -64.614405365
Pre-training layer 2, epoch 33, cost -64.5315925407
Pre-training layer 2, epoch 34, cost -64.5478592396
Pre-training layer 2, epoch 35, cost -64.4374237919
Pre-training layer 2, epoch 35, representative training free energy 10298.2260627
Pre-training layer 2, epoch 35, validation free energy 10215.0040505
Pre-training layer 2, epoch 36, cost -64.3357200718
Pre-training layer 2, epoch 37, cost -64.1796577358
Pre-training layer 2, epoch 38, cost -64.0689754772
Pre-training layer 2, epoch 39, cost -64.0389901638
Pre-training layer 2, epoch 40, cost -63.9500671101
Pre-training layer 2, epoch 40, representative training free energy 10749.0907366
Pre-training layer 2, epoch 40, validation free energy 10663.9451536
Pre-training layer 2, epoch 41, cost -63.8837777615
Pre-training layer 2, epoch 42, cost -63.7729323292
Pre-training layer 2, epoch 43, cost -63.7608413887
Pre-training layer 2, epoch 44, cost -63.6335685635
Pre-training layer 2, epoch 45, cost -63.673284111
Pre-training layer 2, epoch 45, representative training free energy 11145.4384827
Pre-training layer 2, epoch 45, validation free energy 11057.493106
Pre-training layer 2, epoch 46, cost -63.5852191639
Pre-training layer 2, epoch 47, cost -63.4716244411
Pre-training layer 2, epoch 48, cost -63.3800384045
Pre-training layer 2, epoch 49, cost -63.3764788055
Pre-training layer 2, epoch 50, cost -63.3183526516
Pre-training layer 2, epoch 50, representative training free energy 11529.1657642
Pre-training layer 2, epoch 50, validation free energy 11440.1200015
Pre-training layer 2, epoch 51, cost -63.2213535786
Pre-training layer 2, epoch 52, cost -63.1766557693
Pre-training layer 2, epoch 53, cost -63.1370529842
Pre-training layer 2, epoch 54, cost -63.1123377895
Pre-training layer 2, epoch 55, cost -63.050344286
Pre-training layer 2, epoch 55, representative training free energy 11884.0071929
Pre-training layer 2, epoch 55, validation free energy 11791.0637656
Pre-training layer 2, epoch 56, cost -63.0168844986
Pre-training layer 2, epoch 57, cost -62.9853282356
Pre-training layer 2, epoch 58, cost -62.9831083488
Pre-training layer 2, epoch 59, cost -62.9090238476
Pre-training layer 2, epoch 60, cost -62.8845617104
Pre-training layer 2, epoch 60, representative training free energy 12202.2028271
Pre-training layer 2, epoch 60, validation free energy 12107.1817339
Pre-training layer 2, epoch 61, cost -62.9076255989
Pre-training layer 2, epoch 62, cost -62.7120240402
Pre-training layer 2, epoch 63, cost -62.67132658
Pre-training layer 2, epoch 64, cost -62.6521720314
Pre-training layer 2, epoch 65, cost -62.6668413353
Pre-training layer 2, epoch 65, representative training free energy 12512.8881765
Pre-training layer 2, epoch 65, validation free energy 12414.5808359
Pre-training layer 2, epoch 66, cost -62.6606248093
Pre-training layer 2, epoch 67, cost -62.600660038
Pre-training layer 2, epoch 68, cost -62.5802239132
Pre-training layer 2, epoch 69, cost -62.5390794945
Pre-training layer 2, epoch 70, cost -62.5201226616
Pre-training layer 2, epoch 70, representative training free energy 12776.3865347
Pre-training layer 2, epoch 70, validation free energy 12676.8140054
Pre-training layer 2, epoch 71, cost -62.4999495506
Pre-training layer 2, epoch 72, cost -62.4024343204
Pre-training layer 2, epoch 73, cost -62.4094851971
Pre-training layer 2, epoch 74, cost -62.3737504959
Pre-training layer 2, epoch 75, cost -62.3032523632
Pre-training layer 2, epoch 75, representative training free energy 13091.0071699
Pre-training layer 2, epoch 75, validation free energy 12988.5312656
Pre-training layer 2, epoch 76, cost -62.2951817226
Pre-training layer 2, epoch 77, cost -62.2469113827
Pre-training layer 2, epoch 78, cost -62.2312198639
Pre-training layer 2, epoch 79, cost -62.1807015228
Pre-training layer 2, epoch 80, cost -62.2289063454
Pre-training layer 2, epoch 80, representative training free energy 13321.0754229
Pre-training layer 2, epoch 80, validation free energy 13218.2408921
Pre-training layer 2, epoch 81, cost -62.1428518009
Pre-training layer 2, epoch 82, cost -62.2085355759
Pre-training layer 2, epoch 83, cost -62.1631111336
Pre-training layer 2, epoch 84, cost -62.1960599899
Pre-training layer 2, epoch 85, cost -62.1058255291
Pre-training layer 2, epoch 85, representative training free energy 13581.6573032
Pre-training layer 2, epoch 85, validation free energy 13474.8454985
Pre-training layer 2, epoch 86, cost -62.0484974098
Pre-training layer 2, epoch 87, cost -62.0757497406
Pre-training layer 2, epoch 88, cost -61.9017924118
Pre-training layer 2, epoch 89, cost -61.9998730755
Pre-training layer 2, epoch 90, cost -61.968929348
Pre-training layer 2, epoch 90, representative training free energy 13861.1986514
Pre-training layer 2, epoch 90, validation free energy 13752.0769272
Pre-training layer 2, epoch 91, cost -61.9157225609
Pre-training layer 2, epoch 92, cost -61.9051000881
Pre-training layer 2, epoch 93, cost -61.8661442566
Pre-training layer 2, epoch 94, cost -61.8771467972
Pre-training layer 2, epoch 95, cost -61.9393585014
Pre-training layer 2, epoch 95, representative training free energy 14089.4814741
Pre-training layer 2, epoch 95, validation free energy 13978.2397939
Pre-training layer 2, epoch 96, cost -61.7745512295
Pre-training layer 2, epoch 97, cost -61.7841618919
Pre-training layer 2, epoch 98, cost -61.7702822495
Pre-training layer 2, epoch 99, cost -61.7658975315
The pretraining code for file dbn_loop.pyc ran for 10.46m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 34.200000 %
     epoch 1, minibatch 400/400, test error of best model 29.800000 %
epoch 2, minibatch 400/400, validation error 25.100000 %
     epoch 2, minibatch 400/400, test error of best model 16.600000 %
epoch 3, minibatch 400/400, validation error 23.100000 %
     epoch 3, minibatch 400/400, test error of best model 12.800000 %
epoch 4, minibatch 400/400, validation error 21.400000 %
     epoch 4, minibatch 400/400, test error of best model 11.100000 %
epoch 5, minibatch 400/400, validation error 20.500000 %
     epoch 5, minibatch 400/400, test error of best model 10.400000 %
epoch 6, minibatch 400/400, validation error 19.300000 %
     epoch 6, minibatch 400/400, test error of best model 9.600000 %
epoch 7, minibatch 400/400, validation error 18.500000 %
     epoch 7, minibatch 400/400, test error of best model 8.800000 %
epoch 8, minibatch 400/400, validation error 17.800000 %
     epoch 8, minibatch 400/400, test error of best model 8.400000 %
epoch 9, minibatch 400/400, validation error 17.100000 %
     epoch 9, minibatch 400/400, test error of best model 7.800000 %
epoch 10, minibatch 400/400, validation error 16.800000 %
     epoch 10, minibatch 400/400, test error of best model 7.000000 %
epoch 11, minibatch 400/400, validation error 16.700000 %
     epoch 11, minibatch 400/400, test error of best model 7.000000 %
epoch 12, minibatch 400/400, validation error 16.200000 %
     epoch 12, minibatch 400/400, test error of best model 6.600000 %
epoch 13, minibatch 400/400, validation error 16.000000 %
     epoch 13, minibatch 400/400, test error of best model 6.400000 %
epoch 14, minibatch 400/400, validation error 15.700000 %
     epoch 14, minibatch 400/400, test error of best model 6.300000 %
epoch 15, minibatch 400/400, validation error 15.500000 %
     epoch 15, minibatch 400/400, test error of best model 6.300000 %
epoch 16, minibatch 400/400, validation error 15.500000 %
epoch 17, minibatch 400/400, validation error 15.600000 %
epoch 18, minibatch 400/400, validation error 15.500000 %
epoch 19, minibatch 400/400, validation error 15.400000 %
     epoch 19, minibatch 400/400, test error of best model 6.400000 %
epoch 20, minibatch 400/400, validation error 15.400000 %
epoch 21, minibatch 400/400, validation error 15.400000 %
epoch 22, minibatch 400/400, validation error 15.500000 %
epoch 23, minibatch 400/400, validation error 15.500000 %
epoch 24, minibatch 400/400, validation error 15.600000 %
epoch 25, minibatch 400/400, validation error 15.500000 %
epoch 26, minibatch 400/400, validation error 15.500000 %
epoch 27, minibatch 400/400, validation error 15.500000 %
epoch 28, minibatch 400/400, validation error 15.500000 %
epoch 29, minibatch 400/400, validation error 15.500000 %
epoch 30, minibatch 400/400, validation error 15.300000 %
     epoch 30, minibatch 400/400, test error of best model 6.500000 %
epoch 31, minibatch 400/400, validation error 15.400000 %
epoch 32, minibatch 400/400, validation error 15.400000 %
epoch 33, minibatch 400/400, validation error 15.400000 %
epoch 34, minibatch 400/400, validation error 15.400000 %
epoch 35, minibatch 400/400, validation error 15.400000 %
epoch 36, minibatch 400/400, validation error 15.300000 %
epoch 37, minibatch 400/400, validation error 15.200000 %
     epoch 37, minibatch 400/400, test error of best model 6.300000 %
epoch 38, minibatch 400/400, validation error 15.200000 %
epoch 39, minibatch 400/400, validation error 15.200000 %
epoch 40, minibatch 400/400, validation error 15.100000 %
     epoch 40, minibatch 400/400, test error of best model 6.200000 %
epoch 41, minibatch 400/400, validation error 15.100000 %
epoch 42, minibatch 400/400, validation error 15.100000 %
epoch 43, minibatch 400/400, validation error 15.100000 %
epoch 44, minibatch 400/400, validation error 15.100000 %
epoch 45, minibatch 400/400, validation error 15.100000 %
epoch 46, minibatch 400/400, validation error 15.100000 %
epoch 47, minibatch 400/400, validation error 15.100000 %
epoch 48, minibatch 400/400, validation error 15.000000 %
     epoch 48, minibatch 400/400, test error of best model 6.100000 %
epoch 49, minibatch 400/400, validation error 15.000000 %
epoch 50, minibatch 400/400, validation error 15.000000 %
epoch 51, minibatch 400/400, validation error 15.000000 %
epoch 52, minibatch 400/400, validation error 15.000000 %
epoch 53, minibatch 400/400, validation error 15.000000 %
epoch 54, minibatch 400/400, validation error 15.000000 %
epoch 55, minibatch 400/400, validation error 15.000000 %
epoch 56, minibatch 400/400, validation error 15.000000 %
epoch 57, minibatch 400/400, validation error 15.000000 %
epoch 58, minibatch 400/400, validation error 15.000000 %
epoch 59, minibatch 400/400, validation error 15.000000 %
epoch 60, minibatch 400/400, validation error 15.000000 %
epoch 61, minibatch 400/400, validation error 15.000000 %
epoch 62, minibatch 400/400, validation error 14.900000 %
     epoch 62, minibatch 400/400, test error of best model 6.000000 %
epoch 63, minibatch 400/400, validation error 15.000000 %
epoch 64, minibatch 400/400, validation error 15.000000 %
epoch 65, minibatch 400/400, validation error 15.000000 %
epoch 66, minibatch 400/400, validation error 15.000000 %
epoch 67, minibatch 400/400, validation error 15.000000 %
epoch 68, minibatch 400/400, validation error 15.000000 %
epoch 69, minibatch 400/400, validation error 15.000000 %
epoch 70, minibatch 400/400, validation error 15.000000 %
epoch 71, minibatch 400/400, validation error 15.000000 %
epoch 72, minibatch 400/400, validation error 15.000000 %
epoch 73, minibatch 400/400, validation error 15.000000 %
epoch 74, minibatch 400/400, validation error 15.000000 %
epoch 75, minibatch 400/400, validation error 15.000000 %
epoch 76, minibatch 400/400, validation error 15.000000 %
epoch 77, minibatch 400/400, validation error 15.000000 %
epoch 78, minibatch 400/400, validation error 15.000000 %
epoch 79, minibatch 400/400, validation error 15.000000 %
epoch 80, minibatch 400/400, validation error 15.000000 %
epoch 81, minibatch 400/400, validation error 14.900000 %
epoch 82, minibatch 400/400, validation error 14.900000 %
epoch 83, minibatch 400/400, validation error 14.900000 %
epoch 84, minibatch 400/400, validation error 14.900000 %
epoch 85, minibatch 400/400, validation error 14.900000 %
epoch 86, minibatch 400/400, validation error 14.900000 %
epoch 87, minibatch 400/400, validation error 14.800000 %
     epoch 87, minibatch 400/400, test error of best model 5.900000 %
epoch 88, minibatch 400/400, validation error 14.800000 %
epoch 89, minibatch 400/400, validation error 14.800000 %
epoch 90, minibatch 400/400, validation error 14.800000 %
epoch 91, minibatch 400/400, validation error 14.800000 %
epoch 92, minibatch 400/400, validation error 14.800000 %
epoch 93, minibatch 400/400, validation error 14.800000 %
epoch 94, minibatch 400/400, validation error 14.800000 %
epoch 95, minibatch 400/400, validation error 14.800000 %
epoch 96, minibatch 400/400, validation error 14.800000 %
epoch 97, minibatch 400/400, validation error 14.800000 %
epoch 98, minibatch 400/400, validation error 14.800000 %
epoch 99, minibatch 400/400, validation error 14.800000 %
epoch 100, minibatch 400/400, validation error 14.900000 %
epoch 101, minibatch 400/400, validation error 14.900000 %
epoch 102, minibatch 400/400, validation error 14.900000 %
epoch 103, minibatch 400/400, validation error 14.900000 %
epoch 104, minibatch 400/400, validation error 14.900000 %
epoch 105, minibatch 400/400, validation error 15.000000 %
epoch 106, minibatch 400/400, validation error 15.000000 %
epoch 107, minibatch 400/400, validation error 15.000000 %
epoch 108, minibatch 400/400, validation error 15.000000 %
epoch 109, minibatch 400/400, validation error 15.000000 %
epoch 110, minibatch 400/400, validation error 15.000000 %
epoch 111, minibatch 400/400, validation error 15.000000 %
epoch 112, minibatch 400/400, validation error 15.000000 %
epoch 113, minibatch 400/400, validation error 15.000000 %
epoch 114, minibatch 400/400, validation error 15.000000 %
epoch 115, minibatch 400/400, validation error 15.000000 %
epoch 116, minibatch 400/400, validation error 15.000000 %
epoch 117, minibatch 400/400, validation error 15.000000 %
epoch 118, minibatch 400/400, validation error 15.000000 %
epoch 119, minibatch 400/400, validation error 15.000000 %
epoch 120, minibatch 400/400, validation error 15.000000 %
epoch 121, minibatch 400/400, validation error 15.000000 %
epoch 122, minibatch 400/400, validation error 15.000000 %
epoch 123, minibatch 400/400, validation error 15.000000 %
epoch 124, minibatch 400/400, validation error 15.000000 %
epoch 125, minibatch 400/400, validation error 14.900000 %
epoch 126, minibatch 400/400, validation error 14.900000 %
epoch 127, minibatch 400/400, validation error 14.900000 %
epoch 128, minibatch 400/400, validation error 14.900000 %
epoch 129, minibatch 400/400, validation error 14.900000 %
epoch 130, minibatch 400/400, validation error 14.900000 %
epoch 131, minibatch 400/400, validation error 14.900000 %
epoch 132, minibatch 400/400, validation error 14.900000 %
epoch 133, minibatch 400/400, validation error 14.900000 %
epoch 134, minibatch 400/400, validation error 14.900000 %
epoch 135, minibatch 400/400, validation error 14.900000 %
epoch 136, minibatch 400/400, validation error 14.900000 %
epoch 137, minibatch 400/400, validation error 14.900000 %
epoch 138, minibatch 400/400, validation error 14.900000 %
epoch 139, minibatch 400/400, validation error 14.900000 %
epoch 140, minibatch 400/400, validation error 14.900000 %
epoch 141, minibatch 400/400, validation error 14.900000 %
epoch 142, minibatch 400/400, validation error 14.900000 %
epoch 143, minibatch 400/400, validation error 14.900000 %
epoch 144, minibatch 400/400, validation error 14.900000 %
epoch 145, minibatch 400/400, validation error 14.900000 %
epoch 146, minibatch 400/400, validation error 14.900000 %
epoch 147, minibatch 400/400, validation error 14.900000 %
epoch 148, minibatch 400/400, validation error 14.900000 %
epoch 149, minibatch 400/400, validation error 14.900000 %
epoch 150, minibatch 400/400, validation error 14.900000 %
epoch 151, minibatch 400/400, validation error 14.900000 %
epoch 152, minibatch 400/400, validation error 14.900000 %
epoch 153, minibatch 400/400, validation error 14.900000 %
epoch 154, minibatch 400/400, validation error 14.900000 %
epoch 155, minibatch 400/400, validation error 14.900000 %
epoch 156, minibatch 400/400, validation error 14.900000 %
epoch 157, minibatch 400/400, validation error 14.900000 %
epoch 158, minibatch 400/400, validation error 14.900000 %
epoch 159, minibatch 400/400, validation error 14.900000 %
epoch 160, minibatch 400/400, validation error 14.900000 %
epoch 161, minibatch 400/400, validation error 14.900000 %
epoch 162, minibatch 400/400, validation error 14.900000 %
epoch 163, minibatch 400/400, validation error 14.900000 %
epoch 164, minibatch 400/400, validation error 14.900000 %
epoch 165, minibatch 400/400, validation error 14.900000 %
epoch 166, minibatch 400/400, validation error 14.900000 %
epoch 167, minibatch 400/400, validation error 14.900000 %
epoch 168, minibatch 400/400, validation error 14.900000 %
epoch 169, minibatch 400/400, validation error 14.900000 %
epoch 170, minibatch 400/400, validation error 14.900000 %
epoch 171, minibatch 400/400, validation error 14.800000 %
epoch 172, minibatch 400/400, validation error 14.800000 %
epoch 173, minibatch 400/400, validation error 14.800000 %
Optimization complete with best validation score of 14.800000 %, obtained at iteration 34800, with test performance 5.900000 %
The fine tuning code for file dbn_loop.pyc ran for 5.83m


==========Sample: (5000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.458343109
Pre-training layer 0, epoch 0, representative training free energy -545.232632141
Pre-training layer 0, epoch 0, validation free energy -541.320456573
Pre-training layer 0, epoch 1, cost -108.739277512
Pre-training layer 0, epoch 2, cost -100.979415314
Pre-training layer 0, epoch 3, cost -96.3160080872
Pre-training layer 0, epoch 4, cost -93.5508003693
Pre-training layer 0, epoch 5, cost -91.3810725708
Pre-training layer 0, epoch 5, representative training free energy -487.035499298
Pre-training layer 0, epoch 5, validation free energy -482.223570496
Pre-training layer 0, epoch 6, cost -89.6408054657
Pre-training layer 0, epoch 7, cost -88.1702746429
Pre-training layer 0, epoch 8, cost -87.093085083
Pre-training layer 0, epoch 9, cost -86.186596756
Pre-training layer 0, epoch 10, cost -85.3377607422
Pre-training layer 0, epoch 10, representative training free energy -464.544327576
Pre-training layer 0, epoch 10, validation free energy -458.628792114
Pre-training layer 0, epoch 11, cost -84.5638167419
Pre-training layer 0, epoch 12, cost -83.9278636093
Pre-training layer 0, epoch 13, cost -83.3342235489
Pre-training layer 0, epoch 14, cost -82.8925335541
Pre-training layer 0, epoch 15, cost -82.3058362885
Pre-training layer 0, epoch 15, representative training free energy -456.073785309
Pre-training layer 0, epoch 15, validation free energy -450.550131714
Pre-training layer 0, epoch 16, cost -81.9347272949
Pre-training layer 0, epoch 17, cost -81.6146494598
Pre-training layer 0, epoch 18, cost -81.1404228058
Pre-training layer 0, epoch 19, cost -80.8083930969
Pre-training layer 0, epoch 20, cost -80.4864031754
Pre-training layer 0, epoch 20, representative training free energy -447.613580078
Pre-training layer 0, epoch 20, validation free energy -441.021037903
Pre-training layer 0, epoch 21, cost -80.1872696075
Pre-training layer 0, epoch 22, cost -79.9627870407
Pre-training layer 0, epoch 23, cost -79.6183879852
Pre-training layer 0, epoch 24, cost -79.4389675369
Pre-training layer 0, epoch 25, cost -79.2128029175
Pre-training layer 0, epoch 25, representative training free energy -442.723213593
Pre-training layer 0, epoch 25, validation free energy -436.359384583
Pre-training layer 0, epoch 26, cost -79.06858358
Pre-training layer 0, epoch 27, cost -78.6927599564
Pre-training layer 0, epoch 28, cost -78.7399024811
Pre-training layer 0, epoch 29, cost -78.3412397537
Pre-training layer 0, epoch 30, cost -78.232607193
Pre-training layer 0, epoch 30, representative training free energy -441.706291504
Pre-training layer 0, epoch 30, validation free energy -434.654575592
Pre-training layer 0, epoch 31, cost -78.0349830475
Pre-training layer 0, epoch 32, cost -77.8053131409
Pre-training layer 0, epoch 33, cost -77.6455118866
Pre-training layer 0, epoch 34, cost -77.5253651581
Pre-training layer 0, epoch 35, cost -77.3231836929
Pre-training layer 0, epoch 35, representative training free energy -435.615846405
Pre-training layer 0, epoch 35, validation free energy -428.73532016
Pre-training layer 0, epoch 36, cost -77.2369339676
Pre-training layer 0, epoch 37, cost -77.1086820679
Pre-training layer 0, epoch 38, cost -76.9883395386
Pre-training layer 0, epoch 39, cost -76.7962866364
Pre-training layer 0, epoch 40, cost -76.6861610641
Pre-training layer 0, epoch 40, representative training free energy -434.997797272
Pre-training layer 0, epoch 40, validation free energy -427.970036987
Pre-training layer 0, epoch 41, cost -76.4905338287
Pre-training layer 0, epoch 42, cost -76.5034717941
Pre-training layer 0, epoch 43, cost -76.3770420685
Pre-training layer 0, epoch 44, cost -76.20874617
Pre-training layer 0, epoch 45, cost -76.1037799911
Pre-training layer 0, epoch 45, representative training free energy -433.234639893
Pre-training layer 0, epoch 45, validation free energy -425.182215149
Pre-training layer 0, epoch 46, cost -75.9702490158
Pre-training layer 0, epoch 47, cost -75.826573349
Pre-training layer 0, epoch 48, cost -75.7928781281
Pre-training layer 0, epoch 49, cost -75.6514355927
Pre-training layer 0, epoch 50, cost -75.6229441223
Pre-training layer 0, epoch 50, representative training free energy -433.154927582
Pre-training layer 0, epoch 50, validation free energy -425.199173889
Pre-training layer 0, epoch 51, cost -75.4857853775
Pre-training layer 0, epoch 52, cost -75.4841629562
Pre-training layer 0, epoch 53, cost -75.2698440399
Pre-training layer 0, epoch 54, cost -75.2552864685
Pre-training layer 0, epoch 55, cost -75.1471788254
Pre-training layer 0, epoch 55, representative training free energy -431.263851379
Pre-training layer 0, epoch 55, validation free energy -423.67944754
Pre-training layer 0, epoch 56, cost -75.165373085
Pre-training layer 0, epoch 57, cost -74.9905080414
Pre-training layer 0, epoch 58, cost -74.9698887482
Pre-training layer 0, epoch 59, cost -74.8730291748
Pre-training layer 0, epoch 60, cost -74.8278737106
Pre-training layer 0, epoch 60, representative training free energy -428.62788382
Pre-training layer 0, epoch 60, validation free energy -420.487261871
Pre-training layer 0, epoch 61, cost -74.6511202011
Pre-training layer 0, epoch 62, cost -74.6544218292
Pre-training layer 0, epoch 63, cost -74.6194761734
Pre-training layer 0, epoch 64, cost -74.5669592056
Pre-training layer 0, epoch 65, cost -74.412506958
Pre-training layer 0, epoch 65, representative training free energy -429.693623383
Pre-training layer 0, epoch 65, validation free energy -421.532291534
Pre-training layer 0, epoch 66, cost -74.4295451202
Pre-training layer 0, epoch 67, cost -74.2466773605
Pre-training layer 0, epoch 68, cost -74.3210159531
Pre-training layer 0, epoch 69, cost -74.1407795105
Pre-training layer 0, epoch 70, cost -74.182251297
Pre-training layer 0, epoch 70, representative training free energy -427.195711639
Pre-training layer 0, epoch 70, validation free energy -419.040451416
Pre-training layer 0, epoch 71, cost -74.1395892563
Pre-training layer 0, epoch 72, cost -74.0926735916
Pre-training layer 0, epoch 73, cost -73.9779874649
Pre-training layer 0, epoch 74, cost -73.9226277618
Pre-training layer 0, epoch 75, cost -73.8471356354
Pre-training layer 0, epoch 75, representative training free energy -424.671957611
Pre-training layer 0, epoch 75, validation free energy -416.736838287
Pre-training layer 0, epoch 76, cost -73.7020600967
Pre-training layer 0, epoch 77, cost -73.6799390717
Pre-training layer 0, epoch 78, cost -73.7023311996
Pre-training layer 0, epoch 79, cost -73.5467043839
Pre-training layer 0, epoch 80, cost -73.580100296
Pre-training layer 0, epoch 80, representative training free energy -425.805310089
Pre-training layer 0, epoch 80, validation free energy -417.017645996
Pre-training layer 0, epoch 81, cost -73.5388202744
Pre-training layer 0, epoch 82, cost -73.4232589951
Pre-training layer 0, epoch 83, cost -73.4289825592
Pre-training layer 0, epoch 84, cost -73.353449913
Pre-training layer 0, epoch 85, cost -73.2411859665
Pre-training layer 0, epoch 85, representative training free energy -423.520582916
Pre-training layer 0, epoch 85, validation free energy -415.458164429
Pre-training layer 0, epoch 86, cost -73.3490223389
Pre-training layer 0, epoch 87, cost -73.2638059387
Pre-training layer 0, epoch 88, cost -73.176750885
Pre-training layer 0, epoch 89, cost -73.1343738785
Pre-training layer 0, epoch 90, cost -73.0021869125
Pre-training layer 0, epoch 90, representative training free energy -423.138203369
Pre-training layer 0, epoch 90, validation free energy -414.293982727
Pre-training layer 0, epoch 91, cost -73.015542717
Pre-training layer 0, epoch 92, cost -72.9399039841
Pre-training layer 0, epoch 93, cost -72.9070180054
Pre-training layer 0, epoch 94, cost -72.9306473312
Pre-training layer 0, epoch 95, cost -72.9010939026
Pre-training layer 0, epoch 95, representative training free energy -420.875469086
Pre-training layer 0, epoch 95, validation free energy -411.868512634
Pre-training layer 0, epoch 96, cost -72.862506485
Pre-training layer 0, epoch 97, cost -72.8156486816
Pre-training layer 0, epoch 98, cost -72.7639526367
Pre-training layer 0, epoch 99, cost -72.734575592
Pre-training layer 1, epoch 0, cost -311.45688797
Pre-training layer 1, epoch 0, representative training free energy -61943.1618281
Pre-training layer 1, epoch 0, validation free energy -61492.7444746
Pre-training layer 1, epoch 1, cost -267.821978363
Pre-training layer 1, epoch 2, cost -254.389285187
Pre-training layer 1, epoch 3, cost -246.58123407
Pre-training layer 1, epoch 4, cost -241.3925466
Pre-training layer 1, epoch 5, cost -237.588397308
Pre-training layer 1, epoch 5, representative training free energy -82213.648377
Pre-training layer 1, epoch 5, validation free energy -81537.9072891
Pre-training layer 1, epoch 6, cost -234.663608673
Pre-training layer 1, epoch 7, cost -232.400099182
Pre-training layer 1, epoch 8, cost -230.429603394
Pre-training layer 1, epoch 9, cost -228.792603027
Pre-training layer 1, epoch 10, cost -227.418085022
Pre-training layer 1, epoch 10, representative training free energy -88286.9424668
Pre-training layer 1, epoch 10, validation free energy -87531.1880469
Pre-training layer 1, epoch 11, cost -226.289493469
Pre-training layer 1, epoch 12, cost -225.261139404
Pre-training layer 1, epoch 13, cost -224.3541633
Pre-training layer 1, epoch 14, cost -223.510338531
Pre-training layer 1, epoch 15, cost -222.706330078
Pre-training layer 1, epoch 15, representative training free energy -91978.6078555
Pre-training layer 1, epoch 15, validation free energy -91181.9167441
Pre-training layer 1, epoch 16, cost -222.192492554
Pre-training layer 1, epoch 17, cost -221.513632996
Pre-training layer 1, epoch 18, cost -220.958156769
Pre-training layer 1, epoch 19, cost -220.386723724
Pre-training layer 1, epoch 20, cost -220.029809662
Pre-training layer 1, epoch 20, representative training free energy -94447.3617598
Pre-training layer 1, epoch 20, validation free energy -93622.7660762
Pre-training layer 1, epoch 21, cost -219.546748871
Pre-training layer 1, epoch 22, cost -219.178183075
Pre-training layer 1, epoch 23, cost -218.774403442
Pre-training layer 1, epoch 24, cost -218.493191437
Pre-training layer 1, epoch 25, cost -218.041769409
Pre-training layer 1, epoch 25, representative training free energy -96637.3700293
Pre-training layer 1, epoch 25, validation free energy -95788.4865742
Pre-training layer 1, epoch 26, cost -217.804416901
Pre-training layer 1, epoch 27, cost -217.43174176
Pre-training layer 1, epoch 28, cost -217.084153442
Pre-training layer 1, epoch 29, cost -216.876529907
Pre-training layer 1, epoch 30, cost -216.563758759
Pre-training layer 1, epoch 30, representative training free energy -98421.5410625
Pre-training layer 1, epoch 30, validation free energy -97544.8537559
Pre-training layer 1, epoch 31, cost -216.436695313
Pre-training layer 1, epoch 32, cost -216.1921492
Pre-training layer 1, epoch 33, cost -215.875114899
Pre-training layer 1, epoch 34, cost -215.764825256
Pre-training layer 1, epoch 35, cost -215.401026154
Pre-training layer 1, epoch 35, representative training free energy -99852.5088965
Pre-training layer 1, epoch 35, validation free energy -98950.5722129
Pre-training layer 1, epoch 36, cost -215.221089905
Pre-training layer 1, epoch 37, cost -215.150950317
Pre-training layer 1, epoch 38, cost -214.974215271
Pre-training layer 1, epoch 39, cost -214.728927063
Pre-training layer 1, epoch 40, cost -214.552466095
Pre-training layer 1, epoch 40, representative training free energy -101205.454824
Pre-training layer 1, epoch 40, validation free energy -100294.514453
Pre-training layer 1, epoch 41, cost -214.45568573
Pre-training layer 1, epoch 42, cost -214.283803253
Pre-training layer 1, epoch 43, cost -214.021374695
Pre-training layer 1, epoch 44, cost -213.949195007
Pre-training layer 1, epoch 45, cost -213.799083893
Pre-training layer 1, epoch 45, representative training free energy -102402.549959
Pre-training layer 1, epoch 45, validation free energy -101483.883293
Pre-training layer 1, epoch 46, cost -213.668937469
Pre-training layer 1, epoch 47, cost -213.573221436
Pre-training layer 1, epoch 48, cost -213.349969238
Pre-training layer 1, epoch 49, cost -213.241720398
Pre-training layer 1, epoch 50, cost -213.119452972
Pre-training layer 1, epoch 50, representative training free energy -103421.928969
Pre-training layer 1, epoch 50, validation free energy -102488.181773
Pre-training layer 1, epoch 51, cost -213.002622711
Pre-training layer 1, epoch 52, cost -212.915089966
Pre-training layer 1, epoch 53, cost -212.768608337
Pre-training layer 1, epoch 54, cost -212.602626617
Pre-training layer 1, epoch 55, cost -212.666095642
Pre-training layer 1, epoch 55, representative training free energy -104446.870637
Pre-training layer 1, epoch 55, validation free energy -103522.573324
Pre-training layer 1, epoch 56, cost -212.476761841
Pre-training layer 1, epoch 57, cost -212.264902039
Pre-training layer 1, epoch 58, cost -212.302939545
Pre-training layer 1, epoch 59, cost -212.157618408
Pre-training layer 1, epoch 60, cost -212.024033508
Pre-training layer 1, epoch 60, representative training free energy -105340.181488
Pre-training layer 1, epoch 60, validation free energy -104405.617941
Pre-training layer 1, epoch 61, cost -212.000651917
Pre-training layer 1, epoch 62, cost -211.90953299
Pre-training layer 1, epoch 63, cost -211.828830322
Pre-training layer 1, epoch 64, cost -211.738060028
Pre-training layer 1, epoch 65, cost -211.606442139
Pre-training layer 1, epoch 65, representative training free energy -106083.103195
Pre-training layer 1, epoch 65, validation free energy -105132.386484
Pre-training layer 1, epoch 66, cost -211.540413574
Pre-training layer 1, epoch 67, cost -211.44091095
Pre-training layer 1, epoch 68, cost -211.398421997
Pre-training layer 1, epoch 69, cost -211.243203827
Pre-training layer 1, epoch 70, cost -211.2141716
Pre-training layer 1, epoch 70, representative training free energy -107014.810652
Pre-training layer 1, epoch 70, validation free energy -106058.995996
Pre-training layer 1, epoch 71, cost -211.142869141
Pre-training layer 1, epoch 72, cost -211.143517609
Pre-training layer 1, epoch 73, cost -211.034828247
Pre-training layer 1, epoch 74, cost -210.851223602
Pre-training layer 1, epoch 75, cost -210.827538666
Pre-training layer 1, epoch 75, representative training free energy -107639.252668
Pre-training layer 1, epoch 75, validation free energy -106667.076406
Pre-training layer 1, epoch 76, cost -210.771939606
Pre-training layer 1, epoch 77, cost -210.729240417
Pre-training layer 1, epoch 78, cost -210.65039035
Pre-training layer 1, epoch 79, cost -210.566995148
Pre-training layer 1, epoch 80, cost -210.548983704
Pre-training layer 1, epoch 80, representative training free energy -108319.905711
Pre-training layer 1, epoch 80, validation free energy -107342.61243
Pre-training layer 1, epoch 81, cost -210.381258636
Pre-training layer 1, epoch 82, cost -210.44976181
Pre-training layer 1, epoch 83, cost -210.277542877
Pre-training layer 1, epoch 84, cost -210.288200714
Pre-training layer 1, epoch 85, cost -210.195449799
Pre-training layer 1, epoch 85, representative training free energy -108982.115375
Pre-training layer 1, epoch 85, validation free energy -108015.144832
Pre-training layer 1, epoch 86, cost -210.111792877
Pre-training layer 1, epoch 87, cost -210.076688019
Pre-training layer 1, epoch 88, cost -210.073871216
Pre-training layer 1, epoch 89, cost -210.107296997
Pre-training layer 1, epoch 90, cost -209.952140778
Pre-training layer 1, epoch 90, representative training free energy -109488.333781
Pre-training layer 1, epoch 90, validation free energy -108505.811305
Pre-training layer 1, epoch 91, cost -209.905929565
Pre-training layer 1, epoch 92, cost -209.829434631
Pre-training layer 1, epoch 93, cost -209.701807922
Pre-training layer 1, epoch 94, cost -209.7891203
Pre-training layer 1, epoch 95, cost -209.724660187
Pre-training layer 1, epoch 95, representative training free energy -110037.941266
Pre-training layer 1, epoch 95, validation free energy -109051.148469
Pre-training layer 1, epoch 96, cost -209.695649872
Pre-training layer 1, epoch 97, cost -209.663333557
Pre-training layer 1, epoch 98, cost -209.586353119
Pre-training layer 1, epoch 99, cost -209.462566589
Pre-training layer 2, epoch 0, cost -113.038775864
Pre-training layer 2, epoch 0, representative training free energy 3992.89953241
Pre-training layer 2, epoch 0, validation free energy 3985.38009448
Pre-training layer 2, epoch 1, cost -85.250405983
Pre-training layer 2, epoch 2, cost -79.1006218491
Pre-training layer 2, epoch 3, cost -75.5910496216
Pre-training layer 2, epoch 4, cost -73.3751583633
Pre-training layer 2, epoch 5, cost -71.6917825775
Pre-training layer 2, epoch 5, representative training free energy 6262.73431982
Pre-training layer 2, epoch 5, validation free energy 6200.76335144
Pre-training layer 2, epoch 6, cost -70.3611343613
Pre-training layer 2, epoch 7, cost -69.4001772842
Pre-training layer 2, epoch 8, cost -68.4437297134
Pre-training layer 2, epoch 9, cost -67.7644322205
Pre-training layer 2, epoch 10, cost -67.0554230652
Pre-training layer 2, epoch 10, representative training free energy 7628.57873511
Pre-training layer 2, epoch 10, validation free energy 7556.59800879
Pre-training layer 2, epoch 11, cost -66.5663233948
Pre-training layer 2, epoch 12, cost -66.0648242569
Pre-training layer 2, epoch 13, cost -65.6495471344
Pre-training layer 2, epoch 14, cost -65.3595639877
Pre-training layer 2, epoch 15, cost -65.0026723175
Pre-training layer 2, epoch 15, representative training free energy 8559.9339834
Pre-training layer 2, epoch 15, validation free energy 8484.75963428
Pre-training layer 2, epoch 16, cost -64.6227752304
Pre-training layer 2, epoch 17, cost -64.4222542191
Pre-training layer 2, epoch 18, cost -64.1771369781
Pre-training layer 2, epoch 19, cost -63.8621589203
Pre-training layer 2, epoch 20, cost -63.61331073
Pre-training layer 2, epoch 20, representative training free energy 9327.07101538
Pre-training layer 2, epoch 20, validation free energy 9248.31349243
Pre-training layer 2, epoch 21, cost -63.539407547
Pre-training layer 2, epoch 22, cost -63.4007874756
Pre-training layer 2, epoch 23, cost -63.2008627319
Pre-training layer 2, epoch 24, cost -63.0116882095
Pre-training layer 2, epoch 25, cost -62.8874844131
Pre-training layer 2, epoch 25, representative training free energy 9983.79832202
Pre-training layer 2, epoch 25, validation free energy 9899.15381274
Pre-training layer 2, epoch 26, cost -62.7299262238
Pre-training layer 2, epoch 27, cost -62.5942687683
Pre-training layer 2, epoch 28, cost -62.4538944626
Pre-training layer 2, epoch 29, cost -62.3976770477
Pre-training layer 2, epoch 30, cost -62.2399862671
Pre-training layer 2, epoch 30, representative training free energy 10554.0851455
Pre-training layer 2, epoch 30, validation free energy 10465.3331494
Pre-training layer 2, epoch 31, cost -62.144614769
Pre-training layer 2, epoch 32, cost -61.9471910019
Pre-training layer 2, epoch 33, cost -61.949034111
Pre-training layer 2, epoch 34, cost -61.802707222
Pre-training layer 2, epoch 35, cost -61.7336292725
Pre-training layer 2, epoch 35, representative training free energy 11129.3082776
Pre-training layer 2, epoch 35, validation free energy 11036.4974712
Pre-training layer 2, epoch 36, cost -61.6404241791
Pre-training layer 2, epoch 37, cost -61.6822658844
Pre-training layer 2, epoch 38, cost -61.5040196762
Pre-training layer 2, epoch 39, cost -61.4647856674
Pre-training layer 2, epoch 40, cost -61.3392183228
Pre-training layer 2, epoch 40, representative training free energy 11661.4329282
Pre-training layer 2, epoch 40, validation free energy 11564.8253948
Pre-training layer 2, epoch 41, cost -61.2327503204
Pre-training layer 2, epoch 42, cost -61.2187890396
Pre-training layer 2, epoch 43, cost -61.1513380737
Pre-training layer 2, epoch 44, cost -61.0215829163
Pre-training layer 2, epoch 45, cost -61.0323629532
Pre-training layer 2, epoch 45, representative training free energy 12134.1793625
Pre-training layer 2, epoch 45, validation free energy 12033.9770049
Pre-training layer 2, epoch 46, cost -60.9540883102
Pre-training layer 2, epoch 47, cost -61.0085396194
Pre-training layer 2, epoch 48, cost -60.9248591995
Pre-training layer 2, epoch 49, cost -60.8041036224
Pre-training layer 2, epoch 50, cost -60.7913052597
Pre-training layer 2, epoch 50, representative training free energy 12610.8637544
Pre-training layer 2, epoch 50, validation free energy 12506.7891069
Pre-training layer 2, epoch 51, cost -60.7328988571
Pre-training layer 2, epoch 52, cost -60.7063111649
Pre-training layer 2, epoch 53, cost -60.6341001892
Pre-training layer 2, epoch 54, cost -60.5757686157
Pre-training layer 2, epoch 55, cost -60.4941122589
Pre-training layer 2, epoch 55, representative training free energy 13052.6201885
Pre-training layer 2, epoch 55, validation free energy 12946.299248
Pre-training layer 2, epoch 56, cost -60.5203806076
Pre-training layer 2, epoch 57, cost -60.4901770096
Pre-training layer 2, epoch 58, cost -60.4610167847
Pre-training layer 2, epoch 59, cost -60.3714757309
Pre-training layer 2, epoch 60, cost -60.3590602341
Pre-training layer 2, epoch 60, representative training free energy 13453.1096768
Pre-training layer 2, epoch 60, validation free energy 13344.6193262
Pre-training layer 2, epoch 61, cost -60.2826604004
Pre-training layer 2, epoch 62, cost -60.2773857574
Pre-training layer 2, epoch 63, cost -60.1957857742
Pre-training layer 2, epoch 64, cost -60.2457753143
Pre-training layer 2, epoch 65, cost -60.2058911591
Pre-training layer 2, epoch 65, representative training free energy 13855.9025425
Pre-training layer 2, epoch 65, validation free energy 13744.3265337
Pre-training layer 2, epoch 66, cost -60.2501437988
Pre-training layer 2, epoch 67, cost -60.1225070953
Pre-training layer 2, epoch 68, cost -60.0329366226
Pre-training layer 2, epoch 69, cost -60.0219877319
Pre-training layer 2, epoch 70, cost -59.9992442169
Pre-training layer 2, epoch 70, representative training free energy 14243.1852261
Pre-training layer 2, epoch 70, validation free energy 14128.4755659
Pre-training layer 2, epoch 71, cost -59.9307190933
Pre-training layer 2, epoch 72, cost -59.9264365921
Pre-training layer 2, epoch 73, cost -59.9050923386
Pre-training layer 2, epoch 74, cost -59.9201356583
Pre-training layer 2, epoch 75, cost -59.9102934341
Pre-training layer 2, epoch 75, representative training free energy 14619.8137944
Pre-training layer 2, epoch 75, validation free energy 14504.7444507
Pre-training layer 2, epoch 76, cost -59.8798544998
Pre-training layer 2, epoch 77, cost -59.8079151917
Pre-training layer 2, epoch 78, cost -59.7922965851
Pre-training layer 2, epoch 79, cost -59.7300691605
Pre-training layer 2, epoch 80, cost -59.7104316711
Pre-training layer 2, epoch 80, representative training free energy 14948.8890024
Pre-training layer 2, epoch 80, validation free energy 14830.7683784
Pre-training layer 2, epoch 81, cost -59.6783032074
Pre-training layer 2, epoch 82, cost -59.7163120728
Pre-training layer 2, epoch 83, cost -59.7136874695
Pre-training layer 2, epoch 84, cost -59.5725163193
Pre-training layer 2, epoch 85, cost -59.5771093445
Pre-training layer 2, epoch 85, representative training free energy 15251.6975527
Pre-training layer 2, epoch 85, validation free energy 15133.9002861
Pre-training layer 2, epoch 86, cost -59.5955665359
Pre-training layer 2, epoch 87, cost -59.5306649246
Pre-training layer 2, epoch 88, cost -59.4853779755
Pre-training layer 2, epoch 89, cost -59.5329855728
Pre-training layer 2, epoch 90, cost -59.5338646393
Pre-training layer 2, epoch 90, representative training free energy 15533.4133896
Pre-training layer 2, epoch 90, validation free energy 15414.4673926
Pre-training layer 2, epoch 91, cost -59.4753510208
Pre-training layer 2, epoch 92, cost -59.4446347961
Pre-training layer 2, epoch 93, cost -59.4382961502
Pre-training layer 2, epoch 94, cost -59.3728607864
Pre-training layer 2, epoch 95, cost -59.345287674
Pre-training layer 2, epoch 95, representative training free energy 15854.3155288
Pre-training layer 2, epoch 95, validation free energy 15732.4882568
Pre-training layer 2, epoch 96, cost -59.3952200394
Pre-training layer 2, epoch 97, cost -59.3104809647
Pre-training layer 2, epoch 98, cost -59.4294261398
Pre-training layer 2, epoch 99, cost -59.3583066406
The pretraining code for file dbn_loop.pyc ran for 13.02m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 32.800000 %
     epoch 1, minibatch 500/500, test error of best model 28.500000 %
epoch 2, minibatch 500/500, validation error 24.700000 %
     epoch 2, minibatch 500/500, test error of best model 18.300000 %
epoch 3, minibatch 500/500, validation error 21.600000 %
     epoch 3, minibatch 500/500, test error of best model 15.200000 %
epoch 4, minibatch 500/500, validation error 20.200000 %
     epoch 4, minibatch 500/500, test error of best model 12.800000 %
epoch 5, minibatch 500/500, validation error 18.900000 %
     epoch 5, minibatch 500/500, test error of best model 11.700000 %
epoch 6, minibatch 500/500, validation error 18.600000 %
     epoch 6, minibatch 500/500, test error of best model 10.200000 %
epoch 7, minibatch 500/500, validation error 17.600000 %
     epoch 7, minibatch 500/500, test error of best model 9.600000 %
epoch 8, minibatch 500/500, validation error 16.900000 %
     epoch 8, minibatch 500/500, test error of best model 8.800000 %
epoch 9, minibatch 500/500, validation error 16.500000 %
     epoch 9, minibatch 500/500, test error of best model 8.300000 %
epoch 10, minibatch 500/500, validation error 16.000000 %
     epoch 10, minibatch 500/500, test error of best model 7.100000 %
epoch 11, minibatch 500/500, validation error 15.900000 %
     epoch 11, minibatch 500/500, test error of best model 6.700000 %
epoch 12, minibatch 500/500, validation error 15.400000 %
     epoch 12, minibatch 500/500, test error of best model 6.500000 %
epoch 13, minibatch 500/500, validation error 15.400000 %
epoch 14, minibatch 500/500, validation error 15.400000 %
epoch 15, minibatch 500/500, validation error 15.500000 %
epoch 16, minibatch 500/500, validation error 15.500000 %
epoch 17, minibatch 500/500, validation error 15.500000 %
epoch 18, minibatch 500/500, validation error 15.500000 %
epoch 19, minibatch 500/500, validation error 15.400000 %
epoch 20, minibatch 500/500, validation error 15.400000 %
epoch 21, minibatch 500/500, validation error 15.400000 %
epoch 22, minibatch 500/500, validation error 15.300000 %
     epoch 22, minibatch 500/500, test error of best model 5.700000 %
epoch 23, minibatch 500/500, validation error 15.300000 %
epoch 24, minibatch 500/500, validation error 15.400000 %
epoch 25, minibatch 500/500, validation error 15.300000 %
epoch 26, minibatch 500/500, validation error 15.200000 %
     epoch 26, minibatch 500/500, test error of best model 5.500000 %
epoch 27, minibatch 500/500, validation error 15.000000 %
     epoch 27, minibatch 500/500, test error of best model 5.500000 %
epoch 28, minibatch 500/500, validation error 14.900000 %
     epoch 28, minibatch 500/500, test error of best model 5.500000 %
epoch 29, minibatch 500/500, validation error 14.900000 %
epoch 30, minibatch 500/500, validation error 14.800000 %
     epoch 30, minibatch 500/500, test error of best model 5.500000 %
epoch 31, minibatch 500/500, validation error 14.700000 %
     epoch 31, minibatch 500/500, test error of best model 5.700000 %
epoch 32, minibatch 500/500, validation error 14.600000 %
     epoch 32, minibatch 500/500, test error of best model 5.700000 %
epoch 33, minibatch 500/500, validation error 14.600000 %
epoch 34, minibatch 500/500, validation error 14.600000 %
epoch 35, minibatch 500/500, validation error 14.500000 %
     epoch 35, minibatch 500/500, test error of best model 5.700000 %
epoch 36, minibatch 500/500, validation error 14.500000 %
epoch 37, minibatch 500/500, validation error 14.500000 %
epoch 38, minibatch 500/500, validation error 14.500000 %
epoch 39, minibatch 500/500, validation error 14.500000 %
epoch 40, minibatch 500/500, validation error 14.500000 %
epoch 41, minibatch 500/500, validation error 14.300000 %
     epoch 41, minibatch 500/500, test error of best model 5.600000 %
epoch 42, minibatch 500/500, validation error 14.200000 %
     epoch 42, minibatch 500/500, test error of best model 5.500000 %
epoch 43, minibatch 500/500, validation error 14.200000 %
epoch 44, minibatch 500/500, validation error 14.200000 %
epoch 45, minibatch 500/500, validation error 14.200000 %
epoch 46, minibatch 500/500, validation error 14.100000 %
     epoch 46, minibatch 500/500, test error of best model 5.400000 %
epoch 47, minibatch 500/500, validation error 14.100000 %
epoch 48, minibatch 500/500, validation error 14.100000 %
epoch 49, minibatch 500/500, validation error 14.100000 %
epoch 50, minibatch 500/500, validation error 14.100000 %
epoch 51, minibatch 500/500, validation error 14.000000 %
     epoch 51, minibatch 500/500, test error of best model 5.200000 %
epoch 52, minibatch 500/500, validation error 14.000000 %
epoch 53, minibatch 500/500, validation error 14.000000 %
epoch 54, minibatch 500/500, validation error 14.000000 %
epoch 55, minibatch 500/500, validation error 14.000000 %
epoch 56, minibatch 500/500, validation error 14.000000 %
epoch 57, minibatch 500/500, validation error 14.000000 %
epoch 58, minibatch 500/500, validation error 14.000000 %
epoch 59, minibatch 500/500, validation error 14.000000 %
epoch 60, minibatch 500/500, validation error 14.000000 %
epoch 61, minibatch 500/500, validation error 14.000000 %
epoch 62, minibatch 500/500, validation error 13.900000 %
     epoch 62, minibatch 500/500, test error of best model 5.200000 %
epoch 63, minibatch 500/500, validation error 13.800000 %
     epoch 63, minibatch 500/500, test error of best model 5.200000 %
epoch 64, minibatch 500/500, validation error 13.800000 %
epoch 65, minibatch 500/500, validation error 13.800000 %
epoch 66, minibatch 500/500, validation error 13.800000 %
epoch 67, minibatch 500/500, validation error 13.800000 %
epoch 68, minibatch 500/500, validation error 13.800000 %
epoch 69, minibatch 500/500, validation error 13.800000 %
epoch 70, minibatch 500/500, validation error 13.800000 %
epoch 71, minibatch 500/500, validation error 13.800000 %
epoch 72, minibatch 500/500, validation error 13.800000 %
epoch 73, minibatch 500/500, validation error 13.800000 %
epoch 74, minibatch 500/500, validation error 13.800000 %
epoch 75, minibatch 500/500, validation error 13.800000 %
epoch 76, minibatch 500/500, validation error 13.800000 %
epoch 77, minibatch 500/500, validation error 13.800000 %
epoch 78, minibatch 500/500, validation error 13.800000 %
epoch 79, minibatch 500/500, validation error 13.800000 %
epoch 80, minibatch 500/500, validation error 13.800000 %
epoch 81, minibatch 500/500, validation error 13.800000 %
epoch 82, minibatch 500/500, validation error 13.800000 %
epoch 83, minibatch 500/500, validation error 13.800000 %
epoch 84, minibatch 500/500, validation error 13.800000 %
epoch 85, minibatch 500/500, validation error 13.800000 %
epoch 86, minibatch 500/500, validation error 13.800000 %
epoch 87, minibatch 500/500, validation error 13.800000 %
epoch 88, minibatch 500/500, validation error 13.800000 %
epoch 89, minibatch 500/500, validation error 13.800000 %
epoch 90, minibatch 500/500, validation error 13.800000 %
epoch 91, minibatch 500/500, validation error 13.800000 %
epoch 92, minibatch 500/500, validation error 13.800000 %
epoch 93, minibatch 500/500, validation error 13.800000 %
epoch 94, minibatch 500/500, validation error 13.800000 %
epoch 95, minibatch 500/500, validation error 13.800000 %
epoch 96, minibatch 500/500, validation error 13.800000 %
epoch 97, minibatch 500/500, validation error 13.800000 %
epoch 98, minibatch 500/500, validation error 13.800000 %
epoch 99, minibatch 500/500, validation error 13.800000 %
epoch 100, minibatch 500/500, validation error 13.800000 %
epoch 101, minibatch 500/500, validation error 13.800000 %
epoch 102, minibatch 500/500, validation error 13.800000 %
epoch 103, minibatch 500/500, validation error 13.800000 %
epoch 104, minibatch 500/500, validation error 13.800000 %
epoch 105, minibatch 500/500, validation error 13.800000 %
epoch 106, minibatch 500/500, validation error 13.800000 %
epoch 107, minibatch 500/500, validation error 13.800000 %
epoch 108, minibatch 500/500, validation error 13.800000 %
epoch 109, minibatch 500/500, validation error 13.800000 %
epoch 110, minibatch 500/500, validation error 13.800000 %
epoch 111, minibatch 500/500, validation error 13.800000 %
epoch 112, minibatch 500/500, validation error 13.800000 %
epoch 113, minibatch 500/500, validation error 13.800000 %
epoch 114, minibatch 500/500, validation error 13.800000 %
epoch 115, minibatch 500/500, validation error 13.800000 %
epoch 116, minibatch 500/500, validation error 13.800000 %
epoch 117, minibatch 500/500, validation error 13.800000 %
epoch 118, minibatch 500/500, validation error 13.800000 %
epoch 119, minibatch 500/500, validation error 13.800000 %
epoch 120, minibatch 500/500, validation error 13.800000 %
epoch 121, minibatch 500/500, validation error 13.800000 %
epoch 122, minibatch 500/500, validation error 13.800000 %
epoch 123, minibatch 500/500, validation error 13.800000 %
epoch 124, minibatch 500/500, validation error 13.800000 %
epoch 125, minibatch 500/500, validation error 13.800000 %
Optimization complete with best validation score of 13.800000 %, obtained at iteration 31500, with test performance 5.200000 %
The fine tuning code for file dbn_loop.pyc ran for 5.18m
_______RUN: 3

==========Sample: (1000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.726859131
Pre-training layer 0, epoch 0, representative training free energy -597.475411713
Pre-training layer 0, epoch 0, validation free energy -592.978319824
Pre-training layer 0, epoch 1, cost -136.762735977
Pre-training layer 0, epoch 2, cost -124.660535812
Pre-training layer 0, epoch 3, cost -118.315089111
Pre-training layer 0, epoch 4, cost -113.258371429
Pre-training layer 0, epoch 5, cost -109.879232864
Pre-training layer 0, epoch 5, representative training free energy -548.523568207
Pre-training layer 0, epoch 5, validation free energy -538.434399078
Pre-training layer 0, epoch 6, cost -107.04061058
Pre-training layer 0, epoch 7, cost -104.783300934
Pre-training layer 0, epoch 8, cost -102.359064407
Pre-training layer 0, epoch 9, cost -100.957600327
Pre-training layer 0, epoch 10, cost -99.1299171448
Pre-training layer 0, epoch 10, representative training free energy -529.911465332
Pre-training layer 0, epoch 10, validation free energy -518.243012085
Pre-training layer 0, epoch 11, cost -98.1722570038
Pre-training layer 0, epoch 12, cost -96.5545168304
Pre-training layer 0, epoch 13, cost -95.7150649261
Pre-training layer 0, epoch 14, cost -94.7292533112
Pre-training layer 0, epoch 15, cost -93.8123361206
Pre-training layer 0, epoch 15, representative training free energy -516.873422302
Pre-training layer 0, epoch 15, validation free energy -504.414293915
Pre-training layer 0, epoch 16, cost -92.9004715729
Pre-training layer 0, epoch 17, cost -92.3278079987
Pre-training layer 0, epoch 18, cost -91.3297083282
Pre-training layer 0, epoch 19, cost -90.4956526947
Pre-training layer 0, epoch 20, cost -90.3190820313
Pre-training layer 0, epoch 20, representative training free energy -509.516274384
Pre-training layer 0, epoch 20, validation free energy -496.078995422
Pre-training layer 0, epoch 21, cost -89.5428256989
Pre-training layer 0, epoch 22, cost -88.8235674286
Pre-training layer 0, epoch 23, cost -88.2681386566
Pre-training layer 0, epoch 24, cost -87.8900005341
Pre-training layer 0, epoch 25, cost -87.3161035919
Pre-training layer 0, epoch 25, representative training free energy -499.579748199
Pre-training layer 0, epoch 25, validation free energy -486.198899017
Pre-training layer 0, epoch 26, cost -86.7717681885
Pre-training layer 0, epoch 27, cost -86.479526825
Pre-training layer 0, epoch 28, cost -86.2077117157
Pre-training layer 0, epoch 29, cost -85.6000274658
Pre-training layer 0, epoch 30, cost -85.081401825
Pre-training layer 0, epoch 30, representative training free energy -493.495650116
Pre-training layer 0, epoch 30, validation free energy -479.369408844
Pre-training layer 0, epoch 31, cost -85.0601086426
Pre-training layer 0, epoch 32, cost -84.6151966095
Pre-training layer 0, epoch 33, cost -84.1033000183
Pre-training layer 0, epoch 34, cost -84.0562078857
Pre-training layer 0, epoch 35, cost -83.7350444794
Pre-training layer 0, epoch 35, representative training free energy -492.314806366
Pre-training layer 0, epoch 35, validation free energy -477.001019318
Pre-training layer 0, epoch 36, cost -83.288174057
Pre-training layer 0, epoch 37, cost -82.9873925781
Pre-training layer 0, epoch 38, cost -82.9221289062
Pre-training layer 0, epoch 39, cost -82.2378026581
Pre-training layer 0, epoch 40, cost -81.9496316147
Pre-training layer 0, epoch 40, representative training free energy -488.169866089
Pre-training layer 0, epoch 40, validation free energy -473.089311951
Pre-training layer 0, epoch 41, cost -81.9381062698
Pre-training layer 0, epoch 42, cost -81.7867877197
Pre-training layer 0, epoch 43, cost -81.3857738495
Pre-training layer 0, epoch 44, cost -81.2625619888
Pre-training layer 0, epoch 45, cost -81.0812460709
Pre-training layer 0, epoch 45, representative training free energy -485.682023254
Pre-training layer 0, epoch 45, validation free energy -469.807691986
Pre-training layer 0, epoch 46, cost -80.6006116486
Pre-training layer 0, epoch 47, cost -80.551986618
Pre-training layer 0, epoch 48, cost -80.0098638153
Pre-training layer 0, epoch 49, cost -80.0678736115
Pre-training layer 0, epoch 50, cost -80.012542038
Pre-training layer 0, epoch 50, representative training free energy -481.191833557
Pre-training layer 0, epoch 50, validation free energy -464.918377625
Pre-training layer 0, epoch 51, cost -79.8241464233
Pre-training layer 0, epoch 52, cost -79.7681940079
Pre-training layer 0, epoch 53, cost -79.167902832
Pre-training layer 0, epoch 54, cost -79.1292311859
Pre-training layer 0, epoch 55, cost -78.9914742661
Pre-training layer 0, epoch 55, representative training free energy -479.045348541
Pre-training layer 0, epoch 55, validation free energy -462.368226837
Pre-training layer 0, epoch 56, cost -78.9309416962
Pre-training layer 0, epoch 57, cost -78.3870769882
Pre-training layer 0, epoch 58, cost -78.6281934738
Pre-training layer 0, epoch 59, cost -78.4041192245
Pre-training layer 0, epoch 60, cost -78.2179161835
Pre-training layer 0, epoch 60, representative training free energy -475.125434174
Pre-training layer 0, epoch 60, validation free energy -457.702539551
Pre-training layer 0, epoch 61, cost -78.3436725998
Pre-training layer 0, epoch 62, cost -78.1531375122
Pre-training layer 0, epoch 63, cost -78.1066846848
Pre-training layer 0, epoch 64, cost -77.755027771
Pre-training layer 0, epoch 65, cost -77.7234470749
Pre-training layer 0, epoch 65, representative training free energy -477.50861084
Pre-training layer 0, epoch 65, validation free energy -460.172074554
Pre-training layer 0, epoch 66, cost -77.471932373
Pre-training layer 0, epoch 67, cost -77.251553154
Pre-training layer 0, epoch 68, cost -77.3184415817
Pre-training layer 0, epoch 69, cost -77.1605199814
Pre-training layer 0, epoch 70, cost -76.9047880936
Pre-training layer 0, epoch 70, representative training free energy -474.241095306
Pre-training layer 0, epoch 70, validation free energy -456.204839783
Pre-training layer 0, epoch 71, cost -76.9062069702
Pre-training layer 0, epoch 72, cost -76.8054982376
Pre-training layer 0, epoch 73, cost -76.3595459747
Pre-training layer 0, epoch 74, cost -76.4041431427
Pre-training layer 0, epoch 75, cost -76.6392998886
Pre-training layer 0, epoch 75, representative training free energy -471.163159058
Pre-training layer 0, epoch 75, validation free energy -453.523537659
Pre-training layer 0, epoch 76, cost -76.0472835922
Pre-training layer 0, epoch 77, cost -76.4649240112
Pre-training layer 0, epoch 78, cost -76.1695882416
Pre-training layer 0, epoch 79, cost -76.0202894592
Pre-training layer 0, epoch 80, cost -75.9304926682
Pre-training layer 0, epoch 80, representative training free energy -469.433774048
Pre-training layer 0, epoch 80, validation free energy -450.840604523
Pre-training layer 0, epoch 81, cost -75.6375074005
Pre-training layer 0, epoch 82, cost -75.5879079819
Pre-training layer 0, epoch 83, cost -75.3734221268
Pre-training layer 0, epoch 84, cost -75.4639238358
Pre-training layer 0, epoch 85, cost -75.3573460388
Pre-training layer 0, epoch 85, representative training free energy -469.458797028
Pre-training layer 0, epoch 85, validation free energy -450.581252319
Pre-training layer 0, epoch 86, cost -75.3793745804
Pre-training layer 0, epoch 87, cost -75.3257270813
Pre-training layer 0, epoch 88, cost -75.1026037979
Pre-training layer 0, epoch 89, cost -75.2626173401
Pre-training layer 0, epoch 90, cost -74.9815014648
Pre-training layer 0, epoch 90, representative training free energy -470.141450195
Pre-training layer 0, epoch 90, validation free energy -451.394296356
Pre-training layer 0, epoch 91, cost -74.7257077789
Pre-training layer 0, epoch 92, cost -74.6769862747
Pre-training layer 0, epoch 93, cost -74.6199676132
Pre-training layer 0, epoch 94, cost -74.52542099
Pre-training layer 0, epoch 95, cost -74.4213500595
Pre-training layer 0, epoch 95, representative training free energy -468.14552301
Pre-training layer 0, epoch 95, validation free energy -449.105664215
Pre-training layer 0, epoch 96, cost -74.4862530136
Pre-training layer 0, epoch 97, cost -74.5762252426
Pre-training layer 0, epoch 98, cost -74.2735214996
Pre-training layer 0, epoch 99, cost -74.2419328308
Pre-training layer 1, epoch 0, cost -430.479797058
Pre-training layer 1, epoch 0, representative training free energy -32955.8714541
Pre-training layer 1, epoch 0, validation free energy -32370.7670107
Pre-training layer 1, epoch 1, cost -369.580265503
Pre-training layer 1, epoch 2, cost -350.222637634
Pre-training layer 1, epoch 3, cost -338.869161987
Pre-training layer 1, epoch 4, cost -330.400982056
Pre-training layer 1, epoch 5, cost -324.017860107
Pre-training layer 1, epoch 5, representative training free energy -46840.9762988
Pre-training layer 1, epoch 5, validation free energy -46089.8750596
Pre-training layer 1, epoch 6, cost -319.179771423
Pre-training layer 1, epoch 7, cost -314.868426819
Pre-training layer 1, epoch 8, cost -311.393948669
Pre-training layer 1, epoch 9, cost -308.729611816
Pre-training layer 1, epoch 10, cost -305.777311707
Pre-training layer 1, epoch 10, representative training free energy -51257.2362119
Pre-training layer 1, epoch 10, validation free energy -50476.5251709
Pre-training layer 1, epoch 11, cost -303.528515625
Pre-training layer 1, epoch 12, cost -301.276567383
Pre-training layer 1, epoch 13, cost -299.481732941
Pre-training layer 1, epoch 14, cost -297.778059235
Pre-training layer 1, epoch 15, cost -296.517217865
Pre-training layer 1, epoch 15, representative training free energy -53748.1840479
Pre-training layer 1, epoch 15, validation free energy -52961.4570771
Pre-training layer 1, epoch 16, cost -295.025747681
Pre-training layer 1, epoch 17, cost -293.659061737
Pre-training layer 1, epoch 18, cost -292.582204895
Pre-training layer 1, epoch 19, cost -291.330848083
Pre-training layer 1, epoch 20, cost -290.296959839
Pre-training layer 1, epoch 20, representative training free energy -55372.9164775
Pre-training layer 1, epoch 20, validation free energy -54575.8311182
Pre-training layer 1, epoch 21, cost -289.477959137
Pre-training layer 1, epoch 22, cost -288.594178162
Pre-training layer 1, epoch 23, cost -287.520071411
Pre-training layer 1, epoch 24, cost -286.895574799
Pre-training layer 1, epoch 25, cost -286.190560455
Pre-training layer 1, epoch 25, representative training free energy -56723.9354688
Pre-training layer 1, epoch 25, validation free energy -55920.8942852
Pre-training layer 1, epoch 26, cost -285.408575287
Pre-training layer 1, epoch 27, cost -284.725528564
Pre-training layer 1, epoch 28, cost -283.927370605
Pre-training layer 1, epoch 29, cost -283.447385712
Pre-training layer 1, epoch 30, cost -282.928228302
Pre-training layer 1, epoch 30, representative training free energy -57883.393623
Pre-training layer 1, epoch 30, validation free energy -57074.0196484
Pre-training layer 1, epoch 31, cost -282.474807587
Pre-training layer 1, epoch 32, cost -281.848149567
Pre-training layer 1, epoch 33, cost -281.187060089
Pre-training layer 1, epoch 34, cost -280.740161743
Pre-training layer 1, epoch 35, cost -280.338096008
Pre-training layer 1, epoch 35, representative training free energy -58759.8687383
Pre-training layer 1, epoch 35, validation free energy -57949.4417891
Pre-training layer 1, epoch 36, cost -280.000788116
Pre-training layer 1, epoch 37, cost -279.732088013
Pre-training layer 1, epoch 38, cost -279.103456879
Pre-training layer 1, epoch 39, cost -278.768515625
Pre-training layer 1, epoch 40, cost -278.559992828
Pre-training layer 1, epoch 40, representative training free energy -59640.1998799
Pre-training layer 1, epoch 40, validation free energy -58826.538832
Pre-training layer 1, epoch 41, cost -278.018957977
Pre-training layer 1, epoch 42, cost -277.735797272
Pre-training layer 1, epoch 43, cost -277.474694366
Pre-training layer 1, epoch 44, cost -277.0613237
Pre-training layer 1, epoch 45, cost -276.760793304
Pre-training layer 1, epoch 45, representative training free energy -60243.8385693
Pre-training layer 1, epoch 45, validation free energy -59425.2931289
Pre-training layer 1, epoch 46, cost -276.433246918
Pre-training layer 1, epoch 47, cost -276.045449829
Pre-training layer 1, epoch 48, cost -275.889747925
Pre-training layer 1, epoch 49, cost -275.601022491
Pre-training layer 1, epoch 50, cost -275.309713287
Pre-training layer 1, epoch 50, representative training free energy -60893.0673076
Pre-training layer 1, epoch 50, validation free energy -60067.5654687
Pre-training layer 1, epoch 51, cost -275.174186096
Pre-training layer 1, epoch 52, cost -274.731809845
Pre-training layer 1, epoch 53, cost -274.473778381
Pre-training layer 1, epoch 54, cost -274.418484497
Pre-training layer 1, epoch 55, cost -274.198298492
Pre-training layer 1, epoch 55, representative training free energy -61474.7128262
Pre-training layer 1, epoch 55, validation free energy -60653.6935625
Pre-training layer 1, epoch 56, cost -273.83993927
Pre-training layer 1, epoch 57, cost -273.86754425
Pre-training layer 1, epoch 58, cost -273.563757782
Pre-training layer 1, epoch 59, cost -273.238770905
Pre-training layer 1, epoch 60, cost -273.286739044
Pre-training layer 1, epoch 60, representative training free energy -62043.6303965
Pre-training layer 1, epoch 60, validation free energy -61202.9630781
Pre-training layer 1, epoch 61, cost -272.895254669
Pre-training layer 1, epoch 62, cost -272.98820282
Pre-training layer 1, epoch 63, cost -272.459607239
Pre-training layer 1, epoch 64, cost -272.486428223
Pre-training layer 1, epoch 65, cost -272.08849411
Pre-training layer 1, epoch 65, representative training free energy -62404.3952422
Pre-training layer 1, epoch 65, validation free energy -61573.1280391
Pre-training layer 1, epoch 66, cost -271.886437531
Pre-training layer 1, epoch 67, cost -271.815043488
Pre-training layer 1, epoch 68, cost -271.638704529
Pre-training layer 1, epoch 69, cost -271.532758942
Pre-training layer 1, epoch 70, cost -271.259677887
Pre-training layer 1, epoch 70, representative training free energy -62878.9538281
Pre-training layer 1, epoch 70, validation free energy -62038.7567031
Pre-training layer 1, epoch 71, cost -271.289538269
Pre-training layer 1, epoch 72, cost -271.157778473
Pre-training layer 1, epoch 73, cost -270.999697266
Pre-training layer 1, epoch 74, cost -270.937085114
Pre-training layer 1, epoch 75, cost -270.534788666
Pre-training layer 1, epoch 75, representative training free energy -63338.2546016
Pre-training layer 1, epoch 75, validation free energy -62491.764002
Pre-training layer 1, epoch 76, cost -270.651050262
Pre-training layer 1, epoch 77, cost -270.406359863
Pre-training layer 1, epoch 78, cost -270.217817841
Pre-training layer 1, epoch 79, cost -270.154494934
Pre-training layer 1, epoch 80, cost -269.883981018
Pre-training layer 1, epoch 80, representative training free energy -63645.3231523
Pre-training layer 1, epoch 80, validation free energy -62795.9585508
Pre-training layer 1, epoch 81, cost -269.908898163
Pre-training layer 1, epoch 82, cost -269.806760864
Pre-training layer 1, epoch 83, cost -269.465824585
Pre-training layer 1, epoch 84, cost -269.637581635
Pre-training layer 1, epoch 85, cost -269.295437622
Pre-training layer 1, epoch 85, representative training free energy -63999.8845137
Pre-training layer 1, epoch 85, validation free energy -63148.0448672
Pre-training layer 1, epoch 86, cost -269.281902161
Pre-training layer 1, epoch 87, cost -269.166319733
Pre-training layer 1, epoch 88, cost -269.132002411
Pre-training layer 1, epoch 89, cost -269.008162537
Pre-training layer 1, epoch 90, cost -268.981704865
Pre-training layer 1, epoch 90, representative training free energy -64403.5158496
Pre-training layer 1, epoch 90, validation free energy -63542.079832
Pre-training layer 1, epoch 91, cost -268.629793549
Pre-training layer 1, epoch 92, cost -268.625119324
Pre-training layer 1, epoch 93, cost -268.719107971
Pre-training layer 1, epoch 94, cost -268.576986847
Pre-training layer 1, epoch 95, cost -268.527580414
Pre-training layer 1, epoch 95, representative training free energy -64718.3273379
Pre-training layer 1, epoch 95, validation free energy -63864.1503047
Pre-training layer 1, epoch 96, cost -268.503320618
Pre-training layer 1, epoch 97, cost -268.320583038
Pre-training layer 1, epoch 98, cost -268.005484619
Pre-training layer 1, epoch 99, cost -268.071721497
Pre-training layer 2, epoch 0, cost -162.538731689
Pre-training layer 2, epoch 0, representative training free energy 1758.63605438
Pre-training layer 2, epoch 0, validation free energy 1745.37605597
Pre-training layer 2, epoch 1, cost -108.988290558
Pre-training layer 2, epoch 2, cost -98.2452108002
Pre-training layer 2, epoch 3, cost -92.7757434082
Pre-training layer 2, epoch 4, cost -89.2353303528
Pre-training layer 2, epoch 5, cost -86.1092510986
Pre-training layer 2, epoch 5, representative training free energy 2656.78814581
Pre-training layer 2, epoch 5, validation free energy 2620.38925049
Pre-training layer 2, epoch 6, cost -83.9822278976
Pre-training layer 2, epoch 7, cost -82.3183219528
Pre-training layer 2, epoch 8, cost -80.9637121582
Pre-training layer 2, epoch 9, cost -79.5753491592
Pre-training layer 2, epoch 10, cost -78.5545101929
Pre-training layer 2, epoch 10, representative training free energy 3093.05274341
Pre-training layer 2, epoch 10, validation free energy 3041.24780054
Pre-training layer 2, epoch 11, cost -77.3853817749
Pre-training layer 2, epoch 12, cost -76.5920844269
Pre-training layer 2, epoch 13, cost -76.0696554947
Pre-training layer 2, epoch 14, cost -75.1992908859
Pre-training layer 2, epoch 15, cost -74.9384643173
Pre-training layer 2, epoch 15, representative training free energy 3408.2813573
Pre-training layer 2, epoch 15, validation free energy 3350.619159
Pre-training layer 2, epoch 16, cost -73.9689412308
Pre-training layer 2, epoch 17, cost -73.5400242615
Pre-training layer 2, epoch 18, cost -72.9451799393
Pre-training layer 2, epoch 19, cost -72.2961358261
Pre-training layer 2, epoch 20, cost -72.2445524216
Pre-training layer 2, epoch 20, representative training free energy 3678.41678986
Pre-training layer 2, epoch 20, validation free energy 3615.35817725
Pre-training layer 2, epoch 21, cost -71.7278644562
Pre-training layer 2, epoch 22, cost -71.2621967697
Pre-training layer 2, epoch 23, cost -71.0634118271
Pre-training layer 2, epoch 24, cost -70.6965591812
Pre-training layer 2, epoch 25, cost -70.4265282059
Pre-training layer 2, epoch 25, representative training free energy 3919.97008423
Pre-training layer 2, epoch 25, validation free energy 3854.20804431
Pre-training layer 2, epoch 26, cost -70.1306296921
Pre-training layer 2, epoch 27, cost -70.0852436066
Pre-training layer 2, epoch 28, cost -69.6860638428
Pre-training layer 2, epoch 29, cost -69.1918167877
Pre-training layer 2, epoch 30, cost -69.154538269
Pre-training layer 2, epoch 30, representative training free energy 4126.8918241
Pre-training layer 2, epoch 30, validation free energy 4058.41085254
Pre-training layer 2, epoch 31, cost -68.9452511597
Pre-training layer 2, epoch 32, cost -68.6151689529
Pre-training layer 2, epoch 33, cost -68.4510454559
Pre-training layer 2, epoch 34, cost -68.3734134674
Pre-training layer 2, epoch 35, cost -68.1247532272
Pre-training layer 2, epoch 35, representative training free energy 4311.35594849
Pre-training layer 2, epoch 35, validation free energy 4240.49140137
Pre-training layer 2, epoch 36, cost -67.970027771
Pre-training layer 2, epoch 37, cost -67.7299213791
Pre-training layer 2, epoch 38, cost -67.460350914
Pre-training layer 2, epoch 39, cost -67.3851172638
Pre-training layer 2, epoch 40, cost -67.3412069321
Pre-training layer 2, epoch 40, representative training free energy 4469.64473218
Pre-training layer 2, epoch 40, validation free energy 4396.47672168
Pre-training layer 2, epoch 41, cost -66.9574602509
Pre-training layer 2, epoch 42, cost -67.0065731812
Pre-training layer 2, epoch 43, cost -66.9335327911
Pre-training layer 2, epoch 44, cost -66.7030916595
Pre-training layer 2, epoch 45, cost -66.5588448334
Pre-training layer 2, epoch 45, representative training free energy 4627.51755273
Pre-training layer 2, epoch 45, validation free energy 4553.03838867
Pre-training layer 2, epoch 46, cost -66.4476185608
Pre-training layer 2, epoch 47, cost -66.4809279251
Pre-training layer 2, epoch 48, cost -66.3290071487
Pre-training layer 2, epoch 49, cost -66.1391676712
Pre-training layer 2, epoch 50, cost -66.0513103485
Pre-training layer 2, epoch 50, representative training free energy 4761.76284802
Pre-training layer 2, epoch 50, validation free energy 4685.29872864
Pre-training layer 2, epoch 51, cost -66.0320750809
Pre-training layer 2, epoch 52, cost -65.7237973022
Pre-training layer 2, epoch 53, cost -65.7352386093
Pre-training layer 2, epoch 54, cost -65.6672149277
Pre-training layer 2, epoch 55, cost -65.4709580994
Pre-training layer 2, epoch 55, representative training free energy 4901.77440198
Pre-training layer 2, epoch 55, validation free energy 4822.9469231
Pre-training layer 2, epoch 56, cost -65.6137357712
Pre-training layer 2, epoch 57, cost -65.4310294724
Pre-training layer 2, epoch 58, cost -65.3043608856
Pre-training layer 2, epoch 59, cost -65.2623947144
Pre-training layer 2, epoch 60, cost -65.0392950058
Pre-training layer 2, epoch 60, representative training free energy 5014.46717236
Pre-training layer 2, epoch 60, validation free energy 4934.00432153
Pre-training layer 2, epoch 61, cost -65.0274512863
Pre-training layer 2, epoch 62, cost -65.0102384567
Pre-training layer 2, epoch 63, cost -64.7827182388
Pre-training layer 2, epoch 64, cost -64.8285873413
Pre-training layer 2, epoch 65, cost -64.7415808868
Pre-training layer 2, epoch 65, representative training free energy 5136.71204211
Pre-training layer 2, epoch 65, validation free energy 5053.66910803
Pre-training layer 2, epoch 66, cost -64.5919435501
Pre-training layer 2, epoch 67, cost -64.4857600784
Pre-training layer 2, epoch 68, cost -64.535858078
Pre-training layer 2, epoch 69, cost -64.5539935684
Pre-training layer 2, epoch 70, cost -64.4316988754
Pre-training layer 2, epoch 70, representative training free energy 5267.26442468
Pre-training layer 2, epoch 70, validation free energy 5181.27459827
Pre-training layer 2, epoch 71, cost -64.3623560333
Pre-training layer 2, epoch 72, cost -64.2271761322
Pre-training layer 2, epoch 73, cost -64.246708107
Pre-training layer 2, epoch 74, cost -64.1595990372
Pre-training layer 2, epoch 75, cost -64.2287157822
Pre-training layer 2, epoch 75, representative training free energy 5371.50998718
Pre-training layer 2, epoch 75, validation free energy 5283.885521
Pre-training layer 2, epoch 76, cost -64.0517599487
Pre-training layer 2, epoch 77, cost -64.0720418549
Pre-training layer 2, epoch 78, cost -63.9488375854
Pre-training layer 2, epoch 79, cost -64.0649419785
Pre-training layer 2, epoch 80, cost -64.0948451233
Pre-training layer 2, epoch 80, representative training free energy 5493.06345154
Pre-training layer 2, epoch 80, validation free energy 5402.26812927
Pre-training layer 2, epoch 81, cost -63.8939477158
Pre-training layer 2, epoch 82, cost -63.6987422562
Pre-training layer 2, epoch 83, cost -63.6648991776
Pre-training layer 2, epoch 84, cost -63.8226040268
Pre-training layer 2, epoch 85, cost -63.5025666046
Pre-training layer 2, epoch 85, representative training free energy 5581.20638464
Pre-training layer 2, epoch 85, validation free energy 5488.4704834
Pre-training layer 2, epoch 86, cost -63.6404104996
Pre-training layer 2, epoch 87, cost -63.5023537827
Pre-training layer 2, epoch 88, cost -63.4394231415
Pre-training layer 2, epoch 89, cost -63.5327059937
Pre-training layer 2, epoch 90, cost -63.5344376373
Pre-training layer 2, epoch 90, representative training free energy 5685.21053015
Pre-training layer 2, epoch 90, validation free energy 5590.61038318
Pre-training layer 2, epoch 91, cost -63.4977444077
Pre-training layer 2, epoch 92, cost -63.3891451263
Pre-training layer 2, epoch 93, cost -63.1526123047
Pre-training layer 2, epoch 94, cost -63.3200457382
Pre-training layer 2, epoch 95, cost -63.2122741699
Pre-training layer 2, epoch 95, representative training free energy 5760.20248914
Pre-training layer 2, epoch 95, validation free energy 5664.10437878
Pre-training layer 2, epoch 96, cost -63.1454246521
Pre-training layer 2, epoch 97, cost -63.1611437607
Pre-training layer 2, epoch 98, cost -63.1420107651
Pre-training layer 2, epoch 99, cost -62.9653698349
The pretraining code for file dbn_loop.pyc ran for 2.74m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 37.800000 %
     epoch 1, minibatch 100/100, test error of best model 28.800000 %
epoch 2, minibatch 100/100, validation error 33.500000 %
     epoch 2, minibatch 100/100, test error of best model 20.700000 %
epoch 3, minibatch 100/100, validation error 30.800000 %
     epoch 3, minibatch 100/100, test error of best model 17.500000 %
epoch 4, minibatch 100/100, validation error 29.600000 %
     epoch 4, minibatch 100/100, test error of best model 16.300000 %
epoch 5, minibatch 100/100, validation error 28.200000 %
     epoch 5, minibatch 100/100, test error of best model 15.000000 %
epoch 6, minibatch 100/100, validation error 28.100000 %
     epoch 6, minibatch 100/100, test error of best model 14.500000 %
epoch 7, minibatch 100/100, validation error 27.500000 %
     epoch 7, minibatch 100/100, test error of best model 14.700000 %
epoch 8, minibatch 100/100, validation error 26.900000 %
     epoch 8, minibatch 100/100, test error of best model 14.500000 %
epoch 9, minibatch 100/100, validation error 26.800000 %
     epoch 9, minibatch 100/100, test error of best model 13.600000 %
epoch 10, minibatch 100/100, validation error 26.800000 %
epoch 11, minibatch 100/100, validation error 26.300000 %
     epoch 11, minibatch 100/100, test error of best model 12.500000 %
epoch 12, minibatch 100/100, validation error 26.100000 %
     epoch 12, minibatch 100/100, test error of best model 12.500000 %
epoch 13, minibatch 100/100, validation error 25.800000 %
     epoch 13, minibatch 100/100, test error of best model 12.200000 %
epoch 14, minibatch 100/100, validation error 25.400000 %
     epoch 14, minibatch 100/100, test error of best model 12.200000 %
epoch 15, minibatch 100/100, validation error 25.400000 %
epoch 16, minibatch 100/100, validation error 25.300000 %
     epoch 16, minibatch 100/100, test error of best model 12.200000 %
epoch 17, minibatch 100/100, validation error 25.300000 %
epoch 18, minibatch 100/100, validation error 25.400000 %
epoch 19, minibatch 100/100, validation error 25.300000 %
epoch 20, minibatch 100/100, validation error 25.500000 %
epoch 21, minibatch 100/100, validation error 25.200000 %
     epoch 21, minibatch 100/100, test error of best model 12.300000 %
epoch 22, minibatch 100/100, validation error 25.100000 %
     epoch 22, minibatch 100/100, test error of best model 12.300000 %
epoch 23, minibatch 100/100, validation error 25.000000 %
     epoch 23, minibatch 100/100, test error of best model 12.300000 %
epoch 24, minibatch 100/100, validation error 25.000000 %
epoch 25, minibatch 100/100, validation error 25.100000 %
epoch 26, minibatch 100/100, validation error 25.100000 %
epoch 27, minibatch 100/100, validation error 25.000000 %
Optimization complete with best validation score of 25.000000 %, obtained at iteration 2300, with test performance 12.300000 %
The fine tuning code for file dbn_loop.pyc ran for 0.35m


==========Sample: (2000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.211934509
Pre-training layer 0, epoch 0, representative training free energy -581.532345825
Pre-training layer 0, epoch 0, validation free energy -579.896492432
Pre-training layer 0, epoch 1, cost -123.664670372
Pre-training layer 0, epoch 2, cost -114.262186775
Pre-training layer 0, epoch 3, cost -108.356770172
Pre-training layer 0, epoch 4, cost -104.165138664
Pre-training layer 0, epoch 5, cost -101.357310715
Pre-training layer 0, epoch 5, representative training free energy -527.08039386
Pre-training layer 0, epoch 5, validation free energy -520.126835999
Pre-training layer 0, epoch 6, cost -99.0556411362
Pre-training layer 0, epoch 7, cost -97.2146054459
Pre-training layer 0, epoch 8, cost -95.3473817825
Pre-training layer 0, epoch 9, cost -93.8752321243
Pre-training layer 0, epoch 10, cost -92.7200569153
Pre-training layer 0, epoch 10, representative training free energy -504.377433197
Pre-training layer 0, epoch 10, validation free energy -496.540073151
Pre-training layer 0, epoch 11, cost -91.4951912308
Pre-training layer 0, epoch 12, cost -90.5609013748
Pre-training layer 0, epoch 13, cost -89.7910161972
Pre-training layer 0, epoch 14, cost -88.9699975586
Pre-training layer 0, epoch 15, cost -87.9025335693
Pre-training layer 0, epoch 15, representative training free energy -497.159354767
Pre-training layer 0, epoch 15, validation free energy -487.88770755
Pre-training layer 0, epoch 16, cost -87.805284462
Pre-training layer 0, epoch 17, cost -86.8364151764
Pre-training layer 0, epoch 18, cost -86.3897581482
Pre-training layer 0, epoch 19, cost -85.8184248734
Pre-training layer 0, epoch 20, cost -85.6212913895
Pre-training layer 0, epoch 20, representative training free energy -484.237228027
Pre-training layer 0, epoch 20, validation free energy -474.498815277
Pre-training layer 0, epoch 21, cost -84.8420690536
Pre-training layer 0, epoch 22, cost -84.6012099838
Pre-training layer 0, epoch 23, cost -83.9528828049
Pre-training layer 0, epoch 24, cost -83.9919592285
Pre-training layer 0, epoch 25, cost -83.2826214218
Pre-training layer 0, epoch 25, representative training free energy -478.613692993
Pre-training layer 0, epoch 25, validation free energy -468.812488525
Pre-training layer 0, epoch 26, cost -83.1723859024
Pre-training layer 0, epoch 27, cost -82.7790732956
Pre-training layer 0, epoch 28, cost -82.4298134041
Pre-training layer 0, epoch 29, cost -82.1309422684
Pre-training layer 0, epoch 30, cost -81.9306018066
Pre-training layer 0, epoch 30, representative training free energy -471.980716064
Pre-training layer 0, epoch 30, validation free energy -462.086214325
Pre-training layer 0, epoch 31, cost -81.821436882
Pre-training layer 0, epoch 32, cost -81.3918873215
Pre-training layer 0, epoch 33, cost -81.1525105476
Pre-training layer 0, epoch 34, cost -80.8159627342
Pre-training layer 0, epoch 35, cost -80.5102092171
Pre-training layer 0, epoch 35, representative training free energy -470.07729834
Pre-training layer 0, epoch 35, validation free energy -458.679255035
Pre-training layer 0, epoch 36, cost -80.5350035667
Pre-training layer 0, epoch 37, cost -80.2824369431
Pre-training layer 0, epoch 38, cost -79.9120012474
Pre-training layer 0, epoch 39, cost -79.6786672974
Pre-training layer 0, epoch 40, cost -79.5221829796
Pre-training layer 0, epoch 40, representative training free energy -465.355833344
Pre-training layer 0, epoch 40, validation free energy -454.487245392
Pre-training layer 0, epoch 41, cost -79.2938156891
Pre-training layer 0, epoch 42, cost -79.2546628761
Pre-training layer 0, epoch 43, cost -78.9556493187
Pre-training layer 0, epoch 44, cost -78.9319005203
Pre-training layer 0, epoch 45, cost -78.8435246086
Pre-training layer 0, epoch 45, representative training free energy -466.795953979
Pre-training layer 0, epoch 45, validation free energy -455.386143982
Pre-training layer 0, epoch 46, cost -78.6727716637
Pre-training layer 0, epoch 47, cost -78.3547723579
Pre-training layer 0, epoch 48, cost -78.128896122
Pre-training layer 0, epoch 49, cost -78.1461779594
Pre-training layer 0, epoch 50, cost -77.7728160095
Pre-training layer 0, epoch 50, representative training free energy -463.621643616
Pre-training layer 0, epoch 50, validation free energy -451.322246979
Pre-training layer 0, epoch 51, cost -77.841774559
Pre-training layer 0, epoch 52, cost -77.8218663025
Pre-training layer 0, epoch 53, cost -77.6085326576
Pre-training layer 0, epoch 54, cost -77.4945289612
Pre-training layer 0, epoch 55, cost -77.2792519379
Pre-training layer 0, epoch 55, representative training free energy -456.455586029
Pre-training layer 0, epoch 55, validation free energy -444.111291595
Pre-training layer 0, epoch 56, cost -77.228850174
Pre-training layer 0, epoch 57, cost -77.0390789032
Pre-training layer 0, epoch 58, cost -76.9759679794
Pre-training layer 0, epoch 59, cost -76.8954601288
Pre-training layer 0, epoch 60, cost -76.6542793846
Pre-training layer 0, epoch 60, representative training free energy -458.673403076
Pre-training layer 0, epoch 60, validation free energy -446.788997314
Pre-training layer 0, epoch 61, cost -76.5050536346
Pre-training layer 0, epoch 62, cost -76.4494824982
Pre-training layer 0, epoch 63, cost -76.3955538177
Pre-training layer 0, epoch 64, cost -76.329691658
Pre-training layer 0, epoch 65, cost -76.268237896
Pre-training layer 0, epoch 65, representative training free energy -459.369962097
Pre-training layer 0, epoch 65, validation free energy -446.716593628
Pre-training layer 0, epoch 66, cost -76.1220708084
Pre-training layer 0, epoch 67, cost -76.1259606552
Pre-training layer 0, epoch 68, cost -75.7890464211
Pre-training layer 0, epoch 69, cost -75.8623612595
Pre-training layer 0, epoch 70, cost -75.7573764801
Pre-training layer 0, epoch 70, representative training free energy -456.527181793
Pre-training layer 0, epoch 70, validation free energy -443.328875793
Pre-training layer 0, epoch 71, cost -75.5574477959
Pre-training layer 0, epoch 72, cost -75.4706303978
Pre-training layer 0, epoch 73, cost -75.352999382
Pre-training layer 0, epoch 74, cost -75.3126969528
Pre-training layer 0, epoch 75, cost -75.4248756027
Pre-training layer 0, epoch 75, representative training free energy -457.904082794
Pre-training layer 0, epoch 75, validation free energy -445.692499542
Pre-training layer 0, epoch 76, cost -75.0836282158
Pre-training layer 0, epoch 77, cost -74.9744176674
Pre-training layer 0, epoch 78, cost -75.0317347908
Pre-training layer 0, epoch 79, cost -74.8834575081
Pre-training layer 0, epoch 80, cost -74.8057026863
Pre-training layer 0, epoch 80, representative training free energy -453.493272003
Pre-training layer 0, epoch 80, validation free energy -439.880720398
Pre-training layer 0, epoch 81, cost -74.8433304214
Pre-training layer 0, epoch 82, cost -74.8366294861
Pre-training layer 0, epoch 83, cost -74.6907612801
Pre-training layer 0, epoch 84, cost -74.6160649681
Pre-training layer 0, epoch 85, cost -74.4775709343
Pre-training layer 0, epoch 85, representative training free energy -455.632966614
Pre-training layer 0, epoch 85, validation free energy -442.224685791
Pre-training layer 0, epoch 86, cost -74.5084375
Pre-training layer 0, epoch 87, cost -74.3596026611
Pre-training layer 0, epoch 88, cost -74.2777236748
Pre-training layer 0, epoch 89, cost -74.2501361275
Pre-training layer 0, epoch 90, cost -74.2472092247
Pre-training layer 0, epoch 90, representative training free energy -453.6070896
Pre-training layer 0, epoch 90, validation free energy -440.36547995
Pre-training layer 0, epoch 91, cost -74.185688324
Pre-training layer 0, epoch 92, cost -74.0690460396
Pre-training layer 0, epoch 93, cost -73.9809760094
Pre-training layer 0, epoch 94, cost -73.875258522
Pre-training layer 0, epoch 95, cost -73.8947234154
Pre-training layer 0, epoch 95, representative training free energy -452.696629578
Pre-training layer 0, epoch 95, validation free energy -438.790295471
Pre-training layer 0, epoch 96, cost -73.7671497917
Pre-training layer 0, epoch 97, cost -73.7275035858
Pre-training layer 0, epoch 98, cost -73.619250412
Pre-training layer 0, epoch 99, cost -73.7153588676
Pre-training layer 1, epoch 0, cost -375.44108017
Pre-training layer 1, epoch 0, representative training free energy -42614.8378145
Pre-training layer 1, epoch 0, validation free energy -42375.0958213
Pre-training layer 1, epoch 1, cost -322.801259384
Pre-training layer 1, epoch 2, cost -306.583297729
Pre-training layer 1, epoch 3, cost -296.650014954
Pre-training layer 1, epoch 4, cost -289.67720787
Pre-training layer 1, epoch 5, cost -284.237411575
Pre-training layer 1, epoch 5, representative training free energy -58564.1618359
Pre-training layer 1, epoch 5, validation free energy -58165.6556055
Pre-training layer 1, epoch 6, cost -280.225335617
Pre-training layer 1, epoch 7, cost -276.968246078
Pre-training layer 1, epoch 8, cost -274.11778038
Pre-training layer 1, epoch 9, cost -271.812470245
Pre-training layer 1, epoch 10, cost -269.676657715
Pre-training layer 1, epoch 10, representative training free energy -63168.7585723
Pre-training layer 1, epoch 10, validation free energy -62755.9947988
Pre-training layer 1, epoch 11, cost -267.763654327
Pre-training layer 1, epoch 12, cost -266.105347061
Pre-training layer 1, epoch 13, cost -264.73145607
Pre-training layer 1, epoch 14, cost -263.406257553
Pre-training layer 1, epoch 15, cost -261.946338348
Pre-training layer 1, epoch 15, representative training free energy -65957.1400664
Pre-training layer 1, epoch 15, validation free energy -65525.3831367
Pre-training layer 1, epoch 16, cost -261.191667786
Pre-training layer 1, epoch 17, cost -260.119245453
Pre-training layer 1, epoch 18, cost -259.258492279
Pre-training layer 1, epoch 19, cost -258.386656189
Pre-training layer 1, epoch 20, cost -257.62434906
Pre-training layer 1, epoch 20, representative training free energy -67875.8963906
Pre-training layer 1, epoch 20, validation free energy -67437.135873
Pre-training layer 1, epoch 21, cost -256.96472641
Pre-training layer 1, epoch 22, cost -256.265440598
Pre-training layer 1, epoch 23, cost -255.627248993
Pre-training layer 1, epoch 24, cost -255.062362213
Pre-training layer 1, epoch 25, cost -254.504655075
Pre-training layer 1, epoch 25, representative training free energy -69431.4553047
Pre-training layer 1, epoch 25, validation free energy -68983.5656992
Pre-training layer 1, epoch 26, cost -254.050761719
Pre-training layer 1, epoch 27, cost -253.534068604
Pre-training layer 1, epoch 28, cost -253.032675323
Pre-training layer 1, epoch 29, cost -252.776824112
Pre-training layer 1, epoch 30, cost -252.271975174
Pre-training layer 1, epoch 30, representative training free energy -70721.1160566
Pre-training layer 1, epoch 30, validation free energy -70264.151543
Pre-training layer 1, epoch 31, cost -251.994209518
Pre-training layer 1, epoch 32, cost -251.534635162
Pre-training layer 1, epoch 33, cost -251.273843079
Pre-training layer 1, epoch 34, cost -250.888101425
Pre-training layer 1, epoch 35, cost -250.680132065
Pre-training layer 1, epoch 35, representative training free energy -71638.5197969
Pre-training layer 1, epoch 35, validation free energy -71182.3974648
Pre-training layer 1, epoch 36, cost -250.272503662
Pre-training layer 1, epoch 37, cost -250.004541321
Pre-training layer 1, epoch 38, cost -249.636522446
Pre-training layer 1, epoch 39, cost -249.493346024
Pre-training layer 1, epoch 40, cost -249.337185745
Pre-training layer 1, epoch 40, representative training free energy -72584.4375586
Pre-training layer 1, epoch 40, validation free energy -72120.8431738
Pre-training layer 1, epoch 41, cost -249.075152283
Pre-training layer 1, epoch 42, cost -248.737709274
Pre-training layer 1, epoch 43, cost -248.394494019
Pre-training layer 1, epoch 44, cost -248.097360611
Pre-training layer 1, epoch 45, cost -248.094354019
Pre-training layer 1, epoch 45, representative training free energy -73372.1327559
Pre-training layer 1, epoch 45, validation free energy -72906.947832
Pre-training layer 1, epoch 46, cost -248.005121765
Pre-training layer 1, epoch 47, cost -247.455688858
Pre-training layer 1, epoch 48, cost -247.49659874
Pre-training layer 1, epoch 49, cost -247.225484695
Pre-training layer 1, epoch 50, cost -247.010551987
Pre-training layer 1, epoch 50, representative training free energy -74010.2467871
Pre-training layer 1, epoch 50, validation free energy -73540.9300957
Pre-training layer 1, epoch 51, cost -246.803067932
Pre-training layer 1, epoch 52, cost -246.788158569
Pre-training layer 1, epoch 53, cost -246.604149933
Pre-training layer 1, epoch 54, cost -246.388849564
Pre-training layer 1, epoch 55, cost -246.282945633
Pre-training layer 1, epoch 55, representative training free energy -74532.7674336
Pre-training layer 1, epoch 55, validation free energy -74057.1405937
Pre-training layer 1, epoch 56, cost -245.964709244
Pre-training layer 1, epoch 57, cost -246.008906326
Pre-training layer 1, epoch 58, cost -245.959442978
Pre-training layer 1, epoch 59, cost -245.647698441
Pre-training layer 1, epoch 60, cost -245.601357269
Pre-training layer 1, epoch 60, representative training free energy -75235.1213008
Pre-training layer 1, epoch 60, validation free energy -74757.9647461
Pre-training layer 1, epoch 61, cost -245.426668015
Pre-training layer 1, epoch 62, cost -245.309669876
Pre-training layer 1, epoch 63, cost -245.291548462
Pre-training layer 1, epoch 64, cost -245.128090439
Pre-training layer 1, epoch 65, cost -244.980641632
Pre-training layer 1, epoch 65, representative training free energy -75625.0360312
Pre-training layer 1, epoch 65, validation free energy -75151.0469961
Pre-training layer 1, epoch 66, cost -244.823171921
Pre-training layer 1, epoch 67, cost -244.656314163
Pre-training layer 1, epoch 68, cost -244.513778839
Pre-training layer 1, epoch 69, cost -244.486572876
Pre-training layer 1, epoch 70, cost -244.374805756
Pre-training layer 1, epoch 70, representative training free energy -76101.2501074
Pre-training layer 1, epoch 70, validation free energy -75622.9184863
Pre-training layer 1, epoch 71, cost -244.24524437
Pre-training layer 1, epoch 72, cost -244.390912704
Pre-training layer 1, epoch 73, cost -243.90512825
Pre-training layer 1, epoch 74, cost -243.923156357
Pre-training layer 1, epoch 75, cost -243.828312302
Pre-training layer 1, epoch 75, representative training free energy -76632.8424941
Pre-training layer 1, epoch 75, validation free energy -76153.1473281
Pre-training layer 1, epoch 76, cost -243.74539772
Pre-training layer 1, epoch 77, cost -243.686691818
Pre-training layer 1, epoch 78, cost -243.69934433
Pre-training layer 1, epoch 79, cost -243.596076202
Pre-training layer 1, epoch 80, cost -243.468897934
Pre-training layer 1, epoch 80, representative training free energy -77085.3137773
Pre-training layer 1, epoch 80, validation free energy -76597.2215254
Pre-training layer 1, epoch 81, cost -243.27186821
Pre-training layer 1, epoch 82, cost -243.197227097
Pre-training layer 1, epoch 83, cost -243.201938934
Pre-training layer 1, epoch 84, cost -243.166625137
Pre-training layer 1, epoch 85, cost -243.131401443
Pre-training layer 1, epoch 85, representative training free energy -77508.7370742
Pre-training layer 1, epoch 85, validation free energy -77018.0397695
Pre-training layer 1, epoch 86, cost -243.038234177
Pre-training layer 1, epoch 87, cost -242.915992584
Pre-training layer 1, epoch 88, cost -242.808325043
Pre-training layer 1, epoch 89, cost -242.817347565
Pre-training layer 1, epoch 90, cost -242.650059662
Pre-training layer 1, epoch 90, representative training free energy -77848.9835293
Pre-training layer 1, epoch 90, validation free energy -77350.8705566
Pre-training layer 1, epoch 91, cost -242.538300781
Pre-training layer 1, epoch 92, cost -242.557412109
Pre-training layer 1, epoch 93, cost -242.458076096
Pre-training layer 1, epoch 94, cost -242.35731102
Pre-training layer 1, epoch 95, cost -242.282207184
Pre-training layer 1, epoch 95, representative training free energy -78176.2457637
Pre-training layer 1, epoch 95, validation free energy -77684.9975254
Pre-training layer 1, epoch 96, cost -242.249238434
Pre-training layer 1, epoch 97, cost -242.24515274
Pre-training layer 1, epoch 98, cost -242.17267807
Pre-training layer 1, epoch 99, cost -242.035586319
Pre-training layer 2, epoch 0, cost -136.496912079
Pre-training layer 2, epoch 0, representative training free energy 2110.86510907
Pre-training layer 2, epoch 0, validation free energy 2164.70071585
Pre-training layer 2, epoch 1, cost -97.7310965729
Pre-training layer 2, epoch 2, cost -89.6128398705
Pre-training layer 2, epoch 3, cost -85.3558148575
Pre-training layer 2, epoch 4, cost -82.2079523468
Pre-training layer 2, epoch 5, cost -79.7503565216
Pre-training layer 2, epoch 5, representative training free energy 3551.41788855
Pre-training layer 2, epoch 5, validation free energy 3550.12668372
Pre-training layer 2, epoch 6, cost -78.2640950584
Pre-training layer 2, epoch 7, cost -76.8604985809
Pre-training layer 2, epoch 8, cost -75.5153323746
Pre-training layer 2, epoch 9, cost -74.36094347
Pre-training layer 2, epoch 10, cost -73.5364697838
Pre-training layer 2, epoch 10, representative training free energy 4304.79981775
Pre-training layer 2, epoch 10, validation free energy 4274.55850732
Pre-training layer 2, epoch 11, cost -72.9187701797
Pre-training layer 2, epoch 12, cost -72.3657460022
Pre-training layer 2, epoch 13, cost -71.6293890953
Pre-training layer 2, epoch 14, cost -71.1473221207
Pre-training layer 2, epoch 15, cost -70.5248817635
Pre-training layer 2, epoch 15, representative training free energy 4798.2159519
Pre-training layer 2, epoch 15, validation free energy 4761.84197656
Pre-training layer 2, epoch 16, cost -70.1479263878
Pre-training layer 2, epoch 17, cost -69.6712674522
Pre-training layer 2, epoch 18, cost -69.2022355843
Pre-training layer 2, epoch 19, cost -68.9673456383
Pre-training layer 2, epoch 20, cost -68.633725605
Pre-training layer 2, epoch 20, representative training free energy 5221.69822107
Pre-training layer 2, epoch 20, validation free energy 5178.17388684
Pre-training layer 2, epoch 21, cost -68.3222512436
Pre-training layer 2, epoch 22, cost -68.1058431053
Pre-training layer 2, epoch 23, cost -67.9148006821
Pre-training layer 2, epoch 24, cost -67.7431339836
Pre-training layer 2, epoch 25, cost -67.3232658005
Pre-training layer 2, epoch 25, representative training free energy 5543.43674146
Pre-training layer 2, epoch 25, validation free energy 5499.80196741
Pre-training layer 2, epoch 26, cost -67.1483950424
Pre-training layer 2, epoch 27, cost -66.9512825012
Pre-training layer 2, epoch 28, cost -66.9223935318
Pre-training layer 2, epoch 29, cost -66.5557302094
Pre-training layer 2, epoch 30, cost -66.4124767303
Pre-training layer 2, epoch 30, representative training free energy 5863.58129089
Pre-training layer 2, epoch 30, validation free energy 5816.23832727
Pre-training layer 2, epoch 31, cost -66.2461007881
Pre-training layer 2, epoch 32, cost -66.0974975204
Pre-training layer 2, epoch 33, cost -65.9439202309
Pre-training layer 2, epoch 34, cost -65.736463623
Pre-training layer 2, epoch 35, cost -65.6247712135
Pre-training layer 2, epoch 35, representative training free energy 6137.45076416
Pre-training layer 2, epoch 35, validation free energy 6089.50448389
Pre-training layer 2, epoch 36, cost -65.569055233
Pre-training layer 2, epoch 37, cost -65.386390419
Pre-training layer 2, epoch 38, cost -65.417644558
Pre-training layer 2, epoch 39, cost -65.1921794128
Pre-training layer 2, epoch 40, cost -65.1143553734
Pre-training layer 2, epoch 40, representative training free energy 6387.49268018
Pre-training layer 2, epoch 40, validation free energy 6339.79395764
Pre-training layer 2, epoch 41, cost -64.9871401978
Pre-training layer 2, epoch 42, cost -64.9094976425
Pre-training layer 2, epoch 43, cost -64.7085315323
Pre-training layer 2, epoch 44, cost -64.6731322289
Pre-training layer 2, epoch 45, cost -64.6202702522
Pre-training layer 2, epoch 45, representative training free energy 6610.50534705
Pre-training layer 2, epoch 45, validation free energy 6561.12949744
Pre-training layer 2, epoch 46, cost -64.4903265381
Pre-training layer 2, epoch 47, cost -64.4962999535
Pre-training layer 2, epoch 48, cost -64.461484375
Pre-training layer 2, epoch 49, cost -64.2431133461
Pre-training layer 2, epoch 50, cost -64.1730367661
Pre-training layer 2, epoch 50, representative training free energy 6822.98727808
Pre-training layer 2, epoch 50, validation free energy 6773.95660352
Pre-training layer 2, epoch 51, cost -64.20495924
Pre-training layer 2, epoch 52, cost -64.1361389542
Pre-training layer 2, epoch 53, cost -63.8267582512
Pre-training layer 2, epoch 54, cost -63.9658289337
Pre-training layer 2, epoch 55, cost -63.7024999046
Pre-training layer 2, epoch 55, representative training free energy 7027.39242969
Pre-training layer 2, epoch 55, validation free energy 6975.43740845
Pre-training layer 2, epoch 56, cost -63.6872980118
Pre-training layer 2, epoch 57, cost -63.7245715523
Pre-training layer 2, epoch 58, cost -63.54260849
Pre-training layer 2, epoch 59, cost -63.5075803947
Pre-training layer 2, epoch 60, cost -63.5155571175
Pre-training layer 2, epoch 60, representative training free energy 7199.59416284
Pre-training layer 2, epoch 60, validation free energy 7147.37457593
Pre-training layer 2, epoch 61, cost -63.4056830215
Pre-training layer 2, epoch 62, cost -63.4403265381
Pre-training layer 2, epoch 63, cost -63.2929314995
Pre-training layer 2, epoch 64, cost -63.2539295769
Pre-training layer 2, epoch 65, cost -63.3667953682
Pre-training layer 2, epoch 65, representative training free energy 7400.54223389
Pre-training layer 2, epoch 65, validation free energy 7345.15337402
Pre-training layer 2, epoch 66, cost -63.2705443192
Pre-training layer 2, epoch 67, cost -63.1914820099
Pre-training layer 2, epoch 68, cost -63.2341057777
Pre-training layer 2, epoch 69, cost -62.9682492447
Pre-training layer 2, epoch 70, cost -63.0393283272
Pre-training layer 2, epoch 70, representative training free energy 7591.07559839
Pre-training layer 2, epoch 70, validation free energy 7533.1444502
Pre-training layer 2, epoch 71, cost -63.1320180893
Pre-training layer 2, epoch 72, cost -62.9260391426
Pre-training layer 2, epoch 73, cost -62.9340959549
Pre-training layer 2, epoch 74, cost -62.98779562
Pre-training layer 2, epoch 75, cost -62.8932198715
Pre-training layer 2, epoch 75, representative training free energy 7749.98154761
Pre-training layer 2, epoch 75, validation free energy 7692.32024365
Pre-training layer 2, epoch 76, cost -62.8024785805
Pre-training layer 2, epoch 77, cost -62.6859268188
Pre-training layer 2, epoch 78, cost -62.8479827309
Pre-training layer 2, epoch 79, cost -62.7179321098
Pre-training layer 2, epoch 80, cost -62.5948622894
Pre-training layer 2, epoch 80, representative training free energy 7931.23879053
Pre-training layer 2, epoch 80, validation free energy 7872.11819922
Pre-training layer 2, epoch 81, cost -62.638701458
Pre-training layer 2, epoch 82, cost -62.6109299469
Pre-training layer 2, epoch 83, cost -62.4634604454
Pre-training layer 2, epoch 84, cost -62.5327224541
Pre-training layer 2, epoch 85, cost -62.585187645
Pre-training layer 2, epoch 85, representative training free energy 8072.45249927
Pre-training layer 2, epoch 85, validation free energy 8011.89921167
Pre-training layer 2, epoch 86, cost -62.4206329918
Pre-training layer 2, epoch 87, cost -62.4301847076
Pre-training layer 2, epoch 88, cost -62.4251649094
Pre-training layer 2, epoch 89, cost -62.3579062462
Pre-training layer 2, epoch 90, cost -62.4390808868
Pre-training layer 2, epoch 90, representative training free energy 8241.41029541
Pre-training layer 2, epoch 90, validation free energy 8180.37766724
Pre-training layer 2, epoch 91, cost -62.3855937004
Pre-training layer 2, epoch 92, cost -62.4025336266
Pre-training layer 2, epoch 93, cost -62.3239366722
Pre-training layer 2, epoch 94, cost -62.2316871834
Pre-training layer 2, epoch 95, cost -62.20132864
Pre-training layer 2, epoch 95, representative training free energy 8382.40843311
Pre-training layer 2, epoch 95, validation free energy 8318.43846997
Pre-training layer 2, epoch 96, cost -62.2003170586
Pre-training layer 2, epoch 97, cost -62.2182422066
Pre-training layer 2, epoch 98, cost -62.2071235847
Pre-training layer 2, epoch 99, cost -62.1190406609
The pretraining code for file dbn_loop.pyc ran for 5.32m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 34.500000 %
     epoch 1, minibatch 200/200, test error of best model 29.100000 %
epoch 2, minibatch 200/200, validation error 25.900000 %
     epoch 2, minibatch 200/200, test error of best model 19.700000 %
epoch 3, minibatch 200/200, validation error 22.600000 %
     epoch 3, minibatch 200/200, test error of best model 16.300000 %
epoch 4, minibatch 200/200, validation error 21.400000 %
     epoch 4, minibatch 200/200, test error of best model 13.400000 %
epoch 5, minibatch 200/200, validation error 20.600000 %
     epoch 5, minibatch 200/200, test error of best model 12.400000 %
epoch 6, minibatch 200/200, validation error 19.800000 %
     epoch 6, minibatch 200/200, test error of best model 11.300000 %
epoch 7, minibatch 200/200, validation error 19.400000 %
     epoch 7, minibatch 200/200, test error of best model 10.700000 %
epoch 8, minibatch 200/200, validation error 19.000000 %
     epoch 8, minibatch 200/200, test error of best model 10.100000 %
epoch 9, minibatch 200/200, validation error 18.800000 %
     epoch 9, minibatch 200/200, test error of best model 9.800000 %
epoch 10, minibatch 200/200, validation error 18.400000 %
     epoch 10, minibatch 200/200, test error of best model 9.400000 %
epoch 11, minibatch 200/200, validation error 18.600000 %
epoch 12, minibatch 200/200, validation error 18.100000 %
     epoch 12, minibatch 200/200, test error of best model 8.600000 %
epoch 13, minibatch 200/200, validation error 17.800000 %
     epoch 13, minibatch 200/200, test error of best model 8.400000 %
epoch 14, minibatch 200/200, validation error 17.600000 %
     epoch 14, minibatch 200/200, test error of best model 8.400000 %
epoch 15, minibatch 200/200, validation error 17.300000 %
     epoch 15, minibatch 200/200, test error of best model 8.400000 %
epoch 16, minibatch 200/200, validation error 16.900000 %
     epoch 16, minibatch 200/200, test error of best model 8.400000 %
epoch 17, minibatch 200/200, validation error 16.900000 %
epoch 18, minibatch 200/200, validation error 16.800000 %
     epoch 18, minibatch 200/200, test error of best model 8.200000 %
epoch 19, minibatch 200/200, validation error 16.800000 %
epoch 20, minibatch 200/200, validation error 16.800000 %
epoch 21, minibatch 200/200, validation error 16.700000 %
     epoch 21, minibatch 200/200, test error of best model 8.100000 %
epoch 22, minibatch 200/200, validation error 16.800000 %
epoch 23, minibatch 200/200, validation error 16.600000 %
     epoch 23, minibatch 200/200, test error of best model 8.200000 %
epoch 24, minibatch 200/200, validation error 16.500000 %
     epoch 24, minibatch 200/200, test error of best model 8.100000 %
epoch 25, minibatch 200/200, validation error 16.600000 %
epoch 26, minibatch 200/200, validation error 16.600000 %
epoch 27, minibatch 200/200, validation error 16.500000 %
epoch 28, minibatch 200/200, validation error 16.600000 %
epoch 29, minibatch 200/200, validation error 16.500000 %
epoch 30, minibatch 200/200, validation error 16.700000 %
epoch 31, minibatch 200/200, validation error 16.700000 %
epoch 32, minibatch 200/200, validation error 16.800000 %
epoch 33, minibatch 200/200, validation error 16.800000 %
epoch 34, minibatch 200/200, validation error 16.800000 %
epoch 35, minibatch 200/200, validation error 16.800000 %
epoch 36, minibatch 200/200, validation error 16.800000 %
epoch 37, minibatch 200/200, validation error 16.900000 %
epoch 38, minibatch 200/200, validation error 16.900000 %
epoch 39, minibatch 200/200, validation error 16.900000 %
epoch 40, minibatch 200/200, validation error 16.800000 %
epoch 41, minibatch 200/200, validation error 16.800000 %
epoch 42, minibatch 200/200, validation error 16.800000 %
epoch 43, minibatch 200/200, validation error 16.800000 %
epoch 44, minibatch 200/200, validation error 16.800000 %
epoch 45, minibatch 200/200, validation error 16.800000 %
epoch 46, minibatch 200/200, validation error 16.800000 %
epoch 47, minibatch 200/200, validation error 16.800000 %
Optimization complete with best validation score of 16.500000 %, obtained at iteration 4800, with test performance 8.100000 %
The fine tuning code for file dbn_loop.pyc ran for 0.92m


==========Sample: (3000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.801185633
Pre-training layer 0, epoch 0, representative training free energy -560.711916565
Pre-training layer 0, epoch 0, validation free energy -557.182069794
Pre-training layer 0, epoch 1, cost -116.811277084
Pre-training layer 0, epoch 2, cost -108.104614105
Pre-training layer 0, epoch 3, cost -103.003545507
Pre-training layer 0, epoch 4, cost -99.1081987762
Pre-training layer 0, epoch 5, cost -96.5167442322
Pre-training layer 0, epoch 5, representative training free energy -502.470348755
Pre-training layer 0, epoch 5, validation free energy -494.958673187
Pre-training layer 0, epoch 6, cost -94.4165727234
Pre-training layer 0, epoch 7, cost -92.9818003337
Pre-training layer 0, epoch 8, cost -91.333164266
Pre-training layer 0, epoch 9, cost -90.0465643819
Pre-training layer 0, epoch 10, cost -89.0817293294
Pre-training layer 0, epoch 10, representative training free energy -480.225020386
Pre-training layer 0, epoch 10, validation free energy -472.922351227
Pre-training layer 0, epoch 11, cost -88.0642015076
Pre-training layer 0, epoch 12, cost -87.4905707296
Pre-training layer 0, epoch 13, cost -86.6997255707
Pre-training layer 0, epoch 14, cost -85.9627344259
Pre-training layer 0, epoch 15, cost -85.3729631805
Pre-training layer 0, epoch 15, representative training free energy -467.012535309
Pre-training layer 0, epoch 15, validation free energy -459.016653809
Pre-training layer 0, epoch 16, cost -84.8129015732
Pre-training layer 0, epoch 17, cost -84.3201814016
Pre-training layer 0, epoch 18, cost -83.9150822703
Pre-training layer 0, epoch 19, cost -83.3670765686
Pre-training layer 0, epoch 20, cost -83.0235412598
Pre-training layer 0, epoch 20, representative training free energy -457.098292938
Pre-training layer 0, epoch 20, validation free energy -449.755735718
Pre-training layer 0, epoch 21, cost -82.7410173035
Pre-training layer 0, epoch 22, cost -82.3106285858
Pre-training layer 0, epoch 23, cost -81.987351621
Pre-training layer 0, epoch 24, cost -81.5845808538
Pre-training layer 0, epoch 25, cost -81.3184581502
Pre-training layer 0, epoch 25, representative training free energy -452.541789764
Pre-training layer 0, epoch 25, validation free energy -444.441137085
Pre-training layer 0, epoch 26, cost -81.0810729218
Pre-training layer 0, epoch 27, cost -80.7761628342
Pre-training layer 0, epoch 28, cost -80.3858616002
Pre-training layer 0, epoch 29, cost -80.2962630971
Pre-training layer 0, epoch 30, cost -80.2507963435
Pre-training layer 0, epoch 30, representative training free energy -447.211025055
Pre-training layer 0, epoch 30, validation free energy -438.688047791
Pre-training layer 0, epoch 31, cost -79.8253063456
Pre-training layer 0, epoch 32, cost -79.6377763748
Pre-training layer 0, epoch 33, cost -79.5288371913
Pre-training layer 0, epoch 34, cost -79.3147272237
Pre-training layer 0, epoch 35, cost -79.1477920532
Pre-training layer 0, epoch 35, representative training free energy -443.43988324
Pre-training layer 0, epoch 35, validation free energy -435.118830109
Pre-training layer 0, epoch 36, cost -79.0694036357
Pre-training layer 0, epoch 37, cost -78.7187060547
Pre-training layer 0, epoch 38, cost -78.5699302673
Pre-training layer 0, epoch 39, cost -78.4784699504
Pre-training layer 0, epoch 40, cost -78.2307289886
Pre-training layer 0, epoch 40, representative training free energy -441.236508636
Pre-training layer 0, epoch 40, validation free energy -431.955611664
Pre-training layer 0, epoch 41, cost -78.0717833455
Pre-training layer 0, epoch 42, cost -77.9380336253
Pre-training layer 0, epoch 43, cost -77.7910398992
Pre-training layer 0, epoch 44, cost -77.7523132833
Pre-training layer 0, epoch 45, cost -77.4925760142
Pre-training layer 0, epoch 45, representative training free energy -438.682909698
Pre-training layer 0, epoch 45, validation free energy -430.083598694
Pre-training layer 0, epoch 46, cost -77.1342160288
Pre-training layer 0, epoch 47, cost -77.242235349
Pre-training layer 0, epoch 48, cost -77.146395963
Pre-training layer 0, epoch 49, cost -77.0590347036
Pre-training layer 0, epoch 50, cost -76.9236895752
Pre-training layer 0, epoch 50, representative training free energy -436.845039734
Pre-training layer 0, epoch 50, validation free energy -427.324112335
Pre-training layer 0, epoch 51, cost -76.8463171132
Pre-training layer 0, epoch 52, cost -76.5830375163
Pre-training layer 0, epoch 53, cost -76.7628749466
Pre-training layer 0, epoch 54, cost -76.3335539118
Pre-training layer 0, epoch 55, cost -76.4933518219
Pre-training layer 0, epoch 55, representative training free energy -437.51937851
Pre-training layer 0, epoch 55, validation free energy -427.773438263
Pre-training layer 0, epoch 56, cost -76.1197821426
Pre-training layer 0, epoch 57, cost -76.1188664754
Pre-training layer 0, epoch 58, cost -76.0891423416
Pre-training layer 0, epoch 59, cost -75.962253774
Pre-training layer 0, epoch 60, cost -75.8066305288
Pre-training layer 0, epoch 60, representative training free energy -436.336374573
Pre-training layer 0, epoch 60, validation free energy -426.534932404
Pre-training layer 0, epoch 61, cost -75.6776629512
Pre-training layer 0, epoch 62, cost -75.6929837036
Pre-training layer 0, epoch 63, cost -75.5201049296
Pre-training layer 0, epoch 64, cost -75.5042167155
Pre-training layer 0, epoch 65, cost -75.3722028732
Pre-training layer 0, epoch 65, representative training free energy -434.192590149
Pre-training layer 0, epoch 65, validation free energy -424.250379578
Pre-training layer 0, epoch 66, cost -75.2748251343
Pre-training layer 0, epoch 67, cost -75.3351550929
Pre-training layer 0, epoch 68, cost -75.3181381989
Pre-training layer 0, epoch 69, cost -75.0669452413
Pre-training layer 0, epoch 70, cost -75.0613713074
Pre-training layer 0, epoch 70, representative training free energy -431.609509094
Pre-training layer 0, epoch 70, validation free energy -421.069700317
Pre-training layer 0, epoch 71, cost -74.9769404093
Pre-training layer 0, epoch 72, cost -74.7816037242
Pre-training layer 0, epoch 73, cost -74.904242452
Pre-training layer 0, epoch 74, cost -74.7566467158
Pre-training layer 0, epoch 75, cost -74.7271777471
Pre-training layer 0, epoch 75, representative training free energy -433.408431458
Pre-training layer 0, epoch 75, validation free energy -422.826501892
Pre-training layer 0, epoch 76, cost -74.5736683782
Pre-training layer 0, epoch 77, cost -74.5849390666
Pre-training layer 0, epoch 78, cost -74.4897327042
Pre-training layer 0, epoch 79, cost -74.4424978892
Pre-training layer 0, epoch 80, cost -74.3487902578
Pre-training layer 0, epoch 80, representative training free energy -431.362022644
Pre-training layer 0, epoch 80, validation free energy -420.545235443
Pre-training layer 0, epoch 81, cost -74.2090959422
Pre-training layer 0, epoch 82, cost -74.1355373637
Pre-training layer 0, epoch 83, cost -73.9737579727
Pre-training layer 0, epoch 84, cost -74.0905259959
Pre-training layer 0, epoch 85, cost -74.0334138489
Pre-training layer 0, epoch 85, representative training free energy -432.957516693
Pre-training layer 0, epoch 85, validation free energy -421.833907501
Pre-training layer 0, epoch 86, cost -73.9180610402
Pre-training layer 0, epoch 87, cost -73.8165922419
Pre-training layer 0, epoch 88, cost -73.8206448237
Pre-training layer 0, epoch 89, cost -73.808215332
Pre-training layer 0, epoch 90, cost -73.6958906555
Pre-training layer 0, epoch 90, representative training free energy -430.277760101
Pre-training layer 0, epoch 90, validation free energy -419.487251801
Pre-training layer 0, epoch 91, cost -73.6541700236
Pre-training layer 0, epoch 92, cost -73.769459966
Pre-training layer 0, epoch 93, cost -73.5400371679
Pre-training layer 0, epoch 94, cost -73.5135672251
Pre-training layer 0, epoch 95, cost -73.4790825653
Pre-training layer 0, epoch 95, representative training free energy -429.688697845
Pre-training layer 0, epoch 95, validation free energy -418.855925812
Pre-training layer 0, epoch 96, cost -73.4054405467
Pre-training layer 0, epoch 97, cost -73.2867248154
Pre-training layer 0, epoch 98, cost -73.4501353327
Pre-training layer 0, epoch 99, cost -73.2699232229
Pre-training layer 1, epoch 0, cost -344.962693583
Pre-training layer 1, epoch 0, representative training free energy -51270.0473867
Pre-training layer 1, epoch 0, validation free energy -50827.5643184
Pre-training layer 1, epoch 1, cost -296.015223185
Pre-training layer 1, epoch 2, cost -281.097286377
Pre-training layer 1, epoch 3, cost -272.169249013
Pre-training layer 1, epoch 4, cost -266.146731466
Pre-training layer 1, epoch 5, cost -261.59986674
Pre-training layer 1, epoch 5, representative training free energy -69353.3220234
Pre-training layer 1, epoch 5, validation free energy -68768.9582773
Pre-training layer 1, epoch 6, cost -258.079220886
Pre-training layer 1, epoch 7, cost -255.186634776
Pre-training layer 1, epoch 8, cost -252.650675405
Pre-training layer 1, epoch 9, cost -250.739341482
Pre-training layer 1, epoch 10, cost -248.976292928
Pre-training layer 1, epoch 10, representative training free energy -74945.7018867
Pre-training layer 1, epoch 10, validation free energy -74314.3052285
Pre-training layer 1, epoch 11, cost -247.439477081
Pre-training layer 1, epoch 12, cost -246.088058777
Pre-training layer 1, epoch 13, cost -244.900339305
Pre-training layer 1, epoch 14, cost -243.871285604
Pre-training layer 1, epoch 15, cost -242.968097127
Pre-training layer 1, epoch 15, representative training free energy -78231.6341484
Pre-training layer 1, epoch 15, validation free energy -77588.4457363
Pre-training layer 1, epoch 16, cost -242.088991445
Pre-training layer 1, epoch 17, cost -241.288333588
Pre-training layer 1, epoch 18, cost -240.56673116
Pre-training layer 1, epoch 19, cost -239.848738708
Pre-training layer 1, epoch 20, cost -239.206677653
Pre-training layer 1, epoch 20, representative training free energy -80592.0454727
Pre-training layer 1, epoch 20, validation free energy -79932.7833965
Pre-training layer 1, epoch 21, cost -238.747085673
Pre-training layer 1, epoch 22, cost -238.09861323
Pre-training layer 1, epoch 23, cost -237.749044545
Pre-training layer 1, epoch 24, cost -237.20598587
Pre-training layer 1, epoch 25, cost -236.725005849
Pre-training layer 1, epoch 25, representative training free energy -82373.2736465
Pre-training layer 1, epoch 25, validation free energy -81686.6557949
Pre-training layer 1, epoch 26, cost -236.464032694
Pre-training layer 1, epoch 27, cost -236.043896179
Pre-training layer 1, epoch 28, cost -235.641509247
Pre-training layer 1, epoch 29, cost -235.357858073
Pre-training layer 1, epoch 30, cost -234.927997182
Pre-training layer 1, epoch 30, representative training free energy -83890.1034629
Pre-training layer 1, epoch 30, validation free energy -83187.0888848
Pre-training layer 1, epoch 31, cost -234.728105621
Pre-training layer 1, epoch 32, cost -234.501902568
Pre-training layer 1, epoch 33, cost -234.005382334
Pre-training layer 1, epoch 34, cost -233.826637777
Pre-training layer 1, epoch 35, cost -233.560845439
Pre-training layer 1, epoch 35, representative training free energy -85022.8055332
Pre-training layer 1, epoch 35, validation free energy -84316.3945273
Pre-training layer 1, epoch 36, cost -233.459840037
Pre-training layer 1, epoch 37, cost -233.132184245
Pre-training layer 1, epoch 38, cost -232.888402863
Pre-training layer 1, epoch 39, cost -232.699420217
Pre-training layer 1, epoch 40, cost -232.596455994
Pre-training layer 1, epoch 40, representative training free energy -86087.8833496
Pre-training layer 1, epoch 40, validation free energy -85368.219918
Pre-training layer 1, epoch 41, cost -232.287222544
Pre-training layer 1, epoch 42, cost -231.971881917
Pre-training layer 1, epoch 43, cost -231.937220815
Pre-training layer 1, epoch 44, cost -231.623967896
Pre-training layer 1, epoch 45, cost -231.533567454
Pre-training layer 1, epoch 45, representative training free energy -87167.8497363
Pre-training layer 1, epoch 45, validation free energy -86437.7377051
Pre-training layer 1, epoch 46, cost -231.287483164
Pre-training layer 1, epoch 47, cost -231.333001556
Pre-training layer 1, epoch 48, cost -231.042081858
Pre-training layer 1, epoch 49, cost -230.873320312
Pre-training layer 1, epoch 50, cost -230.744985606
Pre-training layer 1, epoch 50, representative training free energy -87919.9451816
Pre-training layer 1, epoch 50, validation free energy -87188.4725879
Pre-training layer 1, epoch 51, cost -230.573593343
Pre-training layer 1, epoch 52, cost -230.493160044
Pre-training layer 1, epoch 53, cost -230.385299174
Pre-training layer 1, epoch 54, cost -230.182546488
Pre-training layer 1, epoch 55, cost -230.098186239
Pre-training layer 1, epoch 55, representative training free energy -88804.3322559
Pre-training layer 1, epoch 55, validation free energy -88069.427791
Pre-training layer 1, epoch 56, cost -229.859992472
Pre-training layer 1, epoch 57, cost -229.957818298
Pre-training layer 1, epoch 58, cost -229.64383194
Pre-training layer 1, epoch 59, cost -229.628005219
Pre-training layer 1, epoch 60, cost -229.550285085
Pre-training layer 1, epoch 60, representative training free energy -89431.4857695
Pre-training layer 1, epoch 60, validation free energy -88680.0148457
Pre-training layer 1, epoch 61, cost -229.378551229
Pre-training layer 1, epoch 62, cost -229.209203186
Pre-training layer 1, epoch 63, cost -229.119489644
Pre-training layer 1, epoch 64, cost -229.035375977
Pre-training layer 1, epoch 65, cost -228.966458893
Pre-training layer 1, epoch 65, representative training free energy -90001.4255801
Pre-training layer 1, epoch 65, validation free energy -89257.7807305
Pre-training layer 1, epoch 66, cost -228.855141907
Pre-training layer 1, epoch 67, cost -228.741930898
Pre-training layer 1, epoch 68, cost -228.685107168
Pre-training layer 1, epoch 69, cost -228.53185969
Pre-training layer 1, epoch 70, cost -228.482580973
Pre-training layer 1, epoch 70, representative training free energy -90637.0917461
Pre-training layer 1, epoch 70, validation free energy -89888.7708945
Pre-training layer 1, epoch 71, cost -228.422398733
Pre-training layer 1, epoch 72, cost -228.299465942
Pre-training layer 1, epoch 73, cost -228.278980865
Pre-training layer 1, epoch 74, cost -228.069576925
Pre-training layer 1, epoch 75, cost -228.048453522
Pre-training layer 1, epoch 75, representative training free energy -91275.3895566
Pre-training layer 1, epoch 75, validation free energy -90510.2769434
Pre-training layer 1, epoch 76, cost -228.063518168
Pre-training layer 1, epoch 77, cost -227.886187185
Pre-training layer 1, epoch 78, cost -227.764196879
Pre-training layer 1, epoch 79, cost -227.732952474
Pre-training layer 1, epoch 80, cost -227.685192362
Pre-training layer 1, epoch 80, representative training free energy -91764.1647227
Pre-training layer 1, epoch 80, validation free energy -91000.507082
Pre-training layer 1, epoch 81, cost -227.55470225
Pre-training layer 1, epoch 82, cost -227.367729797
Pre-training layer 1, epoch 83, cost -227.464954122
Pre-training layer 1, epoch 84, cost -227.411790009
Pre-training layer 1, epoch 85, cost -227.228003184
Pre-training layer 1, epoch 85, representative training free energy -92299.0319199
Pre-training layer 1, epoch 85, validation free energy -91523.4913828
Pre-training layer 1, epoch 86, cost -227.272552541
Pre-training layer 1, epoch 87, cost -227.180734812
Pre-training layer 1, epoch 88, cost -227.077116699
Pre-training layer 1, epoch 89, cost -227.012410787
Pre-training layer 1, epoch 90, cost -227.002949677
Pre-training layer 1, epoch 90, representative training free energy -92736.9926719
Pre-training layer 1, epoch 90, validation free energy -91953.3920273
Pre-training layer 1, epoch 91, cost -226.923178813
Pre-training layer 1, epoch 92, cost -227.002984263
Pre-training layer 1, epoch 93, cost -226.789596761
Pre-training layer 1, epoch 94, cost -226.782320557
Pre-training layer 1, epoch 95, cost -226.743606517
Pre-training layer 1, epoch 95, representative training free energy -93307.5582187
Pre-training layer 1, epoch 95, validation free energy -92519.4296992
Pre-training layer 1, epoch 96, cost -226.791063232
Pre-training layer 1, epoch 97, cost -226.464364675
Pre-training layer 1, epoch 98, cost -226.521740163
Pre-training layer 1, epoch 99, cost -226.444698232
Pre-training layer 2, epoch 0, cost -126.43731542
Pre-training layer 2, epoch 0, representative training free energy 3215.17734485
Pre-training layer 2, epoch 0, validation free energy 3192.64040234
Pre-training layer 2, epoch 1, cost -92.8718362045
Pre-training layer 2, epoch 2, cost -85.7815602875
Pre-training layer 2, epoch 3, cost -81.6079761124
Pre-training layer 2, epoch 4, cost -79.0110956446
Pre-training layer 2, epoch 5, cost -76.949132843
Pre-training layer 2, epoch 5, representative training free energy 4885.43223914
Pre-training layer 2, epoch 5, validation free energy 4821.59046582
Pre-training layer 2, epoch 6, cost -75.3917745717
Pre-training layer 2, epoch 7, cost -74.1877640915
Pre-training layer 2, epoch 8, cost -73.1558523432
Pre-training layer 2, epoch 9, cost -72.1350882848
Pre-training layer 2, epoch 10, cost -71.3876686732
Pre-training layer 2, epoch 10, representative training free energy 5831.93145154
Pre-training layer 2, epoch 10, validation free energy 5777.16248999
Pre-training layer 2, epoch 11, cost -70.7316273244
Pre-training layer 2, epoch 12, cost -70.1800126139
Pre-training layer 2, epoch 13, cost -69.6100900396
Pre-training layer 2, epoch 14, cost -69.233666687
Pre-training layer 2, epoch 15, cost -68.7430568949
Pre-training layer 2, epoch 15, representative training free energy 6480.21139429
Pre-training layer 2, epoch 15, validation free energy 6423.89059326
Pre-training layer 2, epoch 16, cost -68.3779903285
Pre-training layer 2, epoch 17, cost -67.9929909388
Pre-training layer 2, epoch 18, cost -67.7097235743
Pre-training layer 2, epoch 19, cost -67.4018605932
Pre-training layer 2, epoch 20, cost -67.120599912
Pre-training layer 2, epoch 20, representative training free energy 6976.49520984
Pre-training layer 2, epoch 20, validation free energy 6912.59253052
Pre-training layer 2, epoch 21, cost -66.8239621989
Pre-training layer 2, epoch 22, cost -66.6257397207
Pre-training layer 2, epoch 23, cost -66.4765870539
Pre-training layer 2, epoch 24, cost -66.2032119878
Pre-training layer 2, epoch 25, cost -65.9581541189
Pre-training layer 2, epoch 25, representative training free energy 7450.46193237
Pre-training layer 2, epoch 25, validation free energy 7384.06497217
Pre-training layer 2, epoch 26, cost -65.8128900528
Pre-training layer 2, epoch 27, cost -65.8110945002
Pre-training layer 2, epoch 28, cost -65.5953649267
Pre-training layer 2, epoch 29, cost -65.4517304484
Pre-training layer 2, epoch 30, cost -65.2605928548
Pre-training layer 2, epoch 30, representative training free energy 7860.54218286
Pre-training layer 2, epoch 30, validation free energy 7789.18056055
Pre-training layer 2, epoch 31, cost -65.0899889119
Pre-training layer 2, epoch 32, cost -64.8904743449
Pre-training layer 2, epoch 33, cost -64.8746350479
Pre-training layer 2, epoch 34, cost -64.7183230972
Pre-training layer 2, epoch 35, cost -64.6221867879
Pre-training layer 2, epoch 35, representative training free energy 8225.71799902
Pre-training layer 2, epoch 35, validation free energy 8151.90439355
Pre-training layer 2, epoch 36, cost -64.5768364843
Pre-training layer 2, epoch 37, cost -64.3562586085
Pre-training layer 2, epoch 38, cost -64.3504536184
Pre-training layer 2, epoch 39, cost -64.1927275594
Pre-training layer 2, epoch 40, cost -64.0670967356
Pre-training layer 2, epoch 40, representative training free energy 8565.23752148
Pre-training layer 2, epoch 40, validation free energy 8487.7325415
Pre-training layer 2, epoch 41, cost -63.9892511622
Pre-training layer 2, epoch 42, cost -63.9744816081
Pre-training layer 2, epoch 43, cost -63.9790908432
Pre-training layer 2, epoch 44, cost -63.7869400533
Pre-training layer 2, epoch 45, cost -63.7245030848
Pre-training layer 2, epoch 45, representative training free energy 8883.9250769
Pre-training layer 2, epoch 45, validation free energy 8802.6354021
Pre-training layer 2, epoch 46, cost -63.7347628148
Pre-training layer 2, epoch 47, cost -63.6006625621
Pre-training layer 2, epoch 48, cost -63.5733458455
Pre-training layer 2, epoch 49, cost -63.580849762
Pre-training layer 2, epoch 50, cost -63.430774676
Pre-training layer 2, epoch 50, representative training free energy 9169.74119946
Pre-training layer 2, epoch 50, validation free energy 9085.14242871
Pre-training layer 2, epoch 51, cost -63.4637840652
Pre-training layer 2, epoch 52, cost -63.3357527796
Pre-training layer 2, epoch 53, cost -63.2264807638
Pre-training layer 2, epoch 54, cost -63.24297568
Pre-training layer 2, epoch 55, cost -63.2191176097
Pre-training layer 2, epoch 55, representative training free energy 9430.56572388
Pre-training layer 2, epoch 55, validation free energy 9343.19429883
Pre-training layer 2, epoch 56, cost -63.0472079086
Pre-training layer 2, epoch 57, cost -62.9985440826
Pre-training layer 2, epoch 58, cost -62.9840860113
Pre-training layer 2, epoch 59, cost -62.963410937
Pre-training layer 2, epoch 60, cost -62.9303947703
Pre-training layer 2, epoch 60, representative training free energy 9694.66618677
Pre-training layer 2, epoch 60, validation free energy 9605.23479321
Pre-training layer 2, epoch 61, cost -62.8570278676
Pre-training layer 2, epoch 62, cost -62.8126938756
Pre-training layer 2, epoch 63, cost -62.7105096563
Pre-training layer 2, epoch 64, cost -62.7177701823
Pre-training layer 2, epoch 65, cost -62.6992577744
Pre-training layer 2, epoch 65, representative training free energy 9931.09567285
Pre-training layer 2, epoch 65, validation free energy 9838.03537744
Pre-training layer 2, epoch 66, cost -62.6306025696
Pre-training layer 2, epoch 67, cost -62.6074659093
Pre-training layer 2, epoch 68, cost -62.5906963857
Pre-training layer 2, epoch 69, cost -62.5199998093
Pre-training layer 2, epoch 70, cost -62.5293407059
Pre-training layer 2, epoch 70, representative training free energy 10198.9290225
Pre-training layer 2, epoch 70, validation free energy 10103.6884421
Pre-training layer 2, epoch 71, cost -62.4865969213
Pre-training layer 2, epoch 72, cost -62.3961633555
Pre-training layer 2, epoch 73, cost -62.416947581
Pre-training layer 2, epoch 74, cost -62.3756778081
Pre-training layer 2, epoch 75, cost -62.3443763351
Pre-training layer 2, epoch 75, representative training free energy 10420.8487556
Pre-training layer 2, epoch 75, validation free energy 10324.1946787
Pre-training layer 2, epoch 76, cost -62.3677439372
Pre-training layer 2, epoch 77, cost -62.2501604207
Pre-training layer 2, epoch 78, cost -62.1784656143
Pre-training layer 2, epoch 79, cost -62.1931705475
Pre-training layer 2, epoch 80, cost -62.2051505407
Pre-training layer 2, epoch 80, representative training free energy 10615.771533
Pre-training layer 2, epoch 80, validation free energy 10516.9586609
Pre-training layer 2, epoch 81, cost -62.1055263265
Pre-training layer 2, epoch 82, cost -62.1201313273
Pre-training layer 2, epoch 83, cost -62.1394770177
Pre-training layer 2, epoch 84, cost -62.0040479787
Pre-training layer 2, epoch 85, cost -62.0946975072
Pre-training layer 2, epoch 85, representative training free energy 10813.9605459
Pre-training layer 2, epoch 85, validation free energy 10713.4680298
Pre-training layer 2, epoch 86, cost -62.1023041916
Pre-training layer 2, epoch 87, cost -62.008300705
Pre-training layer 2, epoch 88, cost -62.0206071981
Pre-training layer 2, epoch 89, cost -61.9248425293
Pre-training layer 2, epoch 90, cost -61.9395300166
Pre-training layer 2, epoch 90, representative training free energy 11038.6208596
Pre-training layer 2, epoch 90, validation free energy 10934.4339692
Pre-training layer 2, epoch 91, cost -61.8759614944
Pre-training layer 2, epoch 92, cost -61.8559950002
Pre-training layer 2, epoch 93, cost -61.8734075801
Pre-training layer 2, epoch 94, cost -61.7651443481
Pre-training layer 2, epoch 95, cost -61.8289009476
Pre-training layer 2, epoch 95, representative training free energy 11218.4279309
Pre-training layer 2, epoch 95, validation free energy 11111.755373
Pre-training layer 2, epoch 96, cost -61.7584534454
Pre-training layer 2, epoch 97, cost -61.8205256907
Pre-training layer 2, epoch 98, cost -61.6872368113
Pre-training layer 2, epoch 99, cost -61.7422897212
The pretraining code for file dbn_loop.pyc ran for 7.96m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 34.700000 %
     epoch 1, minibatch 300/300, test error of best model 29.600000 %
epoch 2, minibatch 300/300, validation error 28.700000 %
     epoch 2, minibatch 300/300, test error of best model 20.700000 %
epoch 3, minibatch 300/300, validation error 25.500000 %
     epoch 3, minibatch 300/300, test error of best model 16.900000 %
epoch 4, minibatch 300/300, validation error 24.000000 %
     epoch 4, minibatch 300/300, test error of best model 15.200000 %
epoch 5, minibatch 300/300, validation error 23.600000 %
     epoch 5, minibatch 300/300, test error of best model 13.800000 %
epoch 6, minibatch 300/300, validation error 22.600000 %
     epoch 6, minibatch 300/300, test error of best model 12.800000 %
epoch 7, minibatch 300/300, validation error 21.900000 %
     epoch 7, minibatch 300/300, test error of best model 12.000000 %
epoch 8, minibatch 300/300, validation error 21.300000 %
     epoch 8, minibatch 300/300, test error of best model 11.100000 %
epoch 9, minibatch 300/300, validation error 21.000000 %
     epoch 9, minibatch 300/300, test error of best model 10.800000 %
epoch 10, minibatch 300/300, validation error 20.500000 %
     epoch 10, minibatch 300/300, test error of best model 10.000000 %
epoch 11, minibatch 300/300, validation error 19.500000 %
     epoch 11, minibatch 300/300, test error of best model 9.600000 %
epoch 12, minibatch 300/300, validation error 19.700000 %
epoch 13, minibatch 300/300, validation error 19.100000 %
     epoch 13, minibatch 300/300, test error of best model 8.900000 %
epoch 14, minibatch 300/300, validation error 18.600000 %
     epoch 14, minibatch 300/300, test error of best model 8.900000 %
epoch 15, minibatch 300/300, validation error 18.000000 %
     epoch 15, minibatch 300/300, test error of best model 8.800000 %
epoch 16, minibatch 300/300, validation error 17.800000 %
     epoch 16, minibatch 300/300, test error of best model 8.900000 %
epoch 17, minibatch 300/300, validation error 17.600000 %
     epoch 17, minibatch 300/300, test error of best model 9.000000 %
epoch 18, minibatch 300/300, validation error 17.600000 %
epoch 19, minibatch 300/300, validation error 17.500000 %
     epoch 19, minibatch 300/300, test error of best model 9.100000 %
epoch 20, minibatch 300/300, validation error 17.500000 %
epoch 21, minibatch 300/300, validation error 17.200000 %
     epoch 21, minibatch 300/300, test error of best model 9.100000 %
epoch 22, minibatch 300/300, validation error 17.200000 %
epoch 23, minibatch 300/300, validation error 17.200000 %
epoch 24, minibatch 300/300, validation error 17.100000 %
     epoch 24, minibatch 300/300, test error of best model 8.600000 %
epoch 25, minibatch 300/300, validation error 16.900000 %
     epoch 25, minibatch 300/300, test error of best model 8.600000 %
epoch 26, minibatch 300/300, validation error 16.700000 %
     epoch 26, minibatch 300/300, test error of best model 8.500000 %
epoch 27, minibatch 300/300, validation error 16.600000 %
     epoch 27, minibatch 300/300, test error of best model 8.500000 %
epoch 28, minibatch 300/300, validation error 16.700000 %
epoch 29, minibatch 300/300, validation error 16.600000 %
epoch 30, minibatch 300/300, validation error 16.600000 %
epoch 31, minibatch 300/300, validation error 16.500000 %
     epoch 31, minibatch 300/300, test error of best model 8.200000 %
epoch 32, minibatch 300/300, validation error 16.600000 %
epoch 33, minibatch 300/300, validation error 16.600000 %
epoch 34, minibatch 300/300, validation error 16.500000 %
epoch 35, minibatch 300/300, validation error 16.500000 %
epoch 36, minibatch 300/300, validation error 16.500000 %
epoch 37, minibatch 300/300, validation error 16.400000 %
     epoch 37, minibatch 300/300, test error of best model 7.500000 %
epoch 38, minibatch 300/300, validation error 16.300000 %
     epoch 38, minibatch 300/300, test error of best model 7.400000 %
epoch 39, minibatch 300/300, validation error 16.300000 %
epoch 40, minibatch 300/300, validation error 16.000000 %
     epoch 40, minibatch 300/300, test error of best model 7.000000 %
epoch 41, minibatch 300/300, validation error 16.000000 %
epoch 42, minibatch 300/300, validation error 16.100000 %
epoch 43, minibatch 300/300, validation error 16.100000 %
epoch 44, minibatch 300/300, validation error 15.900000 %
     epoch 44, minibatch 300/300, test error of best model 7.000000 %
epoch 45, minibatch 300/300, validation error 15.800000 %
     epoch 45, minibatch 300/300, test error of best model 7.000000 %
epoch 46, minibatch 300/300, validation error 15.800000 %
epoch 47, minibatch 300/300, validation error 15.700000 %
     epoch 47, minibatch 300/300, test error of best model 6.800000 %
epoch 48, minibatch 300/300, validation error 15.700000 %
epoch 49, minibatch 300/300, validation error 15.700000 %
epoch 50, minibatch 300/300, validation error 15.700000 %
epoch 51, minibatch 300/300, validation error 15.700000 %
epoch 52, minibatch 300/300, validation error 15.600000 %
     epoch 52, minibatch 300/300, test error of best model 6.700000 %
epoch 53, minibatch 300/300, validation error 15.600000 %
epoch 54, minibatch 300/300, validation error 15.600000 %
epoch 55, minibatch 300/300, validation error 15.600000 %
epoch 56, minibatch 300/300, validation error 15.500000 %
     epoch 56, minibatch 300/300, test error of best model 6.800000 %
epoch 57, minibatch 300/300, validation error 15.500000 %
epoch 58, minibatch 300/300, validation error 15.400000 %
     epoch 58, minibatch 300/300, test error of best model 6.800000 %
epoch 59, minibatch 300/300, validation error 15.400000 %
epoch 60, minibatch 300/300, validation error 15.400000 %
epoch 61, minibatch 300/300, validation error 15.400000 %
epoch 62, minibatch 300/300, validation error 15.400000 %
epoch 63, minibatch 300/300, validation error 15.300000 %
     epoch 63, minibatch 300/300, test error of best model 6.600000 %
epoch 64, minibatch 300/300, validation error 15.300000 %
epoch 65, minibatch 300/300, validation error 15.200000 %
     epoch 65, minibatch 300/300, test error of best model 6.600000 %
epoch 66, minibatch 300/300, validation error 15.200000 %
epoch 67, minibatch 300/300, validation error 15.200000 %
epoch 68, minibatch 300/300, validation error 15.200000 %
epoch 69, minibatch 300/300, validation error 15.200000 %
epoch 70, minibatch 300/300, validation error 15.200000 %
epoch 71, minibatch 300/300, validation error 15.200000 %
epoch 72, minibatch 300/300, validation error 15.200000 %
epoch 73, minibatch 300/300, validation error 15.200000 %
epoch 74, minibatch 300/300, validation error 15.200000 %
epoch 75, minibatch 300/300, validation error 15.200000 %
epoch 76, minibatch 300/300, validation error 15.200000 %
epoch 77, minibatch 300/300, validation error 15.100000 %
     epoch 77, minibatch 300/300, test error of best model 6.300000 %
epoch 78, minibatch 300/300, validation error 15.100000 %
epoch 79, minibatch 300/300, validation error 14.900000 %
     epoch 79, minibatch 300/300, test error of best model 6.300000 %
epoch 80, minibatch 300/300, validation error 14.900000 %
epoch 81, minibatch 300/300, validation error 14.900000 %
epoch 82, minibatch 300/300, validation error 14.900000 %
epoch 83, minibatch 300/300, validation error 14.900000 %
epoch 84, minibatch 300/300, validation error 15.000000 %
epoch 85, minibatch 300/300, validation error 15.000000 %
epoch 86, minibatch 300/300, validation error 15.000000 %
epoch 87, minibatch 300/300, validation error 15.000000 %
epoch 88, minibatch 300/300, validation error 15.000000 %
epoch 89, minibatch 300/300, validation error 15.000000 %
epoch 90, minibatch 300/300, validation error 15.000000 %
epoch 91, minibatch 300/300, validation error 15.000000 %
epoch 92, minibatch 300/300, validation error 15.000000 %
epoch 93, minibatch 300/300, validation error 15.000000 %
epoch 94, minibatch 300/300, validation error 15.000000 %
epoch 95, minibatch 300/300, validation error 15.000000 %
epoch 96, minibatch 300/300, validation error 15.000000 %
epoch 97, minibatch 300/300, validation error 15.000000 %
epoch 98, minibatch 300/300, validation error 15.000000 %
epoch 99, minibatch 300/300, validation error 15.000000 %
epoch 100, minibatch 300/300, validation error 15.000000 %
epoch 101, minibatch 300/300, validation error 15.000000 %
epoch 102, minibatch 300/300, validation error 15.000000 %
epoch 103, minibatch 300/300, validation error 15.000000 %
epoch 104, minibatch 300/300, validation error 15.000000 %
epoch 105, minibatch 300/300, validation error 15.000000 %
epoch 106, minibatch 300/300, validation error 15.000000 %
epoch 107, minibatch 300/300, validation error 14.900000 %
epoch 108, minibatch 300/300, validation error 14.900000 %
epoch 109, minibatch 300/300, validation error 14.900000 %
epoch 110, minibatch 300/300, validation error 14.900000 %
epoch 111, minibatch 300/300, validation error 14.900000 %
epoch 112, minibatch 300/300, validation error 14.900000 %
epoch 113, minibatch 300/300, validation error 14.900000 %
epoch 114, minibatch 300/300, validation error 14.900000 %
epoch 115, minibatch 300/300, validation error 14.900000 %
epoch 116, minibatch 300/300, validation error 14.900000 %
epoch 117, minibatch 300/300, validation error 14.900000 %
epoch 118, minibatch 300/300, validation error 14.900000 %
epoch 119, minibatch 300/300, validation error 14.900000 %
epoch 120, minibatch 300/300, validation error 14.900000 %
epoch 121, minibatch 300/300, validation error 14.900000 %
epoch 122, minibatch 300/300, validation error 14.900000 %
epoch 123, minibatch 300/300, validation error 14.900000 %
epoch 124, minibatch 300/300, validation error 14.900000 %
epoch 125, minibatch 300/300, validation error 14.900000 %
epoch 126, minibatch 300/300, validation error 14.900000 %
epoch 127, minibatch 300/300, validation error 14.900000 %
epoch 128, minibatch 300/300, validation error 14.900000 %
epoch 129, minibatch 300/300, validation error 14.900000 %
epoch 130, minibatch 300/300, validation error 14.900000 %
epoch 131, minibatch 300/300, validation error 14.900000 %
epoch 132, minibatch 300/300, validation error 14.900000 %
epoch 133, minibatch 300/300, validation error 14.900000 %
epoch 134, minibatch 300/300, validation error 14.900000 %
epoch 135, minibatch 300/300, validation error 14.900000 %
epoch 136, minibatch 300/300, validation error 14.900000 %
epoch 137, minibatch 300/300, validation error 14.900000 %
epoch 138, minibatch 300/300, validation error 14.900000 %
epoch 139, minibatch 300/300, validation error 14.900000 %
epoch 140, minibatch 300/300, validation error 14.900000 %
epoch 141, minibatch 300/300, validation error 14.900000 %
epoch 142, minibatch 300/300, validation error 14.900000 %
epoch 143, minibatch 300/300, validation error 14.900000 %
epoch 144, minibatch 300/300, validation error 14.900000 %
epoch 145, minibatch 300/300, validation error 14.900000 %
epoch 146, minibatch 300/300, validation error 14.900000 %
epoch 147, minibatch 300/300, validation error 14.900000 %
epoch 148, minibatch 300/300, validation error 14.900000 %
epoch 149, minibatch 300/300, validation error 14.900000 %
epoch 150, minibatch 300/300, validation error 14.900000 %
epoch 151, minibatch 300/300, validation error 14.900000 %
epoch 152, minibatch 300/300, validation error 14.900000 %
epoch 153, minibatch 300/300, validation error 14.900000 %
epoch 154, minibatch 300/300, validation error 14.900000 %
epoch 155, minibatch 300/300, validation error 14.900000 %
epoch 156, minibatch 300/300, validation error 14.900000 %
epoch 157, minibatch 300/300, validation error 14.900000 %
Optimization complete with best validation score of 14.900000 %, obtained at iteration 23700, with test performance 6.300000 %
The fine tuning code for file dbn_loop.pyc ran for 4.17m


==========Sample: (4000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.261316547
Pre-training layer 0, epoch 0, representative training free energy -553.847516144
Pre-training layer 0, epoch 0, validation free energy -551.71181546
Pre-training layer 0, epoch 1, cost -111.973196888
Pre-training layer 0, epoch 2, cost -103.718683586
Pre-training layer 0, epoch 3, cost -99.2387199402
Pre-training layer 0, epoch 4, cost -95.8383654022
Pre-training layer 0, epoch 5, cost -93.5581045723
Pre-training layer 0, epoch 5, representative training free energy -489.527354218
Pre-training layer 0, epoch 5, validation free energy -484.578970184
Pre-training layer 0, epoch 6, cost -91.6140400124
Pre-training layer 0, epoch 7, cost -89.996622467
Pre-training layer 0, epoch 8, cost -88.9590029907
Pre-training layer 0, epoch 9, cost -87.8413234138
Pre-training layer 0, epoch 10, cost -86.7593445206
Pre-training layer 0, epoch 10, representative training free energy -472.911444122
Pre-training layer 0, epoch 10, validation free energy -467.465308014
Pre-training layer 0, epoch 11, cost -86.1053066635
Pre-training layer 0, epoch 12, cost -85.4592906284
Pre-training layer 0, epoch 13, cost -84.7946387768
Pre-training layer 0, epoch 14, cost -84.1261402321
Pre-training layer 0, epoch 15, cost -83.5866363239
Pre-training layer 0, epoch 15, representative training free energy -458.589770325
Pre-training layer 0, epoch 15, validation free energy -452.474223541
Pre-training layer 0, epoch 16, cost -83.2996693993
Pre-training layer 0, epoch 17, cost -82.6295613384
Pre-training layer 0, epoch 18, cost -82.2382742405
Pre-training layer 0, epoch 19, cost -81.9440126705
Pre-training layer 0, epoch 20, cost -81.5543259716
Pre-training layer 0, epoch 20, representative training free energy -450.309105835
Pre-training layer 0, epoch 20, validation free energy -443.581734528
Pre-training layer 0, epoch 21, cost -81.2070101452
Pre-training layer 0, epoch 22, cost -80.9162811756
Pre-training layer 0, epoch 23, cost -80.6124417591
Pre-training layer 0, epoch 24, cost -80.3494044018
Pre-training layer 0, epoch 25, cost -80.1806690407
Pre-training layer 0, epoch 25, representative training free energy -445.840151794
Pre-training layer 0, epoch 25, validation free energy -438.897064301
Pre-training layer 0, epoch 26, cost -79.8535656357
Pre-training layer 0, epoch 27, cost -79.5811714363
Pre-training layer 0, epoch 28, cost -79.510094738
Pre-training layer 0, epoch 29, cost -79.2158857727
Pre-training layer 0, epoch 30, cost -79.0615365601
Pre-training layer 0, epoch 30, representative training free energy -441.877496216
Pre-training layer 0, epoch 30, validation free energy -434.518127228
Pre-training layer 0, epoch 31, cost -78.8779769707
Pre-training layer 0, epoch 32, cost -78.59987813
Pre-training layer 0, epoch 33, cost -78.3765442085
Pre-training layer 0, epoch 34, cost -78.2588712597
Pre-training layer 0, epoch 35, cost -78.1364496326
Pre-training layer 0, epoch 35, representative training free energy -434.7775914
Pre-training layer 0, epoch 35, validation free energy -427.431717773
Pre-training layer 0, epoch 36, cost -77.8743243027
Pre-training layer 0, epoch 37, cost -77.9712791634
Pre-training layer 0, epoch 38, cost -77.6334303761
Pre-training layer 0, epoch 39, cost -77.6734483624
Pre-training layer 0, epoch 40, cost -77.3036096096
Pre-training layer 0, epoch 40, representative training free energy -435.698037079
Pre-training layer 0, epoch 40, validation free energy -428.017292969
Pre-training layer 0, epoch 41, cost -77.3213710499
Pre-training layer 0, epoch 42, cost -77.1395324707
Pre-training layer 0, epoch 43, cost -76.9712255287
Pre-training layer 0, epoch 44, cost -76.8407084751
Pre-training layer 0, epoch 45, cost -76.8007779026
Pre-training layer 0, epoch 45, representative training free energy -434.785118378
Pre-training layer 0, epoch 45, validation free energy -426.972460632
Pre-training layer 0, epoch 46, cost -76.598250618
Pre-training layer 0, epoch 47, cost -76.4652150154
Pre-training layer 0, epoch 48, cost -76.2720633221
Pre-training layer 0, epoch 49, cost -76.3510362148
Pre-training layer 0, epoch 50, cost -76.2081858349
Pre-training layer 0, epoch 50, representative training free energy -428.766828491
Pre-training layer 0, epoch 50, validation free energy -420.890860443
Pre-training layer 0, epoch 51, cost -76.1773554707
Pre-training layer 0, epoch 52, cost -75.9974338722
Pre-training layer 0, epoch 53, cost -75.9579834461
Pre-training layer 0, epoch 54, cost -75.7549869251
Pre-training layer 0, epoch 55, cost -75.82323596
Pre-training layer 0, epoch 55, representative training free energy -429.703393951
Pre-training layer 0, epoch 55, validation free energy -421.536912292
Pre-training layer 0, epoch 56, cost -75.605863266
Pre-training layer 0, epoch 57, cost -75.6034762287
Pre-training layer 0, epoch 58, cost -75.409569025
Pre-training layer 0, epoch 59, cost -75.374104681
Pre-training layer 0, epoch 60, cost -75.1261416245
Pre-training layer 0, epoch 60, representative training free energy -424.793103607
Pre-training layer 0, epoch 60, validation free energy -415.961016571
Pre-training layer 0, epoch 61, cost -75.3427992439
Pre-training layer 0, epoch 62, cost -75.1250433826
Pre-training layer 0, epoch 63, cost -75.0303851223
Pre-training layer 0, epoch 64, cost -75.0530463219
Pre-training layer 0, epoch 65, cost -74.8849571896
Pre-training layer 0, epoch 65, representative training free energy -425.920115631
Pre-training layer 0, epoch 65, validation free energy -416.405771088
Pre-training layer 0, epoch 66, cost -74.8008089542
Pre-training layer 0, epoch 67, cost -74.7561558437
Pre-training layer 0, epoch 68, cost -74.6120120907
Pre-training layer 0, epoch 69, cost -74.4748384094
Pre-training layer 0, epoch 70, cost -74.5239454079
Pre-training layer 0, epoch 70, representative training free energy -424.212270569
Pre-training layer 0, epoch 70, validation free energy -415.644190918
Pre-training layer 0, epoch 71, cost -74.4801352119
Pre-training layer 0, epoch 72, cost -74.3240413284
Pre-training layer 0, epoch 73, cost -74.3504069996
Pre-training layer 0, epoch 74, cost -74.3026619911
Pre-training layer 0, epoch 75, cost -74.1700296974
Pre-training layer 0, epoch 75, representative training free energy -423.115301514
Pre-training layer 0, epoch 75, validation free energy -415.089774017
Pre-training layer 0, epoch 76, cost -74.1371266174
Pre-training layer 0, epoch 77, cost -74.1112485027
Pre-training layer 0, epoch 78, cost -73.937584095
Pre-training layer 0, epoch 79, cost -73.9051934719
Pre-training layer 0, epoch 80, cost -73.8635866928
Pre-training layer 0, epoch 80, representative training free energy -422.011040985
Pre-training layer 0, epoch 80, validation free energy -413.513204163
Pre-training layer 0, epoch 81, cost -73.8468431854
Pre-training layer 0, epoch 82, cost -73.8294429493
Pre-training layer 0, epoch 83, cost -73.8669258595
Pre-training layer 0, epoch 84, cost -73.6467947292
Pre-training layer 0, epoch 85, cost -73.5436523342
Pre-training layer 0, epoch 85, representative training free energy -420.032388245
Pre-training layer 0, epoch 85, validation free energy -410.855392151
Pre-training layer 0, epoch 86, cost -73.5760253048
Pre-training layer 0, epoch 87, cost -73.513231144
Pre-training layer 0, epoch 88, cost -73.4830674458
Pre-training layer 0, epoch 89, cost -73.5034046745
Pre-training layer 0, epoch 90, cost -73.3432155323
Pre-training layer 0, epoch 90, representative training free energy -421.403133972
Pre-training layer 0, epoch 90, validation free energy -412.039213379
Pre-training layer 0, epoch 91, cost -73.3079241943
Pre-training layer 0, epoch 92, cost -73.2875682545
Pre-training layer 0, epoch 93, cost -73.3468957424
Pre-training layer 0, epoch 94, cost -73.2992468166
Pre-training layer 0, epoch 95, cost -73.0889192963
Pre-training layer 0, epoch 95, representative training free energy -422.259702759
Pre-training layer 0, epoch 95, validation free energy -413.449886597
Pre-training layer 0, epoch 96, cost -73.1203551197
Pre-training layer 0, epoch 97, cost -73.0932272625
Pre-training layer 0, epoch 98, cost -73.0929371452
Pre-training layer 0, epoch 99, cost -72.8922386932
Pre-training layer 1, epoch 0, cost -324.08875946
Pre-training layer 1, epoch 0, representative training free energy -57776.0460742
Pre-training layer 1, epoch 0, validation free energy -57337.7170957
Pre-training layer 1, epoch 1, cost -278.668570251
Pre-training layer 1, epoch 2, cost -264.793801308
Pre-training layer 1, epoch 3, cost -256.470345993
Pre-training layer 1, epoch 4, cost -250.794484978
Pre-training layer 1, epoch 5, cost -246.611695366
Pre-training layer 1, epoch 5, representative training free energy -77456.3757695
Pre-training layer 1, epoch 5, validation free energy -76811.0016621
Pre-training layer 1, epoch 6, cost -243.339646606
Pre-training layer 1, epoch 7, cost -240.874183884
Pre-training layer 1, epoch 8, cost -238.732372665
Pre-training layer 1, epoch 9, cost -237.027057991
Pre-training layer 1, epoch 10, cost -235.448991547
Pre-training layer 1, epoch 10, representative training free energy -83345.6298301
Pre-training layer 1, epoch 10, validation free energy -82633.6877363
Pre-training layer 1, epoch 11, cost -234.240000114
Pre-training layer 1, epoch 12, cost -233.01036026
Pre-training layer 1, epoch 13, cost -231.990336266
Pre-training layer 1, epoch 14, cost -231.241098061
Pre-training layer 1, epoch 15, cost -230.355682602
Pre-training layer 1, epoch 15, representative training free energy -86890.3494473
Pre-training layer 1, epoch 15, validation free energy -86133.2789375
Pre-training layer 1, epoch 16, cost -229.640278435
Pre-training layer 1, epoch 17, cost -228.944713478
Pre-training layer 1, epoch 18, cost -228.294025154
Pre-training layer 1, epoch 19, cost -227.685071068
Pre-training layer 1, epoch 20, cost -227.144337845
Pre-training layer 1, epoch 20, representative training free energy -89350.5601172
Pre-training layer 1, epoch 20, validation free energy -88575.3038711
Pre-training layer 1, epoch 21, cost -226.752667389
Pre-training layer 1, epoch 22, cost -226.278344193
Pre-training layer 1, epoch 23, cost -225.85945755
Pre-training layer 1, epoch 24, cost -225.465170822
Pre-training layer 1, epoch 25, cost -225.183818512
Pre-training layer 1, epoch 25, representative training free energy -91261.5505215
Pre-training layer 1, epoch 25, validation free energy -90453.9899063
Pre-training layer 1, epoch 26, cost -224.772116356
Pre-training layer 1, epoch 27, cost -224.386814995
Pre-training layer 1, epoch 28, cost -224.109838829
Pre-training layer 1, epoch 29, cost -223.804209518
Pre-training layer 1, epoch 30, cost -223.431868134
Pre-training layer 1, epoch 30, representative training free energy -92874.7415625
Pre-training layer 1, epoch 30, validation free energy -92060.435543
Pre-training layer 1, epoch 31, cost -223.265359344
Pre-training layer 1, epoch 32, cost -222.984812508
Pre-training layer 1, epoch 33, cost -222.785802612
Pre-training layer 1, epoch 34, cost -222.426506348
Pre-training layer 1, epoch 35, cost -222.310316963
Pre-training layer 1, epoch 35, representative training free energy -94186.7635215
Pre-training layer 1, epoch 35, validation free energy -93359.9572109
Pre-training layer 1, epoch 36, cost -221.957097168
Pre-training layer 1, epoch 37, cost -221.827639198
Pre-training layer 1, epoch 38, cost -221.524901581
Pre-training layer 1, epoch 39, cost -221.412027435
Pre-training layer 1, epoch 40, cost -221.261257553
Pre-training layer 1, epoch 40, representative training free energy -95341.6899258
Pre-training layer 1, epoch 40, validation free energy -94491.9087637
Pre-training layer 1, epoch 41, cost -221.056692314
Pre-training layer 1, epoch 42, cost -220.946863136
Pre-training layer 1, epoch 43, cost -220.739997635
Pre-training layer 1, epoch 44, cost -220.474144363
Pre-training layer 1, epoch 45, cost -220.438010368
Pre-training layer 1, epoch 45, representative training free energy -96461.2542168
Pre-training layer 1, epoch 45, validation free energy -95618.3321309
Pre-training layer 1, epoch 46, cost -220.287846336
Pre-training layer 1, epoch 47, cost -220.160233116
Pre-training layer 1, epoch 48, cost -220.02758316
Pre-training layer 1, epoch 49, cost -219.865421791
Pre-training layer 1, epoch 50, cost -219.601678734
Pre-training layer 1, epoch 50, representative training free energy -97482.6781543
Pre-training layer 1, epoch 50, validation free energy -96614.7900684
Pre-training layer 1, epoch 51, cost -219.649720154
Pre-training layer 1, epoch 52, cost -219.379523964
Pre-training layer 1, epoch 53, cost -219.312135849
Pre-training layer 1, epoch 54, cost -219.207116432
Pre-training layer 1, epoch 55, cost -219.128431816
Pre-training layer 1, epoch 55, representative training free energy -98346.3914082
Pre-training layer 1, epoch 55, validation free energy -97464.6732832
Pre-training layer 1, epoch 56, cost -219.046749077
Pre-training layer 1, epoch 57, cost -218.944817657
Pre-training layer 1, epoch 58, cost -218.748356552
Pre-training layer 1, epoch 59, cost -218.660398293
Pre-training layer 1, epoch 60, cost -218.611698112
Pre-training layer 1, epoch 60, representative training free energy -99269.5246133
Pre-training layer 1, epoch 60, validation free energy -98375.3949297
Pre-training layer 1, epoch 61, cost -218.438731842
Pre-training layer 1, epoch 62, cost -218.30407238
Pre-training layer 1, epoch 63, cost -218.26605278
Pre-training layer 1, epoch 64, cost -218.165079918
Pre-training layer 1, epoch 65, cost -218.095307808
Pre-training layer 1, epoch 65, representative training free energy -100072.385109
Pre-training layer 1, epoch 65, validation free energy -99172.9800879
Pre-training layer 1, epoch 66, cost -218.049749413
Pre-training layer 1, epoch 67, cost -217.946809349
Pre-training layer 1, epoch 68, cost -217.855079918
Pre-training layer 1, epoch 69, cost -217.846412697
Pre-training layer 1, epoch 70, cost -217.700772667
Pre-training layer 1, epoch 70, representative training free energy -100816.173785
Pre-training layer 1, epoch 70, validation free energy -99902.4119707
Pre-training layer 1, epoch 71, cost -217.605529442
Pre-training layer 1, epoch 72, cost -217.531646652
Pre-training layer 1, epoch 73, cost -217.393312759
Pre-training layer 1, epoch 74, cost -217.443299561
Pre-training layer 1, epoch 75, cost -217.280473175
Pre-training layer 1, epoch 75, representative training free energy -101324.960361
Pre-training layer 1, epoch 75, validation free energy -100405.486777
Pre-training layer 1, epoch 76, cost -217.217000351
Pre-training layer 1, epoch 77, cost -217.142387695
Pre-training layer 1, epoch 78, cost -217.091756401
Pre-training layer 1, epoch 79, cost -217.01366375
Pre-training layer 1, epoch 80, cost -217.04819809
Pre-training layer 1, epoch 80, representative training free energy -102102.375793
Pre-training layer 1, epoch 80, validation free energy -101195.223828
Pre-training layer 1, epoch 81, cost -216.913862724
Pre-training layer 1, epoch 82, cost -216.879191399
Pre-training layer 1, epoch 83, cost -216.71358902
Pre-training layer 1, epoch 84, cost -216.70821888
Pre-training layer 1, epoch 85, cost -216.675324287
Pre-training layer 1, epoch 85, representative training free energy -102613.897848
Pre-training layer 1, epoch 85, validation free energy -101686.399867
Pre-training layer 1, epoch 86, cost -216.571544952
Pre-training layer 1, epoch 87, cost -216.600640984
Pre-training layer 1, epoch 88, cost -216.497668228
Pre-training layer 1, epoch 89, cost -216.526509895
Pre-training layer 1, epoch 90, cost -216.331927528
Pre-training layer 1, epoch 90, representative training free energy -103294.059771
Pre-training layer 1, epoch 90, validation free energy -102358.755566
Pre-training layer 1, epoch 91, cost -216.392754631
Pre-training layer 1, epoch 92, cost -216.284838753
Pre-training layer 1, epoch 93, cost -216.201081543
Pre-training layer 1, epoch 94, cost -216.229608421
Pre-training layer 1, epoch 95, cost -216.101889305
Pre-training layer 1, epoch 95, representative training free energy -103864.167639
Pre-training layer 1, epoch 95, validation free energy -102922.811098
Pre-training layer 1, epoch 96, cost -216.099211731
Pre-training layer 1, epoch 97, cost -216.014710464
Pre-training layer 1, epoch 98, cost -215.969879684
Pre-training layer 1, epoch 99, cost -215.924071884
Pre-training layer 2, epoch 0, cost -120.823599968
Pre-training layer 2, epoch 0, representative training free energy 3476.81718274
Pre-training layer 2, epoch 0, validation free energy 3437.91193079
Pre-training layer 2, epoch 1, cost -90.5055667019
Pre-training layer 2, epoch 2, cost -83.7857876301
Pre-training layer 2, epoch 3, cost -79.9956508255
Pre-training layer 2, epoch 4, cost -77.4872290516
Pre-training layer 2, epoch 5, cost -75.5157976532
Pre-training layer 2, epoch 5, representative training free energy 5879.31916675
Pre-training layer 2, epoch 5, validation free energy 5821.95471582
Pre-training layer 2, epoch 6, cost -74.144100275
Pre-training layer 2, epoch 7, cost -72.9728348255
Pre-training layer 2, epoch 8, cost -71.9571520805
Pre-training layer 2, epoch 9, cost -71.2044467068
Pre-training layer 2, epoch 10, cost -70.4387558174
Pre-training layer 2, epoch 10, representative training free energy 7062.35413281
Pre-training layer 2, epoch 10, validation free energy 6998.33134741
Pre-training layer 2, epoch 11, cost -69.9036623287
Pre-training layer 2, epoch 12, cost -69.4562689877
Pre-training layer 2, epoch 13, cost -68.9241380692
Pre-training layer 2, epoch 14, cost -68.4714133549
Pre-training layer 2, epoch 15, cost -68.1520451355
Pre-training layer 2, epoch 15, representative training free energy 7896.35155298
Pre-training layer 2, epoch 15, validation free energy 7826.89030078
Pre-training layer 2, epoch 16, cost -67.8412331867
Pre-training layer 2, epoch 17, cost -67.4637072277
Pre-training layer 2, epoch 18, cost -67.2299428558
Pre-training layer 2, epoch 19, cost -66.9023536682
Pre-training layer 2, epoch 20, cost -66.7807647419
Pre-training layer 2, epoch 20, representative training free energy 8602.49427344
Pre-training layer 2, epoch 20, validation free energy 8526.93666504
Pre-training layer 2, epoch 21, cost -66.4924292183
Pre-training layer 2, epoch 22, cost -66.2309943962
Pre-training layer 2, epoch 23, cost -66.0760858536
Pre-training layer 2, epoch 24, cost -65.8748191357
Pre-training layer 2, epoch 25, cost -65.6998169231
Pre-training layer 2, epoch 25, representative training free energy 9212.1309519
Pre-training layer 2, epoch 25, validation free energy 9135.41348706
Pre-training layer 2, epoch 26, cost -65.5676131248
Pre-training layer 2, epoch 27, cost -65.3962346935
Pre-training layer 2, epoch 28, cost -65.241241951
Pre-training layer 2, epoch 29, cost -65.0948503685
Pre-training layer 2, epoch 30, cost -65.0827148437
Pre-training layer 2, epoch 30, representative training free energy 9755.60799854
Pre-training layer 2, epoch 30, validation free energy 9673.2451499
Pre-training layer 2, epoch 31, cost -64.9327931404
Pre-training layer 2, epoch 32, cost -64.7612064552
Pre-training layer 2, epoch 33, cost -64.6423085213
Pre-training layer 2, epoch 34, cost -64.6087940979
Pre-training layer 2, epoch 35, cost -64.5513079739
Pre-training layer 2, epoch 35, representative training free energy 10212.8676211
Pre-training layer 2, epoch 35, validation free energy 10131.8866135
Pre-training layer 2, epoch 36, cost -64.4502485657
Pre-training layer 2, epoch 37, cost -64.2833603287
Pre-training layer 2, epoch 38, cost -64.1774749756
Pre-training layer 2, epoch 39, cost -64.1791326523
Pre-training layer 2, epoch 40, cost -63.9678552818
Pre-training layer 2, epoch 40, representative training free energy 10622.4633423
Pre-training layer 2, epoch 40, validation free energy 10538.1561802
Pre-training layer 2, epoch 41, cost -64.0414822006
Pre-training layer 2, epoch 42, cost -63.9347309113
Pre-training layer 2, epoch 43, cost -63.9161303616
Pre-training layer 2, epoch 44, cost -63.7378460789
Pre-training layer 2, epoch 45, cost -63.7473926926
Pre-training layer 2, epoch 45, representative training free energy 10992.1179844
Pre-training layer 2, epoch 45, validation free energy 10904.5634524
Pre-training layer 2, epoch 46, cost -63.6942529583
Pre-training layer 2, epoch 47, cost -63.6077673912
Pre-training layer 2, epoch 48, cost -63.6010086727
Pre-training layer 2, epoch 49, cost -63.4913993645
Pre-training layer 2, epoch 50, cost -63.4111435699
Pre-training layer 2, epoch 50, representative training free energy 11401.9650264
Pre-training layer 2, epoch 50, validation free energy 11307.5062976
Pre-training layer 2, epoch 51, cost -63.3985236168
Pre-training layer 2, epoch 52, cost -63.3264535999
Pre-training layer 2, epoch 53, cost -63.2360147476
Pre-training layer 2, epoch 54, cost -63.2056769371
Pre-training layer 2, epoch 55, cost -63.1729076576
Pre-training layer 2, epoch 55, representative training free energy 11717.9775662
Pre-training layer 2, epoch 55, validation free energy 11619.180687
Pre-training layer 2, epoch 56, cost -63.1038373184
Pre-training layer 2, epoch 57, cost -63.0471905804
Pre-training layer 2, epoch 58, cost -63.0476261997
Pre-training layer 2, epoch 59, cost -63.0334002113
Pre-training layer 2, epoch 60, cost -62.9114883518
Pre-training layer 2, epoch 60, representative training free energy 12085.3641235
Pre-training layer 2, epoch 60, validation free energy 11979.5900491
Pre-training layer 2, epoch 61, cost -62.9193045139
Pre-training layer 2, epoch 62, cost -62.8911105061
Pre-training layer 2, epoch 63, cost -62.8651338005
Pre-training layer 2, epoch 64, cost -62.7827106857
Pre-training layer 2, epoch 65, cost -62.6911888504
Pre-training layer 2, epoch 65, representative training free energy 12416.9715266
Pre-training layer 2, epoch 65, validation free energy 12305.8903054
Pre-training layer 2, epoch 66, cost -62.7013514805
Pre-training layer 2, epoch 67, cost -62.68638731
Pre-training layer 2, epoch 68, cost -62.6658575249
Pre-training layer 2, epoch 69, cost -62.6358293533
Pre-training layer 2, epoch 70, cost -62.649715414
Pre-training layer 2, epoch 70, representative training free energy 12693.2682646
Pre-training layer 2, epoch 70, validation free energy 12585.2532983
Pre-training layer 2, epoch 71, cost -62.5327724171
Pre-training layer 2, epoch 72, cost -62.5323641586
Pre-training layer 2, epoch 73, cost -62.4320549107
Pre-training layer 2, epoch 74, cost -62.5048268604
Pre-training layer 2, epoch 75, cost -62.4477909088
Pre-training layer 2, epoch 75, representative training free energy 12964.5395996
Pre-training layer 2, epoch 75, validation free energy 12853.741957
Pre-training layer 2, epoch 76, cost -62.4718539333
Pre-training layer 2, epoch 77, cost -62.4193925381
Pre-training layer 2, epoch 78, cost -62.3417586327
Pre-training layer 2, epoch 79, cost -62.2824080658
Pre-training layer 2, epoch 80, cost -62.3790014839
Pre-training layer 2, epoch 80, representative training free energy 13253.5802437
Pre-training layer 2, epoch 80, validation free energy 13140.5314927
Pre-training layer 2, epoch 81, cost -62.2814145279
Pre-training layer 2, epoch 82, cost -62.2499928474
Pre-training layer 2, epoch 83, cost -62.2350918102
Pre-training layer 2, epoch 84, cost -62.2509306049
Pre-training layer 2, epoch 85, cost -62.1067792511
Pre-training layer 2, epoch 85, representative training free energy 13519.9944678
Pre-training layer 2, epoch 85, validation free energy 13401.761395
Pre-training layer 2, epoch 86, cost -62.1601165485
Pre-training layer 2, epoch 87, cost -62.1973551178
Pre-training layer 2, epoch 88, cost -62.1636407661
Pre-training layer 2, epoch 89, cost -62.0901886654
Pre-training layer 2, epoch 90, cost -62.0733066082
Pre-training layer 2, epoch 90, representative training free energy 13764.6298057
Pre-training layer 2, epoch 90, validation free energy 13644.4791006
Pre-training layer 2, epoch 91, cost -62.0403974724
Pre-training layer 2, epoch 92, cost -61.9909717751
Pre-training layer 2, epoch 93, cost -61.9627800274
Pre-training layer 2, epoch 94, cost -61.9477834606
Pre-training layer 2, epoch 95, cost -61.9847047901
Pre-training layer 2, epoch 95, representative training free energy 14028.0912803
Pre-training layer 2, epoch 95, validation free energy 13906.9147002
Pre-training layer 2, epoch 96, cost -61.8693116188
Pre-training layer 2, epoch 97, cost -61.8993722916
Pre-training layer 2, epoch 98, cost -61.8754898834
Pre-training layer 2, epoch 99, cost -61.9412511063
The pretraining code for file dbn_loop.pyc ran for 10.47m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 34.700000 %
     epoch 1, minibatch 400/400, test error of best model 28.600000 %
epoch 2, minibatch 400/400, validation error 24.700000 %
     epoch 2, minibatch 400/400, test error of best model 16.500000 %
epoch 3, minibatch 400/400, validation error 22.400000 %
     epoch 3, minibatch 400/400, test error of best model 12.700000 %
epoch 4, minibatch 400/400, validation error 20.400000 %
     epoch 4, minibatch 400/400, test error of best model 10.700000 %
epoch 5, minibatch 400/400, validation error 19.200000 %
     epoch 5, minibatch 400/400, test error of best model 10.200000 %
epoch 6, minibatch 400/400, validation error 18.300000 %
     epoch 6, minibatch 400/400, test error of best model 9.200000 %
epoch 7, minibatch 400/400, validation error 17.800000 %
     epoch 7, minibatch 400/400, test error of best model 8.500000 %
epoch 8, minibatch 400/400, validation error 17.400000 %
     epoch 8, minibatch 400/400, test error of best model 8.200000 %
epoch 9, minibatch 400/400, validation error 16.900000 %
     epoch 9, minibatch 400/400, test error of best model 8.200000 %
epoch 10, minibatch 400/400, validation error 16.300000 %
     epoch 10, minibatch 400/400, test error of best model 7.700000 %
epoch 11, minibatch 400/400, validation error 16.100000 %
     epoch 11, minibatch 400/400, test error of best model 7.400000 %
epoch 12, minibatch 400/400, validation error 15.900000 %
     epoch 12, minibatch 400/400, test error of best model 7.000000 %
epoch 13, minibatch 400/400, validation error 15.800000 %
     epoch 13, minibatch 400/400, test error of best model 6.800000 %
epoch 14, minibatch 400/400, validation error 15.700000 %
     epoch 14, minibatch 400/400, test error of best model 6.800000 %
epoch 15, minibatch 400/400, validation error 15.700000 %
epoch 16, minibatch 400/400, validation error 15.700000 %
epoch 17, minibatch 400/400, validation error 15.600000 %
     epoch 17, minibatch 400/400, test error of best model 6.600000 %
epoch 18, minibatch 400/400, validation error 15.500000 %
     epoch 18, minibatch 400/400, test error of best model 6.500000 %
epoch 19, minibatch 400/400, validation error 15.500000 %
epoch 20, minibatch 400/400, validation error 15.400000 %
     epoch 20, minibatch 400/400, test error of best model 6.400000 %
epoch 21, minibatch 400/400, validation error 15.300000 %
     epoch 21, minibatch 400/400, test error of best model 6.400000 %
epoch 22, minibatch 400/400, validation error 15.200000 %
     epoch 22, minibatch 400/400, test error of best model 6.100000 %
epoch 23, minibatch 400/400, validation error 15.100000 %
     epoch 23, minibatch 400/400, test error of best model 6.000000 %
epoch 24, minibatch 400/400, validation error 15.100000 %
epoch 25, minibatch 400/400, validation error 15.100000 %
epoch 26, minibatch 400/400, validation error 15.200000 %
epoch 27, minibatch 400/400, validation error 15.200000 %
epoch 28, minibatch 400/400, validation error 15.200000 %
epoch 29, minibatch 400/400, validation error 15.300000 %
epoch 30, minibatch 400/400, validation error 15.300000 %
epoch 31, minibatch 400/400, validation error 15.200000 %
epoch 32, minibatch 400/400, validation error 15.200000 %
epoch 33, minibatch 400/400, validation error 15.200000 %
epoch 34, minibatch 400/400, validation error 15.200000 %
epoch 35, minibatch 400/400, validation error 15.100000 %
epoch 36, minibatch 400/400, validation error 15.000000 %
     epoch 36, minibatch 400/400, test error of best model 6.000000 %
epoch 37, minibatch 400/400, validation error 15.000000 %
epoch 38, minibatch 400/400, validation error 15.000000 %
epoch 39, minibatch 400/400, validation error 15.000000 %
epoch 40, minibatch 400/400, validation error 15.100000 %
epoch 41, minibatch 400/400, validation error 15.100000 %
epoch 42, minibatch 400/400, validation error 15.100000 %
epoch 43, minibatch 400/400, validation error 15.100000 %
epoch 44, minibatch 400/400, validation error 15.100000 %
epoch 45, minibatch 400/400, validation error 15.200000 %
epoch 46, minibatch 400/400, validation error 15.100000 %
epoch 47, minibatch 400/400, validation error 15.100000 %
epoch 48, minibatch 400/400, validation error 15.100000 %
epoch 49, minibatch 400/400, validation error 15.100000 %
epoch 50, minibatch 400/400, validation error 15.100000 %
epoch 51, minibatch 400/400, validation error 15.100000 %
epoch 52, minibatch 400/400, validation error 15.100000 %
epoch 53, minibatch 400/400, validation error 15.100000 %
epoch 54, minibatch 400/400, validation error 15.100000 %
epoch 55, minibatch 400/400, validation error 15.100000 %
epoch 56, minibatch 400/400, validation error 15.100000 %
epoch 57, minibatch 400/400, validation error 15.100000 %
epoch 58, minibatch 400/400, validation error 15.100000 %
epoch 59, minibatch 400/400, validation error 15.000000 %
epoch 60, minibatch 400/400, validation error 15.000000 %
epoch 61, minibatch 400/400, validation error 14.900000 %
     epoch 61, minibatch 400/400, test error of best model 6.000000 %
epoch 62, minibatch 400/400, validation error 14.900000 %
epoch 63, minibatch 400/400, validation error 14.900000 %
epoch 64, minibatch 400/400, validation error 14.900000 %
epoch 65, minibatch 400/400, validation error 14.900000 %
epoch 66, minibatch 400/400, validation error 14.900000 %
epoch 67, minibatch 400/400, validation error 14.900000 %
epoch 68, minibatch 400/400, validation error 14.900000 %
epoch 69, minibatch 400/400, validation error 14.900000 %
epoch 70, minibatch 400/400, validation error 14.900000 %
epoch 71, minibatch 400/400, validation error 15.000000 %
epoch 72, minibatch 400/400, validation error 15.000000 %
epoch 73, minibatch 400/400, validation error 15.000000 %
epoch 74, minibatch 400/400, validation error 15.000000 %
epoch 75, minibatch 400/400, validation error 15.000000 %
epoch 76, minibatch 400/400, validation error 15.000000 %
epoch 77, minibatch 400/400, validation error 15.000000 %
epoch 78, minibatch 400/400, validation error 15.000000 %
epoch 79, minibatch 400/400, validation error 15.000000 %
epoch 80, minibatch 400/400, validation error 15.000000 %
epoch 81, minibatch 400/400, validation error 15.000000 %
epoch 82, minibatch 400/400, validation error 15.000000 %
epoch 83, minibatch 400/400, validation error 15.000000 %
epoch 84, minibatch 400/400, validation error 15.000000 %
epoch 85, minibatch 400/400, validation error 15.000000 %
epoch 86, minibatch 400/400, validation error 15.000000 %
epoch 87, minibatch 400/400, validation error 15.000000 %
epoch 88, minibatch 400/400, validation error 15.000000 %
epoch 89, minibatch 400/400, validation error 15.000000 %
epoch 90, minibatch 400/400, validation error 15.000000 %
epoch 91, minibatch 400/400, validation error 15.000000 %
epoch 92, minibatch 400/400, validation error 15.000000 %
epoch 93, minibatch 400/400, validation error 15.000000 %
epoch 94, minibatch 400/400, validation error 15.000000 %
epoch 95, minibatch 400/400, validation error 15.000000 %
epoch 96, minibatch 400/400, validation error 15.000000 %
epoch 97, minibatch 400/400, validation error 15.000000 %
epoch 98, minibatch 400/400, validation error 15.000000 %
epoch 99, minibatch 400/400, validation error 15.000000 %
epoch 100, minibatch 400/400, validation error 15.000000 %
epoch 101, minibatch 400/400, validation error 15.000000 %
epoch 102, minibatch 400/400, validation error 15.000000 %
epoch 103, minibatch 400/400, validation error 15.000000 %
epoch 104, minibatch 400/400, validation error 15.000000 %
epoch 105, minibatch 400/400, validation error 15.000000 %
epoch 106, minibatch 400/400, validation error 15.000000 %
epoch 107, minibatch 400/400, validation error 15.000000 %
epoch 108, minibatch 400/400, validation error 15.000000 %
epoch 109, minibatch 400/400, validation error 15.000000 %
epoch 110, minibatch 400/400, validation error 15.000000 %
epoch 111, minibatch 400/400, validation error 15.000000 %
epoch 112, minibatch 400/400, validation error 15.000000 %
epoch 113, minibatch 400/400, validation error 15.000000 %
epoch 114, minibatch 400/400, validation error 15.000000 %
epoch 115, minibatch 400/400, validation error 15.000000 %
epoch 116, minibatch 400/400, validation error 15.000000 %
epoch 117, minibatch 400/400, validation error 15.000000 %
epoch 118, minibatch 400/400, validation error 15.000000 %
epoch 119, minibatch 400/400, validation error 15.000000 %
epoch 120, minibatch 400/400, validation error 15.000000 %
epoch 121, minibatch 400/400, validation error 15.000000 %
Optimization complete with best validation score of 14.900000 %, obtained at iteration 24400, with test performance 6.000000 %
The fine tuning code for file dbn_loop.pyc ran for 4.10m


==========Sample: (5000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.418387436
Pre-training layer 0, epoch 0, representative training free energy -545.80177713
Pre-training layer 0, epoch 0, validation free energy -541.946082306
Pre-training layer 0, epoch 1, cost -108.830664337
Pre-training layer 0, epoch 2, cost -100.961740677
Pre-training layer 0, epoch 3, cost -96.4018686981
Pre-training layer 0, epoch 4, cost -93.4712336731
Pre-training layer 0, epoch 5, cost -91.2257950745
Pre-training layer 0, epoch 5, representative training free energy -488.255162415
Pre-training layer 0, epoch 5, validation free energy -482.892154816
Pre-training layer 0, epoch 6, cost -89.6587446747
Pre-training layer 0, epoch 7, cost -88.17809935
Pre-training layer 0, epoch 8, cost -87.1029478912
Pre-training layer 0, epoch 9, cost -86.0766092072
Pre-training layer 0, epoch 10, cost -85.2889110031
Pre-training layer 0, epoch 10, representative training free energy -467.603276123
Pre-training layer 0, epoch 10, validation free energy -461.749276367
Pre-training layer 0, epoch 11, cost -84.6056514053
Pre-training layer 0, epoch 12, cost -83.9000583038
Pre-training layer 0, epoch 13, cost -83.4266011047
Pre-training layer 0, epoch 14, cost -82.8500432358
Pre-training layer 0, epoch 15, cost -82.3539124069
Pre-training layer 0, epoch 15, representative training free energy -453.088827942
Pre-training layer 0, epoch 15, validation free energy -446.152032623
Pre-training layer 0, epoch 16, cost -82.0741148911
Pre-training layer 0, epoch 17, cost -81.5425151901
Pre-training layer 0, epoch 18, cost -81.1539754181
Pre-training layer 0, epoch 19, cost -80.8473540039
Pre-training layer 0, epoch 20, cost -80.4843685303
Pre-training layer 0, epoch 20, representative training free energy -449.282354279
Pre-training layer 0, epoch 20, validation free energy -442.74445993
Pre-training layer 0, epoch 21, cost -80.1568287201
Pre-training layer 0, epoch 22, cost -79.9362491379
Pre-training layer 0, epoch 23, cost -79.6623547974
Pre-training layer 0, epoch 24, cost -79.5126152267
Pre-training layer 0, epoch 25, cost -79.1799852524
Pre-training layer 0, epoch 25, representative training free energy -444.764584534
Pre-training layer 0, epoch 25, validation free energy -437.52445401
Pre-training layer 0, epoch 26, cost -78.9139198074
Pre-training layer 0, epoch 27, cost -78.7518218155
Pre-training layer 0, epoch 28, cost -78.582949379
Pre-training layer 0, epoch 29, cost -78.2982392883
Pre-training layer 0, epoch 30, cost -78.2593582382
Pre-training layer 0, epoch 30, representative training free energy -441.120681335
Pre-training layer 0, epoch 30, validation free energy -433.776644714
Pre-training layer 0, epoch 31, cost -78.0923612366
Pre-training layer 0, epoch 32, cost -77.8545246887
Pre-training layer 0, epoch 33, cost -77.6045764923
Pre-training layer 0, epoch 34, cost -77.5629487152
Pre-training layer 0, epoch 35, cost -77.3360117493
Pre-training layer 0, epoch 35, representative training free energy -438.402439575
Pre-training layer 0, epoch 35, validation free energy -430.481866943
Pre-training layer 0, epoch 36, cost -77.3085802689
Pre-training layer 0, epoch 37, cost -77.0859245071
Pre-training layer 0, epoch 38, cost -76.9586365509
Pre-training layer 0, epoch 39, cost -76.8155078049
Pre-training layer 0, epoch 40, cost -76.5892755966
Pre-training layer 0, epoch 40, representative training free energy -438.26962207
Pre-training layer 0, epoch 40, validation free energy -431.696848022
Pre-training layer 0, epoch 41, cost -76.5484607925
Pre-training layer 0, epoch 42, cost -76.4229579773
Pre-training layer 0, epoch 43, cost -76.3999075089
Pre-training layer 0, epoch 44, cost -76.3384515991
Pre-training layer 0, epoch 45, cost -76.1317990723
Pre-training layer 0, epoch 45, representative training free energy -436.501694885
Pre-training layer 0, epoch 45, validation free energy -429.157039764
Pre-training layer 0, epoch 46, cost -75.9673792496
Pre-training layer 0, epoch 47, cost -75.9817824783
Pre-training layer 0, epoch 48, cost -75.9168417435
Pre-training layer 0, epoch 49, cost -75.7224810257
Pre-training layer 0, epoch 50, cost -75.6083903122
Pre-training layer 0, epoch 50, representative training free energy -430.448575775
Pre-training layer 0, epoch 50, validation free energy -423.083713745
Pre-training layer 0, epoch 51, cost -75.4755973969
Pre-training layer 0, epoch 52, cost -75.2781886826
Pre-training layer 0, epoch 53, cost -75.4079940262
Pre-training layer 0, epoch 54, cost -75.2401362
Pre-training layer 0, epoch 55, cost -75.1490795059
Pre-training layer 0, epoch 55, representative training free energy -432.611209961
Pre-training layer 0, epoch 55, validation free energy -425.339205872
Pre-training layer 0, epoch 56, cost -75.2414887085
Pre-training layer 0, epoch 57, cost -75.0419989319
Pre-training layer 0, epoch 58, cost -74.8976202927
Pre-training layer 0, epoch 59, cost -74.9354705505
Pre-training layer 0, epoch 60, cost -74.807242897
Pre-training layer 0, epoch 60, representative training free energy -434.48741507
Pre-training layer 0, epoch 60, validation free energy -426.748128113
Pre-training layer 0, epoch 61, cost -74.663833107
Pre-training layer 0, epoch 62, cost -74.7130202255
Pre-training layer 0, epoch 63, cost -74.5929285431
Pre-training layer 0, epoch 64, cost -74.4599196091
Pre-training layer 0, epoch 65, cost -74.3839150772
Pre-training layer 0, epoch 65, representative training free energy -427.272126923
Pre-training layer 0, epoch 65, validation free energy -419.874606567
Pre-training layer 0, epoch 66, cost -74.496303093
Pre-training layer 0, epoch 67, cost -74.37501548
Pre-training layer 0, epoch 68, cost -74.2751246567
Pre-training layer 0, epoch 69, cost -74.2596636047
Pre-training layer 0, epoch 70, cost -74.1010103455
Pre-training layer 0, epoch 70, representative training free energy -428.063329529
Pre-training layer 0, epoch 70, validation free energy -420.553402252
Pre-training layer 0, epoch 71, cost -74.0446197433
Pre-training layer 0, epoch 72, cost -73.9977308807
Pre-training layer 0, epoch 73, cost -73.9527253571
Pre-training layer 0, epoch 74, cost -74.0058176498
Pre-training layer 0, epoch 75, cost -73.8039865112
Pre-training layer 0, epoch 75, representative training free energy -425.500583191
Pre-training layer 0, epoch 75, validation free energy -417.825197998
Pre-training layer 0, epoch 76, cost -73.805939888
Pre-training layer 0, epoch 77, cost -73.6936928787
Pre-training layer 0, epoch 78, cost -73.6254640198
Pre-training layer 0, epoch 79, cost -73.6559742203
Pre-training layer 0, epoch 80, cost -73.5623324585
Pre-training layer 0, epoch 80, representative training free energy -423.331875366
Pre-training layer 0, epoch 80, validation free energy -414.802568024
Pre-training layer 0, epoch 81, cost -73.5001784973
Pre-training layer 0, epoch 82, cost -73.3870806885
Pre-training layer 0, epoch 83, cost -73.3916857681
Pre-training layer 0, epoch 84, cost -73.2917190247
Pre-training layer 0, epoch 85, cost -73.3497587814
Pre-training layer 0, epoch 85, representative training free energy -422.734066895
Pre-training layer 0, epoch 85, validation free energy -414.740308411
Pre-training layer 0, epoch 86, cost -73.2833148041
Pre-training layer 0, epoch 87, cost -73.2233755035
Pre-training layer 0, epoch 88, cost -73.1542151031
Pre-training layer 0, epoch 89, cost -73.0158515091
Pre-training layer 0, epoch 90, cost -73.1072377167
Pre-training layer 0, epoch 90, representative training free energy -422.335953003
Pre-training layer 0, epoch 90, validation free energy -413.652698334
Pre-training layer 0, epoch 91, cost -73.0179067993
Pre-training layer 0, epoch 92, cost -73.0879413376
Pre-training layer 0, epoch 93, cost -72.8941032181
Pre-training layer 0, epoch 94, cost -72.8561828537
Pre-training layer 0, epoch 95, cost -72.8067582779
Pre-training layer 0, epoch 95, representative training free energy -424.316627502
Pre-training layer 0, epoch 95, validation free energy -415.345899292
Pre-training layer 0, epoch 96, cost -72.7431667328
Pre-training layer 0, epoch 97, cost -72.710499527
Pre-training layer 0, epoch 98, cost -72.7194828033
Pre-training layer 0, epoch 99, cost -72.7331140518
Pre-training layer 1, epoch 0, cost -311.545515747
Pre-training layer 1, epoch 0, representative training free energy -62073.8929297
Pre-training layer 1, epoch 0, validation free energy -61676.1296113
Pre-training layer 1, epoch 1, cost -267.752819672
Pre-training layer 1, epoch 2, cost -254.544158691
Pre-training layer 1, epoch 3, cost -246.738291412
Pre-training layer 1, epoch 4, cost -241.521577515
Pre-training layer 1, epoch 5, cost -237.795816467
Pre-training layer 1, epoch 5, representative training free energy -82654.6716562
Pre-training layer 1, epoch 5, validation free energy -82048.1840195
Pre-training layer 1, epoch 6, cost -234.840453796
Pre-training layer 1, epoch 7, cost -232.568559021
Pre-training layer 1, epoch 8, cost -230.704088226
Pre-training layer 1, epoch 9, cost -229.089567383
Pre-training layer 1, epoch 10, cost -227.621506866
Pre-training layer 1, epoch 10, representative training free energy -88909.870502
Pre-training layer 1, epoch 10, validation free energy -88238.187293
Pre-training layer 1, epoch 11, cost -226.431936035
Pre-training layer 1, epoch 12, cost -225.367734528
Pre-training layer 1, epoch 13, cost -224.492196686
Pre-training layer 1, epoch 14, cost -223.631568878
Pre-training layer 1, epoch 15, cost -222.898208527
Pre-training layer 1, epoch 15, representative training free energy -92575.5809121
Pre-training layer 1, epoch 15, validation free energy -91858.6425449
Pre-training layer 1, epoch 16, cost -222.270703522
Pre-training layer 1, epoch 17, cost -221.68418808
Pre-training layer 1, epoch 18, cost -221.063244507
Pre-training layer 1, epoch 19, cost -220.560714874
Pre-training layer 1, epoch 20, cost -220.086474243
Pre-training layer 1, epoch 20, representative training free energy -95331.2103203
Pre-training layer 1, epoch 20, validation free energy -94584.6087637
Pre-training layer 1, epoch 21, cost -219.679818665
Pre-training layer 1, epoch 22, cost -219.268922638
Pre-training layer 1, epoch 23, cost -218.792221954
Pre-training layer 1, epoch 24, cost -218.507363647
Pre-training layer 1, epoch 25, cost -218.181981262
Pre-training layer 1, epoch 25, representative training free energy -97299.2072324
Pre-training layer 1, epoch 25, validation free energy -96516.9617559
Pre-training layer 1, epoch 26, cost -217.818779114
Pre-training layer 1, epoch 27, cost -217.562153351
Pre-training layer 1, epoch 28, cost -217.171073914
Pre-training layer 1, epoch 29, cost -216.9558526
Pre-training layer 1, epoch 30, cost -216.721576508
Pre-training layer 1, epoch 30, representative training free energy -99108.836
Pre-training layer 1, epoch 30, validation free energy -98298.2385684
Pre-training layer 1, epoch 31, cost -216.49362088
Pre-training layer 1, epoch 32, cost -216.214221191
Pre-training layer 1, epoch 33, cost -215.919196991
Pre-training layer 1, epoch 34, cost -215.777813507
Pre-training layer 1, epoch 35, cost -215.511907257
Pre-training layer 1, epoch 35, representative training free energy -100569.662906
Pre-training layer 1, epoch 35, validation free energy -99753.6046406
Pre-training layer 1, epoch 36, cost -215.290757843
Pre-training layer 1, epoch 37, cost -215.128047577
Pre-training layer 1, epoch 38, cost -214.951439911
Pre-training layer 1, epoch 39, cost -214.733761414
Pre-training layer 1, epoch 40, cost -214.6273685
Pre-training layer 1, epoch 40, representative training free energy -101831.973957
Pre-training layer 1, epoch 40, validation free energy -101001.466121
Pre-training layer 1, epoch 41, cost -214.445812561
Pre-training layer 1, epoch 42, cost -214.287558075
Pre-training layer 1, epoch 43, cost -214.115922455
Pre-training layer 1, epoch 44, cost -213.993228638
Pre-training layer 1, epoch 45, cost -213.834419037
Pre-training layer 1, epoch 45, representative training free energy -103074.400613
Pre-training layer 1, epoch 45, validation free energy -102223.791742
Pre-training layer 1, epoch 46, cost -213.667129486
Pre-training layer 1, epoch 47, cost -213.606108246
Pre-training layer 1, epoch 48, cost -213.446716095
Pre-training layer 1, epoch 49, cost -213.295526154
Pre-training layer 1, epoch 50, cost -213.236782684
Pre-training layer 1, epoch 50, representative training free energy -104084.068309
Pre-training layer 1, epoch 50, validation free energy -103222.878832
Pre-training layer 1, epoch 51, cost -212.992851379
Pre-training layer 1, epoch 52, cost -212.945283508
Pre-training layer 1, epoch 53, cost -212.763737274
Pre-training layer 1, epoch 54, cost -212.758499084
Pre-training layer 1, epoch 55, cost -212.633348755
Pre-training layer 1, epoch 55, representative training free energy -105150.144641
Pre-training layer 1, epoch 55, validation free energy -104276.234797
Pre-training layer 1, epoch 56, cost -212.45304538
Pre-training layer 1, epoch 57, cost -212.425747833
Pre-training layer 1, epoch 58, cost -212.226860199
Pre-training layer 1, epoch 59, cost -212.231617767
Pre-training layer 1, epoch 60, cost -212.090938477
Pre-training layer 1, epoch 60, representative training free energy -105894.399738
Pre-training layer 1, epoch 60, validation free energy -105010.485605
Pre-training layer 1, epoch 61, cost -212.082194122
Pre-training layer 1, epoch 62, cost -211.966437317
Pre-training layer 1, epoch 63, cost -211.803132141
Pre-training layer 1, epoch 64, cost -211.775461273
Pre-training layer 1, epoch 65, cost -211.662965942
Pre-training layer 1, epoch 65, representative training free energy -106716.24843
Pre-training layer 1, epoch 65, validation free energy -105814.750816
Pre-training layer 1, epoch 66, cost -211.533269653
Pre-training layer 1, epoch 67, cost -211.448671906
Pre-training layer 1, epoch 68, cost -211.504988373
Pre-training layer 1, epoch 69, cost -211.341944
Pre-training layer 1, epoch 70, cost -211.204020905
Pre-training layer 1, epoch 70, representative training free energy -107512.550387
Pre-training layer 1, epoch 70, validation free energy -106602.569484
Pre-training layer 1, epoch 71, cost -211.156859467
Pre-training layer 1, epoch 72, cost -211.025283844
Pre-training layer 1, epoch 73, cost -211.003598389
Pre-training layer 1, epoch 74, cost -210.931147705
Pre-training layer 1, epoch 75, cost -210.868050568
Pre-training layer 1, epoch 75, representative training free energy -108410.705223
Pre-training layer 1, epoch 75, validation free energy -107503.134211
Pre-training layer 1, epoch 76, cost -210.790022247
Pre-training layer 1, epoch 77, cost -210.770777069
Pre-training layer 1, epoch 78, cost -210.752994629
Pre-training layer 1, epoch 79, cost -210.660505249
Pre-training layer 1, epoch 80, cost -210.480403168
Pre-training layer 1, epoch 80, representative training free energy -108967.294816
Pre-training layer 1, epoch 80, validation free energy -108044.026957
Pre-training layer 1, epoch 81, cost -210.473376495
Pre-training layer 1, epoch 82, cost -210.429781219
Pre-training layer 1, epoch 83, cost -210.39995993
Pre-training layer 1, epoch 84, cost -210.340025208
Pre-training layer 1, epoch 85, cost -210.242751953
Pre-training layer 1, epoch 85, representative training free energy -109648.000113
Pre-training layer 1, epoch 85, validation free energy -108726.183824
Pre-training layer 1, epoch 86, cost -210.263610657
Pre-training layer 1, epoch 87, cost -210.148859741
Pre-training layer 1, epoch 88, cost -210.07442923
Pre-training layer 1, epoch 89, cost -210.010348694
Pre-training layer 1, epoch 90, cost -210.024801819
Pre-training layer 1, epoch 90, representative training free energy -110286.772551
Pre-training layer 1, epoch 90, validation free energy -109356.092961
Pre-training layer 1, epoch 91, cost -209.896446655
Pre-training layer 1, epoch 92, cost -209.956740448
Pre-training layer 1, epoch 93, cost -209.820965698
Pre-training layer 1, epoch 94, cost -209.823983826
Pre-training layer 1, epoch 95, cost -209.812338989
Pre-training layer 1, epoch 95, representative training free energy -110982.179176
Pre-training layer 1, epoch 95, validation free energy -110048.524789
Pre-training layer 1, epoch 96, cost -209.700091217
Pre-training layer 1, epoch 97, cost -209.663896454
Pre-training layer 1, epoch 98, cost -209.621647552
Pre-training layer 1, epoch 99, cost -209.565080597
Pre-training layer 2, epoch 0, cost -113.337152191
Pre-training layer 2, epoch 0, representative training free energy 3910.10047009
Pre-training layer 2, epoch 0, validation free energy 3866.62307623
Pre-training layer 2, epoch 1, cost -85.3630260239
Pre-training layer 2, epoch 2, cost -79.2321748199
Pre-training layer 2, epoch 3, cost -75.7163059082
Pre-training layer 2, epoch 4, cost -73.4456768036
Pre-training layer 2, epoch 5, cost -71.7494654083
Pre-training layer 2, epoch 5, representative training free energy 6379.26748242
Pre-training layer 2, epoch 5, validation free energy 6309.00025854
Pre-training layer 2, epoch 6, cost -70.4449670258
Pre-training layer 2, epoch 7, cost -69.3918242798
Pre-training layer 2, epoch 8, cost -68.4080009537
Pre-training layer 2, epoch 9, cost -67.8001231155
Pre-training layer 2, epoch 10, cost -67.1764107742
Pre-training layer 2, epoch 10, representative training free energy 7678.9763291
Pre-training layer 2, epoch 10, validation free energy 7599.34709058
Pre-training layer 2, epoch 11, cost -66.6317281113
Pre-training layer 2, epoch 12, cost -66.111586853
Pre-training layer 2, epoch 13, cost -65.7175161743
Pre-training layer 2, epoch 14, cost -65.3571677933
Pre-training layer 2, epoch 15, cost -64.962034523
Pre-training layer 2, epoch 15, representative training free energy 8589.3702666
Pre-training layer 2, epoch 15, validation free energy 8502.85193555
Pre-training layer 2, epoch 16, cost -64.6325419998
Pre-training layer 2, epoch 17, cost -64.3736405182
Pre-training layer 2, epoch 18, cost -64.060127533
Pre-training layer 2, epoch 19, cost -63.9218616943
Pre-training layer 2, epoch 20, cost -63.6309888763
Pre-training layer 2, epoch 20, representative training free energy 9368.55717822
Pre-training layer 2, epoch 20, validation free energy 9278.92577539
Pre-training layer 2, epoch 21, cost -63.5181580353
Pre-training layer 2, epoch 22, cost -63.3606343079
Pre-training layer 2, epoch 23, cost -63.1044019165
Pre-training layer 2, epoch 24, cost -63.0512393188
Pre-training layer 2, epoch 25, cost -62.8285300903
Pre-training layer 2, epoch 25, representative training free energy 9958.27906079
Pre-training layer 2, epoch 25, validation free energy 9859.05874756
Pre-training layer 2, epoch 26, cost -62.6537000275
Pre-training layer 2, epoch 27, cost -62.5889016495
Pre-training layer 2, epoch 28, cost -62.5244665756
Pre-training layer 2, epoch 29, cost -62.2591634445
Pre-training layer 2, epoch 30, cost -62.236185585
Pre-training layer 2, epoch 30, representative training free energy 10522.6358967
Pre-training layer 2, epoch 30, validation free energy 10418.7685059
Pre-training layer 2, epoch 31, cost -62.1795456619
Pre-training layer 2, epoch 32, cost -62.0638131943
Pre-training layer 2, epoch 33, cost -61.9414621353
Pre-training layer 2, epoch 34, cost -61.8997864227
Pre-training layer 2, epoch 35, cost -61.7449626541
Pre-training layer 2, epoch 35, representative training free energy 11035.2300444
Pre-training layer 2, epoch 35, validation free energy 10926.6082964
Pre-training layer 2, epoch 36, cost -61.698346817
Pre-training layer 2, epoch 37, cost -61.5789015884
Pre-training layer 2, epoch 38, cost -61.5580422897
Pre-training layer 2, epoch 39, cost -61.5187382584
Pre-training layer 2, epoch 40, cost -61.3773045959
Pre-training layer 2, epoch 40, representative training free energy 11523.6449841
Pre-training layer 2, epoch 40, validation free energy 11415.9615769
Pre-training layer 2, epoch 41, cost -61.2920346756
Pre-training layer 2, epoch 42, cost -61.2860463333
Pre-training layer 2, epoch 43, cost -61.1399832153
Pre-training layer 2, epoch 44, cost -61.0979015656
Pre-training layer 2, epoch 45, cost -61.0916527023
Pre-training layer 2, epoch 45, representative training free energy 11973.5217632
Pre-training layer 2, epoch 45, validation free energy 11859.0864731
Pre-training layer 2, epoch 46, cost -61.0088156357
Pre-training layer 2, epoch 47, cost -61.0041660385
Pre-training layer 2, epoch 48, cost -60.9087509689
Pre-training layer 2, epoch 49, cost -60.8444444122
Pre-training layer 2, epoch 50, cost -60.7331457977
Pre-training layer 2, epoch 50, representative training free energy 12390.9488013
Pre-training layer 2, epoch 50, validation free energy 12269.7224399
Pre-training layer 2, epoch 51, cost -60.7626754608
Pre-training layer 2, epoch 52, cost -60.6357232666
Pre-training layer 2, epoch 53, cost -60.6816218567
Pre-training layer 2, epoch 54, cost -60.5879316101
Pre-training layer 2, epoch 55, cost -60.6282731323
Pre-training layer 2, epoch 55, representative training free energy 12835.4476003
Pre-training layer 2, epoch 55, validation free energy 12717.4694517
Pre-training layer 2, epoch 56, cost -60.5157731094
Pre-training layer 2, epoch 57, cost -60.5266252899
Pre-training layer 2, epoch 58, cost -60.3790617294
Pre-training layer 2, epoch 59, cost -60.4255643845
Pre-training layer 2, epoch 60, cost -60.3551421967
Pre-training layer 2, epoch 60, representative training free energy 13194.317748
Pre-training layer 2, epoch 60, validation free energy 13069.403187
Pre-training layer 2, epoch 61, cost -60.2845253448
Pre-training layer 2, epoch 62, cost -60.2870863571
Pre-training layer 2, epoch 63, cost -60.233951355
Pre-training layer 2, epoch 64, cost -60.2078155441
Pre-training layer 2, epoch 65, cost -60.1600449829
Pre-training layer 2, epoch 65, representative training free energy 13545.818771
Pre-training layer 2, epoch 65, validation free energy 13421.9284009
Pre-training layer 2, epoch 66, cost -60.2094454346
Pre-training layer 2, epoch 67, cost -60.0878879547
Pre-training layer 2, epoch 68, cost -60.1018460159
Pre-training layer 2, epoch 69, cost -60.1040194321
Pre-training layer 2, epoch 70, cost -60.0256081924
Pre-training layer 2, epoch 70, representative training free energy 13896.5454575
Pre-training layer 2, epoch 70, validation free energy 13771.0242026
Pre-training layer 2, epoch 71, cost -60.0236009521
Pre-training layer 2, epoch 72, cost -59.9059689178
Pre-training layer 2, epoch 73, cost -59.9385689774
Pre-training layer 2, epoch 74, cost -59.9250958939
Pre-training layer 2, epoch 75, cost -59.9382715607
Pre-training layer 2, epoch 75, representative training free energy 14251.6330938
Pre-training layer 2, epoch 75, validation free energy 14121.5526719
Pre-training layer 2, epoch 76, cost -59.8848523102
Pre-training layer 2, epoch 77, cost -59.857895195
Pre-training layer 2, epoch 78, cost -59.7673324585
Pre-training layer 2, epoch 79, cost -59.7401906357
Pre-training layer 2, epoch 80, cost -59.854913414
Pre-training layer 2, epoch 80, representative training free energy 14591.590585
Pre-training layer 2, epoch 80, validation free energy 14466.5967549
Pre-training layer 2, epoch 81, cost -59.7183821869
Pre-training layer 2, epoch 82, cost -59.7395128021
Pre-training layer 2, epoch 83, cost -59.6565032959
Pre-training layer 2, epoch 84, cost -59.6502690735
Pre-training layer 2, epoch 85, cost -59.6503432999
Pre-training layer 2, epoch 85, representative training free energy 14853.5551396
Pre-training layer 2, epoch 85, validation free energy 14712.1467188
Pre-training layer 2, epoch 86, cost -59.5389104919
Pre-training layer 2, epoch 87, cost -59.5395288315
Pre-training layer 2, epoch 88, cost -59.6394055634
Pre-training layer 2, epoch 89, cost -59.5069618073
Pre-training layer 2, epoch 90, cost -59.551680275
Pre-training layer 2, epoch 90, representative training free energy 15253.6705073
Pre-training layer 2, epoch 90, validation free energy 15114.043147
Pre-training layer 2, epoch 91, cost -59.4834349442
Pre-training layer 2, epoch 92, cost -59.4292168808
Pre-training layer 2, epoch 93, cost -59.5169237823
Pre-training layer 2, epoch 94, cost -59.3681350174
Pre-training layer 2, epoch 95, cost -59.4286075058
Pre-training layer 2, epoch 95, representative training free energy 15536.6048945
Pre-training layer 2, epoch 95, validation free energy 15404.1477656
Pre-training layer 2, epoch 96, cost -59.4046840591
Pre-training layer 2, epoch 97, cost -59.3492268677
Pre-training layer 2, epoch 98, cost -59.2981549454
Pre-training layer 2, epoch 99, cost -59.3274027252
The pretraining code for file dbn_loop.pyc ran for 13.08m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 32.400000 %
     epoch 1, minibatch 500/500, test error of best model 26.000000 %
epoch 2, minibatch 500/500, validation error 23.500000 %
     epoch 2, minibatch 500/500, test error of best model 17.700000 %
epoch 3, minibatch 500/500, validation error 21.900000 %
     epoch 3, minibatch 500/500, test error of best model 14.500000 %
epoch 4, minibatch 500/500, validation error 20.000000 %
     epoch 4, minibatch 500/500, test error of best model 12.600000 %
epoch 5, minibatch 500/500, validation error 18.800000 %
     epoch 5, minibatch 500/500, test error of best model 11.300000 %
epoch 6, minibatch 500/500, validation error 17.800000 %
     epoch 6, minibatch 500/500, test error of best model 10.400000 %
epoch 7, minibatch 500/500, validation error 17.200000 %
     epoch 7, minibatch 500/500, test error of best model 9.200000 %
epoch 8, minibatch 500/500, validation error 16.900000 %
     epoch 8, minibatch 500/500, test error of best model 8.600000 %
epoch 9, minibatch 500/500, validation error 16.500000 %
     epoch 9, minibatch 500/500, test error of best model 7.700000 %
epoch 10, minibatch 500/500, validation error 16.100000 %
     epoch 10, minibatch 500/500, test error of best model 7.400000 %
epoch 11, minibatch 500/500, validation error 15.900000 %
     epoch 11, minibatch 500/500, test error of best model 7.200000 %
epoch 12, minibatch 500/500, validation error 15.900000 %
epoch 13, minibatch 500/500, validation error 15.800000 %
     epoch 13, minibatch 500/500, test error of best model 6.800000 %
epoch 14, minibatch 500/500, validation error 15.600000 %
     epoch 14, minibatch 500/500, test error of best model 6.200000 %
epoch 15, minibatch 500/500, validation error 15.500000 %
     epoch 15, minibatch 500/500, test error of best model 6.000000 %
epoch 16, minibatch 500/500, validation error 15.500000 %
epoch 17, minibatch 500/500, validation error 15.600000 %
epoch 18, minibatch 500/500, validation error 15.700000 %
epoch 19, minibatch 500/500, validation error 15.500000 %
epoch 20, minibatch 500/500, validation error 15.400000 %
     epoch 20, minibatch 500/500, test error of best model 6.100000 %
epoch 21, minibatch 500/500, validation error 15.300000 %
     epoch 21, minibatch 500/500, test error of best model 6.100000 %
epoch 22, minibatch 500/500, validation error 15.200000 %
     epoch 22, minibatch 500/500, test error of best model 6.300000 %
epoch 23, minibatch 500/500, validation error 15.200000 %
epoch 24, minibatch 500/500, validation error 15.200000 %
epoch 25, minibatch 500/500, validation error 15.200000 %
epoch 26, minibatch 500/500, validation error 15.100000 %
     epoch 26, minibatch 500/500, test error of best model 6.200000 %
epoch 27, minibatch 500/500, validation error 15.000000 %
     epoch 27, minibatch 500/500, test error of best model 6.100000 %
epoch 28, minibatch 500/500, validation error 14.800000 %
     epoch 28, minibatch 500/500, test error of best model 6.100000 %
epoch 29, minibatch 500/500, validation error 14.700000 %
     epoch 29, minibatch 500/500, test error of best model 6.100000 %
epoch 30, minibatch 500/500, validation error 14.700000 %
epoch 31, minibatch 500/500, validation error 14.700000 %
epoch 32, minibatch 500/500, validation error 14.700000 %
epoch 33, minibatch 500/500, validation error 14.600000 %
     epoch 33, minibatch 500/500, test error of best model 6.000000 %
epoch 34, minibatch 500/500, validation error 14.600000 %
epoch 35, minibatch 500/500, validation error 14.700000 %
epoch 36, minibatch 500/500, validation error 14.700000 %
epoch 37, minibatch 500/500, validation error 14.600000 %
epoch 38, minibatch 500/500, validation error 14.500000 %
     epoch 38, minibatch 500/500, test error of best model 5.800000 %
epoch 39, minibatch 500/500, validation error 14.500000 %
epoch 40, minibatch 500/500, validation error 14.500000 %
epoch 41, minibatch 500/500, validation error 14.400000 %
     epoch 41, minibatch 500/500, test error of best model 5.800000 %
epoch 42, minibatch 500/500, validation error 14.300000 %
     epoch 42, minibatch 500/500, test error of best model 5.800000 %
epoch 43, minibatch 500/500, validation error 14.300000 %
epoch 44, minibatch 500/500, validation error 14.200000 %
     epoch 44, minibatch 500/500, test error of best model 5.700000 %
epoch 45, minibatch 500/500, validation error 14.200000 %
epoch 46, minibatch 500/500, validation error 14.200000 %
epoch 47, minibatch 500/500, validation error 14.200000 %
epoch 48, minibatch 500/500, validation error 14.200000 %
epoch 49, minibatch 500/500, validation error 14.200000 %
epoch 50, minibatch 500/500, validation error 14.200000 %
epoch 51, minibatch 500/500, validation error 14.200000 %
epoch 52, minibatch 500/500, validation error 14.200000 %
epoch 53, minibatch 500/500, validation error 14.200000 %
epoch 54, minibatch 500/500, validation error 14.200000 %
epoch 55, minibatch 500/500, validation error 14.200000 %
epoch 56, minibatch 500/500, validation error 14.300000 %
epoch 57, minibatch 500/500, validation error 14.300000 %
epoch 58, minibatch 500/500, validation error 14.300000 %
epoch 59, minibatch 500/500, validation error 14.300000 %
epoch 60, minibatch 500/500, validation error 14.300000 %
epoch 61, minibatch 500/500, validation error 14.300000 %
epoch 62, minibatch 500/500, validation error 14.300000 %
epoch 63, minibatch 500/500, validation error 14.300000 %
epoch 64, minibatch 500/500, validation error 14.300000 %
epoch 65, minibatch 500/500, validation error 14.300000 %
epoch 66, minibatch 500/500, validation error 14.300000 %
epoch 67, minibatch 500/500, validation error 14.300000 %
epoch 68, minibatch 500/500, validation error 14.300000 %
epoch 69, minibatch 500/500, validation error 14.300000 %
epoch 70, minibatch 500/500, validation error 14.300000 %
epoch 71, minibatch 500/500, validation error 14.300000 %
epoch 72, minibatch 500/500, validation error 14.300000 %
epoch 73, minibatch 500/500, validation error 14.300000 %
epoch 74, minibatch 500/500, validation error 14.300000 %
epoch 75, minibatch 500/500, validation error 14.300000 %
epoch 76, minibatch 500/500, validation error 14.300000 %
epoch 77, minibatch 500/500, validation error 14.300000 %
epoch 78, minibatch 500/500, validation error 14.300000 %
epoch 79, minibatch 500/500, validation error 14.300000 %
epoch 80, minibatch 500/500, validation error 14.300000 %
epoch 81, minibatch 500/500, validation error 14.300000 %
epoch 82, minibatch 500/500, validation error 14.300000 %
epoch 83, minibatch 500/500, validation error 14.300000 %
epoch 84, minibatch 500/500, validation error 14.300000 %
epoch 85, minibatch 500/500, validation error 14.300000 %
epoch 86, minibatch 500/500, validation error 14.300000 %
epoch 87, minibatch 500/500, validation error 14.300000 %
Optimization complete with best validation score of 14.200000 %, obtained at iteration 22000, with test performance 5.700000 %
The fine tuning code for file dbn_loop.pyc ran for 3.66m
_______RUN: 4

==========Sample: (1000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -184.580209656
Pre-training layer 0, epoch 0, representative training free energy -594.656039001
Pre-training layer 0, epoch 0, validation free energy -589.53497403
Pre-training layer 0, epoch 1, cost -136.626576157
Pre-training layer 0, epoch 2, cost -124.79853363
Pre-training layer 0, epoch 3, cost -118.183399811
Pre-training layer 0, epoch 4, cost -113.329513245
Pre-training layer 0, epoch 5, cost -109.800272064
Pre-training layer 0, epoch 5, representative training free energy -546.389456573
Pre-training layer 0, epoch 5, validation free energy -536.268526123
Pre-training layer 0, epoch 6, cost -107.074622955
Pre-training layer 0, epoch 7, cost -104.731561661
Pre-training layer 0, epoch 8, cost -102.847435532
Pre-training layer 0, epoch 9, cost -100.962949905
Pre-training layer 0, epoch 10, cost -99.5079133606
Pre-training layer 0, epoch 10, representative training free energy -528.932698395
Pre-training layer 0, epoch 10, validation free energy -517.163944855
Pre-training layer 0, epoch 11, cost -98.2027502441
Pre-training layer 0, epoch 12, cost -96.561428833
Pre-training layer 0, epoch 13, cost -95.9789135742
Pre-training layer 0, epoch 14, cost -94.7557294464
Pre-training layer 0, epoch 15, cost -93.814984436
Pre-training layer 0, epoch 15, representative training free energy -513.806976471
Pre-training layer 0, epoch 15, validation free energy -501.295774902
Pre-training layer 0, epoch 16, cost -92.6344039154
Pre-training layer 0, epoch 17, cost -92.208515625
Pre-training layer 0, epoch 18, cost -91.1042027283
Pre-training layer 0, epoch 19, cost -90.5264247894
Pre-training layer 0, epoch 20, cost -90.1475285339
Pre-training layer 0, epoch 20, representative training free energy -511.928507751
Pre-training layer 0, epoch 20, validation free energy -498.588308472
Pre-training layer 0, epoch 21, cost -89.3426021576
Pre-training layer 0, epoch 22, cost -88.9036778259
Pre-training layer 0, epoch 23, cost -88.5808048248
Pre-training layer 0, epoch 24, cost -87.6484042358
Pre-training layer 0, epoch 25, cost -87.3579776001
Pre-training layer 0, epoch 25, representative training free energy -501.164287933
Pre-training layer 0, epoch 25, validation free energy -488.239909271
Pre-training layer 0, epoch 26, cost -86.9932684326
Pre-training layer 0, epoch 27, cost -86.6679883575
Pre-training layer 0, epoch 28, cost -86.0932685852
Pre-training layer 0, epoch 29, cost -85.4222622681
Pre-training layer 0, epoch 30, cost -84.8807831573
Pre-training layer 0, epoch 30, representative training free energy -497.316677124
Pre-training layer 0, epoch 30, validation free energy -483.08933844
Pre-training layer 0, epoch 31, cost -84.9603503418
Pre-training layer 0, epoch 32, cost -84.5635633087
Pre-training layer 0, epoch 33, cost -84.518574295
Pre-training layer 0, epoch 34, cost -83.9609633636
Pre-training layer 0, epoch 35, cost -83.7593421173
Pre-training layer 0, epoch 35, representative training free energy -490.301409149
Pre-training layer 0, epoch 35, validation free energy -475.727979767
Pre-training layer 0, epoch 36, cost -83.2273815918
Pre-training layer 0, epoch 37, cost -82.9062998199
Pre-training layer 0, epoch 38, cost -82.6769542313
Pre-training layer 0, epoch 39, cost -82.7889750671
Pre-training layer 0, epoch 40, cost -82.1827204132
Pre-training layer 0, epoch 40, representative training free energy -486.369467255
Pre-training layer 0, epoch 40, validation free energy -470.591758026
Pre-training layer 0, epoch 41, cost -81.6384889221
Pre-training layer 0, epoch 42, cost -81.7433411026
Pre-training layer 0, epoch 43, cost -81.3769499207
Pre-training layer 0, epoch 44, cost -80.9742027283
Pre-training layer 0, epoch 45, cost -81.1839677429
Pre-training layer 0, epoch 45, representative training free energy -483.71963028
Pre-training layer 0, epoch 45, validation free energy -468.228066803
Pre-training layer 0, epoch 46, cost -80.7936501312
Pre-training layer 0, epoch 47, cost -80.4707087326
Pre-training layer 0, epoch 48, cost -80.5191082382
Pre-training layer 0, epoch 49, cost -80.2109595871
Pre-training layer 0, epoch 50, cost -79.9557403946
Pre-training layer 0, epoch 50, representative training free energy -480.396917908
Pre-training layer 0, epoch 50, validation free energy -464.499018799
Pre-training layer 0, epoch 51, cost -79.8550840759
Pre-training layer 0, epoch 52, cost -79.925760498
Pre-training layer 0, epoch 53, cost -79.3393029785
Pre-training layer 0, epoch 54, cost -79.403239975
Pre-training layer 0, epoch 55, cost -79.1304310608
Pre-training layer 0, epoch 55, representative training free energy -477.920581024
Pre-training layer 0, epoch 55, validation free energy -461.690906219
Pre-training layer 0, epoch 56, cost -78.9078394699
Pre-training layer 0, epoch 57, cost -78.7889192581
Pre-training layer 0, epoch 58, cost -78.6176445389
Pre-training layer 0, epoch 59, cost -78.2513782501
Pre-training layer 0, epoch 60, cost -78.4663030243
Pre-training layer 0, epoch 60, representative training free energy -473.635113434
Pre-training layer 0, epoch 60, validation free energy -456.964077576
Pre-training layer 0, epoch 61, cost -78.3041702652
Pre-training layer 0, epoch 62, cost -77.8514391327
Pre-training layer 0, epoch 63, cost -77.8276805496
Pre-training layer 0, epoch 64, cost -77.5919875717
Pre-training layer 0, epoch 65, cost -77.5850690842
Pre-training layer 0, epoch 65, representative training free energy -474.787254852
Pre-training layer 0, epoch 65, validation free energy -458.12140097
Pre-training layer 0, epoch 66, cost -77.4745217514
Pre-training layer 0, epoch 67, cost -77.4545742416
Pre-training layer 0, epoch 68, cost -76.9327542496
Pre-training layer 0, epoch 69, cost -77.2324760437
Pre-training layer 0, epoch 70, cost -76.8913578033
Pre-training layer 0, epoch 70, representative training free energy -473.791115417
Pre-training layer 0, epoch 70, validation free energy -455.984862915
Pre-training layer 0, epoch 71, cost -76.5877697754
Pre-training layer 0, epoch 72, cost -76.8640687561
Pre-training layer 0, epoch 73, cost -76.4213696289
Pre-training layer 0, epoch 74, cost -76.4010383987
Pre-training layer 0, epoch 75, cost -76.289210968
Pre-training layer 0, epoch 75, representative training free energy -472.617656586
Pre-training layer 0, epoch 75, validation free energy -454.298183838
Pre-training layer 0, epoch 76, cost -76.2655487823
Pre-training layer 0, epoch 77, cost -76.0563117599
Pre-training layer 0, epoch 78, cost -76.0370273972
Pre-training layer 0, epoch 79, cost -75.9154862595
Pre-training layer 0, epoch 80, cost -75.8503565598
Pre-training layer 0, epoch 80, representative training free energy -467.231276428
Pre-training layer 0, epoch 80, validation free energy -449.896993835
Pre-training layer 0, epoch 81, cost -75.8139447784
Pre-training layer 0, epoch 82, cost -75.6040034103
Pre-training layer 0, epoch 83, cost -75.6325990295
Pre-training layer 0, epoch 84, cost -75.3197704697
Pre-training layer 0, epoch 85, cost -75.4354441833
Pre-training layer 0, epoch 85, representative training free energy -469.07709256
Pre-training layer 0, epoch 85, validation free energy -450.303181122
Pre-training layer 0, epoch 86, cost -75.1787845993
Pre-training layer 0, epoch 87, cost -74.9360617447
Pre-training layer 0, epoch 88, cost -75.3397419357
Pre-training layer 0, epoch 89, cost -74.8598590088
Pre-training layer 0, epoch 90, cost -74.7923546982
Pre-training layer 0, epoch 90, representative training free energy -467.469415131
Pre-training layer 0, epoch 90, validation free energy -448.6200177
Pre-training layer 0, epoch 91, cost -74.9363322449
Pre-training layer 0, epoch 92, cost -74.8597667694
Pre-training layer 0, epoch 93, cost -74.7117945862
Pre-training layer 0, epoch 94, cost -74.5638956833
Pre-training layer 0, epoch 95, cost -74.5834870148
Pre-training layer 0, epoch 95, representative training free energy -467.811353729
Pre-training layer 0, epoch 95, validation free energy -448.701716614
Pre-training layer 0, epoch 96, cost -74.3836717224
Pre-training layer 0, epoch 97, cost -74.2182999039
Pre-training layer 0, epoch 98, cost -74.1898573685
Pre-training layer 0, epoch 99, cost -74.292301445
Pre-training layer 1, epoch 0, cost -430.718110046
Pre-training layer 1, epoch 0, representative training free energy -32837.2137852
Pre-training layer 1, epoch 0, validation free energy -32258.3261953
Pre-training layer 1, epoch 1, cost -370.249560852
Pre-training layer 1, epoch 2, cost -350.86757019
Pre-training layer 1, epoch 3, cost -338.694238281
Pre-training layer 1, epoch 4, cost -330.598396912
Pre-training layer 1, epoch 5, cost -324.126390381
Pre-training layer 1, epoch 5, representative training free energy -47057.9796768
Pre-training layer 1, epoch 5, validation free energy -46326.7302871
Pre-training layer 1, epoch 6, cost -319.096347046
Pre-training layer 1, epoch 7, cost -314.911662903
Pre-training layer 1, epoch 8, cost -311.586012573
Pre-training layer 1, epoch 9, cost -308.666727295
Pre-training layer 1, epoch 10, cost -305.98178009
Pre-training layer 1, epoch 10, representative training free energy -51484.9910996
Pre-training layer 1, epoch 10, validation free energy -50755.5669482
Pre-training layer 1, epoch 11, cost -303.512600098
Pre-training layer 1, epoch 12, cost -301.540108948
Pre-training layer 1, epoch 13, cost -299.719002533
Pre-training layer 1, epoch 14, cost -297.905314026
Pre-training layer 1, epoch 15, cost -296.408107758
Pre-training layer 1, epoch 15, representative training free energy -54162.6527236
Pre-training layer 1, epoch 15, validation free energy -53405.736835
Pre-training layer 1, epoch 16, cost -294.95242218
Pre-training layer 1, epoch 17, cost -293.76549408
Pre-training layer 1, epoch 18, cost -292.609874725
Pre-training layer 1, epoch 19, cost -291.445516205
Pre-training layer 1, epoch 20, cost -290.469494476
Pre-training layer 1, epoch 20, representative training free energy -55817.1274395
Pre-training layer 1, epoch 20, validation free energy -55062.4414805
Pre-training layer 1, epoch 21, cost -289.580916443
Pre-training layer 1, epoch 22, cost -288.617938538
Pre-training layer 1, epoch 23, cost -287.892321167
Pre-training layer 1, epoch 24, cost -286.988145142
Pre-training layer 1, epoch 25, cost -286.110920105
Pre-training layer 1, epoch 25, representative training free energy -57166.3191426
Pre-training layer 1, epoch 25, validation free energy -56386.7271445
Pre-training layer 1, epoch 26, cost -285.618612976
Pre-training layer 1, epoch 27, cost -284.967579651
Pre-training layer 1, epoch 28, cost -284.437878876
Pre-training layer 1, epoch 29, cost -283.742169189
Pre-training layer 1, epoch 30, cost -282.995491943
Pre-training layer 1, epoch 30, representative training free energy -58211.1371523
Pre-training layer 1, epoch 30, validation free energy -57432.5045703
Pre-training layer 1, epoch 31, cost -282.505393524
Pre-training layer 1, epoch 32, cost -281.919015961
Pre-training layer 1, epoch 33, cost -281.685421143
Pre-training layer 1, epoch 34, cost -280.865148926
Pre-training layer 1, epoch 35, cost -280.504990082
Pre-training layer 1, epoch 35, representative training free energy -59164.1554336
Pre-training layer 1, epoch 35, validation free energy -58378.5392383
Pre-training layer 1, epoch 36, cost -280.055388336
Pre-training layer 1, epoch 37, cost -279.805032654
Pre-training layer 1, epoch 38, cost -279.341978302
Pre-training layer 1, epoch 39, cost -278.929098053
Pre-training layer 1, epoch 40, cost -278.601318817
Pre-training layer 1, epoch 40, representative training free energy -59878.9671094
Pre-training layer 1, epoch 40, validation free energy -59088.9679824
Pre-training layer 1, epoch 41, cost -278.323825531
Pre-training layer 1, epoch 42, cost -277.803975067
Pre-training layer 1, epoch 43, cost -277.552248993
Pre-training layer 1, epoch 44, cost -277.240528259
Pre-training layer 1, epoch 45, cost -276.897098694
Pre-training layer 1, epoch 45, representative training free energy -60623.3413203
Pre-training layer 1, epoch 45, validation free energy -59844.7385859
Pre-training layer 1, epoch 46, cost -276.565157166
Pre-training layer 1, epoch 47, cost -276.023050232
Pre-training layer 1, epoch 48, cost -275.895837708
Pre-training layer 1, epoch 49, cost -275.838130341
Pre-training layer 1, epoch 50, cost -275.50439743
Pre-training layer 1, epoch 50, representative training free energy -61154.402125
Pre-training layer 1, epoch 50, validation free energy -60368.9788398
Pre-training layer 1, epoch 51, cost -275.292483063
Pre-training layer 1, epoch 52, cost -274.9379422
Pre-training layer 1, epoch 53, cost -274.886607819
Pre-training layer 1, epoch 54, cost -274.440033264
Pre-training layer 1, epoch 55, cost -274.189215698
Pre-training layer 1, epoch 55, representative training free energy -61703.5993047
Pre-training layer 1, epoch 55, validation free energy -60912.676498
Pre-training layer 1, epoch 56, cost -274.018631897
Pre-training layer 1, epoch 57, cost -273.673672638
Pre-training layer 1, epoch 58, cost -273.577001495
Pre-training layer 1, epoch 59, cost -273.32056488
Pre-training layer 1, epoch 60, cost -273.122835388
Pre-training layer 1, epoch 60, representative training free energy -62231.4785098
Pre-training layer 1, epoch 60, validation free energy -61434.3199023
Pre-training layer 1, epoch 61, cost -273.121351013
Pre-training layer 1, epoch 62, cost -272.791964264
Pre-training layer 1, epoch 63, cost -272.908749237
Pre-training layer 1, epoch 64, cost -272.478128815
Pre-training layer 1, epoch 65, cost -272.184692078
Pre-training layer 1, epoch 65, representative training free energy -62659.1067207
Pre-training layer 1, epoch 65, validation free energy -61855.1830527
Pre-training layer 1, epoch 66, cost -272.117780457
Pre-training layer 1, epoch 67, cost -272.011331787
Pre-training layer 1, epoch 68, cost -272.032238617
Pre-training layer 1, epoch 69, cost -271.67922348
Pre-training layer 1, epoch 70, cost -271.515172729
Pre-training layer 1, epoch 70, representative training free energy -63138.6956445
Pre-training layer 1, epoch 70, validation free energy -62330.109457
Pre-training layer 1, epoch 71, cost -271.291654358
Pre-training layer 1, epoch 72, cost -271.29959259
Pre-training layer 1, epoch 73, cost -271.050783691
Pre-training layer 1, epoch 74, cost -270.895895844
Pre-training layer 1, epoch 75, cost -270.762531738
Pre-training layer 1, epoch 75, representative training free energy -63425.5984492
Pre-training layer 1, epoch 75, validation free energy -62615.7850449
Pre-training layer 1, epoch 76, cost -270.497194977
Pre-training layer 1, epoch 77, cost -270.473851013
Pre-training layer 1, epoch 78, cost -270.418495941
Pre-training layer 1, epoch 79, cost -270.438755798
Pre-training layer 1, epoch 80, cost -270.224047546
Pre-training layer 1, epoch 80, representative training free energy -63875.3636367
Pre-training layer 1, epoch 80, validation free energy -63058.5323672
Pre-training layer 1, epoch 81, cost -270.000486908
Pre-training layer 1, epoch 82, cost -269.746137695
Pre-training layer 1, epoch 83, cost -269.879561615
Pre-training layer 1, epoch 84, cost -269.652223358
Pre-training layer 1, epoch 85, cost -269.777299805
Pre-training layer 1, epoch 85, representative training free energy -64215.0805254
Pre-training layer 1, epoch 85, validation free energy -63402.4273574
Pre-training layer 1, epoch 86, cost -269.446621246
Pre-training layer 1, epoch 87, cost -269.381888275
Pre-training layer 1, epoch 88, cost -269.377417297
Pre-training layer 1, epoch 89, cost -269.067211304
Pre-training layer 1, epoch 90, cost -269.205929718
Pre-training layer 1, epoch 90, representative training free energy -64567.3551855
Pre-training layer 1, epoch 90, validation free energy -63752.2803555
Pre-training layer 1, epoch 91, cost -269.027123108
Pre-training layer 1, epoch 92, cost -269.100631714
Pre-training layer 1, epoch 93, cost -268.839658203
Pre-training layer 1, epoch 94, cost -268.852657928
Pre-training layer 1, epoch 95, cost -268.590848999
Pre-training layer 1, epoch 95, representative training free energy -64826.3532559
Pre-training layer 1, epoch 95, validation free energy -64004.4921348
Pre-training layer 1, epoch 96, cost -268.53431488
Pre-training layer 1, epoch 97, cost -268.558999786
Pre-training layer 1, epoch 98, cost -268.232410126
Pre-training layer 1, epoch 99, cost -268.154312439
Pre-training layer 2, epoch 0, cost -162.823709869
Pre-training layer 2, epoch 0, representative training free energy 1789.18310623
Pre-training layer 2, epoch 0, validation free energy 1785.90240823
Pre-training layer 2, epoch 1, cost -108.627294235
Pre-training layer 2, epoch 2, cost -98.5251692963
Pre-training layer 2, epoch 3, cost -92.6676207733
Pre-training layer 2, epoch 4, cost -89.0781667328
Pre-training layer 2, epoch 5, cost -86.1338405609
Pre-training layer 2, epoch 5, representative training free energy 2651.0097951
Pre-training layer 2, epoch 5, validation free energy 2631.56001556
Pre-training layer 2, epoch 6, cost -84.1969219208
Pre-training layer 2, epoch 7, cost -82.3623233032
Pre-training layer 2, epoch 8, cost -80.8975211716
Pre-training layer 2, epoch 9, cost -79.5005804825
Pre-training layer 2, epoch 10, cost -78.2791503525
Pre-training layer 2, epoch 10, representative training free energy 3077.38671423
Pre-training layer 2, epoch 10, validation free energy 3041.78421942
Pre-training layer 2, epoch 11, cost -77.5708615875
Pre-training layer 2, epoch 12, cost -76.5168584061
Pre-training layer 2, epoch 13, cost -75.9319842911
Pre-training layer 2, epoch 14, cost -75.0740938187
Pre-training layer 2, epoch 15, cost -74.371812439
Pre-training layer 2, epoch 15, representative training free energy 3416.62081091
Pre-training layer 2, epoch 15, validation free energy 3369.77911401
Pre-training layer 2, epoch 16, cost -73.9041529846
Pre-training layer 2, epoch 17, cost -73.3144659042
Pre-training layer 2, epoch 18, cost -72.7728403091
Pre-training layer 2, epoch 19, cost -72.5142785645
Pre-training layer 2, epoch 20, cost -72.0644087982
Pre-training layer 2, epoch 20, representative training free energy 3702.48213
Pre-training layer 2, epoch 20, validation free energy 3649.47826294
Pre-training layer 2, epoch 21, cost -71.4833750534
Pre-training layer 2, epoch 22, cost -71.231305275
Pre-training layer 2, epoch 23, cost -71.0440345383
Pre-training layer 2, epoch 24, cost -70.5913558197
Pre-training layer 2, epoch 25, cost -70.268909874
Pre-training layer 2, epoch 25, representative training free energy 3923.52905939
Pre-training layer 2, epoch 25, validation free energy 3863.42640356
Pre-training layer 2, epoch 26, cost -70.3016661835
Pre-training layer 2, epoch 27, cost -69.9060563278
Pre-training layer 2, epoch 28, cost -69.5225925446
Pre-training layer 2, epoch 29, cost -69.2267523193
Pre-training layer 2, epoch 30, cost -69.1139876938
Pre-training layer 2, epoch 30, representative training free energy 4124.06065503
Pre-training layer 2, epoch 30, validation free energy 4061.85739978
Pre-training layer 2, epoch 31, cost -68.9690076828
Pre-training layer 2, epoch 32, cost -68.4574834824
Pre-training layer 2, epoch 33, cost -68.2293238068
Pre-training layer 2, epoch 34, cost -68.1781313705
Pre-training layer 2, epoch 35, cost -67.8566398239
Pre-training layer 2, epoch 35, representative training free energy 4319.39521191
Pre-training layer 2, epoch 35, validation free energy 4256.37323413
Pre-training layer 2, epoch 36, cost -67.7526095581
Pre-training layer 2, epoch 37, cost -67.6275175476
Pre-training layer 2, epoch 38, cost -67.3517232132
Pre-training layer 2, epoch 39, cost -67.3086633301
Pre-training layer 2, epoch 40, cost -67.2557395172
Pre-training layer 2, epoch 40, representative training free energy 4487.5990354
Pre-training layer 2, epoch 40, validation free energy 4420.36106494
Pre-training layer 2, epoch 41, cost -66.9518841934
Pre-training layer 2, epoch 42, cost -67.1241156769
Pre-training layer 2, epoch 43, cost -66.8097729874
Pre-training layer 2, epoch 44, cost -66.4038430405
Pre-training layer 2, epoch 45, cost -66.3890946579
Pre-training layer 2, epoch 45, representative training free energy 4647.60492041
Pre-training layer 2, epoch 45, validation free energy 4578.0286499
Pre-training layer 2, epoch 46, cost -66.4296482086
Pre-training layer 2, epoch 47, cost -66.1778953171
Pre-training layer 2, epoch 48, cost -66.2593978119
Pre-training layer 2, epoch 49, cost -66.0712916565
Pre-training layer 2, epoch 50, cost -65.7548677063
Pre-training layer 2, epoch 50, representative training free energy 4784.58995117
Pre-training layer 2, epoch 50, validation free energy 4712.42771692
Pre-training layer 2, epoch 51, cost -65.8791548538
Pre-training layer 2, epoch 52, cost -65.7464412689
Pre-training layer 2, epoch 53, cost -65.6212649918
Pre-training layer 2, epoch 54, cost -65.5581882095
Pre-training layer 2, epoch 55, cost -65.3905228043
Pre-training layer 2, epoch 55, representative training free energy 4941.58441382
Pre-training layer 2, epoch 55, validation free energy 4865.83416357
Pre-training layer 2, epoch 56, cost -65.3247229385
Pre-training layer 2, epoch 57, cost -65.3952987671
Pre-training layer 2, epoch 58, cost -65.1360799408
Pre-training layer 2, epoch 59, cost -65.1412393951
Pre-training layer 2, epoch 60, cost -65.059275856
Pre-training layer 2, epoch 60, representative training free energy 5064.20323413
Pre-training layer 2, epoch 60, validation free energy 4986.47507202
Pre-training layer 2, epoch 61, cost -64.854197998
Pre-training layer 2, epoch 62, cost -65.0044803238
Pre-training layer 2, epoch 63, cost -64.7916347885
Pre-training layer 2, epoch 64, cost -64.8764839172
Pre-training layer 2, epoch 65, cost -64.5978404236
Pre-training layer 2, epoch 65, representative training free energy 5187.95806958
Pre-training layer 2, epoch 65, validation free energy 5107.80554138
Pre-training layer 2, epoch 66, cost -64.5203993988
Pre-training layer 2, epoch 67, cost -64.5661567688
Pre-training layer 2, epoch 68, cost -64.6575220108
Pre-training layer 2, epoch 69, cost -64.1756376266
Pre-training layer 2, epoch 70, cost -64.3480422974
Pre-training layer 2, epoch 70, representative training free energy 5293.28390283
Pre-training layer 2, epoch 70, validation free energy 5211.67785034
Pre-training layer 2, epoch 71, cost -64.313630867
Pre-training layer 2, epoch 72, cost -64.0814864731
Pre-training layer 2, epoch 73, cost -64.3304607391
Pre-training layer 2, epoch 74, cost -63.9829753876
Pre-training layer 2, epoch 75, cost -64.0016889191
Pre-training layer 2, epoch 75, representative training free energy 5409.86260437
Pre-training layer 2, epoch 75, validation free energy 5327.05412366
Pre-training layer 2, epoch 76, cost -63.9811674118
Pre-training layer 2, epoch 77, cost -63.9431016922
Pre-training layer 2, epoch 78, cost -63.9435986328
Pre-training layer 2, epoch 79, cost -63.799939537
Pre-training layer 2, epoch 80, cost -63.7283306122
Pre-training layer 2, epoch 80, representative training free energy 5528.17126147
Pre-training layer 2, epoch 80, validation free energy 5443.34171301
Pre-training layer 2, epoch 81, cost -63.7394041443
Pre-training layer 2, epoch 82, cost -63.5150243759
Pre-training layer 2, epoch 83, cost -63.6147148132
Pre-training layer 2, epoch 84, cost -63.5281970215
Pre-training layer 2, epoch 85, cost -63.440020256
Pre-training layer 2, epoch 85, representative training free energy 5608.15168713
Pre-training layer 2, epoch 85, validation free energy 5521.82168567
Pre-training layer 2, epoch 86, cost -63.5457052612
Pre-training layer 2, epoch 87, cost -63.4087193298
Pre-training layer 2, epoch 88, cost -63.3654319
Pre-training layer 2, epoch 89, cost -63.2430872345
Pre-training layer 2, epoch 90, cost -63.1525675964
Pre-training layer 2, epoch 90, representative training free energy 5711.28925659
Pre-training layer 2, epoch 90, validation free energy 5621.20401245
Pre-training layer 2, epoch 91, cost -63.3280775833
Pre-training layer 2, epoch 92, cost -63.2102101517
Pre-training layer 2, epoch 93, cost -63.1728162384
Pre-training layer 2, epoch 94, cost -63.1192150879
Pre-training layer 2, epoch 95, cost -63.0788998413
Pre-training layer 2, epoch 95, representative training free energy 5802.33511304
Pre-training layer 2, epoch 95, validation free energy 5711.09691345
Pre-training layer 2, epoch 96, cost -63.225776329
Pre-training layer 2, epoch 97, cost -63.0751400375
Pre-training layer 2, epoch 98, cost -63.0556810379
Pre-training layer 2, epoch 99, cost -62.9526890182
The pretraining code for file dbn_loop.pyc ran for 2.77m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 100/100, validation error 37.200000 %
     epoch 1, minibatch 100/100, test error of best model 27.500000 %
epoch 2, minibatch 100/100, validation error 33.700000 %
     epoch 2, minibatch 100/100, test error of best model 21.400000 %
epoch 3, minibatch 100/100, validation error 30.600000 %
     epoch 3, minibatch 100/100, test error of best model 17.100000 %
epoch 4, minibatch 100/100, validation error 29.300000 %
     epoch 4, minibatch 100/100, test error of best model 16.300000 %
epoch 5, minibatch 100/100, validation error 28.600000 %
     epoch 5, minibatch 100/100, test error of best model 15.400000 %
epoch 6, minibatch 100/100, validation error 27.500000 %
     epoch 6, minibatch 100/100, test error of best model 14.900000 %
epoch 7, minibatch 100/100, validation error 26.900000 %
     epoch 7, minibatch 100/100, test error of best model 14.500000 %
epoch 8, minibatch 100/100, validation error 26.500000 %
     epoch 8, minibatch 100/100, test error of best model 13.800000 %
epoch 9, minibatch 100/100, validation error 26.400000 %
     epoch 9, minibatch 100/100, test error of best model 13.500000 %
epoch 10, minibatch 100/100, validation error 26.100000 %
     epoch 10, minibatch 100/100, test error of best model 13.100000 %
epoch 11, minibatch 100/100, validation error 25.900000 %
     epoch 11, minibatch 100/100, test error of best model 12.600000 %
epoch 12, minibatch 100/100, validation error 25.800000 %
     epoch 12, minibatch 100/100, test error of best model 12.300000 %
epoch 13, minibatch 100/100, validation error 25.700000 %
     epoch 13, minibatch 100/100, test error of best model 12.100000 %
epoch 14, minibatch 100/100, validation error 25.400000 %
     epoch 14, minibatch 100/100, test error of best model 12.100000 %
epoch 15, minibatch 100/100, validation error 24.900000 %
     epoch 15, minibatch 100/100, test error of best model 11.700000 %
epoch 16, minibatch 100/100, validation error 24.500000 %
     epoch 16, minibatch 100/100, test error of best model 11.800000 %
epoch 17, minibatch 100/100, validation error 24.600000 %
epoch 18, minibatch 100/100, validation error 24.500000 %
epoch 19, minibatch 100/100, validation error 24.500000 %
epoch 20, minibatch 100/100, validation error 24.300000 %
     epoch 20, minibatch 100/100, test error of best model 12.000000 %
epoch 21, minibatch 100/100, validation error 24.400000 %
epoch 22, minibatch 100/100, validation error 24.400000 %
epoch 23, minibatch 100/100, validation error 24.600000 %
epoch 24, minibatch 100/100, validation error 24.500000 %
epoch 25, minibatch 100/100, validation error 24.500000 %
epoch 26, minibatch 100/100, validation error 24.800000 %
epoch 27, minibatch 100/100, validation error 24.800000 %
epoch 28, minibatch 100/100, validation error 24.800000 %
epoch 29, minibatch 100/100, validation error 24.800000 %
epoch 30, minibatch 100/100, validation error 25.000000 %
epoch 31, minibatch 100/100, validation error 25.000000 %
epoch 32, minibatch 100/100, validation error 24.900000 %
epoch 33, minibatch 100/100, validation error 24.800000 %
epoch 34, minibatch 100/100, validation error 24.800000 %
epoch 35, minibatch 100/100, validation error 24.700000 %
epoch 36, minibatch 100/100, validation error 24.700000 %
epoch 37, minibatch 100/100, validation error 24.700000 %
epoch 38, minibatch 100/100, validation error 24.700000 %
epoch 39, minibatch 100/100, validation error 24.700000 %
Optimization complete with best validation score of 24.300000 %, obtained at iteration 2000, with test performance 12.000000 %
The fine tuning code for file dbn_loop.pyc ran for 0.47m


==========Sample: (2000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -161.708180542
Pre-training layer 0, epoch 0, representative training free energy -580.416869293
Pre-training layer 0, epoch 0, validation free energy -578.544516541
Pre-training layer 0, epoch 1, cost -123.28137001
Pre-training layer 0, epoch 2, cost -114.014294853
Pre-training layer 0, epoch 3, cost -108.251885376
Pre-training layer 0, epoch 4, cost -104.404921417
Pre-training layer 0, epoch 5, cost -101.252447662
Pre-training layer 0, epoch 5, representative training free energy -523.033539642
Pre-training layer 0, epoch 5, validation free energy -515.734224396
Pre-training layer 0, epoch 6, cost -98.9825737762
Pre-training layer 0, epoch 7, cost -96.6349280548
Pre-training layer 0, epoch 8, cost -95.3073345184
Pre-training layer 0, epoch 9, cost -93.952289505
Pre-training layer 0, epoch 10, cost -92.693352623
Pre-training layer 0, epoch 10, representative training free energy -501.399907013
Pre-training layer 0, epoch 10, validation free energy -493.719021667
Pre-training layer 0, epoch 11, cost -91.5754773331
Pre-training layer 0, epoch 12, cost -90.5020882797
Pre-training layer 0, epoch 13, cost -89.794175148
Pre-training layer 0, epoch 14, cost -88.9206738281
Pre-training layer 0, epoch 15, cost -88.2211046982
Pre-training layer 0, epoch 15, representative training free energy -494.84464209
Pre-training layer 0, epoch 15, validation free energy -485.055102295
Pre-training layer 0, epoch 16, cost -87.7826619339
Pre-training layer 0, epoch 17, cost -86.8697234344
Pre-training layer 0, epoch 18, cost -86.4911837006
Pre-training layer 0, epoch 19, cost -86.0013245392
Pre-training layer 0, epoch 20, cost -85.378282547
Pre-training layer 0, epoch 20, representative training free energy -483.902172363
Pre-training layer 0, epoch 20, validation free energy -474.025251892
Pre-training layer 0, epoch 21, cost -85.1640499115
Pre-training layer 0, epoch 22, cost -84.4578981781
Pre-training layer 0, epoch 23, cost -83.9690471649
Pre-training layer 0, epoch 24, cost -83.9292647552
Pre-training layer 0, epoch 25, cost -83.4023811722
Pre-training layer 0, epoch 25, representative training free energy -477.522524933
Pre-training layer 0, epoch 25, validation free energy -467.091681854
Pre-training layer 0, epoch 26, cost -83.0654373932
Pre-training layer 0, epoch 27, cost -82.8512578964
Pre-training layer 0, epoch 28, cost -82.6023346329
Pre-training layer 0, epoch 29, cost -82.2652976799
Pre-training layer 0, epoch 30, cost -81.8386002731
Pre-training layer 0, epoch 30, representative training free energy -470.647593903
Pre-training layer 0, epoch 30, validation free energy -460.571563995
Pre-training layer 0, epoch 31, cost -81.5348757553
Pre-training layer 0, epoch 32, cost -81.3517410278
Pre-training layer 0, epoch 33, cost -81.2233050537
Pre-training layer 0, epoch 34, cost -80.9060756874
Pre-training layer 0, epoch 35, cost -80.7572605515
Pre-training layer 0, epoch 35, representative training free energy -468.935518799
Pre-training layer 0, epoch 35, validation free energy -457.771144592
Pre-training layer 0, epoch 36, cost -80.4261307716
Pre-training layer 0, epoch 37, cost -80.1916583061
Pre-training layer 0, epoch 38, cost -80.0025009727
Pre-training layer 0, epoch 39, cost -79.7727675819
Pre-training layer 0, epoch 40, cost -79.8523870087
Pre-training layer 0, epoch 40, representative training free energy -466.177434448
Pre-training layer 0, epoch 40, validation free energy -455.236930786
Pre-training layer 0, epoch 41, cost -79.3839160538
Pre-training layer 0, epoch 42, cost -79.1799129677
Pre-training layer 0, epoch 43, cost -79.0390641022
Pre-training layer 0, epoch 44, cost -78.8780750656
Pre-training layer 0, epoch 45, cost -78.7916349602
Pre-training layer 0, epoch 45, representative training free energy -461.074917664
Pre-training layer 0, epoch 45, validation free energy -449.296007813
Pre-training layer 0, epoch 46, cost -78.6580628395
Pre-training layer 0, epoch 47, cost -78.5485132599
Pre-training layer 0, epoch 48, cost -78.2706808662
Pre-training layer 0, epoch 49, cost -78.0943844986
Pre-training layer 0, epoch 50, cost -77.9607397652
Pre-training layer 0, epoch 50, representative training free energy -461.779344849
Pre-training layer 0, epoch 50, validation free energy -449.843005585
Pre-training layer 0, epoch 51, cost -77.8381246376
Pre-training layer 0, epoch 52, cost -77.5915078735
Pre-training layer 0, epoch 53, cost -77.3863803101
Pre-training layer 0, epoch 54, cost -77.4998155403
Pre-training layer 0, epoch 55, cost -77.3970286369
Pre-training layer 0, epoch 55, representative training free energy -463.523880798
Pre-training layer 0, epoch 55, validation free energy -451.828047638
Pre-training layer 0, epoch 56, cost -77.2680843925
Pre-training layer 0, epoch 57, cost -76.9576547623
Pre-training layer 0, epoch 58, cost -77.1144318962
Pre-training layer 0, epoch 59, cost -76.9933651733
Pre-training layer 0, epoch 60, cost -76.8526247215
Pre-training layer 0, epoch 60, representative training free energy -457.509255554
Pre-training layer 0, epoch 60, validation free energy -444.571567963
Pre-training layer 0, epoch 61, cost -76.5912029648
Pre-training layer 0, epoch 62, cost -76.5817553902
Pre-training layer 0, epoch 63, cost -76.1710668564
Pre-training layer 0, epoch 64, cost -76.2735193634
Pre-training layer 0, epoch 65, cost -76.1901130867
Pre-training layer 0, epoch 65, representative training free energy -458.472592163
Pre-training layer 0, epoch 65, validation free energy -445.909470276
Pre-training layer 0, epoch 66, cost -76.1210641479
Pre-training layer 0, epoch 67, cost -75.9858009911
Pre-training layer 0, epoch 68, cost -75.9042617798
Pre-training layer 0, epoch 69, cost -75.8850996971
Pre-training layer 0, epoch 70, cost -75.7555487251
Pre-training layer 0, epoch 70, representative training free energy -460.702865295
Pre-training layer 0, epoch 70, validation free energy -447.633743439
Pre-training layer 0, epoch 71, cost -75.5004122162
Pre-training layer 0, epoch 72, cost -75.5138523865
Pre-training layer 0, epoch 73, cost -75.4791383743
Pre-training layer 0, epoch 74, cost -75.3177738953
Pre-training layer 0, epoch 75, cost -75.2912794495
Pre-training layer 0, epoch 75, representative training free energy -454.754048248
Pre-training layer 0, epoch 75, validation free energy -441.674154755
Pre-training layer 0, epoch 76, cost -75.1659789658
Pre-training layer 0, epoch 77, cost -75.1925997353
Pre-training layer 0, epoch 78, cost -75.051837635
Pre-training layer 0, epoch 79, cost -75.0277238464
Pre-training layer 0, epoch 80, cost -74.8348890686
Pre-training layer 0, epoch 80, representative training free energy -457.999972443
Pre-training layer 0, epoch 80, validation free energy -444.861447021
Pre-training layer 0, epoch 81, cost -74.8925728226
Pre-training layer 0, epoch 82, cost -74.6477957726
Pre-training layer 0, epoch 83, cost -74.6125100899
Pre-training layer 0, epoch 84, cost -74.6961505127
Pre-training layer 0, epoch 85, cost -74.5574570274
Pre-training layer 0, epoch 85, representative training free energy -453.821748444
Pre-training layer 0, epoch 85, validation free energy -441.216878998
Pre-training layer 0, epoch 86, cost -74.4322348785
Pre-training layer 0, epoch 87, cost -74.3151672935
Pre-training layer 0, epoch 88, cost -74.3517748833
Pre-training layer 0, epoch 89, cost -74.4433486557
Pre-training layer 0, epoch 90, cost -74.2076197052
Pre-training layer 0, epoch 90, representative training free energy -452.660691162
Pre-training layer 0, epoch 90, validation free energy -438.330174652
Pre-training layer 0, epoch 91, cost -74.118885994
Pre-training layer 0, epoch 92, cost -74.2440033913
Pre-training layer 0, epoch 93, cost -73.8212293816
Pre-training layer 0, epoch 94, cost -73.802191124
Pre-training layer 0, epoch 95, cost -73.9736420059
Pre-training layer 0, epoch 95, representative training free energy -452.49540564
Pre-training layer 0, epoch 95, validation free energy -437.951957458
Pre-training layer 0, epoch 96, cost -73.8494153976
Pre-training layer 0, epoch 97, cost -73.6644709015
Pre-training layer 0, epoch 98, cost -73.7684141159
Pre-training layer 0, epoch 99, cost -73.6669659996
Pre-training layer 1, epoch 0, cost -375.719617081
Pre-training layer 1, epoch 0, representative training free energy -42868.3635068
Pre-training layer 1, epoch 0, validation free energy -42589.7222285
Pre-training layer 1, epoch 1, cost -323.301638794
Pre-training layer 1, epoch 2, cost -306.658724365
Pre-training layer 1, epoch 3, cost -296.543018951
Pre-training layer 1, epoch 4, cost -289.607955856
Pre-training layer 1, epoch 5, cost -284.654176941
Pre-training layer 1, epoch 5, representative training free energy -59051.471168
Pre-training layer 1, epoch 5, validation free energy -58616.6924609
Pre-training layer 1, epoch 6, cost -280.368677063
Pre-training layer 1, epoch 7, cost -277.158342133
Pre-training layer 1, epoch 8, cost -274.209332428
Pre-training layer 1, epoch 9, cost -271.841938171
Pre-training layer 1, epoch 10, cost -269.740991516
Pre-training layer 1, epoch 10, representative training free energy -63858.8432754
Pre-training layer 1, epoch 10, validation free energy -63394.7160078
Pre-training layer 1, epoch 11, cost -267.827913284
Pre-training layer 1, epoch 12, cost -266.28862381
Pre-training layer 1, epoch 13, cost -264.753305664
Pre-training layer 1, epoch 14, cost -263.385764084
Pre-training layer 1, epoch 15, cost -262.270508881
Pre-training layer 1, epoch 15, representative training free energy -66680.1449648
Pre-training layer 1, epoch 15, validation free energy -66192.8078203
Pre-training layer 1, epoch 16, cost -261.186448975
Pre-training layer 1, epoch 17, cost -260.271306839
Pre-training layer 1, epoch 18, cost -259.339178391
Pre-training layer 1, epoch 19, cost -258.382810059
Pre-training layer 1, epoch 20, cost -257.770859604
Pre-training layer 1, epoch 20, representative training free energy -68760.9065293
Pre-training layer 1, epoch 20, validation free energy -68261.8084707
Pre-training layer 1, epoch 21, cost -256.944443741
Pre-training layer 1, epoch 22, cost -256.353089066
Pre-training layer 1, epoch 23, cost -255.716839828
Pre-training layer 1, epoch 24, cost -255.229730377
Pre-training layer 1, epoch 25, cost -254.756040421
Pre-training layer 1, epoch 25, representative training free energy -70369.9298555
Pre-training layer 1, epoch 25, validation free energy -69864.5278887
Pre-training layer 1, epoch 26, cost -254.152144699
Pre-training layer 1, epoch 27, cost -253.764927216
Pre-training layer 1, epoch 28, cost -253.325923767
Pre-training layer 1, epoch 29, cost -252.856094055
Pre-training layer 1, epoch 30, cost -252.370919418
Pre-training layer 1, epoch 30, representative training free energy -71593.3145684
Pre-training layer 1, epoch 30, validation free energy -71085.8994785
Pre-training layer 1, epoch 31, cost -251.980222321
Pre-training layer 1, epoch 32, cost -251.813957901
Pre-training layer 1, epoch 33, cost -251.459125824
Pre-training layer 1, epoch 34, cost -251.027555161
Pre-training layer 1, epoch 35, cost -250.727368469
Pre-training layer 1, epoch 35, representative training free energy -72607.9627773
Pre-training layer 1, epoch 35, validation free energy -72086.6297793
Pre-training layer 1, epoch 36, cost -250.469331055
Pre-training layer 1, epoch 37, cost -250.094941483
Pre-training layer 1, epoch 38, cost -250.146345978
Pre-training layer 1, epoch 39, cost -249.454241486
Pre-training layer 1, epoch 40, cost -249.275901642
Pre-training layer 1, epoch 40, representative training free energy -73409.6717676
Pre-training layer 1, epoch 40, validation free energy -72881.0649844
Pre-training layer 1, epoch 41, cost -248.949152603
Pre-training layer 1, epoch 42, cost -248.896030502
Pre-training layer 1, epoch 43, cost -248.564347534
Pre-training layer 1, epoch 44, cost -248.590470963
Pre-training layer 1, epoch 45, cost -248.19794838
Pre-training layer 1, epoch 45, representative training free energy -74289.3201895
Pre-training layer 1, epoch 45, validation free energy -73758.6769961
Pre-training layer 1, epoch 46, cost -248.182500229
Pre-training layer 1, epoch 47, cost -247.630965118
Pre-training layer 1, epoch 48, cost -247.725307465
Pre-training layer 1, epoch 49, cost -247.43108429
Pre-training layer 1, epoch 50, cost -247.268522415
Pre-training layer 1, epoch 50, representative training free energy -75061.1092891
Pre-training layer 1, epoch 50, validation free energy -74530.0582012
Pre-training layer 1, epoch 51, cost -247.071319885
Pre-training layer 1, epoch 52, cost -247.027402725
Pre-training layer 1, epoch 53, cost -246.722233963
Pre-training layer 1, epoch 54, cost -246.582118378
Pre-training layer 1, epoch 55, cost -246.389140015
Pre-training layer 1, epoch 55, representative training free energy -75711.2696406
Pre-training layer 1, epoch 55, validation free energy -75152.5652285
Pre-training layer 1, epoch 56, cost -246.265717545
Pre-training layer 1, epoch 57, cost -246.203227005
Pre-training layer 1, epoch 58, cost -245.964530563
Pre-training layer 1, epoch 59, cost -245.978476562
Pre-training layer 1, epoch 60, cost -245.759201965
Pre-training layer 1, epoch 60, representative training free energy -76218.7341953
Pre-training layer 1, epoch 60, validation free energy -75664.1097031
Pre-training layer 1, epoch 61, cost -245.578689423
Pre-training layer 1, epoch 62, cost -245.387425308
Pre-training layer 1, epoch 63, cost -245.325341568
Pre-training layer 1, epoch 64, cost -245.322883606
Pre-training layer 1, epoch 65, cost -245.144302597
Pre-training layer 1, epoch 65, representative training free energy -76757.6493418
Pre-training layer 1, epoch 65, validation free energy -76198.3625039
Pre-training layer 1, epoch 66, cost -244.984182358
Pre-training layer 1, epoch 67, cost -244.994507828
Pre-training layer 1, epoch 68, cost -244.665407333
Pre-training layer 1, epoch 69, cost -244.666927109
Pre-training layer 1, epoch 70, cost -244.505300903
Pre-training layer 1, epoch 70, representative training free energy -77214.2144687
Pre-training layer 1, epoch 70, validation free energy -76652.103541
Pre-training layer 1, epoch 71, cost -244.577048798
Pre-training layer 1, epoch 72, cost -244.459029007
Pre-training layer 1, epoch 73, cost -244.302337418
Pre-training layer 1, epoch 74, cost -244.109991684
Pre-training layer 1, epoch 75, cost -244.118642044
Pre-training layer 1, epoch 75, representative training free energy -77685.6697305
Pre-training layer 1, epoch 75, validation free energy -77110.9893086
Pre-training layer 1, epoch 76, cost -243.872300034
Pre-training layer 1, epoch 77, cost -243.952378464
Pre-training layer 1, epoch 78, cost -243.795475922
Pre-training layer 1, epoch 79, cost -243.70067482
Pre-training layer 1, epoch 80, cost -243.586076202
Pre-training layer 1, epoch 80, representative training free energy -78157.7803418
Pre-training layer 1, epoch 80, validation free energy -77582.2011934
Pre-training layer 1, epoch 81, cost -243.486538467
Pre-training layer 1, epoch 82, cost -243.447552567
Pre-training layer 1, epoch 83, cost -243.374918594
Pre-training layer 1, epoch 84, cost -243.271251221
Pre-training layer 1, epoch 85, cost -243.253951721
Pre-training layer 1, epoch 85, representative training free energy -78542.8719551
Pre-training layer 1, epoch 85, validation free energy -77971.6052891
Pre-training layer 1, epoch 86, cost -243.156390839
Pre-training layer 1, epoch 87, cost -243.14771431
Pre-training layer 1, epoch 88, cost -242.875358658
Pre-training layer 1, epoch 89, cost -242.787667236
Pre-training layer 1, epoch 90, cost -242.809252625
Pre-training layer 1, epoch 90, representative training free energy -78960.3534082
Pre-training layer 1, epoch 90, validation free energy -78376.8179141
Pre-training layer 1, epoch 91, cost -242.753792877
Pre-training layer 1, epoch 92, cost -242.656241608
Pre-training layer 1, epoch 93, cost -242.598995743
Pre-training layer 1, epoch 94, cost -242.558466949
Pre-training layer 1, epoch 95, cost -242.512628326
Pre-training layer 1, epoch 95, representative training free energy -79277.6370195
Pre-training layer 1, epoch 95, validation free energy -78688.8251211
Pre-training layer 1, epoch 96, cost -242.510381317
Pre-training layer 1, epoch 97, cost -242.463208084
Pre-training layer 1, epoch 98, cost -242.414448853
Pre-training layer 1, epoch 99, cost -242.210790253
Pre-training layer 2, epoch 0, cost -137.783674278
Pre-training layer 2, epoch 0, representative training free energy 2226.34565848
Pre-training layer 2, epoch 0, validation free energy 2246.57826215
Pre-training layer 2, epoch 1, cost -98.5509960175
Pre-training layer 2, epoch 2, cost -90.7717225075
Pre-training layer 2, epoch 3, cost -86.1528390503
Pre-training layer 2, epoch 4, cost -83.3001229095
Pre-training layer 2, epoch 5, cost -80.9162420273
Pre-training layer 2, epoch 5, representative training free energy 3438.79613391
Pre-training layer 2, epoch 5, validation free energy 3458.03322083
Pre-training layer 2, epoch 6, cost -79.1331987953
Pre-training layer 2, epoch 7, cost -77.6512558365
Pre-training layer 2, epoch 8, cost -76.4768232346
Pre-training layer 2, epoch 9, cost -75.5852461624
Pre-training layer 2, epoch 10, cost -74.5543115234
Pre-training layer 2, epoch 10, representative training free energy 4221.28676764
Pre-training layer 2, epoch 10, validation free energy 4235.02807629
Pre-training layer 2, epoch 11, cost -73.7633149529
Pre-training layer 2, epoch 12, cost -73.0451564598
Pre-training layer 2, epoch 13, cost -72.5220146942
Pre-training layer 2, epoch 14, cost -71.9570088005
Pre-training layer 2, epoch 15, cost -71.463145256
Pre-training layer 2, epoch 15, representative training free energy 4802.65241138
Pre-training layer 2, epoch 15, validation free energy 4785.96816833
Pre-training layer 2, epoch 16, cost -70.847608242
Pre-training layer 2, epoch 17, cost -70.4119580078
Pre-training layer 2, epoch 18, cost -70.2023534393
Pre-training layer 2, epoch 19, cost -69.7512973785
Pre-training layer 2, epoch 20, cost -69.2396603394
Pre-training layer 2, epoch 20, representative training free energy 5277.823698
Pre-training layer 2, epoch 20, validation free energy 5245.07311462
Pre-training layer 2, epoch 21, cost -69.1684200287
Pre-training layer 2, epoch 22, cost -68.8665195656
Pre-training layer 2, epoch 23, cost -68.5742724037
Pre-training layer 2, epoch 24, cost -68.5469264984
Pre-training layer 2, epoch 25, cost -68.1614712715
Pre-training layer 2, epoch 25, representative training free energy 5639.58483594
Pre-training layer 2, epoch 25, validation free energy 5596.67570825
Pre-training layer 2, epoch 26, cost -67.8663201332
Pre-training layer 2, epoch 27, cost -67.7957292557
Pre-training layer 2, epoch 28, cost -67.6133422661
Pre-training layer 2, epoch 29, cost -67.3963109016
Pre-training layer 2, epoch 30, cost -67.1640715599
Pre-training layer 2, epoch 30, representative training free energy 5989.35601111
Pre-training layer 2, epoch 30, validation free energy 5940.60204321
Pre-training layer 2, epoch 31, cost -66.8498667526
Pre-training layer 2, epoch 32, cost -66.8377375793
Pre-training layer 2, epoch 33, cost -66.5312815475
Pre-training layer 2, epoch 34, cost -66.5319142914
Pre-training layer 2, epoch 35, cost -66.4118392372
Pre-training layer 2, epoch 35, representative training free energy 6286.52109094
Pre-training layer 2, epoch 35, validation free energy 6234.99711304
Pre-training layer 2, epoch 36, cost -66.2791168022
Pre-training layer 2, epoch 37, cost -66.2130018425
Pre-training layer 2, epoch 38, cost -66.1440028763
Pre-training layer 2, epoch 39, cost -65.9494998932
Pre-training layer 2, epoch 40, cost -65.8943791199
Pre-training layer 2, epoch 40, representative training free energy 6547.6627113
Pre-training layer 2, epoch 40, validation free energy 6493.5220874
Pre-training layer 2, epoch 41, cost -65.7147970963
Pre-training layer 2, epoch 42, cost -65.7423913574
Pre-training layer 2, epoch 43, cost -65.533599472
Pre-training layer 2, epoch 44, cost -65.5287721634
Pre-training layer 2, epoch 45, cost -65.355783329
Pre-training layer 2, epoch 45, representative training free energy 6795.27693506
Pre-training layer 2, epoch 45, validation free energy 6738.07099585
Pre-training layer 2, epoch 46, cost -65.1797757721
Pre-training layer 2, epoch 47, cost -65.1297114182
Pre-training layer 2, epoch 48, cost -65.0104430962
Pre-training layer 2, epoch 49, cost -65.0859664154
Pre-training layer 2, epoch 50, cost -64.8613131905
Pre-training layer 2, epoch 50, representative training free energy 7020.07309619
Pre-training layer 2, epoch 50, validation free energy 6961.78579126
Pre-training layer 2, epoch 51, cost -64.8083841324
Pre-training layer 2, epoch 52, cost -64.7635781288
Pre-training layer 2, epoch 53, cost -64.6612227058
Pre-training layer 2, epoch 54, cost -64.6456961441
Pre-training layer 2, epoch 55, cost -64.674851017
Pre-training layer 2, epoch 55, representative training free energy 7230.92310059
Pre-training layer 2, epoch 55, validation free energy 7168.68404956
Pre-training layer 2, epoch 56, cost -64.6035889816
Pre-training layer 2, epoch 57, cost -64.5547048569
Pre-training layer 2, epoch 58, cost -64.4096925354
Pre-training layer 2, epoch 59, cost -64.1944631195
Pre-training layer 2, epoch 60, cost -64.3163356209
Pre-training layer 2, epoch 60, representative training free energy 7437.7061272
Pre-training layer 2, epoch 60, validation free energy 7374.21908765
Pre-training layer 2, epoch 61, cost -64.1584422112
Pre-training layer 2, epoch 62, cost -64.1610572243
Pre-training layer 2, epoch 63, cost -64.0596562576
Pre-training layer 2, epoch 64, cost -64.1270278931
Pre-training layer 2, epoch 65, cost -64.0466411018
Pre-training layer 2, epoch 65, representative training free energy 7632.54871582
Pre-training layer 2, epoch 65, validation free energy 7566.69264429
Pre-training layer 2, epoch 66, cost -63.8033546448
Pre-training layer 2, epoch 67, cost -63.9180142212
Pre-training layer 2, epoch 68, cost -64.0176817131
Pre-training layer 2, epoch 69, cost -63.8263553047
Pre-training layer 2, epoch 70, cost -63.877538147
Pre-training layer 2, epoch 70, representative training free energy 7816.44506958
Pre-training layer 2, epoch 70, validation free energy 7748.06952979
Pre-training layer 2, epoch 71, cost -63.7918441391
Pre-training layer 2, epoch 72, cost -63.6878758812
Pre-training layer 2, epoch 73, cost -63.6481387711
Pre-training layer 2, epoch 74, cost -63.6932422638
Pre-training layer 2, epoch 75, cost -63.5862850571
Pre-training layer 2, epoch 75, representative training free energy 7992.94778833
Pre-training layer 2, epoch 75, validation free energy 7922.97169702
Pre-training layer 2, epoch 76, cost -63.6760449028
Pre-training layer 2, epoch 77, cost -63.4993476868
Pre-training layer 2, epoch 78, cost -63.5368979645
Pre-training layer 2, epoch 79, cost -63.4775347519
Pre-training layer 2, epoch 80, cost -63.3779985237
Pre-training layer 2, epoch 80, representative training free energy 8132.79267407
Pre-training layer 2, epoch 80, validation free energy 8062.10381982
Pre-training layer 2, epoch 81, cost -63.5409822083
Pre-training layer 2, epoch 82, cost -63.3699566078
Pre-training layer 2, epoch 83, cost -63.2196536446
Pre-training layer 2, epoch 84, cost -63.2877608299
Pre-training layer 2, epoch 85, cost -63.3596936035
Pre-training layer 2, epoch 85, representative training free energy 8299.16238208
Pre-training layer 2, epoch 85, validation free energy 8223.90676318
Pre-training layer 2, epoch 86, cost -63.2149993896
Pre-training layer 2, epoch 87, cost -63.2989153671
Pre-training layer 2, epoch 88, cost -63.1697482681
Pre-training layer 2, epoch 89, cost -63.1731102753
Pre-training layer 2, epoch 90, cost -62.9760626793
Pre-training layer 2, epoch 90, representative training free energy 8445.4629668
Pre-training layer 2, epoch 90, validation free energy 8369.84729419
Pre-training layer 2, epoch 91, cost -63.0786128998
Pre-training layer 2, epoch 92, cost -63.0231072044
Pre-training layer 2, epoch 93, cost -62.9271723938
Pre-training layer 2, epoch 94, cost -62.9703141785
Pre-training layer 2, epoch 95, cost -62.97881073
Pre-training layer 2, epoch 95, representative training free energy 8582.61714062
Pre-training layer 2, epoch 95, validation free energy 8503.77742969
Pre-training layer 2, epoch 96, cost -62.9620986938
Pre-training layer 2, epoch 97, cost -63.0150424957
Pre-training layer 2, epoch 98, cost -62.869718132
Pre-training layer 2, epoch 99, cost -62.8014151382
The pretraining code for file dbn_loop.pyc ran for 5.32m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 200/200, validation error 35.200000 %
     epoch 1, minibatch 200/200, test error of best model 30.200000 %
epoch 2, minibatch 200/200, validation error 26.100000 %
     epoch 2, minibatch 200/200, test error of best model 19.800000 %
epoch 3, minibatch 200/200, validation error 23.200000 %
     epoch 3, minibatch 200/200, test error of best model 14.800000 %
epoch 4, minibatch 200/200, validation error 21.600000 %
     epoch 4, minibatch 200/200, test error of best model 13.000000 %
epoch 5, minibatch 200/200, validation error 20.800000 %
     epoch 5, minibatch 200/200, test error of best model 12.000000 %
epoch 6, minibatch 200/200, validation error 20.000000 %
     epoch 6, minibatch 200/200, test error of best model 10.600000 %
epoch 7, minibatch 200/200, validation error 19.900000 %
     epoch 7, minibatch 200/200, test error of best model 9.800000 %
epoch 8, minibatch 200/200, validation error 19.700000 %
     epoch 8, minibatch 200/200, test error of best model 9.500000 %
epoch 9, minibatch 200/200, validation error 19.400000 %
     epoch 9, minibatch 200/200, test error of best model 9.300000 %
epoch 10, minibatch 200/200, validation error 18.600000 %
     epoch 10, minibatch 200/200, test error of best model 8.600000 %
epoch 11, minibatch 200/200, validation error 18.400000 %
     epoch 11, minibatch 200/200, test error of best model 8.100000 %
epoch 12, minibatch 200/200, validation error 18.400000 %
epoch 13, minibatch 200/200, validation error 18.300000 %
     epoch 13, minibatch 200/200, test error of best model 7.400000 %
epoch 14, minibatch 200/200, validation error 18.000000 %
     epoch 14, minibatch 200/200, test error of best model 7.400000 %
epoch 15, minibatch 200/200, validation error 17.600000 %
     epoch 15, minibatch 200/200, test error of best model 7.400000 %
epoch 16, minibatch 200/200, validation error 17.300000 %
     epoch 16, minibatch 200/200, test error of best model 7.200000 %
epoch 17, minibatch 200/200, validation error 17.300000 %
epoch 18, minibatch 200/200, validation error 17.300000 %
epoch 19, minibatch 200/200, validation error 17.100000 %
     epoch 19, minibatch 200/200, test error of best model 7.300000 %
epoch 20, minibatch 200/200, validation error 16.900000 %
     epoch 20, minibatch 200/200, test error of best model 6.900000 %
epoch 21, minibatch 200/200, validation error 17.000000 %
epoch 22, minibatch 200/200, validation error 16.900000 %
epoch 23, minibatch 200/200, validation error 16.800000 %
     epoch 23, minibatch 200/200, test error of best model 7.400000 %
epoch 24, minibatch 200/200, validation error 16.700000 %
     epoch 24, minibatch 200/200, test error of best model 7.300000 %
epoch 25, minibatch 200/200, validation error 16.700000 %
epoch 26, minibatch 200/200, validation error 16.700000 %
epoch 27, minibatch 200/200, validation error 16.600000 %
     epoch 27, minibatch 200/200, test error of best model 7.100000 %
epoch 28, minibatch 200/200, validation error 16.600000 %
epoch 29, minibatch 200/200, validation error 16.600000 %
epoch 30, minibatch 200/200, validation error 16.600000 %
epoch 31, minibatch 200/200, validation error 16.600000 %
epoch 32, minibatch 200/200, validation error 16.700000 %
epoch 33, minibatch 200/200, validation error 16.700000 %
epoch 34, minibatch 200/200, validation error 16.700000 %
epoch 35, minibatch 200/200, validation error 16.500000 %
     epoch 35, minibatch 200/200, test error of best model 7.000000 %
epoch 36, minibatch 200/200, validation error 16.500000 %
epoch 37, minibatch 200/200, validation error 16.500000 %
epoch 38, minibatch 200/200, validation error 16.500000 %
epoch 39, minibatch 200/200, validation error 16.500000 %
epoch 40, minibatch 200/200, validation error 16.400000 %
     epoch 40, minibatch 200/200, test error of best model 7.000000 %
epoch 41, minibatch 200/200, validation error 16.400000 %
epoch 42, minibatch 200/200, validation error 16.400000 %
epoch 43, minibatch 200/200, validation error 16.400000 %
epoch 44, minibatch 200/200, validation error 16.400000 %
epoch 45, minibatch 200/200, validation error 16.400000 %
epoch 46, minibatch 200/200, validation error 16.400000 %
epoch 47, minibatch 200/200, validation error 16.400000 %
epoch 48, minibatch 200/200, validation error 16.400000 %
epoch 49, minibatch 200/200, validation error 16.400000 %
epoch 50, minibatch 200/200, validation error 16.400000 %
epoch 51, minibatch 200/200, validation error 16.400000 %
epoch 52, minibatch 200/200, validation error 16.300000 %
     epoch 52, minibatch 200/200, test error of best model 7.100000 %
epoch 53, minibatch 200/200, validation error 16.300000 %
epoch 54, minibatch 200/200, validation error 16.300000 %
epoch 55, minibatch 200/200, validation error 16.300000 %
epoch 56, minibatch 200/200, validation error 16.300000 %
epoch 57, minibatch 200/200, validation error 16.300000 %
epoch 58, minibatch 200/200, validation error 16.300000 %
epoch 59, minibatch 200/200, validation error 16.300000 %
epoch 60, minibatch 200/200, validation error 16.300000 %
epoch 61, minibatch 200/200, validation error 16.300000 %
epoch 62, minibatch 200/200, validation error 16.300000 %
epoch 63, minibatch 200/200, validation error 16.300000 %
epoch 64, minibatch 200/200, validation error 16.200000 %
     epoch 64, minibatch 200/200, test error of best model 7.000000 %
epoch 65, minibatch 200/200, validation error 16.200000 %
epoch 66, minibatch 200/200, validation error 16.200000 %
epoch 67, minibatch 200/200, validation error 16.300000 %
epoch 68, minibatch 200/200, validation error 16.300000 %
epoch 69, minibatch 200/200, validation error 16.300000 %
epoch 70, minibatch 200/200, validation error 16.300000 %
epoch 71, minibatch 200/200, validation error 16.300000 %
epoch 72, minibatch 200/200, validation error 16.300000 %
epoch 73, minibatch 200/200, validation error 16.300000 %
epoch 74, minibatch 200/200, validation error 16.300000 %
epoch 75, minibatch 200/200, validation error 16.300000 %
epoch 76, minibatch 200/200, validation error 16.300000 %
epoch 77, minibatch 200/200, validation error 16.300000 %
epoch 78, minibatch 200/200, validation error 16.300000 %
epoch 79, minibatch 200/200, validation error 16.300000 %
epoch 80, minibatch 200/200, validation error 16.300000 %
epoch 81, minibatch 200/200, validation error 16.300000 %
epoch 82, minibatch 200/200, validation error 16.300000 %
epoch 83, minibatch 200/200, validation error 16.300000 %
epoch 84, minibatch 200/200, validation error 16.300000 %
epoch 85, minibatch 200/200, validation error 16.400000 %
epoch 86, minibatch 200/200, validation error 16.400000 %
epoch 87, minibatch 200/200, validation error 16.400000 %
epoch 88, minibatch 200/200, validation error 16.400000 %
epoch 89, minibatch 200/200, validation error 16.400000 %
epoch 90, minibatch 200/200, validation error 16.400000 %
epoch 91, minibatch 200/200, validation error 16.400000 %
epoch 92, minibatch 200/200, validation error 16.400000 %
epoch 93, minibatch 200/200, validation error 16.400000 %
epoch 94, minibatch 200/200, validation error 16.400000 %
epoch 95, minibatch 200/200, validation error 16.400000 %
epoch 96, minibatch 200/200, validation error 16.400000 %
epoch 97, minibatch 200/200, validation error 16.400000 %
epoch 98, minibatch 200/200, validation error 16.400000 %
epoch 99, minibatch 200/200, validation error 16.400000 %
epoch 100, minibatch 200/200, validation error 16.400000 %
epoch 101, minibatch 200/200, validation error 16.400000 %
epoch 102, minibatch 200/200, validation error 16.400000 %
epoch 103, minibatch 200/200, validation error 16.500000 %
epoch 104, minibatch 200/200, validation error 16.600000 %
epoch 105, minibatch 200/200, validation error 16.600000 %
epoch 106, minibatch 200/200, validation error 16.600000 %
epoch 107, minibatch 200/200, validation error 16.600000 %
epoch 108, minibatch 200/200, validation error 16.600000 %
epoch 109, minibatch 200/200, validation error 16.600000 %
epoch 110, minibatch 200/200, validation error 16.600000 %
epoch 111, minibatch 200/200, validation error 16.600000 %
epoch 112, minibatch 200/200, validation error 16.600000 %
epoch 113, minibatch 200/200, validation error 16.600000 %
epoch 114, minibatch 200/200, validation error 16.600000 %
epoch 115, minibatch 200/200, validation error 16.600000 %
epoch 116, minibatch 200/200, validation error 16.600000 %
epoch 117, minibatch 200/200, validation error 16.600000 %
epoch 118, minibatch 200/200, validation error 16.600000 %
epoch 119, minibatch 200/200, validation error 16.600000 %
epoch 120, minibatch 200/200, validation error 16.500000 %
epoch 121, minibatch 200/200, validation error 16.500000 %
epoch 122, minibatch 200/200, validation error 16.500000 %
epoch 123, minibatch 200/200, validation error 16.500000 %
epoch 124, minibatch 200/200, validation error 16.500000 %
epoch 125, minibatch 200/200, validation error 16.500000 %
epoch 126, minibatch 200/200, validation error 16.500000 %
epoch 127, minibatch 200/200, validation error 16.500000 %
Optimization complete with best validation score of 16.200000 %, obtained at iteration 12800, with test performance 7.000000 %
The fine tuning code for file dbn_loop.pyc ran for 2.38m


==========Sample: (3000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -150.799255447
Pre-training layer 0, epoch 0, representative training free energy -564.75210022
Pre-training layer 0, epoch 0, validation free energy -559.775762268
Pre-training layer 0, epoch 1, cost -116.745048523
Pre-training layer 0, epoch 2, cost -108.069781011
Pre-training layer 0, epoch 3, cost -102.697687988
Pre-training layer 0, epoch 4, cost -99.255796051
Pre-training layer 0, epoch 5, cost -96.5080286407
Pre-training layer 0, epoch 5, representative training free energy -504.59076651
Pre-training layer 0, epoch 5, validation free energy -497.489487122
Pre-training layer 0, epoch 6, cost -94.5093643697
Pre-training layer 0, epoch 7, cost -92.808605957
Pre-training layer 0, epoch 8, cost -91.5642561595
Pre-training layer 0, epoch 9, cost -90.0365509033
Pre-training layer 0, epoch 10, cost -89.1712291336
Pre-training layer 0, epoch 10, representative training free energy -482.50277771
Pre-training layer 0, epoch 10, validation free energy -474.798775909
Pre-training layer 0, epoch 11, cost -88.2837508392
Pre-training layer 0, epoch 12, cost -87.4014191691
Pre-training layer 0, epoch 13, cost -86.7174258677
Pre-training layer 0, epoch 14, cost -86.0546083323
Pre-training layer 0, epoch 15, cost -85.4232436244
Pre-training layer 0, epoch 15, representative training free energy -466.874971832
Pre-training layer 0, epoch 15, validation free energy -459.28900769
Pre-training layer 0, epoch 16, cost -84.6397128042
Pre-training layer 0, epoch 17, cost -84.4120630264
Pre-training layer 0, epoch 18, cost -83.772482694
Pre-training layer 0, epoch 19, cost -83.4836871719
Pre-training layer 0, epoch 20, cost -83.0704477056
Pre-training layer 0, epoch 20, representative training free energy -457.179627319
Pre-training layer 0, epoch 20, validation free energy -449.118177246
Pre-training layer 0, epoch 21, cost -82.7430279287
Pre-training layer 0, epoch 22, cost -82.2980298615
Pre-training layer 0, epoch 23, cost -82.0292163849
Pre-training layer 0, epoch 24, cost -81.6289459101
Pre-training layer 0, epoch 25, cost -81.4673241806
Pre-training layer 0, epoch 25, representative training free energy -454.004593048
Pre-training layer 0, epoch 25, validation free energy -444.982036194
Pre-training layer 0, epoch 26, cost -81.0589928055
Pre-training layer 0, epoch 27, cost -80.8386492157
Pre-training layer 0, epoch 28, cost -80.5231122589
Pre-training layer 0, epoch 29, cost -80.2954253133
Pre-training layer 0, epoch 30, cost -80.0236607869
Pre-training layer 0, epoch 30, representative training free energy -450.610029816
Pre-training layer 0, epoch 30, validation free energy -442.455351074
Pre-training layer 0, epoch 31, cost -79.8569122187
Pre-training layer 0, epoch 32, cost -79.5958480581
Pre-training layer 0, epoch 33, cost -79.3701303864
Pre-training layer 0, epoch 34, cost -79.2471244685
Pre-training layer 0, epoch 35, cost -79.1088024267
Pre-training layer 0, epoch 35, representative training free energy -443.155741821
Pre-training layer 0, epoch 35, validation free energy -434.115361176
Pre-training layer 0, epoch 36, cost -78.8152695974
Pre-training layer 0, epoch 37, cost -78.7151527786
Pre-training layer 0, epoch 38, cost -78.5385132345
Pre-training layer 0, epoch 39, cost -78.3490362676
Pre-training layer 0, epoch 40, cost -78.2361349996
Pre-training layer 0, epoch 40, representative training free energy -442.303309143
Pre-training layer 0, epoch 40, validation free energy -433.146781158
Pre-training layer 0, epoch 41, cost -78.1132340622
Pre-training layer 0, epoch 42, cost -78.08104201
Pre-training layer 0, epoch 43, cost -77.7221046956
Pre-training layer 0, epoch 44, cost -77.6594666799
Pre-training layer 0, epoch 45, cost -77.5173715719
Pre-training layer 0, epoch 45, representative training free energy -440.933627228
Pre-training layer 0, epoch 45, validation free energy -431.674589355
Pre-training layer 0, epoch 46, cost -77.4879965846
Pre-training layer 0, epoch 47, cost -77.3020275116
Pre-training layer 0, epoch 48, cost -77.0777428563
Pre-training layer 0, epoch 49, cost -76.9564968363
Pre-training layer 0, epoch 50, cost -76.8515716044
Pre-training layer 0, epoch 50, representative training free energy -439.836839111
Pre-training layer 0, epoch 50, validation free energy -429.323206726
Pre-training layer 0, epoch 51, cost -76.7632335154
Pre-training layer 0, epoch 52, cost -76.7542205683
Pre-training layer 0, epoch 53, cost -76.7127080409
Pre-training layer 0, epoch 54, cost -76.3696081797
Pre-training layer 0, epoch 55, cost -76.3345850499
Pre-training layer 0, epoch 55, representative training free energy -438.801007813
Pre-training layer 0, epoch 55, validation free energy -428.598266479
Pre-training layer 0, epoch 56, cost -76.292610232
Pre-training layer 0, epoch 57, cost -76.1578101985
Pre-training layer 0, epoch 58, cost -76.1058209101
Pre-training layer 0, epoch 59, cost -75.9377724075
Pre-training layer 0, epoch 60, cost -75.9342475891
Pre-training layer 0, epoch 60, representative training free energy -438.927295135
Pre-training layer 0, epoch 60, validation free energy -428.929642639
Pre-training layer 0, epoch 61, cost -75.7205884043
Pre-training layer 0, epoch 62, cost -75.6540130997
Pre-training layer 0, epoch 63, cost -75.5505659485
Pre-training layer 0, epoch 64, cost -75.3741823069
Pre-training layer 0, epoch 65, cost -75.258115743
Pre-training layer 0, epoch 65, representative training free energy -437.85465625
Pre-training layer 0, epoch 65, validation free energy -427.190860962
Pre-training layer 0, epoch 66, cost -75.3108753077
Pre-training layer 0, epoch 67, cost -75.2489619446
Pre-training layer 0, epoch 68, cost -75.1591861089
Pre-training layer 0, epoch 69, cost -75.0211505381
Pre-training layer 0, epoch 70, cost -74.9511506653
Pre-training layer 0, epoch 70, representative training free energy -433.587765564
Pre-training layer 0, epoch 70, validation free energy -423.065486206
Pre-training layer 0, epoch 71, cost -74.906336085
Pre-training layer 0, epoch 72, cost -74.8229986191
Pre-training layer 0, epoch 73, cost -74.855321401
Pre-training layer 0, epoch 74, cost -74.6960791397
Pre-training layer 0, epoch 75, cost -74.4781118011
Pre-training layer 0, epoch 75, representative training free energy -432.278082733
Pre-training layer 0, epoch 75, validation free energy -421.756641174
Pre-training layer 0, epoch 76, cost -74.54764534
Pre-training layer 0, epoch 77, cost -74.5557818349
Pre-training layer 0, epoch 78, cost -74.5767244975
Pre-training layer 0, epoch 79, cost -74.3796761831
Pre-training layer 0, epoch 80, cost -74.2545632299
Pre-training layer 0, epoch 80, representative training free energy -429.697670563
Pre-training layer 0, epoch 80, validation free energy -419.791474457
Pre-training layer 0, epoch 81, cost -74.270802358
Pre-training layer 0, epoch 82, cost -74.2357424164
Pre-training layer 0, epoch 83, cost -74.1388342794
Pre-training layer 0, epoch 84, cost -74.0708497492
Pre-training layer 0, epoch 85, cost -73.9774151738
Pre-training layer 0, epoch 85, representative training free energy -431.130474731
Pre-training layer 0, epoch 85, validation free energy -420.378798676
Pre-training layer 0, epoch 86, cost -74.0799819946
Pre-training layer 0, epoch 87, cost -73.9572874324
Pre-training layer 0, epoch 88, cost -73.8586436335
Pre-training layer 0, epoch 89, cost -73.7513484192
Pre-training layer 0, epoch 90, cost -73.6897607676
Pre-training layer 0, epoch 90, representative training free energy -427.300995178
Pre-training layer 0, epoch 90, validation free energy -415.803985443
Pre-training layer 0, epoch 91, cost -73.7853276825
Pre-training layer 0, epoch 92, cost -73.5845217768
Pre-training layer 0, epoch 93, cost -73.5901900736
Pre-training layer 0, epoch 94, cost -73.5706108729
Pre-training layer 0, epoch 95, cost -73.3976964442
Pre-training layer 0, epoch 95, representative training free energy -428.666362732
Pre-training layer 0, epoch 95, validation free energy -417.29116684
Pre-training layer 0, epoch 96, cost -73.5057676951
Pre-training layer 0, epoch 97, cost -73.2621789296
Pre-training layer 0, epoch 98, cost -73.3778173447
Pre-training layer 0, epoch 99, cost -73.2101212947
Pre-training layer 1, epoch 0, cost -344.842766724
Pre-training layer 1, epoch 0, representative training free energy -51062.0022266
Pre-training layer 1, epoch 0, validation free energy -50687.6974551
Pre-training layer 1, epoch 1, cost -295.722711741
Pre-training layer 1, epoch 2, cost -280.918637339
Pre-training layer 1, epoch 3, cost -272.068626607
Pre-training layer 1, epoch 4, cost -265.87241862
Pre-training layer 1, epoch 5, cost -261.280994924
Pre-training layer 1, epoch 5, representative training free energy -69624.8962949
Pre-training layer 1, epoch 5, validation free energy -69096.2803262
Pre-training layer 1, epoch 6, cost -257.551904399
Pre-training layer 1, epoch 7, cost -254.95111913
Pre-training layer 1, epoch 8, cost -252.335559845
Pre-training layer 1, epoch 9, cost -250.506846619
Pre-training layer 1, epoch 10, cost -248.631546834
Pre-training layer 1, epoch 10, representative training free energy -75144.6227344
Pre-training layer 1, epoch 10, validation free energy -74587.329207
Pre-training layer 1, epoch 11, cost -247.332032064
Pre-training layer 1, epoch 12, cost -245.952806346
Pre-training layer 1, epoch 13, cost -244.615641073
Pre-training layer 1, epoch 14, cost -243.531775513
Pre-training layer 1, epoch 15, cost -242.48265269
Pre-training layer 1, epoch 15, representative training free energy -78352.3315684
Pre-training layer 1, epoch 15, validation free energy -77765.8708984
Pre-training layer 1, epoch 16, cost -241.806054738
Pre-training layer 1, epoch 17, cost -240.935563253
Pre-training layer 1, epoch 18, cost -240.329101766
Pre-training layer 1, epoch 19, cost -239.663890533
Pre-training layer 1, epoch 20, cost -238.991672821
Pre-training layer 1, epoch 20, representative training free energy -80781.880293
Pre-training layer 1, epoch 20, validation free energy -80173.7505625
Pre-training layer 1, epoch 21, cost -238.376772715
Pre-training layer 1, epoch 22, cost -237.931211039
Pre-training layer 1, epoch 23, cost -237.414450684
Pre-training layer 1, epoch 24, cost -236.922607168
Pre-training layer 1, epoch 25, cost -236.539189707
Pre-training layer 1, epoch 25, representative training free energy -82537.9689238
Pre-training layer 1, epoch 25, validation free energy -81907.5441094
Pre-training layer 1, epoch 26, cost -236.073632304
Pre-training layer 1, epoch 27, cost -235.839117076
Pre-training layer 1, epoch 28, cost -235.424527283
Pre-training layer 1, epoch 29, cost -234.977255351
Pre-training layer 1, epoch 30, cost -234.713189901
Pre-training layer 1, epoch 30, representative training free energy -84024.7820684
Pre-training layer 1, epoch 30, validation free energy -83383.9032441
Pre-training layer 1, epoch 31, cost -234.490617523
Pre-training layer 1, epoch 32, cost -234.129120585
Pre-training layer 1, epoch 33, cost -233.997420756
Pre-training layer 1, epoch 34, cost -233.701198222
Pre-training layer 1, epoch 35, cost -233.338291372
Pre-training layer 1, epoch 35, representative training free energy -85342.2306367
Pre-training layer 1, epoch 35, validation free energy -84687.8042734
Pre-training layer 1, epoch 36, cost -233.07045929
Pre-training layer 1, epoch 37, cost -232.881023763
Pre-training layer 1, epoch 38, cost -232.776801605
Pre-training layer 1, epoch 39, cost -232.59023641
Pre-training layer 1, epoch 40, cost -232.254588521
Pre-training layer 1, epoch 40, representative training free energy -86449.231168
Pre-training layer 1, epoch 40, validation free energy -85783.1537988
Pre-training layer 1, epoch 41, cost -232.041205495
Pre-training layer 1, epoch 42, cost -231.77633901
Pre-training layer 1, epoch 43, cost -231.618946025
Pre-training layer 1, epoch 44, cost -231.474298706
Pre-training layer 1, epoch 45, cost -231.27391332
Pre-training layer 1, epoch 45, representative training free energy -87362.1811445
Pre-training layer 1, epoch 45, validation free energy -86686.1407324
Pre-training layer 1, epoch 46, cost -231.094150391
Pre-training layer 1, epoch 47, cost -231.029411367
Pre-training layer 1, epoch 48, cost -230.816136576
Pre-training layer 1, epoch 49, cost -230.798840027
Pre-training layer 1, epoch 50, cost -230.436885732
Pre-training layer 1, epoch 50, representative training free energy -88253.8400293
Pre-training layer 1, epoch 50, validation free energy -87573.0479883
Pre-training layer 1, epoch 51, cost -230.350273844
Pre-training layer 1, epoch 52, cost -230.212523549
Pre-training layer 1, epoch 53, cost -230.166640625
Pre-training layer 1, epoch 54, cost -229.916218363
Pre-training layer 1, epoch 55, cost -229.839074249
Pre-training layer 1, epoch 55, representative training free energy -89072.8393711
Pre-training layer 1, epoch 55, validation free energy -88380.1161152
Pre-training layer 1, epoch 56, cost -229.710186818
Pre-training layer 1, epoch 57, cost -229.589529114
Pre-training layer 1, epoch 58, cost -229.540935567
Pre-training layer 1, epoch 59, cost -229.289654338
Pre-training layer 1, epoch 60, cost -229.288781535
Pre-training layer 1, epoch 60, representative training free energy -89784.2538477
Pre-training layer 1, epoch 60, validation free energy -89086.9076816
Pre-training layer 1, epoch 61, cost -229.149317729
Pre-training layer 1, epoch 62, cost -229.041337535
Pre-training layer 1, epoch 63, cost -228.945036977
Pre-training layer 1, epoch 64, cost -228.802047984
Pre-training layer 1, epoch 65, cost -228.684554698
Pre-training layer 1, epoch 65, representative training free energy -90421.5904648
Pre-training layer 1, epoch 65, validation free energy -89713.3003535
Pre-training layer 1, epoch 66, cost -228.679509226
Pre-training layer 1, epoch 67, cost -228.55686381
Pre-training layer 1, epoch 68, cost -228.507532806
Pre-training layer 1, epoch 69, cost -228.268407644
Pre-training layer 1, epoch 70, cost -228.226353251
Pre-training layer 1, epoch 70, representative training free energy -91075.8863398
Pre-training layer 1, epoch 70, validation free energy -90369.3271699
Pre-training layer 1, epoch 71, cost -228.189316152
Pre-training layer 1, epoch 72, cost -228.166831156
Pre-training layer 1, epoch 73, cost -228.040490011
Pre-training layer 1, epoch 74, cost -227.923582306
Pre-training layer 1, epoch 75, cost -227.873239136
Pre-training layer 1, epoch 75, representative training free energy -91653.5885859
Pre-training layer 1, epoch 75, validation free energy -90935.5731289
Pre-training layer 1, epoch 76, cost -227.795722758
Pre-training layer 1, epoch 77, cost -227.689635773
Pre-training layer 1, epoch 78, cost -227.581114502
Pre-training layer 1, epoch 79, cost -227.546029358
Pre-training layer 1, epoch 80, cost -227.45648585
Pre-training layer 1, epoch 80, representative training free energy -92247.8983164
Pre-training layer 1, epoch 80, validation free energy -91526.9765918
Pre-training layer 1, epoch 81, cost -227.394580841
Pre-training layer 1, epoch 82, cost -227.236780345
Pre-training layer 1, epoch 83, cost -227.277706299
Pre-training layer 1, epoch 84, cost -227.268007304
Pre-training layer 1, epoch 85, cost -227.109875743
Pre-training layer 1, epoch 85, representative training free energy -92738.1875449
Pre-training layer 1, epoch 85, validation free energy -92009.3907734
Pre-training layer 1, epoch 86, cost -227.100955912
Pre-training layer 1, epoch 87, cost -226.988576508
Pre-training layer 1, epoch 88, cost -226.958874512
Pre-training layer 1, epoch 89, cost -226.817427521
Pre-training layer 1, epoch 90, cost -226.697000529
Pre-training layer 1, epoch 90, representative training free energy -93320.4508027
Pre-training layer 1, epoch 90, validation free energy -92576.2357617
Pre-training layer 1, epoch 91, cost -226.797037354
Pre-training layer 1, epoch 92, cost -226.697976329
Pre-training layer 1, epoch 93, cost -226.592917735
Pre-training layer 1, epoch 94, cost -226.569206848
Pre-training layer 1, epoch 95, cost -226.486757558
Pre-training layer 1, epoch 95, representative training free energy -93714.5622559
Pre-training layer 1, epoch 95, validation free energy -92975.8902891
Pre-training layer 1, epoch 96, cost -226.506025136
Pre-training layer 1, epoch 97, cost -226.380946503
Pre-training layer 1, epoch 98, cost -226.312225444
Pre-training layer 1, epoch 99, cost -226.344256897
Pre-training layer 2, epoch 0, cost -127.620178299
Pre-training layer 2, epoch 0, representative training free energy 3380.07195569
Pre-training layer 2, epoch 0, validation free energy 3356.04568494
Pre-training layer 2, epoch 1, cost -93.7241378784
Pre-training layer 2, epoch 2, cost -86.5657823817
Pre-training layer 2, epoch 3, cost -82.5587813695
Pre-training layer 2, epoch 4, cost -79.8534410985
Pre-training layer 2, epoch 5, cost -77.6590400441
Pre-training layer 2, epoch 5, representative training free energy 5413.96426807
Pre-training layer 2, epoch 5, validation free energy 5365.58611963
Pre-training layer 2, epoch 6, cost -76.225669047
Pre-training layer 2, epoch 7, cost -74.9469598262
Pre-training layer 2, epoch 8, cost -73.9269284693
Pre-training layer 2, epoch 9, cost -72.9594969304
Pre-training layer 2, epoch 10, cost -72.1306272888
Pre-training layer 2, epoch 10, representative training free energy 6340.3322821
Pre-training layer 2, epoch 10, validation free energy 6282.21359204
Pre-training layer 2, epoch 11, cost -71.5455930328
Pre-training layer 2, epoch 12, cost -70.824686381
Pre-training layer 2, epoch 13, cost -70.4670433807
Pre-training layer 2, epoch 14, cost -69.9550585175
Pre-training layer 2, epoch 15, cost -69.5550739288
Pre-training layer 2, epoch 15, representative training free energy 7013.37566724
Pre-training layer 2, epoch 15, validation free energy 6951.39469604
Pre-training layer 2, epoch 16, cost -69.2101134872
Pre-training layer 2, epoch 17, cost -68.7709191767
Pre-training layer 2, epoch 18, cost -68.3797603353
Pre-training layer 2, epoch 19, cost -68.1492628225
Pre-training layer 2, epoch 20, cost -67.8832886632
Pre-training layer 2, epoch 20, representative training free energy 7577.69710571
Pre-training layer 2, epoch 20, validation free energy 7510.94202417
Pre-training layer 2, epoch 21, cost -67.7258691533
Pre-training layer 2, epoch 22, cost -67.4361928558
Pre-training layer 2, epoch 23, cost -67.1227847926
Pre-training layer 2, epoch 24, cost -67.0250734838
Pre-training layer 2, epoch 25, cost -66.9416531754
Pre-training layer 2, epoch 25, representative training free energy 8034.39795312
Pre-training layer 2, epoch 25, validation free energy 7962.80382959
Pre-training layer 2, epoch 26, cost -66.5753507106
Pre-training layer 2, epoch 27, cost -66.4362312826
Pre-training layer 2, epoch 28, cost -66.2922882334
Pre-training layer 2, epoch 29, cost -66.1463765208
Pre-training layer 2, epoch 30, cost -65.9825326157
Pre-training layer 2, epoch 30, representative training free energy 8450.038198
Pre-training layer 2, epoch 30, validation free energy 8375.14033008
Pre-training layer 2, epoch 31, cost -65.8235417684
Pre-training layer 2, epoch 32, cost -65.7965555064
Pre-training layer 2, epoch 33, cost -65.6172363408
Pre-training layer 2, epoch 34, cost -65.5125448227
Pre-training layer 2, epoch 35, cost -65.3959751002
Pre-training layer 2, epoch 35, representative training free energy 8829.79750024
Pre-training layer 2, epoch 35, validation free energy 8751.67000928
Pre-training layer 2, epoch 36, cost -65.3284785589
Pre-training layer 2, epoch 37, cost -65.1715504583
Pre-training layer 2, epoch 38, cost -65.0297510147
Pre-training layer 2, epoch 39, cost -65.0433751678
Pre-training layer 2, epoch 40, cost -64.9080101903
Pre-training layer 2, epoch 40, representative training free energy 9142.46189331
Pre-training layer 2, epoch 40, validation free energy 9060.28415454
Pre-training layer 2, epoch 41, cost -64.8689201609
Pre-training layer 2, epoch 42, cost -64.7757461548
Pre-training layer 2, epoch 43, cost -64.7104075495
Pre-training layer 2, epoch 44, cost -64.6902610906
Pre-training layer 2, epoch 45, cost -64.4924093628
Pre-training layer 2, epoch 45, representative training free energy 9455.90616284
Pre-training layer 2, epoch 45, validation free energy 9371.35493115
Pre-training layer 2, epoch 46, cost -64.4233912786
Pre-training layer 2, epoch 47, cost -64.4419959768
Pre-training layer 2, epoch 48, cost -64.225660731
Pre-training layer 2, epoch 49, cost -64.2822507222
Pre-training layer 2, epoch 50, cost -64.1930749385
Pre-training layer 2, epoch 50, representative training free energy 9733.29405933
Pre-training layer 2, epoch 50, validation free energy 9644.84014819
Pre-training layer 2, epoch 51, cost -64.223553594
Pre-training layer 2, epoch 52, cost -64.223817126
Pre-training layer 2, epoch 53, cost -64.0469085566
Pre-training layer 2, epoch 54, cost -64.0255459213
Pre-training layer 2, epoch 55, cost -64.0176609166
Pre-training layer 2, epoch 55, representative training free energy 10007.6991782
Pre-training layer 2, epoch 55, validation free energy 9917.89158252
Pre-training layer 2, epoch 56, cost -63.7926244863
Pre-training layer 2, epoch 57, cost -63.7873576609
Pre-training layer 2, epoch 58, cost -63.8077893957
Pre-training layer 2, epoch 59, cost -63.7898546727
Pre-training layer 2, epoch 60, cost -63.7061006165
Pre-training layer 2, epoch 60, representative training free energy 10248.2300366
Pre-training layer 2, epoch 60, validation free energy 10155.8045652
Pre-training layer 2, epoch 61, cost -63.5939656957
Pre-training layer 2, epoch 62, cost -63.5439069112
Pre-training layer 2, epoch 63, cost -63.5704061127
Pre-training layer 2, epoch 64, cost -63.5452384059
Pre-training layer 2, epoch 65, cost -63.5341016006
Pre-training layer 2, epoch 65, representative training free energy 10483.5166482
Pre-training layer 2, epoch 65, validation free energy 10389.7599485
Pre-training layer 2, epoch 66, cost -63.3867197673
Pre-training layer 2, epoch 67, cost -63.413596522
Pre-training layer 2, epoch 68, cost -63.3929123179
Pre-training layer 2, epoch 69, cost -63.4473692958
Pre-training layer 2, epoch 70, cost -63.2616384761
Pre-training layer 2, epoch 70, representative training free energy 10705.7816169
Pre-training layer 2, epoch 70, validation free energy 10608.8955256
Pre-training layer 2, epoch 71, cost -63.138998998
Pre-training layer 2, epoch 72, cost -63.2215020116
Pre-training layer 2, epoch 73, cost -63.1758555222
Pre-training layer 2, epoch 74, cost -63.1265089798
Pre-training layer 2, epoch 75, cost -63.1410764186
Pre-training layer 2, epoch 75, representative training free energy 10928.9979609
Pre-training layer 2, epoch 75, validation free energy 10829.9326636
Pre-training layer 2, epoch 76, cost -62.9975593694
Pre-training layer 2, epoch 77, cost -63.0788658905
Pre-training layer 2, epoch 78, cost -63.0756029256
Pre-training layer 2, epoch 79, cost -63.0765493266
Pre-training layer 2, epoch 80, cost -62.9396163305
Pre-training layer 2, epoch 80, representative training free energy 11145.5235317
Pre-training layer 2, epoch 80, validation free energy 11045.0893813
Pre-training layer 2, epoch 81, cost -62.9866234461
Pre-training layer 2, epoch 82, cost -62.9850971349
Pre-training layer 2, epoch 83, cost -62.9165895716
Pre-training layer 2, epoch 84, cost -62.909133695
Pre-training layer 2, epoch 85, cost -62.8001412837
Pre-training layer 2, epoch 85, representative training free energy 11360.1154438
Pre-training layer 2, epoch 85, validation free energy 11259.3143889
Pre-training layer 2, epoch 86, cost -62.7871193568
Pre-training layer 2, epoch 87, cost -62.7380724208
Pre-training layer 2, epoch 88, cost -62.6646212769
Pre-training layer 2, epoch 89, cost -62.7991740926
Pre-training layer 2, epoch 90, cost -62.6990642293
Pre-training layer 2, epoch 90, representative training free energy 11550.3017561
Pre-training layer 2, epoch 90, validation free energy 11451.7404912
Pre-training layer 2, epoch 91, cost -62.6631944529
Pre-training layer 2, epoch 92, cost -62.6362074788
Pre-training layer 2, epoch 93, cost -62.6913938649
Pre-training layer 2, epoch 94, cost -62.5582375463
Pre-training layer 2, epoch 95, cost -62.461796697
Pre-training layer 2, epoch 95, representative training free energy 11758.4386868
Pre-training layer 2, epoch 95, validation free energy 11654.8246868
Pre-training layer 2, epoch 96, cost -62.3908375422
Pre-training layer 2, epoch 97, cost -62.5502992121
Pre-training layer 2, epoch 98, cost -62.5141023127
Pre-training layer 2, epoch 99, cost -62.4841253535
The pretraining code for file dbn_loop.pyc ran for 7.92m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 300/300, validation error 32.500000 %
     epoch 1, minibatch 300/300, test error of best model 27.900000 %
epoch 2, minibatch 300/300, validation error 26.700000 %
     epoch 2, minibatch 300/300, test error of best model 19.800000 %
epoch 3, minibatch 300/300, validation error 24.400000 %
     epoch 3, minibatch 300/300, test error of best model 16.000000 %
epoch 4, minibatch 300/300, validation error 22.900000 %
     epoch 4, minibatch 300/300, test error of best model 14.600000 %
epoch 5, minibatch 300/300, validation error 22.300000 %
     epoch 5, minibatch 300/300, test error of best model 12.800000 %
epoch 6, minibatch 300/300, validation error 21.700000 %
     epoch 6, minibatch 300/300, test error of best model 12.000000 %
epoch 7, minibatch 300/300, validation error 20.900000 %
     epoch 7, minibatch 300/300, test error of best model 11.400000 %
epoch 8, minibatch 300/300, validation error 20.300000 %
     epoch 8, minibatch 300/300, test error of best model 11.100000 %
epoch 9, minibatch 300/300, validation error 20.200000 %
     epoch 9, minibatch 300/300, test error of best model 10.600000 %
epoch 10, minibatch 300/300, validation error 19.900000 %
     epoch 10, minibatch 300/300, test error of best model 10.100000 %
epoch 11, minibatch 300/300, validation error 19.500000 %
     epoch 11, minibatch 300/300, test error of best model 9.400000 %
epoch 12, minibatch 300/300, validation error 18.800000 %
     epoch 12, minibatch 300/300, test error of best model 9.600000 %
epoch 13, minibatch 300/300, validation error 18.800000 %
epoch 14, minibatch 300/300, validation error 18.500000 %
     epoch 14, minibatch 300/300, test error of best model 9.400000 %
epoch 15, minibatch 300/300, validation error 18.600000 %
epoch 16, minibatch 300/300, validation error 17.800000 %
     epoch 16, minibatch 300/300, test error of best model 9.000000 %
epoch 17, minibatch 300/300, validation error 17.800000 %
epoch 18, minibatch 300/300, validation error 17.800000 %
epoch 19, minibatch 300/300, validation error 17.900000 %
epoch 20, minibatch 300/300, validation error 18.100000 %
epoch 21, minibatch 300/300, validation error 17.900000 %
epoch 22, minibatch 300/300, validation error 17.800000 %
epoch 23, minibatch 300/300, validation error 17.400000 %
     epoch 23, minibatch 300/300, test error of best model 8.000000 %
epoch 24, minibatch 300/300, validation error 17.300000 %
     epoch 24, minibatch 300/300, test error of best model 8.000000 %
epoch 25, minibatch 300/300, validation error 16.800000 %
     epoch 25, minibatch 300/300, test error of best model 8.100000 %
epoch 26, minibatch 300/300, validation error 16.800000 %
epoch 27, minibatch 300/300, validation error 16.700000 %
     epoch 27, minibatch 300/300, test error of best model 8.100000 %
epoch 28, minibatch 300/300, validation error 16.600000 %
     epoch 28, minibatch 300/300, test error of best model 7.800000 %
epoch 29, minibatch 300/300, validation error 16.600000 %
epoch 30, minibatch 300/300, validation error 16.600000 %
epoch 31, minibatch 300/300, validation error 16.500000 %
     epoch 31, minibatch 300/300, test error of best model 7.800000 %
epoch 32, minibatch 300/300, validation error 16.600000 %
epoch 33, minibatch 300/300, validation error 16.500000 %
epoch 34, minibatch 300/300, validation error 16.400000 %
     epoch 34, minibatch 300/300, test error of best model 7.500000 %
epoch 35, minibatch 300/300, validation error 16.100000 %
     epoch 35, minibatch 300/300, test error of best model 7.400000 %
epoch 36, minibatch 300/300, validation error 16.100000 %
epoch 37, minibatch 300/300, validation error 16.100000 %
epoch 38, minibatch 300/300, validation error 15.900000 %
     epoch 38, minibatch 300/300, test error of best model 6.900000 %
epoch 39, minibatch 300/300, validation error 15.700000 %
     epoch 39, minibatch 300/300, test error of best model 6.900000 %
epoch 40, minibatch 300/300, validation error 15.700000 %
epoch 41, minibatch 300/300, validation error 15.700000 %
epoch 42, minibatch 300/300, validation error 15.700000 %
epoch 43, minibatch 300/300, validation error 15.700000 %
epoch 44, minibatch 300/300, validation error 15.700000 %
epoch 45, minibatch 300/300, validation error 15.600000 %
     epoch 45, minibatch 300/300, test error of best model 6.900000 %
epoch 46, minibatch 300/300, validation error 15.600000 %
epoch 47, minibatch 300/300, validation error 15.500000 %
     epoch 47, minibatch 300/300, test error of best model 6.900000 %
epoch 48, minibatch 300/300, validation error 15.500000 %
epoch 49, minibatch 300/300, validation error 15.500000 %
epoch 50, minibatch 300/300, validation error 15.500000 %
epoch 51, minibatch 300/300, validation error 15.500000 %
epoch 52, minibatch 300/300, validation error 15.500000 %
epoch 53, minibatch 300/300, validation error 15.500000 %
epoch 54, minibatch 300/300, validation error 15.500000 %
epoch 55, minibatch 300/300, validation error 15.500000 %
epoch 56, minibatch 300/300, validation error 15.500000 %
epoch 57, minibatch 300/300, validation error 15.500000 %
epoch 58, minibatch 300/300, validation error 15.500000 %
epoch 59, minibatch 300/300, validation error 15.400000 %
     epoch 59, minibatch 300/300, test error of best model 6.600000 %
epoch 60, minibatch 300/300, validation error 15.400000 %
epoch 61, minibatch 300/300, validation error 15.400000 %
epoch 62, minibatch 300/300, validation error 15.400000 %
epoch 63, minibatch 300/300, validation error 15.400000 %
epoch 64, minibatch 300/300, validation error 15.400000 %
epoch 65, minibatch 300/300, validation error 15.400000 %
epoch 66, minibatch 300/300, validation error 15.400000 %
epoch 67, minibatch 300/300, validation error 15.400000 %
epoch 68, minibatch 300/300, validation error 15.400000 %
epoch 69, minibatch 300/300, validation error 15.400000 %
epoch 70, minibatch 300/300, validation error 15.400000 %
epoch 71, minibatch 300/300, validation error 15.400000 %
epoch 72, minibatch 300/300, validation error 15.300000 %
     epoch 72, minibatch 300/300, test error of best model 6.600000 %
epoch 73, minibatch 300/300, validation error 15.300000 %
epoch 74, minibatch 300/300, validation error 15.300000 %
epoch 75, minibatch 300/300, validation error 15.300000 %
epoch 76, minibatch 300/300, validation error 15.400000 %
epoch 77, minibatch 300/300, validation error 15.300000 %
epoch 78, minibatch 300/300, validation error 15.400000 %
epoch 79, minibatch 300/300, validation error 15.400000 %
epoch 80, minibatch 300/300, validation error 15.400000 %
epoch 81, minibatch 300/300, validation error 15.400000 %
epoch 82, minibatch 300/300, validation error 15.400000 %
epoch 83, minibatch 300/300, validation error 15.400000 %
epoch 84, minibatch 300/300, validation error 15.400000 %
epoch 85, minibatch 300/300, validation error 15.400000 %
epoch 86, minibatch 300/300, validation error 15.400000 %
epoch 87, minibatch 300/300, validation error 15.400000 %
epoch 88, minibatch 300/300, validation error 15.400000 %
epoch 89, minibatch 300/300, validation error 15.400000 %
epoch 90, minibatch 300/300, validation error 15.400000 %
epoch 91, minibatch 300/300, validation error 15.400000 %
epoch 92, minibatch 300/300, validation error 15.400000 %
epoch 93, minibatch 300/300, validation error 15.400000 %
epoch 94, minibatch 300/300, validation error 15.400000 %
epoch 95, minibatch 300/300, validation error 15.400000 %
epoch 96, minibatch 300/300, validation error 15.400000 %
epoch 97, minibatch 300/300, validation error 15.400000 %
epoch 98, minibatch 300/300, validation error 15.400000 %
epoch 99, minibatch 300/300, validation error 15.400000 %
epoch 100, minibatch 300/300, validation error 15.400000 %
epoch 101, minibatch 300/300, validation error 15.200000 %
     epoch 101, minibatch 300/300, test error of best model 6.500000 %
epoch 102, minibatch 300/300, validation error 15.200000 %
epoch 103, minibatch 300/300, validation error 15.200000 %
epoch 104, minibatch 300/300, validation error 15.200000 %
epoch 105, minibatch 300/300, validation error 15.200000 %
epoch 106, minibatch 300/300, validation error 15.200000 %
epoch 107, minibatch 300/300, validation error 15.200000 %
epoch 108, minibatch 300/300, validation error 15.200000 %
epoch 109, minibatch 300/300, validation error 15.200000 %
epoch 110, minibatch 300/300, validation error 15.100000 %
     epoch 110, minibatch 300/300, test error of best model 6.400000 %
epoch 111, minibatch 300/300, validation error 15.100000 %
epoch 112, minibatch 300/300, validation error 15.100000 %
epoch 113, minibatch 300/300, validation error 15.100000 %
epoch 114, minibatch 300/300, validation error 15.100000 %
epoch 115, minibatch 300/300, validation error 15.100000 %
epoch 116, minibatch 300/300, validation error 15.100000 %
epoch 117, minibatch 300/300, validation error 15.100000 %
epoch 118, minibatch 300/300, validation error 15.100000 %
epoch 119, minibatch 300/300, validation error 15.100000 %
epoch 120, minibatch 300/300, validation error 15.100000 %
epoch 121, minibatch 300/300, validation error 15.100000 %
epoch 122, minibatch 300/300, validation error 15.100000 %
epoch 123, minibatch 300/300, validation error 15.100000 %
epoch 124, minibatch 300/300, validation error 15.100000 %
epoch 125, minibatch 300/300, validation error 15.100000 %
epoch 126, minibatch 300/300, validation error 15.000000 %
     epoch 126, minibatch 300/300, test error of best model 6.400000 %
epoch 127, minibatch 300/300, validation error 15.000000 %
epoch 128, minibatch 300/300, validation error 15.000000 %
epoch 129, minibatch 300/300, validation error 15.000000 %
epoch 130, minibatch 300/300, validation error 15.000000 %
epoch 131, minibatch 300/300, validation error 15.000000 %
epoch 132, minibatch 300/300, validation error 15.000000 %
epoch 133, minibatch 300/300, validation error 15.000000 %
epoch 134, minibatch 300/300, validation error 15.000000 %
epoch 135, minibatch 300/300, validation error 15.000000 %
epoch 136, minibatch 300/300, validation error 15.000000 %
epoch 137, minibatch 300/300, validation error 15.000000 %
epoch 138, minibatch 300/300, validation error 15.000000 %
epoch 139, minibatch 300/300, validation error 15.000000 %
epoch 140, minibatch 300/300, validation error 15.000000 %
epoch 141, minibatch 300/300, validation error 15.000000 %
epoch 142, minibatch 300/300, validation error 15.000000 %
epoch 143, minibatch 300/300, validation error 15.000000 %
epoch 144, minibatch 300/300, validation error 15.000000 %
epoch 145, minibatch 300/300, validation error 15.000000 %
epoch 146, minibatch 300/300, validation error 14.900000 %
     epoch 146, minibatch 300/300, test error of best model 6.400000 %
epoch 147, minibatch 300/300, validation error 14.900000 %
epoch 148, minibatch 300/300, validation error 14.900000 %
epoch 149, minibatch 300/300, validation error 14.900000 %
epoch 150, minibatch 300/300, validation error 14.900000 %
epoch 151, minibatch 300/300, validation error 14.900000 %
epoch 152, minibatch 300/300, validation error 14.900000 %
epoch 153, minibatch 300/300, validation error 14.900000 %
epoch 154, minibatch 300/300, validation error 14.900000 %
epoch 155, minibatch 300/300, validation error 14.900000 %
epoch 156, minibatch 300/300, validation error 14.900000 %
epoch 157, minibatch 300/300, validation error 14.900000 %
epoch 158, minibatch 300/300, validation error 14.900000 %
epoch 159, minibatch 300/300, validation error 14.900000 %
epoch 160, minibatch 300/300, validation error 14.900000 %
epoch 161, minibatch 300/300, validation error 14.900000 %
epoch 162, minibatch 300/300, validation error 14.900000 %
epoch 163, minibatch 300/300, validation error 14.900000 %
epoch 164, minibatch 300/300, validation error 14.900000 %
epoch 165, minibatch 300/300, validation error 14.900000 %
epoch 166, minibatch 300/300, validation error 14.900000 %
epoch 167, minibatch 300/300, validation error 14.900000 %
epoch 168, minibatch 300/300, validation error 14.900000 %
epoch 169, minibatch 300/300, validation error 14.900000 %
epoch 170, minibatch 300/300, validation error 14.900000 %
epoch 171, minibatch 300/300, validation error 14.900000 %
epoch 172, minibatch 300/300, validation error 14.900000 %
epoch 173, minibatch 300/300, validation error 14.900000 %
epoch 174, minibatch 300/300, validation error 14.900000 %
epoch 175, minibatch 300/300, validation error 14.900000 %
epoch 176, minibatch 300/300, validation error 14.900000 %
epoch 177, minibatch 300/300, validation error 14.900000 %
epoch 178, minibatch 300/300, validation error 14.900000 %
epoch 179, minibatch 300/300, validation error 14.900000 %
epoch 180, minibatch 300/300, validation error 14.900000 %
epoch 181, minibatch 300/300, validation error 14.900000 %
epoch 182, minibatch 300/300, validation error 14.900000 %
epoch 183, minibatch 300/300, validation error 14.900000 %
epoch 184, minibatch 300/300, validation error 14.900000 %
epoch 185, minibatch 300/300, validation error 14.900000 %
epoch 186, minibatch 300/300, validation error 14.900000 %
epoch 187, minibatch 300/300, validation error 14.900000 %
epoch 188, minibatch 300/300, validation error 14.900000 %
epoch 189, minibatch 300/300, validation error 14.900000 %
epoch 190, minibatch 300/300, validation error 14.900000 %
epoch 191, minibatch 300/300, validation error 14.900000 %
epoch 192, minibatch 300/300, validation error 14.900000 %
epoch 193, minibatch 300/300, validation error 14.900000 %
epoch 194, minibatch 300/300, validation error 14.900000 %
epoch 195, minibatch 300/300, validation error 14.900000 %
epoch 196, minibatch 300/300, validation error 14.900000 %
epoch 197, minibatch 300/300, validation error 14.900000 %
epoch 198, minibatch 300/300, validation error 14.900000 %
epoch 199, minibatch 300/300, validation error 14.900000 %
epoch 200, minibatch 300/300, validation error 14.900000 %
epoch 201, minibatch 300/300, validation error 14.900000 %
epoch 202, minibatch 300/300, validation error 14.900000 %
epoch 203, minibatch 300/300, validation error 14.900000 %
epoch 204, minibatch 300/300, validation error 14.900000 %
epoch 205, minibatch 300/300, validation error 14.900000 %
epoch 206, minibatch 300/300, validation error 14.900000 %
epoch 207, minibatch 300/300, validation error 14.900000 %
epoch 208, minibatch 300/300, validation error 14.900000 %
epoch 209, minibatch 300/300, validation error 14.900000 %
epoch 210, minibatch 300/300, validation error 15.000000 %
epoch 211, minibatch 300/300, validation error 15.000000 %
epoch 212, minibatch 300/300, validation error 15.000000 %
epoch 213, minibatch 300/300, validation error 15.000000 %
epoch 214, minibatch 300/300, validation error 15.000000 %
epoch 215, minibatch 300/300, validation error 15.000000 %
epoch 216, minibatch 300/300, validation error 15.000000 %
epoch 217, minibatch 300/300, validation error 15.000000 %
epoch 218, minibatch 300/300, validation error 15.000000 %
epoch 219, minibatch 300/300, validation error 15.000000 %
epoch 220, minibatch 300/300, validation error 15.000000 %
epoch 221, minibatch 300/300, validation error 15.000000 %
epoch 222, minibatch 300/300, validation error 15.000000 %
epoch 223, minibatch 300/300, validation error 15.000000 %
epoch 224, minibatch 300/300, validation error 15.000000 %
epoch 225, minibatch 300/300, validation error 15.000000 %
epoch 226, minibatch 300/300, validation error 15.000000 %
epoch 227, minibatch 300/300, validation error 15.000000 %
epoch 228, minibatch 300/300, validation error 15.000000 %
epoch 229, minibatch 300/300, validation error 15.000000 %
epoch 230, minibatch 300/300, validation error 15.000000 %
epoch 231, minibatch 300/300, validation error 15.000000 %
epoch 232, minibatch 300/300, validation error 15.000000 %
epoch 233, minibatch 300/300, validation error 15.000000 %
epoch 234, minibatch 300/300, validation error 15.000000 %
epoch 235, minibatch 300/300, validation error 15.000000 %
epoch 236, minibatch 300/300, validation error 15.000000 %
epoch 237, minibatch 300/300, validation error 15.000000 %
epoch 238, minibatch 300/300, validation error 15.000000 %
epoch 239, minibatch 300/300, validation error 15.000000 %
epoch 240, minibatch 300/300, validation error 15.000000 %
epoch 241, minibatch 300/300, validation error 15.000000 %
epoch 242, minibatch 300/300, validation error 15.000000 %
epoch 243, minibatch 300/300, validation error 15.000000 %
epoch 244, minibatch 300/300, validation error 15.000000 %
epoch 245, minibatch 300/300, validation error 15.000000 %
epoch 246, minibatch 300/300, validation error 15.000000 %
epoch 247, minibatch 300/300, validation error 15.000000 %
epoch 248, minibatch 300/300, validation error 15.000000 %
epoch 249, minibatch 300/300, validation error 15.000000 %
epoch 250, minibatch 300/300, validation error 15.000000 %
epoch 251, minibatch 300/300, validation error 15.000000 %
epoch 252, minibatch 300/300, validation error 15.000000 %
epoch 253, minibatch 300/300, validation error 15.000000 %
epoch 254, minibatch 300/300, validation error 15.000000 %
epoch 255, minibatch 300/300, validation error 15.000000 %
epoch 256, minibatch 300/300, validation error 15.000000 %
epoch 257, minibatch 300/300, validation error 15.000000 %
epoch 258, minibatch 300/300, validation error 15.000000 %
epoch 259, minibatch 300/300, validation error 15.000000 %
epoch 260, minibatch 300/300, validation error 15.000000 %
epoch 261, minibatch 300/300, validation error 14.900000 %
epoch 262, minibatch 300/300, validation error 14.900000 %
epoch 263, minibatch 300/300, validation error 14.900000 %
epoch 264, minibatch 300/300, validation error 14.900000 %
epoch 265, minibatch 300/300, validation error 14.900000 %
epoch 266, minibatch 300/300, validation error 14.900000 %
epoch 267, minibatch 300/300, validation error 14.900000 %
epoch 268, minibatch 300/300, validation error 14.900000 %
epoch 269, minibatch 300/300, validation error 14.900000 %
epoch 270, minibatch 300/300, validation error 14.900000 %
epoch 271, minibatch 300/300, validation error 14.900000 %
epoch 272, minibatch 300/300, validation error 14.900000 %
epoch 273, minibatch 300/300, validation error 14.900000 %
epoch 274, minibatch 300/300, validation error 14.900000 %
epoch 275, minibatch 300/300, validation error 14.900000 %
epoch 276, minibatch 300/300, validation error 14.900000 %
epoch 277, minibatch 300/300, validation error 14.900000 %
epoch 278, minibatch 300/300, validation error 14.900000 %
epoch 279, minibatch 300/300, validation error 14.900000 %
epoch 280, minibatch 300/300, validation error 14.900000 %
epoch 281, minibatch 300/300, validation error 14.900000 %
epoch 282, minibatch 300/300, validation error 14.900000 %
epoch 283, minibatch 300/300, validation error 14.900000 %
epoch 284, minibatch 300/300, validation error 14.900000 %
epoch 285, minibatch 300/300, validation error 14.900000 %
epoch 286, minibatch 300/300, validation error 14.900000 %
epoch 287, minibatch 300/300, validation error 14.900000 %
epoch 288, minibatch 300/300, validation error 14.900000 %
epoch 289, minibatch 300/300, validation error 14.900000 %
epoch 290, minibatch 300/300, validation error 14.900000 %
epoch 291, minibatch 300/300, validation error 14.900000 %
Optimization complete with best validation score of 14.900000 %, obtained at iteration 43800, with test performance 6.400000 %
The fine tuning code for file dbn_loop.pyc ran for 7.58m


==========Sample: (4000,1000,1000) ===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -143.309058895
Pre-training layer 0, epoch 0, representative training free energy -552.166520966
Pre-training layer 0, epoch 0, validation free energy -548.54364801
Pre-training layer 0, epoch 1, cost -112.216065388
Pre-training layer 0, epoch 2, cost -103.955150261
Pre-training layer 0, epoch 3, cost -99.0139557648
Pre-training layer 0, epoch 4, cost -95.8491218758
Pre-training layer 0, epoch 5, cost -93.437562027
Pre-training layer 0, epoch 5, representative training free energy -491.6673909
Pre-training layer 0, epoch 5, validation free energy -486.264633362
Pre-training layer 0, epoch 6, cost -91.578380146
Pre-training layer 0, epoch 7, cost -90.1929794312
Pre-training layer 0, epoch 8, cost -88.9364607811
Pre-training layer 0, epoch 9, cost -87.8402077103
Pre-training layer 0, epoch 10, cost -86.8016569424
Pre-training layer 0, epoch 10, representative training free energy -469.260010803
Pre-training layer 0, epoch 10, validation free energy -464.317358948
Pre-training layer 0, epoch 11, cost -86.0105183411
Pre-training layer 0, epoch 12, cost -85.3936494255
Pre-training layer 0, epoch 13, cost -84.6944184399
Pre-training layer 0, epoch 14, cost -84.122548933
Pre-training layer 0, epoch 15, cost -83.5255278301
Pre-training layer 0, epoch 15, representative training free energy -458.21041214
Pre-training layer 0, epoch 15, validation free energy -452.737151031
Pre-training layer 0, epoch 16, cost -83.0262138081
Pre-training layer 0, epoch 17, cost -82.507225008
Pre-training layer 0, epoch 18, cost -82.3963513947
Pre-training layer 0, epoch 19, cost -82.0537266922
Pre-training layer 0, epoch 20, cost -81.6748023796
Pre-training layer 0, epoch 20, representative training free energy -453.310377625
Pre-training layer 0, epoch 20, validation free energy -446.910947937
Pre-training layer 0, epoch 21, cost -81.2967978954
Pre-training layer 0, epoch 22, cost -80.9096979523
Pre-training layer 0, epoch 23, cost -80.5971734047
Pre-training layer 0, epoch 24, cost -80.3231781101
Pre-training layer 0, epoch 25, cost -80.125172863
Pre-training layer 0, epoch 25, representative training free energy -445.467307648
Pre-training layer 0, epoch 25, validation free energy -438.799117096
Pre-training layer 0, epoch 26, cost -79.8838305378
Pre-training layer 0, epoch 27, cost -79.5653144455
Pre-training layer 0, epoch 28, cost -79.4001289272
Pre-training layer 0, epoch 29, cost -79.1580991745
Pre-training layer 0, epoch 30, cost -78.918482132
Pre-training layer 0, epoch 30, representative training free energy -440.940513428
Pre-training layer 0, epoch 30, validation free energy -433.938480927
Pre-training layer 0, epoch 31, cost -78.7507989502
Pre-training layer 0, epoch 32, cost -78.6433698559
Pre-training layer 0, epoch 33, cost -78.508409586
Pre-training layer 0, epoch 34, cost -78.2880931854
Pre-training layer 0, epoch 35, cost -78.0759513378
Pre-training layer 0, epoch 35, representative training free energy -437.593239044
Pre-training layer 0, epoch 35, validation free energy -431.238708252
Pre-training layer 0, epoch 36, cost -77.79091362
Pre-training layer 0, epoch 37, cost -77.7132165527
Pre-training layer 0, epoch 38, cost -77.5642603302
Pre-training layer 0, epoch 39, cost -77.4161904526
Pre-training layer 0, epoch 40, cost -77.2999712276
Pre-training layer 0, epoch 40, representative training free energy -434.318818787
Pre-training layer 0, epoch 40, validation free energy -427.441822754
Pre-training layer 0, epoch 41, cost -77.2094702148
Pre-training layer 0, epoch 42, cost -77.0770512581
Pre-training layer 0, epoch 43, cost -76.9150097561
Pre-training layer 0, epoch 44, cost -76.8027280235
Pre-training layer 0, epoch 45, cost -76.6349839211
Pre-training layer 0, epoch 45, representative training free energy -435.847538452
Pre-training layer 0, epoch 45, validation free energy -427.985819855
Pre-training layer 0, epoch 46, cost -76.636476841
Pre-training layer 0, epoch 47, cost -76.4567261314
Pre-training layer 0, epoch 48, cost -76.292738142
Pre-training layer 0, epoch 49, cost -76.3000889778
Pre-training layer 0, epoch 50, cost -76.1667474937
Pre-training layer 0, epoch 50, representative training free energy -429.937939423
Pre-training layer 0, epoch 50, validation free energy -422.299136414
Pre-training layer 0, epoch 51, cost -76.0346799755
Pre-training layer 0, epoch 52, cost -75.9110982513
Pre-training layer 0, epoch 53, cost -75.9810238647
Pre-training layer 0, epoch 54, cost -75.689691267
Pre-training layer 0, epoch 55, cost -75.6518552113
Pre-training layer 0, epoch 55, representative training free energy -428.05324469
Pre-training layer 0, epoch 55, validation free energy -420.226925751
Pre-training layer 0, epoch 56, cost -75.6201926041
Pre-training layer 0, epoch 57, cost -75.4565619755
Pre-training layer 0, epoch 58, cost -75.3732078743
Pre-training layer 0, epoch 59, cost -75.2809448719
Pre-training layer 0, epoch 60, cost -75.1164840698
Pre-training layer 0, epoch 60, representative training free energy -429.291424622
Pre-training layer 0, epoch 60, validation free energy -420.072100159
Pre-training layer 0, epoch 61, cost -75.2324108982
Pre-training layer 0, epoch 62, cost -75.1193598557
Pre-training layer 0, epoch 63, cost -75.0248549461
Pre-training layer 0, epoch 64, cost -74.9233278656
Pre-training layer 0, epoch 65, cost -74.8744084072
Pre-training layer 0, epoch 65, representative training free energy -426.874596069
Pre-training layer 0, epoch 65, validation free energy -418.381015167
Pre-training layer 0, epoch 66, cost -74.8947592258
Pre-training layer 0, epoch 67, cost -74.8191967773
Pre-training layer 0, epoch 68, cost -74.5268357563
Pre-training layer 0, epoch 69, cost -74.5504525375
Pre-training layer 0, epoch 70, cost -74.4133029175
Pre-training layer 0, epoch 70, representative training free energy -425.761791901
Pre-training layer 0, epoch 70, validation free energy -417.825659912
Pre-training layer 0, epoch 71, cost -74.4388980579
Pre-training layer 0, epoch 72, cost -74.4352321911
Pre-training layer 0, epoch 73, cost -74.3829084396
Pre-training layer 0, epoch 74, cost -74.2294658279
Pre-training layer 0, epoch 75, cost -74.0884430218
Pre-training layer 0, epoch 75, representative training free energy -425.39133194
Pre-training layer 0, epoch 75, validation free energy -417.000297974
Pre-training layer 0, epoch 76, cost -74.1163460159
Pre-training layer 0, epoch 77, cost -74.0311281013
Pre-training layer 0, epoch 78, cost -74.1008876228
Pre-training layer 0, epoch 79, cost -73.9567469692
Pre-training layer 0, epoch 80, cost -73.9367197514
Pre-training layer 0, epoch 80, representative training free energy -423.491432861
Pre-training layer 0, epoch 80, validation free energy -414.6506586
Pre-training layer 0, epoch 81, cost -73.8316615295
Pre-training layer 0, epoch 82, cost -73.796394968
Pre-training layer 0, epoch 83, cost -73.7065393353
Pre-training layer 0, epoch 84, cost -73.6703751755
Pre-training layer 0, epoch 85, cost -73.4899804497
Pre-training layer 0, epoch 85, representative training free energy -426.656192169
Pre-training layer 0, epoch 85, validation free energy -417.184901672
Pre-training layer 0, epoch 86, cost -73.5948455238
Pre-training layer 0, epoch 87, cost -73.5223679256
Pre-training layer 0, epoch 88, cost -73.5606291962
Pre-training layer 0, epoch 89, cost -73.4261523438
Pre-training layer 0, epoch 90, cost -73.4650167561
Pre-training layer 0, epoch 90, representative training free energy -421.257031342
Pre-training layer 0, epoch 90, validation free energy -412.435960754
Pre-training layer 0, epoch 91, cost -73.2812027359
Pre-training layer 0, epoch 92, cost -73.3313681316
Pre-training layer 0, epoch 93, cost -73.2301389027
Pre-training layer 0, epoch 94, cost -73.1200627708
Pre-training layer 0, epoch 95, cost -73.1441081429
Pre-training layer 0, epoch 95, representative training free energy -419.02476825
Pre-training layer 0, epoch 95, validation free energy -409.255897797
Pre-training layer 0, epoch 96, cost -73.2109913921
Pre-training layer 0, epoch 97, cost -73.1768017483
Pre-training layer 0, epoch 98, cost -73.0128189182
Pre-training layer 0, epoch 99, cost -73.0067908382
Pre-training layer 1, epoch 0, cost -324.694351273
Pre-training layer 1, epoch 0, representative training free energy -57311.3604707
Pre-training layer 1, epoch 0, validation free energy -56948.1273027
Pre-training layer 1, epoch 1, cost -279.026442337
Pre-training layer 1, epoch 2, cost -265.155712166
Pre-training layer 1, epoch 3, cost -256.871050339
Pre-training layer 1, epoch 4, cost -251.211454163
Pre-training layer 1, epoch 5, cost -247.270506554
Pre-training layer 1, epoch 5, representative training free energy -76877.9670488
Pre-training layer 1, epoch 5, validation free energy -76301.3736504
Pre-training layer 1, epoch 6, cost -244.058417816
Pre-training layer 1, epoch 7, cost -241.45753437
Pre-training layer 1, epoch 8, cost -239.392341309
Pre-training layer 1, epoch 9, cost -237.614945374
Pre-training layer 1, epoch 10, cost -236.141499596
Pre-training layer 1, epoch 10, representative training free energy -82723.9618496
Pre-training layer 1, epoch 10, validation free energy -82091.7456582
Pre-training layer 1, epoch 11, cost -234.763807526
Pre-training layer 1, epoch 12, cost -233.695832939
Pre-training layer 1, epoch 13, cost -232.575458832
Pre-training layer 1, epoch 14, cost -231.520626068
Pre-training layer 1, epoch 15, cost -230.856340446
Pre-training layer 1, epoch 15, representative training free energy -86136.8475273
Pre-training layer 1, epoch 15, validation free energy -85481.4060664
Pre-training layer 1, epoch 16, cost -230.10222847
Pre-training layer 1, epoch 17, cost -229.472557297
Pre-training layer 1, epoch 18, cost -228.893714294
Pre-training layer 1, epoch 19, cost -228.280259476
Pre-training layer 1, epoch 20, cost -227.683359032
Pre-training layer 1, epoch 20, representative training free energy -88628.7606914
Pre-training layer 1, epoch 20, validation free energy -87929.5159238
Pre-training layer 1, epoch 21, cost -227.223736992
Pre-training layer 1, epoch 22, cost -226.812735443
Pre-training layer 1, epoch 23, cost -226.383993874
Pre-training layer 1, epoch 24, cost -225.951326256
Pre-training layer 1, epoch 25, cost -225.687431831
Pre-training layer 1, epoch 25, representative training free energy -90524.4506094
Pre-training layer 1, epoch 25, validation free energy -89827.0696855
Pre-training layer 1, epoch 26, cost -225.175124855
Pre-training layer 1, epoch 27, cost -224.986020927
Pre-training layer 1, epoch 28, cost -224.640422249
Pre-training layer 1, epoch 29, cost -224.344557457
Pre-training layer 1, epoch 30, cost -224.059170876
Pre-training layer 1, epoch 30, representative training free energy -92180.067791
Pre-training layer 1, epoch 30, validation free energy -91464.1399922
Pre-training layer 1, epoch 31, cost -223.801138077
Pre-training layer 1, epoch 32, cost -223.491686707
Pre-training layer 1, epoch 33, cost -223.271124878
Pre-training layer 1, epoch 34, cost -223.079283218
Pre-training layer 1, epoch 35, cost -222.758307571
Pre-training layer 1, epoch 35, representative training free energy -93569.5999023
Pre-training layer 1, epoch 35, validation free energy -92831.9049648
Pre-training layer 1, epoch 36, cost -222.601537704
Pre-training layer 1, epoch 37, cost -222.407421722
Pre-training layer 1, epoch 38, cost -222.159014511
Pre-training layer 1, epoch 39, cost -221.918722801
Pre-training layer 1, epoch 40, cost -221.687155952
Pre-training layer 1, epoch 40, representative training free energy -94782.1236367
Pre-training layer 1, epoch 40, validation free energy -94046.6138066
Pre-training layer 1, epoch 41, cost -221.54609478
Pre-training layer 1, epoch 42, cost -221.449270935
Pre-training layer 1, epoch 43, cost -221.310250702
Pre-training layer 1, epoch 44, cost -221.108196869
Pre-training layer 1, epoch 45, cost -220.959915466
Pre-training layer 1, epoch 45, representative training free energy -95797.7682793
Pre-training layer 1, epoch 45, validation free energy -95040.0459883
Pre-training layer 1, epoch 46, cost -220.864159393
Pre-training layer 1, epoch 47, cost -220.708431015
Pre-training layer 1, epoch 48, cost -220.475013275
Pre-training layer 1, epoch 49, cost -220.474115181
Pre-training layer 1, epoch 50, cost -220.334189224
Pre-training layer 1, epoch 50, representative training free energy -96826.4971641
Pre-training layer 1, epoch 50, validation free energy -96068.6875469
Pre-training layer 1, epoch 51, cost -220.241255417
Pre-training layer 1, epoch 52, cost -219.997543602
Pre-training layer 1, epoch 53, cost -219.969250336
Pre-training layer 1, epoch 54, cost -219.809143486
Pre-training layer 1, epoch 55, cost -219.610337639
Pre-training layer 1, epoch 55, representative training free energy -97720.7325645
Pre-training layer 1, epoch 55, validation free energy -96950.8928711
Pre-training layer 1, epoch 56, cost -219.522255058
Pre-training layer 1, epoch 57, cost -219.368140564
Pre-training layer 1, epoch 58, cost -219.354421997
Pre-training layer 1, epoch 59, cost -219.213088684
Pre-training layer 1, epoch 60, cost -219.200001984
Pre-training layer 1, epoch 60, representative training free energy -98583.5340195
Pre-training layer 1, epoch 60, validation free energy -97804.3447051
Pre-training layer 1, epoch 61, cost -219.000177917
Pre-training layer 1, epoch 62, cost -218.893724442
Pre-training layer 1, epoch 63, cost -218.905856361
Pre-training layer 1, epoch 64, cost -218.789360733
Pre-training layer 1, epoch 65, cost -218.707007141
Pre-training layer 1, epoch 65, representative training free energy -99449.0041836
Pre-training layer 1, epoch 65, validation free energy -98662.1881328
Pre-training layer 1, epoch 66, cost -218.621336594
Pre-training layer 1, epoch 67, cost -218.56131958
Pre-training layer 1, epoch 68, cost -218.430895996
Pre-training layer 1, epoch 69, cost -218.391063309
Pre-training layer 1, epoch 70, cost -218.208940048
Pre-training layer 1, epoch 70, representative training free energy -100011.537365
Pre-training layer 1, epoch 70, validation free energy -99217.5253105
Pre-training layer 1, epoch 71, cost -218.253007011
Pre-training layer 1, epoch 72, cost -218.194143333
Pre-training layer 1, epoch 73, cost -217.963166809
Pre-training layer 1, epoch 74, cost -217.908816872
Pre-training layer 1, epoch 75, cost -217.794250755
Pre-training layer 1, epoch 75, representative training free energy -100651.055666
Pre-training layer 1, epoch 75, validation free energy -99870.6711172
Pre-training layer 1, epoch 76, cost -217.755157433
Pre-training layer 1, epoch 77, cost -217.709227676
Pre-training layer 1, epoch 78, cost -217.664917908
Pre-training layer 1, epoch 79, cost -217.602955208
Pre-training layer 1, epoch 80, cost -217.462461662
Pre-training layer 1, epoch 80, representative training free energy -101351.939361
Pre-training layer 1, epoch 80, validation free energy -100554.332703
Pre-training layer 1, epoch 81, cost -217.432177734
Pre-training layer 1, epoch 82, cost -217.426951485
Pre-training layer 1, epoch 83, cost -217.232310143
Pre-training layer 1, epoch 84, cost -217.298274765
Pre-training layer 1, epoch 85, cost -217.274108696
Pre-training layer 1, epoch 85, representative training free energy -102009.718574
Pre-training layer 1, epoch 85, validation free energy -101202.592797
Pre-training layer 1, epoch 86, cost -217.117784805
Pre-training layer 1, epoch 87, cost -217.122107735
Pre-training layer 1, epoch 88, cost -217.084667549
Pre-training layer 1, epoch 89, cost -217.024448013
Pre-training layer 1, epoch 90, cost -216.891765823
Pre-training layer 1, epoch 90, representative training free energy -102539.955805
Pre-training layer 1, epoch 90, validation free energy -101728.576836
Pre-training layer 1, epoch 91, cost -216.86382473
Pre-training layer 1, epoch 92, cost -216.818634911
Pre-training layer 1, epoch 93, cost -216.804503174
Pre-training layer 1, epoch 94, cost -216.702762718
Pre-training layer 1, epoch 95, cost -216.662592201
Pre-training layer 1, epoch 95, representative training free energy -103108.05226
Pre-training layer 1, epoch 95, validation free energy -102289.810977
Pre-training layer 1, epoch 96, cost -216.598475113
Pre-training layer 1, epoch 97, cost -216.568086128
Pre-training layer 1, epoch 98, cost -216.463319359
Pre-training layer 1, epoch 99, cost -216.466587868
Pre-training layer 2, epoch 0, cost -119.750458107
Pre-training layer 2, epoch 0, representative training free energy 3770.43704279
Pre-training layer 2, epoch 0, validation free energy 3763.4845719
Pre-training layer 2, epoch 1, cost -89.5556461334
Pre-training layer 2, epoch 2, cost -82.8576750183
Pre-training layer 2, epoch 3, cost -79.2354799557
Pre-training layer 2, epoch 4, cost -76.7420296383
Pre-training layer 2, epoch 5, cost -74.997345829
Pre-training layer 2, epoch 5, representative training free energy 5738.61210168
Pre-training layer 2, epoch 5, validation free energy 5688.24865564
Pre-training layer 2, epoch 6, cost -73.4989199638
Pre-training layer 2, epoch 7, cost -72.3625780106
Pre-training layer 2, epoch 8, cost -71.511935463
Pre-training layer 2, epoch 9, cost -70.6048905087
Pre-training layer 2, epoch 10, cost -69.9296724892
Pre-training layer 2, epoch 10, representative training free energy 6926.11335303
Pre-training layer 2, epoch 10, validation free energy 6864.94582544
Pre-training layer 2, epoch 11, cost -69.3817362785
Pre-training layer 2, epoch 12, cost -68.826502409
Pre-training layer 2, epoch 13, cost -68.3304559135
Pre-training layer 2, epoch 14, cost -67.9123153114
Pre-training layer 2, epoch 15, cost -67.6351664257
Pre-training layer 2, epoch 15, representative training free energy 7795.68852881
Pre-training layer 2, epoch 15, validation free energy 7725.31891772
Pre-training layer 2, epoch 16, cost -67.2435648823
Pre-training layer 2, epoch 17, cost -66.9623567963
Pre-training layer 2, epoch 18, cost -66.746839056
Pre-training layer 2, epoch 19, cost -66.5369956303
Pre-training layer 2, epoch 20, cost -66.3028409958
Pre-training layer 2, epoch 20, representative training free energy 8506.20385669
Pre-training layer 2, epoch 20, validation free energy 8432.89872607
Pre-training layer 2, epoch 21, cost -65.9743366718
Pre-training layer 2, epoch 22, cost -65.7447865295
Pre-training layer 2, epoch 23, cost -65.5227156067
Pre-training layer 2, epoch 24, cost -65.4594843006
Pre-training layer 2, epoch 25, cost -65.2870581532
Pre-training layer 2, epoch 25, representative training free energy 9073.988396
Pre-training layer 2, epoch 25, validation free energy 8997.47179614
Pre-training layer 2, epoch 26, cost -65.1541928673
Pre-training layer 2, epoch 27, cost -64.9351548767
Pre-training layer 2, epoch 28, cost -64.7927227688
Pre-training layer 2, epoch 29, cost -64.6811501026
Pre-training layer 2, epoch 30, cost -64.5248322964
Pre-training layer 2, epoch 30, representative training free energy 9576.09828735
Pre-training layer 2, epoch 30, validation free energy 9496.34485596
Pre-training layer 2, epoch 31, cost -64.5166683102
Pre-training layer 2, epoch 32, cost -64.3050811481
Pre-training layer 2, epoch 33, cost -64.2335960674
Pre-training layer 2, epoch 34, cost -64.1283401012
Pre-training layer 2, epoch 35, cost -64.0671141624
Pre-training layer 2, epoch 35, representative training free energy 10034.3733113
Pre-training layer 2, epoch 35, validation free energy 9952.59558569
Pre-training layer 2, epoch 36, cost -63.9001677799
Pre-training layer 2, epoch 37, cost -63.9039051151
Pre-training layer 2, epoch 38, cost -63.8437703705
Pre-training layer 2, epoch 39, cost -63.7436704922
Pre-training layer 2, epoch 40, cost -63.6238090134
Pre-training layer 2, epoch 40, representative training free energy 10421.6844475
Pre-training layer 2, epoch 40, validation free energy 10334.6072722
Pre-training layer 2, epoch 41, cost -63.5325861168
Pre-training layer 2, epoch 42, cost -63.5251285648
Pre-training layer 2, epoch 43, cost -63.3690894032
Pre-training layer 2, epoch 44, cost -63.3055781078
Pre-training layer 2, epoch 45, cost -63.2981188774
Pre-training layer 2, epoch 45, representative training free energy 10796.4216262
Pre-training layer 2, epoch 45, validation free energy 10705.9455159
Pre-training layer 2, epoch 46, cost -63.2306265736
Pre-training layer 2, epoch 47, cost -63.1051336765
Pre-training layer 2, epoch 48, cost -63.0656018925
Pre-training layer 2, epoch 49, cost -63.0359250546
Pre-training layer 2, epoch 50, cost -63.0051086998
Pre-training layer 2, epoch 50, representative training free energy 11180.6677458
Pre-training layer 2, epoch 50, validation free energy 11087.4931172
Pre-training layer 2, epoch 51, cost -62.9059067631
Pre-training layer 2, epoch 52, cost -62.8762086678
Pre-training layer 2, epoch 53, cost -62.812389822
Pre-training layer 2, epoch 54, cost -62.7811334324
Pre-training layer 2, epoch 55, cost -62.7755239487
Pre-training layer 2, epoch 55, representative training free energy 11512.889636
Pre-training layer 2, epoch 55, validation free energy 11418.7559063
Pre-training layer 2, epoch 56, cost -62.7686789417
Pre-training layer 2, epoch 57, cost -62.6917396641
Pre-training layer 2, epoch 58, cost -62.6180369663
Pre-training layer 2, epoch 59, cost -62.574248476
Pre-training layer 2, epoch 60, cost -62.5246223068
Pre-training layer 2, epoch 60, representative training free energy 11869.0034116
Pre-training layer 2, epoch 60, validation free energy 11771.4156936
Pre-training layer 2, epoch 61, cost -62.3807942963
Pre-training layer 2, epoch 62, cost -62.406461792
Pre-training layer 2, epoch 63, cost -62.4536746216
Pre-training layer 2, epoch 64, cost -62.3782938099
Pre-training layer 2, epoch 65, cost -62.3211137772
Pre-training layer 2, epoch 65, representative training free energy 12146.5510383
Pre-training layer 2, epoch 65, validation free energy 12045.9866689
Pre-training layer 2, epoch 66, cost -62.3179815483
Pre-training layer 2, epoch 67, cost -62.2918659973
Pre-training layer 2, epoch 68, cost -62.3489546204
Pre-training layer 2, epoch 69, cost -62.2170518303
Pre-training layer 2, epoch 70, cost -62.1540657997
Pre-training layer 2, epoch 70, representative training free energy 12467.6024912
Pre-training layer 2, epoch 70, validation free energy 12363.415729
Pre-training layer 2, epoch 71, cost -62.1015699196
Pre-training layer 2, epoch 72, cost -62.1388990402
Pre-training layer 2, epoch 73, cost -62.100661211
Pre-training layer 2, epoch 74, cost -62.0541736412
Pre-training layer 2, epoch 75, cost -61.9834772491
Pre-training layer 2, epoch 75, representative training free energy 12729.8417627
Pre-training layer 2, epoch 75, validation free energy 12624.9879189
Pre-training layer 2, epoch 76, cost -62.0562441063
Pre-training layer 2, epoch 77, cost -61.9899570847
Pre-training layer 2, epoch 78, cost -61.933632021
Pre-training layer 2, epoch 79, cost -61.960005846
Pre-training layer 2, epoch 80, cost -61.8564957714
Pre-training layer 2, epoch 80, representative training free energy 13016.2081328
Pre-training layer 2, epoch 80, validation free energy 12908.7099409
Pre-training layer 2, epoch 81, cost -61.9057535839
Pre-training layer 2, epoch 82, cost -61.7821075821
Pre-training layer 2, epoch 83, cost -61.7716807938
Pre-training layer 2, epoch 84, cost -61.752521534
Pre-training layer 2, epoch 85, cost -61.7861741066
Pre-training layer 2, epoch 85, representative training free energy 13310.9038647
Pre-training layer 2, epoch 85, validation free energy 13201.9902827
Pre-training layer 2, epoch 86, cost -61.7674523067
Pre-training layer 2, epoch 87, cost -61.7176513767
Pre-training layer 2, epoch 88, cost -61.5969582462
Pre-training layer 2, epoch 89, cost -61.6396061707
Pre-training layer 2, epoch 90, cost -61.6514559269
Pre-training layer 2, epoch 90, representative training free energy 13532.7641616
Pre-training layer 2, epoch 90, validation free energy 13422.2958945
Pre-training layer 2, epoch 91, cost -61.5489082527
Pre-training layer 2, epoch 92, cost -61.5505400372
Pre-training layer 2, epoch 93, cost -61.633424902
Pre-training layer 2, epoch 94, cost -61.5345041561
Pre-training layer 2, epoch 95, cost -61.5147474194
Pre-training layer 2, epoch 95, representative training free energy 13832.9022852
Pre-training layer 2, epoch 95, validation free energy 13721.1739775
Pre-training layer 2, epoch 96, cost -61.4521471882
Pre-training layer 2, epoch 97, cost -61.4416776943
Pre-training layer 2, epoch 98, cost -61.5171656513
Pre-training layer 2, epoch 99, cost -61.431488657
The pretraining code for file dbn_loop.pyc ran for 10.49m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 400/400, validation error 34.700000 %
     epoch 1, minibatch 400/400, test error of best model 30.400000 %
epoch 2, minibatch 400/400, validation error 24.400000 %
     epoch 2, minibatch 400/400, test error of best model 17.000000 %
epoch 3, minibatch 400/400, validation error 21.800000 %
     epoch 3, minibatch 400/400, test error of best model 12.200000 %
epoch 4, minibatch 400/400, validation error 19.900000 %
     epoch 4, minibatch 400/400, test error of best model 10.600000 %
epoch 5, minibatch 400/400, validation error 19.400000 %
     epoch 5, minibatch 400/400, test error of best model 9.400000 %
epoch 6, minibatch 400/400, validation error 18.300000 %
     epoch 6, minibatch 400/400, test error of best model 8.700000 %
epoch 7, minibatch 400/400, validation error 17.800000 %
     epoch 7, minibatch 400/400, test error of best model 8.000000 %
epoch 8, minibatch 400/400, validation error 17.500000 %
     epoch 8, minibatch 400/400, test error of best model 7.600000 %
epoch 9, minibatch 400/400, validation error 17.400000 %
     epoch 9, minibatch 400/400, test error of best model 7.200000 %
epoch 10, minibatch 400/400, validation error 16.900000 %
     epoch 10, minibatch 400/400, test error of best model 6.400000 %
epoch 11, minibatch 400/400, validation error 16.500000 %
     epoch 11, minibatch 400/400, test error of best model 6.600000 %
epoch 12, minibatch 400/400, validation error 16.300000 %
     epoch 12, minibatch 400/400, test error of best model 6.400000 %
epoch 13, minibatch 400/400, validation error 16.200000 %
     epoch 13, minibatch 400/400, test error of best model 6.300000 %
epoch 14, minibatch 400/400, validation error 16.100000 %
     epoch 14, minibatch 400/400, test error of best model 6.200000 %
epoch 15, minibatch 400/400, validation error 16.200000 %
epoch 16, minibatch 400/400, validation error 16.100000 %
epoch 17, minibatch 400/400, validation error 16.100000 %
epoch 18, minibatch 400/400, validation error 16.100000 %
epoch 19, minibatch 400/400, validation error 16.000000 %
     epoch 19, minibatch 400/400, test error of best model 6.300000 %
epoch 20, minibatch 400/400, validation error 16.000000 %
epoch 21, minibatch 400/400, validation error 15.800000 %
     epoch 21, minibatch 400/400, test error of best model 6.200000 %
epoch 22, minibatch 400/400, validation error 15.800000 %
epoch 23, minibatch 400/400, validation error 15.800000 %
epoch 24, minibatch 400/400, validation error 15.700000 %
     epoch 24, minibatch 400/400, test error of best model 6.100000 %
epoch 25, minibatch 400/400, validation error 15.600000 %
     epoch 25, minibatch 400/400, test error of best model 6.200000 %
epoch 26, minibatch 400/400, validation error 15.600000 %
epoch 27, minibatch 400/400, validation error 15.500000 %
     epoch 27, minibatch 400/400, test error of best model 6.200000 %
epoch 28, minibatch 400/400, validation error 15.500000 %
epoch 29, minibatch 400/400, validation error 15.300000 %
     epoch 29, minibatch 400/400, test error of best model 6.200000 %
epoch 30, minibatch 400/400, validation error 15.100000 %
     epoch 30, minibatch 400/400, test error of best model 6.200000 %
epoch 31, minibatch 400/400, validation error 15.100000 %
epoch 32, minibatch 400/400, validation error 15.000000 %
     epoch 32, minibatch 400/400, test error of best model 6.300000 %
epoch 33, minibatch 400/400, validation error 15.000000 %
epoch 34, minibatch 400/400, validation error 15.000000 %
epoch 35, minibatch 400/400, validation error 15.000000 %
epoch 36, minibatch 400/400, validation error 14.900000 %
     epoch 36, minibatch 400/400, test error of best model 6.300000 %
epoch 37, minibatch 400/400, validation error 14.900000 %
epoch 38, minibatch 400/400, validation error 14.900000 %
epoch 39, minibatch 400/400, validation error 15.000000 %
epoch 40, minibatch 400/400, validation error 15.000000 %
epoch 41, minibatch 400/400, validation error 15.200000 %
epoch 42, minibatch 400/400, validation error 15.200000 %
epoch 43, minibatch 400/400, validation error 15.200000 %
epoch 44, minibatch 400/400, validation error 15.200000 %
epoch 45, minibatch 400/400, validation error 15.200000 %
epoch 46, minibatch 400/400, validation error 15.200000 %
epoch 47, minibatch 400/400, validation error 15.200000 %
epoch 48, minibatch 400/400, validation error 15.200000 %
epoch 49, minibatch 400/400, validation error 15.200000 %
epoch 50, minibatch 400/400, validation error 15.200000 %
epoch 51, minibatch 400/400, validation error 15.100000 %
epoch 52, minibatch 400/400, validation error 15.100000 %
epoch 53, minibatch 400/400, validation error 15.100000 %
epoch 54, minibatch 400/400, validation error 15.100000 %
epoch 55, minibatch 400/400, validation error 15.100000 %
epoch 56, minibatch 400/400, validation error 15.100000 %
epoch 57, minibatch 400/400, validation error 15.100000 %
epoch 58, minibatch 400/400, validation error 15.000000 %
epoch 59, minibatch 400/400, validation error 15.000000 %
epoch 60, minibatch 400/400, validation error 15.000000 %
epoch 61, minibatch 400/400, validation error 15.000000 %
epoch 62, minibatch 400/400, validation error 14.900000 %
epoch 63, minibatch 400/400, validation error 14.800000 %
     epoch 63, minibatch 400/400, test error of best model 6.300000 %
epoch 64, minibatch 400/400, validation error 14.800000 %
epoch 65, minibatch 400/400, validation error 14.800000 %
epoch 66, minibatch 400/400, validation error 14.800000 %
epoch 67, minibatch 400/400, validation error 14.800000 %
epoch 68, minibatch 400/400, validation error 14.800000 %
epoch 69, minibatch 400/400, validation error 14.800000 %
epoch 70, minibatch 400/400, validation error 14.800000 %
epoch 71, minibatch 400/400, validation error 14.700000 %
     epoch 71, minibatch 400/400, test error of best model 6.200000 %
epoch 72, minibatch 400/400, validation error 14.700000 %
epoch 73, minibatch 400/400, validation error 14.700000 %
epoch 74, minibatch 400/400, validation error 14.800000 %
epoch 75, minibatch 400/400, validation error 14.800000 %
epoch 76, minibatch 400/400, validation error 14.800000 %
epoch 77, minibatch 400/400, validation error 14.800000 %
epoch 78, minibatch 400/400, validation error 14.800000 %
epoch 79, minibatch 400/400, validation error 14.800000 %
epoch 80, minibatch 400/400, validation error 14.800000 %
epoch 81, minibatch 400/400, validation error 14.800000 %
epoch 82, minibatch 400/400, validation error 14.800000 %
epoch 83, minibatch 400/400, validation error 14.800000 %
epoch 84, minibatch 400/400, validation error 14.800000 %
epoch 85, minibatch 400/400, validation error 14.800000 %
epoch 86, minibatch 400/400, validation error 14.800000 %
epoch 87, minibatch 400/400, validation error 14.800000 %
epoch 88, minibatch 400/400, validation error 14.800000 %
epoch 89, minibatch 400/400, validation error 14.700000 %
epoch 90, minibatch 400/400, validation error 14.700000 %
epoch 91, minibatch 400/400, validation error 14.700000 %
epoch 92, minibatch 400/400, validation error 14.700000 %
epoch 93, minibatch 400/400, validation error 14.700000 %
epoch 94, minibatch 400/400, validation error 14.700000 %
epoch 95, minibatch 400/400, validation error 14.600000 %
     epoch 95, minibatch 400/400, test error of best model 6.200000 %
epoch 96, minibatch 400/400, validation error 14.600000 %
epoch 97, minibatch 400/400, validation error 14.600000 %
epoch 98, minibatch 400/400, validation error 14.600000 %
epoch 99, minibatch 400/400, validation error 14.600000 %
epoch 100, minibatch 400/400, validation error 14.600000 %
epoch 101, minibatch 400/400, validation error 14.600000 %
epoch 102, minibatch 400/400, validation error 14.600000 %
epoch 103, minibatch 400/400, validation error 14.600000 %
epoch 104, minibatch 400/400, validation error 14.600000 %
epoch 105, minibatch 400/400, validation error 14.600000 %
epoch 106, minibatch 400/400, validation error 14.600000 %
epoch 107, minibatch 400/400, validation error 14.600000 %
epoch 108, minibatch 400/400, validation error 14.600000 %
epoch 109, minibatch 400/400, validation error 14.600000 %
epoch 110, minibatch 400/400, validation error 14.600000 %
epoch 111, minibatch 400/400, validation error 14.600000 %
epoch 112, minibatch 400/400, validation error 14.600000 %
epoch 113, minibatch 400/400, validation error 14.600000 %
epoch 114, minibatch 400/400, validation error 14.600000 %
epoch 115, minibatch 400/400, validation error 14.600000 %
epoch 116, minibatch 400/400, validation error 14.600000 %
epoch 117, minibatch 400/400, validation error 14.600000 %
epoch 118, minibatch 400/400, validation error 14.600000 %
epoch 119, minibatch 400/400, validation error 14.600000 %
epoch 120, minibatch 400/400, validation error 14.600000 %
epoch 121, minibatch 400/400, validation error 14.600000 %
epoch 122, minibatch 400/400, validation error 14.600000 %
epoch 123, minibatch 400/400, validation error 14.600000 %
epoch 124, minibatch 400/400, validation error 14.600000 %
epoch 125, minibatch 400/400, validation error 14.600000 %
epoch 126, minibatch 400/400, validation error 14.600000 %
epoch 127, minibatch 400/400, validation error 14.600000 %
epoch 128, minibatch 400/400, validation error 14.600000 %
epoch 129, minibatch 400/400, validation error 14.600000 %
epoch 130, minibatch 400/400, validation error 14.600000 %
epoch 131, minibatch 400/400, validation error 14.600000 %
epoch 132, minibatch 400/400, validation error 14.600000 %
epoch 133, minibatch 400/400, validation error 14.600000 %
epoch 134, minibatch 400/400, validation error 14.600000 %
epoch 135, minibatch 400/400, validation error 14.600000 %
epoch 136, minibatch 400/400, validation error 14.600000 %
epoch 137, minibatch 400/400, validation error 14.600000 %
epoch 138, minibatch 400/400, validation error 14.600000 %
epoch 139, minibatch 400/400, validation error 14.600000 %
epoch 140, minibatch 400/400, validation error 14.600000 %
epoch 141, minibatch 400/400, validation error 14.600000 %
epoch 142, minibatch 400/400, validation error 14.600000 %
epoch 143, minibatch 400/400, validation error 14.600000 %
epoch 144, minibatch 400/400, validation error 14.600000 %
epoch 145, minibatch 400/400, validation error 14.600000 %
epoch 146, minibatch 400/400, validation error 14.600000 %
epoch 147, minibatch 400/400, validation error 14.600000 %
epoch 148, minibatch 400/400, validation error 14.600000 %
epoch 149, minibatch 400/400, validation error 14.600000 %
epoch 150, minibatch 400/400, validation error 14.600000 %
epoch 151, minibatch 400/400, validation error 14.600000 %
epoch 152, minibatch 400/400, validation error 14.600000 %
epoch 153, minibatch 400/400, validation error 14.600000 %
epoch 154, minibatch 400/400, validation error 14.600000 %
epoch 155, minibatch 400/400, validation error 14.600000 %
epoch 156, minibatch 400/400, validation error 14.600000 %
epoch 157, minibatch 400/400, validation error 14.600000 %
epoch 158, minibatch 400/400, validation error 14.600000 %
epoch 159, minibatch 400/400, validation error 14.600000 %
epoch 160, minibatch 400/400, validation error 14.600000 %
epoch 161, minibatch 400/400, validation error 14.600000 %
epoch 162, minibatch 400/400, validation error 14.600000 %
epoch 163, minibatch 400/400, validation error 14.500000 %
     epoch 163, minibatch 400/400, test error of best model 6.000000 %
epoch 164, minibatch 400/400, validation error 14.500000 %
epoch 165, minibatch 400/400, validation error 14.500000 %
epoch 166, minibatch 400/400, validation error 14.500000 %
epoch 167, minibatch 400/400, validation error 14.500000 %
epoch 168, minibatch 400/400, validation error 14.500000 %
epoch 169, minibatch 400/400, validation error 14.500000 %
epoch 170, minibatch 400/400, validation error 14.500000 %
epoch 171, minibatch 400/400, validation error 14.500000 %
epoch 172, minibatch 400/400, validation error 14.500000 %
epoch 173, minibatch 400/400, validation error 14.500000 %
epoch 174, minibatch 400/400, validation error 14.500000 %
epoch 175, minibatch 400/400, validation error 14.500000 %
epoch 176, minibatch 400/400, validation error 14.500000 %
epoch 177, minibatch 400/400, validation error 14.500000 %
epoch 178, minibatch 400/400, validation error 14.500000 %
epoch 179, minibatch 400/400, validation error 14.500000 %
epoch 180, minibatch 400/400, validation error 14.500000 %
epoch 181, minibatch 400/400, validation error 14.500000 %
epoch 182, minibatch 400/400, validation error 14.500000 %
epoch 183, minibatch 400/400, validation error 14.500000 %
epoch 184, minibatch 400/400, validation error 14.500000 %
epoch 185, minibatch 400/400, validation error 14.500000 %
epoch 186, minibatch 400/400, validation error 14.500000 %
epoch 187, minibatch 400/400, validation error 14.500000 %
epoch 188, minibatch 400/400, validation error 14.500000 %
epoch 189, minibatch 400/400, validation error 14.500000 %
epoch 190, minibatch 400/400, validation error 14.500000 %
epoch 191, minibatch 400/400, validation error 14.500000 %
epoch 192, minibatch 400/400, validation error 14.500000 %
epoch 193, minibatch 400/400, validation error 14.500000 %
epoch 194, minibatch 400/400, validation error 14.500000 %
epoch 195, minibatch 400/400, validation error 14.500000 %
epoch 196, minibatch 400/400, validation error 14.500000 %
epoch 197, minibatch 400/400, validation error 14.500000 %
epoch 198, minibatch 400/400, validation error 14.500000 %
epoch 199, minibatch 400/400, validation error 14.500000 %
epoch 200, minibatch 400/400, validation error 14.500000 %
epoch 201, minibatch 400/400, validation error 14.500000 %
epoch 202, minibatch 400/400, validation error 14.500000 %
epoch 203, minibatch 400/400, validation error 14.500000 %
epoch 204, minibatch 400/400, validation error 14.500000 %
epoch 205, minibatch 400/400, validation error 14.500000 %
epoch 206, minibatch 400/400, validation error 14.500000 %
epoch 207, minibatch 400/400, validation error 14.500000 %
epoch 208, minibatch 400/400, validation error 14.500000 %
epoch 209, minibatch 400/400, validation error 14.500000 %
epoch 210, minibatch 400/400, validation error 14.500000 %
epoch 211, minibatch 400/400, validation error 14.500000 %
epoch 212, minibatch 400/400, validation error 14.500000 %
epoch 213, minibatch 400/400, validation error 14.500000 %
epoch 214, minibatch 400/400, validation error 14.500000 %
epoch 215, minibatch 400/400, validation error 14.500000 %
epoch 216, minibatch 400/400, validation error 14.500000 %
epoch 217, minibatch 400/400, validation error 14.500000 %
epoch 218, minibatch 400/400, validation error 14.500000 %
epoch 219, minibatch 400/400, validation error 14.500000 %
epoch 220, minibatch 400/400, validation error 14.500000 %
epoch 221, minibatch 400/400, validation error 14.500000 %
epoch 222, minibatch 400/400, validation error 14.500000 %
epoch 223, minibatch 400/400, validation error 14.500000 %
epoch 224, minibatch 400/400, validation error 14.500000 %
epoch 225, minibatch 400/400, validation error 14.500000 %
epoch 226, minibatch 400/400, validation error 14.500000 %
epoch 227, minibatch 400/400, validation error 14.500000 %
epoch 228, minibatch 400/400, validation error 14.500000 %
epoch 229, minibatch 400/400, validation error 14.500000 %
epoch 230, minibatch 400/400, validation error 14.500000 %
epoch 231, minibatch 400/400, validation error 14.500000 %
epoch 232, minibatch 400/400, validation error 14.500000 %
epoch 233, minibatch 400/400, validation error 14.500000 %
epoch 234, minibatch 400/400, validation error 14.500000 %
epoch 235, minibatch 400/400, validation error 14.500000 %
epoch 236, minibatch 400/400, validation error 14.500000 %
epoch 237, minibatch 400/400, validation error 14.500000 %
epoch 238, minibatch 400/400, validation error 14.500000 %
epoch 239, minibatch 400/400, validation error 14.500000 %
epoch 240, minibatch 400/400, validation error 14.500000 %
epoch 241, minibatch 400/400, validation error 14.500000 %
epoch 242, minibatch 400/400, validation error 14.500000 %
epoch 243, minibatch 400/400, validation error 14.500000 %
epoch 244, minibatch 400/400, validation error 14.500000 %
epoch 245, minibatch 400/400, validation error 14.500000 %
epoch 246, minibatch 400/400, validation error 14.500000 %
epoch 247, minibatch 400/400, validation error 14.500000 %
epoch 248, minibatch 400/400, validation error 14.500000 %
epoch 249, minibatch 400/400, validation error 14.500000 %
epoch 250, minibatch 400/400, validation error 14.500000 %
epoch 251, minibatch 400/400, validation error 14.500000 %
epoch 252, minibatch 400/400, validation error 14.500000 %
epoch 253, minibatch 400/400, validation error 14.500000 %
epoch 254, minibatch 400/400, validation error 14.500000 %
epoch 255, minibatch 400/400, validation error 14.500000 %
epoch 256, minibatch 400/400, validation error 14.500000 %
epoch 257, minibatch 400/400, validation error 14.500000 %
epoch 258, minibatch 400/400, validation error 14.500000 %
epoch 259, minibatch 400/400, validation error 14.500000 %
epoch 260, minibatch 400/400, validation error 14.500000 %
epoch 261, minibatch 400/400, validation error 14.500000 %
epoch 262, minibatch 400/400, validation error 14.500000 %
epoch 263, minibatch 400/400, validation error 14.500000 %
epoch 264, minibatch 400/400, validation error 14.500000 %
epoch 265, minibatch 400/400, validation error 14.500000 %
epoch 266, minibatch 400/400, validation error 14.500000 %
epoch 267, minibatch 400/400, validation error 14.500000 %
epoch 268, minibatch 400/400, validation error 14.500000 %
epoch 269, minibatch 400/400, validation error 14.500000 %
epoch 270, minibatch 400/400, validation error 14.500000 %
epoch 271, minibatch 400/400, validation error 14.500000 %
epoch 272, minibatch 400/400, validation error 14.500000 %
epoch 273, minibatch 400/400, validation error 14.500000 %
epoch 274, minibatch 400/400, validation error 14.500000 %
epoch 275, minibatch 400/400, validation error 14.500000 %
epoch 276, minibatch 400/400, validation error 14.500000 %
epoch 277, minibatch 400/400, validation error 14.500000 %
epoch 278, minibatch 400/400, validation error 14.500000 %
epoch 279, minibatch 400/400, validation error 14.500000 %
epoch 280, minibatch 400/400, validation error 14.500000 %
epoch 281, minibatch 400/400, validation error 14.500000 %
epoch 282, minibatch 400/400, validation error 14.500000 %
epoch 283, minibatch 400/400, validation error 14.500000 %
epoch 284, minibatch 400/400, validation error 14.500000 %
epoch 285, minibatch 400/400, validation error 14.500000 %
epoch 286, minibatch 400/400, validation error 14.500000 %
epoch 287, minibatch 400/400, validation error 14.500000 %
epoch 288, minibatch 400/400, validation error 14.500000 %
epoch 289, minibatch 400/400, validation error 14.500000 %
epoch 290, minibatch 400/400, validation error 14.500000 %
epoch 291, minibatch 400/400, validation error 14.500000 %
epoch 292, minibatch 400/400, validation error 14.500000 %
epoch 293, minibatch 400/400, validation error 14.500000 %
epoch 294, minibatch 400/400, validation error 14.500000 %
epoch 295, minibatch 400/400, validation error 14.500000 %
epoch 296, minibatch 400/400, validation error 14.500000 %
epoch 297, minibatch 400/400, validation error 14.500000 %
epoch 298, minibatch 400/400, validation error 14.500000 %
epoch 299, minibatch 400/400, validation error 14.500000 %
epoch 300, minibatch 400/400, validation error 14.500000 %
epoch 301, minibatch 400/400, validation error 14.500000 %
epoch 302, minibatch 400/400, validation error 14.500000 %
epoch 303, minibatch 400/400, validation error 14.500000 %
epoch 304, minibatch 400/400, validation error 14.500000 %
epoch 305, minibatch 400/400, validation error 14.500000 %
epoch 306, minibatch 400/400, validation error 14.500000 %
epoch 307, minibatch 400/400, validation error 14.500000 %
epoch 308, minibatch 400/400, validation error 14.500000 %
epoch 309, minibatch 400/400, validation error 14.500000 %
epoch 310, minibatch 400/400, validation error 14.500000 %
epoch 311, minibatch 400/400, validation error 14.500000 %
epoch 312, minibatch 400/400, validation error 14.500000 %
epoch 313, minibatch 400/400, validation error 14.500000 %
epoch 314, minibatch 400/400, validation error 14.500000 %
epoch 315, minibatch 400/400, validation error 14.500000 %
epoch 316, minibatch 400/400, validation error 14.500000 %
epoch 317, minibatch 400/400, validation error 14.500000 %
epoch 318, minibatch 400/400, validation error 14.500000 %
epoch 319, minibatch 400/400, validation error 14.500000 %
epoch 320, minibatch 400/400, validation error 14.500000 %
epoch 321, minibatch 400/400, validation error 14.500000 %
epoch 322, minibatch 400/400, validation error 14.500000 %
epoch 323, minibatch 400/400, validation error 14.500000 %
epoch 324, minibatch 400/400, validation error 14.500000 %
epoch 325, minibatch 400/400, validation error 14.500000 %
Optimization complete with best validation score of 14.500000 %, obtained at iteration 65200, with test performance 6.000000 %
The fine tuning code for file dbn_loop.pyc ran for 10.93m


==========Sample: (5000,1000,1000)===========

... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost -138.660812256
Pre-training layer 0, epoch 0, representative training free energy -545.779011169
Pre-training layer 0, epoch 0, validation free energy -542.224973145
Pre-training layer 0, epoch 1, cost -108.668594452
Pre-training layer 0, epoch 2, cost -100.877104965
Pre-training layer 0, epoch 3, cost -96.493406189
Pre-training layer 0, epoch 4, cost -93.4943333435
Pre-training layer 0, epoch 5, cost -91.2912367249
Pre-training layer 0, epoch 5, representative training free energy -489.205980774
Pre-training layer 0, epoch 5, validation free energy -483.741313385
Pre-training layer 0, epoch 6, cost -89.6651550522
Pre-training layer 0, epoch 7, cost -88.2158263397
Pre-training layer 0, epoch 8, cost -87.1738821716
Pre-training layer 0, epoch 9, cost -86.1640822525
Pre-training layer 0, epoch 10, cost -85.2989472733
Pre-training layer 0, epoch 10, representative training free energy -467.471796356
Pre-training layer 0, epoch 10, validation free energy -462.292979462
Pre-training layer 0, epoch 11, cost -84.6211958008
Pre-training layer 0, epoch 12, cost -83.8936693802
Pre-training layer 0, epoch 13, cost -83.363500412
Pre-training layer 0, epoch 14, cost -82.8668063202
Pre-training layer 0, epoch 15, cost -82.3469235153
Pre-training layer 0, epoch 15, representative training free energy -458.588260681
Pre-training layer 0, epoch 15, validation free energy -452.058731415
Pre-training layer 0, epoch 16, cost -81.9419123764
Pre-training layer 0, epoch 17, cost -81.5666847
Pre-training layer 0, epoch 18, cost -81.1991974258
Pre-training layer 0, epoch 19, cost -80.838725769
Pre-training layer 0, epoch 20, cost -80.5065197449
Pre-training layer 0, epoch 20, representative training free energy -446.933244995
Pre-training layer 0, epoch 20, validation free energy -441.562216187
Pre-training layer 0, epoch 21, cost -80.2705855865
Pre-training layer 0, epoch 22, cost -79.9485379715
Pre-training layer 0, epoch 23, cost -79.6952980957
Pre-training layer 0, epoch 24, cost -79.4583970566
Pre-training layer 0, epoch 25, cost -79.2184976273
Pre-training layer 0, epoch 25, representative training free energy -444.803977844
Pre-training layer 0, epoch 25, validation free energy -438.155491302
Pre-training layer 0, epoch 26, cost -79.0314790955
Pre-training layer 0, epoch 27, cost -78.7319686661
Pre-training layer 0, epoch 28, cost -78.561587677
Pre-training layer 0, epoch 29, cost -78.4223800049
Pre-training layer 0, epoch 30, cost -78.2447616959
Pre-training layer 0, epoch 30, representative training free energy -440.233364655
Pre-training layer 0, epoch 30, validation free energy -433.724040955
Pre-training layer 0, epoch 31, cost -78.0941690369
Pre-training layer 0, epoch 32, cost -77.965618103
Pre-training layer 0, epoch 33, cost -77.8289074783
Pre-training layer 0, epoch 34, cost -77.6759989014
Pre-training layer 0, epoch 35, cost -77.4555815048
Pre-training layer 0, epoch 35, representative training free energy -435.018098541
Pre-training layer 0, epoch 35, validation free energy -428.147836761
Pre-training layer 0, epoch 36, cost -77.3349684448
Pre-training layer 0, epoch 37, cost -77.0916261978
Pre-training layer 0, epoch 38, cost -76.9817067795
Pre-training layer 0, epoch 39, cost -76.8380596924
Pre-training layer 0, epoch 40, cost -76.6652282944
Pre-training layer 0, epoch 40, representative training free energy -435.44409256
Pre-training layer 0, epoch 40, validation free energy -427.908699158
Pre-training layer 0, epoch 41, cost -76.5832843933
Pre-training layer 0, epoch 42, cost -76.4575908813
Pre-training layer 0, epoch 43, cost -76.4475890808
Pre-training layer 0, epoch 44, cost -76.1777959747
Pre-training layer 0, epoch 45, cost -76.0708837738
Pre-training layer 0, epoch 45, representative training free energy -433.404264893
Pre-training layer 0, epoch 45, validation free energy -425.60359433
Pre-training layer 0, epoch 46, cost -76.0363168259
Pre-training layer 0, epoch 47, cost -75.9125726395
Pre-training layer 0, epoch 48, cost -75.8364339142
Pre-training layer 0, epoch 49, cost -75.7424453354
Pre-training layer 0, epoch 50, cost -75.6958797836
Pre-training layer 0, epoch 50, representative training free energy -429.916552948
Pre-training layer 0, epoch 50, validation free energy -421.825786041
Pre-training layer 0, epoch 51, cost -75.6115077286
Pre-training layer 0, epoch 52, cost -75.4744711533
Pre-training layer 0, epoch 53, cost -75.4443373795
Pre-training layer 0, epoch 54, cost -75.3259455719
Pre-training layer 0, epoch 55, cost -75.1479057693
Pre-training layer 0, epoch 55, representative training free energy -430.58691449
Pre-training layer 0, epoch 55, validation free energy -422.993122986
Pre-training layer 0, epoch 56, cost -75.1171722183
Pre-training layer 0, epoch 57, cost -74.949850029
Pre-training layer 0, epoch 58, cost -74.9996252594
Pre-training layer 0, epoch 59, cost -74.8758178024
Pre-training layer 0, epoch 60, cost -74.8015933914
Pre-training layer 0, epoch 60, representative training free energy -426.759412811
Pre-training layer 0, epoch 60, validation free energy -418.554419891
Pre-training layer 0, epoch 61, cost -74.7132195816
Pre-training layer 0, epoch 62, cost -74.7043192291
Pre-training layer 0, epoch 63, cost -74.6266453705
Pre-training layer 0, epoch 64, cost -74.5313872986
Pre-training layer 0, epoch 65, cost -74.4069536591
Pre-training layer 0, epoch 65, representative training free energy -430.878185577
Pre-training layer 0, epoch 65, validation free energy -422.727753082
Pre-training layer 0, epoch 66, cost -74.4088730469
Pre-training layer 0, epoch 67, cost -74.2399818115
Pre-training layer 0, epoch 68, cost -74.2512742615
Pre-training layer 0, epoch 69, cost -74.1685324402
Pre-training layer 0, epoch 70, cost -74.1839306641
Pre-training layer 0, epoch 70, representative training free energy -427.208195953
Pre-training layer 0, epoch 70, validation free energy -419.190890778
Pre-training layer 0, epoch 71, cost -73.9333730545
Pre-training layer 0, epoch 72, cost -74.0029335175
Pre-training layer 0, epoch 73, cost -73.9309905319
Pre-training layer 0, epoch 74, cost -73.9185240021
Pre-training layer 0, epoch 75, cost -73.8418507156
Pre-training layer 0, epoch 75, representative training free energy -427.330815765
Pre-training layer 0, epoch 75, validation free energy -418.823739777
Pre-training layer 0, epoch 76, cost -73.8490183487
Pre-training layer 0, epoch 77, cost -73.6631748962
Pre-training layer 0, epoch 78, cost -73.6733924408
Pre-training layer 0, epoch 79, cost -73.5767776794
Pre-training layer 0, epoch 80, cost -73.5870540771
Pre-training layer 0, epoch 80, representative training free energy -422.737759491
Pre-training layer 0, epoch 80, validation free energy -414.577466125
Pre-training layer 0, epoch 81, cost -73.5132998047
Pre-training layer 0, epoch 82, cost -73.3925193405
Pre-training layer 0, epoch 83, cost -73.4193668594
Pre-training layer 0, epoch 84, cost -73.4042673035
Pre-training layer 0, epoch 85, cost -73.2978532181
Pre-training layer 0, epoch 85, representative training free energy -422.634768127
Pre-training layer 0, epoch 85, validation free energy -414.312119202
Pre-training layer 0, epoch 86, cost -73.2343546524
Pre-training layer 0, epoch 87, cost -73.2144197769
Pre-training layer 0, epoch 88, cost -73.1497583694
Pre-training layer 0, epoch 89, cost -73.15863591
Pre-training layer 0, epoch 90, cost -73.1092558517
Pre-training layer 0, epoch 90, representative training free energy -422.516341766
Pre-training layer 0, epoch 90, validation free energy -413.750216125
Pre-training layer 0, epoch 91, cost -73.0759360123
Pre-training layer 0, epoch 92, cost -73.0457193298
Pre-training layer 0, epoch 93, cost -72.926480545
Pre-training layer 0, epoch 94, cost -72.9053224258
Pre-training layer 0, epoch 95, cost -72.795266243
Pre-training layer 0, epoch 95, representative training free energy -419.080943054
Pre-training layer 0, epoch 95, validation free energy -410.857903259
Pre-training layer 0, epoch 96, cost -72.8047944031
Pre-training layer 0, epoch 97, cost -72.7906691589
Pre-training layer 0, epoch 98, cost -72.6972127304
Pre-training layer 0, epoch 99, cost -72.7294725189
Pre-training layer 1, epoch 0, cost -311.802760437
Pre-training layer 1, epoch 0, representative training free energy -62313.3936563
Pre-training layer 1, epoch 0, validation free energy -61841.8817715
Pre-training layer 1, epoch 1, cost -267.771354279
Pre-training layer 1, epoch 2, cost -254.528065491
Pre-training layer 1, epoch 3, cost -246.641122742
Pre-training layer 1, epoch 4, cost -241.586663635
Pre-training layer 1, epoch 5, cost -237.767764099
Pre-training layer 1, epoch 5, representative training free energy -82999.8574707
Pre-training layer 1, epoch 5, validation free energy -82309.9163047
Pre-training layer 1, epoch 6, cost -234.871489349
Pre-training layer 1, epoch 7, cost -232.381216949
Pre-training layer 1, epoch 8, cost -230.603420349
Pre-training layer 1, epoch 9, cost -228.94464978
Pre-training layer 1, epoch 10, cost -227.503092529
Pre-training layer 1, epoch 10, representative training free energy -89241.7751484
Pre-training layer 1, epoch 10, validation free energy -88476.3343691
Pre-training layer 1, epoch 11, cost -226.358467529
Pre-training layer 1, epoch 12, cost -225.317416748
Pre-training layer 1, epoch 13, cost -224.441861572
Pre-training layer 1, epoch 14, cost -223.559126129
Pre-training layer 1, epoch 15, cost -222.874635101
Pre-training layer 1, epoch 15, representative training free energy -92997.7576211
Pre-training layer 1, epoch 15, validation free energy -92199.3051484
Pre-training layer 1, epoch 16, cost -222.265821808
Pre-training layer 1, epoch 17, cost -221.645605591
Pre-training layer 1, epoch 18, cost -221.081575409
Pre-training layer 1, epoch 19, cost -220.556284637
Pre-training layer 1, epoch 20, cost -220.153075714
Pre-training layer 1, epoch 20, representative training free energy -95743.9179199
Pre-training layer 1, epoch 20, validation free energy -94913.8401855
Pre-training layer 1, epoch 21, cost -219.578755798
Pre-training layer 1, epoch 22, cost -219.285272186
Pre-training layer 1, epoch 23, cost -218.883914551
Pre-training layer 1, epoch 24, cost -218.41518454
Pre-training layer 1, epoch 25, cost -218.200204498
Pre-training layer 1, epoch 25, representative training free energy -97871.1550684
Pre-training layer 1, epoch 25, validation free energy -97026.9208867
Pre-training layer 1, epoch 26, cost -217.761010864
Pre-training layer 1, epoch 27, cost -217.532270813
Pre-training layer 1, epoch 28, cost -217.273341064
Pre-training layer 1, epoch 29, cost -216.886655457
Pre-training layer 1, epoch 30, cost -216.702413208
Pre-training layer 1, epoch 30, representative training free energy -99696.7119727
Pre-training layer 1, epoch 30, validation free energy -98816.6083633
Pre-training layer 1, epoch 31, cost -216.452695496
Pre-training layer 1, epoch 32, cost -216.289057281
Pre-training layer 1, epoch 33, cost -216.068917572
Pre-training layer 1, epoch 34, cost -215.82209787
Pre-training layer 1, epoch 35, cost -215.585759003
Pre-training layer 1, epoch 35, representative training free energy -101242.804432
Pre-training layer 1, epoch 35, validation free energy -100348.942316
Pre-training layer 1, epoch 36, cost -215.404969727
Pre-training layer 1, epoch 37, cost -215.130238098
Pre-training layer 1, epoch 38, cost -214.947907471
Pre-training layer 1, epoch 39, cost -214.753524933
Pre-training layer 1, epoch 40, cost -214.675734131
Pre-training layer 1, epoch 40, representative training free energy -102500.802357
Pre-training layer 1, epoch 40, validation free energy -101587.99925
Pre-training layer 1, epoch 41, cost -214.51055542
Pre-training layer 1, epoch 42, cost -214.191925812
Pre-training layer 1, epoch 43, cost -214.138513184
Pre-training layer 1, epoch 44, cost -214.004563049
Pre-training layer 1, epoch 45, cost -213.805796417
Pre-training layer 1, epoch 45, representative training free energy -103642.243438
Pre-training layer 1, epoch 45, validation free energy -102725.380148
Pre-training layer 1, epoch 46, cost -213.793028107
Pre-training layer 1, epoch 47, cost -213.510869476
Pre-training layer 1, epoch 48, cost -213.476127808
Pre-training layer 1, epoch 49, cost -213.294232697
Pre-training layer 1, epoch 50, cost -213.159597107
Pre-training layer 1, epoch 50, representative training free energy -104798.039252
Pre-training layer 1, epoch 50, validation free energy -103883.951437
Pre-training layer 1, epoch 51, cost -213.018883881
Pre-training layer 1, epoch 52, cost -212.921929688
Pre-training layer 1, epoch 53, cost -212.807410889
Pre-training layer 1, epoch 54, cost -212.865394196
Pre-training layer 1, epoch 55, cost -212.5617388
Pre-training layer 1, epoch 55, representative training free energy -105851.145305
Pre-training layer 1, epoch 55, validation free energy -104928.281871
Pre-training layer 1, epoch 56, cost -212.455503479
Pre-training layer 1, epoch 57, cost -212.374383789
Pre-training layer 1, epoch 58, cost -212.305018738
Pre-training layer 1, epoch 59, cost -212.153704224
Pre-training layer 1, epoch 60, cost -211.974363617
Pre-training layer 1, epoch 60, representative training free energy -106698.468211
Pre-training layer 1, epoch 60, validation free energy -105754.88302
Pre-training layer 1, epoch 61, cost -212.036383484
Pre-training layer 1, epoch 62, cost -211.84617746
Pre-training layer 1, epoch 63, cost -211.816956268
Pre-training layer 1, epoch 64, cost -211.712844055
Pre-training layer 1, epoch 65, cost -211.629146912
Pre-training layer 1, epoch 65, representative training free energy -107574.993863
Pre-training layer 1, epoch 65, validation free energy -106629.169121
Pre-training layer 1, epoch 66, cost -211.526661926
Pre-training layer 1, epoch 67, cost -211.467336731
Pre-training layer 1, epoch 68, cost -211.368105988
Pre-training layer 1, epoch 69, cost -211.34836792
Pre-training layer 1, epoch 70, cost -211.179004486
Pre-training layer 1, epoch 70, representative training free energy -108367.316367
Pre-training layer 1, epoch 70, validation free energy -107404.861832
Pre-training layer 1, epoch 71, cost -211.183421448
Pre-training layer 1, epoch 72, cost -211.093183014
Pre-training layer 1, epoch 73, cost -210.887001434
Pre-training layer 1, epoch 74, cost -210.955780762
Pre-training layer 1, epoch 75, cost -210.807971039
Pre-training layer 1, epoch 75, representative training free energy -109008.772512
Pre-training layer 1, epoch 75, validation free energy -108044.883484
Pre-training layer 1, epoch 76, cost -210.759039734
Pre-training layer 1, epoch 77, cost -210.805276276
Pre-training layer 1, epoch 78, cost -210.697711182
Pre-training layer 1, epoch 79, cost -210.618214966
Pre-training layer 1, epoch 80, cost -210.578488312
Pre-training layer 1, epoch 80, representative training free energy -109791.903566
Pre-training layer 1, epoch 80, validation free energy -108820.480258
Pre-training layer 1, epoch 81, cost -210.508009552
Pre-training layer 1, epoch 82, cost -210.411856934
Pre-training layer 1, epoch 83, cost -210.369457397
Pre-training layer 1, epoch 84, cost -210.226525024
Pre-training layer 1, epoch 85, cost -210.272892609
Pre-training layer 1, epoch 85, representative training free energy -110489.870605
Pre-training layer 1, epoch 85, validation free energy -109515.88266
Pre-training layer 1, epoch 86, cost -210.220982788
Pre-training layer 1, epoch 87, cost -210.127247528
Pre-training layer 1, epoch 88, cost -210.107742615
Pre-training layer 1, epoch 89, cost -210.111032166
Pre-training layer 1, epoch 90, cost -209.968288361
Pre-training layer 1, epoch 90, representative training free energy -111062.893734
Pre-training layer 1, epoch 90, validation free energy -110082.451531
Pre-training layer 1, epoch 91, cost -209.992861359
Pre-training layer 1, epoch 92, cost -209.935369751
Pre-training layer 1, epoch 93, cost -209.847752716
Pre-training layer 1, epoch 94, cost -209.788104736
Pre-training layer 1, epoch 95, cost -209.753192902
Pre-training layer 1, epoch 95, representative training free energy -111754.362949
Pre-training layer 1, epoch 95, validation free energy -110765.899602
Pre-training layer 1, epoch 96, cost -209.621879089
Pre-training layer 1, epoch 97, cost -209.676031769
Pre-training layer 1, epoch 98, cost -209.550901489
Pre-training layer 1, epoch 99, cost -209.585196106
Pre-training layer 2, epoch 0, cost -114.690821198
Pre-training layer 2, epoch 0, representative training free energy 4481.30698853
Pre-training layer 2, epoch 0, validation free energy 4447.73954321
Pre-training layer 2, epoch 1, cost -86.7045525208
Pre-training layer 2, epoch 2, cost -80.4079333725
Pre-training layer 2, epoch 3, cost -76.9305466919
Pre-training layer 2, epoch 4, cost -74.5237370529
Pre-training layer 2, epoch 5, cost -72.8695671158
Pre-training layer 2, epoch 5, representative training free energy 7004.44177271
Pre-training layer 2, epoch 5, validation free energy 6943.312
Pre-training layer 2, epoch 6, cost -71.4954410172
Pre-training layer 2, epoch 7, cost -70.5609831085
Pre-training layer 2, epoch 8, cost -69.7033671036
Pre-training layer 2, epoch 9, cost -68.9991937637
Pre-training layer 2, epoch 10, cost -68.2993218536
Pre-training layer 2, epoch 10, representative training free energy 8318.80537964
Pre-training layer 2, epoch 10, validation free energy 8251.0390625
Pre-training layer 2, epoch 11, cost -67.7352040176
Pre-training layer 2, epoch 12, cost -67.2490149307
Pre-training layer 2, epoch 13, cost -66.8813639145
Pre-training layer 2, epoch 14, cost -66.5068457947
Pre-training layer 2, epoch 15, cost -66.1485044861
Pre-training layer 2, epoch 15, representative training free energy 9261.95891357
Pre-training layer 2, epoch 15, validation free energy 9188.96194702
Pre-training layer 2, epoch 16, cost -65.8067216568
Pre-training layer 2, epoch 17, cost -65.6531459274
Pre-training layer 2, epoch 18, cost -65.3970284958
Pre-training layer 2, epoch 19, cost -65.1378590546
Pre-training layer 2, epoch 20, cost -64.9025239105
Pre-training layer 2, epoch 20, representative training free energy 9996.62839697
Pre-training layer 2, epoch 20, validation free energy 9919.44805078
Pre-training layer 2, epoch 21, cost -64.7013823547
Pre-training layer 2, epoch 22, cost -64.4471426392
Pre-training layer 2, epoch 23, cost -64.4265965881
Pre-training layer 2, epoch 24, cost -64.1712517929
Pre-training layer 2, epoch 25, cost -64.0130894852
Pre-training layer 2, epoch 25, representative training free energy 10668.1379973
Pre-training layer 2, epoch 25, validation free energy 10588.2109397
Pre-training layer 2, epoch 26, cost -63.8209255524
Pre-training layer 2, epoch 27, cost -63.809165741
Pre-training layer 2, epoch 28, cost -63.6632895508
Pre-training layer 2, epoch 29, cost -63.4684647064
Pre-training layer 2, epoch 30, cost -63.4538462601
Pre-training layer 2, epoch 30, representative training free energy 11210.5491721
Pre-training layer 2, epoch 30, validation free energy 11123.3972026
Pre-training layer 2, epoch 31, cost -63.3082663879
Pre-training layer 2, epoch 32, cost -63.2223546524
Pre-training layer 2, epoch 33, cost -63.1901975327
Pre-training layer 2, epoch 34, cost -62.9720048676
Pre-training layer 2, epoch 35, cost -62.8539876099
Pre-training layer 2, epoch 35, representative training free energy 11751.3905806
Pre-training layer 2, epoch 35, validation free energy 11661.7015742
Pre-training layer 2, epoch 36, cost -62.8743150558
Pre-training layer 2, epoch 37, cost -62.718594902
Pre-training layer 2, epoch 38, cost -62.7530159836
Pre-training layer 2, epoch 39, cost -62.6614584885
Pre-training layer 2, epoch 40, cost -62.552862999
Pre-training layer 2, epoch 40, representative training free energy 12184.930636
Pre-training layer 2, epoch 40, validation free energy 12092.1614526
Pre-training layer 2, epoch 41, cost -62.5003357239
Pre-training layer 2, epoch 42, cost -62.4247817917
Pre-training layer 2, epoch 43, cost -62.4082330093
Pre-training layer 2, epoch 44, cost -62.3312078171
Pre-training layer 2, epoch 45, cost -62.2388152161
Pre-training layer 2, epoch 45, representative training free energy 12646.8946143
Pre-training layer 2, epoch 45, validation free energy 12552.2775767
Pre-training layer 2, epoch 46, cost -62.1747761688
Pre-training layer 2, epoch 47, cost -62.1076893005
Pre-training layer 2, epoch 48, cost -62.0555620956
Pre-training layer 2, epoch 49, cost -61.9949976349
Pre-training layer 2, epoch 50, cost -62.0315011902
Pre-training layer 2, epoch 50, representative training free energy 13073.8597632
Pre-training layer 2, epoch 50, validation free energy 12975.5016855
Pre-training layer 2, epoch 51, cost -61.9332285843
Pre-training layer 2, epoch 52, cost -61.8679781036
Pre-training layer 2, epoch 53, cost -61.83636306
Pre-training layer 2, epoch 54, cost -61.7730786667
Pre-training layer 2, epoch 55, cost -61.7930063324
Pre-training layer 2, epoch 55, representative training free energy 13489.8978569
Pre-training layer 2, epoch 55, validation free energy 13387.6462871
Pre-training layer 2, epoch 56, cost -61.6767154694
Pre-training layer 2, epoch 57, cost -61.6242852554
Pre-training layer 2, epoch 58, cost -61.609508873
Pre-training layer 2, epoch 59, cost -61.568905838
Pre-training layer 2, epoch 60, cost -61.5160734329
Pre-training layer 2, epoch 60, representative training free energy 13898.0632695
Pre-training layer 2, epoch 60, validation free energy 13794.4091777
Pre-training layer 2, epoch 61, cost -61.5288790741
Pre-training layer 2, epoch 62, cost -61.4336452637
Pre-training layer 2, epoch 63, cost -61.488088974
Pre-training layer 2, epoch 64, cost -61.4317775726
Pre-training layer 2, epoch 65, cost -61.34076931
Pre-training layer 2, epoch 65, representative training free energy 14289.013665
Pre-training layer 2, epoch 65, validation free energy 14181.0619727
Pre-training layer 2, epoch 66, cost -61.3175354996
Pre-training layer 2, epoch 67, cost -61.2921118698
Pre-training layer 2, epoch 68, cost -61.2602213821
Pre-training layer 2, epoch 69, cost -61.2038828354
Pre-training layer 2, epoch 70, cost -61.1760823135
Pre-training layer 2, epoch 70, representative training free energy 14646.4582554
Pre-training layer 2, epoch 70, validation free energy 14538.3004658
Pre-training layer 2, epoch 71, cost -61.1835380325
Pre-training layer 2, epoch 72, cost -61.1654007034
Pre-training layer 2, epoch 73, cost -61.1282563171
Pre-training layer 2, epoch 74, cost -61.0549347229
Pre-training layer 2, epoch 75, cost -61.0252055511
Pre-training layer 2, epoch 75, representative training free energy 15026.2231577
Pre-training layer 2, epoch 75, validation free energy 14914.3634375
Pre-training layer 2, epoch 76, cost -61.0656002121
Pre-training layer 2, epoch 77, cost -60.9707180786
Pre-training layer 2, epoch 78, cost -61.0399040375
Pre-training layer 2, epoch 79, cost -60.9828191681
Pre-training layer 2, epoch 80, cost -60.8984158325
Pre-training layer 2, epoch 80, representative training free energy 15356.8056006
Pre-training layer 2, epoch 80, validation free energy 15243.9480869
Pre-training layer 2, epoch 81, cost -60.9476484222
Pre-training layer 2, epoch 82, cost -60.9581492233
Pre-training layer 2, epoch 83, cost -60.8780396805
Pre-training layer 2, epoch 84, cost -60.8739981079
Pre-training layer 2, epoch 85, cost -60.7830283661
Pre-training layer 2, epoch 85, representative training free energy 15710.8138784
Pre-training layer 2, epoch 85, validation free energy 15595.5243618
Pre-training layer 2, epoch 86, cost -60.7840680466
Pre-training layer 2, epoch 87, cost -60.7479602966
Pre-training layer 2, epoch 88, cost -60.744550209
Pre-training layer 2, epoch 89, cost -60.6494028931
Pre-training layer 2, epoch 90, cost -60.7383183823
Pre-training layer 2, epoch 90, representative training free energy 16017.0500669
Pre-training layer 2, epoch 90, validation free energy 15899.8404922
Pre-training layer 2, epoch 91, cost -60.7330644379
Pre-training layer 2, epoch 92, cost -60.6960785294
Pre-training layer 2, epoch 93, cost -60.6355255814
Pre-training layer 2, epoch 94, cost -60.6927846527
Pre-training layer 2, epoch 95, cost -60.6495995102
Pre-training layer 2, epoch 95, representative training free energy 16355.5653345
Pre-training layer 2, epoch 95, validation free energy 16235.454625
Pre-training layer 2, epoch 96, cost -60.5910650711
Pre-training layer 2, epoch 97, cost -60.5720233917
Pre-training layer 2, epoch 98, cost -60.5767492752
Pre-training layer 2, epoch 99, cost -60.562942337
The pretraining code for file dbn_loop.pyc ran for 13.01m... getting the finetuning functions... finetuning the model
epoch 1, minibatch 500/500, validation error 30.200000 %
     epoch 1, minibatch 500/500, test error of best model 24.500000 %
epoch 2, minibatch 500/500, validation error 23.300000 %
     epoch 2, minibatch 500/500, test error of best model 16.100000 %
epoch 3, minibatch 500/500, validation error 21.200000 %
     epoch 3, minibatch 500/500, test error of best model 13.900000 %
epoch 4, minibatch 500/500, validation error 19.700000 %
     epoch 4, minibatch 500/500, test error of best model 11.900000 %
epoch 5, minibatch 500/500, validation error 19.200000 %
     epoch 5, minibatch 500/500, test error of best model 11.100000 %
epoch 6, minibatch 500/500, validation error 18.600000 %
     epoch 6, minibatch 500/500, test error of best model 9.900000 %
epoch 7, minibatch 500/500, validation error 17.400000 %
     epoch 7, minibatch 500/500, test error of best model 9.400000 %
epoch 8, minibatch 500/500, validation error 16.900000 %
     epoch 8, minibatch 500/500, test error of best model 8.600000 %
epoch 9, minibatch 500/500, validation error 16.900000 %
epoch 10, minibatch 500/500, validation error 16.700000 %
     epoch 10, minibatch 500/500, test error of best model 7.500000 %
epoch 11, minibatch 500/500, validation error 16.600000 %
     epoch 11, minibatch 500/500, test error of best model 6.700000 %
epoch 12, minibatch 500/500, validation error 16.500000 %
     epoch 12, minibatch 500/500, test error of best model 6.300000 %
epoch 13, minibatch 500/500, validation error 16.400000 %
     epoch 13, minibatch 500/500, test error of best model 6.200000 %
epoch 14, minibatch 500/500, validation error 16.300000 %
     epoch 14, minibatch 500/500, test error of best model 6.100000 %
epoch 15, minibatch 500/500, validation error 15.900000 %
     epoch 15, minibatch 500/500, test error of best model 6.200000 %
epoch 16, minibatch 500/500, validation error 15.700000 %
     epoch 16, minibatch 500/500, test error of best model 6.100000 %
epoch 17, minibatch 500/500, validation error 15.700000 %
epoch 18, minibatch 500/500, validation error 15.700000 %
epoch 19, minibatch 500/500, validation error 15.700000 %
epoch 20, minibatch 500/500, validation error 15.600000 %
     epoch 20, minibatch 500/500, test error of best model 5.700000 %
epoch 21, minibatch 500/500, validation error 15.300000 %
     epoch 21, minibatch 500/500, test error of best model 5.600000 %
epoch 22, minibatch 500/500, validation error 15.300000 %
epoch 23, minibatch 500/500, validation error 15.200000 %
     epoch 23, minibatch 500/500, test error of best model 5.600000 %
epoch 24, minibatch 500/500, validation error 15.200000 %
epoch 25, minibatch 500/500, validation error 14.900000 %
     epoch 25, minibatch 500/500, test error of best model 5.400000 %
epoch 26, minibatch 500/500, validation error 14.800000 %
     epoch 26, minibatch 500/500, test error of best model 5.400000 %
epoch 27, minibatch 500/500, validation error 14.800000 %
epoch 28, minibatch 500/500, validation error 14.900000 %
epoch 29, minibatch 500/500, validation error 14.800000 %
epoch 30, minibatch 500/500, validation error 14.800000 %
epoch 31, minibatch 500/500, validation error 14.800000 %
epoch 32, minibatch 500/500, validation error 14.800000 %
epoch 33, minibatch 500/500, validation error 14.800000 %
epoch 34, minibatch 500/500, validation error 14.700000 %
     epoch 34, minibatch 500/500, test error of best model 5.400000 %
epoch 35, minibatch 500/500, validation error 14.700000 %
epoch 36, minibatch 500/500, validation error 14.600000 %
     epoch 36, minibatch 500/500, test error of best model 5.400000 %
epoch 37, minibatch 500/500, validation error 14.500000 %
     epoch 37, minibatch 500/500, test error of best model 5.300000 %
epoch 38, minibatch 500/500, validation error 14.500000 %
epoch 39, minibatch 500/500, validation error 14.500000 %
epoch 40, minibatch 500/500, validation error 14.700000 %
epoch 41, minibatch 500/500, validation error 14.700000 %
epoch 42, minibatch 500/500, validation error 14.700000 %
epoch 43, minibatch 500/500, validation error 14.600000 %
epoch 44, minibatch 500/500, validation error 14.600000 %
epoch 45, minibatch 500/500, validation error 14.500000 %
     epoch 45, minibatch 500/500, test error of best model 5.000000 %
epoch 46, minibatch 500/500, validation error 14.500000 %
epoch 47, minibatch 500/500, validation error 14.600000 %
epoch 48, minibatch 500/500, validation error 14.600000 %
epoch 49, minibatch 500/500, validation error 14.600000 %
epoch 50, minibatch 500/500, validation error 14.600000 %
epoch 51, minibatch 500/500, validation error 14.600000 %
epoch 52, minibatch 500/500, validation error 14.600000 %
epoch 53, minibatch 500/500, validation error 14.600000 %
epoch 54, minibatch 500/500, validation error 14.600000 %
epoch 55, minibatch 500/500, validation error 14.600000 %
epoch 56, minibatch 500/500, validation error 14.600000 %
epoch 57, minibatch 500/500, validation error 14.600000 %
epoch 58, minibatch 500/500, validation error 14.600000 %
epoch 59, minibatch 500/500, validation error 14.600000 %
epoch 60, minibatch 500/500, validation error 14.600000 %
epoch 61, minibatch 500/500, validation error 14.600000 %
epoch 62, minibatch 500/500, validation error 14.600000 %
epoch 63, minibatch 500/500, validation error 14.600000 %
epoch 64, minibatch 500/500, validation error 14.600000 %
epoch 65, minibatch 500/500, validation error 14.600000 %
epoch 66, minibatch 500/500, validation error 14.600000 %
epoch 67, minibatch 500/500, validation error 14.600000 %
epoch 68, minibatch 500/500, validation error 14.600000 %
epoch 69, minibatch 500/500, validation error 14.600000 %
epoch 70, minibatch 500/500, validation error 14.600000 %
epoch 71, minibatch 500/500, validation error 14.600000 %
epoch 72, minibatch 500/500, validation error 14.600000 %
epoch 73, minibatch 500/500, validation error 14.600000 %
Optimization complete with best validation score of 14.500000 %, obtained at iteration 22500, with test performance 5.000000 %
The fine tuning code for file dbn_loop.pyc ran for 3.06m
